<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Paper Reading: CatSQL: Towards Real World Natural Language to SQL Applications [VLDB 23] - Adbean&#39;s Blog</title><meta name="Description" content="Adbean&#39;s Blog"><meta property="og:title" content="Paper Reading: CatSQL: Towards Real World Natural Language to SQL Applications [VLDB 23]" />
<meta property="og:description" content="CatSQL: Towards Real World Natural Language to SQL Applications NL2SQL, text to SQL æ˜¯å¾ˆæœ‰è¶£çš„æ–¹å‘ã€‚æœ‰ DL æ–¹æ³•ä¹Ÿæœ‰ç°åœ¨çš„ LLM å¾®è°ƒã€‚ ABSTRACT rule-based æˆ–è€… Deep Learning æ–¹æ³•ï¼Œè¦ä¹ˆæ— æ³•é€šç”¨ï¼Œæˆ–è€…å­˜åœ¨è¯­æ³•/è¯­ä¹‰é”™è¯¯/æ— æ³•æ‰§è¡Œã€‚ æœ¬æ–‡æ" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ad-bean.github.io/posts/catsql-nlsql/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-04-14T14:19:15-04:00" />
<meta property="article:modified_time" content="2024-04-14T14:19:15-04:00" /><meta property="og:site_name" content="My cool site" />

<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Paper Reading: CatSQL: Towards Real World Natural Language to SQL Applications [VLDB 23]"/>
<meta name="twitter:description" content="CatSQL: Towards Real World Natural Language to SQL Applications NL2SQL, text to SQL æ˜¯å¾ˆæœ‰è¶£çš„æ–¹å‘ã€‚æœ‰ DL æ–¹æ³•ä¹Ÿæœ‰ç°åœ¨çš„ LLM å¾®è°ƒã€‚ ABSTRACT rule-based æˆ–è€… Deep Learning æ–¹æ³•ï¼Œè¦ä¹ˆæ— æ³•é€šç”¨ï¼Œæˆ–è€…å­˜åœ¨è¯­æ³•/è¯­ä¹‰é”™è¯¯/æ— æ³•æ‰§è¡Œã€‚ æœ¬æ–‡æ"/>
<meta name="application-name" content="Adbean&#39;s Blog">
<meta name="apple-mobile-web-app-title" content="Adbean&#39;s Blog"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="../../Owl.ico"><link rel="apple-touch-icon" sizes="180x180" href="../../apple-touch-icon.png"><link rel="mask-icon" href="../../safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="../../site.webmanifest"><link rel="canonical" href="https://ad-bean.github.io/posts/catsql-nlsql/" /><link rel="prev" href="https://ad-bean.github.io/posts/learned-sorting/" /><link rel="stylesheet" href="../../css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Paper Reading: CatSQL: Towards Real World Natural Language to SQL Applications [VLDB 23]",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/ad-bean.github.io\/posts\/catsql-nlsql\/"
        },"genre": "posts","keywords": "Paper Reading","wordcount":  3418 ,
        "url": "https:\/\/ad-bean.github.io\/posts\/catsql-nlsql\/","datePublished": "2024-04-14T14:19:15-04:00","dateModified": "2024-04-14T14:19:15-04:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "Adbean"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="../../" title="Adbean&#39;s Blog"><img
        class="lazyload logo"
        src="../../svg/loading.min.svg"
        data-src="../../Owl.ico"
        data-srcset="../../Owl.ico, ../../Owl.ico 1.5x, ../../Owl.ico 2x"
        data-sizes="auto"
        alt="/Owl.ico"
        title="/Owl.ico" />Adbean&#39;s Blog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="../../"> ä¸»é¡µ </a><a class="menu-item" href="../../posts/"> æ–‡ç«  </a><a class="menu-item" href="../../tags/"> æ ‡ç­¾ </a><a class="menu-item" href="../../categories/"> åˆ†ç±» </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="æœç´¢æ–‡ç« æ ‡é¢˜æˆ–å†…å®¹..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="æœç´¢">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="æ¸…ç©º">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="åˆ‡æ¢ä¸»é¢˜">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="../../" title="Adbean&#39;s Blog"><img
        class="lazyload logo"
        src="../../svg/loading.min.svg"
        data-src="../../Owl.ico"
        data-srcset="../../Owl.ico, ../../Owl.ico 1.5x, ../../Owl.ico 2x"
        data-sizes="auto"
        alt="/Owl.ico"
        title="/Owl.ico" />Adbean&#39;s Blog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="æœç´¢æ–‡ç« æ ‡é¢˜æˆ–å†…å®¹..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="æœç´¢">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="æ¸…ç©º">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        å–æ¶ˆ
                    </a>
                </div><a class="menu-item" href="../../" title="">ä¸»é¡µ</a><a class="menu-item" href="../../posts/" title="">æ–‡ç« </a><a class="menu-item" href="../../tags/" title="">æ ‡ç­¾</a><a class="menu-item" href="../../categories/" title="">åˆ†ç±»</a><a href="javascript:void(0);" class="menu-item theme-switch" title="åˆ‡æ¢ä¸»é¢˜">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">ç›®å½•</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Paper Reading: CatSQL: Towards Real World Natural Language to SQL Applications [VLDB 23]</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://github.com/ad-bean" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Adbean</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2024-04-14">2024-04-14</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;çº¦ 3418 å­—&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;é¢„è®¡é˜…è¯» 7 åˆ†é’Ÿ&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>ç›®å½•</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#catsql-towards-real-world-natural-language-to-sql-applications">CatSQL: Towards Real World Natural Language to SQL Applications</a></li>
    <li><a href="#abstract">ABSTRACT</a></li>
    <li><a href="#introduction">INTRODUCTION</a></li>
    <li><a href="#overview">OVERVIEW</a>
      <ul>
        <li><a href="#motivating-example">Motivating Example</a></li>
        <li><a href="#background">Background</a></li>
        <li><a href="#existing-nl2sql-approaches">Existing NL2SQL Approaches</a></li>
      </ul>
    </li>
    <li><a href="#catsql-approach">CATSQL APPROACH</a>
      <ul>
        <li><a href="#catsql-template">CatSQL template</a></li>
        <li><a href="#catsql-query-generation">CatSQL query generation</a></li>
        <li><a href="#semantics-correction">Semantics Correction</a></li>
      </ul>
    </li>
    <li><a href="#system-implementation">SYSTEM IMPLEMENTATION</a></li>
    <li><a href="#experiments">EXPERIMENTS</a>
      <ul>
        <li><a href="#benchmarks-and-baselines">Benchmarks and Baselines</a></li>
        <li><a href="#cross-domain-evaluation-results">Cross-Domain Evaluation Results</a></li>
        <li><a href="#single-domain-evaluation-results">Single-Domain Evaluation Results</a></li>
        <li><a href="#throughput-analysis">Throughput analysis</a></li>
        <li><a href="#case-study">Case Study</a></li>
      </ul>
    </li>
    <li><a href="#related-work">RELATED WORK</a></li>
    <li><a href="#conclusion">CONCLUSION</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="catsql-towards-real-world-natural-language-to-sql-applications">CatSQL: Towards Real World Natural Language to SQL Applications</h2>
<p>NL2SQL, text to SQL æ˜¯å¾ˆæœ‰è¶£çš„æ–¹å‘ã€‚æœ‰ DL æ–¹æ³•ä¹Ÿæœ‰ç°åœ¨çš„ LLM å¾®è°ƒã€‚</p>
<h2 id="abstract">ABSTRACT</h2>
<p>rule-based æˆ–è€… Deep Learning æ–¹æ³•ï¼Œè¦ä¹ˆæ— æ³•é€šç”¨ï¼Œæˆ–è€…å­˜åœ¨è¯­æ³•/è¯­ä¹‰é”™è¯¯/æ— æ³•æ‰§è¡Œã€‚</p>
<p>æœ¬æ–‡æå‡ºçš„æ–°æ¡†æ¶ï¼Œæ³¨é‡ Accuracy å’Œ runtimeï¼Œæå‡ºäº† novel CatSQL sketch, which constructs a template with slots that initially serve as placeholders, and tightly integrates with a <strong>deep learning model</strong> to fill in these slots with meaningful contents based on the database schema</p>
<p>å¯¹æ¯” sequence-to-sequence æˆ– sketch-based æ–¹æ³•ï¼Œä¸éœ€è¦ç”Ÿæˆå…³é”®è¯ï¼Œæœ‰æ›´é«˜å‡†ç¡®å’Œæ›´å¿«</p>
<p>å¯¹æ¯” sketch-based æ–¹æ³•ï¼Œæ›´åŠ é€šç”¨ï¼Œè€Œä¸”å¯ä»¥ç”¨å·²ç»å¡«å¥½çš„è¯æ¥æé«˜æ€§èƒ½ã€‚</p>
<p>æå‡ºäº† Semantics Correction technique, which is the first that leverages database domain knowledge in a deep learning based NL2SQL solution.</p>
<p>Semantics Correction æ˜¯ post-processing åå¤„ç†ï¼Œé€šè¿‡ rules è¯†åˆ«å’Œä¿®æ”¹è¯­ä¹‰é”™è¯¯ï¼Œå¤§å¤§æé«˜äº† NL2SQL çš„å‡†ç¡®åº¦ã€‚</p>
<p>å®éªŒï¼šsingle-domain and cross-domainï¼Œå‡†ç¡®æ€§å’Œååé‡éƒ½æé«˜å¾ˆå¤šï¼Œå°¤å…¶æ˜¯åœ¨ Spider åŸºå‡†ä¸Šï¼Œæ¯”ä¹‹å‰æœ€å¥½çš„ stoa NL2SQL è¦é«˜å››åˆ†ï¼Œ63x çš„ååé‡</p>
<h2 id="introduction">INTRODUCTION</h2>
<p>æ—©æœŸ NL2SQL æ˜¯ rule-based, å…ˆå°† nl parse æˆä¸­é—´æ€(parsing tree) ç„¶åå¼€å‘ rules æ˜ å°„æˆ SQL æŠ½è±¡è¯­æ³•æ ‘ï¼Œç„¶åè½¬æˆ SQL queryã€‚è¿™æ ·éš¾ä»¥è·¨åŸŸï¼Œè€Œä¸”éœ€è¦å¤§é‡äººåŠ›å¼€å‘è§„åˆ™ã€‚</p>
<p>æœ€è¿‘å€ŸåŠ© Deep Learning å®ç° cross-domain adaptionï¼Œè€Œä¸”æä¾›äº†å¤§é‡æ•°æ®é›†ï¼Œæ¯”å¦‚ Wiki-SQL å’Œ Spiderã€‚éƒ¨åˆ† DL æ–¹æ³•å¯ä»¥è¾¾åˆ° 80-90% çš„ç²¾åº¦ï¼Œä½†æ˜¯å¯¹äºå¤æ‚æŸ¥è¯¢æ€§èƒ½ä¼šæ˜¾è‘—ä¸‹é™ï¼Œä¸åˆ° 50%ã€‚ä»¥å‰çš„æ–¹æ³•å°†å…¶è®¤ä¸ºæ˜¯ç¿»è¯‘é—®é¢˜ï¼Œæœºå™¨ç¿»è¯‘é—®é¢˜(seq2seq)ï¼Œæ²¡æœ‰åˆ©ç”¨æ•°æ®åº“çŸ¥è¯†ï¼Œå¾ˆå®¹æ˜“å¯¼è‡´è¯­ä¹‰é”™è¯¯ã€‚</p>
<p>æœ¬æ–‡æ˜¯ç¬¬ä¸€ä¸ªå°† DL ç»“åˆæ•°æ®åº“çš„ï¼Œå¼€å‘äº†æ–°çš„ NL2SQL é—®é¢˜ï¼Œå¯ä»¥æé«˜æ€§èƒ½ã€‚</p>
<p>CatSQL, is a deep learning-based approach, which can mitigate the issues of rule-based solutions to generalize across application domains.</p>
<ol>
<li>most existing deep learning approaches are based on a sequence-to-sequence or sequence-to-tree model . These methods do not guarantee the generated SQL queries are <strong>executable</strong> or even syntactically legal. Instead, our approach is a <strong>sketch-based solution</strong>, which relies on our novel CatSQL sketch to generate the SQL query. CatSQL sketch is a template with keywords and slots. These slots initially serve as placeholders. We use a deep learning model to fill in the empty slots to get a final SQL query, which is almost always a legal SQL query</li>
</ol>
<blockquote>
<p>å®Œå½¢å¡«ç©ºï¼Ÿæ€»æ˜¯åˆæ³•çš„ SQL è¯­å¥ï¼Œé‚£è¯­ä¹‰èƒ½å¦ä¿è¯æ­£ç¡®å‘¢ï¼Œç»“æœæ€»æ˜¯æ­£ç¡®çš„å—ã€‚å¦‚æœç»“æœæ­£ç¡®ï¼Œæ€§èƒ½æ€ä¹ˆæ ·å‘¢ï¼ŸNL2SQL ä¼šä¸ä¼šçŸ¥é“ç´¢å¼•ï¼Œæˆ–è€…è¯´ä¼šä¸ä¼šç»“åˆ query optimization å‘¢ï¼Ÿ</p>
</blockquote>
<p>ä»¥å‰ä¹Ÿæœ‰ fill in slots çš„åšæ³•ï¼Œ sketch-based idea</p>
<p>Our CatSQL SQL generation algorithm employs a novel CatSQL sketch, which is <strong>general</strong> enough, and can facilitate the idea of parameter sharing to boost the performance</p>
<blockquote>
<p>å¼ºè°ƒäº†æ›´åŠ  generalï¼Œè€Œä¸”å‚æ•°ä¹‹é—´å¯ä»¥å…±äº«</p>
</blockquote>
<p>ä»¥å‰çš„ DL æ²¡æœ‰ç»“åˆæ•°æ®åº“ä¿¡æ¯ï¼ŒCatSQL åšäº†è¯­ä¹‰çŸ«æ­£ï¼ŒTo the best of our knowledge, we are the first to incorporate <strong>semantic information</strong> into a deep learning-based NL2SQL solution. We evaluate our CatSQL approach on the well-known Spider dataset, and the results demonstrate that CatSQL is 4 points better than the previous state-of-the-art methods</p>
<ol>
<li>A <strong>novel sketch-based model CatSQL</strong> is proposed to achieve the state-of-the-art performance on various NL2SQL benchmarks;</li>
<li><strong>Semantics Correction</strong> of CatSQL is the first work that adopts database domain knowledge in a NL2SQL solution;</li>
<li><strong>Extensive evaluations</strong> demonstrate that CatSQL significantly outperforms all existing solutions on cross-domain benchmarks such as Spider and WikiSQL;</li>
<li>On <strong>single-domain</strong> benchmarks, CatSQL solution also significantly outperforms existing solutions;</li>
<li>CatSQL prototype achieves outstanding <strong>runtime performance</strong>: its single query runtime latency can be 2Ã—âˆ’20Ã— faster than all baselines; while its <strong>throughput</strong> can be 2.5Ã—âˆ’63Ã—higher than the previous approaches</li>
</ol>
<blockquote>
<p>ä¸»è¦è´¡çŒ®ï¼ŒCatSQL æ–°æ–¹æ³•åŸºäº sketch-basedï¼Œè¯­ä¹‰çŸ«æ­£ï¼Œå¤§é‡æµ‹è¯•ï¼Œå•é¢†åŸŸå¤šé¢†åŸŸï¼Œè¿è¡Œæ—¶ã€ååé‡æ€§èƒ½æ›´å¥½</p>
</blockquote>
<h2 id="overview">OVERVIEW</h2>
<h3 id="motivating-example">Motivating Example</h3>
<p>The NL2SQL problem is to translate the <strong>natural language question</strong> into the <strong>corresponding SQL query</strong>. We need to figure out three challenging questions from the natural language description: (1) what tables and columns that will be used in the query; (2) what is the correct query structure; and (3) how to fill in query details and the literal in the query.</p>
<blockquote>
<p>è¡¨å’Œåˆ—ï¼Œquery ç»“æ„ï¼Œquery details å­—é¢é‡ã€‚</p>
</blockquote>
<p>Solutions from the DB community requires designing <strong>rules</strong> for the mapping between natural language tokens into SQL elements, and translating a natural language parsing tree into a SQLâ€™s abstract syntax tree (AST). However, these approachesâ€™ performance decay significantly when they are applied to a new domain of database, that requires redesigning the mapping.</p>
<blockquote>
<p>rules éš¾ä»¥åº”å¯¹æ–°çš„ domainï¼Œæ–° domain æ˜¯ä»€ä¹ˆæ„æ€ï¼Œæ–°çš„è¡¨ï¼Ÿè¿˜æ˜¯æ–°çš„æ•°æ®ï¼Ÿ</p>
</blockquote>
<p>Deep Learning è®­ç»ƒå¤§æ¨¡å‹å¯ä»¥è§£å†³ cross-domain é—®é¢˜ï¼Œå¹¶ä¸”æ€§èƒ½å¾ˆå¥½ï¼Œä½†æ˜¯æ²¡æœ‰åˆ©ç”¨è¯­ä¹‰ä¿¡æ¯ç”ŸæˆæŸ¥è¯¢ï¼Œè€Œä¸”éš¾ä»¥å¤„ç†å¤æ‚æŸ¥è¯¢ï¼Œè€Œä¸”è¿è¡Œæ—¶æ€§èƒ½å’Œæ¨¡å‹å‚æ•°ã€å¤æ‚åº¦æœ‰å…³ã€‚è®­ç»ƒéœ€è¦å¾ˆå¤šè®¡ç®—ã€‚</p>
<p>æœ¬æ–‡ç»“åˆäº†è¿™ä¸¤ç§æ–¹æ³•ï¼Œand we demonstrate that our approach performs better than all existing solutions.</p>
<p>Our approach employs a <strong>deep learning architecture</strong>, and we <strong>leverage DB domain knowledge</strong> to develop novel <strong>Semantics Correction</strong> techniques to postprocess the query generated by a neural network to fix obvious semantics errors. In the following, we will first provide necessary background on how a deep neural network NL2SQL solution works, and then we will give an overview of our approach.</p>
<h3 id="background">Background</h3>
<ol>
<li>Embedding: As an atomic operator, neural networks, such as LSTMs [18] and Transformers [41], can model a sequence of tokens into a sequence of ğ‘-dimensional numeric vectors called embedding</li>
</ol>
<blockquote>
<p>è¿™é‡Œä¹Ÿæåˆ°äº† BERT, GraPPa æ˜¯å¦ä¸€ä¸ªè¡¨è¯­ä¹‰åˆ†æçš„é¢„è®­ç»ƒæ¨¡å‹ï¼Œåº”è¯¥æ˜¯ä¸“ç”¨äº SQL é¢†åŸŸçš„ã€è¡¨ç»“æ„çš„ã€‚æœäº†ä¸€ä¸‹æ‰çŸ¥é“ï¼Œä¹‹å‰æœ‰ä¸€ç¯‡ RatSQL å°±æ˜¯åˆ©ç”¨è‡ªæ³¨æ„åŠ›æœºåˆ¶æ¥åšçš„ï¼Œèƒ½çŸ¥é“å…³ç³»ï¼Œä¹Ÿå°±æ˜¯ Relation-Aware Text2SQL</p>
</blockquote>
<ol start="2">
<li>
<p>Classifier: Using this operator, we can build a classifier to classify the input sequence into one of ğ¶ categories as follows.</p>
</li>
<li>
<p>Sequence-to-sequence translation:</p>
</li>
<li>
<p>Training:</p>
</li>
</ol>
<blockquote>
<p>åŸºç¡€çŸ¥è¯†ç•¥</p>
</blockquote>
<h3 id="existing-nl2sql-approaches">Existing NL2SQL Approaches</h3>
<p>(1) rule-based approaches;</p>
<p>(2) sequence-to-sequence approaches; These approaches typically face the problem of picking a <strong>wrong column or a wrong value</strong>. Therefore, most of the efforts in these works are devoted to tackling this issue</p>
<p>(3) sketch-based approaches. We will briefly explain the basic ideas below</p>
<blockquote>
<p>å…·ä½“ä»‹ç»ç•¥ï¼Œä½† rule-based å¯ä»¥å¤„ç†å¤æ‚ç»“æ„å’Œ queryï¼Ÿè€Œä¸” Sketch-based æ–¹æ³•å¹¶ä¸æ–°ï¼Œä»¥å‰ä¹Ÿæœ‰ï¼Œæ¯”å¦‚ SyntaxSQLNet å’Œ Sqlnetï¼Œåªä¸è¿‡å¯èƒ½æ²¡æœ‰ç»“åˆ RL æˆ–è€…æ²¡æœ‰åšå¾—é‚£ä¹ˆå¥½ã€‚CatSQL å¯èƒ½å°±æ˜¯åˆ©ç”¨ GraPPa åŠ ä¸Š Sketch-Based çš„ç»“åˆ</p>
</blockquote>
<h2 id="catsql-approach">CATSQL APPROACH</h2>
<p>Column Action Templates</p>
<p><img
        class="lazyload"
        src="../../svg/loading.min.svg"
        data-src="https://s2.loli.net/2024/04/15/HbjG14VmxkD3lIR.png"
        data-srcset="https://s2.loli.net/2024/04/15/HbjG14VmxkD3lIR.png, https://s2.loli.net/2024/04/15/HbjG14VmxkD3lIR.png 1.5x, https://s2.loli.net/2024/04/15/HbjG14VmxkD3lIR.png 2x"
        data-sizes="auto"
        alt="https://s2.loli.net/2024/04/15/HbjG14VmxkD3lIR.png"
        title="https://s2.loli.net/2024/04/15/HbjG14VmxkD3lIR.png" /></p>
<h3 id="catsql-template">CatSQL template</h3>
<p>The definition of the CatSQL template is designed to <strong>facilitate the idea of parameter sharing</strong>, which is not adapted by previous sketch-based approaches. In particular, since each of the four CAT clauses can be viewed as a sequence of CATs, we can train one sequence-to-sequence model for all four different clauses. At runtime, once the CATs are predicted, we can simply construct the final SQL query by assembling different CAT clauses. We will explain how our neural network fills a CatSQL sketch in the next section</p>
<blockquote>
<p>parameter sharing è¿™ä¸ªæ¦‚å¿µä¸å¤ªç†è§£ï¼Œå¦‚æœè¯´å¡«ç©ºä¹‹é—´æœ‰è”ç³»ï¼Œèƒ½ä¸èƒ½ç”¨å¾®è°ƒåçš„æ¨¡å‹ï¼Œåšä¸€ä¸ªä¸Šä¸‹æ–‡é¢„æµ‹ï¼Ÿ</p>
</blockquote>
<h3 id="catsql-query-generation">CatSQL query generation</h3>
<p>the overall architecture of CatSQL is composed of four components, namely</p>
<ol>
<li>GraPPa embedding network,</li>
<li>CAT decoder network,</li>
<li>conjunction network, and</li>
<li>FROM decoder network. We now explain each of these components</li>
</ol>
<blockquote>
<p>å°±æ˜¯ç”¨ GraPPa å®ç°äº† parameter sharingï¼Œçœ‹æ¥æœ¬è´¨è¿˜æ˜¯ä¸Šä¸‹æ–‡é¢„æµ‹ã€‚æƒ³çŸ¥é“å’Œ CatSQL çš„åŒºåˆ«åœ¨å“ªå‘¢ï¼Ÿ</p>
</blockquote>
<p><img
        class="lazyload"
        src="../../svg/loading.min.svg"
        data-src="https://s2.loli.net/2024/04/15/S1TC3I6lcOZ4KGP.png"
        data-srcset="https://s2.loli.net/2024/04/15/S1TC3I6lcOZ4KGP.png, https://s2.loli.net/2024/04/15/S1TC3I6lcOZ4KGP.png 1.5x, https://s2.loli.net/2024/04/15/S1TC3I6lcOZ4KGP.png 2x"
        data-sizes="auto"
        alt="https://s2.loli.net/2024/04/15/S1TC3I6lcOZ4KGP.png"
        title="https://s2.loli.net/2024/04/15/S1TC3I6lcOZ4KGP.png" /></p>
<h3 id="semantics-correction">Semantics Correction</h3>
<p><strong>Semantics Correction</strong> technique significantly improves the accuracy by leveraging database domain knowledge. While a deep learning model is effective in understanding the <strong>intention of a question</strong>, sometimes the gene<strong>rated SQL query expresses the same intention</strong>, but is semantically invalid considering the database schema.</p>
<blockquote>
<p>å¦‚æœå’Œ CatSQL + GraPPa åŒºåˆ«ä¸å¤§ï¼Œæ˜¯ä¸æ˜¯è¯­ä¹‰çŸ«æ­£æé«˜äº†æ›´å¤šçš„å‡†ç¡®æ€§</p>
<p>å¦‚æœè¯´ ChatGPT ç”Ÿæˆçš„ SQL è´¨é‡è¾ƒå¥½ï¼Œæ˜¯å› ä¸º RLHF å—ï¼Ÿ</p>
</blockquote>
<p>We classify our Semantics Correction rules into three categories: (1) token-level violation, (2) FROM clause revision, and (3) join-path revision.</p>
<blockquote>
<p>æœ‰ä¸‰ä¸ªç±»å‹å¯ä»¥ä¿®æ­£ï¼Œæ˜¯ best-effort è€Œä¸æ˜¯ä¿è¯å¯ä»¥çš„ï¼Œä¹Ÿä¸ä¼šæŠŠå¯¹çš„å†™æˆé”™çš„</p>
</blockquote>
<ol>
<li>token-level violation çœ‹ä¸Šå»æ˜¯æ˜¯ç±»å‹æ£€æŸ¥</li>
<li>FROM clause revision æœ‰æ—¶å€™ query ä¼šå‡ºç°ä¸€äº›æ²¡å‡ºç°è¿‡çš„ column æ¯”å¦‚ FROM é‡Œæ²¡å‡ºç°è¿‡çš„ï¼Œæ­¤æ—¶ä¼šç›´æ¥åŠ åˆ° FROM é‡Œï¼Ÿç”¨æœ€å°ç”Ÿæˆæ ‘æ¥åˆ¤æ–­è¿™äº› JOIN æƒ…å†µã€‚</li>
<li>join-path revision æœ‰æ—¶å€™ join ä¼šå¤±è´¥</li>
</ol>
<h2 id="system-implementation">SYSTEM IMPLEMENTATION</h2>
<p>åŸºäº MySQL v5.7.30</p>
<ol>
<li>Offline processing. ç¦»çº¿é¢„å¤„ç†ï¼Œæ¨¡å‹è®­ç»ƒã€‚ç”šè‡³ç”¨äº† redis å­˜å‚¨ literals to embedding (word2vec è€Œä¸æ˜¯ BERT çš„åŸå› æ˜¯æ›´å¿«)</li>
<li>Online serving. åœ¨çº¿æ¨ç†ï¼Œç”±äºæ„å»ºäº†åç«¯ï¼Œå¥½åƒå¯ä»¥å¹¶è¡ŒåŒ–ï¼ˆååé‡çš„ç”±æ¥ï¼Ÿï¼‰</li>
<li>Model details:</li>
</ol>
<h2 id="experiments">EXPERIMENTS</h2>
<p>accuracy, running speed, throughput</p>
<h3 id="benchmarks-and-baselines">Benchmarks and Baselines</h3>
<p>Dataset:</p>
<ol>
<li>cross-domain: WikiSQL, Spider å…·æœ‰å¤§é‡çš„ queries, tables å’Œ databases</li>
<li>single-domain: GeoQuery, Scholar, IMDB&hellip;</li>
</ol>
<p><strong>Spider</strong> is considered as the hardest NL2SQL dataset currently. Spider supports much richer SQL syntax, and it classifies the dataset into four categories based on their hardness levels</p>
<p>Evaluation metrics:</p>
<ol>
<li>accuracy (i.e., Accex ). è¯­ä¹‰ä¸Šæ­£ç¡®çš„ SQLï¼Ÿè¿˜æ˜¯ç»“æœä¸€è‡´ï¼Ÿ</li>
<li>logical form accuracy (i.e., Acclf ). å®Œå…¨ä¸€è‡´çš„ SQLï¼Ÿ</li>
<li>executable rate: æœ¬æ–‡æå‡ºçš„</li>
</ol>
<p>Baseline approaches: æ–‡ç« é€‰äº† RAT-SQLï¼Œä½†æ˜¯æ˜¯ç”¨ GraPPa é¢„è®­ç»ƒçš„ï¼Œè€Œ NatSQL å’Œ SmBoP é€‰çš„æ˜¯ GraPPa ä¸è®­ç»ƒçš„</p>
<h3 id="cross-domain-evaluation-results">Cross-Domain Evaluation Results</h3>
<p>åˆ†åˆ«æµ‹è¯•äº†æ²¡æœ‰ parameter sharing çš„ï¼Œæ²¡æœ‰ semantic correction çš„ï¼Œå®Œæ•´çš„ï¼Œ</p>
<p>åœ¨ Spider ä¸Šè¡¨ç°éå¸¸å¥½ï¼Œå‡ ä¹å„é¡¹éƒ½æ˜¯ç¬¬ä¸€ï¼Œæ²¡æœ‰ parameter sharing çš„æ•°æ®éƒ½æŒºå¥½ä½†çœ‹ä¸Šå» SC çš„æå‡åœ¨ easy æå‡å¾ˆæ˜æ˜¾ï¼Œä½† Extra Hard å°±æå‡æ²¡é‚£ä¹ˆå¤šã€‚</p>
<p>è€Œä¸”å¯æ‰§è¡Œçš„æ¦‚ç‡ä¹Ÿç‰¹åˆ«é«˜ï¼Œé™¤éæ²¡æœ‰è¯­ä¹‰çŸ«æ­£ï¼Œéƒ½æ˜¯ 100%</p>
<p>è®ºæ–‡æåˆ° not designed for logical form accuracyï¼Ÿ</p>
<p>è¿è¡Œé€Ÿåº¦ä¹Ÿå¾ˆå¿«ï¼Œååé‡ä¹Ÿå¾ˆå¤§ã€‚</p>
<h3 id="single-domain-evaluation-results">Single-Domain Evaluation Results</h3>
<p>æ¯” rule based ä¹Ÿè¦å¥½ï¼Œä½†æ˜¯åœ¨ IMDB ä¸Šè¡¨ç°æ¯”è¾ƒå·®ï¼Œä½†ä¹Ÿæ¯”å…¶ä»–éƒ½å¥½</p>
<blockquote>
<p>ä½¿ç”¨çš„æ˜¯ Spider æ•°æ®è®­ç»ƒï¼Œåœ¨ IMDB ä¸Šè¡¨ç°å·®æ˜¯å› ä¸ºå¾ˆå¤š join rules ä¸å¤ªé€‚ç”¨ï¼Ÿ</p>
</blockquote>
<h3 id="throughput-analysis">Throughput analysis</h3>
<p>ååé‡é«˜çš„åŸå› ï¼Œç”¨äº†å°çš„æ¨¡å‹ GraPPaï¼Œæ‰€ä»¥ä¹Ÿæ›´å¿«ã€‚è€Œä¸”åœ¨ decoding æ—¶ï¼Œä¸€ä¸ª CAT ç”Ÿæˆä¸€ç»„ slotsï¼Œå¯ä»¥å¤§å¹…å¹¶è¡Œã€‚å¯ä»¥å¹¶è¡Œå¤„ç† 11 ä¸ªæŸ¥è¯¢ï¼Œ</p>
<h3 id="case-study">Case Study</h3>
<p>åˆ†æäº†å‡ ä¸ªç”¨ä¾‹ï¼Œæ¯”è¾ƒæœ‰è¶£çš„æ˜¯æ²¡æ³•ç”Ÿæˆ AVG() è¿™ç§ï¼Œè€Œæ˜¯ç›´æ¥ select averageï¼Œä½†æ˜¯è¡¨å¸¦æœ‰ average åˆ—ï¼Ÿ</p>
<p>è¿˜æœ‰å°±æ˜¯ Column Action Template ä¼š flatten conjunction å…³ç³» å¯¼è‡´æ— æ³•ç”Ÿæˆåˆé€‚çš„ SQL æ¥é€‰å– OR å…³ç³»ã€‚</p>
<p>è®ºæ–‡è®¤ä¸ºå¯ä»¥å¤šè®­ç»ƒ This problem could be possibly handled by either collecting more training data containing queries with complex conjunction relationships, or designing new architecture to predict logical operations explicitly. Both approaches are challenging to implement and require high-quality manual labels. We leave this issue as a further research to study</p>
<blockquote>
<p>å¤šè®­ç»ƒæ˜¯åˆç†çš„ï¼Œä¸çŸ¥é“å¾®è°ƒ GraPPa èƒ½ä¸èƒ½é¢„æµ‹ä¸€äº› conjunction å…³ç³»</p>
</blockquote>
<h2 id="related-work">RELATED WORK</h2>
<p>æåˆ°äº† GraPPa éå¸¸æœ‰ç”¨</p>
<h2 id="conclusion">CONCLUSION</h2>
<p>ç•¥</p>
<blockquote>
<p>åå­—éå¸¸å¥½ç©ï¼Œä» RatSQL åˆ° CatSQLï¼Œä½†å®é™…ä¸Šè®ºæ–‡æ²¡æœ‰å¤ªå¤šæ¯”è¾ƒ RatSQL ç”šè‡³ RatSQL åªç”¨äº† BERT æ¥ä½œä¸º baseline</p>
<p>ä¹Ÿéå¸¸åˆ›æ–°åœ°åˆ©ç”¨ RL ä»ç¿»è¯‘å˜æˆäº†å®Œå½¢å¡«ç©ºï¼Œè€Œä¸”ç”¨ LLM å¯ä»¥é¢„æµ‹ä¸Šä¸‹æ–‡çš„èƒ½åŠ›è¿›è¡Œå…³è”ï¼Œéå¸¸å·§å¦™</p>
<p>è€Œä¸”ç”¨ Semantic Correction å¯ä»¥åå¤„ç†è¿™äº›å¯èƒ½é”™è¯¯çš„è¯­ä¹‰ï¼Œåªæ˜¯è¿˜æœ‰ä¸€äº›ç¼ºé™·ï¼Œæ–‡ä¸­ä¹Ÿè¯´è®­ç»ƒä¹Ÿå¯èƒ½å¯ä»¥è§£å†³ã€‚</p>
<p>çœ‹äº†ä¸‹ç›®å‰ CatSQL 78 åˆ† Accğ‘’ğ‘¥ å¹¶ä¸ç®—é«˜çš„ï¼Œé˜¿é‡Œåé¢çš„ DAIL-SQL + GPT-4 å’Œ DAIL-SQL + GPT-4 + Self-Consistency åˆ·åˆ°äº† 86 åˆ†ã€‚ç”šè‡³æœ‰åŒ¿åçš„ MiniSeek åˆ·åˆ°äº† 91 åˆ†ï¼Œå¯èƒ½ GPT å‚æ•°æ›´å¤§ï¼Œè¿˜æ˜¯è¦æ›´å¼ºå§ã€‚</p>
<p>åŒæ—¶æœ€è¿‘è¿˜æœ‰æ–°çš„ benchmark BIRD-SQL æ˜¯é˜¿é‡Œå’Œæ¸¯å¤§ä¸€èµ·æ¨å‡ºçš„ï¼Œ</p>
<p>Summarize</p>
<p>The paper propose a novel framework called CatSQL, which tackles the challenge of translating natural language questions into SQL queries. While existing systems like rule-based and deep-learning-based cannot handle cross-domain datasets or donot use the database information, CatSQL creatively combines two approaches. CatSQL leverages the contextual prediction capabilities of language models such as GraPPa to enable parameter sharing based on a sketch-based method and can generate more accurate SQL statements with semantics correction. In addition, CatSQL not only exhibits better accuracy, it is also faster and has greater throughput.</p>
<p>Contributions:</p>
<ol>
<li>CatSQL innovatively bridges two existing Text-to-SQL approaches (deep-learning and rule-based) and overcomes their problems, for example, rule-based emthods are almost exclusively used for single-domain datasets. CatSQL also turns the existing Deep Learning translation task into a filling task with faster runtime and higher throughput.</li>
<li>CatSQL applies sketches to construct a SQL statement template with slots and placeholders, and then uses deep learning model like GraPPa to fill the slots with meaningful content based on the database schema. The method is called parameter sharing and can reduce the computational complexity and improve generalization capability and flexibility.</li>
<li>The paper proposes a semantic correction technique to identify and correct semantic errors in the generated SQL queries with database domain knowledge. The method can detect erros on token level, FROM clause level and join-path level, improving the exact set match accuracy and obtaining a significant improvement over baseline models (RAT-SQL with BERT model).</li>
</ol>
<p>Limitations:</p>
<ol>
<li>CatSQL would be very dependent on the performance of deep learning models, although the paper compares Rat-SQL, which is using the BERT model. If the GraPPa model is also used, RAT-SQL as a baseline will also perform better. And from the current Spider Leader Board, the front runners are using larger models like GPT-4, and the score is much higher than CatSQL, at 86 (DAIL-SQL + GPT-4).</li>
<li>The paper says that CatSQL doesn&rsquo;t focus on accuracy, but no attempt is made to solve the problems encountered in the Case Study such as conjunction and column name confusion by more training, or by switching to a larger model.</li>
<li>The method Semantic correction is post-processed and could be improved if it can be performed when reasoning or generating SQL statements. In addition, when new benchmarks come out, such as BIRD, which can better evaluate a model&rsquo;s ability to work across data domains, and CatSQL might need to be retrained to achieve better performance.</li>
</ol>
<p>Improve:</p>
<p>This paper is very innovative and methodologically sound. I might try to replace the language model with a larger one at first, possibly with more parameters capable of stronger context and parameter sharing. And I may do more model training to try to solve the problems in cast study, especially conjunction errors and semantic obfuscation. In addition, perhaps the ChatGPT fine-tuning approach, or Reinforcement Learning Human Feedback (RLHF) could also help CatSQL to achieve higher accuracy. Finally, I would try to run the modified model on more benchmarks for evaluation, especially on the BIRD benchmark.</p>
</blockquote>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>æ›´æ–°äº 2024-04-14</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="åˆ†äº«åˆ° Twitter" data-sharer="twitter" data-url="https://ad-bean.github.io/posts/catsql-nlsql/" data-title="Paper Reading: CatSQL: Towards Real World Natural Language to SQL Applications [VLDB 23]" data-hashtags="Paper Reading"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° Facebook" data-sharer="facebook" data-url="https://ad-bean.github.io/posts/catsql-nlsql/" data-hashtag="Paper Reading"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° Hacker News" data-sharer="hackernews" data-url="https://ad-bean.github.io/posts/catsql-nlsql/" data-title="Paper Reading: CatSQL: Towards Real World Natural Language to SQL Applications [VLDB 23]"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° Line" data-sharer="line" data-url="https://ad-bean.github.io/posts/catsql-nlsql/" data-title="Paper Reading: CatSQL: Towards Real World Natural Language to SQL Applications [VLDB 23]"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° å¾®åš" data-sharer="weibo" data-url="https://ad-bean.github.io/posts/catsql-nlsql/" data-title="Paper Reading: CatSQL: Towards Real World Natural Language to SQL Applications [VLDB 23]"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="../../tags/paper-reading/">Paper Reading</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">è¿”å›</a></span>&nbsp;|&nbsp;<span><a href="../../">ä¸»é¡µ</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="../../posts/learned-sorting/" class="prev" rel="prev" title="Paper Reading: The Case for a Learned Sorting Algorithm [SIGMOD 2020]"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>Paper Reading: The Case for a Learned Sorting Algorithm [SIGMOD 2020]</a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">ç”± <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.121.1">Hugo</a> å¼ºåŠ›é©±åŠ¨ | ä¸»é¢˜ - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2022 - 2024</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://github.com/ad-bean" target="_blank">Adbean</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="å›åˆ°é¡¶éƒ¨">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="æŸ¥çœ‹è¯„è®º">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js"></script><script type="text/javascript" src="../../lib/lunr/lunr.stemmer.support.min.js"></script><script type="text/javascript" src="../../lib/lunr/lunr.zh.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"å¤åˆ¶åˆ°å‰ªè´´æ¿","maxShownLines":50},"comment":{},"search":{"highlightTag":"em","lunrLanguageCode":"zh","lunrSegmentitURL":"/lib/lunr/lunr.segmentit.js","maxResultLength":10,"noResultsFound":"æ²¡æœ‰æ‰¾åˆ°ç»“æœ","snippetLength":50}};</script><script type="text/javascript" src="../../js/theme.min.js"></script></body>
</html>
