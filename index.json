[{"categories":null,"content":"10-714: Homework 0 build a basic softmax regression algorithm, plus a simple two-layer neural network github hw0 ","date":"2025-03-04","objectID":"/posts/ml-sys-hw0/:1:0","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ hw0","uri":"/posts/ml-sys-hw0/"},{"categories":null,"content":"Question 1: A basic add function, and testing/autograding basics plement simple_ml.add() function in src/simple_ml.py testing: !python3 -m pytest -k \"add\" æ ¹æ®æµ‹è¯•ï¼Œç”±äº add(x, y) ä¼ å…¥çš„å‚æ•°å¯ä»¥æ˜¯ä»»æ„ç±»å‹ï¼Œåˆ™ç›´æ¥è¿”å› return x + y æ²¡æœ‰æ³¨å†Œ mugrade ç­‰ autograde systemï¼Œæ‰€ä»¥å°±åŸºæœ¬è·‘æœ¬åœ°çš„æµ‹è¯•äº† ","date":"2025-03-04","objectID":"/posts/ml-sys-hw0/:1:1","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ hw0","uri":"/posts/ml-sys-hw0/"},{"categories":null,"content":"Question 2: Loading MNIST data parse_mnist_data() function def parse_mnist(image_filename, label_filename): \"\"\" Read an images and labels file in MNIST format. See this page: http://yann.lecun.com/exdb/mnist/ for a description of the file format. Args: image_filename (str): name of gzipped images file in MNIST format label_filename (str): name of gzipped labels file in MNIST format Returns: Tuple (X,y): X (numpy.ndarray[np.float32]): 2D numpy array containing the loaded data. The dimensionality of the data should be (num_examples x input_dim) where 'input_dim' is the full dimension of the data, e.g., since MNIST images are 28x28, it will be 784. Values should be of type np.float32, and the data should be normalized to have a minimum value of 0.0 and a maximum value of 1.0 (i.e., scale original values of 0 to 0.0 and 255 to 1.0). y (numpy.ndarray[dtype=np.uint8]): 1D numpy array containing the labels of the examples. Values should be of type np.uint8 and for MNIST will contain the values 0-9. \"\"\" æ³¨æ„è¿”å›çš„æ˜¯ Tuple ä½¿ç”¨ gzip æ‰“å¼€æ–‡ä»¶ gzip.open(image_filename, 'rb') å’Œ gzip.open(label_filename, 'rb') MNIST image_filename çš„æ ¼å¼ä¸º [magic number 32bits] [number of images 32bits] [number of rows 32bits] [number of columns 32bits] [... pixel] MNIST label_filename çš„æ ¼å¼ä¸º [magic number 32bits] [number of items 32bits] [...label] åˆ©ç”¨ struct.unpack('\u003eIIII', f.read(16)) è¯»å– image_file è¡¨ç¤º big-endian å¤§ç«¯è¯» 16 bytes è·å– magic, num_images, rows, cols ç„¶åä½¿ç”¨ img_data = np.frombuffer(f.read(), dtype=np.uint8) è·å–å‰©ä¸‹çš„å›¾åƒæ•°æ®ï¼ˆä¸€ç»´ï¼‰ï¼Œè¿›è¡Œ img_data.reshape(num_images, rows * cols) / 255.0 è½¬æˆäºŒç»´ åˆ©ç”¨ struct.unpack('\u003eII', f.read(8)) è¯»å– image_file è¡¨ç¤º big-endian å¤§ç«¯è¯» 8 bytes è·å– magic, num_items ç„¶åç”¨ y = np.frombuffer(f.read(), dtype=np.uint8) è·å–å‰©ä¸‹çš„æ ‡ç­¾æ•°æ® ","date":"2025-03-04","objectID":"/posts/ml-sys-hw0/:1:2","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ hw0","uri":"/posts/ml-sys-hw0/"},{"categories":null,"content":"Question 3: Softmax loss Implement the softmax (a.k.a. cross-entropy) loss as defined in softmax_loss() function in src/simple_ml.py. $$ \\begin{equation} \\ell_{\\mathrm{softmax}}(z, y) = \\log\\sum_{i=1}^k \\exp z_i - z_y. \\end{equation} $$ softmax_loss() takes a 2D array of logits (i.e., the $k$ dimensional logits for a batch of different samples), plus a corresponding 1D array of true labels, and should output the average softmax loss over the entire batch. Note that to do this correctly, you should not use any loops, but do all the computation natively with numpy vectorized operations (to set expectations here, we should note for instance that our reference solution consists of a single line of code). def softmax_loss(Z, y): \"\"\" Return softmax loss. Note that for the purposes of this assignment, you don't need to worry about \"nicely\" scaling the numerical properties of the log-sum-exp computation, but can just compute this directly. Args: Z (np.ndarray[np.float32]): 2D numpy array of shape (batch_size, num_classes), containing the logit predictions for each class. y (np.ndarray[np.uint8]): 1D numpy array of shape (batch_size, ) containing the true label of each example. Returns: Average softmax loss over the sample. \"\"\" æŒ‰ç…§å…¬å¼å®Œæˆå³å¯ï¼Œæ³¨æ„è¾“å…¥æ˜¯ Z (np.ndarray[np.float32]) (batch_size, num_classes) æ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ªæ ·æœ¬çš„ logitsï¼ˆé¢„æµ‹åˆ†æ•°ï¼‰ï¼Œy (np.ndarray[np.uint8]) æ˜¯å¯¹åº”çš„ label æ‹¿å‡º batch_size = Z.shape[0]ï¼Œæ ¹æ®å…¬å¼å†™å‡º np.log(np.sum(np.exp(Z), axis=1)) - Z[np.arange(batch_size), y] æœ€åè¿”å› np.mean(loss) np.arange(batch_size) ç”Ÿæˆä¸€ä¸ªä» 0 åˆ° batch_size-1 çš„æ•°ç»„ï¼Œè¿™æ ·å¯ä»¥å’Œ y é…åˆä» Z ä¸­æå–æ¯ä¸ªæ ·æœ¬çœŸå®ç±»åˆ«å¯¹åº”çš„ logitã€‚ ","date":"2025-03-04","objectID":"/posts/ml-sys-hw0/:1:3","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ hw0","uri":"/posts/ml-sys-hw0/"},{"categories":null,"content":"Question 4: Stochastic gradient descent for softmax regression implement stochastic gradient descent (SGD) for (linear) softmax regression. consider a hypothesis function that makes $n$-dimensional inputs to $k$-dimensional logits via the function $$ \\begin{equation} h(x) = \\Theta^T x \\end{equation} $$ where $x \\in \\mathbb{R}^n$ is the input, and $\\Theta \\in \\mathbb{R}^{n \\times k}$ are the model parameters the gradient of the linear softmax objective is given by $$ \\begin{equation} \\nabla_\\Theta \\ell_{\\mathrm{softmax}}(\\Theta^T x, y) = x (z - e_y)^T \\end{equation} \\ \\begin{equation} z = \\frac{\\exp(\\Theta^T x)}{1^T \\exp(\\Theta^T x)} \\equiv normalize(\\exp(\\Theta^T x)) \\end{equation} \\ $$ Using these gradients, implement the softmax_regression_epoch() function, which runs a single epoch of SGD (one pass over a data set) using the specified learning rate / step size lr and minibatch size batch. As described in the docstring, your function should modify the Theta array in-place. def softmax_regression_epoch(X, y, theta, lr = 0.1, batch=100): \"\"\" Run a single epoch of SGD for softmax regression on the data, using the step size lr and specified batch size. This function should modify the theta matrix in place, and you should iterate through batches in X _without_ randomizing the order. Args: X (np.ndarray[np.float32]): 2D input array of size (num_examples x input_dim). y (np.ndarray[np.uint8]): 1D class label array of size (num_examples,) theta (np.ndarrray[np.float32]): 2D array of softmax regression parameters, of shape (input_dim, num_classes) lr (float): step size (learning rate) for SGD batch (int): size of SGD minibatch Returns: None \"\"\" æŒ‰ç…§ batch å¤§å°éå†æ•°æ®é›†ï¼Œå…¶ä¸­ X.shape[0] æ˜¯ num_examples æ¯æ¬¡è·å¾— X[i : i+batch] è¾“å…¥å’Œ y[i : i+batch] ç›¸åº”çš„ label theta æ˜¯å‚æ•°çŸ©é˜µï¼Œåœ¨ numpy é‡Œç”¨ @ è¿›è¡ŒçŸ©é˜µä¹˜æ³• X_batch @ theta è®¡ç®— minibatch logits ä¹Ÿå°±æ˜¯é¢„æµ‹åˆ†æ•° æ ¹æ®å…¬å¼è®¡ç®— np.exp(logits) æ±‚å’Œå¹¶ä¸”è¿›è¡Œ normalize å½’ä¸€åŒ– One-hot ç¼–ç ï¼šå½’ä¸€åŒ–ç»“æœ one_hot = [np.arange(X_batch.shape[0]), y_batch] = 1.0 å°±å¾—åˆ°äº†æ ‡ç­¾çš„çš„ç¼–ç ã€‚ è¿™é‡Œæ˜¯ python çš„è¯­æ³•ï¼Œnp.arange(X_batch.shape[0]) åˆ›å»ºä¸€ä¸ªå¤§å°ä¸ºå‚æ•°çš„æ•°ç»„ï¼Œå¹¶ä¸”ä» 0 å¼€å§‹ï¼Œä¹Ÿå°±æ˜¯è¡Œç´¢å¼•ï¼Œè€Œ y_batch åˆ™æ˜¯æ ‡ç­¾çš„ç´¢å¼•ï¼Œåˆ—ç´¢å¼•ã€‚ æ¢¯åº¦è®¡ç®—ï¼šgrad = (X_batch.T @ (probs - one_hot)) / X_batch.shape[0] æ¢¯åº¦å…¬å¼ $\\frac{1}{m} X^T (Z - I_y)$ modify the Theta array in-place: theta -= lr * grad å…¶ä¸­ lr å°±æ˜¯å­¦ä¹ ç‡ $\\theta_{\\text{new}} = \\theta - \\eta \\cdot \\text{grad}$ Training MNIST with softmax regression: For reference, as seen below, our implementation runs in ~3 seconds on Colab, and achieves 7.97% error. ","date":"2025-03-04","objectID":"/posts/ml-sys-hw0/:1:4","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ hw0","uri":"/posts/ml-sys-hw0/"},{"categories":null,"content":"Question 5: SGD for a two-layer neural network def nn_epoch(X, y, W1, W2, lr = 0.1, batch=100): \"\"\" Run a single epoch of SGD for a two-layer neural network defined by the weights W1 and W2 (with no bias terms): logits = ReLU(X * W1) * W2 The function should use the step size lr, and the specified batch size (and again, without randomizing the order of X). It should modify the W1 and W2 matrices in place. Args: X (np.ndarray[np.float32]): 2D input array of size (num_examples x input_dim). y (np.ndarray[np.uint8]): 1D class label array of size (num_examples,) W1 (np.ndarray[np.float32]): 2D array of first layer weights, of shape (input_dim, hidden_dim) W2 (np.ndarray[np.float32]): 2D array of second layer weights, of shape (hidden_dim, num_classes) lr (float): step size (learning rate) for SGD batch (int): size of SGD minibatch Returns: None \"\"\" consider a two-layer neural network (without bias terms) of the form $$ z = W_2^T \\mathrm{ReLU}(W_1^T x) $$ where $W_1 \\in \\mathbb{R}^{n \\times d}$ and $W_2 \\in \\mathbb{R}^{d \\times k}$ represent the weights of the network (which has a $d$-dimensional hidden unit), and where $z \\in \\mathbb{R}^k$ represents the logits output by the network. again use the softmax / cross-entropy loss, meaning that we want to solve the optimization problem $$ minimize_{W_1, W_2} ;; \\frac{1}{m} sum_{i=1}^m \\ell_{\\mathrm{softmax}}(W_2^T \\mathrm{ReLU}(W_1^T x^{(i)}), y^{(i)}) $$ Using the chain rule, we can derive the backpropagation updates for this network $$ \\begin{equation} \\begin{split} Z_1 \\in \\mathbb{R}^{m \\times d} \u0026 = \\mathrm{ReLU}(X W_1) \\ G_2 \\in \\mathbb{R}^{m \\times k} \u0026 = normalize(\\exp(Z_1 W_2)) - I_y \\ G_1 \\in \\mathbb{R}^{m \\times d} \u0026 = \\mathrm{1}{Z_1 \u003e 0} \\circ (G_2 W_2^T) \\end{split} \\end{equation} $$ ç›¸æ¯” SGDï¼Œ2 layer çš„å®ç°ä¹Ÿå¾ˆç±»ä¼¼ï¼Œä½†éœ€è¦å®ç° forward å’Œ backpropï¼Œä»¥åŠé“¾å¼æ³•åˆ™ $$ \\text{softmax}(zi) = \\frac{\\exp(z_i)}{\\sum{j=1}^{k} \\exp(z_j)} $$ ReLU çš„è¯¯å·®è®¡ç®—ï¼š $$ \\nabla_{W_1} \\ell_{\\mathrm{softmax}}(\\mathrm{ReLU}(X W_1) W_2, y) = \\frac{1}{m} X^T G_1 \\ G_1 \\in \\mathbb{R}^{m \\times d} = \\mathrm{1}{Z_1 \u003e 0} \\circ (G_2 W_2^T) $$ def nn_epoch(X, y, W1, W2, lr=0.1, batch=100): m = X.shape[0] for i in range(0, m, batch): X_batch = X[i : i + batch] y_batch = y[i : i + batch] m_batch = X_batch.shape[0] # forward, ReLU(XW1)W2, np.maximum(0, ...) æ˜¯ ReLU çš„å®ç°å½¢å¼ Z1 = np.maximum(0, X_batch @ W1) logits = Z1 @ W2 # è®¡ç®— softmax è¾“å‡º exp_logits = np.exp(logits) sums = np.sum(exp_logits, axis=1, keepdims=True) probs = exp_logits / sums # ç¼–ç  one_hot = np.zeros_like(probs) one_hot[np.arange(m_batch), y_batch] = 1.0 # backprop # G2: ç¼–ç åçš„ softmax - label G2 = probs - one_hot # W2æ¢¯åº¦: (Z1^T @ G2) / m_batch. gradW2 = (Z1.T @ G2) / m_batch # Propagate the gradients back through the ReLU nonlinearity. # (Z1 \u003e 0) is the indicator of activated neurons. # ReLU åå‘ä¼ æ’­ï¼ŒZ1 å¤§äº 0 è¡¨ç¤ºæ¿€æ´» G1 = (G2 @ W2.T) * (Z1 \u003e 0) # Gradient for W1: (X_batch^T @ G1) / m_batch. gradW1 = (X_batch.T @ G1) / m_batch # inplace åŸåœ°æ›´æ–° W1 -= lr * gradW1 W2 -= lr * gradW2 Training a full neural network: trains a two-layer network with 400 hidden units. import sys # Reload the simple_ml module which has been cached from the earlier experiment import importlib import simple_ml importlib.reload(simple_ml) sys.path.append(\"src/\") from simple_ml import train_nn, parse_mnist X_tr, y_tr = parse_mnist(\"data/train-images-idx3-ubyte.gz\", \"data/train-labels-idx1-ubyte.gz\") X_te, y_te = parse_mnist(\"data/t10k-images-idx3-ubyte.gz\", \"data/t10k-labels-idx1-ubyte.gz\") train_nn(X_tr, y_tr, X_te, y_te, hidden_dim=400, epochs=20, lr=0.2) it achieve an error of 1.89% on MNIST. ","date":"2025-03-04","objectID":"/posts/ml-sys-hw0/:1:5","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ hw0","uri":"/posts/ml-sys-hw0/"},{"categories":null,"content":"Question 6: Softmax regression in C++ pybind11, a header-only library, which allows you to implement the entire Python/C++ interface within a single C++ source library void softmax_regression_epoch_cpp(const float *X, const unsigned char *y, float *theta, size_t m, size_t n, size_t k, float lr, size_t batch) { } it requires passing some additional arguments because we are operating on raw pointers to the array data rather than any sort of higher-level â€œmatrixâ€ data structure. Specifically, X, y, and theta are pointers to the raw data of the corresponding numpy arrays from the previous section; for 2D arrays, these are stored in C-style (row-major) format, meaning that the first row of $X$ is stored sequentially as the first bytes in X, then the second row, etc (this contrasts with column major ordering, which stores the first column of the matrirx sequentially, then the second column, etc). row major è¡Œå­˜å‚¨ As an illustration of how to access the data, note that because X represents a row-major, $m \\times n$ matrix, if we want to access the $(i,j)$ element of $X$ (the element in the $i$th row and the $j$th column), we would use the index X[i*n + j] pybind11 code that actually provides the Python interface, this code essentially just extracts the raw pointers from the provided inputs (using pybinds numpy interface), and then calls the corresponding softmax_regression_epoch_cpp function. PYBIND11_MODULE(simple_ml_ext, m) { m.def(\"softmax_regression_epoch_cpp\", [](py::array_t\u003cfloat, py::array::c_style\u003e X, py::array_t\u003cunsigned char, py::array::c_style\u003e y, py::array_t\u003cfloat, py::array::c_style\u003e theta, float lr, int batch) { softmax_regression_epoch_cpp( static_cast\u003cconst float*\u003e(X.request().ptr), static_cast\u003cconst unsigned char*\u003e(y.request().ptr), static_cast\u003cfloat*\u003e(theta.request().ptr), X.request().shape[0], X.request().shape[1], theta.request().shape[1], lr, batch ); }, py::arg(\"X\"), py::arg(\"y\"), py::arg(\"theta\"), py::arg(\"lr\"), py::arg(\"batch\")); } ç›¸æ¯” pythonï¼Œç”¨ cpp å®ç° softmax regression çš„éš¾ç‚¹åœ¨äºçŸ©é˜µå¤§å°å’Œä¸‹æ ‡è®¿é—®ï¼š void softmax_regression_epoch_cpp(const float *X, const unsigned char *y, float *theta, size_t m, size_t n, size_t k, float lr, size_t batch) { for (size_t i = 0; i \u003c m; i += batch) { // m ä¸ªæ ·æœ¬ï¼Œæ¯æ¬¡ batch size_t currentBatch = std::min(batch, m - i); // å½“å‰ batch æ•°é‡ // Allocate a gradient buffer for theta (size n*k) and initialize to 0. float *grad = new float[n * k]; // std::memset(grad, 0, sizeof(float) * n * k); // process the minibatch for (size_t s = 0; s \u003c currentBatch; s++) { // forward: X_batch @ theta size_t exampleIdx = i + s; // logits = \\theta^T X, x \\in R^n, \\theta \\in R^{n x k} // logits \\in k dimension float *logits = new float[k]; // matrix multiplication // Compute logits = X[exampleIdx] dot theta, for each class j. for (size_t j = 0; j \u003c k; j++) { float dot = 0.0f; for (size_t l = 0; l \u003c n; l++) { // X is row-major: element (exampleIdx, l) // theta is row-major: element (l, j) dot += X[exampleIdx * n + l] * theta[l * k + j]; } logits[j] = dot; } // exp(logits) / np.sum(exp(logtis)) float sumExp = 0.0f; for (size_t j = 0; j \u003c k; j++) { logits[j] = std::exp(logits[j]); sumExp += logits[j]; } // one-hot encoding // compute the probability and the difference (error) // compared to the one-hot label indicator. for (size_t j = 0; j \u003c k; j++) { float prob = logits[j] / sumExp; // If j equals the true label then indicator is 1, else 0. float delta = prob - ( (j == static_cast\u003csize_t\u003e(y[exampleIdx])) ? 1.0f : 0.0f ); // Accumulate gradients for each feature. for (size_t l = 0; l \u003c n; l++) { grad[l * k + j] += X[exampleIdx * n + l] * delta; } } delete[] logits; } // update theta in-place // mean gradients over the mini-batch and update theta // divide by float(currentBatch) to avoid integer division issues for (size_t l = 0; l \u003c n; l++) { for (size_t j = 0; j \u003c k; j++) { theta[l*k + j] -= lr * (grad[l*k + j] / static_cast\u003cfloat\u003e(currentBatch)); } } delete[] grad; } } ","date":"2025-03-04","objectID":"/posts/ml-sys-hw0/:1:6","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ hw0","uri":"/posts/ml-sys-hw0/"},{"categories":null,"content":"Automatic Differentiation hypothesis class: $x \\rightarrow h_\\theta(x)$, MLP loss function(cross-entropy loss): $\\ell(x, y) = -h_y(x) + \\log \\sum_{j=1}^n \\exp(h_j(x))$ optimization method: $\\theta := \\theta - \\alpha \\nabla_\\theta \\ell$ æœºå™¨å­¦ä¹ /æ·±åº¦å­¦ä¹ æ˜¯å¦å°±æ˜¯åœ¨å­¦ä¹ å‚æ•°é›†åˆ $\\theta$? é™¤äº† SGD éšæœºæ¢¯åº¦ä¸‹é™ï¼Œè¿˜æœ‰ Adam ç­‰ä¼˜åŒ–æ–¹æ³• è®¡ç®— gradient æ˜¯ä¸€ä¸ªå¾ˆå¤æ‚çš„é—®é¢˜ï¼Œä½†æ˜¯ç°åœ¨æœ‰è‡ªåŠ¨å¾®åˆ† ","date":"2025-03-03","objectID":"/posts/ml-sys-03/:1:0","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 04 Automatic Differentiation","uri":"/posts/ml-sys-03/"},{"categories":null,"content":"Numerical differentiation $$ \\frac{\\partial f(\\theta)}{\\partial \\theta_i} = \\lim_{\\epsilon \\to 0} \\frac{f(\\theta + \\epsilon e_i) - f(\\theta)}{\\epsilon} \\ \\frac{\\partial f(\\theta)}{\\partial \\theta_i} \\approx \\frac{f(\\theta + \\epsilon e_i) - f(\\theta - \\epsilon e_i)}{2\\epsilon} + o(\\epsilon^2) $$ numerical error, less efficient to compute ä¸€èˆ¬ç”¨æ¥åš checkingï¼Ÿ ","date":"2025-03-03","objectID":"/posts/ml-sys-03/:2:0","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 04 Automatic Differentiation","uri":"/posts/ml-sys-03/"},{"categories":null,"content":"Numerical gradient checking $$ \\frac{\\partial f(\\theta)}{\\partial \\theta_i} \\approx \\frac{f(\\theta + \\epsilon \\delta) - f(\\theta - \\epsilon \\delta)}{2\\epsilon} $$ æ£€æŸ¥ auto differentiation algo æ˜¯å¦æ­£ç¡® ","date":"2025-03-03","objectID":"/posts/ml-sys-03/:3:0","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 04 Automatic Differentiation","uri":"/posts/ml-sys-03/"},{"categories":null,"content":"Symbolic differentiation $$ \\frac{\\partial (f(\\theta) + g(\\theta))}{\\partial \\theta} = \\frac{\\partial f}{\\partial \\theta} + \\frac{\\partial g}{\\partial \\theta} $$ $$ \\frac{\\partial (f(\\theta) g(\\theta))}{\\partial \\theta} = g(\\theta) \\frac{\\partial f}{\\partial \\theta} + f(\\theta) \\frac{\\partial g}{\\partial \\theta} $$ $$ \\frac{\\partial f(g(\\theta))}{\\partial \\theta} = \\frac{\\partial f(g)}{\\partial g(\\theta)} \\cdot \\frac{\\partial g(\\theta)}{\\partial \\theta} $$ å›é¡¾åå¾®åˆ†æ³•åˆ™ wasted computation: $$ f(\\theta) = \\prod_{i=1}^n \\theta_i $$ ä¸ºäº†é¿å…å†—ä½™ï¼Œç°ä»£æœºå™¨å­¦ä¹ å’Œè®¡ç®—å·¥å…·ä½¿ç”¨äº†è‡ªåŠ¨å¾®åˆ†ï¼ˆAutomatic Differentiationï¼‰ è¿™ä¸ªå‡½æ•°æ±‚åå¯¼ï¼Œä¼šæœ‰å¾ˆå¤šé‡å¤çš„ä¹˜ç§¯ï¼Œå¯ä»¥ç”¨è‡ªåŠ¨å¾®åˆ†å’Œè®¡ç®—å›¾ç¼“å­˜ä¸­é—´ç»“æœ ","date":"2025-03-03","objectID":"/posts/ml-sys-03/:4:0","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 04 Automatic Differentiation","uri":"/posts/ml-sys-03/"},{"categories":null,"content":"Computational graph $$ y = \\ln(x_1) + x_1 \\cdot x_2 - \\sin(x_2) $$ ä¸­é—´ç»“æœ ","date":"2025-03-03","objectID":"/posts/ml-sys-03/:5:0","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 04 Automatic Differentiation","uri":"/posts/ml-sys-03/"},{"categories":null,"content":"Forward mode automatic differentiation (AD) it automatically propagates gradients through a computational graph based on the mathematical operations involved. ä¸éœ€è¦æ‰‹åŠ¨è®¡ç®—æ¢¯åº¦ è®¡ç®—äº†å¾ˆå¤šä¸­é—´å€¼ ","date":"2025-03-03","objectID":"/posts/ml-sys-03/:6:0","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 04 Automatic Differentiation","uri":"/posts/ml-sys-03/"},{"categories":null,"content":"Limitation of forward mode AD å¯¹äºå‡½æ•° $f: \\mathbb{R}^n \\to \\mathbb{R}^k$ ï¼Œå‰å‘æ¨¡å¼è‡ªåŠ¨å¾®åˆ†éœ€è¦ n æ¬¡ä¼ é€’ æ¥è®¡ç®—è¾“å‡ºå¯¹æ‰€æœ‰ n ä¸ªè¾“å…¥å˜é‡çš„æ¢¯åº¦ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºæ¯ä¸ªè¾“å…¥å˜é‡ $(x_1, x_2, \\ldots, x_n )$ï¼Œéœ€è¦å•ç‹¬è¿›è¡Œä¸€æ¬¡è®¡ç®—ï¼Œä»¥è¿½è¸ªè¾“å‡ºéšç€è¯¥è¾“å…¥çš„å˜åŒ–ã€‚ åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå½“ $k = 1$ ï¼ˆæ ‡é‡è¾“å‡ºï¼Œä¾‹å¦‚æœºå™¨å­¦ä¹ ä¸­çš„æŸå¤±å‡½æ•°ï¼‰ä¸” $n$ å¾ˆå¤§æ—¶ï¼ˆå¦‚ç¥ç»ç½‘ç»œçš„æƒé‡æ•°é‡åºå¤§ï¼‰ï¼Œå‰å‘æ¨¡å¼ä¼šæ˜¾å¾— è®¡ç®—æˆæœ¬è¾ƒé«˜ä¸”æ•ˆç‡ä½ä¸‹ï¼Œå› ä¸ºå®ƒçš„è®¡ç®—æˆæœ¬éšç€è¾“å…¥æ•°é‡ $n$ çš„å¢åŠ çº¿æ€§å¢é•¿ã€‚ We mostly care about the cases where $k = 1$ and large $n$ . In order to resolve the problem efficiently, we need to use another kind of AD ","date":"2025-03-03","objectID":"/posts/ml-sys-03/:7:0","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 04 Automatic Differentiation","uri":"/posts/ml-sys-03/"},{"categories":null,"content":"Reverse mode automatic differentiation(AD) Adjoint: $\\bar{v}_i = \\frac{\\partial y}{\\partial v_i}$ æ¯ä¸ªå˜é‡çš„å¯¼æ•°ï¼Œä½†æ˜¯åå‘è®¡ç®— Reverse Mode ä¸€æ¬¡åå‘ä¼ é€’å³å¯è®¡ç®—å‡º æ ‡é‡è¾“å‡ºå¯¹æ‰€æœ‰è¾“å…¥çš„æ¢¯åº¦ï¼Œé€‚ç”¨äº $f: \\mathbb{R}^n \\to \\mathbb{R}^1$ çš„æƒ…å†µï¼ˆä¾‹å¦‚æœºå™¨å­¦ä¹ ä¸­çš„æŸå¤±å‡½æ•°ï¼‰ã€‚ ","date":"2025-03-03","objectID":"/posts/ml-sys-03/:8:0","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 04 Automatic Differentiation","uri":"/posts/ml-sys-03/"},{"categories":null,"content":"Derivation for the multiple pathway case multiple pathways $$ v_1 \\ y = f(v_2, v_3) \\ \\frac{\\partial y}{\\partial v_1} = \\frac{\\partial f(v_2, v_3)}{\\partial v_2} \\cdot \\frac{\\partial v_2}{\\partial v_1} + \\frac{\\partial f(v_2, v_3)}{\\partial v_3} \\cdot \\frac{\\partial v_3}{\\partial v_1} $$ partial adjoint: $v_i \\rightarrow v_j = \\bar{v}_j \\cdot \\frac{\\partial v_j}{\\partial v_i}$ $$ \\bar{v}i = \\sum{j \\in \\text{next}(i)} v_i \\rightarrow v_j $$ We can compute partial adjoints separately then sum them together è‡ªåŠ¨å¾®åˆ†ï¼ˆautomatic differentiationï¼‰çš„èƒŒæ™¯ä¸‹ï¼Œé’ˆå¯¹å¤šè·¯å¾„è®¡ç®—åœºæ™¯çš„åå¯¼æ•°çš„æ¨å¯¼ ç”¨äºè¡¨ç¤º Reverse AD ç®—æ³• ","date":"2025-03-03","objectID":"/posts/ml-sys-03/:9:0","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 04 Automatic Differentiation","uri":"/posts/ml-sys-03/"},{"categories":null,"content":"Reverse AD algorithm node_to_grad è®°å½• partial adjoint ç”¨äºç¼“å­˜ ","date":"2025-03-03","objectID":"/posts/ml-sys-03/:10:0","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 04 Automatic Differentiation","uri":"/posts/ml-sys-03/"},{"categories":null,"content":"Reverse mode AD by extending computational graph computational graph æ‹“å±• ","date":"2025-03-03","objectID":"/posts/ml-sys-03/:11:0","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 04 Automatic Differentiation","uri":"/posts/ml-sys-03/"},{"categories":null,"content":"Reverse mode AD vs Backprop ","date":"2025-03-03","objectID":"/posts/ml-sys-03/:12:0","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 04 Automatic Differentiation","uri":"/posts/ml-sys-03/"},{"categories":null,"content":"Backprop Run backward operations the same forward graph Used in first generation deep learning frameworks (caffe, cuda-convnet) ","date":"2025-03-03","objectID":"/posts/ml-sys-03/:12:1","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 04 Automatic Differentiation","uri":"/posts/ml-sys-03/"},{"categories":null,"content":"Reverse mode AD by extending computational graph Construct separate graph nodes for adjoints Used by modern deep learning frameworks æ‰€ä»¥ reverse mode AD è‡ªåŠ¨å¾®åˆ†å°±æ˜¯ç¼“å­˜äº†ä¸€äº›å…¶ä¸­çš„ç»“æœï¼Œç”¨ adjoints æ¥è¡¨ç¤º æ¯æ¬¡è®¡ç®—å°±ä¸éœ€è¦å®Œå…¨é‡æ–°è®¡ç®—æ¢¯åº¦ã€æ‰©å±•çš„å›¾ ","date":"2025-03-03","objectID":"/posts/ml-sys-03/:12:2","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 04 Automatic Differentiation","uri":"/posts/ml-sys-03/"},{"categories":null,"content":"Reverse mode AD on Tensors Define adjoint for tensor values $$ \\bar{Z} = \\frac{\\partial y}{\\partial Z} = \\begin{bmatrix} \\frac{\\partial y}{\\partial Z_{1,1}} \u0026 \\cdots \u0026 \\frac{\\partial y}{\\partial Z_{1,n}} \\ \\vdots \u0026 \\ddots \u0026 \\vdots \\ \\frac{\\partial y}{\\partial Z_{m,1}} \u0026 \\cdots \u0026 \\frac{\\partial y}{\\partial Z_{m,n}} \\end{bmatrix} $$ Tensor è®¡ç®—ï¼Œreverse mode AD çš„å‘é‡è¡¨è¾¾ ä¸‹ä¸€å¼ å°†è®¨è®ºå®ç° pros/cons of backprop and reverse mode AD: ","date":"2025-03-03","objectID":"/posts/ml-sys-03/:13:0","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 04 Automatic Differentiation","uri":"/posts/ml-sys-03/"},{"categories":null,"content":"Handling gradient of gradient The result of reverse mode AD is still a computational graph We can extend that graph further by composing more operations and run reverse mode AD again on the gradient ","date":"2025-03-03","objectID":"/posts/ml-sys-03/:14:0","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 04 Automatic Differentiation","uri":"/posts/ml-sys-03/"},{"categories":null,"content":"Reverse mode AD on data structures Key take away: Define â€œadjoint valueâ€ usually in the same data type as the forward value and adjoint propagation rule. Then the sample algorithm works ","date":"2025-03-03","objectID":"/posts/ml-sys-03/:15:0","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 04 Automatic Differentiation","uri":"/posts/ml-sys-03/"},{"categories":null,"content":"Efficient Large-Scale Language Model Training on GPU Clusters Using Megatron-LM å§‘ä¸”ç®—ä½œ Megatron LM v2ï¼Œå› ä¸ºæ˜¯æ™šä¸€å¹´å‘è¡¨çš„ï¼Œç²—ç•¥è¿‡ä¸€ä¸‹ï¼Œå› ä¸ºéƒ½æ˜¯åŒæ ·çš„ motivation å’Œ background ç­‰ç­‰ çŸ¥ä¹ä¸€ç¯‡ä¸é”™çš„æ€»ç»“ ä½œè€… Jared çš„è§†é¢‘ä»‹ç» å…¶ä¸­å’Œ ZeRO çš„å¯¹æ¯”å¾ˆæœ‰æ„æ€ï¼Œååé‡é«˜äº†å¾ˆå¤šã€‚å‘¨æœ«çœ‹çœ‹ Gpipe å’Œ ZeRO ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm-v2/:1:0","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Efficient Large-Scale Language Model Training on GPU Clusters Using Megatron-LM","uri":"/posts/paper-megatron-lm-v2/"},{"categories":null,"content":"ABSTRACT æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å±•ç¤ºäº†å¦‚ä½•å°†å¼ é‡å¹¶è¡Œã€æµæ°´çº¿å¹¶è¡Œå’Œæ•°æ®å¹¶è¡Œç»“åˆèµ·æ¥ï¼Œä»¥æ‰©å±•åˆ°æ•°åƒä¸ª GPUã€‚ æå‡ºäº†ä¸€ç§æ–°é¢–çš„äº¤é”™æµæ°´çº¿è°ƒåº¦æ–¹æ³•ï¼Œå¯ä»¥åœ¨å†…å­˜å ç”¨ä¸ç°æœ‰æ–¹æ³•ç›¸å½“çš„æƒ…å†µä¸‹ï¼Œå°†ååé‡æé«˜ 10%ä»¥ä¸Šã€‚ ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm-v2/:2:0","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Efficient Large-Scale Language Model Training on GPU Clusters Using Megatron-LM","uri":"/posts/paper-megatron-lm-v2/"},{"categories":null,"content":"INTRODUCTION æ•°æ®å¹¶è¡Œæ‰©å±•é€šå¸¸æ•ˆæœè‰¯å¥½ï¼Œä½†å­˜åœ¨ä¸¤ä¸ªå±€é™æ€§ï¼š beyond a point, the per-GPU batch size becomes too small, reducing GPU utilization and increasing communication cost the maximum number of devices that can be used is the batch size, limiting the number of accelerators that can be used for training. æ¨¡å‹å¹¶è¡ŒæŠ€æœ¯ã€å¼ é‡ï¼ˆå±‚å†…ï¼‰æ¨¡å‹å¹¶è¡ŒåŒ– å¼ é‡å¹¶è¡Œæ‰€éœ€çš„ all-reduce é€šä¿¡éœ€è¦é€šè¿‡æœåŠ¡å™¨é—´é“¾è·¯ï¼Œè¿™äº›é“¾è·¯æ¯”å¤š GPU æœåŠ¡å™¨å†…å¯ç”¨çš„é«˜å¸¦å®½ NVLink[9]æ…¢ï¼› é«˜åº¦çš„æ¨¡å‹å¹¶è¡ŒåŒ–å¯èƒ½ä¼šäº§ç”Ÿå°çš„çŸ©é˜µä¹˜æ³•ï¼ˆGEMMsï¼‰ï¼Œå¯èƒ½ä¼šé™ä½ GPU åˆ©ç”¨ç‡ã€‚ Pipeline model parallelism æµæ°´çº¿æ¨¡å‹å¹¶è¡ŒåŒ–ï¼Œä¸€ä¸ªæ‰¹æ¬¡è¢«æ‹†åˆ†ä¸ºè¾ƒå°çš„å¾®æ‰¹æ¬¡ï¼Œæ‰§è¡Œè¿‡ç¨‹åœ¨è¿™äº›å¾®æ‰¹æ¬¡ä¹‹é—´è¿›è¡Œæµæ°´çº¿å¤„ç†ã€‚ å°†æµæ°´çº¿å¹¶è¡Œã€å¼ é‡å¹¶è¡Œå’Œæ•°æ®å¹¶è¡Œç»“åˆèµ·æ¥ï¼Œè¿™ç§æŠ€æœ¯æˆ‘ä»¬ç§°ä¹‹ä¸º PTD-P è¿˜ä¸ ZeRO[36]è¿›è¡Œäº†æ¯”è¾ƒï¼Œå‘ç°ç”±äºè·¨èŠ‚ç‚¹é€šä¿¡è¾ƒå°‘ï¼Œæˆ‘ä»¬çš„æ–¹æ³•åœ¨ 1750 äº¿å’Œ 5300 äº¿å‚æ•°çš„æ¨¡å‹ä¸Šæ¯” ZeRO-3 é«˜å‡º 70%ã€‚è¿™äº›æ¨¡å‹å¤ªå¤§ï¼Œæ— æ³•å®¹çº³åœ¨å¤š GPU æœåŠ¡å™¨ä¸Šã€‚ ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm-v2/:3:0","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Efficient Large-Scale Language Model Training on GPU Clusters Using Megatron-LM","uri":"/posts/paper-megatron-lm-v2/"},{"categories":null,"content":"MODES OF PARALLELISM ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm-v2/:4:0","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Efficient Large-Scale Language Model Training on GPU Clusters Using Megatron-LM","uri":"/posts/paper-megatron-lm-v2/"},{"categories":null,"content":"Data Parallelism æ¯ä¸ªå·¥ä½œèŠ‚ç‚¹éƒ½æ‹¥æœ‰å®Œæ•´æ¨¡å‹çš„å‰¯æœ¬ï¼Œè¾“å…¥æ•°æ®é›†è¢«åˆ†ç‰‡ï¼Œå·¥ä½œèŠ‚ç‚¹å®šæœŸèšåˆå®ƒä»¬çš„æ¢¯åº¦ï¼Œä»¥ç¡®ä¿æ‰€æœ‰å·¥ä½œèŠ‚ç‚¹çœ‹åˆ°ä¸€è‡´çš„æƒé‡ç‰ˆæœ¬ ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm-v2/:4:1","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Efficient Large-Scale Language Model Training on GPU Clusters Using Megatron-LM","uri":"/posts/paper-megatron-lm-v2/"},{"categories":null,"content":"Pipeline Model Parallelism åœ¨æµæ°´çº¿å¹¶è¡ŒåŒ–ä¸­ï¼Œæ¨¡å‹çš„å„å±‚è¢«åˆ†é…åˆ°å¤šä¸ªè®¾å¤‡ä¸Šã€‚å½“ç”¨äºå…·æœ‰é‡å¤ç›¸åŒ Transformer å—çš„æ¨¡å‹æ—¶ï¼Œæ¯ä¸ªè®¾å¤‡å¯ä»¥è¢«åˆ†é…ç›¸åŒæ•°é‡çš„ Transformer å±‚ã€‚ ä¸€ä¸ªæ‰¹æ¬¡è¢«æ‹†åˆ†ä¸ºè¾ƒå°çš„å¾®æ‰¹æ¬¡ï¼›ç„¶ååœ¨å¾®æ‰¹æ¬¡ä¹‹é—´è¿›è¡Œæµæ°´çº¿æ‰§è¡Œã€‚ å…¶å®æµæ°´çº¿å’Œ CPU çš„æµæ°´çº¿è°ƒåº¦å¾ˆç›¸ä¼¼ï¼Ÿ é‡åŒ– GPipe çš„æµæ°´çº¿æ°”æ³¡å¤§å°ï¼ˆğ‘¡ğ‘ğ‘ï¼‰ã€‚æˆ‘ä»¬å°†æ‰¹æ¬¡ä¸­çš„å¾®æ‰¹æ¬¡æ•°é‡è¡¨ç¤ºä¸º ğ‘šï¼Œæµæ°´çº¿é˜¶æ®µçš„æ•°é‡ï¼ˆç”¨äºæµæ°´çº¿å¹¶è¡Œçš„è®¾å¤‡æ•°é‡ï¼‰è¡¨ç¤ºä¸º ğ‘ï¼Œæ¯æ¬¡è¿­ä»£çš„ç†æƒ³æ—¶é—´è¡¨ç¤ºä¸º ğ‘¡ğ‘–ğ‘‘ï¼ˆå‡è®¾å®Œç¾æˆ–ç†æƒ³çš„æ‰©å±•ï¼‰ï¼Œæ‰§è¡Œå•ä¸ªå¾®æ‰¹æ¬¡çš„å‰å‘å’Œåå‘ä¼ é€’çš„æ—¶é—´è¡¨ç¤ºä¸º ğ‘¡ğ‘“ å’Œ ğ‘¡ğ‘ã€‚åœ¨æ­¤è°ƒåº¦ä¸­ï¼Œæµæ°´çº¿æ°”æ³¡åŒ…æ‹¬æ‰¹æ¬¡å¼€å§‹æ—¶çš„ ğ‘âˆ’1 ä¸ªå‰å‘ä¼ é€’å’Œæ‰¹æ¬¡ç»“æŸæ—¶çš„ ğ‘âˆ’1 ä¸ªåå‘ä¼ é€’ã€‚æµæ°´çº¿æ°”æ³¡ä¸­èŠ±è´¹çš„æ€»æ—¶é—´ä¸º ğ‘¡ğ‘ğ‘ = (ğ‘âˆ’1)Â·(ğ‘¡ğ‘“ +ğ‘¡ğ‘)ã€‚æ‰¹æ¬¡çš„ç†æƒ³å¤„ç†æ—¶é—´ä¸º ğ‘¡ğ‘–ğ‘‘ = ğ‘šÂ·(ğ‘¡ğ‘“ +ğ‘¡ğ‘)ã€‚å› æ­¤ï¼Œæµæ°´çº¿æ°”æ³¡ä¸­èŠ±è´¹çš„ç†æƒ³è®¡ç®—æ—¶é—´çš„æ¯”ä¾‹ä¸º $$ Bubble\\ time\\ fraction (pipeline\\ bubble\\ size) = \\frac{t_{pb}}{t_{id}} = \\frac{(pâˆ’1)\\cdot (t_f + t_b)}{m \\cdot(t_f + t_b)} = \\frac{pâˆ’1}{m} $$ ä¸ºäº†å‡å°‘æµæ°´çº¿æ°”æ³¡çš„å½±å“ï¼Œå¯ä»¥å¢åŠ å¾®æ‰¹æ¬¡çš„æ•°é‡æˆ–å‡å°‘æµæ°´çº¿é˜¶æ®µçš„æ•°é‡ã€‚ ä½¿æµæ°´çº¿æ°”æ³¡æ—¶é—´å æ¯”ï¼ˆbubble time fractionï¼‰å°½å¯èƒ½å°ï¼Œæˆ‘ä»¬éœ€è¦æ»¡è¶³ $m Â» p$ Schedule with Interleaved Stages: æ–°è°ƒåº¦å°†æ°”æ³¡æ—¶é—´å‡å°‘äº† v å€ï¼Œè¿™ç§æµæ°´çº¿æ°”æ³¡å¤§å°çš„å‡å°‘å¹¶éæ²¡æœ‰ä»£ä»·ï¼šè¿™ç§è°ƒåº¦éœ€è¦é¢å¤–çš„é€šä¿¡ã€‚ ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm-v2/:4:2","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Efficient Large-Scale Language Model Training on GPU Clusters Using Megatron-LM","uri":"/posts/paper-megatron-lm-v2/"},{"categories":null,"content":"Tensor Model Parallelism MLP parallelism multi-head attention parallelism ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm-v2/:4:3","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Efficient Large-Scale Language Model Training on GPU Clusters Using Megatron-LM","uri":"/posts/paper-megatron-lm-v2/"},{"categories":null,"content":"PERFORMANCE ANALYSIS OF PARALLELIZATI ON CONFIGURATIONS ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm-v2/:5:0","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Efficient Large-Scale Language Model Training on GPU Clusters Using Megatron-LM","uri":"/posts/paper-megatron-lm-v2/"},{"categories":null,"content":"Tensor and Pipeline Model Parallelism $$ \\frac{p - 1}{m} = \\frac{n / t - 1}{m} $$ å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå¼ é‡æ¨¡å‹å¹¶è¡ŒåŒ–å¢åŠ äº†è®¾å¤‡ä¹‹é—´çš„é€šä¿¡é‡ã€‚å› æ­¤ï¼Œå½“ ğ‘¡ å¤§äºå•ä¸ªèŠ‚ç‚¹ä¸­çš„ GPU æ•°é‡æ—¶ï¼Œè·¨è¾ƒæ…¢çš„èŠ‚ç‚¹é—´é“¾è·¯æ‰§è¡Œå¼ é‡æ¨¡å‹å¹¶è¡ŒåŒ–çš„å¼€é”€å¯èƒ½æ˜¯ä¸åˆ‡å®é™…çš„ã€‚ ğ‘¡ è¡¨ç¤ºå¼ é‡æ¨¡å‹å¹¶è¡Œçš„è§„æ¨¡ï¼Œğ‘ è¡¨ç¤ºæµæ°´çº¿æ¨¡å‹å¹¶è¡Œçš„è§„æ¨¡ï¼Œğ‘‘ è¡¨ç¤ºæ•°æ®å¹¶è¡Œçš„è§„æ¨¡ã€‚ ğ‘ï¼šå¾®æ‰¹æ¬¡å¤§å° ğ‘šï¼šæ¯ä¸ªæµæ°´çº¿ä¸­ä¸€ä¸ªæ‰¹æ¬¡å†…çš„å¾®æ‰¹æ¬¡æ•°é‡ ğ‘›ï¼šGPU çš„æ•°é‡ ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm-v2/:5:1","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Efficient Large-Scale Language Model Training on GPU Clusters Using Megatron-LM","uri":"/posts/paper-megatron-lm-v2/"},{"categories":null,"content":"Data and Model Parallelism åœ¨ä½¿ç”¨å¼ é‡æ¨¡å‹å¹¶è¡ŒåŒ–æ—¶ï¼Œæ¯ä¸ªå¾®æ‰¹æ¬¡éƒ½éœ€è¦æ‰§è¡Œ all-reduce é€šä¿¡ã€‚è¿™åœ¨è·¨å¤š GPU æœåŠ¡å™¨æ—¶å¯èƒ½ä¼šéå¸¸æ˜‚è´µ ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm-v2/:5:2","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Efficient Large-Scale Language Model Training on GPU Clusters Using Megatron-LM","uri":"/posts/paper-megatron-lm-v2/"},{"categories":null,"content":"Microbatch Size å¾®æ‰¹æ¬¡å¤§å° b çš„é€‰æ‹©ä¹Ÿä¼šå½±å“æ¨¡å‹è®­ç»ƒçš„ååé‡ã€‚ ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm-v2/:5:3","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Efficient Large-Scale Language Model Training on GPU Clusters Using Megatron-LM","uri":"/posts/paper-megatron-lm-v2/"},{"categories":null,"content":"Activation Recomputation æ¿€æ´»é‡è®¡ç®—ï¼ˆActivation Recomputationï¼‰[12, 18, 20, 21] æ˜¯ä¸€ç§å¯é€‰æŠ€æœ¯ï¼Œé€šè¿‡åœ¨åå‘ä¼ é€’ä¹‹å‰å†æ¬¡è¿è¡Œå‰å‘ä¼ é€’ï¼ˆå¹¶ä»…ä¿å­˜ç»™å®šæµæ°´çº¿é˜¶æ®µçš„è¾“å…¥æ¿€æ´»å€¼ï¼Œè€Œä¸æ˜¯æ•´ä¸ªä¸­é—´æ¿€æ´»å€¼é›†ï¼Œåè€…å ç”¨å†…å­˜æ›´å¤§ï¼‰ï¼Œä»¥å¢åŠ è®¡ç®—æ“ä½œçš„æ•°é‡ä¸ºä»£ä»·æ¥å‡å°‘å†…å­˜å ç”¨ã€‚ ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm-v2/:5:4","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Efficient Large-Scale Language Model Training on GPU Clusters Using Megatron-LM","uri":"/posts/paper-megatron-lm-v2/"},{"categories":null,"content":"IMPLEMENTATION ç•¥ ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm-v2/:6:0","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Efficient Large-Scale Language Model Training on GPU Clusters Using Megatron-LM","uri":"/posts/paper-megatron-lm-v2/"},{"categories":null,"content":"EVALUATION PTD-P çš„æ€§èƒ½å¦‚ä½•ï¼Ÿå®ƒæ˜¯å¦èƒ½å®ç°å®é™…çš„ç«¯åˆ°ç«¯è®­ç»ƒæ—¶é—´ï¼Ÿ æµæ°´çº¿å¹¶è¡ŒåŒ–åœ¨ç»™å®šæ¨¡å‹å’Œæ‰¹é‡å¤§å°ä¸‹çš„æ‰©å±•æ€§å¦‚ä½•ï¼Ÿäº¤é”™è°ƒåº¦å¯¹æ€§èƒ½æœ‰å¤šå¤§å½±å“ï¼Ÿ ä¸åŒçš„å¹¶è¡ŒåŒ–ç»´åº¦ä¹‹é—´å¦‚ä½•äº¤äº’ï¼Ÿå¾®æ‰¹æ¬¡å¤§å°ç­‰è¶…å‚æ•°çš„å½±å“æ˜¯ä»€ä¹ˆï¼Ÿ scatter-gather é€šä¿¡ä¼˜åŒ–çš„å½±å“æ˜¯ä»€ä¹ˆï¼Ÿåœ¨å¤§è§„æ¨¡è¿è¡Œè®­ç»ƒè¿­ä»£æ—¶ï¼Œæˆ‘ä»¬å¯¹ç¡¬ä»¶æ–½åŠ äº†å“ªäº›é™åˆ¶ï¼Ÿ ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm-v2/:7:0","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Efficient Large-Scale Language Model Training on GPU Clusters Using Megatron-LM","uri":"/posts/paper-megatron-lm-v2/"},{"categories":null,"content":"End-to-End Performance è¯„ä¼°äº†ç³»ç»Ÿåœ¨å‚æ•°é‡ä» 10 äº¿åˆ° 1 ä¸‡äº¿çš„ GPT æ¨¡å‹ä¸Šçš„ç«¯åˆ°ç«¯æ€§èƒ½ å¯ç”¨äº† scatter/gather ä¼˜åŒ– çš„äº¤é”™æµæ°´çº¿è°ƒåº¦ å¦‚ä½•è®¡ç®— FLOPSï¼Ÿ ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm-v2/:7:1","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Efficient Large-Scale Language Model Training on GPU Clusters Using Megatron-LM","uri":"/posts/paper-megatron-lm-v2/"},{"categories":null,"content":"Comparison to ZeRO-3 PTD-P åœ¨è¿™ä¸¤ä¸ªæ¨¡å‹ä¸Šçš„æ€§èƒ½æ¯” ZeRO-3 é«˜å‡º 70%ï¼Œè¿™å¾—ç›Šäºæ›´å°‘çš„è·¨èŠ‚ç‚¹é€šä¿¡ã€‚ ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm-v2/:7:2","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Efficient Large-Scale Language Model Training on GPU Clusters Using Megatron-LM","uri":"/posts/paper-megatron-lm-v2/"},{"categories":null,"content":"Pipeline Parallelism Weak Scaling. è¾ƒé«˜çš„æ‰¹é‡å¤§å°å…·æœ‰æ›´å¥½çš„æ‰©å±•æ€§ï¼Œå› ä¸ºæµæ°´çº¿æ°”æ³¡è¢«åˆ†æ‘Šåˆ°æ›´å¤šçš„å¾®æ‰¹æ¬¡ä¸Š Interleaved versus Non-Interleaved Schedule. å¯ç”¨ scatter/gather é€šä¿¡ä¼˜åŒ– çš„äº¤é”™è°ƒåº¦æ¯”éäº¤é”™ï¼ˆé»˜è®¤ï¼‰è°ƒåº¦å…·æœ‰æ›´é«˜çš„è®¡ç®—æ€§èƒ½ã€‚ ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm-v2/:7:3","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Efficient Large-Scale Language Model Training on GPU Clusters Using Megatron-LM","uri":"/posts/paper-megatron-lm-v2/"},{"categories":null,"content":"Comparison of Parallel Configurations ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm-v2/:7:4","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Efficient Large-Scale Language Model Training on GPU Clusters Using Megatron-LM","uri":"/posts/paper-megatron-lm-v2/"},{"categories":null,"content":"Microbatch Size ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm-v2/:7:5","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Efficient Large-Scale Language Model Training on GPU Clusters Using Megatron-LM","uri":"/posts/paper-megatron-lm-v2/"},{"categories":null,"content":"Activation Recomputation ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm-v2/:7:6","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Efficient Large-Scale Language Model Training on GPU Clusters Using Megatron-LM","uri":"/posts/paper-megatron-lm-v2/"},{"categories":null,"content":"Scatter-Gather Optimization ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm-v2/:7:7","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Efficient Large-Scale Language Model Training on GPU Clusters Using Megatron-LM","uri":"/posts/paper-megatron-lm-v2/"},{"categories":null,"content":"Fused Operators ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm-v2/:7:8","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Efficient Large-Scale Language Model Training on GPU Clusters Using Megatron-LM","uri":"/posts/paper-megatron-lm-v2/"},{"categories":null,"content":"Inter-Node Communication Bandwidth ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm-v2/:7:9","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Efficient Large-Scale Language Model Training on GPU Clusters Using Megatron-LM","uri":"/posts/paper-megatron-lm-v2/"},{"categories":null,"content":"Checkpoint Loading and Saving å„ç§é…ç½® evaluation ç•¥ ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm-v2/:7:10","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Efficient Large-Scale Language Model Training on GPU Clusters Using Megatron-LM","uri":"/posts/paper-megatron-lm-v2/"},{"categories":null,"content":"RELATED WORK ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm-v2/:8:0","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Efficient Large-Scale Language Model Training on GPU Clusters Using Megatron-LM","uri":"/posts/paper-megatron-lm-v2/"},{"categories":null,"content":"Megatron-LM Nvidia å¼€æºçš„ Megatron-LM å¤§æ¨¡å‹è®­ç»ƒæ¡†æ¶ ç»“åˆ Model Parallelism å’Œ Pipeline Parallelism å®ç°äº† Tensor Model Parallelism åŸºäº Transformer å’Œ Attention è¿›è¡Œåˆ‡åˆ†ï¼ŒåŒæ ·æ˜¯ç»å…¸çš„ä¸€ç¯‡åˆ†å¸ƒå¼è¯­è¨€æ¨¡å‹è®­ç»ƒçš„æ–‡ç«  è®ºæ–‡æ¯”è¾ƒçŸ­ï¼Œç»†èŠ‚å¾ˆå°‘ï¼Œéœ€è¦ç»“åˆææ²å¤§ç¥çš„ç²¾è¯»è§†é¢‘é˜…è¯»ï¼Œå…³äº AI çš„ä¸œè¥¿è¿˜æ˜¯å¾—å¤šçœ‹å¤šåŠ¨æ‰‹ï¼Œä¸ç„¶ä¸€çŸ¥åŠè§£ æŸ³æµ©â€œç½—è¥¿çš„æ€è€ƒâ€ å¤§ç¥çš„ MegatronLM æºç åˆ†æ ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm/:1:0","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Megatron-LM: Training Multi-Billion Parameter Language Models Using Model Parallelism","uri":"/posts/paper-megatron-lm/"},{"categories":null,"content":"Abstract è®­ç»ƒå¤§å‹ Transformer æ¨¡å‹ï¼Œç”±äºå†…å­˜é™åˆ¶ï¼Œè®­ç»ƒéå¸¸å¤§çš„æ¨¡å‹å¯èƒ½ä¼šéå¸¸å›°éš¾ æœ¬æ–‡ä»‹ç»äº†è®­ç»ƒè¶…å¤§å‹ Transformer æ¨¡å‹çš„æŠ€æœ¯ï¼Œå¹¶å®ç°äº†ä¸€ç§ç®€å•é«˜æ•ˆçš„å±‚å†…æ¨¡å‹å¹¶è¡Œæ–¹æ³•ï¼Œä½¿å¾—è®­ç»ƒå…·æœ‰æ•°åäº¿å‚æ•°çš„ Transformer æ¨¡å‹æˆä¸ºå¯èƒ½ orthogonal and complimentary to pipeline model parallelism, å¯ä»¥é€šè¿‡åœ¨åŸç”Ÿ PyTorch ä¸­æ’å…¥å°‘é‡é€šä¿¡æ“ä½œæ¥å®Œå…¨å®ç° é€šè¿‡ä½¿ç”¨ 512 ä¸ª GPU æ”¶æ•›äº†é«˜è¾¾ 83 äº¿å‚æ•°çš„åŸºäº Transformer çš„æ¨¡å‹æ¥å±•ç¤ºè¿™ç§æ–¹æ³• ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm/:2:0","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Megatron-LM: Training Multi-Billion Parameter Language Models Using Model Parallelism","uri":"/posts/paper-megatron-lm/"},{"categories":null,"content":"Introduction éšç€è¿™äº›æ¨¡å‹å˜å¾—è¶Šæ¥è¶Šå¤§ï¼Œå®ƒä»¬è¶…å‡ºäº†ç°ä»£å¤„ç†å™¨çš„å†…å­˜é™åˆ¶ï¼Œéœ€è¦é¢å¤–çš„å†…å­˜ç®¡ç†æŠ€æœ¯ï¼Œä¾‹å¦‚æ¿€æ´»æ£€æŸ¥ç‚¹ activation checkpointing å‡å°å†…å­˜å ç”¨ï¼Œä¸¢å¼ƒå¤§éƒ¨åˆ†ä¸­é—´æ¿€æ´»å€¼ å¯æ‰©å±•æ€§ï¼šå• GPU åˆ° 512 GPU å‡†ç¡®æ€§ï¼šSOTA ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm/:3:0","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Megatron-LM: Training Multi-Billion Parameter Language Models Using Model Parallelism","uri":"/posts/paper-megatron-lm/"},{"categories":null,"content":"Background and Challenges ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm/:4:0","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Megatron-LM: Training Multi-Billion Parameter Language Models Using Model Parallelism","uri":"/posts/paper-megatron-lm/"},{"categories":null,"content":"Neural Language Model Pretraining ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm/:4:1","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Megatron-LM: Training Multi-Billion Parameter Language Models Using Model Parallelism","uri":"/posts/paper-megatron-lm/"},{"categories":null,"content":"Transformer Language Models and Multi-Head Attention å½“å‰ NLP çš„ç ”ç©¶è¶‹åŠ¿å€¾å‘äºä½¿ç”¨ Transformer æ¨¡å‹ï¼Œæœ€åˆçš„ Transformer è®¾è®¡æ˜¯ä¸€ç§æœºå™¨ç¿»è¯‘æ¶æ„ï¼Œé€šè¿‡ç¼–ç å™¨ï¼ˆEncoderï¼‰å’Œè§£ç å™¨ï¼ˆDecoderï¼‰ä¸¤éƒ¨åˆ†å°†è¾“å…¥åºåˆ—è½¬æ¢ä¸ºè¾“å‡ºåºåˆ—ã€‚ç„¶è€Œï¼Œæœ€è¿‘åˆ©ç”¨ Transformer è¿›è¡Œè¯­è¨€å»ºæ¨¡çš„å·¥ä½œï¼Œå¦‚ BERTï¼ˆDevlin ç­‰ï¼Œ2018ï¼‰å’Œ GPT-2ï¼ˆRadford ç­‰ï¼Œ2019ï¼‰ï¼Œæ ¹æ®éœ€æ±‚ä»…ä½¿ç”¨ç¼–ç å™¨æˆ–è§£ç å™¨ã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒGPT-2 å’Œ BERT éƒ½ä½¿ç”¨äº† GeLUï¼ˆHendrycks \u0026 Gimpelï¼Œ2016ï¼‰éçº¿æ€§å’Œå±‚å½’ä¸€åŒ–ï¼ˆBa ç­‰ï¼Œ2016ï¼‰åº”ç”¨äºå¤šå¤´æ³¨æ„åŠ›å’Œå‰é¦ˆå±‚çš„è¾“å…¥ï¼Œè€ŒåŸå§‹ Transformerï¼ˆVaswani ç­‰ï¼Œ2017ï¼‰ä½¿ç”¨ ReLU éçº¿æ€§å¹¶å°†å±‚å½’ä¸€åŒ–åº”ç”¨äºè¾“å‡ºã€‚ ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm/:4:2","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Megatron-LM: Training Multi-Billion Parameter Language Models Using Model Parallelism","uri":"/posts/paper-megatron-lm/"},{"categories":null,"content":"Data and Model Parallelism in Deep Learning å°†æ·±åº¦ç¥ç»ç½‘ç»œè®­ç»ƒæ‰©å±•åˆ°å¤šä¸ªç¡¬ä»¶åŠ é€Ÿå™¨æ—¶ï¼Œæœ‰ä¸¤ç§æ ¸å¿ƒèŒƒå¼ï¼š data parallelism(Valiant, 1990): å°†è®­ç»ƒå°æ‰¹é‡æ•°æ®æ‹†åˆ†åˆ°å¤šä¸ªå·¥ä½œèŠ‚ç‚¹ä¸Šï¼› model parallelism: å°†æ¨¡å‹çš„å†…å­˜ä½¿ç”¨å’Œè®¡ç®—åˆ†å¸ƒåˆ°å¤šä¸ªå·¥ä½œèŠ‚ç‚¹ä¸Šã€‚ ç„¶è€Œï¼Œè¿™äº›æŠ€æœ¯åœ¨å¯å¤„ç†çš„é—®é¢˜è§„æ¨¡ä¸Šå­˜åœ¨ä¸€ä¸ªæ ¹æœ¬æ€§é™åˆ¶ï¼šæ¨¡å‹å¿…é¡»å®Œå…¨é€‚åˆå•ä¸ªå·¥ä½œèŠ‚ç‚¹ã€‚éšç€ BERT å’Œ GPT-2 ç­‰è¯­è¨€æ¨¡å‹çš„è§„æ¨¡å’Œå¤æ‚æ€§ä¸æ–­å¢åŠ ï¼Œç¥ç»ç½‘ç»œå·²æ¥è¿‘ç°ä»£ç¡¬ä»¶åŠ é€Ÿå™¨çš„å†…å­˜å®¹é‡ã€‚ Within model parallelism, there are two further paradigms: layer-wise pipeline parallelism: TensorFlow GPipe ç„¶è€Œï¼Œè¿™ç§æ–¹æ³•éœ€è¦é¢å¤–çš„é€»è¾‘æ¥é«˜æ•ˆå¤„ç†é€šä¿¡å’Œè®¡ç®—æ“ä½œçš„æµæ°´çº¿ï¼Œå¹¶ä¸”å­˜åœ¨ç®¡é“æ°”æ³¡ï¼ˆpipeline bubblesï¼‰é—®é¢˜ï¼Œé™ä½äº†æ•ˆç‡ï¼Œæˆ–è€…éœ€è¦ä¿®æ”¹ä¼˜åŒ–å™¨æœ¬èº«ï¼Œä»è€Œå½±å“å‡†ç¡®æ€§ã€‚ distributed tensor computation: æ­£äº¤ä¸”æ›´é€šç”¨çš„æ–¹æ³•ï¼ŒFlexFlowï¼ŒMesh-TensorFlow ç­‰ç­‰ æˆ‘ä»¬åˆ©ç”¨äº†ä¸ Mesh-TensorFlow ç±»ä¼¼çš„æ€è·¯ï¼Œå¹¶é€šè¿‡å¹¶è¡Œè®¡ç®— Transformer çš„æ³¨æ„åŠ›å¤´æ¥å®ç° Transformer æ¨¡å‹çš„å¹¶è¡ŒåŒ–ï¼Œä»…å¯¹ç°æœ‰çš„ PyTorch Transformer å®ç°è¿›è¡Œäº†ä¸€äº›æœ‰é’ˆå¯¹æ€§çš„ä¿®æ”¹ã€‚ä¸éœ€è¦ä»»ä½•æ–°çš„ç¼–è¯‘å™¨æˆ–ä»£ç é‡å†™ï¼Œåªéœ€æ’å…¥ä¸€äº›ç®€å•çš„åŸè¯­å³å¯å®Œå…¨å®ç°ã€‚ ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm/:4:3","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Megatron-LM: Training Multi-Billion Parameter Language Models Using Model Parallelism","uri":"/posts/paper-megatron-lm/"},{"categories":null,"content":"Model Parallel Transformers åˆ©ç”¨ Transformer ç½‘ç»œçš„ç»“æ„ï¼Œé€šè¿‡æ·»åŠ å°‘é‡åŒæ­¥åŸè¯­ï¼Œå®ç°äº†ä¸€ç§ç®€å•çš„æ¨¡å‹å¹¶è¡Œæ–¹æ³•ã€‚ Transformer å±‚ç”±ä¸€ä¸ªè‡ªæ³¨æ„åŠ›å—å’Œä¸€ä¸ªä¸¤å±‚çš„å¤šå±‚æ„ŸçŸ¥æœºï¼ˆMLPï¼‰ ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm/:5:0","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Megatron-LM: Training Multi-Billion Parameter Language Models Using Model Parallelism","uri":"/posts/paper-megatron-lm/"},{"categories":null,"content":"MLP å—çš„å¹¶è¡ŒåŒ– MLP å—çš„ç¬¬ä¸€éƒ¨åˆ†æ˜¯ä¸€ä¸ª GEMMï¼ˆé€šç”¨çŸ©é˜µä¹˜æ³•ï¼‰æ“ä½œï¼Œåæ¥ä¸€ä¸ª GeLU éçº¿æ€§æ¿€æ´»å‡½æ•° $$ Y=GeLU(XA) $$ å¹¶è¡ŒåŒ– GEMM çš„ä¸€ç§é€‰æ‹©æ˜¯å°†æƒé‡çŸ©é˜µ A æ²¿å…¶è¡Œ rows åˆ†å‰²è¾“å…¥ X æ²¿å…¶åˆ— columns åˆ†å‰² $$ X = [X_1 \\ X_2], \\quad A = \\begin{bmatrix} A_1 \\ A_2 \\end{bmatrix} $$ è¿™ç§åˆ†åŒºä¼šå¯¼è‡´ $Y = \\text{GeLU}(X_1A_1 + X_2A_2)$ï¼Œç”±äº GeLU æ˜¯ä¸€ä¸ªéçº¿æ€§å‡½æ•°ï¼ˆ$\\text{GeLU}(X_1A_1 + X_2A_2) \\neq \\text{GeLU}(X_1A_1) + \\text{GeLU}(X_2A_2)$ ï¼Œéœ€è¦åœ¨ GeLU å‡½æ•°ä¹‹å‰æ·»åŠ ä¸€ä¸ªåŒæ­¥ç‚¹ã€‚ å¦ä¸€ç§é€‰æ‹©æ˜¯å°† $A$ æ²¿å…¶åˆ— column åˆ†å‰² $A = [A_1 \\ A_2]$ã€‚è¿™ç§åˆ†åŒºå…è®¸ GeLU éçº¿æ€§ç‹¬ç«‹åº”ç”¨äºæ¯ä¸ªåˆ†åŒº GEMM çš„è¾“å‡ºï¼š $$ [Y_1 \\ Y_2] = [\\text{GeLU}(XA_1) \\ \\text{GeLU}(XA_2)] $$ è¿™ç§æ–¹æ³•çš„ä¼˜åŠ¿åœ¨äºå®ƒç§»é™¤äº†ä¸€ä¸ªåŒæ­¥ç‚¹ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä»¥è¿™ç§åˆ—å¹¶è¡Œ column parallel çš„æ–¹å¼å¯¹ç¬¬ä¸€ä¸ª GEMM è¿›è¡Œåˆ†åŒºï¼Œå¹¶å°†ç¬¬äºŒä¸ª GEMM æ²¿å…¶è¡Œ rows åˆ†å‰²ï¼Œä½¿å…¶ç›´æ¥æ¥æ”¶ GeLU å±‚çš„è¾“å‡ºï¼Œè€Œæ— éœ€ä»»ä½•é€šä¿¡ï¼Œ GEMMï¼ˆGeneral Matrix Multiplyï¼‰ åœ¨å‰å‘ä¼ æ’­ä¸­åªéœ€è¦ä¸€æ¬¡ all-reduce æ“ä½œï¼ˆg æ“ä½œç¬¦ï¼‰ï¼Œåœ¨åå‘ä¼ æ’­ä¸­ä¹Ÿåªéœ€è¦ä¸€æ¬¡ all-reduce æ“ä½œï¼ˆf æ“ä½œç¬¦ï¼‰ã€‚è¿™ä¸¤ä¸ªæ“ä½œç¬¦äº’ä¸ºå…±è½­ï¼Œå¯ä»¥åœ¨ PyTorch ä¸­ç”¨å‡ è¡Œä»£ç å®ç°ã€‚ class f(torch.autograd.Function): def forward(ctx, x): return x def backward(ctx, gradient): all_reduce(gradient) return gradient ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm/:5:1","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Megatron-LM: Training Multi-Billion Parameter Language Models Using Model Parallelism","uri":"/posts/paper-megatron-lm/"},{"categories":null,"content":"è‡ªæ³¨æ„åŠ›å—çš„å¹¶è¡ŒåŒ– å¯¹äºè‡ªæ³¨æ„åŠ›å—ï¼Œæˆ‘ä»¬åˆ©ç”¨äº†å¤šå¤´æ³¨æ„åŠ›æ“ä½œä¸­çš„å›ºæœ‰å¹¶è¡Œæ€§ï¼Œå°†é”®ï¼ˆKï¼‰ã€æŸ¥è¯¢ï¼ˆQï¼‰å’Œå€¼ï¼ˆVï¼‰ç›¸å…³çš„ GEMM ä»¥åˆ— column parallel å¹¶è¡Œçš„æ–¹å¼åˆ†åŒºï¼Œä½¿å¾—æ¯ä¸ªæ³¨æ„åŠ›å¤´å¯¹åº”çš„çŸ©é˜µä¹˜æ³•åœ¨å•ä¸ª GPU ä¸Šæœ¬åœ°å®Œæˆ The transformer language model has an output embedding with the dimension of hidden-size (H) times vocabulary size (v) ç”±äºç°ä»£è¯­è¨€æ¨¡å‹çš„è¯æ±‡è¡¨å¤§å°é€šå¸¸åœ¨æ•°ä¸‡ä¸ªè¯ï¼ˆä¾‹å¦‚ï¼ŒGPT-2 ä½¿ç”¨äº† 50,257 çš„è¯æ±‡è¡¨å¤§å°ï¼‰ï¼Œå› æ­¤å¹¶è¡ŒåŒ–è¾“å‡ºåµŒå…¥çš„ GEMM æ“ä½œæ˜¯æœ‰ç›Šçš„ã€‚ç„¶è€Œï¼Œåœ¨ Transformer è¯­è¨€æ¨¡å‹ä¸­ï¼Œè¾“å‡ºåµŒå…¥å±‚ä¸è¾“å…¥åµŒå…¥å…±äº«æƒé‡ï¼Œå› æ­¤éœ€è¦å¯¹ä¸¤è€…è¿›è¡Œä¿®æ”¹ã€‚ è¾“å…¥åµŒå…¥æƒé‡çŸ©é˜µ $E_{H\\times v}$ æ²¿è¯æ±‡è¡¨ç»´åº¦å¹¶è¡ŒåŒ–ï¼ŒæŒ‰åˆ—åˆ†å‰² è¿™é‡Œçœç•¥ embedding æ²¡å¤ªçœ‹æ‡‚ æˆ‘ä»¬çš„æ¨¡å‹å¹¶è¡Œæ–¹æ³•ä¸»è¦é€šè¿‡å‡å°‘é€šä¿¡å¹¶ä¿æŒ GPU çš„è®¡ç®—è´Ÿè½½æ¥å®ç°ä¼˜åŒ–ã€‚ä¸å…¶è®©ä¸€ä¸ª GPU è®¡ç®—éƒ¨åˆ† dropoutã€å±‚å½’ä¸€åŒ–æˆ–æ®‹å·®è¿æ¥å¹¶å°†ç»“æœå¹¿æ’­åˆ°å…¶ä»– GPUï¼Œæˆ‘ä»¬é€‰æ‹©åœ¨ GPU ä¹‹é—´å¤åˆ¶è®¡ç®—ã€‚ é™„å½• B ä¸­æä¾›äº†å…³äºæ··åˆæ¨¡å‹å’Œæ•°æ®å¹¶è¡Œä»¥åŠéšæœºæ•°ç”Ÿæˆå¤„ç†çš„æ›´å¤šç»†èŠ‚ä»¥ä¾›å‚è€ƒã€‚æ€»ä¹‹ï¼Œæˆ‘ä»¬ä¸Šè¿°çš„æ–¹æ³•å®ç°ç®€å•ï¼Œåªéœ€åœ¨å‰å‘å’Œåå‘ä¼ æ’­ä¸­æ·»åŠ å°‘é‡é¢å¤–çš„ all-reduce æ“ä½œã€‚å®ƒä¸éœ€è¦ç¼–è¯‘å™¨ï¼Œå¹¶ä¸”ä¸ç®¡é“æ¨¡å‹å¹¶è¡Œæ˜¯æ­£äº¤ä¸”äº’è¡¥çš„ã€‚ ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm/:5:2","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Megatron-LM: Training Multi-Billion Parameter Language Models Using Model Parallelism","uri":"/posts/paper-megatron-lm/"},{"categories":null,"content":"Setup GPT-2, BERT ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm/:6:0","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Megatron-LM: Training Multi-Billion Parameter Language Models Using Model Parallelism","uri":"/posts/paper-megatron-lm/"},{"categories":null,"content":"Training Dataset èšåˆäº†å‡ ä¸ªæœ€å¤§çš„è¯­è¨€å»ºæ¨¡æ•°æ®é›† ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm/:6:1","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Megatron-LM: Training Multi-Billion Parameter Language Models Using Model Parallelism","uri":"/posts/paper-megatron-lm/"},{"categories":null,"content":"Training Optimization and Hyperparameters æ··åˆç²¾åº¦è®­ç»ƒå’ŒåŠ¨æ€æŸå¤±ç¼©æ”¾ å¥½å¥‡ä¸ºä»€ä¹ˆè®ºæ–‡æ²¡æåˆ° FP16 FP32 ç­‰ç­‰ ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm/:6:2","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Megatron-LM: Training Multi-Billion Parameter Language Models Using Model Parallelism","uri":"/posts/paper-megatron-lm/"},{"categories":null,"content":"Experiments 32 å° DGX-2H æœåŠ¡å™¨ï¼ˆå…± 512 ä¸ª Tesla V100 SXM3 32GB GPUï¼‰ ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm/:7:0","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Megatron-LM: Training Multi-Billion Parameter Language Models Using Model Parallelism","uri":"/posts/paper-megatron-lm/"},{"categories":null,"content":"Scaling Analysis GPT-2 models with four sets of parameters detailed in Table1 ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm/:7:1","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Megatron-LM: Training Multi-Billion Parameter Language Models Using Model Parallelism","uri":"/posts/paper-megatron-lm/"},{"categories":null,"content":"MODEL AND DATA PARALLELISM å±•ç¤ºæ¨¡å‹å¹¶è¡Œå’Œæ¨¡å‹+æ•°æ®å¹¶è¡Œæƒ…å†µä¸‹å…³äºæ¨¡å‹å‚æ•°çš„å¼±æ‰©å±•æ€§ å¼±æ‰©å±•æ€§ weak scaling ä»£è¡¨äº†ä»€ä¹ˆï¼Ÿæ€ä¹ˆè®¡ç®—ï¼Ÿ æ˜¯å¦åº”è¯¥ç¨³å®šæˆ–è€…è½»å¾®ä¸‹é™æ‰è¡¨ç¤ºæ‰©å±•è‰¯å¥½ ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm/:7:2","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Megatron-LM: Training Multi-Billion Parameter Language Models Using Model Parallelism","uri":"/posts/paper-megatron-lm/"},{"categories":null,"content":"Language Modeling Results Using GPT-2 è¡¨ 2 è¿˜åˆ—å‡ºäº†å®Œæˆä¸€ä¸ª epoch æ‰€éœ€çš„æ—¶é—´ï¼Œç›¸å½“äº 68,507 æ¬¡è¿­ä»£ã€‚ä¾‹å¦‚ï¼Œå¯¹äºåœ¨ 512 ä¸ª GPU ä¸Šè®­ç»ƒçš„ 8.3B æ¨¡å‹ï¼Œæ¯ä¸ª epoch å¤§çº¦éœ€è¦ä¸¤å¤©æ—¶é—´ã€‚ä¸è¡¨ 1 ä¸­ç”¨äºæ‰©å±•æ€§ç ”ç©¶çš„é…ç½®ç›¸æ¯”ï¼Œ2.5B æ¨¡å‹ç›¸åŒï¼Œ8.3B æ¨¡å‹æœ‰ 24 ä¸ªæ³¨æ„åŠ›å¤´è€Œä¸æ˜¯ 32 ä¸ªï¼Œè€Œ 355M æ¨¡å‹æ¯”ä¹‹å‰çœ‹åˆ°çš„ä»»ä½•æ¨¡å‹éƒ½å°å¾—å¤šï¼Œä½†ä»ç„¶ä½¿ç”¨ 64 ä¸ª GPU è¿›è¡Œè®­ç»ƒï¼Œå› æ­¤æ¯ä¸ª epoch çš„æ—¶é—´å¤§å¤§å‡å°‘ã€‚ éªŒè¯å›°æƒ‘åº¦ï¼ˆperplexityï¼‰éšè¿­ä»£æ¬¡æ•°çš„å˜åŒ–ï¼Œéšç€æ¨¡å‹è§„æ¨¡çš„å¢åŠ ï¼ŒéªŒè¯å›°æƒ‘åº¦ä¸‹é™ï¼Œ8.3B æ¨¡å‹çš„éªŒè¯å›°æƒ‘åº¦è¾¾åˆ° 9.27 å¾®è½¯çš„ç ”ç©¶äººå‘˜ä¸ NVIDIA åˆä½œï¼Œä½¿ç”¨ Megatron è®­ç»ƒäº†ä¸€ä¸ª 170 äº¿å‚æ•°çš„ GPT-2 æ¨¡å‹ï¼Œç§°ä¸º Turing-NLGï¼ˆMicrosoftï¼Œ2020ï¼‰ï¼Œå¹¶å±•ç¤ºäº†éšç€æ¨¡å‹è§„æ¨¡çš„æ‰©å¤§ï¼Œå‡†ç¡®ç‡è¿›ä¸€æ­¥æé«˜ï¼Œå‡¸æ˜¾äº†å¤§å‹æ¨¡å‹çš„ä»·å€¼ã€‚ ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm/:7:3","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Megatron-LM: Training Multi-Billion Parameter Language Models Using Model Parallelism","uri":"/posts/paper-megatron-lm/"},{"categories":null,"content":"Bi-directional Transformer Results Using BERT ç•¥ ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm/:7:4","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Megatron-LM: Training Multi-Billion Parameter Language Models Using Model Parallelism","uri":"/posts/paper-megatron-lm/"},{"categories":null,"content":"Conclusion and Future Work æ¯”è¾ƒçŸ­çš„ä¸€ç¯‡è®ºæ–‡ï¼Œæ–¹æ³•å¾ˆç²—æš´ç®€å•ï¼Œä½†ä¹Ÿå¾ˆæœ‰æ•ˆ å¯¹äº DL/LLM Training æˆ‘å…¶å®å¾ˆéš¾æƒ³è±¡è¿™äº›å¹¶è¡Œ/åˆ†å¸ƒå¼è®­ç»ƒæ˜¯å‡ å¹´å‰æ‰çƒ­é—¨ï¼Œè¿˜éœ€è¦é˜…è¯»æ›´å¤š å°¤å…¶æ˜¯ Megatron çš„æºç  ","date":"2025-02-26","objectID":"/posts/paper-megatron-lm/:8:0","tags":["Paper Reading","Deep Learning","Language Models","Training"],"title":"Paper Reading: Megatron-LM: Training Multi-Billion Parameter Language Models Using Model Parallelism","uri":"/posts/paper-megatron-lm/"},{"categories":null,"content":"PipeDream: Generalized Pipeline Parallelism for DNN Training ç¬¬ä¸€æ¬¡çœ‹ ML/DL (distributed) training æ¡†æ¶ç›¸å…³çš„è®ºæ–‡ï¼Œæœ‰å¾ˆå¤šåœ°æ–¹ä¸ç†è§£ã€‚ å¯¹ Evaluation ä¸æ•°å­¦è¯æ˜æ›´æ˜¯æµ…å°è¾„æ­¢ï¼Œè®¸å¤šæŒ‡æ ‡å’Œç®—æ³•éš¾ä»¥ç†è§£ï¼Œå…³äºå¤§æ¨¡å‹ã€åˆ†å¸ƒå¼è®­ç»ƒç­‰ç­‰æœ‰è®¸å¤šæ€»ç»“å¾—éå¸¸å¥½çš„åšå®¢å’Œåˆ†äº«ï¼Œå‚ç…§ç€å¤šçœ‹çœ‹åŠ æ·±è®°å¿†ã€‚ æµæ°´çº¿å¹¶è¡Œåˆ†å¸ƒå¼è®­ç»ƒä¸€ç¯‡ç»å…¸çš„æ–‡ç« ï¼Œç»“åˆ DP, MP ä»¥åŠ Pipeline è¿™ç¯‡å’Œ Gpipe éå¸¸ç›¸ä¼¼ï¼š GPipe: Efficient Training of Giant Neural Networks using Pipeline Parallelism ç±»ä¼¼è¿˜æœ‰ MegatronLM å›¢é˜Ÿçš„è®ºæ–‡ Megatron-LM Gpipe çŸ¥ä¹è®²è§£ å…³äº Gpipe å’Œ PipeDream æºç è¯¦è§£å¯ä»¥å‚è€ƒæŸ³æµ©â€œç½—è¥¿çš„æ€è€ƒâ€å¤§ç¥çš„åšå®¢ Gpipe æºç è§£æ PipeDream ä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„ ç¬”è®° by jasperzhong è¯¦ç»†è§£é‡Šäº† pipedream åš partition çš„æ—¶å€™ä¸ºä»€ä¹ˆå¯ä»¥ç”¨åŠ¨æ€è§„åˆ’ ","date":"2025-02-24","objectID":"/posts/paper-pipedream/:1:0","tags":["Paper Reading","Deep Learning","Training"],"title":"Paper Reading: PipeDream: Generalized Pipeline Parallelism for DNN Training [SOSP2019]","uri":"/posts/paper-pipedream/"},{"categories":null,"content":"ABSTRACT æ·±åº¦ç¥ç»ç½‘ç»œï¼ˆDNNï¼‰çš„è®­ç»ƒæä¸ºè€—æ—¶ï¼Œéœ€é«˜æ•ˆçš„å¤šåŠ é€Ÿå™¨å¹¶è¡ŒåŒ–ã€‚ å½“å‰çš„è®­ç»ƒå¹¶è¡ŒåŒ–æ–¹æ³•ä¸»è¦ä½¿ç”¨ intra-batch parallelization, ä½†åœ¨è¾ƒé«˜å·¥äººæ•°ç›®æ—¶ä¼šé‡åˆ°è¾¹é™…æ”¶ç›Šé€’å‡ PipeDream: adds inter-batch pipelining to intra-batch parallelism to further improve parallel training throughput ä¸ä¼ ç»Ÿæµæ°´çº¿ä¸åŒï¼ŒDNN è®­ç»ƒæ˜¯åŒå‘çš„ï¼Œè®¡ç®—å›¾çš„å‰å‘ä¼ æ’­ä¹‹åæ˜¯åå‘ä¼ æ’­ï¼Œåè€…ä½¿ç”¨å‰å‘ä¼ æ’­æœŸé—´è®¡ç®—çš„çŠ¶æ€å’Œä¸­é—´æ•°æ® PipeDream å¯¹æ¨¡å‹å‚æ•°è¿›è¡Œç‰ˆæœ¬æ§åˆ¶ä»¥ç¡®ä¿æ¢¯åº¦è®¡ç®—çš„æ•°å€¼æ­£ç¡®æ€§ï¼Œå¹¶åœ¨ä¸åŒå·¥ä½œèŠ‚ç‚¹ä¸ŠåŒæ—¶è°ƒåº¦ä¸åŒå°æ‰¹æ¬¡çš„å‰å‘å’Œåå‘ä¼ æ’­ï¼Œä»¥æœ€å°åŒ–æµæ°´çº¿åœé¡¿ã€‚ intra-batch parallelism techniques æ¯”å¦‚ä¼ ç»Ÿçš„æ•°æ®å¹¶è¡Œ DP å’Œæ¨¡å‹å¹¶è¡Œ MP https://leimao.github.io/blog/Data-Parallelism-vs-Model-Paralelism/ æ¯›ç£Šå¤§ç¥çš„åšå®¢å¸¦æœ‰ Data Parallelism çš„è¯æ˜ ä»–çš„è§‚ç‚¹ä¹Ÿå¾ˆæœ‰æ„æ€ï¼ŒModel Parallelism å¹¶ä¸æ˜¯çœŸçš„å¹¶è¡Œï¼Œè€Œæ˜¯ Model Serialization ","date":"2025-02-24","objectID":"/posts/paper-pipedream/:2:0","tags":["Paper Reading","Deep Learning","Training"],"title":"Paper Reading: PipeDream: Generalized Pipeline Parallelism for DNN Training [SOSP2019]","uri":"/posts/paper-pipedream/"},{"categories":null,"content":"INTRODUCTION Deep Neural Networks (DNNs) è®­ç»ƒæ‰€éœ€çš„è®¡ç®—æˆæœ¬æ˜¾è‘—å¢åŠ ï¼Œéœ€è¦åœ¨å¤šä¸ª acceleratorsï¼ˆe.g., GPUsï¼‰ä¸Šè¿›è¡Œå¹¶è¡Œæ‰§è¡Œã€‚ DNN è®­ç»ƒé€šè¿‡å‰å‘ä¼ æ’­å’Œåå‘ä¼ æ’­çš„è¿­ä»£è®¡ç®—è¿›è¡Œï¼Œåœ¨æ¯æ¬¡è¿­ä»£ä¸­ï¼Œè®­ç»ƒå¾ªç¯å¤„ç†ä¸€ä¸ªå°æ‰¹æ¬¡ï¼ˆminibatchï¼‰çš„è¾“å…¥æ•°æ®ï¼Œå¹¶æ›´æ–°æ¨¡å‹å‚æ•°ã€‚å½“å‰çš„æ–¹æ³•ä¸»è¦é›†ä¸­åœ¨å°†ä¼˜åŒ–ç®—æ³•çš„æ¯æ¬¡è¿­ä»£åœ¨ä¸€ç»„å·¥ä½œèŠ‚ç‚¹ä¸Šå¹¶è¡ŒåŒ–ã€‚ æ•°æ®å¹¶è¡Œå°†è¾“å…¥æ•°æ®åˆ†é…åˆ°ä¸åŒå·¥ä½œèŠ‚ç‚¹ä¸Š æ¨¡å‹å¹¶è¡Œå°†ç®—å­åˆ†é…åˆ°ä¸åŒå·¥ä½œèŠ‚ç‚¹ä¸Š è€Œæ··åˆæ–¹æ¡ˆåˆ™åŒæ—¶åˆ†é…æ•°æ®å’Œæ¨¡å‹ ç„¶è€Œï¼Œæ‰¹å†…å¹¶è¡ŒåŒ–åœ¨å¤§è§„æ¨¡è®­ç»ƒä¸­å¯èƒ½ä¼šé¢ä¸´é«˜é€šä¿¡å¼€é”€çš„é—®é¢˜ åœ¨ 32 ä¸ª GPU ä¸Šï¼ŒæŸäº›æ¨¡å‹çš„é€šä¿¡å¼€é”€ï¼ˆä»¥é€šä¿¡åœé¡¿æ—¶é—´å æ€»æ—¶é—´çš„ç™¾åˆ†æ¯”è®¡ç®—ï¼‰é«˜è¾¾ 90%ï¼Œè¿™æ˜¯ç”±äºè·¨æœåŠ¡å™¨çš„ all_reduce é€šä¿¡æˆæœ¬é«˜æ˜‚ã€‚å³ä½¿åœ¨ä½¿ç”¨ä¸“ç”¨äº’è¿ï¼ˆå¦‚ NVLink [4]ï¼‰çš„æœåŠ¡å™¨ä¸Šï¼Œé€šä¿¡å¼€é”€ä»ç„¶å¾ˆé«˜ã€‚æ­¤å¤–ï¼ŒGPU è®¡ç®—èƒ½åŠ›çš„å¿«é€Ÿæå‡å°†è¿›ä¸€æ­¥ä½¿è®­ç»ƒçš„ç“¶é¢ˆè½¬å‘é€šä¿¡ã€‚ PipeDream: combining intra-batch parallelism with inter-batch parallelization æ€ä¹ˆå‡å°‘é€šä¿¡å¼€é”€ï¼Ÿçœ‹ä¹‹å‰ Gpipe çš„å®éªŒå¤§éƒ¨åˆ†æ—¶é—´éƒ½èŠ±è´¹åœ¨é€šä¿¡ä¸Šï¼Œè¾ƒå°çš„æ‰¹æ¬¡ä¼šå¸¦æ¥æ›´å¤šå¼€é”€å— PipeDream å°†æ¨¡å‹åˆ†é…åˆ°å¯ç”¨å·¥ä½œèŠ‚ç‚¹ä¸Šï¼Œä¸ºæ¯ä¸ªå·¥ä½œèŠ‚ç‚¹åˆ†é…ä¸€ç»„è¿ç»­çš„ç®—å­ consecutive operatorsï¼ˆåœ¨ DNN æœ¯è¯­ä¸­ç§°ä¸ºå±‚ layersï¼‰ï¼Œç„¶åä»¥æµæ°´çº¿æ–¹å¼é‡å ä¸åŒè¾“å…¥çš„è®¡ç®—å’Œé€šä¿¡ã€‚è¿™ä¸€è¿‡ç¨‹å¯ä»¥æ˜¾è‘—å‡å°‘å·¥ä½œèŠ‚ç‚¹é—´çš„é€šä¿¡ï¼Œå› ä¸ºå®ƒå°†é€šä¿¡é™åˆ¶åœ¨åˆ†é…åˆ°ä¸åŒå·¥ä½œèŠ‚ç‚¹çš„è¿ç»­å±‚ä¹‹é—´çš„å±‚è¾“å…¥å’Œè¾“å‡ºï¼ˆå‰å‘ä¼ æ’­ä¸­çš„æ¿€æ´»å€¼å’Œåå‘ä¼ æ’­ä¸­çš„æ¢¯åº¦ï¼‰ï¼Œå¯¹äºè®¸å¤šæ¨¡å‹æ¥è¯´ï¼Œè¿™äº›é€šä¿¡é‡è¿œå°äºæ•´ä¸ªæ¨¡å‹çš„å¤§å°ã€‚æ­¤å¤–ï¼Œè¿™ç§é€šä¿¡æ˜¯ç‚¹å¯¹ç‚¹çš„ï¼Œè€Œä¸æ˜¯å…¨å¯¹å…¨çš„ã€‚ PipeDream é‡‡ç”¨äº†ä¸€ç§æ›´ç²¾ç»†çš„æµæ°´çº¿æ–¹æ³•ï¼šç»™å®šä¸€ä¸ªç”±åˆ†é…åˆ°ä¸åŒå·¥ä½œèŠ‚ç‚¹çš„è¿ç»­å±‚ç»„ï¼ˆç§°ä¸ºé˜¶æ®µ stageï¼‰ç»„æˆçš„æµæ°´çº¿ï¼ŒPipeDream ä½¿ç”¨ä¸€ç§ç§°ä¸º 1F1B çš„è°ƒåº¦ç®—æ³•æ¥ä¿æŒç¡¬ä»¶çš„é«˜åˆ©ç”¨ç‡ï¼ŒåŒæ—¶å®ç°ä¸æ•°æ®å¹¶è¡Œç›¸ä¼¼çš„è¯­ä¹‰ã€‚ åœ¨ 1 Forward 1 Backward çš„ç¨³æ€ä¸‹ï¼Œæ¯ä¸ªå·¥ä½œèŠ‚ç‚¹ä¸¥æ ¼äº¤æ›¿æ‰§è¡Œå…¶é˜¶æ®µçš„å‰å‘ä¼ æ’­å’Œåå‘ä¼ æ’­ï¼Œç¡®ä¿é«˜èµ„æºåˆ©ç”¨ç‡ï¼ˆnegligible pipeline stalls, no pipeline flushesï¼‰ PipeDream åœ¨å¤š GPU ä¸Šæ•ˆæœå¾ˆå¥½ ","date":"2025-02-24","objectID":"/posts/paper-pipedream/:3:0","tags":["Paper Reading","Deep Learning","Training"],"title":"Paper Reading: PipeDream: Generalized Pipeline Parallelism for DNN Training [SOSP2019]","uri":"/posts/paper-pipedream/"},{"categories":null,"content":"BACKGROUND AND RELATED WORK æ·±åº¦ç¥ç»ç½‘ç»œï¼ˆDNNï¼‰æ¨¡å‹ç”±è®¸å¤šç®—å­ç»„æˆï¼Œè¿™äº›ç®—å­è¢«ç»„ç»‡æˆå±‚ã€‚ æ²¡æ­£ç»å­¦è¿‡ ML DLï¼Œè¿™é‡Œçš„ç®—å­å¯ä»¥ç†è§£ä¸ºå„ç§æ“ä½œå—ï¼Ÿæ¯”å¦‚å·ç§¯ã€çŸ©é˜µä¹˜æ³•æˆ–è€…æ¿€æ´»å‡½æ•°ï¼Ÿç„¶åç»„ç»‡æˆä¸€ä¸ªå±‚ï¼Œå·ç§¯å±‚ç­‰ç­‰ ","date":"2025-02-24","objectID":"/posts/paper-pipedream/:4:0","tags":["Paper Reading","Deep Learning","Training"],"title":"Paper Reading: PipeDream: Generalized Pipeline Parallelism for DNN Training [SOSP2019]","uri":"/posts/paper-pipedream/"},{"categories":null,"content":"Intra-batch Parallelism åœ¨å¹¶è¡ŒåŒ– DNN è®­ç»ƒæ—¶ï¼Œè¿™äº›å±‚å¯ä»¥ä»¥ä¸åŒçš„æ–¹å¼åˆ†é…åˆ°å¯ç”¨å·¥ä½œèŠ‚ç‚¹ä¸Šã€‚ Data Parallelism: è¾“å…¥æ•°æ®è¢«åˆ†é…åˆ°ä¸åŒå·¥ä½œèŠ‚ç‚¹ä¸Šï¼ŒåŒæ—¶å®šæœŸé€šè¿‡é›†ä½“é€šä¿¡åŸè¯­ï¼ˆå¦‚ all_reduce [24]ï¼‰æˆ–å‚æ•°æœåŠ¡å™¨ [38] ä¸å…¶ä»–å·¥ä½œèŠ‚ç‚¹åŒæ­¥æƒé‡ã€‚æœ€å¸¸ç”¨çš„æ•°æ®å¹¶è¡Œå½¢å¼ç§°ä¸º bulk synchronous parallel or BSP Model Parallelism: intra-batch å°† DNN æ¨¡å‹ä¸­çš„ç®—å­åˆ†é…åˆ°å¯ç”¨å·¥ä½œèŠ‚ç‚¹ä¸Šï¼Œæ¯ä¸ªå·¥ä½œèŠ‚ç‚¹ä»…è¯„ä¼°å’Œæ›´æ–°æ¨¡å‹å‚æ•°çš„ä¸€ä¸ªå­é›†ï¼ˆé’ˆå¯¹æ‰€æœ‰è¾“å…¥ï¼‰ã€‚é€šä¿¡çš„æ•°æ®é‡æ˜¯éœ€è¦è·¨å·¥ä½œèŠ‚ç‚¹ä¼ è¾“çš„ä¸­é—´è¾“å‡ºï¼ˆåŠç›¸åº”çš„æ¢¯åº¦ï¼‰çš„å¤§å°ã€‚ Hybrid Intra-batch Parallelism: OWT, FlexFlow â€¦ æ€ä¹ˆç†è§£ intra-batch å’Œ inter-batch parallelism ä¸€æ¬¡è®­ç»ƒçš„åŒä¸€æ‰¹æ¬¡ï¼Œæ¯”å¦‚ä¸€äº›æ•°æ®/æ¨¡å‹æ‹†åˆ†ï¼Œdata/model åˆ†é…åˆ°ä¸åŒ worker å¹¶è¡Œï¼ŒåŠ ä»¥æµæ°´çº¿ https://blog.csdn.net/weixin_36378508/article/details/129838193 ","date":"2025-02-24","objectID":"/posts/paper-pipedream/:4:1","tags":["Paper Reading","Deep Learning","Training"],"title":"Paper Reading: PipeDream: Generalized Pipeline Parallelism for DNN Training [SOSP2019]","uri":"/posts/paper-pipedream/"},{"categories":null,"content":"Inter-batch Parallelism GPipeï¼ˆä¸ PipeDream çš„æ—©æœŸé¢„å°æœ¬ [25] åŒæ—¶æœŸçš„å·¥ä½œï¼‰åœ¨æ¨¡å‹å¹¶è¡Œè®­ç»ƒçš„èƒŒæ™¯ä¸‹ä½¿ç”¨æµæ°´çº¿æŠ€æœ¯æ¥è®­ç»ƒéå¸¸å¤§çš„æ¨¡å‹ GPipe è¿›ä¸€æ­¥å°†ä¸€ä¸ªå°æ‰¹æ¬¡æ‹†åˆ†ä¸º m ä¸ªå¾®æ‰¹æ¬¡ï¼ˆmicrobatchesï¼‰ å¹¶å¯¹è¿™äº›å¾®æ‰¹æ¬¡æ‰§è¡Œå‰å‘ä¼ æ’­ï¼Œç„¶åè¿›è¡Œåå‘ä¼ æ’­ï¼ˆè§å›¾ï¼Œm=4ï¼‰ Gpipe è¿˜ä½¿ç”¨äº† æƒé‡æ¢¯åº¦èšåˆï¼ˆWeight Gradient Aggregationï¼‰ å’Œ é€šè¿‡ä¸¢å¼ƒæ¿€æ´»å€¼å­˜å‚¨æ¥ä»¥è®¡ç®—æ¢å†…å­˜ï¼ˆTrading Computation for Memory by Discarding Activation Stashesï¼‰ å‰è€…æ˜¯å¦æ˜¯ All-Reduceï¼Ÿ ","date":"2025-02-24","objectID":"/posts/paper-pipedream/:4:2","tags":["Paper Reading","Deep Learning","Training"],"title":"Paper Reading: PipeDream: Generalized Pipeline Parallelism for DNN Training [SOSP2019]","uri":"/posts/paper-pipedream/"},{"categories":null,"content":"DNN Model and Hardware Diversity DNN æ¨¡å‹å…·æœ‰å¤šæ ·æ€§ï¼Œå¸¸è§çš„æ¨¡å‹åŒ…æ‹¬å·ç§¯å±‚ã€LSTM [55]ã€æ³¨æ„åŠ›å±‚ [53] å’Œå…¨è¿æ¥å±‚ã€‚è¿™äº›ä¸åŒç±»å‹çš„æ¨¡å‹åœ¨ä½¿ç”¨ä¸åŒçš„å¹¶è¡ŒåŒ–ç­–ç•¥æ—¶è¡¨ç°å‡ºæˆªç„¶ä¸åŒçš„æ€§èƒ½ç‰¹å¾ï¼Œå› æ­¤æœ€ä¼˜çš„å¹¶è¡ŒåŒ–ç­–ç•¥é«˜åº¦ä¾èµ–äºæ¨¡å‹æœ¬èº«ã€‚ ä¸åŒæ¨¡å‹ä¸åŒçš„å¹¶è¡Œè¡¨ç°ï¼ŒPipedream æ˜¯æ›´é€šç”¨çš„é€‰æ‹©è¿˜æ˜¯ï¼Ÿ ","date":"2025-02-24","objectID":"/posts/paper-pipedream/:4:3","tags":["Paper Reading","Deep Learning","Training"],"title":"Paper Reading: PipeDream: Generalized Pipeline Parallelism for DNN Training [SOSP2019]","uri":"/posts/paper-pipedream/"},{"categories":null,"content":"PIPELINE PARALLELISM PipeDream ä½¿ç”¨äº†ä¸€ç§æ–°çš„å¹¶è¡ŒåŒ–ç­–ç•¥â€”â€”æµæ°´çº¿å¹¶è¡ŒåŒ– Pipelineï¼Œç»“åˆäº†æ‰¹å†…å¹¶è¡ŒåŒ–å’Œæ‰¹é—´å¹¶è¡ŒåŒ–ã€‚æµæ°´çº¿å¹¶è¡ŒåŒ–å°† DNN æ¨¡å‹çš„å±‚åˆ’åˆ†ä¸ºå¤šä¸ªé˜¶æ®µï¼ˆstageï¼‰ï¼Œæ¯ä¸ªé˜¶æ®µç”±æ¨¡å‹ä¸­ä¸€ç»„è¿ç»­çš„å±‚ç»„æˆã€‚æ¯ä¸ªé˜¶æ®µè¢«æ˜ å°„åˆ°ä¸€ä¸ªå•ç‹¬çš„ GPU ä¸Šï¼Œè¯¥ GPU è´Ÿè´£æ‰§è¡Œè¯¥é˜¶æ®µä¸­æ‰€æœ‰å±‚çš„å‰å‘ä¼ æ’­å’Œåå‘ä¼ æ’­ã€‚ pipedream æ˜¯æŠŠä¸€ä¸ª batch åˆ‡åˆ†çš„æ›´ç»†å—ï¼Œè¿™æ ·ä¸€å°æ®µå°±å¯ä»¥ç«‹åˆ»å‘ç»™ä¸‹ä¸€ä¸ª gpu å¼€å§‹ forwardï¼Ÿ è¿™æ ·åˆ©ç”¨ç‡æ›´é«˜ï¼Œ gpu bubble å‡å°‘ æµæ°´çº¿å¹¶è¡ŒåŒ–ä¼˜äºæ‰¹å†…å¹¶è¡ŒåŒ–çš„åŸå› ï¼š å‡å°‘äº†é€šä¿¡é‡ï¼ˆå°äº DPï¼‰ï¼ŒDP éœ€è¦èšåˆï¼ŒPP åªéœ€è¦å‘ç»™å¦ä¸€ä¸ªèŠ‚ç‚¹ é‡å é€šä¿¡å’Œè®¡ç®—ï¼šå¼‚æ­¥é€šä¿¡ä½¿å¾—å‰å‘ä¼ æ’­çš„æ¿€æ´»å€¼å’Œåå‘ä¼ æ’­çš„æ¢¯åº¦å¯ä»¥åœ¨ä¸åŒé˜¶æ®µä¹‹é—´é‡å è®¡ç®—å’Œé€šä¿¡ è¿™ç§è®­ç»ƒæ–¹å¼ä¸€èˆ¬å¦‚ä½•ä¿è¯æ­£ç¡®æ€§ï¼Ÿå¦‚ä½•åˆ‡åˆ†æ‰èƒ½ä¿è¯è´Ÿè½½å‡è¡¡ ","date":"2025-02-24","objectID":"/posts/paper-pipedream/:5:0","tags":["Paper Reading","Deep Learning","Training"],"title":"Paper Reading: PipeDream: Generalized Pipeline Parallelism for DNN Training [SOSP2019]","uri":"/posts/paper-pipedream/"},{"categories":null,"content":"Challenge 1: Work Partitioning ä¸ä»»ä½•æµæ°´çº¿ä¸€æ ·ï¼Œæœ€ç»ˆæµæ°´çº¿çš„ç¨³æ€ååé‡å–å†³äºæœ€æ…¢é˜¶æ®µçš„ååé‡ å·¥ä½œèŠ‚ç‚¹ä¹‹é—´çš„è¿‡å¤šé€šä¿¡ä¹Ÿä¼šé™ä½è®­ç»ƒæµæ°´çº¿çš„ååé‡ Solution: PipeDream Optimizer è¾“å‡ºä¸€ä¸ªå¹³è¡¡çš„æµæ°´çº¿ PipeDream åœ¨åˆå§‹åˆ†ææ­¥éª¤ä¸­è®°å½•æ¯ä¸ªå±‚çš„å‰å‘å’Œåå‘ä¼ æ’­çš„è®¡ç®—æ—¶é—´ã€å±‚è¾“å‡ºçš„æ¿€æ´»å€¼å¤§å°ä»¥åŠç›¸å…³å‚æ•°çš„å¤§å°ï¼›è¿™äº›åˆ†ææ•°æ®ä½œä¸ºä¼˜åŒ–å™¨åˆ’åˆ†ç®—æ³•çš„è¾“å…¥ï¼ˆå›¾ 6ï¼‰ã€‚åˆ’åˆ†ç®—æ³•è¿˜è€ƒè™‘äº†å…¶ä»–çº¦æŸæ¡ä»¶ï¼Œå¦‚ç¡¬ä»¶æ‹“æ‰‘å’Œå¸¦å®½ã€å·¥ä½œèŠ‚ç‚¹æ•°é‡ä»¥åŠè®¡ç®—è®¾å¤‡çš„å†…å­˜å®¹é‡ã€‚ Profiler: Partitioning Algorithm: PipeDream çš„ä¼˜åŒ–å™¨ä»æœ€ä½çº§åˆ«åˆ°æœ€é«˜çº§åˆ«é€æ­¥è§£å†³åŠ¨æ€è§„åˆ’é—®é¢˜ çœç•¥å…¬å¼ï¼Œè½¬åŒ–æˆäº†ä¸€ä¸ª DP é—®é¢˜ ","date":"2025-02-24","objectID":"/posts/paper-pipedream/:5:1","tags":["Paper Reading","Deep Learning","Training"],"title":"Paper Reading: PipeDream: Generalized Pipeline Parallelism for DNN Training [SOSP2019]","uri":"/posts/paper-pipedream/"},{"categories":null,"content":"Challenge2: Work Scheduling æµæ°´çº¿ä¸­çš„æ¯ä¸ªæ´»è·ƒå°æ‰¹é‡æ•°æ®å¯èƒ½å¤„äºä¸åŒçš„é˜¶æ®µï¼Œè¦ä¹ˆåœ¨å‰å‘ä¼ æ’­ä¸­ï¼Œè¦ä¹ˆåœ¨åå‘ä¼ æ’­ä¸­ã€‚ Solution: åœ¨å¯åŠ¨é˜¶æ®µï¼Œè¾“å…¥é˜¶æ®µä¼šæ¥æ”¶è¶³å¤Ÿå¤šçš„å°æ‰¹é‡æ•°æ®ï¼Œä»¥ä½¿æµæ°´çº¿åœ¨ç¨³æ€ä¸‹ä¿æŒæ»¡è´Ÿè· ä¸€æ—¦è¿›å…¥ç¨³æ€ï¼Œæ¯ä¸ªé˜¶æ®µä¼šäº¤æ›¿æ‰§è¡Œä¸€ä¸ªå°æ‰¹é‡æ•°æ®çš„å‰å‘ä¼ æ’­å’Œå¦ä¸€ä¸ªè¾ƒæ—©å°æ‰¹é‡æ•°æ®çš„åå‘ä¼ æ’­ã€‚æˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œä¸€å‰ä¸€åâ€ï¼ˆ1F1Bï¼‰è°ƒåº¦ã€‚ â€œä¸€å‰ä¸€åè½®è¯¢â€ 1F1B-RRï¼šå½“ä¸€ä¸ªé˜¶æ®µä»¥æ•°æ®å¹¶è¡Œé…ç½®è¿è¡Œï¼ˆåœ¨å¤šä¸ª GPU ä¸Šå¤åˆ¶ï¼‰æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨åŸºäºå°æ‰¹é‡æ•°æ®æ ‡è¯†ç¬¦çš„ç¡®å®šæ€§è½®è¯¢è´Ÿè½½å‡è¡¡ï¼Œå°†å·¥ä½œåˆ†é…åˆ°å„ä¸ªå‰¯æœ¬ä¸Š è§‚å¯Ÿåˆ°åœ¨å®è·µä¸­åå‘ä¼ æ’­æ€»æ˜¯æ¯”å‰å‘ä¼ æ’­è€—æ—¶æ›´é•¿ã€‚1F1B-RR ä»ç„¶æ˜¯ä¸€ç§æœ‰æ•ˆçš„è°ƒåº¦æœºåˆ¶ ","date":"2025-02-24","objectID":"/posts/paper-pipedream/:5:2","tags":["Paper Reading","Deep Learning","Training"],"title":"Paper Reading: PipeDream: Generalized Pipeline Parallelism for DNN Training [SOSP2019]","uri":"/posts/paper-pipedream/"},{"categories":null,"content":"Challenge3: Effective Learning åœ¨ä¸€ä¸ªç®€å•çš„æµæ°´çº¿ç³»ç»Ÿä¸­ï¼Œæ¯ä¸ªé˜¶æ®µçš„å‰å‘ä¼ æ’­ä½¿ç”¨ä¸€ä¸ªç‰ˆæœ¬çš„å‚æ•°ï¼Œè€Œå…¶åå‘ä¼ æ’­åˆ™ä½¿ç”¨å¦ä¸€ä¸ªç‰ˆæœ¬çš„å‚æ•° å› æ­¤ï¼Œåœ¨é˜¶æ®µ 1 ä¸­ï¼Œå°æ‰¹é‡æ•°æ® 5 çš„åå‘ä¼ æ’­ä¸­ä½¿ç”¨çš„æƒé‡ä¸å¯¹åº”å‰å‘ä¼ æ’­ä¸­ä½¿ç”¨çš„æƒé‡ä¸åŒï¼›è¿™ç§æƒé‡ç‰ˆæœ¬çš„ä¸ä¸€è‡´ä¼šå¯¼è‡´æ— æ•ˆçš„æ¢¯åº¦ï¼Œå¹¶å¯èƒ½é˜»æ­¢æ¨¡å‹æ”¶æ•›ã€‚ Solution: PipeDream ä½¿ç”¨ä¸€ç§ç§°ä¸ºæƒé‡æš‚å­˜ï¼ˆweight stashingï¼‰çš„æŠ€æœ¯æ¥é¿å…å‰å‘ä¼ æ’­å’Œåå‘ä¼ æ’­ä¸­ä½¿ç”¨çš„æƒé‡ç‰ˆæœ¬ä¹‹é—´çš„æ ¹æœ¬æ€§ä¸åŒ¹é…ã€‚ Memory Overheadï¼šæµæ°´çº¿å¹¶ä¸ä¼šæ˜¾è‘—å¢åŠ æ¯ä¸ªå·¥ä½œèŠ‚ç‚¹çš„å†…å­˜ä½¿ç”¨é‡ï¼Œå³ä½¿ä½¿ç”¨æƒé‡æš‚å­˜ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ ","date":"2025-02-24","objectID":"/posts/paper-pipedream/:5:3","tags":["Paper Reading","Deep Learning","Training"],"title":"Paper Reading: PipeDream: Generalized Pipeline Parallelism for DNN Training [SOSP2019]","uri":"/posts/paper-pipedream/"},{"categories":null,"content":"Implementation PipeDream çš„æ¥å£å®ç°ä¸ºä¸€ä¸ªç‹¬ç«‹çš„ Python åº“ï¼Œçº¦ 3000 è¡Œä»£ç ï¼Œè´Ÿè´£ç®¡ç†è®¾å¤‡å†…å­˜ã€è°ƒåº¦å·¥ä½œå¹¶å¤„ç†é€šä¿¡ã€‚ PipeDream ä½¿ç”¨ PyTorch è¿›è¡Œè‡ªåŠ¨å¾®åˆ†å’Œæ‰§è¡Œç®—å­ï¼›ç„¶è€Œï¼ŒPipeDream æ˜¯å¯æ‰©å±•çš„ï¼Œå¹¶ä¸”å¯ä»¥ä¸å…¶ä»–æœºå™¨å­¦ä¹ æ¡†æ¶ï¼ˆå¦‚ TensorFlowã€MXNet å’Œ CNTKï¼‰ä¸€èµ·å·¥ä½œã€‚ Parameter State: PipeDream å°†æ‰€æœ‰ä¸é˜¶æ®µç›¸å…³çš„å‚æ•°ç›´æ¥ä¿å­˜åœ¨ GPU å†…å­˜ä¸­ï¼Œåªæœ‰åœ¨ä½¿ç”¨æ›´æ–°å‚æ•°çš„å‘åä¼ æ’­å®Œæˆåï¼Œå‚æ•°æ‰ä¼šè¢«ä¸¢å¼ƒã€‚ Intermediate State: æ¯ä¸ªé˜¶æ®µçš„è¾“å…¥å’Œè¾“å‡ºæ•°æ®è¢«åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„ blob IDã€‚å½“ä»å‰ä¸€ä¸ªé˜¶æ®µï¼ˆæˆ–è¾“å…¥é˜¶æ®µä»ç£ç›˜ï¼‰æ¥æ”¶åˆ°ä¸­é—´æ•°æ®æ—¶ï¼ŒPipeDream å°†ä¸­é—´æ•°æ®å¤åˆ¶åˆ° GPU å†…å­˜ä¸­ï¼Œå¹¶å°†æŒ‡å‘ç›¸å…³ç¼“å†²åŒºçš„æŒ‡é’ˆæ”¾å…¥å·¥ä½œé˜Ÿåˆ—ä¸­ Stage Replication: PipeDream ä½¿ç”¨ PyTorch çš„ DistributedDataParallel åº“ [6] æ¥åŒæ­¥æ•°æ®å¹¶è¡Œé˜¶æ®µçš„å±‚çš„å‚æ•°ã€‚ Checkpointing: PipeDream æ”¯æŒå®šæœŸæ£€æŸ¥æ¨¡å‹å‚æ•°ä»¥å®ç°å®¹é”™ï¼Œé»˜è®¤åœ¨æ¯ä¸ª epoch ç»“æŸæ—¶è·¨é˜¶æ®µåˆ›å»ºæ£€æŸ¥ç‚¹ã€‚ ","date":"2025-02-24","objectID":"/posts/paper-pipedream/:6:0","tags":["Paper Reading","Deep Learning","Training"],"title":"Paper Reading: PipeDream: Generalized Pipeline Parallelism for DNN Training [SOSP2019]","uri":"/posts/paper-pipedream/"},{"categories":null,"content":"EVALUATION PipeDream åœ¨ä¸åŒç¡¬ä»¶éƒ¨ç½²ä¸Šçš„å¤šç§å­¦ä¹ ä»»åŠ¡ä¸­æ˜¾è‘—åŠ é€Ÿäº†è¾¾åˆ°ç›®æ ‡ç²¾åº¦çš„æ—¶é—´ï¼› PipeDream æ¯”å…¶ä»–æœ€è¿‘æå‡ºçš„è·¨æ‰¹æ¬¡æ–¹æ³•æ›´é«˜æ•ˆï¼› PipeDream å¤§å¤§å‡å°‘äº†é€šä¿¡å¼€é”€ï¼Œå¹¶ä¸”ä¸æ•°æ®å¹¶è¡Œè®­ç»ƒç›¸æ¯”ï¼Œå¹¶æœªæ˜¾è‘—å¢åŠ å†…å­˜å ç”¨ï¼› ç»“åˆæµæ°´çº¿å¹¶è¡Œã€æ¨¡å‹å¹¶è¡Œå’Œæ•°æ®å¹¶è¡Œä¼˜äºå•ç‹¬çš„æ¨¡å‹å¹¶è¡Œã€æ•°æ®å¹¶è¡Œæˆ–æ··åˆå¹¶è¡Œã€‚ å‡å°‘é€šä¿¡å¼€é”€ï¼Œå¹¶æœªæ˜¾è‘—å¢åŠ å†…å­˜å ç”¨ æ‰¹æ¬¡å¦‚ä½•è®¾ç½®ï¼Ÿ Batch Sizes and Training Methodology: æˆ‘ä»¬ä½¿ç”¨é€‚åˆå•ä¸ª GPU å†…å­˜çš„æœ€å¤§æ¯ GPU å°æ‰¹é‡æ•°æ®â€”â€”æ›´å¤§çš„æ‰¹é‡ä¼šå¯¼è‡´å†…å­˜ä¸è¶³å¼‚å¸¸ã€‚è¿™ç¡®ä¿æˆ‘ä»¬åœ¨å•ä¸ªè®¾å¤‡ä¸Šè¾¾åˆ°å³°å€¼ FLOPsã€‚ ","date":"2025-02-24","objectID":"/posts/paper-pipedream/:7:0","tags":["Paper Reading","Deep Learning","Training"],"title":"Paper Reading: PipeDream: Generalized Pipeline Parallelism for DNN Training [SOSP2019]","uri":"/posts/paper-pipedream/"},{"categories":null,"content":"Comparison to Data Parallelism è¡¨ 1 æ€»ç»“äº† PipeDream ä¸æ•°æ®å¹¶è¡Œè®­ç»ƒï¼ˆDPï¼‰çš„æ¯”è¾ƒç»“æœã€‚è¡¨ä¸­æ˜¾ç¤ºäº† PipeDream è‡ªåŠ¨ç”Ÿæˆçš„é…ç½®åŠå…¶åœ¨è¾¾åˆ°ç›®æ ‡ç²¾åº¦è®­ç»ƒæ—¶é—´ä¸Šç›¸å¯¹äºç›¸åº”æ•°æ®å¹¶è¡Œé…ç½®çš„åŠ é€Ÿæ¯”ã€‚ ","date":"2025-02-24","objectID":"/posts/paper-pipedream/:7:1","tags":["Paper Reading","Deep Learning","Training"],"title":"Paper Reading: PipeDream: Generalized Pipeline Parallelism for DNN Training [SOSP2019]","uri":"/posts/paper-pipedream/"},{"categories":null,"content":"Comparison to Other Intra-batch Parallelism Schemes Model Parallelism: For VGG-16 and AlexNet 14.9x and 6.5x ","date":"2025-02-24","objectID":"/posts/paper-pipedream/:7:2","tags":["Paper Reading","Deep Learning","Training"],"title":"Paper Reading: PipeDream: Generalized Pipeline Parallelism for DNN Training [SOSP2019]","uri":"/posts/paper-pipedream/"},{"categories":null,"content":"Comparison to Inter-batch Parallelism Gpipe: These throughput slow downs are largely due to more frequent pipeline flushes compared to PipeDream ","date":"2025-02-24","objectID":"/posts/paper-pipedream/:7:3","tags":["Paper Reading","Deep Learning","Training"],"title":"Paper Reading: PipeDream: Generalized Pipeline Parallelism for DNN Training [SOSP2019]","uri":"/posts/paper-pipedream/"},{"categories":null,"content":"Microbenchmarks ä¼˜åŒ–å™¨ï¼šPipeDream çš„ä¼˜åŒ–å™¨éå¸¸é«˜æ•ˆï¼Œå¯¹äºæ‰€æœ‰è¯„ä¼°çš„æ¨¡å‹å’Œç¡¬ä»¶éƒ¨ç½²ï¼Œç”Ÿæˆæœ€ä½³è®­ç»ƒé…ç½®çš„æ—¶é—´ä¸åˆ° 8 ç§’ã€‚ å†…å­˜å ç”¨ï¼šå›¾ 16 æ˜¾ç¤ºäº† PipeDream åœ¨ 4 é˜¶æ®µé…ç½®ä¸‹ä¸‰ä¸ªä¸åŒæ¨¡å‹çš„æ¯é˜¶æ®µå†…å­˜å ç”¨ã€‚PipeDream çš„æœ€åæƒ…å†µå†…å­˜å ç”¨ä¸æ•°æ®å¹¶è¡Œç›¸å½“ï¼Œå°½ç®¡ PipeDream å­˜å‚¨äº†å¤šä¸ªæƒé‡å’Œæ¿€æ´»ç‰ˆæœ¬ã€‚ é€šä¿¡å¼€é”€ï¼š æµæ°´çº¿æ·±åº¦çš„å½±å“ï¼šæœ€ä½³é DP é…ç½®çš„é€šä¿¡å¼€é”€è¿œä½äº DP é…ç½®çš„é€šä¿¡å¼€é”€ optimizer å¦‚ä½•å®ç°ï¼Ÿ ","date":"2025-02-24","objectID":"/posts/paper-pipedream/:7:4","tags":["Paper Reading","Deep Learning","Training"],"title":"Paper Reading: PipeDream: Generalized Pipeline Parallelism for DNN Training [SOSP2019]","uri":"/posts/paper-pipedream/"},{"categories":null,"content":"CONCLUSION æµæ°´çº¿å¹¶è¡Œçš„ DNN è®­ç»ƒæœ‰åŠ©äºå‡å°‘å¯èƒ½æˆä¸ºæ‰¹æ¬¡å†…å¹¶è¡Œç“¶é¢ˆçš„é€šä¿¡å¼€é”€ã€‚PipeDream è‡ªåŠ¨å°† DNN è®­ç»ƒåˆ’åˆ†åˆ°å¤šä¸ªå·¥ä½œèŠ‚ç‚¹ä¸Šï¼Œç»“åˆè·¨æ‰¹æ¬¡æµæ°´çº¿ä¸æ‰¹æ¬¡å†…å¹¶è¡Œï¼Œä»¥æ›´å¥½åœ°é‡å è®¡ç®—ä¸é€šä¿¡ï¼ŒåŒæ—¶æœ€å°åŒ–é€šä¿¡æ•°æ®é‡ã€‚ pipeline çš„å®ç°ï¼Ÿå¾ˆå¥½å¥‡ optimizer å¦‚ä½•å®ç°ï¼Œprofiling æ˜¯æå‰é‡‡æ ·å—ï¼Ÿ åŸºäº pytorch çš„ç®€å•å®ç° PipeDream å®ç° åœ¨ gpipe å’Œ pipedream æœ‰ä¸ªå¾ˆæœ‰æ„æ€çš„ tradeoffï¼š ç”±äº GPU æ˜¾å­˜åè€Œæ›´åŠ çè´µï¼Œä¼šä½¿ç”¨ checkpoint æ—¶é—´æ¢ç©ºé—´ pipedream æ›´åŠ åå‘å¼‚æ­¥ã€gpipe æ˜¯åŒæ­¥ ","date":"2025-02-24","objectID":"/posts/paper-pipedream/:8:0","tags":["Paper Reading","Deep Learning","Training"],"title":"Paper Reading: PipeDream: Generalized Pipeline Parallelism for DNN Training [SOSP2019]","uri":"/posts/paper-pipedream/"},{"categories":null,"content":"â€œManualâ€ Neural Networks / Backprop è¿˜æ˜¯å¤ä¹  ML çš„å†…å®¹ From linear to nonlinear hypothesis classes Neural networks Backpropagation (i.e., computiing gradients) hypothesis classes æ˜¯ç”¨äºæ¨¡å‹è®­ç»ƒçš„å‡½æ•°ç±»å‹ çº¿æ€§å‡è®¾ç±»ã€éçº¿æ€§å‡è®¾ç±» å¤šé¡¹å¼å›å½’æˆ–ç¥ç»ç½‘ç»œç­‰æ¨¡å‹éƒ½å±äºéçº¿æ€§å‡è®¾ç±»ï¼Œèƒ½æ•æ‰æ›´å¤æ‚çš„å…³ç³» ä»¥ä¸‹æ˜¯ä¸€ä¸ªä¸¤å±‚ç¥ç»ç½‘ç»œçš„ç®€åŒ–è¡¨ç¤ºï¼š $$h_\\theta(x) = \\theta_2^T \\sigma(W_1^T x)$$ å…¶ä¸­ï¼Œ$W_1$ å’Œ $W_2$ æ˜¯æƒé‡çŸ©é˜µï¼Œ$\\sigma$æ˜¯éçº¿æ€§æ¿€æ´»å‡½æ•°ï¼Œå¦‚ ReLU æˆ– sigmoidã€‚ ","date":"2025-02-10","objectID":"/posts/ml-sys-02/:1:0","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 02-03 Neural Networks","uri":"/posts/ml-sys-02/"},{"categories":null,"content":"nonlinear hypothesis classes linear hypothesis classes: $h_\\theta(x) = \\theta^T x$ çº¿æ€§çš„åˆ†ç±»å¯èƒ½å¯ä»¥ fit ä¸€äº›æƒ…å†µï¼Œä½†å¦‚æœç±»å‹æ˜¯åˆ†æ•£çš„åœ†åœˆç­‰ç­‰æƒ…å†µï¼Œå¯èƒ½éš¾ä»¥æ‹Ÿåˆï¼Ÿ One idea: apply a linear classifier to some (potentially higher-dimensional) features of the data: $h_\\theta(x) = \\theta^T \\phi(x), \\theta \\in R^{d\\times k}, \\phi: R^n \\rightarrow R^d$ phi æŠŠ n ç»´çš„è¾“å…¥å˜æˆ d ç»´çš„ éšè—å±‚èŠ‚ç‚¹çš„æ¿€æ´»å‡½æ•°ï¼ˆå¦‚ ReLUï¼‰å¯ä»¥è§†ä¸ºä¸€ç§éçº¿æ€§ç‰¹å¾æ˜ å°„ï¼Œè¿™ä½¿å¾—ç¥ç»ç½‘ç»œèƒ½å¤Ÿæ•æ‰åˆ°æ•°æ®ä¸­çš„å¤æ‚éçº¿æ€§å…³ç³»ã€‚ ","date":"2025-02-10","objectID":"/posts/ml-sys-02/:2:0","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 02-03 Neural Networks","uri":"/posts/ml-sys-02/"},{"categories":null,"content":"How do we create features? manual engineering, the â€œoldâ€ way of doing machine learning In a way that itself is learned from data, the â€œnewâ€ way of doing ML ä¼ ç»Ÿæœºå™¨å­¦ä¹ ï¼Œæ‰‹åŠ¨æå–ç‰¹å¾æ¯”å¦‚æˆ¿ä»·é¢„æµ‹é‡Œçš„é¢ç§¯ã€æˆ¿é—´ç‰¹å¾ ","date":"2025-02-10","objectID":"/posts/ml-sys-02/:2:1","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 02-03 Neural Networks","uri":"/posts/ml-sys-02/"},{"categories":null,"content":"Neural networks / deep learning Neural Network, a particular type of hypothesis class, multiple, parameterized differentiable functions (a.k.a. â€œlayersâ€) composed together Deep Network, synonym for â€œneural networkâ€, composing together a lot of functions, so â€œdeepâ€ is typically an appropriate qualifier æ·±åº¦å­¦ä¹ ï¼ŒæŒ‡çš„å°±æ˜¯ç”¨ç¥ç»ç½‘ç»œçš„æœºå™¨å­¦ä¹ ï¼Ÿ two layer neural network $h_\\theta(x) = W^T_2\\sigma(W_1^Tx)$ where $\\sigma: R \\rightarrow R$ is nonlinear function like ReLU or sigmoid $\\sigma$ éçº¿æ€§å‡½æ•°, æ¯”å¦‚ ReLUï¼Œsigmod $\\theta$ å¯ä»¥çœ‹ä½œæ˜¯å‚æ•° batch matrix form: $$ h_\\theta(X) = \\sigma(X W_1) W_2 $$ ä¸ºä»€ä¹ˆåŠ ä¸€ä¸ª non linear å°±å¯ä»¥è¡¨ç¤ºè¿™ä¹ˆå¤šç»“æœï¼Ÿ æ•°å­¦ä¸Šï¼šç¥ç»ç½‘ç»œå·²ç»è¢«è¯æ˜ä¸ºé€šç”¨å‡½æ•°é€¼è¿‘å™¨ï¼ˆUniversal Function Approximatorsï¼‰ ç†è®ºä¸Šï¼Œåªè¦ç½‘ç»œç»“æ„è¶³å¤Ÿå¤æ‚ï¼ˆéšè—å•å…ƒå’Œå±‚æ•°è¶³å¤Ÿå¤šï¼‰ï¼Œå®ƒå°±èƒ½è¿‘ä¼¼ä»»ä½•è¿ç»­å‡½æ•°ã€‚ ä¹‹å‰å­¦è¿‡ä¸€ç‚¹æ•°å€¼è®¡ç®—ï¼Œå½“æ—¶è¿˜æ²¡æ¥è§¦åˆ°éçº¿æ€§å‡½æ•°å¯ä»¥æ‹Ÿåˆçš„å‡½æ•°ï¼ŒåŸºæœ¬éƒ½æ˜¯çº¿æ€§/æŒ‡æ•°æˆ–è€…åˆ†æ®µ/å¹³æ»‘ç­‰ç­‰ï¼Œåº”è¯¥ç»§ç»­å­¦ä¸€ä¸‹éçº¿æ€§æ‹Ÿåˆçš„ ","date":"2025-02-10","objectID":"/posts/ml-sys-02/:2:2","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 02-03 Neural Networks","uri":"/posts/ml-sys-02/"},{"categories":null,"content":"Fully-connected deep networks ğ¿-layer neural network â€“ a.k.a. â€œMulti-layer perceptronâ€ (MLP) $$Z_{i+1} = \\sigma_i(Z_i W_i), \\quad i = 1, \\dots, L$$ $$h_\\theta(X) = Z_{L+1}$$ æ¯ä¸€å±‚çš„è¾“å…¥éƒ½æ˜¯ä¸Šä¸€å±‚çš„ éçº¿æ€§å‡½æ•° (è¾“å‡º x æƒé‡çŸ©é˜µ) ","date":"2025-02-10","objectID":"/posts/ml-sys-02/:3:0","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 02-03 Neural Networks","uri":"/posts/ml-sys-02/"},{"categories":null,"content":"why deep networks? work like the brain? parity å¥‡å¶æ€§æ— æ³•å­¦ä¹ ï¼Ÿ empirically it seems like they work better for a fixed parameter count å¤šå±‚ç»“æ„/æ·±å±‚ç½‘ç»œèƒ½æ›´å‡åŒ€åœ°åˆ†å¸ƒå‚æ•° ","date":"2025-02-10","objectID":"/posts/ml-sys-02/:4:0","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 02-03 Neural Networks","uri":"/posts/ml-sys-02/"},{"categories":null,"content":"Backpropagation neural networks: Hypothesis Class: MLP Loss function: cross-entropy loss Optimization procedure: SGD $$\\min_\\theta \\frac{1}{m} \\sum_{i=1}^m \\ell_{ce}(h_\\theta(x_i), y_i) $$ æˆ‘çŸ¥é“è¿™äº›ç»„ä»¶ï¼Œä½†å…·ä½“å¦‚ä½•è¿ä½œï¼Ÿ ","date":"2025-02-10","objectID":"/posts/ml-sys-02/:5:0","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 02-03 Neural Networks","uri":"/posts/ml-sys-02/"},{"categories":null,"content":"The gradient(s) of a two-layer network $$ \\nabla_{{W_1, W_2}} \\ell_{ce}(\\sigma((XW_1)W_2), y) = \\sigma(XW_1)^T \\cdot (S - I_y) $$ é“¾å¼æ³•åˆ™ï¼ˆchain ruleï¼‰è®¡ç®—åå¯¼æ•° åå¯¼æ•°æ˜¯å¤šå˜é‡å‡½æ•°å¯¹å…¶ä¸­ä¸€ä¸ªå˜é‡çš„å˜åŒ–ç‡ï¼Œè€Œä¿æŒå…¶ä»–å˜é‡å›ºå®šä¸å˜ æ¢¯åº¦æ˜¯å¤šå˜é‡å‡½æ•°æ‰€æœ‰åå¯¼æ•°ç»„æˆçš„å‘é‡ï¼Œæ¢¯åº¦çš„æ–¹å‘ç”¨äºæè¿°å‡½æ•°å€¼å¢é•¿æœ€å¿«çš„è·¯å¾„ï¼Œè´Ÿæ–¹å‘æ˜¯å‡½æ•°å€¼ä¸‹é™æœ€å¿«çš„è·¯å¾„ å¯¹å¤šå…ƒå‡½æ•°ï¼Œå‡è®¾æœ‰ä¸ªåˆå§‹ç‚¹ $(x_0, y_0)$ å¯ä»¥æ±‚å‡ºæ¢¯åº¦ï¼Œæ›´æ–°å…¶å€¼ $x_1 = x_0 - \\eta \\cdot \\frac{\\partial f}{\\partial x}$ å…¶ä¸­ $\\eta$ æ˜¯å­¦ä¹ ç‡ï¼Œä¸€æ—¦æ¢¯åº¦è¶³å¤Ÿå°ï¼Œå°±å¯ä»¥å‡å°‘åŸå‡½æ•°çš„å€¼ï¼Œä¹Ÿå°±æ˜¯æŸå¤±å‡½æ•°çš„å€¼å‡å°‘ ","date":"2025-02-10","objectID":"/posts/ml-sys-02/:5:1","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 02-03 Neural Networks","uri":"/posts/ml-sys-02/"},{"categories":null,"content":"Backpropagation â€œin generalâ€ consider our fully-connected network $$ Z_{i+1} = \\sigma_i(Z_i W_i), i = 1, â€¦, L \\ \\frac{\\partial \\ell}{\\partial W_i} = \\frac{\\partial \\ell}{\\partial Z_{L+1}} \\cdot \\frac{\\partial Z_{L+1}}{\\partial Z_L} \\cdot \\frac{\\partial Z_L}{\\partial Z_{L-1}} \\cdot \\ldots \\cdot \\frac{\\partial Z_{i+2}}{\\partial Z_{i+1}} \\cdot G_{i+1} $$ Then we have a simple â€backwardâ€ iteration to compute the $G_i$â€™s $$ G_i = G_{i+1} \\cdot \\frac{\\partial \\ell}{\\partial Z_{i+1}} $$ ","date":"2025-02-10","objectID":"/posts/ml-sys-02/:6:0","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 02-03 Neural Networks","uri":"/posts/ml-sys-02/"},{"categories":null,"content":"Computing the real gradients $$ \\nabla_{W_i} \\ell = Z_i^T \\cdot (G_{i+1} \\circ \\sigma_iâ€™(Z_i W_i)) $$ é“¾å¼æ³•åˆ™çŸ©é˜µè®¡ç®—æ˜¯åå‘ä¼ æ’­ï¼ˆBackpropagationï¼‰çš„æ ¸å¿ƒæ€æƒ³ã€‚å®ƒåˆ©ç”¨é“¾å¼æ³•åˆ™ï¼ˆChain Ruleï¼‰å’ŒçŸ©é˜µè®¡ç®—ï¼Œé€å±‚å‘åä¼ é€’è¯¯å·® å…¶ä¸­ $Z_i$ æ˜¯å¯ä»¥å¤ç”¨çš„ ","date":"2025-02-10","objectID":"/posts/ml-sys-02/:6:1","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 02-03 Neural Networks","uri":"/posts/ml-sys-02/"},{"categories":null,"content":"Backpropagation: Forward and backward passes ä¸ºä»€ä¹ˆè¿™äº›è®¡ç®—æ˜¯â€œåŒæ—¶â€å‘ç”Ÿçš„ï¼Ÿ å‰å‘ä¼ æ’­çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å·²ç»ç¼“å­˜äº†æ¯ä¸€å±‚çš„è¾“å‡º $Z_i$ å’Œæ¿€æ´»å‡½æ•°çš„å¯¼æ•° $\\sigmaâ€™(Z_i W_i)$ åå‘ä¼ æ’­æ—¶ï¼Œåˆ©ç”¨è¿™äº›ç¼“å­˜å€¼ç›´æ¥è¿›è¡Œæ¢¯åº¦è®¡ç®—ï¼Œé¿å…é‡å¤è®¡ç®—ä¸­é—´å€¼ã€‚ What is really happening with the backward iteration? $$ \\frac{\\partial \\ell}{\\partial W_i} = \\frac{\\partial Z_{i+1}}{\\partial W_i} \\cdot \\frac{\\partial \\ell}{\\partial Z_{L+1}} \\cdot \\frac{\\partial Z_{L+1}}{\\partial Z_L} \\cdot \\ldots \\cdot \\frac{\\partial Z_{i+2}}{\\partial Z_{i+1}} $$ Each layer needs to be able to multiply the â€œincoming backwardâ€ gradient $G_{i+1}$ by its derivatives $\\frac{\\partial Z_{i+1}}{\\partial W_i}$ an operation called the â€œvector Jacobian productâ€ automatic differentiation æ¯ä¸€å±‚çš„æ¢¯åº¦ $G_i$ æ˜¯ä»åä¸€å±‚çš„æ¢¯åº¦ $G_{i+1}$ é€’å½’è®¡ç®—å¾—åˆ°ã€‚ å‘é‡é›…å¯æ¯”ä¹˜ç§¯ åå‘ä¼ æ’­å¯ä»¥æ¨å¹¿åˆ°ä»»æ„è®¡ç®—å›¾ï¼Œæˆä¸ºå®ç°è‡ªåŠ¨å¾®åˆ†çš„åŸºç¡€ ","date":"2025-02-10","objectID":"/posts/ml-sys-02/:6:2","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 02-03 Neural Networks","uri":"/posts/ml-sys-02/"},{"categories":null,"content":"Deep Learning Systems https://dlsyscourse.org/ 10-414/714: Deep Learning Systems è¿™å­¦æœŸé€‰äº† ML systemsï¼Œä¸€äº› DL çš„æ¦‚å¿µä¸å¤ªç†Ÿæ‚‰ï¼Œè¡¥ä¸€ä¸‹ Tianqi Chen å¤§ç¥çš„è¯¾ ","date":"2025-02-05","objectID":"/posts/ml-sys-01/:1:0","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 01 Softmax","uri":"/posts/ml-sys-01/"},{"categories":null,"content":"Introduction AlexNet: Image Classification AlphaGo, StyleGAN, GPT-3, stable diffusion â€¦ DL æ˜¯æ·±åº¦ç¥ç»ç½‘ç»œï¼Œè¶Šæ·±è¶Šå¥½å—ï¼Ÿ transformer å’Œ GAN ä¹Ÿéƒ½æ˜¯æ·±åº¦å­¦ä¹  CNNï¼šå·ç§¯å±‚ã€æ± åŒ–ã€å…¨è¿æ¥ RNN, LSTM, GAN, Transformerâ€¦ Pytorch, Tensorflow, â€¦ æ·±åº¦å­¦ä¹ å’Œä¼ ç»Ÿæœºå™¨å­¦ä¹ çš„åŒºåˆ«æ˜¯è‡ªåŠ¨å¾®åˆ†å—ï¼Ÿ ","date":"2025-02-05","objectID":"/posts/ml-sys-01/:2:0","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 01 Softmax","uri":"/posts/ml-sys-01/"},{"categories":null,"content":"ML Refresher / Softmax Regression å›é¡¾ ML é‡Œçš„å›¾åƒè¯†åˆ«ä»»åŠ¡ å…¶å®ä¸çŸ¥é“è¦ä¸è¦å…ˆçœ‹çœ‹ ML çš„åŸºç¡€è¯¾ï¼Œå¾ˆå¤š ML çš„åŸºç¡€ä¹Ÿä¸å¤ªè®°å¾—äº† Machine Learning as data-driven programming classify handwritten drawing of digits computers dont see pics like us (supervised) ML approach: train with known labels -\u003e ML algo -\u003e Model h ","date":"2025-02-05","objectID":"/posts/ml-sys-01/:3:0","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 01 Softmax","uri":"/posts/ml-sys-01/"},{"categories":null,"content":"3 ingredients hypothesis class: program structure, a set of parameters, how we map inputs (images of digits) to ouputs (labels, probabilities) loss function: a function specifies how well a given hypothesis performs optimization method: a procedure for determining a set of params that minimize the sum of losses over the training set æ¡†æ¶éƒ½æ˜¯ä¸€æ ·çš„ ","date":"2025-02-05","objectID":"/posts/ml-sys-01/:3:1","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 01 Softmax","uri":"/posts/ml-sys-01/"},{"categories":null,"content":"softmax regression $$ \\begin{align} x^{(i)} \u0026 \\in \\mathbb{R}^n \\ y^{(i)} \u0026 \\in {1, \\ldots, k} \\quad \\text{for} \\quad i = 1, \\ldots, m \\end{align} $$ $\\mathbb{R}$ è¡¨ç¤ºå®æ•°é›†ï¼ˆReal numbersï¼‰ã€‚å› æ­¤ï¼Œå…¬å¼ä¸­çš„ $x^{(i)} \\in \\mathbb{R}^n $ æ„æ€æ˜¯æ¯ä¸ªæ•°æ®ç‚¹ $x^{(i)}$ æ˜¯ä¸€ä¸ª $n$ ç»´çš„å®æ•°å‘é‡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ$x^{(i)}$ æ˜¯ä¸€ä¸ªåŒ…å« $n$ ä¸ªå®æ•°çš„å‘é‡ï¼Œæ¯ä¸ªæ•°æ®ç‚¹çš„ç‰¹å¾å‘é‡ã€‚ æ¯”å¦‚ $x^{(i)} = \\begin{pmatrix} 2.5 \\ -1.0 \\ 3.7 \\end{pmatrix} \\in \\mathbb{R}^3$ $y^{(i)}$ æ˜¯æ¯ä¸ªæ•°æ®ç‚¹å¯¹åº”çš„æ ‡ç­¾ $n$ è¾“å…¥æ•°æ®çš„ç»´åº¦ï¼ˆç‰¹å¾æ•°é‡ï¼‰ $k$ ç±»åˆ«çš„æ•°é‡ï¼Œä¹Ÿå°±æ˜¯ 0 åˆ° 9 çš„æ•°å­— $m$ è®­ç»ƒé›†ä¸­çš„æ•°æ®ç‚¹æ•°é‡ Our hypothesis function maps inputs $x^{(i)} \\in \\mathbb{R}^n$ to $k$-dimensional vectors $$ h: \\mathbb{R}^ğ‘› \\rightarrow \\mathbb{R}^k $$ $h_i(x)$ indicates some measure of â€œbeliefâ€ in how much likely the label is to be class $i$ h_i è¡¨ç¤ºæ˜¯ class i çš„â€œå¯èƒ½æ€§â€ï¼Œä½†ç›®å‰ä¸ä¸€å®šæ˜¯æ¦‚ç‡ï¼Ÿ A linear hypothesis function uses a linear operator (i.e. matrix multiplication) for this transformation çº¿æ€§å‡è®¾å‡½æ•°ï¼Œå°†è¾“å…¥ n ç»´è¾“å…¥ x æ˜ å°„åˆ° k ç»´ çº¿æ€§å‡è®¾å‡½æ•°ä½¿ç”¨çº¿æ€§ç®—å­ï¼ˆå³çŸ©é˜µä¹˜æ³•ï¼‰è¿›è¡Œè¿™ç§å˜æ¢ $$ h_\\theta(x) = \\theta^T x $$ å…¶ä¸­ $\\theta$ æ˜¯ $n\\times k$ ç»´åº¦çš„ï¼Œä¸€ä¸ªæƒé‡çŸ©é˜µï¼Œæœ€åè¾“å‡ºä¸€ä¸ª k ç»´å‘é‡ï¼Œæ¯ä¸ªå…ƒç´ å¯¹åº”æ¯ä¸ªç±»åˆ«çš„ç½®ä¿¡åº¦ ","date":"2025-02-05","objectID":"/posts/ml-sys-01/:3:2","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 01 Softmax","uri":"/posts/ml-sys-01/"},{"categories":null,"content":"Matrix batch notation çŸ©é˜µè¿ç®—æ›´åŠ é«˜æ•ˆï¼ŒGPU/CPU ","date":"2025-02-05","objectID":"/posts/ml-sys-01/:3:3","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 01 Softmax","uri":"/posts/ml-sys-01/"},{"categories":null,"content":"Loss Function classification error $$ \\ell_{\\text{err}}(h(x), y) = \\begin{cases} 0 \u0026 \\text{if } \\arg\\max_i h_i(x) = y \\ 1 \u0026 \\text{otherwise} \\end{cases} $$ åˆ†ç±»é”™è¯¯æŸå¤±å‡½æ•°ï¼Œåªæ£€æŸ¥åˆ†ç±»æ˜¯å¦å¤±è´¥ argmax å°±æ˜¯å–æœ€å¤§çš„å¯èƒ½æ€§ï¼Œæ˜¯å¦ç­‰äºæ ‡ç­¾ y åˆ†ç±»é”™è¯¯æŸå¤±å‡½æ•°ä¸é€‚åˆä½œä¸ºä¼˜åŒ–è¿‡ç¨‹ä¸­é€‰æ‹©æœ€ä½³å‚æ•°çš„æŸå¤±å‡½æ•°ï¼Œå› ä¸ºå®ƒä¸å¯å¾®åˆ† åœ¨ä¼˜åŒ–ç®—æ³•ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦ç”¨åˆ°æ¢¯åº¦ä¿¡æ¯ï¼Œè€Œåˆ†ç±»é”™è¯¯æŸå¤±å‡½æ•°ç”±äºå…¶ç¦»æ•£çš„æ€§è´¨ï¼Œæ— æ³•æä¾›è¿ç»­çš„æ¢¯åº¦ã€‚ softmax / cross-entropy loss $$ z_i = p(\\text{label} = i | x) = \\frac{\\exp(h_i(x))}{\\sum_{j=1}^k \\exp(h_j(x))} $$ $h_i(x)$ æ˜¯å‡è®¾å‡½æ•°çš„ç¬¬ $i$ ä¸ªè¾“å‡ºã€‚ $k$ æ˜¯ç±»åˆ«çš„æ€»æ•°ã€‚ $p(\\text{label} = i | x)$ æ˜¯è¾“å…¥ $x$ å±äºç±»åˆ« $i$ çš„æ¦‚ç‡ã€‚ $$ \\ell_{ce}(h(x), y) = -\\log(p(\\text{label} = y | x)) = -h_y(x) + \\log \\left( \\sum*{j=1}^k \\exp(h_j(x)) \\right) $$ äº¤å‰ç†µæŸå¤±è¡¡é‡çš„æ˜¯é¢„æµ‹æ¦‚ç‡ä¸å®é™…ç±»åˆ«ä¹‹é—´çš„å·®å¼‚ã€‚å½“æ¨¡å‹å¯¹æ­£ç¡®ç±»åˆ«çš„é¢„æµ‹æ¦‚ç‡è¾ƒé«˜æ—¶ï¼ŒæŸå¤±è¾ƒä½ï¼›åä¹‹ï¼Œå½“æ¨¡å‹å¯¹é”™è¯¯ç±»åˆ«çš„é¢„æµ‹æ¦‚ç‡è¾ƒé«˜æ—¶ï¼ŒæŸå¤±è¾ƒé«˜ã€‚é€šè¿‡æœ€å°åŒ–äº¤å‰ç†µæŸå¤±ï¼Œæˆ‘ä»¬å¯ä»¥è®­ç»ƒæ¨¡å‹ï¼Œä½¿å…¶å¯¹æ­£ç¡®ç±»åˆ«çš„é¢„æµ‹æ¦‚ç‡æœ€å¤§åŒ–ã€‚ æœ€å°åŒ–çš„æ˜¯è´Ÿçš„å¯¹æ•°æ¦‚ç‡ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¸Œæœ›å¢åŠ æ­£ç¡®ç±»åˆ«çš„é¢„æµ‹æ¦‚ç‡ã€‚é€šè¿‡æœ€å°åŒ–è¿™ä¸ªæŸå¤±å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥è®­ç»ƒæ¨¡å‹ï¼Œä½¿å…¶å¯¹æ­£ç¡®ç±»åˆ«çš„é¢„æµ‹æ¦‚ç‡æœ€å¤§åŒ–ã€‚ ä¹Ÿå°±æ˜¯ä¸Šé¢å°†å…¶è½¬æˆäº†æ¦‚ç‡ï¼Œè¾“å…¥ä¸º x ä¸” label ä¸º i çš„æ¦‚ç‡ï¼Œé™¤æ‰€æœ‰ j å°†å…¶å½’ä¸€åŒ–ï¼Œå°±å˜æˆäº†é”™è¯¯æ¦‚ç‡ã€‚ äº¤å‰ç†µä¸ä¿¡æ¯è®ºï¼šhttps://zhuanlan.zhihu.com/p/149186719 åœ¨ Softmax å›å½’ï¼ˆæˆ–å¤šåˆ†ç±»é€»è¾‘å›å½’ï¼‰ä¸­ï¼Œå‡è®¾å‡½æ•°æ˜¯çº¿æ€§çš„ï¼Ÿé‚£ ReLU å‘¢ The softmax regression optimization problem $$ \\min_{\\theta} \\frac{1}{m} \\sum_{i=1}^{m} \\ell_{\\text{ce}}(h_{\\theta}(x_i), y_i) $$ $\\theta$ æ˜¯æ¨¡å‹å‚æ•° $m$ æ˜¯è®­ç»ƒé›†ä¸­æ ·æœ¬çš„æ•°é‡ã€‚ $x_i$ å’Œ $y_i$ åˆ†åˆ«æ˜¯ç¬¬ $i$ ä¸ªæ ·æœ¬çš„è¾“å…¥å’ŒçœŸå®æ ‡ç­¾ã€‚ $\\ell_{\\text{ce}}$ æ˜¯äº¤å‰ç†µæŸå¤±å‡½æ•°ã€‚ åœ¨è½¯æœ€å¤§å€¼å›å½’ä¸­ï¼Œå‡è®¾å‡½æ•°æ˜¯çº¿æ€§çš„ï¼Œå¹¶ä¸”ä½¿ç”¨è½¯æœ€å¤§å€¼æŸå¤±ï¼š $$ \\min*{\\theta} \\frac{1}{m} \\sum*{i=1}^{m} \\ell_{\\text{ce}}(\\theta^T x_i, y_i) $$ å°±æ˜¯æ‰¾åˆ°è¿™ä¸ª theta å‚æ•°ï¼Œè®¡ç®—æ¢¯åº¦ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œé€šå¸¸ä½¿ç”¨ä¸€ç§ç§°ä¸ºéšæœºæ¢¯åº¦ä¸‹é™ï¼ˆStochastic Gradient Descent, SGDï¼‰ ","date":"2025-02-05","objectID":"/posts/ml-sys-01/:3:4","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 01 Softmax","uri":"/posts/ml-sys-01/"},{"categories":null,"content":"Optimization: gradient descent the gradient is defined as the matrix of partial derivatives æ¢¯åº¦æ˜¯å‘é‡å‡½æ•°çš„ä¸€ä¸ªé‡è¦æ¦‚å¿µï¼Œç”¨äºæè¿°å‡½æ•°åœ¨ç‰¹å®šç‚¹çš„å˜åŒ–ç‡ æ¢¯åº¦ä¸‹é™æ˜¯ä¸€ç§ä¼˜åŒ–ç®—æ³•ï¼Œç”¨äºæœ€å°åŒ–ç›®æ ‡å‡½æ•° $f(\\theta)$ çš„å€¼ã€‚è¿™ä¸ªç®—æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡è¿­ä»£åœ°æ²¿ç€è´Ÿæ¢¯åº¦æ–¹å‘æ›´æ–°å‚æ•°ï¼Œä½¿å¾—ç›®æ ‡å‡½æ•°çš„å€¼é€æ¸å‡å°ã€‚ https://dlsyscourse.org/slides/2-softmax_regression.pdf å›¾è§£å¯ä»¥çœ‹å‡º $\\alpha$ æ˜¯ step size æˆ– learning rate å¤§äº 0 çš„æ—¶å€™ $\\theta$ å‘ç”Ÿå˜åŒ– $$ \\theta \\leftarrow \\theta - \\alpha \\nabla_{\\theta} f $$ ","date":"2025-02-05","objectID":"/posts/ml-sys-01/:3:5","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 01 Softmax","uri":"/posts/ml-sys-01/"},{"categories":null,"content":"Stochastic Gradient Descent éšæœºæ¢¯åº¦ä¸‹é™ ç”¨äºåœ¨æœºå™¨å­¦ä¹ æ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹ä¸­æœ€å°åŒ–æŸå¤±å‡½æ•°ã€‚ä¸ä¼ ç»Ÿçš„æ¢¯åº¦ä¸‹é™ä¸åŒï¼ŒSGD ä¸æ˜¯åœ¨æ¯æ¬¡æ›´æ–°æ—¶ä½¿ç”¨æ•´ä¸ªè®­ç»ƒé›†çš„æ•°æ®ï¼Œè€Œæ˜¯ä½¿ç”¨ä¸€ä¸ªå°çš„éšæœºæ•°æ®å­é›†ï¼ˆå³å°æ‰¹é‡ mini batchï¼‰ http://zh.gluon.ai/chapter_optimization/gd-sgd.html å°æ‰¹é‡éšæœºæ¢¯åº¦ä¸‹é™ï¼ˆSGDï¼‰å¼•å…¥äº†ä¸€å®šçš„éšæœºæ€§ï¼Œä½¿å¾—æ¨¡å‹å¯ä»¥æ›´å¿«è·³å‡ºå±€éƒ¨æœ€ä¼˜ï¼Œæœå…¨å±€æœ€ä¼˜æ”¶æ•›ã€‚è¿™ç§éšæœºæ€§æœ‰åŠ©äºåœ¨å¤æ‚çš„æŸå¤±å‡½æ•°ç©ºé—´ä¸­è¿›è¡Œæ›´æœ‰æ•ˆçš„æœç´¢ã€‚ $$ \\mathbf{\\theta} \\leftarrow \\mathbf{\\theta} - \\frac{\\alpha}{B} \\sum_{i=1}^B \\nabla_{\\mathbf{\\theta}} \\ell_i(h_{\\mathbf{\\theta}}(\\mathbf{x}_i), \\mathbf{y}_i) $$ ","date":"2025-02-05","objectID":"/posts/ml-sys-01/:3:6","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 01 Softmax","uri":"/posts/ml-sys-01/"},{"categories":null,"content":"The gradient of the softmax objective auto grad? å¦‚æœæ‰‹åŠ¨æ±‚å¯¼ï¼Œéœ€è¦é“¾å¼æ³•åˆ™ï¼Œä¼šå¾ˆå¤æ‚ å¤§éƒ¨åˆ†äººå½“æˆäº†æ ‡é‡ scalar æ­£å¼çš„æ–¹æ³•ï¼šä½¿ç”¨çŸ©é˜µå¾®ç§¯åˆ†ã€é›…å¯æ¯”çŸ©é˜µã€å…‹ç½—å†…å…‹ç§¯å’Œå‘é‡åŒ– vector æŠ€æœ¯ã€‚è¿™ç§æ–¹æ³•æ˜¯â€œæ­£ç¡®çš„æ–¹å¼â€ï¼Œæ›´åŠ ä¸¥è°¨å’Œç³»ç»Ÿï¼Œä½†ä¹Ÿæ›´åŠ å¤æ‚å’Œè´¹æ—¶ã€‚ å¤§å®¶å®é™…ä½¿ç”¨çš„æ·å¾„æ–¹æ³•ï¼šå‡è£…æ‰€æœ‰å˜é‡éƒ½æ˜¯æ ‡é‡ï¼Œä½¿ç”¨å…¸å‹çš„é“¾å¼æ³•åˆ™ï¼Œç„¶ååœ¨è®¡ç®—ç»“æœåé‡æ–°æ’åˆ—/è½¬ç½®çŸ©é˜µå’Œå‘é‡ï¼Œä½¿å…¶ç»´åº¦åŒ¹é…ã€‚è™½ç„¶è¿™ç§æ–¹æ³•ä¸é‚£ä¹ˆä¸¥è°¨ï¼Œä½†åœ¨å®é™…æ“ä½œä¸­æ›´åŠ å¿«æ·å’Œæ–¹ä¾¿ã€‚ ","date":"2025-02-05","objectID":"/posts/ml-sys-01/:3:7","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 01 Softmax","uri":"/posts/ml-sys-01/"},{"categories":null,"content":"softmax regression algorithm å°½ç®¡æ¨å¯¼è¿‡ç¨‹ç›¸å½“å¤æ‚ï¼Œä½†æœ€ç»ˆçš„ç®—æ³•éå¸¸ç®€å•ã€‚ Softmax å›å½’æ˜¯å¤šåˆ†ç±»é—®é¢˜çš„çº¿æ€§æ¨¡å‹ï¼Œé€šè¿‡äº¤å‰ç†µæŸå¤±å‡½æ•°å’Œæ¢¯åº¦ä¸‹é™ä¼˜åŒ–å‚æ•° MNIST æ•°æ®é›†ï¼šæ‰‹å†™æ•°å­—åˆ†ç±»ï¼ˆ10 ç±»ï¼Œ28x28 åƒç´ ï¼‰ã€‚ ç»“æœï¼šé”™è¯¯ç‡\u003c8%ï¼Œè®­ç»ƒæ—¶é—´ä»…æ•°ç§’ã€‚ Softmax å›å½’æ˜¯çº¿æ€§åˆ†ç±»å™¨ï¼Œè€Œç¥ç»ç½‘ç»œé€šè¿‡éçº¿æ€§å±‚ï¼ˆæ¿€æ´»å‡½æ•°ï¼‰å’Œéšè—å±‚æ„å»ºæ›´å¤æ‚çš„å‡è®¾ç©ºé—´ã€‚ ","date":"2025-02-05","objectID":"/posts/ml-sys-01/:3:8","tags":["Learning Notes","Deep Learning"],"title":"CMU 10-414/714: Deep Learning Systems (2020) - æ·±åº¦å­¦ä¹ ç³»ç»Ÿ 01 Softmax","uri":"/posts/ml-sys-01/"},{"categories":null,"content":"å¾®æœåŠ¡æ¶æ„ å›é¡¾ä¸‹å¾®æœåŠ¡æ¶æ„çš„ä¸€äº›çŸ¥è¯†ï¼ŒåŒ…æ‹¬æœåŠ¡å‘ç°ã€è´Ÿè½½å‡è¡¡ã€å¯ç”¨æ€§ï¼Œå¾ˆå¤šä¸œè¥¿æ²¡æœ‰å®æ“è¿‡æ‰€ä»¥éš¾ä»¥è®°ä½ï¼Œéœ€è¦å¤šå¤šå›é¡¾ã€‚ æ¥è‡ªæå®¢æ—¶é—´çš„è¯¾ç¨‹ https://time.geekbang.org/column/intro/100551601 åç«¯å·¥ç¨‹å¸ˆçš„é«˜é˜¶é¢ç» ","date":"2024-12-25","objectID":"/posts/backend-microservice/:1:0","tags":["Backend"],"title":"é˜…è¯»ç¬”è®°ï¼šå¾®æœåŠ¡æ¶æ„","uri":"/posts/backend-microservice/"},{"categories":null,"content":"æœåŠ¡æ³¨å†Œä¸å‘ç° æœåŠ¡ç«¯å¯åŠ¨éœ€è¦å‘æ³¨å†Œä¸­å¿ƒé‡Œæ³¨å†Œè‡ªèº«çš„ä¿¡æ¯ï¼Œä¿æŒå¿ƒè·³ å®¢æˆ·ç«¯è°ƒç”¨ï¼Œéœ€è¦æ‰¾æ³¨å†Œä¸­å¿ƒè·å–æœåŠ¡èŠ‚ç‚¹ï¼Œå¹¶ä¸”ç¼“å­˜åˆ—è¡¨ã€‚ å®¢æˆ·ç«¯ä¸æ³¨å†Œä¸­å¿ƒä¹Ÿè¦ä¿æŒå¿ƒè·³å’Œæ•°æ®åŒæ­¥ï¼ŒæœåŠ¡ç«¯å‘ç”Ÿå˜åŠ¨éœ€è¦é€šçŸ¥å®¢æˆ·ç«¯æ›´æ–° å®¢æˆ·ç«¯å‘é€è¯·æ±‚ï¼ŒæœåŠ¡ç«¯è¿”å›å“åº” å¦‚æœæœåŠ¡ç«¯ä¸‹çº¿æ€ä¹ˆåŠï¼Ÿ æœåŠ¡ç«¯é€šçŸ¥æ³¨å†Œä¸­å¿ƒå‡†å¤‡ä¸‹çº¿ï¼Œæ³¨å†Œä¸­å¿ƒé€šçŸ¥å®¢æˆ·ç«¯æ›´æ–°åˆ—è¡¨ï¼Œå®¢æˆ·ç«¯ä¸å†å‘è¯·æ±‚åˆ°è¯¥æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯ç­‰å¾…ä¸€æ®µæ—¶é—´åä¸‹çº¿ã€‚ ç­‰å¾…æ—¶é—´æ˜¯éœ€è¦çš„ etcd / ZooKeeper å¯ä»¥å½“ä½œæ³¨å†Œä¸­å¿ƒï¼Œç”¨ä¸€è‡´æ€§åè®®æ¯”å¦‚ Raft, ZAB ä¿è¯ä¸€è‡´æ€§ ä¸ºä»€ä¹ˆéœ€è¦æœåŠ¡æ³¨å†Œå’Œå‘ç°ï¼Ÿ HTTP éœ€è¦åŸŸåè§£æï¼Œå¤šçº§ç¼“å­˜ï¼Œè€Œ RPC ä¸€èˆ¬éœ€è¦ç»‘å®šå¤šä¸ªç«¯å£ï¼ŒDNS ä¸èƒ½æ³¨å†Œç«¯å£ï¼Ÿ RPC ä¸€èˆ¬éœ€è¦æ›´æ–°æœåŠ¡ï¼ŒDNS å¤šçº§ç¼“å­˜éš¾ä»¥æ›´æ–° é«˜å¯ç”¨ æœåŠ¡æ³¨å†Œä¸å‘ç°æ€ä¹ˆä¿è¯é«˜å¯ç”¨ æ³¨å†ŒæœåŠ¡ç«¯å´©æºƒæ£€æµ‹ æ³¨å†Œä¸­å¿ƒå’ŒæœåŠ¡ç«¯ä¹‹é—´ç»´æŒå¿ƒè·³ æ¯”å¦‚ç§Ÿçº¦ã€é•¿è¿æ¥ ws ç­‰ç­‰ï¼Œä½†æœ€é‡è¦çš„é—®é¢˜æ˜¯ï¼Œå¿ƒè·³å¤±è´¥åçš„å¤„ç†ï¼Œæ˜¯è¿ç»­å‡ æ¬¡å¿ƒè·³å¤±è´¥æ‰è®¤ä¸ºå¤±è´¥è¿˜æ˜¯ï¼Ÿè¿ç»­é‡è¯•ï¼Œè¿˜æ˜¯é—´éš”é‡è¯•ï¼Œé—´éš”æ˜¯ï¼Ÿ å‚è€ƒæŒ‡æ•°é€€é¿ç®—æ³•ï¼šä¸€å¼€å§‹é‡è¯•å‡ æ¬¡ï¼Œé—´éš”è¾ƒçŸ­ï¼Œç„¶åé—´éš”æŒ‡æ•°ä¸Šå‡ï¼Œç±»ä¼¼å†·å¯åŠ¨ï¼Ÿ å®¢æˆ·ç«¯å®¹é”™ æ³¨å†Œä¸­å¿ƒæˆ–è€…æœåŠ¡ç«¯èŠ‚ç‚¹å‡ºé—®é¢˜æ—¶ï¼Œè¯·æ±‚ä¾æ—§èƒ½å‘é€åˆ°æ­£ç¡®çš„æœåŠ¡ç«¯èŠ‚ç‚¹ failover æ¢èŠ‚ç‚¹ æ²¡å¤ªç†è§£ï¼Œæ„æ€å°±æ˜¯å®¢æˆ·ç«¯ç»´æŠ¤å¯ç”¨åˆ—è¡¨ï¼Ÿ æ³¨å†Œä¸­å¿ƒé€‰å‹ æ³¨å†Œä¸­å¿ƒæ›´åŠ å…³æ³¨ CAP ä¸­é€‰ CP è¿˜æ˜¯é€‰ AP çš„é—®é¢˜ Cï¼šConsistencyï¼Œæ•°æ®ä¸€è‡´æ€§ Aï¼šAvailabilityï¼ŒæœåŠ¡å¯ç”¨æ€§ Pï¼šPartition-toleranceï¼Œåˆ†åŒºå®¹é”™æ€§ CAP ç†è®ºæœ€å¤šæ»¡è¶³å…¶ä¸­ä¸¤ä¸ªï¼ŒCP è¡¨ç¤ºä¸€è‡´ + åˆ†åŒºå®¹é”™ï¼ŒAP è¡¨ç¤ºå¯ç”¨ + åˆ†åŒºå®¹é”™ P åˆ†åŒºå®¹é”™æ€§æ˜¯è‚¯å®šè¦é€‰çš„ï¼Œ é€‰ Cï¼ˆä¸€è‡´æ€§ï¼‰ è¿˜æ˜¯é€‰ Aï¼ˆå¯ç”¨æ€§ï¼‰ï¼Ÿå“ªä¸ªæ›´åŠ é‡è¦ï¼Ÿ å¯ç”¨æ€§ï¼Œä¹Ÿå°±æ˜¯é€‰ AP å¦‚æœæ³¨å†Œä¸­å¿ƒé€‰äº† APï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯å¯èƒ½æ‹¿åˆ°ä¸ä¸€è‡´çš„å¯ç”¨èŠ‚ç‚¹åˆ—è¡¨ï¼Œå¦‚æœå®¢æˆ·ç«¯å‘é€åˆ°å·²ç»å¤±æ•ˆçš„æœåŠ¡ç«¯èŠ‚ç‚¹ï¼Œé‚£ä¹ˆå°±ä¼šå‘ç”Ÿé”™è¯¯ï¼Œå°±éœ€è¦å®¢æˆ·ç«¯å®¹é”™ï¼Œfailover æ¢èŠ‚ç‚¹é‡è¯•ã€‚ ZooKeeper/ETCD å®é™…ä¸Šæ˜¯ä¸€ä¸ª CP ç³»ç»Ÿï¼Œè€Œä¸æ˜¯ AP ç³»ç»Ÿã€‚ å®ƒä»¬çš„ä¸€è‡´æ€§åè®®å‡ºè‰² ä½†æ˜¯ CP é¢å¯¹è´Ÿè½½è¾ƒé«˜çš„æƒ…å†µä¼šå‡ºç°ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿå†™å…¥ï¼Ÿ æ€»ç»“ å¾®æœåŠ¡æ¶æ„å¯ä»¥çœ‹æˆä¸‰è§’å½¢ï¼Œå›´ç»•å“ªæ¡è¾¹/å“ªä¸ªç‚¹ä¼šå‡ºé—®é¢˜æ¥è¿›è¡Œå®¹é”™ æ³¨å†Œä¸­å¿ƒ / \\ å®¢æˆ·ç«¯ ----- æœåŠ¡ç«¯ ","date":"2024-12-25","objectID":"/posts/backend-microservice/:1:1","tags":["Backend"],"title":"é˜…è¯»ç¬”è®°ï¼šå¾®æœåŠ¡æ¶æ„","uri":"/posts/backend-microservice/"},{"categories":null,"content":"è´Ÿè½½å‡è¡¡ è´Ÿè½½å‡è¡¡æ˜¯å¾ˆé‡è¦çš„ï¼Œé—®é¢˜åœ¨äºè€ƒè™‘åˆ°æ€§èƒ½å’Œå¯ç”¨ã€è¯·æ±‚è¯¥å‘ç»™å“ªä¸ªæœåŠ¡ç«¯ï¼Ÿ å¸¸è§çš„è´Ÿè½½å‡è¡¡ç®—æ³•ï¼š è½®è¯¢ï¼šä¾æ¬¡åˆ†é… åŠ æƒè½®è¯¢ï¼šæ¯ä¸ªæœåŠ¡å™¨æœ‰æƒé‡ï¼Œæƒé‡é«˜çš„ä¼˜å…ˆåˆ†é… éšæœºï¼šéšæœº åŠ æƒéšæœºï¼šæ¯ä¸ªæœåŠ¡å™¨æœ‰æƒé‡ å“ˆå¸Œï¼šæ ¹æ®è¯·æ±‚ç‰¹å¾æ¯”å¦‚å®¢æˆ·ç«¯ IP è®¡ç®—å“ˆå¸Œåˆ†é…ç»™å¯¹åº”çš„æœåŠ¡å™¨ ä¸€è‡´æ€§å“ˆå¸Œï¼šæœåŠ¡å™¨æ˜ å°„æˆç¯ï¼Œè¯·æ±‚ä¹Ÿä¼šæ˜ å°„åˆ°ç¯ä¸Šåˆ†é…åˆ°æœ€è¿‘çš„æœåŠ¡å™¨ ä¸€è‡´æ€§å“ˆå¸Œæ¯”è¾ƒå‡ºåï¼Œä½†å­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œè´Ÿè½½å¹¶ä¸å®Œç¾å‡è¡¡ï¼Œä½†å¯ä»¥å¾ˆæ˜¾è‘—è§£å†³èŠ‚ç‚¹å¢åŠ æˆ–å‡å°‘å¯¼è‡´çš„æ•°æ®è¿ç§»ï¼Œåªéœ€è¦éƒ¨åˆ†è¿ç§»ã€‚é€šè¿‡å¢åŠ è™šæ‹ŸèŠ‚ç‚¹ï¼ˆæ¯ä¸ªèŠ‚ç‚¹ä¼šå­˜åœ¨å¤šä¸ªå‰¯æœ¬ï¼‰ã€éšæœºæƒé‡å¯ä»¥æé«˜è´Ÿè½½å‡è¡¡æ•ˆæœ è½®è¯¢ä¸åŠ æƒè½®è¯¢ åŠ æƒè½®è¯¢å¦‚ä½•å®ç°ï¼Ÿèƒ½ä¸èƒ½ç›´æ¥ [1,1,1,2,3] å¦‚æœä¸æƒ³è¿ç»­é€‰æ‹©åŒä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¯ä»¥ä½¿ç”¨å¹³æ»‘åŠ æƒè½®è¯¢ç®—æ³•ï¼Œæ¯”å¦‚ [1,2,1,3,1] å¹³æ»‘åŠ æƒ smooth weighted round-robin balancing é™¤äº†å®šä¹‰çš„ weight è¿˜æœ‰ä¸ªåŠ¨æ€æ”¹å˜çš„ current_weight æ¯æ¬¡é€‰æ‹© weight æœ€å¤§çš„ï¼Œå¹¶ä¸”å°†å…¶å‡å» total_weight = sum(current_weight) ç„¶åæ¯ä¸ªèŠ‚ç‚¹ current_weight += weight é‡å¤è¿™ä¸¤æ­¥é€‰æ‹©èŠ‚ç‚¹ å›¾ä¾‹ï¼šhttps://blog.csdn.net/gqtcgq/article/details/52076997 å“ˆå¸Œä¸ä¸€è‡´æ€§å“ˆå¸Œ ç®€å•å“ˆå¸Œï¼š(è¯·æ±‚çš„ä¸€äº›å‚æ•°æˆ–è€… ip å¾—åˆ°å“ˆå¸Œå€¼) % n ä¸ªèŠ‚ç‚¹ = åºå· ä½†å¦‚æœå“ˆå¸Œç®—æ³•é€‰çš„ä¸å¥½ï¼Œå¯èƒ½ä¼šå¯¼è‡´çƒ­ç‚¹ï¼Œå¹¶ä¸å‡åŒ€ã€‚ ä¸€è‡´æ€§å“ˆå¸Œï¼šæœåŠ¡ç«¯èŠ‚ç‚¹è½åœ¨å“ˆå¸Œç¯ä¸Šï¼Œå®¢æˆ·ç«¯è¯·æ±‚å‚æ•°è®¡ç®—å“ˆå¸Œå€¼ï¼Œè½åœ¨ç¯ä¸Šæœ€è¿‘çš„æœåŠ¡ç«¯èŠ‚ç‚¹ï¼ˆé¡ºæ—¶é’ˆï¼‰ ä¸€è‡´æ€§å“ˆå¸Œå¹¶ä¸ä¿è¯æœåŠ¡ç«¯èŠ‚ç‚¹å‡åŒ€åˆ†æ•£åœ¨å“ˆå¸Œç¯ä¸Šï¼Œéœ€è¦é€šè¿‡åŠ æƒéšæœº (Rendezvous hashing)ã€è™šæ‹ŸèŠ‚ç‚¹ï¼ˆåˆ†æ•£å¤šä¸ªå‰¯æœ¬ï¼Œå°½å¯èƒ½å‡åŒ€ï¼‰ ä¸ºä»€ä¹ˆç”¨å“ˆå¸Œï¼Œä¸€ä¸ªåŸå› å¯èƒ½æ˜¯å’Œç¼“å­˜æœ‰å…³ï¼Œå¦‚æœä¸€æ ·çš„è¯·æ±‚å¯ä»¥ä¸€ç›´åˆ°åŒä¸€ä¸ªæœåŠ¡ç«¯ï¼Œåˆ©ç”¨ç¼“å­˜å¯ä»¥æé«˜æ•ˆç‡åŠ å¿«å“åº”é€Ÿåº¦ã€‚ æœ€å°‘è¿æ¥æ•°ï¼šæ¯æ¬¡é€‰æ‹©å½“å‰è¿æ¥æ•°æœ€å°‘çš„ ä½†å½“å‰è¿æ¥æ•°å¹¶ä¸ä»£è¡¨å®é™…è´Ÿè½½ï¼Œå°¤å…¶æ˜¯å¯ä»¥å¤šè·¯å¤ç”¨ æœ€å°‘æ´»è·ƒæ•°ï¼šæ´»è·ƒè¯·æ±‚æ˜¯å·²ç»æ¥å—ä½†æ˜¯è¿˜æ²¡è¿”å›çš„è¯·æ±‚ï¼Œå®¢æˆ·ç«¯è‡ªå·±ç»´æŠ¤ï¼Œæ¯æ¬¡é€‰æ‹©æœ€å°‘çš„ã€‚ä½†åŒæ ·è¿™ä¸ä»£è¡¨è´Ÿè½½ï¼Œæ´»è·ƒè¯·æ±‚æœ‰å¯èƒ½æ˜¯å»¶è¿Ÿ/å¤§è¯·æ±‚é€ æˆçš„ã€‚ æœ€å¿«å“åº”æ—¶é—´ï¼šå®¢æˆ·ç«¯ç»´æŒæ¯ä¸ªèŠ‚ç‚¹çš„å“åº”æ—¶é—´ï¼Œè€Œåæ¯æ¬¡æŒ‘é€‰å“åº”æ—¶é—´æœ€çŸ­çš„ã€‚ è¿™äº›éƒ½æ˜¯å•ä¸€æŒ‡æ ‡ï¼Œä¹Ÿå¯ä»¥ç”¨ CPU ç­‰è´Ÿè½½ä½œä¸ºå‡è¡¡ç®—æ³•ï¼Œä½†å¯èƒ½éœ€è¦ä¸­é—´ä»£ç†æ¥è®°å½•è¿™äº›ä¿¡æ¯ï¼Œç„¶åè½¬å‘ è®©å®¢æˆ·ç«¯æ¥ç»´æŠ¤å°±å¾ˆå¥‡æ€ª åŸºäºä¸€è‡´æ€§å“ˆå¸Œçš„æ”¹è¿›ï¼š Rendezvous hashing èƒ½è·å¾—æ›´å¥½çš„è´Ÿè½½å‡è¡¡ï¼Œå› ä¸ºå®ƒéœ€è¦è®¡ç®—æ‰€æœ‰èŠ‚ç‚¹çš„å“ˆå¸Œå€¼ hashfunction.hash(key + node.key()); æœ€åé€‰æ‹©æœ€å¤§çš„ è€Œä¸€è‡´æ€§å“ˆå¸Œåªè®¡ç®—å½“å‰ key çš„å“ˆå¸Œå€¼ï¼Œåœ¨å“ˆå¸Œç¯ä¸Šæ‰¾ è¯¦ç»†å¯¹æ¯”ï¼šhttps://blog.prochase.top/2024/08/rendezvous-hashing/ ","date":"2024-12-25","objectID":"/posts/backend-microservice/:1:2","tags":["Backend"],"title":"é˜…è¯»ç¬”è®°ï¼šå¾®æœåŠ¡æ¶æ„","uri":"/posts/backend-microservice/"},{"categories":null,"content":"ç†”æ–­ ç†”æ–­ï¼Œé™æµï¼Œé™çº§ç­‰ç­‰æ˜¯å¾®æœåŠ¡æ¶æ„å¯ç”¨æ€§çš„ä¸€äº›ä¿éšœ ç†”æ–­ï¼šå¾®æœåŠ¡æœ¬èº«å‡ºé—®é¢˜æ—¶ï¼Œæ‹’ç»æœåŠ¡ç›´åˆ°æ¢å¤ï¼Œç±»ä¼¼è‚¡ç¥¨çš„ç†”æ–­æœºåˆ¶ circuit breakerã€‚ç†”æ–­æœŸé—´å°±å¯ä»¥æ¢å¤æœåŠ¡ç«¯. åˆ¤å®šæœåŠ¡çš„å¥åº·çŠ¶æ€ å¦‚ä½•åˆ¤æ–­å¾®æœåŠ¡å‡ºç°é—®é¢˜ï¼Ÿä¸€äº›æŒ‡æ ‡ï¼šå“åº”æ—¶é—´ã€é”™è¯¯ç‡ç­‰ç­‰ï¼Œä½†é—®é¢˜æ˜¯ä»€ä¹ˆé˜ˆå€¼æ‰æ˜¯æœ€åˆé€‚çš„ï¼Œè¶…è¿‡é˜ˆå€¼ä¹‹åä»€ä¹ˆæ—¶å€™è§¦å‘ç†”æ–­ æ¯”å¦‚å“åº”æ—¶é—´è¶…è¿‡ 1s 2s ä¹‹ç±»çš„ï¼Œå¦‚æœ p99 = 1s é‚£ä¹ˆå¯ä»¥è®¾ç½® 1.2s ä½œä¸ºç†”æ–­é˜ˆå€¼ ä¸€æ—¦è¶…è¿‡å°±è¦è§¦å‘ç†”æ–­å—ï¼Ÿè¿˜æ˜¯éœ€è¦å“åº”æ—¶é—´è¶…è¿‡ä¸€æ®µæ—¶é—´åæ‰è§¦å‘ã€‚é˜²æ­¢å¶å‘å’ŒæŠ–åŠ¨ jitter æœåŠ¡æ¢å¤ ç†”æ–­åéœ€è¦æ‹’ç»æœåŠ¡ï¼Œç»“æŸç†”æ–­åéœ€è¦æ¢å¤æœåŠ¡ã€‚ä½†å¦‚æœå‘ç”ŸæŠ–åŠ¨ï¼Œé¢‘ç¹åœ¨æ­£å¸¸å’Œç†”æ–­ä¸¤ä¸ªçŠ¶æ€åˆ‡æ¢æ€ä¹ˆåŠï¼Ÿæ¯”å¦‚å°±æ ¹æœ¬æ”¯æ’‘ä¸äº† QPS 1000 çš„æœåŠ¡ï¼Œç†”æ–­åè¿˜æ˜¯æœ‰ QPS 1000 çš„è¯·æ±‚ã€‚ ç†”æ–­å¯ä»¥é€æ­¥æ”¾å¼€æµé‡ï¼Œè¿˜æ˜¯è®©å®¢æˆ·ç«¯æ§åˆ¶æµé‡å»è¯·æ±‚åˆ«çš„èŠ‚ç‚¹ã€‚ ","date":"2024-12-25","objectID":"/posts/backend-microservice/:1:3","tags":["Backend"],"title":"é˜…è¯»ç¬”è®°ï¼šå¾®æœåŠ¡æ¶æ„","uri":"/posts/backend-microservice/"},{"categories":null,"content":"é™çº§ ç†”æ–­ã€é™çº§ã€é™æµéƒ½æ˜¯å¾®æœåŠ¡æ¶æ„çš„å¯ç”¨æ€§ä¿éšœ é«˜å³°æœŸé—´ä¼šå…³é—­ä¸€äº›æœåŠ¡ï¼Œè…¾å‡ºæœåŠ¡å™¨èµ„æºå’Œå‡å°‘å…¬å…±ç»„ä»¶æ¯”å¦‚æ•°æ®åº“çš„å‹åŠ›ï¼Œ é™çº§çš„æ¡ä»¶å’Œç†”æ–­å¾ˆåƒï¼Œå¦‚ä½•åˆ¤æ–­ä»€ä¹ˆæ—¶å€™é™çº§ï¼Œé™çº§åæ€ä¹ˆæ¢å¤ï¼Œæ€ä¹ˆå¤„ç†æŠ–åŠ¨ï¼Ÿ ä½†è¿˜æœ‰ä¸ªé—®é¢˜ï¼Œä»€ä¹ˆæœåŠ¡èƒ½é™çº§ä»€ä¹ˆæœåŠ¡ä¸èƒ½ï¼Ÿ å†™æœåŠ¡ä¸€èˆ¬ä¸èƒ½é™çº§ï¼Œä»å‰ç«¯æ¥å—æ•°æ®ç„¶åå†™åˆ°æ•°æ®åº“è¿™ç§æœåŠ¡ä¸€èˆ¬ä¸é™çº§ã€‚ è·¨æœåŠ¡é™çº§ï¼šèµ„æºä¸å¤Ÿçš„æ—¶å€™æš‚åœæŸäº›æœåŠ¡ï¼Œè®©ç»™å…¶ä»–æ›´é‡è¦å’Œæ ¸å¿ƒçš„æœåŠ¡ã€‚ æœ¬æœåŠ¡æä¾›æœ‰æŸæœåŠ¡ï¼šæ¯”å¦‚ app é¦–é¡µä¹Ÿå­˜åœ¨é™çº§ï¼Œè§¦å‘é™çº§åè·¨å¹´ä¸ä¼šåšä¸ªæ€§åŒ–æ¨èè€Œä½¿ç”¨é™æ€é¡µé¢ã€‚ é™çº§æ€è·¯ï¼šè¿”å›é»˜è®¤ã€ç¦ç”¨å¯è§‚æµ‹ç»„ä»¶ï¼ŒåŸ‹ç‚¹ï¼Œé™ä½é‡‡æ ·ç‡ç­‰ç­‰ã€åŒæ­¥è½¬å¼‚æ­¥ã€ç®€åŒ–æµç¨‹â€¦ é™çº§çš„æ¢å¤å’ŒæŠ–åŠ¨ï¼Ÿä¸»è¦æ˜¯æ§åˆ¶æµé‡ï¼ŒæœåŠ¡ç«¯æˆ–è€…å®¢æˆ·ç«¯ï¼Œéƒ¨åˆ†æµé‡ä¾æ—§ç†”æ–­/é™çº§ã€‚ ä¾‹å­ï¼šè¯»æœåŠ¡ QPS æ›´é«˜æ›´é‡è¦ï¼Œé‚£ä¹ˆå°±å¯ä»¥é™çº§å†™æœåŠ¡ï¼Œæ¯”å¦‚å•†åº—é¡µé¢è¯»ï¼Œå•†å®¶å†™ï¼Œé«˜å³°æœŸé—´å¯ä»¥æš‚åœå†™å…¥ã€‚ ä»¥å‰æˆ‘ä¼šä»¥ä¸ºé«˜å³°æœŸé—´å¢åŠ å†—ä½™å’Œå‰¯æœ¬æ‰æ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Œä½†å®é™…ä¸Šå¢åŠ å‰¯æœ¬å¯èƒ½å¯¼è‡´æ›´å¤šçš„æˆæœ¬å’Œé—®é¢˜ï¼Œå¯¹å…¬å…±ç»„ä»¶å¢åŠ æ›´å¤šçš„è´Ÿæ‹…ï¼Œç”šè‡³å¤šä¸ªå‰¯æœ¬é—´äº§ç”Ÿä¸€è‡´æ€§é—®é¢˜ã€‚ ä¸ºäº†é«˜å¯ç”¨ï¼Œæ‹’ç»æœåŠ¡ç†”æ–­å’Œé™çº§ä¿è¯å¯ç”¨åº”è¯¥æ˜¯æˆæœ¬æ›´ä½çš„æ‰‹æ®µã€‚ ","date":"2024-12-25","objectID":"/posts/backend-microservice/:1:4","tags":["Backend"],"title":"é˜…è¯»ç¬”è®°ï¼šå¾®æœåŠ¡æ¶æ„","uri":"/posts/backend-microservice/"},{"categories":null,"content":"é™æµ limiting é™æµå°±æ›´åŠ å¸¸è§äº†ï¼Œä½†ä¹ŸåŒæ ·æ›´å¤æ‚ï¼Œé˜ˆå€¼æ›´åŠ éš¾å®šã€‚ é™æµé€šè¿‡é™åˆ¶æµé‡æ¥æé«˜å¯ç”¨æ€§ï¼Œé˜²æ­¢å¼‚å¸¸æµé‡çªå‘æ‰“å´©ç³»ç»Ÿï¼Œ é™æµç®—æ³• é™æ€é™æµï¼šä»¤ç‰Œæ¡¶ã€æ¼æ¡¶ã€å›ºå®šçª—å£ã€æ»‘åŠ¨çª—å£ åŠ¨æ€é™æµï¼ˆè‡ªé€‚åº”é™æµï¼‰ï¼šBBR ç­‰åˆ©ç”¨ä¸€ç³»åˆ—æŒ‡æ ‡æ¥åˆ¤å®šæ˜¯å¦åº”è¯¥å‡å°‘æµé‡æˆ–æ–¹æ³•æµé‡ï¼Œç±»ä¼¼ TCP æ‹¥å¡æ§åˆ¶ã€‚ ä»¤ç‰Œæ¡¶ï¼šç³»ç»Ÿä»¥æ’å®šé€Ÿç‡äº§ç”Ÿä»¤ç‰Œï¼Œæ”¾åˆ°æ¡¶é‡Œï¼Œæ¯ä¸ªè¯·æ±‚åªæœ‰æ‹¿åˆ°äº†ä»¤ç‰Œæ‰èƒ½æ‰§è¡Œã€‚ æ¼æ¡¶ï¼šé™æµå™¨ä»¥å‡åŒ€é€Ÿåº¦äº¤ç»™ä¸šåŠ¡é€»è¾‘ï¼Œæ¥å¤„ç†ä¸ç¨³å®šçš„è¯·æ±‚é€Ÿåº¦ï¼Œå¯ä»¥ç±»æ¯”åŒ€é€Ÿçš„ä»¤ç‰Œæ¡¶ å›ºå®šçª—å£ï¼šåœ¨ä¸€ä¸ªå›ºå®šæ—¶é—´æ®µåªæ‰§è¡Œå›ºå®šæ•°é‡çš„è¯·æ±‚ï¼Œæ¯”å¦‚ä¸€ç§’å†…ä¸€ç™¾ä¸ªè¯·æ±‚ æ»‘åŠ¨çª—å£ï¼šåŒæ ·ï¼Œä¸€ä¸ªçª—å£å†…åªèƒ½æ‰§è¡Œå›ºå®šæ•°é‡çš„è¯·æ±‚ï¼Œä½†æ˜¯ä¼šå¹³æ»‘ç§»åŠ¨çª—å£ å¦‚ä½•é™æµï¼Ÿå€ŸåŠ© redis ä¸­é—´ä»¶è®°å½•æµé‡å’Œé˜ˆå€¼ï¼Œæˆ–è€…åˆ©ç”¨ç½‘å…³æ¥é™æµã€‚ è¿™é‡Œä¹Ÿæœ‰ä¸€äº›ä¸šåŠ¡é€»è¾‘ï¼Œvip ç”¨æˆ·ä¸é™æµä»€ä¹ˆçš„ï¼Œip é™æµï¼Œæ™®é€šç”¨æˆ·é™æµç­‰ç­‰ã€‚ BBR åŠ¨æ€é™æµï¼šè‡ªé€‚åº”ï¼ˆQPS æŒ‡æ ‡ï¼Œå“åº”æ—¶é—´ RTï¼‰ + æ»‘åŠ¨çª—å£ + é™æµå…¬å¼ bilibili å¼€æºçš„å¥æ‰˜æ–¯ go kratos æ¡†æ¶ https://github.com/go-kratos/kratos å…¶é™æµå™¨å°±æ˜¯ç”¨ bbr limiter å®ç°çš„ https://go-kratos.dev/en/docs/component/middleware/ratelimit/ https://github.com/go-kratos/aegis/tree/main/ratelimit/bbr ","date":"2024-12-25","objectID":"/posts/backend-microservice/:1:5","tags":["Backend"],"title":"é˜…è¯»ç¬”è®°ï¼šå¾®æœåŠ¡æ¶æ„","uri":"/posts/backend-microservice/"},{"categories":null,"content":"éš”ç¦» éš”ç¦»æ¯”è¾ƒå°‘è§ï¼Ÿä½†å¯¹äºé«˜å¯ç”¨ä¹Ÿå¾ˆé‡è¦ï¼Œåˆ†ç¦»æ™®é€šç”¨æˆ·å’Œ VIP ç”¨æˆ·ç­‰ç­‰ï¼Œä¹Ÿå¯ä»¥æé«˜å¯ç”¨æ€§ã€æ€§èƒ½å’Œå®‰å…¨æ€§ã€‚ å®ä¾‹éš”ç¦»ï¼šæŸä¸ªæœåŠ¡ç‹¬äº«æŸä¸ªå®ä¾‹å…¨éƒ¨èµ„æºï¼Œæ— å…±äº«ã€‚è€Œä¸æ˜¯ä¸€å°æœºå™¨å¤šä¸ªæœåŠ¡å…±äº«ã€‚ åˆ†ç»„éš”ç¦»ï¼š è¿æ¥æ± éš”ç¦»/çº¿ç¨‹æ± éš”ç¦»ï¼š ç¬¬ä¸‰æ–¹ä¾èµ–éš”ç¦»ï¼šè¶Šæ˜¯å…³é”®çš„ä¸šåŠ¡ï¼Œä¸šåŠ¡ä¸Šè¶Šæ˜¯å…³é”®çš„è·¯å¾„ï¼Œå°±è¶Šè¦å°å¿ƒéš”ç¦» ","date":"2024-12-25","objectID":"/posts/backend-microservice/:1:6","tags":["Backend"],"title":"é˜…è¯»ç¬”è®°ï¼šå¾®æœåŠ¡æ¶æ„","uri":"/posts/backend-microservice/"},{"categories":null,"content":"è¶…æ—¶æ§åˆ¶ è¶…æ—¶æ§åˆ¶åŒæ ·ä¹Ÿæ˜¯å¯ç”¨æ€§çš„ä¸€ä¸ªæ–¹æ¡ˆï¼ŒæŒ‡åœ¨è§„å®šçš„æ—¶é—´å†…å®Œæˆæ“ä½œï¼Œå¦‚æœä¸èƒ½å®Œæˆï¼Œé‚£ä¹ˆå°±è¿”å›ä¸€ä¸ªè¶…æ—¶å“åº”ã€‚ ç¡®ä¿å®¢æˆ·ç«¯èƒ½åœ¨é¢„æœŸçš„æ—¶é—´å†…æ‹¿åˆ°å“åº”ï¼Œè€Œä¸æ˜¯æ²¡æœ‰ä»»ä½•å“åº”ã€‚ åŠæ—¶é‡Šæ”¾èµ„æºï¼Œå°¤å…¶æ˜¯é‡Šæ”¾çº¿ç¨‹å’Œè¿æ¥ï¼Œæ¯”å¦‚ go åç¨‹ä¼šè¢«ä¸€ç›´å æœ‰ã€‚é‡Šæ”¾ RPC è¿æ¥å’Œæ•°æ®åº“è¿æ¥ç­‰ç­‰ã€‚ å®é™…æ“ä½œä¸­ä¹Ÿé‡åˆ°è¿‡è¿™ç§é—®é¢˜ï¼Œgo åç¨‹ä¸€ç›´æœªè¢«é‡Šæ”¾å¯¼è‡´åç¨‹æŒ¤å‹å’Œåˆ‡æ¢æœ€åè¿æ¥æ•°æ®åº“è¶…æ—¶äº† è¶…æ—¶æ§åˆ¶å½¢æ€ï¼šè°ƒç”¨è¶…æ—¶ã€é“¾è·¯è¶…æ—¶ å¦‚ä½•ç¡®å®šè¶…æ—¶æ—¶é—´ï¼šç”¨æˆ·ä½“éªŒã€è¢«è°ƒç”¨æ¥å£å“åº”æ—¶é—´ã€å‹æµ‹ã€ä»£ç ã€‚ã€‚ã€‚ ä¸€èˆ¬æ¥è¯´éƒ½æ ¹æ®ç”¨æˆ·ä½“éªŒï¼Œæ¯”å¦‚äº§å“ç»ç†è®¤ä¸º 300ms ç­‰å¾…æ—¶é—´æ˜¯åˆç†çš„ã€‚æ ¹æ®å“åº”æ—¶é—´ï¼Œå¯ä»¥é€‰æ‹© p99 æˆ–è€… p999 ç­‰ tail latency å‹åŠ›æµ‹è¯•å¯ä»¥æµ‹åˆ° p99 å’Œ p999 çº¿ç­‰ï¼Œä½†å¦‚æœå¾ˆéš¾å‹åŠ›æµ‹è¯•ï¼Œå¯ä»¥å°è¯•ä»£ç æ¨ç®—ï¼Œæ¯”å¦‚æœ‰ä¸‰æ¬¡æ•°æ®åº“æ“ä½œå’Œ redis æ“ä½œå’Œå‘é€æ¶ˆæ¯æ“ä½œï¼Œéœ€è¦å°†ä»–ä»¬å…¨éƒ¨ åŠ èµ·æ¥ï¼Œå¹¶ä¸”åŠ ä¸€äº›ä½™é‡ã€‚ è¶…æ—¶ä¸­æ–­ä¸šåŠ¡ï¼šå¦‚æœä¸šåŠ¡é€»è¾‘å«æœ‰å¤šä¸ªä¸šåŠ¡ï¼Œå…¶ä¸­ä¸€ä¸ªè¶…æ—¶æ€ä¹ˆåŠï¼Ÿæ¯”å¦‚é“¾è·¯è¶…æ—¶ï¼Œå¯ä»¥ç”¨åè®®å¤´ä¼ é€’è¶…æ—¶æ—¶é—´ï¼Œæ¯”å¦‚ rcp åè®®å¤´ï¼Œhttp åè®®å¤´ç­‰ç­‰ï¼Œ è‡³äºä¼ é€’å‰©ä½™æ—¶é—´è¿˜æ˜¯è¶…æ—¶æ—¶é—´ï¼Œå‰è€…éœ€è¦è€ƒè™‘ç½‘ç»œä¼ è¾“æ—¶é—´ï¼Œåè€…éœ€è¦è€ƒè™‘æ—¶é’ŸåŒæ­¥å’Œåç§»é—®é¢˜ã€‚ ","date":"2024-12-25","objectID":"/posts/backend-microservice/:1:7","tags":["Backend"],"title":"é˜…è¯»ç¬”è®°ï¼šå¾®æœåŠ¡æ¶æ„","uri":"/posts/backend-microservice/"},{"categories":null,"content":"è°ƒç”¨ç¬¬ä¸‰æ–¹ ä»»ä½•ç³»ç»Ÿéƒ½å¯èƒ½éœ€è¦å’Œç¬¬ä¸‰æ–¹æ‰“äº¤é“ï¼Œä½†æ˜¯å¦‚ä½•ä¿è¯ç¬¬ä¸‰æ–¹æ¥å£çš„å¯ç”¨æ€§ï¼Ÿ æ¯”å¦‚å¾®ä¿¡æ”¯ä»˜ç­‰ç­‰ï¼Œå®ä¹ æœŸé—´ä¹Ÿéœ€è¦æ¥å…¥å„ç§ä¸‰æ–¹ APIï¼Œæ¯”å¦‚ loki query ç­‰ç­‰ï¼Œ ä¸‰æ–¹ API åŸºæœ¬ä¼šæœ‰é™æµï¼Œå¤±è´¥äº†æ€ä¹ˆåŠï¼Ÿé‡è¯•ï¼Ÿ æµ‹è¯•ç¯å¢ƒä¸‹ä¸€èˆ¬éœ€è¦ mock ç¬¬ä¸‰æ–¹æœåŠ¡çš„å“åº” ","date":"2024-12-25","objectID":"/posts/backend-microservice/:1:8","tags":["Backend"],"title":"é˜…è¯»ç¬”è®°ï¼šå¾®æœåŠ¡æ¶æ„","uri":"/posts/backend-microservice/"},{"categories":null,"content":"ç»¼åˆ å¦‚ä½•ä¿è¯å¾®æœåŠ¡åº”ç”¨çš„é«˜å¯ç”¨æ€§ï¼Ÿé«˜å¹¶å‘ã€é«˜å¯ç”¨å’Œå¤§æ•°æ® å¯ç”¨æ€§ï¼šSLA Service Level Aggrement æ¯”å¦‚ 99.9%å¯ç”¨æ€§ï¼Œå…¨å¹´åªæœ‰ 8.76h åœæœºæ—¶é—´ã€‚å¦‚ä½•åšåˆ°é«˜å¯ç”¨ï¼Ÿ å®¹é”™ï¼šç†”æ–­ã€é‡è¯•ã€é™æµã€é™çº§ã€è´Ÿè½½å‡è¡¡ã€éš”ç¦»ç­‰ç­‰ é™åˆ¶æ•…éšœå½±å“èŒƒå›´ï¼šéš”ç¦»ï¼Œç›¸äº’ä¾èµ–ï¼Œå…±äº«åŸºç¡€è®¾æ–½ã€‚ å‡ºç°æ•…éšœï¼Œå¿«é€Ÿä¿®å¤ï¼šå®Œå¤‡çš„è§‚æµ‹å’Œå‘Šè­¦ç³»ç»Ÿ è§„èŒƒå˜æ›´æµç¨‹ï¼šreview ç­‰ç­‰ ","date":"2024-12-25","objectID":"/posts/backend-microservice/:1:9","tags":["Backend"],"title":"é˜…è¯»ç¬”è®°ï¼šå¾®æœåŠ¡æ¶æ„","uri":"/posts/backend-microservice/"},{"categories":null,"content":"RPC å¸¸è§„ HTTP è°ƒç”¨ï¼Œé€šè¿‡åŸŸåï¼Œå‘é€å‚æ•°å’Œåè®®å¤´ç­‰ç­‰ï¼Œä¸­é—´éœ€è¦ç»è¿‡ DNS ç­‰ç­‰ è€Œ RPC æ›´åƒè°ƒç”¨æœ¬åœ°æ–¹æ³•ï¼Œå’Œ HTTP ä¸åŒçš„æ˜¯ï¼Œé‡‡ç”¨äº†ä½“ç§¯æ›´å°çš„ protobuf åºåˆ—åŒ–åè®®æ¥ä¿å­˜ç»“æ„ä½“ï¼Œä¹Ÿä¸éœ€è¦è€ƒè™‘ HTTP çŠ¶æ€ç æ¯”å¦‚ 302 é‡å®šå‘ç­‰ç­‰ï¼Œè¿™åœ¨å¾®æœåŠ¡æ¶æ„ä¸­è¡¨ç°æ›´å¥½ã€‚ HTTP æ˜¯åº”ç”¨å±‚çš„åè®®ï¼ŒRPC å¯ä»¥åŸºäº TDP ä¹Ÿå¯ä»¥åŸºäº UDPï¼Œæ¯” HTTP æ›´æ—©å‡ºç°ï¼Œ gRPC åº•å±‚ç”¨çš„ HTTP/2 æ‰€ä»¥æ˜¯ä¸€ç§æ¶æ„æ¦‚å¿µè€Œä¸æ˜¯é€šç”¨åè®®ï¼Ÿ å®Œæ•´çš„ RPC æµç¨‹ï¼š stub -\u003e serialization -\u003e tcp å®šä¹‰ IDL æ–‡ä»¶æ¯”å¦‚ protobufï¼Œç”Ÿæˆ stub æ–‡ä»¶ï¼ˆé™æ€åº“å’Œå‡½æ•°æ˜ å°„ï¼‰ ç½‘ç»œä¼ è¾“çš„æ•°æ®æ˜¯äºŒè¿›åˆ¶æ•°æ®ï¼Œéœ€è¦ encode decode å‚æ•°å’Œç»“æœ æ ¹æ® RPC åè®®çº¦å®šæ•°æ®å¤´ã€å…ƒæ•°æ®ã€æ¶ˆæ¯ä½“ï¼Œä¿è¯æœ‰ åŸºäº TCP/UDP ä¼ è¾“ stub å…¶å®å°±æ˜¯ä¸€æ®µä»£ç ï¼Œå®¢æˆ·ç«¯ stub å¯ä»¥æ˜¯è¿œç«¯ä»£ç çš„è¡¨ç¤ºï¼ŒæœåŠ¡ç«¯ stub HTTP ä¸€èˆ¬ç”¨ JSON åºåˆ—åŒ–ï¼Œä¸€èˆ¬éœ€è¦ç”¨åå°„æ¥å¾—åˆ°ç±»å‹ è€Œ Protobuf ä½“ç§¯æ›´å°ï¼Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–æ›´å¿« HTTP ä¸€èˆ¬æœ‰å¾ˆå¤šåè®®å¤´ï¼Œè€Œå¾®æœåŠ¡ä¸€èˆ¬ä¸éœ€è¦è¿™äº›ï¼Œç”¨ RPC æ›´é€‚åˆ gRPC ç”¨ HTTP/2 æ‹¥æœ‰å¤šè·¯å¤ç”¨ã€ä¼˜å…ˆçº§æ§åˆ¶ã€å¤´éƒ¨å‹ç¼©ç­‰ä¼˜åŠ¿ï¼Œå…·æœ‰ è¿æ¥æ±  RPC æ¡†æ¶ä¸€èˆ¬éœ€è¦ç”Ÿæˆä»£ç ï¼Œæ¯”å¦‚ protobufã€‚éœ€è¦åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œå°† object å˜æˆäºŒè¿›åˆ¶å­—èŠ‚æµã€‚ å…·æœ‰å®‰å…¨æ€§ã€é€šç”¨æ€§ã€å’Œå…¼å®¹æ€§ï¼ŒåŒæ—¶æ€§èƒ½å¾ˆå¥½ã€‚ åè®®å±‚ æ”¯æŒè§£æå¤šç§åè®®ï¼ŒåŒ…å« HTTP, HTTP2, HTTP3 è‡ªå®šä¹‰ RPC åè®®ï¼Œç§æœ‰åè®®ç­‰ç­‰ å¤§å‚å†…éƒ¨å¤§éƒ¨åˆ†ä½¿ç”¨è‡ªå®šä¹‰ RPC åè®®ï¼ŒTCP ä¸­çš„äºŒè¿›åˆ¶æ•°æ®åŒ…ä¼šè¢«æ‹†åˆ†ã€åˆå¹¶ï¼Œéœ€è¦åº”ç”¨å±‚åè®®ç¡®å®šè¾¹ç•Œã€‚ gRPC, Thrift ç­‰ç­‰ ç½‘ç»œä¼ è¾“å±‚ä¸€èˆ¬ä½¿ç”¨æˆç†Ÿçš„ç½‘ç»œé€šä¿¡æ¡†æ¶ï¼Œæ¯”å¦‚ Netty å’Œ RPC è§£è€¦ã€‚ IO å¤šè·¯å¤ç”¨ï¼Œå®ç°å¯é ä¼ è¾“ç­‰ç­‰ã€‚ RPC ä¸è¶³ RPC åè®®æœ¬èº«æ— æ³•è§£å†³å¾®æœåŠ¡é›†ç¾¤çš„é—®é¢˜ï¼šæœåŠ¡å‘ç°ç­‰ç­‰ï¼Œéœ€è¦å…¶ä»–å·¥å…· è°ƒç”¨æ–¹æ¯”å¦‚å®¢æˆ·ç«¯ï¼Œå¯¹æœåŠ¡ç«¯çš„ RPC æ¥å£æœ‰å¼ºä¾èµ–å…³ç³»ï¼Œéœ€è¦è‡ªåŠ¨åŒ–å·¥å…·ã€ç‰ˆæœ¬ç®¡ç†å·¥å…·æ¥ä¿è¯ä»£ç çº§åˆ«çš„ä¾èµ–ï¼Œæ¯”å¦‚ stub æ–‡ä»¶çš„æ›´æ–°ã€‚ RPC çƒ­é—¨æ¡†æ¶ è·¨è¯­è¨€è°ƒç”¨ï¼šgrpc, thrift æä¾›åŸºç¡€çš„ RPC é€šä¿¡èƒ½åŠ›ï¼Œä¸“æ³¨è·¨è¯­è¨€è°ƒç”¨ç­‰ç­‰ï¼Œä½†ä¸å¸¦æœ‰æœåŠ¡æ²»ç†ç­‰æœºåˆ¶ï¼Œéœ€è¦å…¶ä»–æ¡†æ¶æ¥å®ç°æœåŠ¡å‘ç°å’Œè´Ÿè½½å‡è¡¡ç­‰ç­‰ã€‚ æœåŠ¡æ²»ç†ï¼šrpcx, kitex, dubbo ç­‰ï¼Œæä¾› rpc é€šä¿¡ï¼ˆå¤šæ¶ˆæ¯ä¼ è¾“åè®®æ¯”å¦‚åºåˆ—åŒ–åè®®ã€å¤šç½‘ç»œé€šä¿¡åè®®æ¯”å¦‚ TCP, UDP, HTTP/2 å’Œ QUIC ç­‰ç­‰ã€æœåŠ¡å®šä¹‰å’Œå‡½æ•°æ˜ å°„ï¼‰å¹¶ä¸”æä¾›æœåŠ¡å‘ç°ã€è´Ÿè½½å‡è¡¡ç­‰æœåŠ¡ã€‚ https://github.com/cloudwego/kitex https://www.cloudwego.io/ https://www.cloudwego.io/docs/kitex/getting-started/pre-knowledge/ ","date":"2024-12-25","objectID":"/posts/backend-microservice/:1:10","tags":["Backend"],"title":"é˜…è¯»ç¬”è®°ï¼šå¾®æœåŠ¡æ¶æ„","uri":"/posts/backend-microservice/"},{"categories":null,"content":"Kitex Demo https://github.com/cloudwego/kitex-examples https://github.com/cloudwego/kitex-examples/tree/main/bizdemo/kitex_gorm ä½¿ç”¨ thrift ç”Ÿæˆ RPC IDLï¼ˆRemote Procedure Call Interface Definition Languageï¼‰ ç”Ÿæˆçš„æ–‡ä»¶åœ¨ kitex_gen/user ç„¶ååœ¨ handler ä¸Šå®ç° ","date":"2024-12-25","objectID":"/posts/backend-microservice/:1:11","tags":["Backend"],"title":"é˜…è¯»ç¬”è®°ï¼šå¾®æœåŠ¡æ¶æ„","uri":"/posts/backend-microservice/"},{"categories":null,"content":"å…¶ä»– è®¾è®¡å¹‚ç­‰æ¥å£ï¼Œé’ˆå¯¹å†™è¯·æ±‚ï¼Œå¯ä»¥å¯¹è¯·æ±‚è¿›è¡Œå»é‡ï¼Œç¡®ä¿åŒä¸€ä¸ªè¯·æ±‚å¤„ç†ä¸€æ¬¡å’Œå¤šæ¬¡çš„ç»“æœæ˜¯ç›¸åŒçš„ è¯·æ±‚æ–¹æ¯æ¬¡è¯·æ±‚ç”Ÿæˆå”¯ä¸€çš„ idï¼Œé¦–æ¬¡è°ƒç”¨å’Œé‡è¯•æ—¶ï¼Œå”¯ä¸€çš„ ID ä¿æŒä¸å˜ æœåŠ¡ç«¯æ¥å—è¯·æ±‚æ—¶ï¼Œæ£€æŸ¥ ID æ˜¯å¦è¢«å¤„ç†è¿‡ï¼Œå¦‚æœå¤„ç†è¿‡ä¸éœ€è¦å†é‡å¤æ‰§è¡Œä¸šåŠ¡é€»è¾‘ã€‚ åˆ†å¸ƒå¼é”å¦‚ä½•å®ç°å¹‚ç­‰æ€§ï¼šhttps://juejin.cn/post/6965740344335925279 å¹‚ç­‰è®¾è®¡ https://juejin.cn/post/7049140742182141959 ","date":"2024-12-25","objectID":"/posts/backend-microservice/:1:12","tags":["Backend"],"title":"é˜…è¯»ç¬”è®°ï¼šå¾®æœåŠ¡æ¶æ„","uri":"/posts/backend-microservice/"},{"categories":null,"content":"From Cloud Computing to Sky Computing 21 å¹´ UCB æå‡ºäº† Sky Computing çš„æ¦‚å¿µï¼Œåç»­ä¹Ÿæœ‰ä¸€ç¯‡ 35 é¡µçš„ The Sky Above The Clouds ç›¸æ¯”èµ·ä¼ ç»Ÿçš„äº‘æœåŠ¡ï¼Œsky computing æ›´åƒä¸€ä¸ªå¤§ä¸€ç»Ÿçš„ä¸­é—´å±‚ï¼Œæ¯”å¦‚å¯ä»¥è°ƒç”¨ä¸åŒçš„äº‘æœåŠ¡ã€‚ä½†çœ‹ä»–ä»¬å®éªŒå®¤çš„é¡¹ç›®å·²ç»åŸºæœ¬éƒ½åœ¨åš LLM ç›¸å…³ï¼Œæ²¡æœ‰å¤ªå¤š sky computing çš„åç»­äº†ã€‚ ä½œè€… Ion ä¹Ÿæ˜¯ Databricks çš„ cofounderï¼Œä¹Ÿæ˜¯ spark çš„åŸä½œè€… ","date":"2024-12-04","objectID":"/posts/paper-skycomputing/:1:0","tags":["Paper Reading"],"title":"Paper Reading: From Cloud Computing to Sky Computing","uri":"/posts/paper-skycomputing/"},{"categories":null,"content":"Abstract æˆ‘ä»¬è€ƒè™‘äº‘è®¡ç®—çš„æœªæ¥ï¼Œå¹¶æ¢è®¨å¦‚ä½•å¼•å¯¼å…¶å‘å±•æˆä¸ºä¸€ä¸ªæ›´ä¸ºè¿è´¯çš„æœåŠ¡ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºå¤©ç©ºè®¡ç®—ã€‚ ä¸»è¦çš„éšœç¢æ›´å¤šæ˜¯ç»æµå±‚é¢çš„è€ŒéæŠ€æœ¯å±‚é¢çš„ï¼Œæˆ‘ä»¬æå‡ºäº’æƒ å¯¹ç­‰ä½œä¸ºå…³é”®çš„æ¨åŠ¨æ­¥éª¤ã€‚ ","date":"2024-12-04","objectID":"/posts/paper-skycomputing/:2:0","tags":["Paper Reading"],"title":"Paper Reading: From Cloud Computing to Sky Computing","uri":"/posts/paper-skycomputing/"},{"categories":null,"content":"Introduction In 1961, John McCarthy â€œcomputation may someday be organized as a public utility, just as the telephone system is a public utility. We can envisage computer service companies whose subscribers are connected to them [â€¦]. Each subscriber needs to pay only for the capacity that he actually uses, but he has access to all programming languages characteristic of a very large system.â€ ä¹Ÿå°±æ˜¯ä¸€æ¬¡ä»˜è´¹å¯ä»¥ç”¨å¤šç§äº‘çš„æœåŠ¡ ä»–ç®€çŸ­çš„æè¿°å‡†ç¡®åœ°æç»˜äº†æˆ‘ä»¬å¦‚ä»Šç§°ä¹‹ä¸ºäº‘è®¡ç®—çš„æƒ…æ™¯ï¼Œç”¨æˆ·å¯ä»¥è®¿é—®å¤§é‡çš„è®¡ç®—å’Œå­˜å‚¨èµ„æºï¼Œå¹¶ä¸”åªéœ€ä¸ºä½¿ç”¨çš„èµ„æºä»˜è´¹ã€‚ç›¸åï¼Œä»–å¯¹ç»æµå­¦çš„é¢„æµ‹åˆ™å¤§ç›¸å¾„åº­ï¼›å¦‚ä»Šï¼Œåœ¨ç¾å›½ï¼Œç”µè¯æœåŠ¡å·²ä¸å†æ˜¯å…¬å…±äº‹ä¸šï¼Œè€Œæ˜¯é€šè¿‡ä¸€ç³»åˆ—ç«äº‰çš„ä¾›åº”å•†æä¾›ã€‚ç„¶è€Œï¼Œå°½ç®¡ç”µè¯æœåŠ¡ä¸æ˜¯å…¬å…±äº‹ä¸šï¼Œä½†å®ƒåŸºæœ¬ä¸Šæ˜¯ä¸€ç§å•†å“ï¼Œæä¾›äº†ç»Ÿä¸€çš„ç”¨æˆ·ä½“éªŒï¼šå³ï¼Œæ— è®ºä½ ä½¿ç”¨å“ªä¸ªä¾›åº”å•†ï¼Œä½ éƒ½å¯ä»¥è”ç³»åˆ°ä»»ä½•äººï¼Œå¹¶ä¸”åˆ‡æ¢ä¾›åº”å•†ç›¸å¯¹å®¹æ˜“ï¼›ä½ ç”šè‡³å¯ä»¥åœ¨åˆ‡æ¢æ—¶ä¿ç•™ä½ çš„å·ç ã€‚ å›åˆ°éº¦å¡é”¡çš„é¢„æµ‹ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œå…³æ³¨çš„ä¸æ˜¯æ²¡æœ‰å•ä¸€çš„å…¬å…±è®¡ç®—äº‹ä¸šï¼Œè€Œæ˜¯äº‘è®¡ç®—å¹¶ä¸æ˜¯ä¸€ç§æ— å·®åˆ«çš„å•†å“ã€‚ä¸ç”µè¯æœåŠ¡ä¸åŒï¼Œäº‘è®¡ç®—å¸‚åœºå·²ç»è¿œç¦»äº†å•†å“åŒ–ï¼Œäº‘æœåŠ¡æä¾›å•†é€šè¿‡ä¸“æœ‰æœåŠ¡æ¥åŠªåŠ›ä½¿è‡ªå·±ä¸ä¼—ä¸åŒã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å»ºè®®é‡‡å–ä¸€äº›æ­¥éª¤æ¥å…‹æœè¿™ç§å·®å¼‚åŒ–ï¼Œå¹¶å¸®åŠ©åˆ›å»ºä¸€ä¸ªæ›´åŠ å•†å“åŒ–çš„äº‘è®¡ç®—ç‰ˆæœ¬ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºå¤©ç©ºè®¡ç®—ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬ç®€è¦æ€»ç»“äº†äº‘è®¡ç®—çš„å†å²ï¼Œä¸ºæœ¬æ–‡çš„å…¶ä½™éƒ¨åˆ†æä¾›èƒŒæ™¯ã€‚ ","date":"2024-12-04","objectID":"/posts/paper-skycomputing/:3:0","tags":["Paper Reading"],"title":"Paper Reading: From Cloud Computing to Sky Computing","uri":"/posts/paper-skycomputing/"},{"categories":null,"content":"Historical Context The NSF high performance computing (HPC) initiative in the 1980s provided an early glimpse of the utility computing vision, though limited to the HPC community ä¸ªäººè®¡ç®—æœºäº§ä¸šç”±é‚£äº›æƒ³è¦æ‹¥æœ‰è‡ªå·±çš„æœºå™¨è¿›è¡Œæ£é¼“çš„çˆ±å¥½è€…å‘èµ·ï¼Œå¹¶ç”±æ‘©å°”å®šå¾‹æ¨åŠ¨ï¼Œä½¿å¾—ä¸ªäººè®¡ç®—æœºèƒ½å¤Ÿè¿…é€Ÿæ»¡è¶³ä¸æ–­å¢é•¿çš„ç”¨æˆ·éœ€æ±‚ã€‚ äº’è”ç½‘çš„å‡ºç°è¿…é€Ÿä½¿å¾—åŒ…æ‹¬ç”µå­é‚®ä»¶ã€å…¬å‘Šæ¿ç³»ç»Ÿå’Œæ¸¸æˆåœ¨å†…çš„å¤šç§æµè¡ŒæœåŠ¡åœ¨å…¨çƒèŒƒå›´å†…å¯è®¿é—®ã€‚ è®¸å¤šå…¬å¸ï¼Œå¦‚é›…è™ã€è°·æ­Œã€eBay å’Œäºšé©¬é€Šï¼Œéƒ½éµå¾ªäº†è¿™æ¡é“è·¯ï¼Œä½†åˆ›å»ºå¤§è§„æ¨¡æœåŠ¡ç‰¹å®šåŸºç¡€è®¾æ–½çš„è´£ä»»æˆä¸ºäº†è¿›å…¥äº’è”ç½‘æœåŠ¡å¸‚åœºçš„éšœç¢ï¼Œå› ä¸ºè¿™äº›æ­¥éª¤éœ€è¦å·¨é¢æŠ•èµ„ï¼Œå¤§å¤šæ•°å…¬å¸æ— æ³•è´Ÿæ‹…ã€‚ è¿™ä¸€æƒ…å†µåœ¨ 2006 å¹´å‘ç”Ÿäº†å˜åŒ–ï¼Œå½“æ—¶äºšé©¬é€Šæ¨å‡ºäº† S3 å’Œ EC2ï¼Œé€šè¿‡ democratizing access to compute/storage and promoting the â€œpay-as-you-goâ€ business model. è¿™ï¼Œå†åŠ ä¸Šæ‘©å°”å®šå¾‹çš„ç»ˆç»“ï¼ˆè¿™ä½¿å¾—åœ¨æœ¬åœ°é›†ç¾¤ä¸­æ„å»ºå’Œæ‰©å±•æœåŠ¡å˜å¾—ç›¸å½“æ˜‚è´µï¼‰ï¼Œå¯¼è‡´äº†å¯¹å¯èƒ½æˆä¸º utility computing çš„é‡æ–°æ¨åŠ¨ã€‚ ç„¶è€Œï¼Œå•†ä¸šè¶‹åŠ¿å°†æˆ‘ä»¬æ¨å‘äº†ä¸åŒçš„æ–¹å‘ã€‚åœ¨äºšé©¬é€Šåœ¨äº‘è®¡ç®—é¢†åŸŸå æ®ä¸»å¯¼åœ°ä½çš„æ—©æœŸï¼Œä»–ä»¬ä¸ºäº‘è®¡ç®—è®¾å®šäº†äº‹å®ä¸Šçš„æ ‡å‡†ã€‚ç„¶è€Œï¼Œåœ¨è¿‡å»åå¹´ä¸­ï¼Œè¿™ä¸ªå¸‚åœºä¸Šå‡ºç°äº†å¤šä¸ªç«äº‰å¯¹æ‰‹ã€‚æ ¹æ®æœ€è¿‘çš„ä¸€ä»½æŠ¥å‘Š[6]ï¼ŒAWS ç°åœ¨ä»…æ‹¥æœ‰ 32%çš„å¸‚åœºä»½é¢ï¼Œå…¶æ¬¡æ˜¯å¾®è½¯å  19%ï¼Œè°·æ­Œå  7%ï¼Œé˜¿é‡Œå·´å·´å  6%ï¼Œå…¶ä»–äº‘ï¼ˆå¦‚ IBM å’Œç”²éª¨æ–‡ï¼‰ç“œåˆ†äº†å‰©ä½™çš„ 37%å¸‚åœºä»½é¢ï¼ˆç”±äºå››èˆäº”å…¥è¯¯å·®ï¼Œè¿™æ€»è®¡ä¸º 101%ï¼‰ã€‚ è¿™ç§ç«äº‰å¯¼è‡´äº†ä»·æ ¼çš„ä¸‹é™å’Œäº§å“ä¸æœåŠ¡çš„ä¸æ–­å¢åŠ ã€‚ä¾‹å¦‚ï¼Œä»… AWS å°±æä¾›äº†è¶…è¿‡ 175 ç§äº§å“å’ŒæœåŠ¡[8]ã€‚ç„¶è€Œï¼Œè®¸å¤šè¿™äº›æœåŠ¡æ˜¯ä¸“æœ‰çš„ï¼Œè¿™äº›ä¸“æœ‰æœåŠ¡æ˜¯äº‘æä¾›å•†åŒºåˆ†è‡ªå·±çš„ä¸»è¦æ–¹å¼ä¹‹ä¸€ã€‚ä¾‹å¦‚ï¼Œæ¯ä¸ªäº‘éƒ½æœ‰è‡ªå·±ç®¡ç†é›†ç¾¤çš„ APIï¼Œè‡ªå·±çš„å¯¹è±¡å­˜å‚¨ç‰ˆæœ¬ï¼Œè‡ªå·±çš„æ•°æ®ä»“åº“ç‰ˆæœ¬ï¼Œè‡ªå·±çš„æ— æœåŠ¡å™¨äº§å“ï¼Œç­‰ç­‰ã€‚åœ¨ä¸€ä¸ªäº‘ä¸Šå¼€å‘çš„åº”ç”¨ç¨‹åºé€šå¸¸åœ¨ä¸åŒçš„äº‘ä¸Šæ— æ³•è¿è¡Œï¼Œé™¤éè¿›è¡Œå¤§é‡ä¿®æ”¹ï¼Œå°±åƒä¸ºå¾®è½¯ Windows ç¼–å†™çš„åº”ç”¨ç¨‹åºéœ€è¦å¤§é‡ä¿®æ”¹æ‰èƒ½åœ¨ Mac OS ä¸Šè¿è¡Œä¸€æ ·ã€‚å› æ­¤ï¼Œäº‘è®¡ç®—å¸‚åœºçš„ç«äº‰ä½¿æˆ‘ä»¬è¿œç¦»äº†å…¬ç”¨è®¡ç®—çš„æ„¿æ™¯ã€‚ å½“ç„¶ï¼Œæœ‰è®¸å¤šå‘¼åæ ‡å‡†åŒ–äº‘è®¡ç®—[28, 39]ï¼Œä½†è¿™äº›å¯¹æ¨åŠ¨äº‘è®¡ç®—å·®å¼‚åŒ–çš„å½±å“ç”šå¾®ã€‚å½“å‰äº‘æä¾›å•†çš„å•†ä¸šæ¨¡å¼å›´ç»•ç€å¸å¼•å¹¶ç•™ä½å®¢æˆ·ï¼Œè¿™ä¸æä¾›çº¯ç²¹çš„å•†å“åŒ–æœåŠ¡ç›¸æ‚–ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬è¦è§£å†³çš„é—®é¢˜æ˜¯ï¼Œæˆ‘ä»¬å¦‚ä½•æœç€å…¬ç”¨è®¡ç®—çš„ç›®æ ‡å–å¾—è¿›å±•ï¼Ÿ æˆ‘ä»¬çš„æè®®è¢«ç§°ä¸ºå¤©ç©ºè®¡ç®—ï¼Œæ„åœ¨è¡¨æ˜æˆ‘ä»¬è¯•å›¾è¶…è¶Šå•ä¸ªäº‘çš„å±€é™ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬å¹¶ä¸æ˜¯ç¬¬ä¸€ä¸ªä½¿ç”¨â€œå¤©ç©ºè®¡ç®—â€è¿™ä¸€æœ¯è¯­çš„äººã€‚è‡ª 2009 å¹´ä»¥æ¥ï¼Œå‡ ç¯‡è®ºæ–‡æå‡ºäº†ä»¥è¿™ä¸ªåå­—å‘½åçš„è®¾è®¡[30, 34, 35]ã€‚ç„¶è€Œï¼Œè¿™äº›è®ºæ–‡å…³æ³¨äºç‰¹å®šçš„æŠ€æœ¯è§£å†³æ–¹æ¡ˆï¼Œä¾‹å¦‚åœ¨è·¨äº‘åŸºç¡€è®¾æ–½å³æœåŠ¡å¹³å°ï¼ˆå¦‚ Nimbusï¼‰ä¸Šè¿è¡Œä¸­é—´ä»¶ï¼Œå¹¶é’ˆå¯¹ç‰¹å®šçš„å·¥ä½œè´Ÿè½½ï¼Œå¦‚é«˜æ€§èƒ½è®¡ç®—ï¼ˆHPCï¼‰ã€‚æœ¬æ–‡å¯¹å¤©ç©ºè®¡ç®—æŒæ›´å¹¿æ³›çš„è§†è§’ï¼Œå°†å…¶ä½œä¸ºæœªæ¥åº”ç”¨ç¨‹åºçš„é€šç”¨è½¯ä»¶å¹³å°ï¼Œå¹¶è€ƒè™‘æŠ€æœ¯è¶‹åŠ¿å’Œå¸‚åœºåŠ›é‡å¦‚ä½•åœ¨å¤©ç©ºè®¡ç®—çš„å‡ºç°ä¸­å‘æŒ¥å…³é”®ä½œç”¨ã€‚ ","date":"2024-12-04","objectID":"/posts/paper-skycomputing/:4:0","tags":["Paper Reading"],"title":"Paper Reading: From Cloud Computing to Sky Computing","uri":"/posts/paper-skycomputing/"},{"categories":null,"content":"Lessons from the Internet å°½ç®¡äº‘è®¡ç®—å’Œäº’è”ç½‘åœ¨è®¸å¤šæ–¹é¢å­˜åœ¨å·®å¼‚ï¼Œä½†æˆ‘ä»¬è®¤ä¸ºäº’è”ç½‘æä¾›äº†ä¸€ç»„æœ‰ç”¨çš„å†å²æ•™è®­ã€‚åœ¨ 20 ä¸–çºª 60 å¹´ä»£åˆï¼Œå‡ ä¸ªå›¢ä½“æ­£åœ¨å¼€å‘åˆ†ç»„äº¤æ¢æŠ€æœ¯ã€‚è¿™äº›æ—©æœŸçš„ç½‘ç»œå·¥ä½œè‰¯å¥½ï¼Œä½†å½¼æ­¤ä¸å…¼å®¹ã€‚ç¤¾åŒºé¢ä¸´ä¸€ä¸ªé€‰æ‹©ï¼šæ˜¯åº”è¯¥æ ‡å‡†åŒ–å•ä¸€çš„ç½‘ç»œæŠ€æœ¯ï¼Œè¿˜æ˜¯èƒ½æ‰¾åˆ°ä¸€ç§æ–¹å¼æ¥å®¹çº³å¤šæ ·æ€§ï¼Ÿ1972 å¹´ï¼Œç½—ä¼¯ç‰¹Â·å¡æ©æå‡ºäº†å¼€æ”¾æ¶æ„ç½‘ç»œ[32]ï¼Œä¸»å¼ ä¸€ä¸ªé€šç”¨çš„äº’æ“ä½œæ€§å±‚ï¼Œå…è®¸ä»»ä½•ä¸¤ä¸ªç½‘ç»œäº’è”ã€‚è¿™æˆä¸ºäº†äº’è”ç½‘åè®®ï¼ˆIPï¼‰ã€‚ ä¸ªäººè§‰å¾— Internet å’Œ Cloud è¿˜æ˜¯ä¸å¤ªä¸€æ · Cloud ä»æœ¬è´¨æ¥è¯´å°±ä¸å¤ªé€‚åˆæ ‡å‡†åŒ–ï¼Œæˆæœ¬æ¥è¯´ï¼Œè°ä¾¿å®œå°±ç”¨è°ã€‚ å› æ­¤ï¼Œæœ‰ä¸‰ä¸ªå…³é”®çš„è®¾è®¡å†³ç­–ä½¿å¾—äº’è”ç½‘èƒ½å¤Ÿä¸ºç”±å¼‚æ„æŠ€æœ¯ï¼ˆä»ä»¥å¤ªç½‘åˆ° ATM åˆ°æ— çº¿ï¼‰å’Œç«äº‰å…¬å¸ç»„æˆçš„å¤§å‹åŸºç¡€è®¾æ–½æä¾›ç»Ÿä¸€çš„æ¥å£ã€‚é¦–å…ˆæ˜¯æ©ç›–æŠ€æœ¯å¼‚æ„æ€§çš„â€œå…¼å®¹æ€§â€å±‚ã€‚ç¬¬äºŒæ˜¯åŸŸé—´è·¯ç”±ï¼Œå®ƒå°†äº’è”ç½‘ç²˜åˆåœ¨ä¸€èµ·ï¼Œä½¿å…¶å¯¹ç»ˆç«¯ç”¨æˆ·æ¥è¯´åƒä¸€ä¸ªç½‘ç»œã€‚ç¬¬ä¸‰æ˜¯ä¸€ç»„ç»æµåè®®ï¼Œå½¢æˆäº†æˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œå¯¹ç­‰â€å±‚ï¼Œå…è®¸ç«äº‰ç½‘ç»œåœ¨åˆ›å»ºç»Ÿä¸€ç½‘ç»œä¸­åˆä½œã€‚ äº’è”ç½‘è¦è§£å†³çš„ä¸‰ä¸ªé—®é¢˜ï¼š compatibility interdomain routing economic agreements è¿™å¯¹äº‘è®¡ç®—æœ‰ä»€ä¹ˆå¯ç¤ºï¼Ÿä¸ºäº†å®ç°å…¬ç”¨è®¡ç®—çš„æ„¿æ™¯ï¼Œåº”ç”¨ç¨‹åºåº”è¯¥èƒ½å¤Ÿåœ¨ä»»ä½•äº‘æä¾›å•†ä¸Šè¿è¡Œï¼ˆå³ä¸€æ¬¡ç¼–å†™ï¼Œéšå¤„è¿è¡Œï¼‰ã€‚æ­¤å¤–ï¼Œç”¨æˆ·ä¸åº”è¯¥éœ€è¦ç®¡ç†å•ä¸ªäº‘ä¸Šçš„éƒ¨ç½²ï¼Œæˆ–è€…åœ¨ä»ä¸€ä¸ªäº‘è¿ç§»åˆ°å¦ä¸€ä¸ªäº‘æ—¶é¢ä¸´é‡å¤§éšœç¢ã€‚ç®€è€Œè¨€ä¹‹ï¼Œå¯¹äºå¼€å‘è€…æ¥è¯´ï¼Œæ„å»ºä¸€ä¸ªå¤šäº‘åº”ç”¨ç¨‹åºåº”è¯¥åƒæ„å»ºä¸€ä¸ªè¿è¡Œåœ¨å•ä¸€äº‘ä¸Šçš„åº”ç”¨ç¨‹åºä¸€æ ·å®¹æ˜“ã€‚æˆ‘ä»¬ç§°ä¹‹ä¸ºå¤©ç©ºè®¡ç®—ã€‚æˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªæœ¯è¯­æ˜¯å› ä¸ºå…¬ç”¨è®¡ç®—æ„å‘³ç€åŸºç¡€è®¾æ–½æ˜¯ä¸€ä¸ªå…¬å…±äº‹ä¸šï¼Œè€Œå¤©ç©ºè®¡ç®—æŒ‡çš„æ˜¯åœ¨ç”±å¤šä¸ªå’Œå¼‚æ„çš„ç«äº‰å•†ä¸šäº‘æä¾›å•†ç»„æˆçš„åŸºç¡€è®¾æ–½ä¸Šæ„å»ºå…¬ç”¨è®¡ç®—çš„å¹»è±¡ã€‚ æˆ‘ä»¬è®¤ä¸ºï¼Œäº’è”ç½‘å¿…é¡»è§£å†³çš„ä¸‰ä¸ªè®¾è®¡é—®é¢˜æ­£æ˜¯ä»æˆ‘ä»¬å½“å‰çš„äº‘é›†åˆä¸­åˆ›å»ºå¤©ç©ºè®¡ç®—æ‰€éœ€çš„ç»„æˆéƒ¨åˆ†ã€‚æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå…¼å®¹æ€§å±‚æ¥æ©ç›–ä½çº§æŠ€æœ¯å·®å¼‚ï¼Œä¸€ä¸ªè·¨äº‘å±‚æ¥å°†ä½œä¸šè·¯ç”±åˆ°æ­£ç¡®çš„äº‘ï¼Œä»¥åŠä¸€ä¸ªå¯¹ç­‰å±‚ï¼Œå…è®¸äº‘ä¹‹é—´å°±å¦‚ä½•äº¤æ¢æœåŠ¡è¾¾æˆåè®®ã€‚åœ¨æ¥ä¸‹æ¥çš„ä¸‰ä¸ªéƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†æ›´è¯¦ç»†åœ°æè¿°è¿™äº›å±‚ã€‚ç„¶åï¼Œæˆ‘ä»¬é€šè¿‡æ¨æµ‹æœªæ¥æ¥ç»“æŸæœ¬æ–‡ã€‚ è¡¨ 1 å±•ç¤ºäº†æ‰€æå‡ºçš„å¤©ç©ºæ¶æ„ä¸äº’è”ç½‘ä¹‹é—´çš„ç›¸ä¼¼æ€§ï¼šè·¯ç”±å™¨ç±»ä¼¼äºæœåŠ¡å™¨ï¼ŒAS ç±»ä¼¼äºå¯ç”¨åŒºï¼ŒISP ç±»ä¼¼äºäº‘æä¾›å•†ã€‚å°±åƒåœ¨äº’è”ç½‘ä¸­ï¼ŒIP å¯¹åœ¨åŒä¸€ ISP æˆ–è·¨ ISP çš„è·¯ç”±å™¨ä¹‹é—´è·¯ç”±æ•°æ®åŒ…ä¸€æ— æ‰€çŸ¥ä¸€æ ·ï¼Œæ„å»ºåœ¨è·¨äº‘å±‚ä¸Šçš„åº”ç”¨ç¨‹åºåº”è¯¥å¯¹å…¶è¿è¡Œçš„äº‘ä¸€æ— æ‰€çŸ¥ã€‚ IP åè®®å˜æˆäº† compatibility layer BGPï¼ˆBorder Gateway Protocolï¼Œè¾¹ç•Œç½‘å…³åè®®ï¼‰æ˜¯ä¸€ç§ç”¨äºåœ¨ä¸åŒè‡ªæ²»ç³»ç»Ÿï¼ˆASï¼ŒAutonomous Systemï¼‰ä¹‹é—´äº¤æ¢è·¯ç”±ä¿¡æ¯çš„åè®®ã€‚å®ƒæ˜¯äº’è”ç½‘çš„æ ¸å¿ƒåè®®ä¹‹ä¸€ï¼Œè´Ÿè´£åœ¨ä¸åŒç½‘ç»œä¹‹é—´ä¼ é€’æ•°æ®åŒ…ã€‚BGP çš„ä¸»è¦åŠŸèƒ½æ˜¯é€‰æ‹©æœ€ä½³è·¯å¾„ï¼Œå°†æ•°æ®ä»ä¸€ä¸ªç½‘ç»œä¼ è¾“åˆ°å¦ä¸€ä¸ªç½‘ç»œã€‚ ","date":"2024-12-04","objectID":"/posts/paper-skycomputing/:5:0","tags":["Paper Reading"],"title":"Paper Reading: From Cloud Computing to Sky Computing","uri":"/posts/paper-skycomputing/"},{"categories":null,"content":"Compatibility Layer å®ç°å¤©ç©ºè®¡ç®—æ„¿æ™¯çš„ç¬¬ä¸€æ­¥æ˜¯æä¾›ä¸€ä¸ªäº‘å…¼å®¹æ€§å±‚ï¼›å³ï¼Œä¸€ä¸ªæŠ½è±¡æ‰äº‘æ‰€æä¾›æœåŠ¡çš„å±‚ï¼Œä½¿å¾—åœ¨è¿™ä¸ªå±‚ä¹‹ä¸Šå¼€å‘çš„åº”ç”¨ç¨‹åºå¯ä»¥åœ¨ä¸åŒçš„äº‘ä¸Šè¿è¡Œè€Œæ— éœ€ä¿®æ”¹ã€‚ç®€è€Œè¨€ä¹‹ï¼Œå…¼å®¹æ€§å±‚æ˜¯ä¸€ç»„åº”ç”¨ç¨‹åºå¯ä»¥æ„å»ºåœ¨å…¶ä¸Šçš„æ¥å£æˆ– APIï¼›ç„¶åï¼Œè¿™ä¸ªå…¼å®¹æ€§å±‚å¯ä»¥ä½¿ç”¨äº‘çš„ä¸€ç»„ï¼ˆå¯èƒ½æ˜¯ä¸“æœ‰çš„ï¼‰æ¥å£ç§»æ¤åˆ°æ¯ä¸ªäº‘ä¸Šã€‚ å…¶å® POE è¿™ç§æ•´åˆäº†å¤šç§ LLM API çš„æ˜¯ä¸æ˜¯ä¹Ÿç®—ä¸€ç§ sky computing åœ¨æˆ‘ä»¬çš„äº’è”ç½‘ç±»æ¯”ä¸­ï¼Œè¿™ç±»ä¼¼äº IP å±‚ï¼Œå®ƒä½¿ä½¿ç”¨ä¸åŒåº•å±‚ï¼ˆL2ï¼‰é€šä¿¡æŠ€æœ¯çš„è·¯ç”±å™¨èƒ½å¤Ÿå¤„ç† IP æ•°æ®åŒ…ã€‚ç„¶è€Œï¼Œä¸ IP ä¸åŒï¼ŒIP æ˜¯ä¸€ä¸ª narrow waistï¼Œäº‘å…¼å®¹æ€§å±‚è¦å®½å¾—å¤šï¼Œå®šä¹‰ä¹Ÿä¸é‚£ä¹ˆæ˜ç¡®ï¼Œå› ä¸ºäº‘å‘åº”ç”¨ç¨‹åºæš´éœ²äº†ä¸°å¯Œçš„ï¼ˆä¸”ä¸æ–­å¢é•¿çš„ï¼‰æœåŠ¡é›†ï¼ŒåŒ…æ‹¬è®¡ç®—ã€å­˜å‚¨ã€æ•°æ®ä¼ è¾“ç­‰ã€‚å› æ­¤ï¼Œäº‘å…¼å®¹æ€§å±‚åœ¨ç²¾ç¥ä¸Šæ›´åƒæ˜¯ä¸€ä¸ªæ“ä½œç³»ç»Ÿï¼ˆä¾‹å¦‚ Linuxï¼‰ï¼Œå®ƒç®¡ç†è®¡ç®—æœºçš„èµ„æºå¹¶å‘åº”ç”¨ç¨‹åºæš´éœ² APIã€‚ IP is the narrow waist æ˜¯ä¸€ä¸ªæ¯”è¾ƒæœ‰æ„æ€çš„ç†å¿µ æˆ‘ä»¬å¦‚ä½•æ„å»ºè¿™æ ·ä¸€ä¸ªäº‘å…¼å®¹æ€§å±‚ï¼Ÿè™½ç„¶æ¯ä¸ªäº‘éƒ½æä¾›äº†ä¸€ç»„ä¸“æœ‰çš„ä½çº§æ¥å£ï¼Œä½†ä»Šå¤©çš„ç”¨æˆ·å¤§å¤šä¸æ›´é«˜çº§åˆ«çš„ç®¡ç†å’ŒæœåŠ¡æ¥å£äº¤äº’ã€‚å…¶ä¸­ä¸€äº›æ˜¯ä¸“æœ‰çš„ï¼Œä½†è¶Šæ¥è¶Šå¤šçš„æ¥å£å¾—åˆ°äº†å¼€æºè½¯ä»¶ï¼ˆOSSï¼‰çš„æ”¯æŒã€‚ è¿™äº› OSS é¡¹ç›®å­˜åœ¨äºè½¯ä»¶æ ˆçš„å„ä¸ªå±‚æ¬¡ï¼ŒåŒ…æ‹¬æ“ä½œç³»ç»Ÿï¼ˆLinuxï¼‰ã€é›†ç¾¤èµ„æºç®¡ç†å™¨ï¼ˆKubernetes [12]ï¼ŒApache Mesos [31]ï¼‰ã€åº”ç”¨ç¨‹åºæ‰“åŒ…ï¼ˆDocker [10]ï¼‰ã€æ•°æ®åº“ï¼ˆMySQL [15]ï¼ŒPostgres [17]ï¼‰ã€å¤§æ•°æ®æ‰§è¡Œå¼•æ“ï¼ˆApache Spark [42]ï¼ŒApache Hadoop [41]ï¼‰ã€æµå¼•æ“ï¼ˆApache Flink [26]ï¼ŒApache Spark [42]ï¼ŒApache Kafka [5]ï¼‰ã€åˆ†å¸ƒå¼æŸ¥è¯¢å¼•æ“å’Œæ•°æ®åº“ï¼ˆCassandra [4]ï¼ŒMongoDB [14]ï¼ŒPresto [18]ï¼ŒSparkSQL [22]ï¼ŒRedis [19]ï¼‰ã€æœºå™¨å­¦ä¹ åº“ï¼ˆPyTorch [37]ï¼ŒTensorflow [24]ï¼ŒMXNet [27]ï¼ŒMLFlow [13]ï¼ŒHorovod [40]ï¼ŒRay RLlib [33]ï¼‰ä»¥åŠé€šç”¨åˆ†å¸ƒå¼æ¡†æ¶ï¼ˆRay [36]ï¼ŒErlang [25]ï¼ŒAkka [1]ï¼‰ã€‚ æ­¤å¤–ï¼Œç”± OSS åˆ›å»ºè€…åˆ›ç«‹çš„å¤§é‡å…¬å¸å·²ç»å‡ºç°ï¼Œä¸ºå¤šä¸ªäº‘æä¾›æ‰˜ç®¡æœåŠ¡ã€‚ä¾‹å¦‚ Clouderaï¼ˆApache Hadoopï¼‰ã€Confluentï¼ˆApache Kafkaï¼‰ã€MongoDBã€Redis Labsã€HashiCorpï¼ˆTerraformï¼ŒConsulï¼‰ã€Datastaxï¼ˆCassandraï¼‰å’Œ Databricksï¼ˆApache Sparkï¼ŒMLFlowï¼ŒDeltaï¼‰ã€‚è¿™äº›å‘å±•ä½¿å¾—ä¼ä¸šå¦‚æœä½¿ç”¨è¿™äº›åŸºäºå¤šäº‘ OSS çš„äº§å“ï¼Œç›¸å¯¹å®¹æ˜“ä»ä¸€ä¸ªäº‘åˆ‡æ¢åˆ°å¦ä¸€ä¸ªäº‘ã€‚ å…¶å®ç°åœ¨ iceberg ç­‰ç­‰ä½¿ç”¨ parquet åº”è¯¥ä¹Ÿæ˜¯ç±»ä¼¼çš„ç†å¿µæŠŠ è™½ç„¶ OSS åœ¨è½¯ä»¶æ ˆçš„å¤§å¤šæ•°å±‚æä¾›äº†è§£å†³æ–¹æ¡ˆï¼Œä½†ä¸€ä¸ªæ˜æ˜¾çš„å·®è·æ˜¯å­˜å‚¨å±‚ã€‚æ¯ä¸ªäº‘æä¾›å•†éƒ½æœ‰è‡ªå·±çš„ä¸“æœ‰é«˜åº¦å¯æ‰©å±•å­˜å‚¨ç‰ˆæœ¬ã€‚ä¾‹å¦‚ AWS çš„ S3 [2]ã€å¾®è½¯çš„ Azure Blob Storage [7]å’Œè°·æ­Œçš„ Cloud Storage [11]ã€‚å°½ç®¡å¦‚æ­¤ï¼Œå·²ç»æœ‰å‡ ç§è§£å†³æ–¹æ¡ˆä¸º Azure çš„ Blob Storage å’Œè°·æ­Œçš„ Cloud Storage æä¾› S3 å…¼å®¹ APIï¼Œä¾‹å¦‚ S3Proxy [20]å’Œ Scality [21]ã€‚ä¸€äº›äº‘æä¾›å•†æä¾›è‡ªå·±çš„ S3 å…¼å®¹ APIï¼Œä»¥å¸®åŠ©å®¢æˆ·ä» AWS è¿‡æ¸¡åˆ°ä»–ä»¬è‡ªå·±çš„äº‘ã€‚åœ¨ä¸‹æ–‡ä¸­ï¼Œæˆ‘ä»¬å‡è®¾å…¼å®¹æ€§å±‚æä¾›çš„å­˜å‚¨ API å…è®¸è·¨äº‘è¯»å–æ•°æ®ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬è®¤ä¸ºåœ¨çº¯æŠ€æœ¯åŸºç¡€ä¸Šå®ç°ä¸€ä¸ªå¹¿æ³›å¯ç”¨çš„å…¼å®¹æ€§å±‚æ˜¯å®¹æ˜“å®ç°çš„ã€‚é—®é¢˜åœ¨äºå¸‚åœºæ˜¯å¦ä¼šæ”¯æŒè¿™æ ·çš„åŠªåŠ›ï¼Œå› ä¸ºè™½ç„¶å…¼å®¹æ€§å±‚å¯¹ç”¨æˆ·æœ‰æ˜æ˜¾çš„å¥½å¤„ï¼Œä½†å®ƒè‡ªç„¶ä¼šå¯¼è‡´äº‘æä¾›å•†çš„å•†å“åŒ–ï¼Œè¿™å¯èƒ½ä¸ç¬¦åˆä»–ä»¬çš„åˆ©ç›Šã€‚æˆ‘ä»¬å°†åœ¨ç¬¬ 7 èŠ‚è®¨è®ºæ¿€åŠ±é—®é¢˜ã€‚ ","date":"2024-12-04","objectID":"/posts/paper-skycomputing/:6:0","tags":["Paper Reading"],"title":"Paper Reading: From Cloud Computing to Sky Computing","uri":"/posts/paper-skycomputing/"},{"categories":null,"content":"Intercloud Layer å…¼å®¹æ€§å±‚åªæ˜¯å®ç°å¤©ç©ºæ„¿æ™¯çš„ç¬¬ä¸€æ­¥ã€‚å³ä½¿å…¼å®¹æ€§å±‚å…è®¸ç”¨æˆ·åœ¨ä¸åŒçš„äº‘ä¸Šè¿è¡Œåº”ç”¨ç¨‹åºè€Œæ— éœ€ä¿®æ”¹ï¼Œç”¨æˆ·ä»ç„¶éœ€è¦å†³å®šåœ¨å“ªä¸ªäº‘ä¸Šè¿è¡Œåº”ç”¨ç¨‹åºã€‚å› æ­¤ï¼Œç”¨æˆ·ä»ç„¶è´Ÿè´£åœ¨ä¸åŒçš„äº‘ä¹‹é—´è¿›è¡Œæ€§èƒ½/æˆæœ¬æƒè¡¡ã€‚è¿™ç±»ä¼¼äºè¦æ±‚äº’è”ç½‘ç”¨æˆ·ä¸ºå…¶åŸŸé—´æµé‡æ˜¾å¼é€‰æ‹© AS è·¯å¾„ï¼Œè¿™å°†æ˜¯ä¸€é¡¹ç¹é‡çš„ä»»åŠ¡ã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œäº’è”ç½‘ä½¿ç”¨ BGP è¿›è¡Œ AS çº§è·¯ç”±å†³ç­–ï¼Œè¿™äº›å†³ç­–å¯¹ç”¨æˆ·æ˜¯é€æ˜çš„ã€‚ç±»ä¼¼åœ°ï¼Œå¤©ç©ºæ¶æ„åº”è¯¥å®ç°ä¸€ä¸ªè·¨äº‘å±‚ï¼Œå°†äº‘æä¾›å•†ä»ç”¨æˆ·ä¸­æŠ½è±¡å‡ºæ¥ï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œç”¨æˆ·ä¸åº”è¯¥çŸ¥é“åº”ç”¨ç¨‹åºè¿è¡Œåœ¨å“ªä¸ªäº‘ä¸Šï¼ˆé™¤éä»–ä»¬æ˜ç¡®æƒ³è¦çŸ¥é“ï¼‰ã€‚è·¨äº‘å±‚åœ¨å…¼å®¹æ€§å±‚ä¹‹ä¸Šå®ç°ï¼Œå¦‚å›¾ 1 æ‰€ç¤ºã€‚ è·¨äº‘å±‚å¿…é¡»å…è®¸ç”¨æˆ·æŒ‡å®šä»–ä»¬çš„ä½œä¸šåº”è¯¥åœ¨å“ªé‡Œè¿è¡Œçš„ç­–ç•¥ï¼Œä½†ä¸éœ€è¦ç”¨æˆ·åšå‡ºå…³äºä½œä¸šæ”¾ç½®çš„ä½çº§å†³ç­–ï¼ˆä½†å¦‚æœç”¨æˆ·æ„¿æ„ï¼Œå¯ä»¥å…è®¸ä»–ä»¬è¿™æ ·åšï¼‰ã€‚ intercloud è¿˜æ˜¯éœ€è¦è€ƒè™‘ä¸åŒçš„æ€§èƒ½ã€æˆæœ¬å’Œéšç§ç­‰ç­‰ (1) A uniform naming scheme for OSS services. (2) A directory service which allows cloud providers to register their services, and applications to select a service based on their preferences. (3) An accounting and charging mechanism across clouds. Service Naming Scheme å‘½åæ–¹æ¡ˆæ¥æ ‡è¯†è¯¥å®ä¾‹ï¼Œå°½ç®¡ä¸€ä¸ªè‡ªç„¶çš„å¯èƒ½æ€§æ˜¯åˆ©ç”¨ DNS æ¥å‘½åè¿™äº›æœåŠ¡å®ä¾‹ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬éœ€è¦å°†å…ƒæ•°æ®ä¸æ¯ä¸ªè¿™æ ·çš„æœåŠ¡å®ä¾‹å…³è”èµ·æ¥ã€‚è¿™æ ·çš„å…ƒæ•°æ®åº”åŒ…å«å¦‚ä½•è°ƒç”¨æœåŠ¡ã€äº‘æä¾›å•†çš„åç§°ã€ä½ç½®ã€è½¯ä»¶æˆ– API ç‰ˆæœ¬ã€ç¡¬ä»¶ç±»å‹ç­‰ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬å¯èƒ½è¿˜å¸Œæœ›æ·»åŠ åŠ¨æ€ä¿¡æ¯ï¼Œå¦‚å®šä»·ã€è´Ÿè½½å’Œå¯ç”¨æ€§ã€‚ Directory service éœ€è¦ç‰¹å®šæœåŠ¡çš„åº”ç”¨ç¨‹åºå¿…é¡»æ‰¾åˆ°æ»¡è¶³å…¶è¦æ±‚å’Œåå¥½çš„æœåŠ¡å®ä¾‹ã€‚è¿™å°±éœ€è¦ä¸€ä¸ªç›®å½•æœåŠ¡ã€‚ Accounting and charging ï¼Œç”¨æˆ·çš„åº”ç”¨ç¨‹åºå¯ä»¥åœ¨è®¸å¤šäº‘ä¸­çš„ä¸€ä¸ªæˆ–ç”šè‡³åœ¨å¤šä¸ªäº‘ä¸ŠåŒæ—¶è¿è¡Œï¼Œæ¯ä¸ªäº‘å¿…é¡»å¯¹ä½¿ç”¨çš„èµ„æºè¿›è¡Œä¼šè®¡å¤„ç†ã€‚å¦‚æœæ¯ä¸ªäº‘éƒ½è¿›è¡Œè®¡è´¹ï¼Œæ¯ä¸ªç”¨æˆ·éƒ½éœ€è¦åœ¨æ¯ä¸ªäº‘ä¸Šæ‹¥æœ‰è´¦æˆ·ã€‚æˆ‘ä»¬å»ºè®®ä¸€ä¸ªæ›¿ä»£æ–¹æ¡ˆï¼Œæ¯ä¸ªç”¨æˆ·ä¸ç¬¬ä¸‰æ–¹ç»çºªäººï¼ˆå¯èƒ½æ˜¯äº‘æä¾›å•†ä¹‹ä¸€ï¼‰ç­¾çº¦ï¼Œè¯¥ç»çºªäººåœ¨æ‰€æœ‰äº‘ä¸Šéƒ½æœ‰è´¦æˆ·ï¼Œå¹¶ç´¯ç§¯è´¹ç”¨ï¼Œç„¶åå°†æ¯ä¸ªç”¨æˆ·çš„ä»˜æ¬¾åˆ†é…å›å„ä¸ªäº‘ã€‚ å…¶å®æœ€å¤§çš„é—®é¢˜æ˜¯ï¼Œè°æ¥åš sky computing? the issue is whether the market will produce one? ","date":"2024-12-04","objectID":"/posts/paper-skycomputing/:7:0","tags":["Paper Reading"],"title":"Paper Reading: From Cloud Computing to Sky Computing","uri":"/posts/paper-skycomputing/"},{"categories":null,"content":"Peering Between Clouds è·¨äº‘å±‚æ—¨åœ¨åœ¨æœ€èƒ½æ»¡è¶³å…¶éœ€æ±‚çš„äº‘ï¼ˆæˆ–äº‘ï¼‰ä¸Šè¿è¡Œä½œä¸šã€‚å¦‚æœä½œä¸šæ¶‰åŠå¤§æ•°æ®é›†ï¼Œå°±åƒè®¸å¤šå¸¸è§çš„äº‘å·¥ä½œè´Ÿè½½ä¸€æ ·ï¼Œè¿™å°†éœ€è¦å°†æ•°æ®ç§»åŠ¨åˆ°è®¡ç®—å‘ç”Ÿçš„äº‘ä¸Š æµé‡å’Œæœºå™¨æ¯”è°æ›´åŠ è´µï¼Ÿ è¿˜æ˜¯è¯´æ•°æ®ç§»åŠ¨æ‰æ˜¯è´µçš„ ","date":"2024-12-04","objectID":"/posts/paper-skycomputing/:8:0","tags":["Paper Reading"],"title":"Paper Reading: From Cloud Computing to Sky Computing","uri":"/posts/paper-skycomputing/"},{"categories":null,"content":"Speculations About The Future å¦‚ä¸Šæ‰€è¿°ï¼Œè™½ç„¶å…¼å®¹æ€§å±‚å‡ ä¹æ²¡æœ‰æŠ€æœ¯éšœç¢ï¼Œä½†å®ƒä¼šä½¿äº‘è®¡ç®—æ›´åƒä¸€ç§å•†å“ã€‚ æ­¤å¤–ï¼Œè™½ç„¶å¤§å‹ç°æœ‰äº‘æä¾›å•†å¯èƒ½ä¸ä¼šå¯¹å…¼å®¹æ€§å±‚æ„Ÿåˆ°é«˜å…´ï¼Œä½†æˆ‘ä»¬é¢„è®¡è¾ƒå°çš„äº‘æä¾›å•†ä¼šæ‹¥æŠ±è¿™æ ·çš„å±‚ã€‚ å…¶å®ç¡®å®ï¼Œä¸å°‘äº‘ DB éƒ½ä¼šæ”¯æŒ aws/azure/gcp å¤šç§äº‘ï¼Œä½†åº”è¯¥æ˜¯ä¸ºäº†æ»¡è¶³ä¸åŒå®¢æˆ·çš„éœ€æ±‚ è€Œä¸æ˜¯çœŸçš„æ„¿æ„å»åšå¤§ä¸€ç»Ÿï¼Œä¸åŒæŠ€æœ¯å…¼å®¹è¿˜æ˜¯æ»¡å›°éš¾å’Œç¹ççš„ è¿˜æ˜¯å¤ªç†æƒ³ï¼Œä½†ç¡®å®å¯èƒ½æ…¢æ…¢çš„å¤§å®¶ä¼šå¾€è¿™ä¸ªæ–¹å‘èµ° ","date":"2024-12-04","objectID":"/posts/paper-skycomputing/:9:0","tags":["Paper Reading"],"title":"Paper Reading: From Cloud Computing to Sky Computing","uri":"/posts/paper-skycomputing/"},{"categories":null,"content":"ServiceRouter: Hyperscale and Minimal Cost Service Mesh at Meta Meta çš„å…¨çƒæœåŠ¡ç½‘æ ¼ ServiceRouterï¼ˆSRï¼‰ æœåŠ¡ç½‘æ ¼ï¼ˆService Meshï¼‰æ˜¯ä¸€ç§ç”¨äºå¤„ç†å¾®æœåŠ¡æ¶æ„ä¸­æœåŠ¡ä¹‹é—´é€šä¿¡çš„è½¯ä»¶å±‚ã€‚å®ƒé€šè¿‡åœ¨æœåŠ¡ä¹‹é—´æ’å…¥ä»£ç†ï¼Œå®ç°é€šä¿¡æ§åˆ¶å’Œç›‘æ§ï¼Œä»è€Œæé«˜ç³»ç»Ÿçš„å¯é æ€§ã€å®‰å…¨æ€§å’Œå¯è§‚æµ‹æ€§ã€‚ æµé‡ç®¡ç†ã€è´Ÿè½½å‡è¡¡ï¼Ÿ ","date":"2024-12-02","objectID":"/posts/paper-servicerouter/:1:0","tags":["Paper Reading"],"title":"Paper Reading: ServiceRouter: Hyperscale and Minimal Cost Service Mesh at Meta","uri":"/posts/paper-servicerouter/"},{"categories":null,"content":"Abstract æ•°æ®ä¸­å¿ƒåº”ç”¨ç¨‹åºé€šå¸¸è¢«æ„å»ºä¸ºè®¸å¤šç›¸äº’è¿æ¥çš„å¾®æœåŠ¡ï¼Œè€ŒæœåŠ¡ç½‘æ ¼å·²æˆä¸ºåœ¨æœåŠ¡ä¹‹é—´è·¯ç”± RPC æµé‡çš„æµè¡Œæ–¹æ³•ã€‚ SR ä¸å…¬å¼€å·²çŸ¥çš„æœåŠ¡ç½‘æ ¼åœ¨å‡ ä¸ªé‡è¦æ–¹é¢æœ‰æ‰€ä¸åŒã€‚é¦–å…ˆï¼ŒSR æ˜¯ä¸ºè¶…å¤§è§„æ¨¡è®¾è®¡çš„ï¼Œç›®å‰ä½¿ç”¨æ•°ç™¾ä¸‡ä¸ª L7 è·¯ç”±å™¨åœ¨æ•°ä¸‡ä¸ªæœåŠ¡ä¹‹é—´æ¯ç§’è·¯ç”±æ•°åƒäº¿ä¸ªè¯·æ±‚ å…¶æ¬¡ï¼Œè™½ç„¶ SR é‡‡ç”¨äº†ä½¿ç”¨ sidecar æˆ–è¿œç¨‹ä»£ç†æ¥è·¯ç”±æˆ‘ä»¬ fleet ä¸­ 1%çš„ RPC è¯·æ±‚çš„å¸¸è§æ–¹æ³•ï¼Œä½†å®ƒé‡‡ç”¨äº†ä¸€ä¸ªè·¯ç”±åº“ï¼Œè¯¥åº“ç›´æ¥é“¾æ¥åˆ°æœåŠ¡å¯æ‰§è¡Œæ–‡ä»¶ä¸­ï¼Œä»¥å°†å‰©ä½™çš„ 99% ç›´æ¥ä»å®¢æˆ·ç«¯è·¯ç”±åˆ°æœåŠ¡å™¨ï¼Œè€Œæ— éœ€é€šè¿‡ä»£ç†çš„é¢å¤–è·³è½¬ã€‚è¿™ç§æ–¹æ³•æ˜¾è‘—é™ä½äº†æˆ‘ä»¬è¶…å¤§è§„æ¨¡æœåŠ¡ç½‘æ ¼çš„ç¡¬ä»¶æˆæœ¬ï¼ŒèŠ‚çœäº†æ•°åä¸‡å°æœºå™¨ã€‚ç¬¬ä¸‰ï¼ŒSR å†…ç½®æ”¯æŒåˆ†ç‰‡æœåŠ¡ï¼Œè¿™äº›æœåŠ¡å æˆ‘ä»¬èˆ°é˜Ÿä¸­ 68%çš„ RPC è¯·æ±‚ï¼Œè€Œç°æœ‰çš„é€šç”¨æœåŠ¡ç½‘æ ¼ä¸æ”¯æŒåˆ†ç‰‡ sharded æœåŠ¡ã€‚æœ€åï¼ŒSR å¼•å…¥äº†å±€éƒ¨æ€§ç¯çš„æ¦‚å¿µï¼Œä»¥åŒæ—¶æœ€å°åŒ– RPC å»¶è¿Ÿå¹¶åœ¨åœ°ç†åˆ†å¸ƒçš„æ•°æ®ä¸­å¿ƒåŒºåŸŸä¹‹é—´å¹³è¡¡è´Ÿè½½ï¼Œæ®æˆ‘ä»¬æ‰€çŸ¥ï¼Œè¿™æ˜¯ä»¥å‰æœªæ›¾å°è¯•è¿‡çš„ã€‚ ","date":"2024-12-02","objectID":"/posts/paper-servicerouter/:2:0","tags":["Paper Reading"],"title":"Paper Reading: ServiceRouter: Hyperscale and Minimal Cost Service Mesh at Meta","uri":"/posts/paper-servicerouter/"},{"categories":null,"content":"Introduction å¾®æœåŠ¡æ¶æ„ ä¸ºäº†ç®¡ç†è¿™äº›æœåŠ¡ä¹‹é—´çš„è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼ˆRPCï¼‰æµé‡ï¼Œè®¸å¤šç»„ç»‡ä½¿ç”¨æœåŠ¡ç½‘æ ¼ service mesh å›¾ 1 å±•ç¤ºäº†æœ€å¸¸è§çš„ç¬¬ 7 å±‚ï¼ˆL7ï¼Œå³åº”ç”¨å±‚ï¼‰æœåŠ¡ç½‘æ ¼å½¢å¼ã€‚åœ¨è¿™ç§æ¶æ„ä¸­ï¼Œæ¯ä¸ªæœåŠ¡è¿›ç¨‹éƒ½ä¼´éšç€ä¸€ä¸ªè¿è¡Œåœ¨åŒä¸€å°æœºå™¨ä¸Šçš„ L7 è¾¹è½¦ä»£ç†ï¼Œè¯¥ä»£ç†ä»£è¡¨æœåŠ¡è·¯ç”± RPC è¯·æ±‚ã€‚ ä¾‹å¦‚ï¼Œå½“æœºå™¨ 1 ä¸Šçš„æœåŠ¡ A å‘æœåŠ¡ B å‘é€è¯·æ±‚æ—¶ï¼Œæœºå™¨ 1 ä¸Šçš„ä»£ç†å°†è¯·æ±‚åœ¨æœºå™¨ 2 å’Œæœºå™¨ 3 ä¹‹é—´è¿›è¡Œè´Ÿè½½å‡è¡¡ã€‚å¦‚æœè‡ªåŠ¨æ‰©å±•ç³»ç»Ÿæ£€æµ‹åˆ°è´Ÿè½½å¢åŠ å¹¶å¼€å§‹åœ¨æœºå™¨ 4 ä¸Šå¯åŠ¨æœåŠ¡ B çš„æ–°å‰¯æœ¬ï¼Œæ§åˆ¶å¹³é¢çš„æœåŠ¡å‘ç°åŠŸèƒ½å°†é€šçŸ¥æœºå™¨ 1 ä¸Šçš„ä»£ç†ï¼Œè¯¥ä»£ç†éšåå°†æœºå™¨ 4 åŒ…å«åœ¨å…¶æœªæ¥å¯¹æœåŠ¡ B è¯·æ±‚çš„è´Ÿè½½å‡è¡¡ç›®æ ‡ä¸­ã€‚ æœ¬æ–‡ä»‹ç»äº† Meta çš„å…¨çƒæœåŠ¡ç½‘æ ¼ï¼Œç§°ä¸º ServiceRouterï¼ˆSRï¼‰ã€‚SR æ”¯æŒä¸€ç³»åˆ—å…¨é¢çš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬æœåŠ¡å‘ç°ã€è´Ÿè½½å‡è¡¡ã€æ•…éšœè½¬ç§»ã€è®¤è¯ã€åŠ å¯†ã€å¯è§‚æµ‹æ€§ã€è¿‡è½½ä¿æŠ¤ã€åˆ†å¸ƒå¼è¯·æ±‚è·Ÿè¸ªã€å®¹é‡ç®¡ç†çš„èµ„æºå½’å±ä»¥åŠç”¨äºå½±å­æµ‹è¯•çš„æµé‡å¤åˆ¶ã€‚ Scalability: ä¼ ç»Ÿä¸Šï¼Œè½¯ä»¶å®šä¹‰ç½‘ç»œä½¿ç”¨é›†ä¸­å¼æ§åˆ¶å¹³é¢å’Œåˆ†æ•£å¼æ•°æ®å¹³é¢ã€‚å¤§å¤šæ•°æœåŠ¡ç½‘æ ¼éµå¾ªè¿™ç§æ–¹æ³•ï¼Œå¹¶ä½¿ç”¨ä¸­å¤®æ§åˆ¶å™¨æ¥é…ç½®æ¯ä¸ªè¾¹è½¦ä»£ç†çš„è·¯ç”±è¡¨ å›¾ 2 å±•ç¤ºäº† SR çš„å¯æ‰©å±•æ¶æ„ åœ¨é¡¶éƒ¨ï¼Œä¸åŒçš„æ§åˆ¶å™¨ç‹¬ç«‹æ‰§è¡Œè¯¸å¦‚æ³¨å†ŒæœåŠ¡å’Œç”Ÿæˆæ¯ä¸ªæœåŠ¡çš„è·¨åŒºåŸŸè·¯ç”±è¡¨ç­‰åŠŸèƒ½ã€‚æ¯ä¸ªæ§åˆ¶å™¨ç‹¬ç«‹æ›´æ–°ä¸­å¤®è·¯ç”±ä¿¡æ¯åº“ï¼ˆRIBï¼‰ï¼Œè€Œä¸å…³å¿ƒé…ç½®æˆ–ç®¡ç†å•ä¸ª L7 è·¯ç”±å™¨ Routing Information Base (RIB) è´Ÿè´£æœåŠ¡å‘ç°ã€è·¯ç”±é…ç½®ã€è·¨åŒºè·¯ç”±é…ç½®ç­‰ç­‰ Hardware cost. SR é€šè¿‡æä¾›ä¸€ä¸ªåä¸º SRLib çš„åº“æ¥æ¶ˆé™¤å¯¹ä»£ç†åŠå…¶ç›¸å…³ç¡¬ä»¶æˆæœ¬çš„éœ€æ±‚ã€‚ ä¸ºäº†æ»¡è¶³æœåŠ¡çš„å¤šæ ·åŒ–éœ€æ±‚ï¼ŒSR å®ç°äº†ä¸åŒç±»å‹ L7 è·¯ç”±å™¨çš„æ— ç¼å…±å­˜ï¼ŒåŒ…æ‹¬ Istio é£æ ¼çš„è¾¹è½¦ä»£ç†ã€AWS-ELB é£æ ¼çš„ä¸“ç”¨è´Ÿè½½å‡è¡¡å™¨å’Œ gRPC é£æ ¼çš„æ—è·¯è´Ÿè½½å‡è¡¡å™¨ Sharded services SR å°†åˆ†ç‰‡æ”¯æŒä½œä¸ºé¦–è¦ä»»åŠ¡ï¼Œå¹¶ä½¿ç”¨å•ä¸€æ¡†æ¶æ¥æ”¯æŒåˆ†ç‰‡å’Œå¤åˆ¶ã€‚ Cross-region routing ç°æœ‰çš„è§£å†³æ–¹æ¡ˆæœªé’ˆå¯¹è·¨åœ°ç†åˆ†å¸ƒçš„æ•°æ®ä¸­å¿ƒåŒºåŸŸçš„è·¯ç”±è¿›è¡Œä¼˜åŒ–ã€‚ ä¸ºäº†æ›´å¥½åœ°æ”¯æŒè·¨åŒºåŸŸè·¯ç”±ï¼Œæˆ‘ä»¬å¼•å…¥äº†å±€éƒ¨æ€§ç¯çš„æ¦‚å¿µï¼Œè®©æœåŠ¡è¡¨è¾¾å®ƒä»¬åœ¨å»¶è¿Ÿå’Œè´Ÿè½½ä¹‹é—´çš„é¦–é€‰æƒè¡¡ã€‚ Contributions SR æ˜¯ä¸ºè¶…å¤§è§„æ¨¡è®¾è®¡çš„ã€‚ SR æ”¯æŒåœ¨ä¸€ä¸ªæœåŠ¡ç½‘æ ¼ä¸­ä¸åŒç±»å‹ L7 è·¯ç”±å™¨çš„æ— ç¼å…±å­˜ï¼ŒåŒ…æ‹¬è¾¹è½¦ä»£ç†ã€ä¸“ç”¨è´Ÿè½½å‡è¡¡å™¨ã€æ—è·¯è´Ÿè½½å‡è¡¡å™¨å’ŒåµŒå…¥å¼è·¯ç”±åº“ã€‚ å°½ç®¡ç°æœ‰æœåŠ¡ç½‘æ ¼ä»…å…³æ³¨æœªåˆ†ç‰‡çš„æœåŠ¡ï¼Œè¿™äº›æœåŠ¡ä»…å æˆ‘ä»¬èˆ°é˜Ÿ RPC è¯·æ±‚çš„ 32%ï¼ŒSR æä¾›äº†å¯¹åˆ†ç‰‡æœåŠ¡çš„å†…ç½®æ”¯æŒï¼Œè¿™äº›æœåŠ¡å æˆ‘ä»¬æµé‡çš„ 68%ã€‚ å±€éƒ¨æ€§ç¯ ","date":"2024-12-02","objectID":"/posts/paper-servicerouter/:3:0","tags":["Paper Reading"],"title":"Paper Reading: ServiceRouter: Hyperscale and Minimal Cost Service Mesh at Meta","uri":"/posts/paper-servicerouter/"},{"categories":null,"content":"Comparison of Services Mesh Architectures (1) which component fetches and caches the routing metadata, and (2) which component routes application RPC traffic. ","date":"2024-12-02","objectID":"/posts/paper-servicerouter/:4:0","tags":["Paper Reading"],"title":"Paper Reading: ServiceRouter: Hyperscale and Minimal Cost Service Mesh at Meta","uri":"/posts/paper-servicerouter/"},{"categories":null,"content":"Different Types of L7 Routers in SR SRLib SRLookaside SRSidecarProxy SRRemoteProxy åˆ†åˆ«æ˜¯è·¯ç”±åº“ï¼Œæ—è·¯è´Ÿè½½å‡è¡¡å™¨ï¼Œ sidecarï¼Œè¿œç¨‹ä»£ç† SRLib ç›´æ¥å‘é€è¯·æ±‚åˆ° Server SRLookaside è´Ÿè½½å‡è¡¡ SRSidecarProxy è¾¹è½¦ SRRemoteProxy è·¨åŒºåŸŸï¼Ÿ ","date":"2024-12-02","objectID":"/posts/paper-servicerouter/:4:1","tags":["Paper Reading"],"title":"Paper Reading: ServiceRouter: Hyperscale and Minimal Cost Service Mesh at Meta","uri":"/posts/paper-servicerouter/"},{"categories":null,"content":"Comparison of L7 Routers å¯¹æ¯”äº†ä¸åŒçš„ miniRIB è·¯ç”±åº“ï¼Ÿ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æ¯”è¾ƒè¡¨ 1 ä¸­çš„è§£å†³æ–¹æ¡ˆã€‚è§£å†³æ–¹æ¡ˆ(1)â€“(4)æ˜¯ä¸ç†æƒ³çš„ï¼Œå› ä¸ºç®¡ç†åµŒå…¥å¼åº“ä¸­çš„ miniRIB ä¼šå½±å“åº”ç”¨ç¨‹åºçš„æ€§èƒ½ï¼Œç”±äºç¼ºä¹éš”ç¦»ã€‚ è§£å†³æ–¹æ¡ˆ(5)ã€(7)å’Œ(8)æ˜¯ä¸ç†æƒ³çš„ï¼Œå› ä¸ºæ²¡æœ‰ç³»ç»Ÿè°ƒç”¨æ¥è®¿é—®å†…æ ¸ä¸­ç¼“å­˜çš„ miniRIBã€‚ä¾‹å¦‚ï¼ŒCilium çš„ eBPF ç¨‹åºåªèƒ½å¤„ç† L3/L4 åè®®ï¼Œä»ç„¶éœ€è¦ä½¿ç”¨è¾¹è½¦ä»£ç†æ¥å¤„ç† L7 åè®®ã€‚ä¸è§£å†³æ–¹æ¡ˆ(6)ç±»ä¼¼ï¼Œè§£å†³æ–¹æ¡ˆ(10)å’Œ(14)æ˜¯ä¸ç†æƒ³çš„ï¼Œå› ä¸ºéš¾ä»¥åœ¨å†…æ ¸ä¸­å®ç°é«˜çº§ L7 è·¯ç”±åŠŸèƒ½ã€‚è§£å†³æ–¹æ¡ˆ(12)æ˜¯ä¸ç†æƒ³çš„ï¼Œå› ä¸ºå®ƒä¸¥æ ¼æ¯”(16)å·®ï¼Œå³å¦‚æœè·¯ç”±ç”±è¿œç¨‹ä»£ç†æ‰§è¡Œï¼Œæœ€å¥½ä¹Ÿå°† miniRIB ç§»åˆ°è¿œç¨‹ä»£ç†ã€‚ç†è®ºä¸Šï¼Œè§£å†³æ–¹æ¡ˆ(15)åœ¨å®¢æˆ·ç«¯æœºå™¨ä¸Šä½¿ç”¨çš„å†…å­˜æ¯”(11)å°‘ã€‚ç„¶è€Œï¼Œ(15)åœ¨ Meta ä¸­æ²¡æœ‰ä½¿ç”¨ï¼Œå› ä¸ºå³ä½¿(11)ä¹Ÿæ²¡æœ‰å¹¿æ³›ä½¿ç”¨ï¼Œ(15)çš„é¢å¤–å¥½å¤„æœ‰é™ã€‚æœ€åï¼Œä¸ºäº†ä¾¿äºè®¿é—®ï¼Œæˆ‘ä»¬åœ¨è¡¨ 2 ä¸­æ€»ç»“äº†è®¾è®¡æ›¿ä»£æ–¹æ¡ˆçš„æ¯”è¾ƒã€‚ ","date":"2024-12-02","objectID":"/posts/paper-servicerouter/:4:2","tags":["Paper Reading"],"title":"Paper Reading: ServiceRouter: Hyperscale and Minimal Cost Service Mesh at Meta","uri":"/posts/paper-servicerouter/"},{"categories":null,"content":"ServiceRouter Design ","date":"2024-12-02","objectID":"/posts/paper-servicerouter/:5:0","tags":["Paper Reading"],"title":"Paper Reading: ServiceRouter: Hyperscale and Minimal Cost Service Mesh at Meta","uri":"/posts/paper-servicerouter/"},{"categories":null,"content":"Overview SR æ”¯æŒå›¾ 4 ä¸­æè¿°çš„æ‰€æœ‰å››ç§ L7 è·¯ç”±å™¨ç±»å‹ã€‚å¯¹äºè¾¹è½¦æˆ–è¿œç¨‹ä»£ç†è®¾ç½®ï¼Œæˆ‘ä»¬åœ¨ SRLib ä»£ç ä¹‹ä¸Šæ·»åŠ äº†ä¸€ä¸ªåŒ…è£…å±‚ï¼Œä»¥ä½¿å…¶ä½œä¸ºç‹¬ç«‹ä»£ç†è¿è¡Œã€‚SR çš„æ§åˆ¶å¹³é¢ç»„ä»¶å¦‚å›¾ 6 æ‰€ç¤ºï¼Œå¹¶è¿›ä¸€æ­¥è§£é‡Šå¦‚ä¸‹ã€‚ Routing Information Base ï¼ˆRIBï¼‰ã€‚RIB æ˜¯ä¸€ä¸ªåŸºäº Paxos çš„é”®å€¼å­˜å‚¨ Global Registry Serviceï¼ˆGRSï¼‰åœ¨ RIB ä¸­ç»´æŠ¤æœåŠ¡å’Œåˆ†ç‰‡å‘ç°ä¿¡æ¯ã€‚å›¾ 7 æ˜¾ç¤ºäº†åœ¨ GRS æ³¨å†Œçš„ä¸¤ä¸ªç¤ºä¾‹æœåŠ¡ã€‚æœåŠ¡ A æ˜¯å¤åˆ¶çš„ä½†æœªåˆ†ç‰‡ã€‚å½“é›†ç¾¤ç®¡ç†å™¨å¯åŠ¨æˆ–åœæ­¢æœåŠ¡ A çš„å®¹å™¨æ—¶ï¼Œå®ƒä¼šé€šçŸ¥ GRS æ›´æ–°æœåŠ¡ A çš„å‰¯æœ¬åˆ—è¡¨ã€‚æˆ‘ä»¬å°†åœ¨ Â§3.3 ä¸­è§£é‡Š SR å¯¹åˆ†ç‰‡æœåŠ¡çš„å†…ç½®æ”¯æŒã€‚ Configuration Management System (CMS) å…è®¸ä¸ºæ¯ä¸ªæœåŠ¡å®šåˆ¶è·¯ç”±ç­–ç•¥ï¼ŒåŒ…æ‹¬ RPC è¶…æ—¶ã€è¿æ¥é‡ç”¨ã€å±€éƒ¨æ€§è·¯ç”±åå¥½ç­‰ã€‚æœåŠ¡æ‰€æœ‰è€…éµå¾ªé…ç½®å³ä»£ç èŒƒå¼æ¥ç¼–å†™ã€å®¡æŸ¥å’Œæäº¤è·¯ç”±é…ç½®ã€‚å®ƒè¿˜æ”¯æŒè‡ªåŠ¨é…ç½®æ›´æ–°ã€‚ä¾‹å¦‚ï¼Œå»¶è¿Ÿç›‘æ§æœåŠ¡ï¼ˆLMSï¼‰å®šæœŸèšåˆå¹¶æäº¤ä¸è·¨åŒºåŸŸå»¶è¿Ÿç›¸å…³çš„é…ç½®æ›´æ–°ï¼Œä»¥æŒ‡å¯¼ SRLib çš„è·¯ç”±å†³ç­–ã€‚ Cross-region Routing Service (xRS). ä¸é›†ä¸­å¼è´Ÿè½½å‡è¡¡å™¨ç›¸æ¯”ï¼ŒSRLib åªæœ‰ä¸€ä¸ªå®¢æˆ·ç«¯çš„æœ¬åœ°è§†å›¾ï¼Œå¯èƒ½æ— æ³•åšå‡ºå…¨å±€æœ€ä¼˜çš„è·¯ç”±å†³ç­–ã€‚xRS é€šè¿‡èšåˆæ¯ä¸ªæœåŠ¡çš„å…¨å±€æµé‡ä¿¡æ¯å¹¶è®¡ç®—è·¨åŒºåŸŸè·¯ç”±è¡¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè¯¥è·¯ç”±è¡¨é€šè¿‡ RIB åˆ†å‘å¹¶ç”± SRLib ä½¿ç”¨ä»¥æŒ‡å¯¼å…¶è·¯ç”±å†³ç­– ","date":"2024-12-02","objectID":"/posts/paper-servicerouter/:5:1","tags":["Paper Reading"],"title":"Paper Reading: ServiceRouter: Hyperscale and Minimal Cost Service Mesh at Meta","uri":"/posts/paper-servicerouter/"},{"categories":null,"content":"Service Discovery æ¯ä¸ªæœºå™¨ä¸Šè¿è¡Œä¸€ä¸ª RIBDaemonï¼Œç»´æŠ¤ä¸€ä¸ªæ‰€è°“çš„ miniRIBï¼Œç¼“å­˜ RIB ä¸­ RPC å®¢æˆ·ç«¯è¿è¡Œæ‰€éœ€çš„å…·ä½“éƒ¨åˆ†ã€‚æœ€åˆï¼ŒminiRIB æ˜¯ç©ºçš„ã€‚å½“ SRLib æƒ³è¦å‘ç‰¹å®šæœåŠ¡ï¼ˆå¦‚æœåŠ¡ Xï¼‰å‘é€ RPC è¯·æ±‚æ—¶ï¼Œå®ƒä¼šä» RIBDaemon è¯·æ±‚æœåŠ¡ X çš„è·¯ç”±å…ƒæ•°æ®ã€‚RIBDaemon ä» RIB å‰¯æœ¬ä¸­è·å–å…ƒæ•°æ®ï¼Œå°†å…¶ç¼“å­˜åˆ°ç£ç›˜ä¸Šä»¥ä¾¿åœ¨æœºå™¨é‡å¯åä»ç„¶å¯ç”¨ï¼Œè®¢é˜…ä¸æœåŠ¡ X ç›¸å…³çš„æœªæ¥æ›´æ–°ï¼Œæœ€åå°†å…ƒæ•°æ®è¿”å›ç»™ SRLibã€‚SRLib ä¹Ÿè®¢é˜… RIBDaemon çš„æœªæ¥æ›´æ–°ï¼Œå¹¶å°†å…ƒæ•°æ®ç¼“å­˜åœ¨å†…å­˜ä¸­ï¼ˆä½†ä¸ç¼“å­˜åˆ°ç£ç›˜ï¼‰ä»¥ä¾›åç»­é‡ç”¨ï¼Œè¿™æ ·å®ƒå°±ä¸ä¼šåœ¨æ¯æ¬¡ RPC è¯·æ±‚æ—¶éƒ½è”ç³» RIBDaemonã€‚ å½“æœåŠ¡ X çš„éƒ¨ç½²åœ¨æœªæ¥å‘ç”Ÿå˜åŒ–æ—¶ï¼Œé›†ç¾¤ç®¡ç†å™¨é€šçŸ¥ GRS æ›´æ–° RIBã€‚æ›´æ–°ä¼šç«‹å³æ¨é€åˆ°æ‰€æœ‰ RIB å‰¯æœ¬ï¼Œè¿™äº›å‰¯æœ¬è¿›ä¸€æ­¥å°†æ›´æ–°æ¨é€åˆ°è®¢é˜…æœåŠ¡ X è·¯ç”±å…ƒæ•°æ®çš„æ‰€æœ‰ RIBDaemonã€‚æœ€åï¼ŒRIBDaemon å°†æ›´æ–°æ¨é€åˆ° SRLibã€‚æœåŠ¡ X å¯èƒ½éƒ¨ç½²åœ¨å¤šä¸ªæ•°æ®ä¸­å¿ƒåŒºåŸŸï¼Œæ¯ä¸ªåŒºåŸŸçš„å‰¯æœ¬ç”±ä¸åŒçš„åŒºåŸŸé›†ç¾¤ç®¡ç†å™¨ç®¡ç†ã€‚æ‰€æœ‰è¿™äº›é›†ç¾¤ç®¡ç†å™¨éƒ½ä¼šé€šçŸ¥ GRS æ›´æ–°æœåŠ¡ X çš„ç›¸åŒæœåŠ¡æ³¨å†Œè®°å½•ï¼Œä»¥ä¾¿å®¢æˆ·ç«¯çš„ RPC è¯·æ±‚å¯ä»¥æ½œåœ¨åœ°è·¯ç”±åˆ°ä»»ä½•åŒºåŸŸçš„å‰¯æœ¬ï¼ˆÂ§3.4.1ï¼‰ã€‚æœåŠ¡çš„æœåŠ¡å®¢æˆ·ç«¯å¯ä»¥é€‰æ‹©ä»…å‘ä½äºä¸å®¢æˆ·ç«¯ç›¸åŒåŒºåŸŸçš„æœåŠ¡å™¨å‘é€è¯·æ±‚ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸ºäº†å‡å°‘å¼€é”€ï¼ŒRIBDaemon ä»…è®¢é˜…æ¥è‡ªæœ¬åœ°åŒºåŸŸçš„æ›´æ–°ã€‚ åœ¨é›†ç¾¤ç®¡ç†å™¨çš„å¸®åŠ©ä¸‹ï¼Œå®¢æˆ·ç«¯ä¸éœ€è¦é€šè¿‡è¶…æ—¶ç‹¬ç«‹å‘ç°æœåŠ¡å™¨çš„æ•…éšœã€‚å½“æœåŠ¡å™¨å› è®¡åˆ’ç»´æŠ¤ï¼ˆå¦‚ä»£ç éƒ¨ç½²ï¼‰è€Œå…³é—­æ—¶ï¼Œé›†ç¾¤ç®¡ç†å™¨é¦–å…ˆæ›´æ–° RIB ä»¥é€šçŸ¥å®¢æˆ·ç«¯ï¼Œç„¶ååœæ­¢æœåŠ¡å™¨ã€‚å¯¹äºè®¡åˆ’å¤–æ•…éšœï¼Œé›†ç¾¤ç®¡ç†å™¨æ£€æµ‹å„ç§æ•…éšœï¼Œå¦‚è¿›ç¨‹å´©æºƒ/æŒ‚èµ·å’Œæœºå™¨æ•…éšœï¼Œå¹¶æ›´æ–° RIB ä»¥é€šçŸ¥å®¢æˆ·ç«¯ã€‚ ","date":"2024-12-02","objectID":"/posts/paper-servicerouter/:5:2","tags":["Paper Reading"],"title":"Paper Reading: ServiceRouter: Hyperscale and Minimal Cost Service Mesh at Meta","uri":"/posts/paper-servicerouter/"},{"categories":null,"content":"Support for Sharded Services SR çš„åˆ†ç‰‡æ˜ å°„æŠ½è±¡æ˜¯é€šç”¨çš„ï¼Œç›®å‰æ”¯æŒæ•°ç™¾ä¸ªåˆ†ç‰‡æœåŠ¡ã€‚å…¶ä¸­å¤§å¤šæ•°ï¼ˆä½†ä¸æ˜¯å…¨éƒ¨ï¼‰ç”±ä¸€ä¸ªé€šç”¨çš„åˆ†ç‰‡ç®¡ç†å™¨ç®¡ç†ï¼Œå½“æ·»åŠ æˆ–åˆ é™¤æ–°åˆ†ç‰‡æˆ–ç°æœ‰åˆ†ç‰‡åœ¨å®¹å™¨ä¹‹é—´è¿ç§»æ—¶ï¼Œåˆ†ç‰‡ç®¡ç†å™¨ä¼šé€šçŸ¥ GRS æ›´æ–°åˆ†ç‰‡æ³¨å†Œè¡¨ã€‚ é€šè¿‡ SRï¼Œåˆ†ç‰‡å’Œæœªåˆ†ç‰‡æœåŠ¡å…±äº«å¹¶é‡ç”¨ SR ä¸­çš„æ‰€æœ‰å¤æ‚ç»„ä»¶ï¼ˆå›¾ 2 å’Œå›¾ 6ï¼‰ã€‚æ­¤å¤–ï¼Œåˆ†ç‰‡æœåŠ¡çš„è·¯ç”±å¼€ç®±å³ç”¨ï¼Œæ— éœ€ä»»ä½•é¢å¤–åŠªåŠ›ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œç°æœ‰çš„é€šç”¨æœåŠ¡ç½‘æ ¼ä¸æ”¯æŒåˆ†ç‰‡æœåŠ¡ï¼Œåº”ç”¨ç¨‹åºå¿…é¡»å¼€å‘è‡ªå·±çš„è§£å†³æ–¹æ¡ˆã€‚ Design alternatives: ä¸€è‡´æ€§å“ˆå¸Œï¼Œ ä½†ä¸€è‡´æ€§å“ˆå¸Œå¯¹äºé«˜çº§åˆ†ç‰‡ç”¨ä¾‹æ˜¯ä¸å¤Ÿçš„ï¼Œå› ä¸ºå…¶ç¡®å®šæ€§çš„é”®åˆ†é…ä¸æ”¯æŒå“åº”åˆ†ç‰‡è´Ÿè½½å˜åŒ–çš„åŠ¨æ€åˆ†ç‰‡è¿ç§»ã€‚SR æä¾›äº†å¯¹ä¸€è‡´æ€§å“ˆå¸Œå’Œåˆ†ç‰‡æ˜ å°„æ–¹æ³•çš„å†…ç½®æ”¯æŒã€‚å¦‚æˆ‘ä»¬ä¹‹å‰çš„å·¥ä½œæ‰€ç¤ºï¼Œåœ¨ Meta çš„æ•°ç™¾ä¸ªåˆ†ç‰‡æœåŠ¡ä¸­ï¼Œé€‰æ‹©ä½¿ç”¨çµæ´»åˆ†ç‰‡æ˜ å°„çš„æœåŠ¡æ•°é‡æ˜¯é€‰æ‹©ä½¿ç”¨ä¸€è‡´æ€§å“ˆå¸Œçš„æœåŠ¡æ•°é‡çš„ 5.4 å€ï¼Œè¿™è¯å®äº†åˆ†ç‰‡æ˜ å°„æ–¹æ³•çš„é‡è¦æ€§å’Œæœ‰æ•ˆæ€§ã€‚ SR çš„åˆ†ç‰‡æ˜ å°„æ–¹æ³•çš„å¦ä¸€ä¸ªæ›¿ä»£æ–¹æ¡ˆæ˜¯å…è®¸æœåŠ¡æä¾›è‡ªå·±çš„è‡ªå®šä¹‰æ—è·¯æœåŠ¡å®ç°ã€‚ ","date":"2024-12-02","objectID":"/posts/paper-servicerouter/:5:3","tags":["Paper Reading"],"title":"Paper Reading: ServiceRouter: Hyperscale and Minimal Cost Service Mesh at Meta","uri":"/posts/paper-servicerouter/"},{"categories":null,"content":"Load Balancing Pick-2 ç®—æ³• Michael Mitzenmacher. The power of two choices in randomized load balancing. IEEE Transactions on Parallel and Distributed Systems, 12(10):1094â€“1104, 2001. å¼€å‘äº†ä¸‰ç§æ–°æŠ€æœ¯æ¥è¡¥å…… Pick-2ï¼š1) åœ¨æŠ½å–ä¸¤ä¸ªéšæœºæœåŠ¡å™¨æ—¶è€ƒè™‘åŒºåŸŸå±€éƒ¨æ€§ï¼ˆÂ§3.4.1ï¼‰ã€‚2) ä»æœåŠ¡å™¨çš„ç¨³å®šå­é›†ä¸­æŠ½å–ä¸¤ä¸ªéšæœºæœåŠ¡å™¨ï¼Œè€Œä¸æ˜¯æ‰€æœ‰æœåŠ¡å™¨ï¼Œä»¥æœ€å¤§åŒ–è¿æ¥é‡ç”¨ï¼ˆÂ§3.4.2ï¼‰ã€‚3) æ ¹æ®å·¥ä½œè´Ÿè½½ç‰¹å¾é‡‡ç”¨è‡ªé€‚åº”è´Ÿè½½ä¼°è®¡æ–¹æ³•ï¼ˆÂ§3.4.3ï¼‰ã€‚ä»¥ä¸‹éƒ¨åˆ†æä¾›äº†è¿™äº›æŠ€æœ¯çš„æ›´å¤šç»†èŠ‚ã€‚ Locality Awareness SR ä¸æ˜¯ä»å€™é€‰æ± ä¸­éšæœºæŠ½å–ä¸¤ä¸ªæœåŠ¡å™¨ï¼Œè€Œæ˜¯ä½¿ç”¨æ‰€è°“çš„å±€éƒ¨æ€§ç¯æ¥è¿‡æ»¤æ‰è¿œç¦»å®¢æˆ·ç«¯çš„é•¿å»¶è¿ŸæœåŠ¡å™¨ï¼Œç„¶åä»å‰©ä½™çš„é™„è¿‘æœåŠ¡å™¨ä¸­æŠ½å–ã€‚æ¯ä¸ªæœåŠ¡å¯ä»¥å®šä¹‰ä¸€ç»„å…·æœ‰é€’å¢å»¶è¿Ÿçš„ç¯ï¼Œä¾‹å¦‚ [ring1: 5 æ¯«ç§’ | ring2: 35 æ¯«ç§’ | ring3: 80 æ¯«ç§’ | ring4: æ— é™åˆ¶]ã€‚å»¶è¿Ÿç›‘æ§æœåŠ¡ï¼ˆLMSï¼‰å®šæœŸæ›´æ–°åŒºåŸŸä¹‹é—´çš„ RTTï¼ŒRPC å®¢æˆ·ç«¯é€šè¿‡ CMS è·å–è¿™äº›ä¿¡æ¯ã€‚ é€šè¿‡å±€éƒ¨æ€§ç¯è¿‡æ»¤å¯ä»¥å‡å°‘è·¯ç”±å»¶è¿Ÿï¼Œä½†ç”±äºç¼ºä¹å…¨å±€è§†å›¾ï¼Œä»ç„¶å­˜åœ¨å±€é™æ€§ã€‚ Design alternative: xRS, ç„¶è€Œï¼ŒSR æ²¡æœ‰é‡‡ç”¨è¿™ç§æ–¹æ³•ï¼Œå› ä¸ºæ ¹æ®æ’é˜Ÿç†è®ºå’Œæˆ‘ä»¬çš„ç”Ÿäº§ç»éªŒï¼Œåœ¨é«˜åˆ©ç”¨ç‡ä¸‹å»ºæ¨¡å»¶è¿Ÿå¹¶ä¸ç¨³å¥ã€‚ æ€»çš„æ¥è¯´ï¼Œåœ¨ç½‘ç»œ RTT å¯èƒ½ä» 100 æ¯«ç§’åˆ° 100 æ¯«ç§’å˜åŒ–ä¸‰ä¸ªæ•°é‡çº§çš„åœ°ç†åˆ†å¸ƒç¯å¢ƒä¸­ï¼Œä»¥å»¶è¿Ÿä¸ºä¸­å¿ƒçš„æ–¹æ³•å¹¶ä¸ç¨³å¥ã€‚ ","date":"2024-12-02","objectID":"/posts/paper-servicerouter/:5:4","tags":["Paper Reading"],"title":"Paper Reading: ServiceRouter: Hyperscale and Minimal Cost Service Mesh at Meta","uri":"/posts/paper-servicerouter/"},{"categories":null,"content":"RPC Connection Reuse å»ºç«‹ä¸€ä¸ªæ–°çš„ TLS/TCP è¿æ¥éœ€è¦ 1.6 æ¯«ç§’ï¼Œå¹¶ä¸”åœ¨æ¯ä¾§æ¶ˆè€— 14KB çš„å†…å­˜ã€‚ä¸ºäº†å‡å°‘è¿™ç§å¼€é”€ï¼ŒSR ä¿æŒ TLS/TCP è¿æ¥å¹¶åœ¨ä¸åŒçš„ RPC è¯·æ±‚ä¹‹é—´é‡ç”¨å®ƒä»¬ã€‚ç„¶è€Œï¼ŒPick-2 ä½¿ç”¨çš„éšæœºåŒ–ä½¿å¾—è¿æ¥é‡ç”¨æ— æ•ˆã€‚ ä¸ºäº†æé«˜è¿æ¥é‡ç”¨ï¼Œ åœ¨ SR ä¸­ï¼Œæ¯ä¸ª RPC å®¢æˆ·ç«¯ä½¿ç”¨ Rendezvous Hashing æ¥é€‰æ‹© Ä ä¸ªç¨³å®šæœåŠ¡å™¨ï¼Œè¿™å®ç°äº†ä¸Šè¿°ç†æƒ³çš„ç‰¹æ€§ Design alternative æˆ‘ä»¬æ›´å–œæ¬¢ Rendezvous Hashing è€Œä¸æ˜¯ä¸€è‡´æ€§å“ˆå¸Œï¼Œå› ä¸ºå®ƒå…è®¸ SR ä½¿ç”¨åŠ æƒå“ˆå¸ŒæŒ‰æœåŠ¡å™¨çš„è®¡ç®—èƒ½åŠ›æˆæ¯”ä¾‹åœ°åˆ†é…å®¢æˆ·ç«¯è¿æ¥ã€‚ æ›´åŠ è´Ÿè½½å‡è¡¡ï¼ŒRendezvous Hashing æ¯”èµ·ä¸€è‡´æ€§å“ˆå¸Œ ","date":"2024-12-02","objectID":"/posts/paper-servicerouter/:5:5","tags":["Paper Reading"],"title":"Paper Reading: ServiceRouter: Hyperscale and Minimal Cost Service Mesh at Meta","uri":"/posts/paper-servicerouter/"},{"categories":null,"content":"Adaptive Load Estimation ä¸ºäº†ä½¿ Pick-2 åœ¨ä¸¤ä¸ªå€™é€‰æœåŠ¡å™¨ä¹‹é—´é€‰æ‹©è·¯ç”±ç›®æ ‡ï¼Œå®ƒéœ€è¦çŸ¥é“è´Ÿè½½ä¿¡æ¯ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒSR ä½¿ç”¨ RPC æœåŠ¡å™¨ä¸Šçš„æœªå®Œæˆè¯·æ±‚æ•°é‡æ¥è¡¨ç¤ºå…¶è´Ÿè½½ ä¸ºäº†ç¡®å®šæœåŠ¡å™¨çš„è´Ÿè½½ï¼Œå®¢æˆ·ç«¯æœ‰ä¸¤ä¸ªé€‰é¡¹ï¼š åœ¨å†³å®šæ˜¯å¦å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ä¹‹å‰ï¼Œè½®è¯¢æœåŠ¡å™¨ä»¥è·å–å…¶è´Ÿè½½ï¼Œè¿™ä¼šå¸¦æ¥é¢å¤–çš„å¼€é”€å’Œå»¶è¿Ÿã€‚ è®©æœåŠ¡å™¨åœ¨å…¶å“åº”ä¸­åŒ…å«å…¶è´Ÿè½½ä¿¡æ¯ï¼Œç„¶ååœ¨å®¢æˆ·ç«¯ç¼“å­˜ä»¥ä¾›åç»­é‡ç”¨ï¼Œè¿™å¾ˆé«˜æ•ˆï¼Œä½†å¯èƒ½å¯¼è‡´å®¢æˆ·ç«¯ä½¿ç”¨è¿‡æ—¶çš„è´Ÿè½½ä¿¡æ¯å¹¶å¯¼è‡´è´Ÿè½½ä¸å¹³è¡¡ã€‚ Design alternative. LI [13] è¯•å›¾é€šè¿‡ä»…ä½¿ç”¨æ–¹æ³• 1 å’Œæ–¹æ³• 3 æ¥è§£å†³è´Ÿè½½ä¼°è®¡é—®é¢˜ï¼Œè€Œä¸ä½¿ç”¨æ–¹æ³• 2ï¼ˆè½®è¯¢ï¼‰ã€‚æˆ‘ä»¬ç”Ÿäº§ç³»ç»Ÿä¸­çš„æ•°æ®æ˜¾ç¤ºï¼Œä½¿ç”¨ SR çš„è‡ªé€‚åº”æœºåˆ¶ï¼Œå¤§çº¦ 50%ã€25% å’Œ 25% çš„ RPC è¯·æ±‚åˆ†åˆ«ä½¿ç”¨æ–¹æ³• 1ã€æ–¹æ³• 2 å’Œæ–¹æ³• 3ã€‚è¿™è¯å®äº†å¼•å…¥ just-in-time polling æ–¹æ³•çš„æœ‰ç”¨æ€§ã€‚ ","date":"2024-12-02","objectID":"/posts/paper-servicerouter/:5:6","tags":["Paper Reading"],"title":"Paper Reading: ServiceRouter: Hyperscale and Minimal Cost Service Mesh at Meta","uri":"/posts/paper-servicerouter/"},{"categories":null,"content":"Evaluation Does SR scale well? (Â§ 4.1) To what extent does SRLib save hardware costs, and when should one use SRProxy versus SRLib? (Â§ 4.2) Can SR balance load within and across regions? (Â§ 4.3) Are sharded services important, and can SR effectively support both sharded and unsharded services? (Â§ 4.4) ","date":"2024-12-02","objectID":"/posts/paper-servicerouter/:6:0","tags":["Paper Reading"],"title":"Paper Reading: ServiceRouter: Hyperscale and Minimal Cost Service Mesh at Meta","uri":"/posts/paper-servicerouter/"},{"categories":null,"content":"Scalability è¶…å¤§è§„æ¨¡æ˜¯åŒºåˆ† SR ä¸å¤§å¤šæ•°ç°æœ‰æœåŠ¡ç½‘æ ¼çš„å…³é”®è®¾è®¡ç›®æ ‡ã€‚ è¿‡å»ï¼Œæˆ‘ä»¬ä½¿ç”¨ ZooKeeper ä½œä¸º RIB çš„æ•°æ®å­˜å‚¨ï¼Œå®ƒæ— æ³•æ‰©å±•åˆ°å‡  GB ä»¥ä¸Šï¼Œå› æ­¤æˆ‘ä»¬åˆ†ç‰‡äº† RIBã€‚ç°åœ¨æˆ‘ä»¬ä½¿ç”¨å†…éƒ¨æ•°æ®å­˜å‚¨ï¼Œå®ƒæ‰©å±•æ€§è‰¯å¥½ï¼Œæ²¡æœ‰è¿›ä¸€æ­¥åˆ†ç‰‡ RIB çš„ç´§è¿«æ€§ã€‚æ€»ä½“è€Œè¨€ï¼Œç›®å‰ RIB ä¸æ˜¯ç“¶é¢ˆï¼Œå¦‚æœéœ€è¦ï¼Œå¯ä»¥è¿›ä¸€æ­¥åˆ†ç‰‡ä»¥æ‰©å±•ã€‚ ","date":"2024-12-02","objectID":"/posts/paper-servicerouter/:6:1","tags":["Paper Reading"],"title":"Paper Reading: ServiceRouter: Hyperscale and Minimal Cost Service Mesh at Meta","uri":"/posts/paper-servicerouter/"},{"categories":null,"content":"Hardware Cost SRLib å’Œ SRProxy çš„ CPU å¼€é”€ ","date":"2024-12-02","objectID":"/posts/paper-servicerouter/:6:2","tags":["Paper Reading"],"title":"Paper Reading: ServiceRouter: Hyperscale and Minimal Cost Service Mesh at Meta","uri":"/posts/paper-servicerouter/"},{"categories":null,"content":"SRLib versus SRProxy ä¸ºäº†é‡åŒ–ç¡¬ä»¶æˆæœ¬ï¼Œæˆ‘ä»¬è¿›è¡Œäº†ä¸€é¡¹å®éªŒï¼Œæ¯”è¾ƒäº†ä¸‰ç§ RPC è®¾ç½®ï¼š1) SRLibï¼Œå®¢æˆ·ç«¯ä½¿ç”¨ SRLib å°†è¯·æ±‚è·¯ç”±åˆ°ä¸€ä¸ªåœ¨ 10 å°æœºå™¨ä¸Šè¿è¡Œçš„ç®€å•æœåŠ¡ï¼›2) SRProxyï¼Œå®¢æˆ·ç«¯å°†è¯·æ±‚å‘é€åˆ°è¿œç¨‹ SRProxyï¼Œåè€…å°†è¯·æ±‚è½¬å‘åˆ°æœåŠ¡å™¨ï¼›3) Thriftï¼Œè£¸å®¢æˆ·ç«¯ç¡¬ç¼–ç ä¸€ä¸ªæœ€æœ‰æ•ˆçš„æ–¹å¼éšæœºé€‰æ‹© 10 å°æœåŠ¡å™¨ä¹‹ä¸€ï¼Œå¹¶ä½¿ç”¨ Thrift RPC åè®®è°ƒç”¨å®ƒã€‚SRLib å’Œ SRProxy çš„å†…éƒ¨å®ç°ä¹Ÿä½¿ç”¨ Thriftï¼Œä½†åœ¨å…¶ä¸Šæ·»åŠ äº†é¢å¤–çš„é€»è¾‘ã€‚å› æ­¤ï¼ŒThrift ä»£è¡¨äº†ä¸‹é™åŸºçº¿ã€‚ Case Study of When to Use SRProxy E-Comm. Key-value store ","date":"2024-12-02","objectID":"/posts/paper-servicerouter/:6:3","tags":["Paper Reading"],"title":"Paper Reading: ServiceRouter: Hyperscale and Minimal Cost Service Mesh at Meta","uri":"/posts/paper-servicerouter/"},{"categories":null,"content":"Load Balancing SR åœ¨åŒºåŸŸå†…å’Œè·¨åŒºåŸŸæ‰§è¡Œè´Ÿè½½å‡è¡¡ã€‚ ","date":"2024-12-02","objectID":"/posts/paper-servicerouter/:6:4","tags":["Paper Reading"],"title":"Paper Reading: ServiceRouter: Hyperscale and Minimal Cost Service Mesh at Meta","uri":"/posts/paper-servicerouter/"},{"categories":null,"content":"Sharded Services ç›®å‰ï¼Œæˆ‘ä»¬çš„èˆ°é˜Ÿè¿è¡Œæ•°ç™¾ä¸ªåˆ†ç‰‡æœåŠ¡ã€‚å°½ç®¡å®ƒä»¬ä»…å æˆ‘ä»¬æ•°ä¸‡ä¸ªæœåŠ¡çš„çº¦ 3%ï¼Œä½†å®ƒä»¬äº§ç”Ÿçš„æµé‡æ¯”å…¶ä»– 97% çš„æœªåˆ†ç‰‡æœåŠ¡æ›´å¤šï¼Œå› ä¸ºè®¸å¤šåˆ†ç‰‡æœåŠ¡æ˜¯æˆ‘ä»¬æœ€å¤§å’Œæœ€é«˜æµé‡çš„æœåŠ¡ä¹‹ä¸€ã€‚ æˆ‘ä»¬çš„ memcache æ˜¯åˆ†ç‰‡çš„ï¼Œ ","date":"2024-12-02","objectID":"/posts/paper-servicerouter/:6:5","tags":["Paper Reading"],"title":"Paper Reading: ServiceRouter: Hyperscale and Minimal Cost Service Mesh at Meta","uri":"/posts/paper-servicerouter/"},{"categories":null,"content":"Limitations of SRLib and Our Solutions Dynamic policy updates: Source code modification: SRLib çš„ä¸€ä¸ªç¼ºç‚¹æ˜¯å®ƒéœ€è¦å¯¹æœåŠ¡è¿›è¡Œä»£ç æ›´æ”¹ã€‚ä¼ ç»Ÿçš„ RPC ä½¿ç”¨ IP åœ°å€å’Œç«¯å£å·æ¥è·å– RPC å®¢æˆ·ç«¯ï¼Œè€Œ SRLib ä½¿ç”¨æœåŠ¡åç§°è·å– RPC å®¢æˆ·ç«¯ Library code deployment éƒ¨ç½²æ–°ç‰ˆæœ¬çš„ SRLib æ¯”éƒ¨ç½²æ–°ç‰ˆæœ¬çš„è¾¹è½¦ä»£ç†æ›´å›°éš¾ã€‚è¿™æ˜¯å› ä¸º SRLib è¢«ç¼–è¯‘åˆ°æ•°ä¸‡ä¸ªæœåŠ¡ä¸­ï¼Œæ¯ä¸ªæœåŠ¡éƒ½æœ‰è‡ªå·±çš„éƒ¨ç½²è®¡åˆ’ã€‚ Bugs in SRLib: å¦‚æœ SRLib çš„æ–°ä»£ç æœ‰é”™è¯¯ï¼Œå¯èƒ½å¾ˆéš¾ç«‹å³å›æ»šæ‰€æœ‰æœåŠ¡ ","date":"2024-12-02","objectID":"/posts/paper-servicerouter/:7:0","tags":["Paper Reading"],"title":"Paper Reading: ServiceRouter: Hyperscale and Minimal Cost Service Mesh at Meta","uri":"/posts/paper-servicerouter/"},{"categories":null,"content":"From Laptop to Lambda: Outsourcing Everyday Jobs to Thousands of Transient Functional Containers åŒæ ·æ˜¯ standford DBOS ç»„å…³äº serverless çš„è®ºæ–‡ï¼Œä½œè€…è¿˜æœ‰ä¸€ç¯‡ R2E2 å¾ˆå‰å®³ï¼Œç”¨ serverless åš ray tracing å®ç°å¾ˆé«˜çš„åŠ é€Ÿï¼Œä½† cost ä¼°è®¡æ§åˆ¶ä¸ä½ ","date":"2024-11-20","objectID":"/posts/paper-gg/:1:0","tags":["Paper Reading"],"title":"Paper Reading: From Laptop to Lambda: Outsourcing Everyday Jobs to Thousands of Transient Functional Containers","uri":"/posts/paper-gg/"},{"categories":null,"content":"Abstract gg framework users might push a button that spawns 10,000 parallel cloud functions to execute a large job in a few seconds from start. é€šè¿‡ ggï¼Œåº”ç”¨ç¨‹åºå°†ä»»åŠ¡è¡¨ç¤ºä¸ºè½»é‡çº§æ“ä½œç³»ç»Ÿå®¹å™¨çš„ç»„åˆï¼Œè¿™äº›å®¹å™¨æ˜¯å•ç‹¬ç¬æ€çš„ï¼ˆç”Ÿå‘½å‘¨æœŸä¸º 1-60 ç§’ï¼‰å’ŒåŠŸèƒ½æ€§çš„ï¼ˆæ¯ä¸ªå®¹å™¨éƒ½æ˜¯å¯†å°ä¸”ç¡®å®šæ€§çš„ï¼‰ã€‚gg è´Ÿè´£åœ¨äº‘å‡½æ•°ä¸Šå®ä¾‹åŒ–è¿™äº›å®¹å™¨ï¼ŒåŠ è½½ä¾èµ–é¡¹ï¼Œæœ€å°åŒ–æ•°æ®ç§»åŠ¨ï¼Œåœ¨å®¹å™¨ä¹‹é—´ç§»åŠ¨æ•°æ®ï¼Œå¹¶å¤„ç†æ•…éšœå’Œæ»åè€…ã€‚ æˆ‘ä»¬ç§»æ¤äº†å‡ ä¸ªå¯¹å»¶è¿Ÿæ•æ„Ÿçš„åº”ç”¨ç¨‹åºä»¥åœ¨ gg ä¸Šè¿è¡Œï¼Œå¹¶è¯„ä¼°äº†å…¶æ€§èƒ½ã€‚åœ¨æœ€ä½³æƒ…å†µä¸‹ï¼ŒåŸºäº gg æ„å»ºçš„åˆ†å¸ƒå¼ç¼–è¯‘å™¨æ¯”ä¼ ç»Ÿå·¥å…·ï¼ˆiceccï¼‰å¿« 2-5 å€ï¼Œè€Œæ— éœ€æŒç»­è¿è¡Œçš„ warm é›†ç¾¤ã€‚åœ¨æœ€å·®æƒ…å†µä¸‹ï¼Œgg çš„æ€§èƒ½ä¸ç°æœ‰è§†é¢‘ç¼–ç å·¥å…·ï¼ˆExCameraï¼‰çš„æ‰‹åŠ¨è°ƒä¼˜æ€§èƒ½ç›¸å·® 20% ä»¥å†…ã€‚ ","date":"2024-11-20","objectID":"/posts/paper-gg/:2:0","tags":["Paper Reading"],"title":"Paper Reading: From Laptop to Lambda: Outsourcing Everyday Jobs to Thousands of Transient Functional Containers","uri":"/posts/paper-gg/"},{"categories":null,"content":"Introduction äº‘å‡½æ•°ï¼Œä¹Ÿç§°ä¸ºæ— æœåŠ¡å™¨è®¡ç®—ã€‚Amazon çš„ Lambda æœåŠ¡å°†ä»¥æ¯ 100 æ¯«ç§’çš„æœ€å°é—´éš”å‡ºç§Ÿä¸€ä¸ª Linux å®¹å™¨æ¥è¿è¡Œä»»æ„çš„ x86-64 å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¯åŠ¨æ—¶é—´ä¸åˆ°ä¸€ç§’ï¼Œç©ºé—²æ—¶ä¸æ”¶è´¹ã€‚ äº‘å‡½æ•°åŸæœ¬æ˜¯ä¸ºå¼‚æ­¥è°ƒç”¨çš„å¾®æœåŠ¡è®¾è®¡çš„ï¼Œä½†å…¶ç²’åº¦å’Œè§„æ¨¡ä½¿å¾—ç ”ç©¶äººå‘˜æ¢ç´¢äº†ä¸€ç§ä¸åŒçš„ç”¨é€”ï¼šä½œä¸ºæŒ‰éœ€çš„çªå‘è¶…çº§è®¡ç®—æœºã€‚ æœ€è¿‘çš„å·¥ä½œéªŒè¯äº†è¿™ä¸€æ„¿æ™¯ã€‚ExCamera [15] å’Œ Sprocket [3] å¯åŠ¨äº†æ•°åƒä¸ªäº‘å‡½æ•°ï¼Œé€šè¿‡ TCP è¿›è¡Œçº¿ç¨‹é—´é€šä¿¡ï¼Œä»¥å¿«é€Ÿç¼–ç ã€æœç´¢å’Œè½¬æ¢è§†é¢‘æ–‡ä»¶ã€‚PyWren [23] æä¾›äº†ä¸€ä¸ª Python APIï¼Œå¹¶ä½¿ç”¨ AWS Lambda å‡½æ•°è¿›è¡Œçº¿æ€§ä»£æ•°å’Œæœºå™¨å­¦ä¹ ã€‚Serverless MapReduce [35] å’Œ Spark-on-Lambda [36] å±•ç¤ºäº†ç±»ä¼¼çš„æ–¹æ³•ã€‚ ä¸å¹¸çš„æ˜¯ï¼Œåœ¨äº‘å‡½æ•°çš„é›†ç¾¤ä¸Šæ„å»ºåº”ç”¨ç¨‹åºæ˜¯å›°éš¾çš„ã€‚æ¯ä¸ªåº”ç”¨ç¨‹åºéƒ½å¿…é¡»å…‹æœè¿™ä¸ªç¯å¢ƒä¸­å›ºæœ‰çš„ä¸€ç³»åˆ—æŒ‘æˆ˜ï¼š ï¼ˆ1ï¼‰å·¥ä½œè€…æ˜¯æ— çŠ¶æ€çš„ï¼Œå¯èƒ½éœ€è¦åœ¨å¯åŠ¨æ—¶ä¸‹è½½å¤§é‡ä»£ç å’Œæ•°æ®ï¼Œ ï¼ˆ2ï¼‰å·¥ä½œè€…åœ¨è¿è¡Œæ—¶æœ‰é™ï¼Œä¹‹åä¼šè¢«ç»ˆæ­¢ï¼Œ ï¼ˆ3ï¼‰å·¥ä½œè€…ä¸Šçš„å­˜å‚¨æ˜¯æœ‰é™çš„ï¼Œä½†æ¯”å¤–éƒ¨å­˜å‚¨å¿«å¾—å¤šï¼Œ ï¼ˆ4ï¼‰å¯ç”¨äº‘å·¥ä½œè€…çš„æ•°é‡å–å†³äºæä¾›å•†çš„æ•´ä½“è´Ÿè½½ï¼Œæ— æ³•æå‰ç²¾ç¡®çŸ¥é“ï¼Œ ï¼ˆ5ï¼‰åœ¨å¤§è§„æ¨¡è¿è¡Œæ—¶ä¼šå‘ç”Ÿå·¥ä½œè€…æ•…éšœï¼Œ ï¼ˆ6ï¼‰äº‘å‡½æ•°ä¸æœ¬åœ°æœºå™¨ä¸Šçš„åº“å’Œä¾èµ–é¡¹ä¸åŒï¼Œ ï¼ˆ7ï¼‰äº‘çš„å»¶è¿Ÿä½¿å¾—å¾€è¿”æˆæœ¬é«˜æ˜‚ã€‚è¿‡å»çš„åº”ç”¨ç¨‹åºåªä»¥ç‰¹å®šçš„æ–¹å¼è§£å†³äº†è¿™äº›æŒ‘æˆ˜çš„ä¸€éƒ¨åˆ†ã€‚ gg ä¸å…¶ä»–å¹¶è¡Œæ‰§è¡Œç³»ç»Ÿã€‚åœ¨ç›®æ ‡å’Œæ–¹æ³•ä¸Šï¼Œgg ä¸å®¹å™¨ç¼–æ’ç³»ç»Ÿå¦‚ Kubernetes [5] å’Œ Docker Swarm [10]ã€å¤–åŒ…å·¥å…·å¦‚ Utility Coprocessor [12] å’Œ icecc [20]ã€ä»¥åŠé›†ç¾¤è®¡ç®—å·¥å…·å¦‚ Hadoop [38]ã€Dryad [22]ã€Spark [40] å’Œ CIEL [27] æœ‰ç›¸ä¼¼ä¹‹å¤„ã€‚ ä½† gg ä¹Ÿä¸è¿™äº›ç³»ç»Ÿåœ¨å…³æ³¨ç‚¹ä¸Šæœ‰æ‰€ä¸åŒï¼Œå®ƒä¸“æ³¨äºæ–°çš„è®¡ç®—åŸºåº•ï¼ˆäº‘å‡½æ•°ï¼‰ã€æ‰§è¡Œæ¨¡å¼ï¼ˆä»é›¶å¼€å§‹çš„çªå‘å¹¶è¡Œã€å¯¹å»¶è¿Ÿæ•æ„Ÿçš„ç¨‹åºï¼‰å’Œç›®æ ‡åº”ç”¨é¢†åŸŸï¼ˆæ—¥å¸¸çš„â€œæœ¬åœ°â€ç¨‹åºï¼Œä¾‹å¦‚è½¯ä»¶ç¼–è¯‘ï¼Œä¾èµ–äºä»ç”¨æˆ·è‡ªå·±çš„ç¬”è®°æœ¬ç”µè„‘æ•è·çš„ç¯å¢ƒï¼‰ã€‚ ä¾‹å¦‚ï¼Œäº‘å‡½æ•°çš„â€œæ— çŠ¶æ€â€ç‰¹æ€§ï¼ˆå®ƒä»¬å¯åŠ¨æ—¶æ²¡æœ‰ä»»ä½•å¯é çš„ç¬æ€çŠ¶æ€ï¼‰ä½¿å¾— gg ç‰¹åˆ«å…³æ³¨é«˜æ•ˆçš„å®¹å™¨åŒ–å’Œä¾èµ–ç®¡ç†ï¼šåœ¨å¯åŠ¨æ—¶å°†æ­£ç¡®æ–‡ä»¶çš„æœ€å°é›†åˆåŠ è½½åˆ°æ¯ä¸ªå®¹å™¨ä¸­ã€‚ gg åœ¨å¯åŠ¨é€Ÿåº¦ä¸Šæ¯” Google Kubernetes Engine å¿« 45 å€ï¼Œæ¯” Spark-on-Lambda å¿« 13 å€ï¼ˆå›¾ 7ï¼‰ã€‚ ","date":"2024-11-20","objectID":"/posts/paper-gg/:3:0","tags":["Paper Reading"],"title":"Paper Reading: From Laptop to Lambda: Outsourcing Everyday Jobs to Thousands of Transient Functional Containers","uri":"/posts/paper-gg/"},{"categories":null,"content":"Summary of Results æˆ‘ä»¬å°†å››ä¸ªåº”ç”¨ç¨‹åºç§»æ¤åˆ° gg çš„æ ¼å¼ä¸­ï¼Œä»¥è¡¨è¾¾å®ƒä»¬çš„å·¥ä½œï¼šæ¯ä¸ªå®¹å™¨çš„æè¿°ä»¥åŠå®ƒå¦‚ä½•ä¾èµ–äºå…¶ä»–å®¹å™¨ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º intermediate representation (IR)ï¼ˆÂ§3ï¼‰ã€‚å…¶ä¸­ä¸€ä¸ªåº”ç”¨ç¨‹åºé€šè¿‡ä»ç°æœ‰çš„è½¯ä»¶æ„å»ºç³»ç»Ÿï¼ˆä¾‹å¦‚ make æˆ– ninjaï¼‰æ¨æ–­ IR æ¥è‡ªåŠ¨å®Œæˆæ­¤æ“ä½œã€‚å…¶ä½™çš„åº”ç”¨ç¨‹åºåˆ™æ˜ç¡®åœ°å†™å‡ºæè¿°ï¼šä¸€ä¸ªå•å…ƒæµ‹è¯•æ¡†æ¶ï¼ˆGoogle Test [17]ï¼‰ã€å¸¦æœ‰çº¿ç¨‹é—´é€šä¿¡çš„å¹¶è¡Œè§†é¢‘ç¼–ç ï¼ˆExCamera [15]ï¼‰ï¼Œä»¥åŠä½¿ç”¨ Scanner [30]å’Œ TensorFlow [1]çš„å¯¹è±¡è¯†åˆ«ã€‚ è¿™é‡Œçš„ IR æ˜¯ LLVM ç±»ä¼¼çš„æ¦‚å¿µå— ç„¶åï¼Œæˆ‘ä»¬ä¸ºäº”ä¸ªè®¡ç®—å¼•æ“ï¼ˆæœ¬åœ°æœºå™¨ã€a cluster of warm VMsã€AWS Lambdaã€IBM Cloud Functions å’Œ Google Cloud Functionsï¼‰å’Œä¸‰ä¸ªå­˜å‚¨å¼•æ“ï¼ˆS3ã€Google Cloud Storage å’Œ Redisï¼‰å®ç°äº† gg çš„åç«¯ï¼Œè¿™äº›åç«¯è§£é‡Š IR å¹¶æ‰§è¡Œä»»åŠ¡ å¯¹äºä»å†·å¯åŠ¨ç¼–è¯‘å¤§å‹ç¨‹åºï¼Œgg çš„åŠŸèƒ½æ€§æ–¹æ³•å’Œç»†ç²’åº¦çš„ä¾èµ–ç®¡ç†å¸¦æ¥äº†æ˜¾è‘—çš„æ€§èƒ½æå‡ã€‚ æ€»ä¹‹ï¼Œgg æ˜¯ä¸€ä¸ªå®ç”¨çš„å·¥å…·ï¼Œè§£å†³äº†çªå‘å¹¶è¡Œäº‘å‡½æ•°åº”ç”¨ç¨‹åºé¢ä¸´çš„ä¸»è¦æŒ‘æˆ˜ã€‚å®ƒå¸®åŠ©å¼€å‘è€…å’Œç”¨æˆ·æ„å»ºåº”ç”¨ç¨‹åºï¼Œä»é›¶çªå‘åˆ°æ•°åƒä¸ªå¹¶è¡Œçº¿ç¨‹ï¼Œä»¥å®ç°æ—¥å¸¸ä»»åŠ¡çš„ä½å»¶è¿Ÿã€‚gg æ˜¯å¼€æºè½¯ä»¶ï¼Œæºä»£ç åœ¨ https://snr.stanford.edu/gg ","date":"2024-11-20","objectID":"/posts/paper-gg/:3:1","tags":["Paper Reading"],"title":"Paper Reading: From Laptop to Lambda: Outsourcing Everyday Jobs to Thousands of Transient Functional Containers","uri":"/posts/paper-gg/"},{"categories":null,"content":"Related Work gg æœ‰è®¸å¤šå‰èº«â€”â€”é›†ç¾¤è®¡ç®—ç³»ç»Ÿå¦‚ Hadoop [38]ã€Spark [40]ã€Dryad [22]å’Œ CIEL [27]ï¼›å®¹å™¨ç¼–æ’ç³»ç»Ÿå¦‚ Docker Swarm å’Œ Kubernetesï¼›å¤–åŒ…å·¥å…·å¦‚ distcc [8]ã€icecc [20]å’Œ UCop [12]ï¼›åŸºäºè§„åˆ™çš„å·¥ä½œæµç³»ç»Ÿå¦‚ make [13]ã€CMake [7]å’Œ Bazel [4]ï¼›ä»¥åŠäº‘å‡½æ•°å·¥å…·å¦‚ ExCamera/mu [15]ã€PyWren [23]å’Œ Spark-on-Lambda [36]ã€‚ Process migration and outsourcing: gg ä»å†·å¯åŠ¨å¼€å§‹ç¼–æ’æ•°åƒä¸ªä¸å¯é å’Œæ— çŠ¶æ€çš„äº‘å‡½æ•° Container orchestration: gg çš„ IR ç±»ä¼¼äºå®¹å™¨å’Œç¯å¢ƒæè¿°è¯­è¨€ï¼ŒåŒ…æ‹¬ Docker [10]å’Œ Vagrant [34]ï¼Œä»¥åŠå®¹å™¨ç¼–æ’ç³»ç»Ÿå¦‚ Docker Swarm å’Œ Kubernetesã€‚ä¸è¿™äº›ç³»ç»Ÿç›¸æ¯”ï¼Œgg çš„ thunk è®¾è®¡ä¸ºåœ¨äº‘å‡½æ•°ä¸­é«˜æ•ˆå®ä¾‹åŒ–ï¼Œ thunk åˆ°åº•æ˜¯ä»€ä¹ˆï¼Œå»¶è¿Ÿè®¡ç®—ï¼Ÿ haskeel é‡Œçš„æƒ°æ€§æ±‚å€¼ï¼Ÿ Workflow systems. gg is aimed at a different kind of application gg uses OS abstractions gg is considerably lighter weight. gg supports dynamic data access ä¸ºä»€ä¹ˆè¯´ spark ä¸èƒ½ç”¨äºç¼–è¯‘ï¼Ÿ åŠ¨æ€æ•°æ®è®¿é—®ä¹Ÿä¸å¤ªç†è§£ï¼Œè¿™ç¯‡è®ºæ–‡å‰åŠéƒ¨åˆ†æœ‰ç‚¹è«åå…¶å¦™çš„ï¼Œè®²ä¸€å¤§å † related work gg æ”¯æŒé DAG æ•°æ®æµï¼Ÿï¼Ÿæ€ä¹ˆå®ç°çš„ Burst-parallel cloud functions: gg çš„ä¸»è¦è´¡çŒ®æ˜¯æŒ‡å®šä¸€ä¸ª IRï¼Œå…è®¸å„ç§åº”ç”¨ç¨‹åºï¼ˆç”¨ä»»ä½•ç¼–ç¨‹è¯­è¨€ç¼–å†™ï¼‰ä»è®¡ç®—å’Œå­˜å‚¨å¹³å°ä¸­æŠ½è±¡å‡ºæ¥ï¼Œå¹¶åˆ©ç”¨å¸¸è§çš„æœåŠ¡è¿›è¡Œä¾èµ–ç®¡ç†ã€æ»åè€…ç¼“è§£å’Œè°ƒåº¦ã€‚ Build tools: å‡ ä¸ªæ„å»ºç³»ç»Ÿï¼ˆä¾‹å¦‚ make [13]ã€Bazel [4]ã€Nix [11]å’Œ Vesta [19]ï¼‰å’Œå¤–åŒ…å·¥å…·ï¼ˆå¦‚ distcc [8]ã€icecc [20]å’Œ mrcc [26]ï¼‰å¯»æ±‚å¢é‡åŒ–ã€å¹¶è¡ŒåŒ–æˆ–å°†ç¼–è¯‘åˆ†å¸ƒåˆ°æ›´å¼ºå¤§çš„è¿œç¨‹æœºå™¨ä¸Šã€‚åŸºäºè¿™äº›ç³»ç»Ÿï¼Œgg è‡ªåŠ¨å°†ç°æœ‰çš„æ„å»ºè¿‡ç¨‹è½¬æ¢ä¸ºå…¶è‡ªå·±çš„ IRã€‚ç›®æ ‡æ˜¯å¿«é€Ÿç¼–è¯‘ç¨‹åºâ€”â€”ä¸è€ƒè™‘è½¯ä»¶è‡ªèº«çš„æ„å»ºç³»ç»Ÿâ€”â€”é€šè¿‡åˆ©ç”¨å¯ä»¥ä»å®Œå…¨ä¼‘çœ çŠ¶æ€çªå‘åˆ°æ•°åƒå€å¹¶è¡Œæ€§å¹¶è¿”å›çš„äº‘å‡½æ•°å¹³å°ã€‚ ç°æœ‰çš„è¿œç¨‹ç¼–è¯‘ç³»ç»Ÿ remote compilation systemsï¼ŒåŒ…æ‹¬ distcc å’Œ iceccï¼Œåœ¨æ„å»ºè¿‡ç¨‹ä¸­é¢‘ç¹åœ°åœ¨ä¸»èŠ‚ç‚¹å’Œå·¥ä½œèŠ‚ç‚¹ä¹‹é—´ä¼ è¾“æ•°æ®ã€‚è¿™äº›ç³»ç»Ÿåœ¨å±€åŸŸç½‘ä¸Šè¡¨ç°æœ€ä½³ï¼Œå¹¶ä¸”åœ¨äº‘ä¸­æ›´è¿œç¨‹çš„æœåŠ¡å™¨ä¸Šæ„å»ºæ—¶ä¼šå¢åŠ å¤§é‡å»¶è¿Ÿã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œgg ä¸€æ¬¡æ€§ä¸Šä¼ æ‰€æœ‰æ„å»ºè¾“å…¥ï¼Œå¹¶åœ¨äº‘ä¸­çº¯ç²¹æ‰§è¡Œå’Œäº¤æ¢æ•°æ®ï¼Œå‡å°‘äº†ç½‘ç»œå»¶è¿Ÿçš„å½±å“ã€‚ gg çš„å–ç‚¹å¥½åƒæ³¨é‡åˆ†å¸ƒå¼ç¼–è¯‘ ","date":"2024-11-20","objectID":"/posts/paper-gg/:4:0","tags":["Paper Reading"],"title":"Paper Reading: From Laptop to Lambda: Outsourcing Everyday Jobs to Thousands of Transient Functional Containers","uri":"/posts/paper-gg/"},{"categories":null,"content":"Design and Implementation gg è¢«è®¾è®¡ä¸ºä¸€ä¸ªé€šç”¨ç³»ç»Ÿï¼Œå¸®åŠ©åº”ç”¨ç¨‹åºå¼€å‘è€…ç®¡ç†åˆ›å»ºçªå‘å¹¶è¡Œäº‘å‡½æ•°åº”ç”¨ç¨‹åºçš„æŒ‘æˆ˜ã€‚é¢„æœŸç”¨æˆ·å°†æŠŠé€šå¸¸åœ¨æœ¬åœ°æˆ–å°å‹é›†ç¾¤ä¸Šé•¿æ—¶é—´è¿è¡Œçš„è®¡ç®—ï¼ˆä¾‹å¦‚æµ‹è¯•å¥—ä»¶ã€æœºå™¨å­¦ä¹ ã€æ•°æ®æ¢ç´¢å’Œåˆ†æã€è½¯ä»¶ç¼–è¯‘ã€è§†é¢‘ç¼–ç å’Œå¤„ç†ï¼‰å¤–åŒ…ç»™äº‘ä¸­æ•°åƒä¸ªçŸ­æš‚çš„å¹¶è¡Œçº¿ç¨‹ï¼Œä»¥å®ç°æ¥è¿‘äº¤äº’å¼çš„å®Œæˆæ—¶é—´ã€‚ ","date":"2024-11-20","objectID":"/posts/paper-gg/:5:0","tags":["Paper Reading"],"title":"Paper Reading: From Laptop to Lambda: Outsourcing Everyday Jobs to Thousands of Transient Functional Containers","uri":"/posts/paper-gg/"},{"categories":null,"content":"ggâ€™s Intermediate Representation gg ä½¿ç”¨çš„æ ¼å¼â€”â€”ä¸€ç»„æè¿°å®¹å™¨åŠå…¶å¯¹å…¶ä»–å®¹å™¨ä¾èµ–å…³ç³»çš„æ–‡æ¡£â€”â€”æ—¨åœ¨ä»åº”ç”¨ç¨‹åºä¸­æå–è¶³å¤Ÿçš„ä¿¡æ¯ï¼ˆç»†ç²’åº¦çš„ä¾èµ–å…³ç³»å’Œæ•°æ®æµï¼‰ï¼Œä»¥ä¾¿èƒ½å¤Ÿåœ¨å—é™å’Œæ— çŠ¶æ€çš„äº‘å‡½æ•°ä¸Šé«˜æ•ˆæ‰§è¡Œä»»åŠ¡ã€‚å®ƒåŒ…æ‹¬ï¼š å†…å®¹å¯»å€ cloud thunk çš„åŸè¯­ï¼šåº”ç”¨äºå‘½åè¾“å…¥æ•°æ®çš„ä»£ç ç‰‡æ®µæˆ–å¯æ‰§è¡Œæ–‡ä»¶ã€‚ ä¸­é—´è¡¨ç¤ºï¼ˆIRï¼‰ï¼Œå°†ä»»åŠ¡è¡¨ç¤ºä¸ºç›¸äº’ä¾èµ–çš„ thunk çš„æƒ°æ€§æ±‚å€¼ lambda è¡¨è¾¾å¼ã€‚ ä¸€ç§ç­–ç•¥ï¼Œç”¨äºä»¥è¯­è¨€æ— å…³å’Œå¯è®°å¿†åŒ–çš„æ–¹å¼è¡¨ç¤ºåŠ¨æ€è®¡ç®—å›¾å’Œæ•°æ®è®¿é—®æ¨¡å¼ï¼Œä½¿ç”¨å°¾é€’å½’ã€‚ æˆ‘ä»¬è®¨è®ºè¿™äº›å…ƒç´ ä¸­çš„æ¯ä¸€ä¸ªã€‚ ","date":"2024-11-20","objectID":"/posts/paper-gg/:5:1","tags":["Paper Reading"],"title":"Paper Reading: From Laptop to Lambda: Outsourcing Everyday Jobs to Thousands of Transient Functional Containers","uri":"/posts/paper-gg/"},{"categories":null,"content":"Thunk: A Lightweight Container åœ¨å‡½æ•°å¼ç¼–ç¨‹æ–‡çŒ®ä¸­ï¼Œthunk æ˜¯ä¸€ä¸ªæ— å‚æ•°çš„é—­åŒ…ï¼ˆå‡½æ•°ï¼‰ï¼Œå®ƒæ•è·å…¶å‚æ•°å’Œç¯å¢ƒçš„å¿«ç…§ä»¥ä¾›ä»¥åæ±‚å€¼ã€‚æ±‚å€¼ thunk çš„è¿‡ç¨‹â€”â€”å°†å‡½æ•°åº”ç”¨äºå…¶å‚æ•°å¹¶ä¿å­˜ç»“æœâ€”â€”ç§°ä¸ºå¼ºåˆ¶æ±‚å€¼[2]ã€‚ å¯¹äº ggï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯ç®€åŒ–æ–°åº”ç”¨ç¨‹åºçš„åˆ›å»º,å…è®¸å®ƒä»¬é’ˆå¯¹ IRï¼Œä»è€Œåˆ©ç”¨åç«¯å¼•æ“æä¾›çš„å¸¸è§æœåŠ¡ã€‚å› æ­¤ï¼Œthunk çš„è¡¨ç¤ºéµå¾ªå‡ ä¸ªè®¾è®¡ç›®æ ‡ã€‚å®ƒåº”è¯¥æ˜¯ï¼šï¼ˆ1ï¼‰è¶³å¤Ÿç®€å•ï¼Œä»¥ä¾¿å¯ä»¥ç§»æ¤åˆ°ä¸åŒçš„è®¡ç®—å’Œå­˜å‚¨å¹³å°ï¼Œï¼ˆ2ï¼‰è¶³å¤Ÿé€šç”¨ï¼Œä»¥è¡¨è¾¾å„ç§åˆç†çš„åº”ç”¨ç¨‹åºï¼Œï¼ˆ3ï¼‰ä¸å®ç°å‡½æ•°çš„ç¼–ç¨‹è¯­è¨€æ— å…³ï¼Œï¼ˆ4ï¼‰è¶³å¤Ÿé«˜æ•ˆï¼Œä»¥æ•è·å¯ä»¥åœ¨æ— çŠ¶æ€å’Œç©ºé—´å—é™çš„äº‘å‡½æ•°ä¸Šå…·ä½“åŒ–çš„ç»†ç²’åº¦ä¾èµ–å…³ç³»ï¼Œï¼ˆ5ï¼‰èƒ½å¤Ÿè®°å¿†åŒ–ä»¥é˜²æ­¢é‡å¤å·¥ä½œã€‚ æ€ä¹ˆè®°å¿†åŒ–ï¼Ÿ åœ¨å†…å®¹å¯»å€æ–¹æ¡ˆä¸­ï¼Œå¯¹è±¡çš„åç§°æœ‰å››ä¸ªç»„ä»¶ï¼šï¼ˆ1ï¼‰å¯¹è±¡æ˜¯åŸå§‹å€¼ï¼ˆå“ˆå¸Œä»¥ V å¼€å¤´ï¼‰è¿˜æ˜¯è¡¨ç¤ºå¼ºåˆ¶å…¶ä»– thunk çš„ç»“æœï¼ˆå“ˆå¸Œä»¥ T å¼€å¤´ï¼‰ï¼Œï¼ˆ2ï¼‰SHA-256 å“ˆå¸Œï¼Œï¼ˆ3ï¼‰å­—èŠ‚é•¿åº¦ï¼Œï¼ˆ4ï¼‰å¯é€‰æ ‡ç­¾ï¼Œå‘½åå¯¹è±¡æˆ– thunk çš„è¾“å‡ºã€‚ å¼ºåˆ¶ thunk æ„å‘³ç€å®ä¾‹åŒ–æè¿°çš„å®¹å™¨å¹¶è¿è¡Œä»£ç ã€‚ä¸ºæ­¤ï¼Œæ‰§è¡Œå™¨å¿…é¡»è·å–ä»£ç å’Œæ•°æ®å€¼ã€‚å› ä¸ºè¿™äº›æ˜¯å†…å®¹å¯»å€çš„ï¼Œæ‰€ä»¥å¯ä»¥ä»ä»»ä½•èƒ½å¤Ÿç”Ÿæˆå…·æœ‰æ­£ç¡®åç§°çš„ blob çš„æœºåˆ¶ä¸­è·å–â€”â€”æŒä¹…æˆ–çŸ­æš‚çš„å­˜å‚¨ï¼ˆä¾‹å¦‚ S3ã€Redis æˆ– Bigtableï¼‰ã€ä»å¦ä¸€ä¸ªèŠ‚ç‚¹çš„ç½‘ç»œä¼ è¾“ï¼Œæˆ–è€…é€šè¿‡åœ¨å…ˆå‰æ‰§è¡Œä¸­å·²ç»å¯ç”¨çš„ RAM ä¸­æ‰¾åˆ°å¯¹è±¡ã€‚ç„¶åï¼Œæ‰§è¡Œå™¨ä½¿ç”¨æä¾›çš„å‚æ•°å’Œç¯å¢ƒè¿è¡Œå¯æ‰§è¡Œæ–‡ä»¶â€”â€”å‡ºäºè°ƒè¯•æˆ–å®‰å…¨ç›®çš„ï¼Œæœ€å¥½æ˜¯åœ¨é˜²æ­¢å¯æ‰§è¡Œæ–‡ä»¶è®¿é—®ç½‘ç»œæˆ–æœªåˆ—ä¸ºä¾èµ–é¡¹çš„ä»»ä½•æ•°æ®çš„æ¨¡å¼ä¸‹è¿è¡Œã€‚æ‰§è¡Œå™¨æ”¶é›†è¾“å‡º blobï¼Œè®¡ç®—å…¶å“ˆå¸Œå€¼ï¼Œå¹¶è®°å½•è¾“å‡ºå¯ä»¥æ›¿æ¢å¯¹åˆšåˆšå¼ºåˆ¶çš„ thunk çš„ä»»ä½•å¼•ç”¨ã€‚ ","date":"2024-11-20","objectID":"/posts/paper-gg/:5:2","tags":["Paper Reading"],"title":"Paper Reading: From Laptop to Lambda: Outsourcing Everyday Jobs to Thousands of Transient Functional Containers","uri":"/posts/paper-gg/"},{"categories":null,"content":"gg IR: A Lazily Evaluated Lambda Expression Figure 3 ä½¿ç”¨å“ˆå¸Œæ¥è¿½è¸ª thunk ä¾èµ–ï¼Ÿ ç›¸äº’ä¾èµ–çš„ thunk çš„ç»“æ„å®šä¹‰äº† gg çš„ IRï¼Œæˆ‘ä»¬ä½¿ç”¨å•å‘ IRï¼Œä¸€ç§åº”ç”¨ç¨‹åºç”¨æ¥è¡¨è¾¾å…¶ä»»åŠ¡çš„æ–‡æ¡£æ ¼å¼ï¼Œè€Œä¸æ˜¯åŒå‘ APIï¼ˆä¾‹å¦‚ï¼Œè°ƒç”¨å‡½æ•°æ¥ç”Ÿæˆæ–°ä»»åŠ¡å¹¶è§‚å¯Ÿå…¶ç»“æœï¼‰ï¼Œå› ä¸ºæˆ‘ä»¬æœŸæœ›åº”ç”¨ç¨‹åºå°†åœ¨ç”¨æˆ·çš„è®¡ç®—æœºä¸Šè¿è¡Œï¼Œè€Œåœ¨æŸä¸ªè¿œç¨‹äº‘å‡½æ•°å¼•æ“ä¸Šæ‰§è¡Œï¼šç›®çš„æ˜¯é€šè¿‡å°†åº”ç”¨ç¨‹åºæ’é™¤åœ¨å¤–æ¥é¿å…é€šè¿‡é«˜å»¶è¿Ÿè·¯å¾„çš„å¾€è¿”ã€‚æˆ‘ä»¬è¿˜è®¾æƒ³ï¼Œå¦‚æœåº”ç”¨ç¨‹åºåœ¨æ‰§è¡Œå¼€å§‹ä¹‹å‰è¢«æ’é™¤åœ¨å¤–ï¼Œå°†æ›´å®¹æ˜“æ›´å¥½åœ°è°ƒåº¦å’Œä¼˜åŒ–ä»»åŠ¡ï¼Œå¹¶æ›´å®¹æ˜“ç»´æŠ¤ä¸åŒçš„å¯äº’æ“ä½œçš„åç«¯ã€‚2 è¿™ç§è¡¨ç¤ºå½¢å¼å‘åå°æš´éœ²äº†è®¡ç®—å›¾ï¼Œä»¥åŠéœ€è¦åœ¨ thunk ä¹‹é—´é€šä¿¡çš„å¯¹è±¡çš„èº«ä»½å’Œå¤§å°ã€‚åŸºäºè¿™äº›ä¿¡æ¯ï¼Œåå°å¯ä»¥è°ƒåº¦ thunk çš„å¼ºåˆ¶æ‰§è¡Œï¼Œå°†å…·æœ‰ç›¸ä¼¼æ•°æ®ä¾èµ–æ€§æˆ–è¾“å‡º-è¾“å…¥å…³ç³»çš„ thunk æ”¾ç½®åœ¨ç›¸åŒçš„ç‰©ç†åŸºç¡€è®¾æ–½ä¸Šï¼Œå¹¶ç®¡ç†ä¸­é—´ç»“æœçš„å­˜å‚¨æˆ–ä¼ è¾“ï¼Œè€Œæ— éœ€å¾€è¿”ç”¨æˆ·çš„è®¡ç®—æœºã€‚ IR å…è®¸ gg é«˜æ•ˆåœ°è°ƒåº¦ä»»åŠ¡ï¼Œé€šè¿‡åœ¨å…³é”®è·¯å¾„ä¸Šè°ƒç”¨å¤šä¸ªå¹¶å‘ thunk æ¥ç¼“è§£æ»åè€…çš„å½±å“ï¼Œé€šè¿‡ç¬¬äºŒæ¬¡å¼ºåˆ¶ thunk æ¥æ¢å¤æ•…éšœï¼Œå¹¶è®°å¿†åŒ– thunkã€‚è¿™æ˜¯ä»¥åº”ç”¨ç¨‹åºæ— å…³ã€è¯­è¨€æ— å…³çš„æ–¹å¼å®ç°çš„ã€‚ åº”ç”¨ç¨‹åºé€šå¸¸ä»å¼ºåˆ¶è¡¨ç¤ºäº¤äº’æ“ä½œæœ€ç»ˆç»“æœçš„å•ä¸ª thunk å¼€å§‹ã€‚è¿™ä¸ª thunk é€šå¸¸ä¾èµ–äºå…¶ä»–éœ€è¦é¦–å…ˆå¼ºåˆ¶çš„ thunkï¼Œç­‰ç­‰ï¼Œå¯¼è‡´åå°é€’å½’åœ°æƒ°æ€§å¼ºåˆ¶ thunkï¼Œç›´åˆ°è·å¾—æœ€ç»ˆç»“æœã€‚å›¾ 3 æ˜¾ç¤ºäº†ä¸€ä¸ªè®¡ç®—è¡¨è¾¾å¼ ASSEMBLE(COMPILE(PREPROCESS(hello.c)))çš„ç¤ºä¾‹ IRã€‚ ","date":"2024-11-20","objectID":"/posts/paper-gg/:5:3","tags":["Paper Reading"],"title":"Paper Reading: From Laptop to Lambda: Outsourcing Everyday Jobs to Thousands of Transient Functional Containers","uri":"/posts/paper-gg/"},{"categories":null,"content":"Tail Recursion: Supporting Dynamic Execution ä¸Šè¿°è®¾è®¡è¶³ä»¥æè¿°åœ¨äº‘ä¸­æ‰§è¡Œçš„ç¡®å®šæ€§ä»»åŠ¡çš„æœ‰å‘æ— ç¯å›¾ï¼ˆDAGï¼‰ã€‚ç„¶è€Œï¼Œè®¸å¤šä»»åŠ¡çš„æ•°æ®è®¿é—®æ¨¡å¼å¹¶ä¸æ˜¯å®Œå…¨é¢„å…ˆå·²çŸ¥çš„ã€‚ä¾‹å¦‚ï¼Œåœ¨ç¼–è¯‘è½¯ä»¶æ—¶ï¼Œæ— æ³•äº‹å…ˆçŸ¥é“æŸä¸ªé˜¶æ®µéœ€è¦è¯»å–å“ªäº›å¤´æ–‡ä»¶å’Œåº“ã€‚å…¶ä»–åº”ç”¨ç¨‹åºä½¿ç”¨å¾ªç¯ã€é€’å½’å’Œå…¶ä»–é DAG æ•°æ®æµã€‚ ç›¸åï¼Œgg é€šè¿‡è¯­è¨€æ— å…³çš„å°¾é€’å½’æ¥å¤„ç†è¿™ç§æƒ…å†µï¼šä¸€ä¸ª thunk å¯ä»¥å°†å…¶è¾“å‡ºå†™ä¸ºå¦ä¸€ä¸ª thunkã€‚ ","date":"2024-11-20","objectID":"/posts/paper-gg/:5:4","tags":["Paper Reading"],"title":"Paper Reading: From Laptop to Lambda: Outsourcing Everyday Jobs to Thousands of Transient Functional Containers","uri":"/posts/paper-gg/"},{"categories":null,"content":"Front-ends æˆ‘ä»¬å¼€å‘äº†å››ä¸ªå‰ç«¯ï¼Œå®ƒä»¬ç”Ÿæˆ gg IRï¼šä¸€ä¸ª C++ SDKã€ä¸€ä¸ª Python SDKã€ä¸€ç»„å‘½ä»¤è¡Œå·¥å…·å’Œä¸€ç³»åˆ—æ¨¡å‹æ›¿æ¢åŸè¯­ï¼Œå¯ä»¥ä»è½¯ä»¶æ„å»ºç³»ç»Ÿæ¨æ–­ gg IRã€‚ ","date":"2024-11-20","objectID":"/posts/paper-gg/:5:5","tags":["Paper Reading"],"title":"Paper Reading: From Laptop to Lambda: Outsourcing Everyday Jobs to Thousands of Transient Functional Containers","uri":"/posts/paper-gg/"},{"categories":null,"content":"Back-ends gg IR è¡¨è¾¾åº”ç”¨ç¨‹åºé’ˆå¯¹ä¸€ä¸ªæŠ½è±¡æœºå™¨ï¼Œè¯¥æœºå™¨éœ€è¦ä¸¤ä¸ªç»„ä»¶ï¼šä¸€ä¸ªç”¨äºå¼ºåˆ¶å•ä¸ª thunk çš„æ‰§è¡Œå¼•æ“ï¼Œä»¥åŠä¸€ä¸ªç”¨äºå­˜å‚¨ thunk å¼•ç”¨æˆ–ç”Ÿæˆçš„å‘½å blob çš„å†…å®¹å¯»å€å­˜å‚¨å¼•æ“ã€‚åè°ƒç¨‹åºå°†è¿™ä¸¤ä¸ªç»„ä»¶ç»“åˆåœ¨ä¸€èµ·ã€‚ Storage engine å­˜å‚¨å¼•æ“æä¾›äº†ä¸€ä¸ªç®€å•çš„æ¥å£ï¼Œç”¨äºå†…å®¹å¯»å€å­˜å‚¨ï¼ŒåŒ…æ‹¬ GET å’Œ PUT å‡½æ•°æ¥æ£€ç´¢å’Œå­˜å‚¨å¯¹è±¡ã€‚ Execution engine ä¸å­˜å‚¨å¼•æ“ç»“åˆï¼Œæ¯ä¸ªæ‰§è¡Œå¼•æ“å®ç°äº†ä¸€ä¸ªç®€å•çš„æŠ½è±¡ï¼šä¸€ä¸ªæ¥æ”¶ thunk ä½œä¸ºè¾“å…¥å¹¶è¿”å›å…¶è¾“å‡ºå¯¹è±¡å“ˆå¸Œï¼ˆå¯ä»¥æ˜¯å€¼æˆ– thunkï¼‰çš„å‡½æ•°ã€‚ The coordinator æ‰§è¡Œ thunk çš„ä¸»è¦å…¥å£ç‚¹æ˜¯åè°ƒç¨‹åºã€‚è¯¥ç¨‹åºçš„è¾“å…¥æ˜¯ç›®æ ‡ thunkã€å¯ç”¨æ‰§è¡Œå¼•æ“åˆ—è¡¨å’Œå­˜å‚¨å¼•æ“ã€‚è¯¥ç¨‹åºå®ç°äº† gg æä¾›çš„æœåŠ¡ï¼Œå¦‚ä½œä¸šè°ƒåº¦ã€è®°å¿†åŒ–ã€æ•…éšœæ¢å¤å’Œæ»åè€…ç¼“ å¯åŠ¨æ—¶ï¼Œè¯¥ç¨‹åºå…·ä½“åŒ–ç›®æ ‡ thunk çš„ä¾èµ–å›¾ï¼Œå…¶ä¸­åŒ…æ‹¬è·å–è¾“å‡ºæ‰€éœ€çš„æ‰€æœ‰å…¶ä»– thunkã€‚ç„¶åï¼Œæ ¹æ®å…¶å¯ç”¨å®¹é‡ï¼Œå°†å‡†å¤‡å¥½æ‰§è¡Œçš„ thunk ä¼ é€’ç»™æ‰§è¡Œå¼•æ“ã€‚å½“ thunk çš„æ‰§è¡Œå®Œæˆåï¼Œç¨‹åºé€šè¿‡æ›¿æ¢å¯¹åˆšåˆšå¼ºåˆ¶çš„ thunk çš„å¼•ç”¨æ¥æ›´æ–°å›¾ï¼Œå¹¶æ·»åŠ ä¸€ä¸ªç¼“å­˜æ¡ç›®ï¼Œå°†è¾“å‡ºå“ˆå¸Œä¸è¾“å…¥å“ˆå¸Œå…³è”ã€‚å‡†å¤‡å¥½æ‰§è¡Œçš„ thunk è¢«æ”¾ç½®åœ¨é˜Ÿåˆ—ä¸­ï¼Œå¹¶åœ¨å…¶å®¹é‡å…è®¸æ—¶ä¼ é€’ç»™æ‰§è¡Œå¼•æ“ã€‚ç»Ÿä¸€çš„æ¥å£å…è®¸ç”¨æˆ·æ··åˆå’ŒåŒ¹é…ä¸åŒçš„æ‰§è¡Œå¼•æ“ï¼Œåªè¦å®ƒä»¬å…±äº«ç›¸åŒçš„å­˜å‚¨å¼•æ“ã€‚ è°ƒç”¨ã€æ‰§è¡Œå’Œæ”¾ç½®çš„ç»†èŠ‚ç•™ç»™æ‰§è¡Œå¼•æ“ã€‚ä¾‹å¦‚ï¼ŒAWS Lambda/S3 çš„é»˜è®¤å¼•æ“ä¸ºæ¯ä¸ª thunk è°ƒç”¨ä¸€ä¸ªæ–°çš„ Lambdaã€‚Lambda ä» S3 ä¸‹è½½æ‰€æœ‰ä¾èµ–é¡¹å¹¶è®¾ç½®ç¯å¢ƒï¼Œæ‰§è¡Œ thunkï¼Œå°†è¾“å‡ºä¸Šä¼ å› S3 å¹¶å…³é—­ã€‚å¯¹äºå…·æœ‰å¤§è¾“å…¥/è¾“å‡ºå¯¹è±¡çš„åº”ç”¨ç¨‹åºï¼Œå¾€è¿” S3 å¯èƒ½ä¼šå½±å“æ€§èƒ½ã€‚ä½œä¸ºæ­¤ç±»æƒ…å†µçš„ä¼˜åŒ–ï¼Œç”¨æˆ·å¯ä»¥é€‰æ‹©ä»¥â€œé•¿æœŸè¿è¡Œâ€æ¨¡å¼è¿è¡Œæ‰§è¡Œå¼•æ“ï¼Œå…¶ä¸­æ¯ä¸ª Lambda å·¥ä½œè€…ä¿æŒæ´»åŠ¨çŠ¶æ€ï¼Œç›´åˆ°ä½œä¸šå®Œæˆå¹¶å¯»æ‰¾æ–°çš„ thunk æ¥æ‰§è¡Œã€‚æ‰§è¡Œå¼•æ“ç»´æŠ¤æ¯ä¸ªå·¥ä½œè€…æœ¬åœ°å­˜å‚¨ä¸­å·²å­˜åœ¨çš„æ‰€æœ‰å¯¹è±¡çš„ç´¢å¼•ã€‚åœ¨å°† thunk æ”¾ç½®åœ¨å·¥ä½œè€…ä¸Šæ—¶ï¼Œå®ƒé€‰æ‹©å…·æœ‰æœ€å¤šå¯ç”¨æ•°æ®çš„å·¥ä½œè€…ï¼Œä»¥æœ€å°åŒ–ä»å­˜å‚¨åç«¯è·å–ä¾èµ–é¡¹çš„éœ€æ±‚ã€‚ åè°ƒç¨‹åºè¿˜å¯ä»¥å¯¹ä¾èµ–å›¾åº”ç”¨ä¼˜åŒ–ã€‚ä¾‹å¦‚ï¼Œå¤šä¸ª thunk å¯ä»¥æ†ç»‘ä¸ºä¸€ä¸ªå¹¶å‘é€ç»™æ‰§è¡Œå¼•æ“ã€‚å½“ä¸€ä¸ª thunk çš„è¾“å‡ºå°†è¢«ä¸‹ä¸€ä¸ª thunk æ¶ˆè€—æ—¶ï¼Œè¿™å¾ˆæœ‰ç”¨ï¼Œåˆ›å»ºäº†ä¸€ä¸ªçº¿æ€§å·¥ä½œç®¡é“ã€‚é€šè¿‡åœ¨ä¸€ä¸ªå·¥ä½œè€…ä¸Šè°ƒåº¦æ‰€æœ‰è¿™äº› thunkï¼Œç³»ç»Ÿå‡å°‘äº†å¾€è¿”æ¬¡æ•°ã€‚ Failure recovery and straggler mitigation. åœ¨åè°ƒç¨‹åºå¤±è´¥çš„æƒ…å†µä¸‹ï¼Œä½œä¸šå¯ä»¥ä»ä¸Šæ¬¡ä¸­æ–­çš„åœ°æ–¹ç»§ç»­ï¼Œå› ä¸ºåè°ƒç¨‹åºä½¿ç”¨ç£ç›˜ç¼“å­˜æ¡ç›®æ¥é¿å…é‡å¤å·²ç»å®Œæˆçš„å·¥ä½œ Straggler mitigation æ»åè€…ç¼“è§£æ˜¯åè°ƒç¨‹åºç®¡ç†çš„å¦ä¸€é¡¹æœåŠ¡ï¼Œå®ƒä¼šåœ¨ç›¸åŒæˆ–ä¸åŒçš„æ‰§è¡Œå¼•æ“ä¸­å¤åˆ¶æŒ‚èµ·çš„æ‰§è¡Œã€‚ç¨‹åºè·Ÿè¸ªæ¯ä¸ª thunk çš„æ‰§è¡Œæ—¶é—´ï¼Œå¦‚æœæ‰§è¡Œæ—¶é—´è¶…è¿‡è¶…æ—¶ï¼ˆç”±ç”¨æˆ·æˆ–åº”ç”¨ç¨‹åºå¼€å‘è€…è®¾ç½®ï¼‰ï¼Œä½œä¸šå°†è¢«å¤åˆ¶ã€‚ç”±äºå‡½æ•°æ²¡æœ‰ä»»ä½•å‰¯ä½œç”¨ï¼Œåè°ƒç¨‹åºåªéœ€é€‰æ‹©é¦–å…ˆå‡†å¤‡å¥½çš„è¾“å‡ºã€‚ éº»äº†éšä¾¿çœ‹çœ‹äº†è¿™è®ºæ–‡ï¼Œè®²è§£çš„ä¸æ˜¯å¾ˆæ¸…æ™° ","date":"2024-11-20","objectID":"/posts/paper-gg/:5:6","tags":["Paper Reading"],"title":"Paper Reading: From Laptop to Lambda: Outsourcing Everyday Jobs to Thousands of Transient Functional Containers","uri":"/posts/paper-gg/"},{"categories":null,"content":"Implementation Notes ","date":"2024-11-20","objectID":"/posts/paper-gg/:5:7","tags":["Paper Reading"],"title":"Paper Reading: From Laptop to Lambda: Outsourcing Everyday Jobs to Thousands of Transient Functional Containers","uri":"/posts/paper-gg/"},{"categories":null,"content":"Applications We used gg to implement several applications, each emitting jobs in the gg IR. We describe these in turn ","date":"2024-11-20","objectID":"/posts/paper-gg/:6:0","tags":["Paper Reading"],"title":"Paper Reading: From Laptop to Lambda: Outsourcing Everyday Jobs to Thousands of Transient Functional Containers","uri":"/posts/paper-gg/"},{"categories":null,"content":"Software Compilation è½¯ä»¶ç¼–è¯‘æ‰€éœ€çš„æ—¶é—´ä¸€ç›´æ˜¯è½¯ä»¶å¼€å‘è€…çš„æŒç»­çƒ¦æ¼ï¼›ç”šè‡³æœ‰ä¸€å¹…æµè¡Œçš„å¡é€šè®½åˆºäº†è¿™ä¸ªä»»åŠ¡çš„æŒç»­æ—¶é—´[39]ã€‚å¦‚ä»Šçš„å¼€æºåº”ç”¨ç¨‹åºå·²ç»å˜å¾—è¶Šæ¥è¶Šå¤§ã€‚ä¾‹å¦‚ï¼Œä»å†·å¯åŠ¨å¼€å§‹ï¼ŒChromium Web æµè§ˆå™¨åœ¨å››æ ¸ç¬”è®°æœ¬ç”µè„‘ä¸Šç¼–è¯‘éœ€è¦å››ä¸ªå¤šå°æ—¶ã€‚å·²ç»å¼€å‘äº†è®¸å¤šè§£å†³æ–¹æ¡ˆæ¥åˆ©ç”¨æœ¬åœ°é›†ç¾¤æˆ–äº‘æ•°æ®ä¸­å¿ƒçš„æ¸©æš–æœºå™¨ï¼ˆä¾‹å¦‚ distcc æˆ– iceccï¼‰ã€‚æˆ‘ä»¬åœ¨ gg ä¹‹ä¸Šå¼€å‘äº†è¿™æ ·ä¸€ä¸ªåº”ç”¨ç¨‹åºã€‚ ä½¿ç”¨æ¨¡å‹æ›¿æ¢ï¼Œæˆ‘ä»¬ä¸º C æˆ– C++è½¯ä»¶æ„å»ºç®¡é“çš„ä¸ƒä¸ªæµè¡Œé˜¶æ®µå®ç°äº†æ¨¡å‹ï¼šé¢„å¤„ç†å™¨ã€ç¼–è¯‘å™¨ã€æ±‡ç¼–å™¨ã€é“¾æ¥å™¨ã€å½’æ¡£å™¨ã€ç´¢å¼•å™¨å’Œ stripã€‚è¿™äº›æ¨¡å‹å…è®¸æˆ‘ä»¬è‡ªåŠ¨å°†ä¸€äº›è½¯ä»¶æ„å»ºè¿‡ç¨‹ï¼ˆä¾‹å¦‚ Makefile æˆ– build.ninja æ–‡ä»¶ï¼‰è½¬æ¢ä¸º gg IR ä¸­çš„è¡¨è¾¾å¼ï¼Œç„¶åå¯ä»¥åœ¨äº‘å‡½æ•°å¹³å°ä¸Šä»¥æ•°åƒå€çš„å¹¶è¡Œæ€§æ‰§è¡Œï¼Œä»¥è·å¾—ä¸æœ¬åœ°æ‰§è¡Œæ„å»ºç³»ç»Ÿç›¸åŒçš„ç»“æœã€‚å›¾ 4 å±•ç¤ºäº†ä¸€ä¸ªç¤ºä¾‹è°ƒç”¨ç”Ÿæˆçš„ IRï¼ˆæšä¸¾çš„ thunk åœ¨å›¾ 3 ä¸­è¯¦ç»†è¯´æ˜ï¼‰ã€‚è¿™äº›æ¨¡å‹è¶³ä»¥æ•è·ä¸€äº›ä¸»è¦å¼€æºåº”ç”¨ç¨‹åºçš„æ„å»ºè¿‡ç¨‹ï¼ŒåŒ…æ‹¬ OpenSSH [29]ã€Python è§£é‡Šå™¨ [32]ã€Protobuf åº“ [31]ã€FFmpeg è§†é¢‘ç³»ç»Ÿ [14]ã€GIMP å›¾åƒç¼–è¾‘å™¨ [16]ã€Inkscape çŸ¢é‡å›¾å½¢ç¼–è¾‘å™¨ [21]å’Œ Chromium æµè§ˆå™¨ [6] Capturing dependencies of the preprocessor. ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåº”ç”¨ç¨‹åºä½¿ç”¨ gg åœ¨è¿è¡Œæ—¶åŠ¨æ€æ•°æ®æµçš„èƒ½åŠ›ã€‚gg çš„é¢„å¤„ç†å™¨æ¨¡å‹ç”Ÿæˆ thunkï¼Œè¿™äº› thunk åœ¨äº‘å‡½æ•°ä¸Šå¹¶è¡Œè¿›è¡Œä¾èµ–é¡¹æ¨æ–­ã€‚è¿™äº› thunk åªèƒ½è®¿é—®ç”¨æˆ·åŒ…å«ç›®å½•çš„ç®€åŒ–ç‰ˆæœ¬ï¼Œä»…ä¿ç•™å¸¦æœ‰ C é¢„å¤„ç†å™¨æŒ‡ä»¤ï¼ˆå¦‚#include å’Œ#defineï¼‰çš„è¡Œã€‚ç„¶åï¼Œè¿™äº› thunk ç”Ÿæˆè¿›ä¸€æ­¥çš„ thunkï¼Œé€šè¿‡ä»…åˆ—å‡ºå¿…è¦çš„å¤´æ–‡ä»¶æ¥é¢„å¤„ç†ç»™å®šçš„æºä»£ç æ–‡ä»¶ã€‚ ","date":"2024-11-20","objectID":"/posts/paper-gg/:6:1","tags":["Paper Reading"],"title":"Paper Reading: From Laptop to Lambda: Outsourcing Everyday Jobs to Thousands of Transient Functional Containers","uri":"/posts/paper-gg/"},{"categories":null,"content":"Unit Testing é€šå¸¸ï¼Œæ¯ä¸ªæµ‹è¯•éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ç¨‹åºï¼Œå¯ä»¥ä¸å…¶ä»–æµ‹è¯•å¹¶è¡Œè¿è¡Œï¼Œå®ƒä»¬ä¹‹é—´æ²¡æœ‰ä¾èµ–å…³ç³»ã€‚ä»£ç ä¸éœ€è¦æ›´æ”¹ï¼Œä½†æœ‰ä¸€ä¸ªä¾‹å¤–ï¼šå¦‚æœæµ‹è¯•ç”¨ä¾‹éœ€è¦è®¿é—®æ–‡ä»¶ç³»ç»Ÿä¸Šçš„æ–‡ä»¶ï¼Œé‚£ä¹ˆç¨‹åºå‘˜å¿…é¡»åœ¨æµ‹è¯•ç”¨ä¾‹ä¸­æ³¨é‡Šå‡ºå®ƒæƒ³è¦è®¿é—®çš„æ–‡ä»¶åˆ—è¡¨ã€‚è¿™ä¸ªè¿‡ç¨‹å¯ä»¥é€šè¿‡åœ¨æœ¬åœ°è¿è¡Œæµ‹è¯•ï¼Œç„¶åè·Ÿè¸ªæ¯ä¸ªæµ‹è¯•ç”¨ä¾‹è°ƒç”¨çš„æ‰“å¼€ç³»ç»Ÿè°ƒç”¨æ¥å®ç°è‡ªåŠ¨åŒ–ã€‚è¯¥å·¥å…·ä½¿ç”¨è¿™äº›æ³¨é‡Šï¼Œæ— è®ºæ˜¯æ‰‹å·¥ç¼–å†™çš„è¿˜æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œæ¥æ•è·æ¯ä¸ªæµ‹è¯•çš„ä¾èµ–é¡¹ã€‚ä¸ºæ¯ä¸ªæµ‹è¯•ç”¨ä¾‹åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„ thunkï¼Œå…è®¸æ‰§è¡Œå¼•æ“åˆ©ç”¨å¯ç”¨çš„å¹¶è¡Œæ€§ã€‚ ","date":"2024-11-20","objectID":"/posts/paper-gg/:6:2","tags":["Paper Reading"],"title":"Paper Reading: From Laptop to Lambda: Outsourcing Everyday Jobs to Thousands of Transient Functional Containers","uri":"/posts/paper-gg/"},{"categories":null,"content":"Video Encoding ","date":"2024-11-20","objectID":"/posts/paper-gg/:6:3","tags":["Paper Reading"],"title":"Paper Reading: From Laptop to Lambda: Outsourcing Everyday Jobs to Thousands of Transient Functional Containers","uri":"/posts/paper-gg/"},{"categories":null,"content":"Object Recognition ","date":"2024-11-20","objectID":"/posts/paper-gg/:6:4","tags":["Paper Reading"],"title":"Paper Reading: From Laptop to Lambda: Outsourcing Everyday Jobs to Thousands of Transient Functional Containers","uri":"/posts/paper-gg/"},{"categories":null,"content":"Recursive Fibonacci ","date":"2024-11-20","objectID":"/posts/paper-gg/:6:5","tags":["Paper Reading"],"title":"Paper Reading: From Laptop to Lambda: Outsourcing Everyday Jobs to Thousands of Transient Functional Containers","uri":"/posts/paper-gg/"},{"categories":null,"content":"Evaluation ","date":"2024-11-20","objectID":"/posts/paper-gg/:7:0","tags":["Paper Reading"],"title":"Paper Reading: From Laptop to Lambda: Outsourcing Everyday Jobs to Thousands of Transient Functional Containers","uri":"/posts/paper-gg/"},{"categories":null,"content":"Startup Overhead ä¸ºäº†è¯´æ˜ gg è½»é‡çº§æŠ½è±¡çš„é‡è¦æ€§ï¼Œæˆ‘ä»¬ä½¿ç”¨å››ä¸ªæ¡†æ¶å®ç°äº†ä¸€ä¸ªç®€å•çš„ä»»åŠ¡ï¼š1,000 ä¸ªå¹¶è¡Œä»»åŠ¡ï¼Œæ¯ä¸ªä»»åŠ¡æ‰§è¡Œ sleep(2)ï¼Œä½¿ç”¨çš„æ¡†æ¶æ˜¯ ggã€PyWrenã€Spark-on-Lambda å’Œ Kubernetesã€‚å‰ä¸‰ä¸ªæ¡†æ¶åœ¨ AWS Lambda ä¸Šæ‰§è¡Œï¼Œæœ€åä¸€ä¸ªåœ¨ Google Kubernetes Engine (GKE)ä¸Šæ‰§è¡Œï¼ŒGKE æä¾›äº†ä¸€ä¸ªæ¸©æš–çš„é›†ç¾¤ï¼ŒåŒ…å«åä¸€ä¸ª 96 æ ¸è™šæ‹Ÿæœºï¼ˆæ€»å…± 1,056 ä¸ªæ ¸å¿ƒï¼‰ï¼Œç”¨äºåˆ†é…å®¹å™¨ã€‚å›¾ 7 æ˜¾ç¤ºäº†ç»“æœã€‚ gg èƒ½å¤Ÿå¿«é€Ÿæ‰©å±•åˆ° 1,000 ä¸ªå¹¶å‘å®¹å™¨ï¼Œå¹¶ä¸”ä¸å…¶ä»–ä¸¤ä¸ªåœ¨ Lambda ä¸Šè¿è¡Œçš„æ¡†æ¶ç›¸æ¯”ï¼Œå®Œæˆä»»åŠ¡çš„é€Ÿåº¦å¿« 7.5-9 å€ã€‚å‡å» 2 ç§’çš„ç¡çœ æ—¶é—´åï¼Œè¿™ç›¸å½“äºå‡å°‘äº† 11-13 å€çš„é¢å¤–å¼€é”€ã€‚å¯¹äº PyWrenï¼Œå¹³å‡æ¯ä¸ªå·¥ä½œè€…èŠ±è´¹ 70%çš„æ—¶é—´è®¾ç½® Python è¿è¡Œæ—¶ï¼ˆä¸‹è½½å’Œè§£å‹ tarballï¼‰ã€‚è¿™ä¸ªè¿è¡Œæ—¶çš„å¤§éƒ¨åˆ†ç”±æˆ‘ä»¬çš„ sleep(2)ç¨‹åºæœªä½¿ç”¨çš„åŒ…ç»„æˆï¼ˆå‚è§ gg çš„ç»†ç²’åº¦ä¾èµ–è·Ÿè¸ªï¼‰ã€‚Google Kubernetes Engine ä¸æ˜¯ä¸ºç¬æ€è®¡ç®—è®¾è®¡çš„ï¼Œä¹Ÿæ²¡æœ‰é’ˆå¯¹è¿™ç§ç”¨ä¾‹è¿›è¡Œä¼˜åŒ–ï¼›å¯åŠ¨ 1,000 ä¸ª Docker å®¹å™¨è¦æ…¢å¾—å¤šã€‚ ","date":"2024-11-20","objectID":"/posts/paper-gg/:7:1","tags":["Paper Reading"],"title":"Paper Reading: From Laptop to Lambda: Outsourcing Everyday Jobs to Thousands of Transient Functional Containers","uri":"/posts/paper-gg/"},{"categories":null,"content":"Software Compilation ä¸ºäº†åŸºå‡†æµ‹è¯• gg çš„æ€§èƒ½ï¼Œæˆ‘ä»¬é€‰æ‹©äº†å››ä¸ªç”¨ C æˆ– C++ç¼–å†™çš„å¼€æºç¨‹åºï¼šFFmpegã€GIMPã€Inkscape å’Œ Chromiumã€‚è¿™äº›åŒ…çš„ä»£ç æˆ–åº•å±‚æ„å»ºç³»ç»Ÿæ²¡æœ‰è¿›è¡Œä»»ä½•æ›´æ”¹ã€‚æˆ‘ä»¬ä½¿ç”¨ GCC 7.2 ç¼–è¯‘æ‰€æœ‰åŒ… å›¾ 9 æ˜¾ç¤ºäº†åŒ…æ„å»ºçš„ä¸­ä½æ—¶é—´ã€‚gg åœ¨æ„å»ºä¸­ç­‰å’Œå¤§å‹è½¯ä»¶åŒ…æ—¶æ¯”ä¼ ç»Ÿå·¥å…·ï¼ˆiceccï¼‰å¿«çº¦ 2-5 å€ã€‚ä¾‹å¦‚ï¼Œgg åœ¨ AWS Lambda ä¸Šç¼–è¯‘ Inkscape ä»…éœ€ 87 ç§’ï¼Œè€Œä½¿ç”¨ icecc å¤–åŒ…åˆ°æ¸©æš–çš„ 384 æ ¸é›†ç¾¤éœ€è¦ 7 åˆ†é’Ÿã€‚è¿™æ˜¯ 4.8 å€çš„åŠ é€Ÿã€‚Chromium æ˜¯æœ€å¤§çš„å¯ç”¨å¼€æºé¡¹ç›®ä¹‹ä¸€ï¼Œä½¿ç”¨ gg åœ¨ AWS Lambda ä¸Šç¼–è¯‘ä»…éœ€ä¸åˆ° 20 åˆ†é’Ÿï¼Œæ¯” icecc (384)å¿« 2.2 å€ã€‚ æˆ‘ä»¬è®¤ä¸º gg åœ¨ AWS Lambda ä¸Šçš„æ€§èƒ½æå‡ä¸èƒ½ç®€å•åœ°å½’å› äºæ¯”æˆ‘ä»¬çš„ 384 æ ¸é›†ç¾¤æ›´å¤šçš„æ ¸å¿ƒï¼›icecc åœ¨ 48 æ ¸å’Œ 384 æ ¸æƒ…å†µä¸‹çš„æ”¹è¿›åªæ˜¯é€‚åº¦ï¼Œå¹¶ä¸”ä¼¼ä¹æ²¡æœ‰æœ‰æ•ˆåˆ©ç”¨æ›´é«˜çš„å¹¶è¡Œåº¦ã€‚è¿™ä¸»è¦æ˜¯å› ä¸º icecc ä¸ºäº†ç®€åŒ–ä¾èµ–è·Ÿè¸ªï¼Œåœ¨æœ¬åœ°è¿è¡Œé¢„å¤„ç†å™¨ï¼Œè¿™æˆä¸ºäº†ä¸€ä¸ªä¸»è¦ç“¶é¢ˆã€‚gg çš„ç»†ç²’åº¦ä¾èµ–è·Ÿè¸ªå…è®¸ç³»ç»Ÿå°†è¿™ä¸€æ­¥éª¤é«˜æ•ˆå¤–åŒ…åˆ°äº‘ç«¯ï¼Œå¹¶æœ€å°åŒ–æœ¬åœ°æœºå™¨ä¸Šçš„å·¥ä½œã€‚ å›¾ 10 æ˜¾ç¤ºäº†ç¼–è¯‘ Inkscape çš„æ‰§è¡Œåˆ†è§£ã€‚æˆ‘ä»¬è§‚å¯Ÿåˆ°ä¸¤ä¸ªé‡è¦ç‰¹å¾ã€‚é¦–å…ˆï¼Œå¤§çš„å³°å€¼å¯¹åº”äºå¤±è´¥çš„æˆ–æ¯”å¹³æ—¶å®Œæˆæ—¶é—´æ›´é•¿çš„ Lambdaã€‚gg çš„æ»åè€…ç¼“è§£æ£€æµ‹å¹¶é‡æ–°å¯åŠ¨è¿™äº›ä»»åŠ¡ï¼Œä»¥é˜²æ­¢ç«¯åˆ°ç«¯å»¶è¿Ÿå¢åŠ ã€‚å…¶æ¬¡ï¼Œæœ€åå‡ ä¸ªä»»åŠ¡ä¸»è¦æ˜¯ä¸²è¡Œçš„ï¼ˆå½’æ¡£å’Œé“¾æ¥ï¼‰ï¼Œæ¶ˆè€—äº†è¿‘å››åˆ†ä¹‹ä¸€çš„æ€»ä»»åŠ¡å®Œæˆæ—¶é—´ã€‚è¿™äº›ç‰¹å¾åœ¨å…¶ä»–æ„å»ºä»»åŠ¡ä¸­ä¹Ÿæœ‰æ‰€ä½“ç°ã€‚ çœŸçš„è«åå…¶å¦™çš„è®ºæ–‡ï¼Œçœ‹ä¸æ‡‚ ","date":"2024-11-20","objectID":"/posts/paper-gg/:7:2","tags":["Paper Reading"],"title":"Paper Reading: From Laptop to Lambda: Outsourcing Everyday Jobs to Thousands of Transient Functional Containers","uri":"/posts/paper-gg/"},{"categories":null,"content":"Limitations and Discussion ä»…é™äº CPU ç¨‹åº gg å°†ä»£ç æ ¼å¼æŒ‡å®šä¸º x86-64 Linux ELF å¯æ‰§è¡Œæ–‡ä»¶ã€‚IR æ²¡æœ‰æœºåˆ¶æ¥è¡¨ç¤ºå¯¹ GPU æˆ–å…¶ä»–åŠ é€Ÿå™¨çš„éœ€æ±‚ï¼Œå¹¶ä¸”é«˜æ•ˆè°ƒåº¦è¿™äº›èµ„æºæå‡ºäº†éå¹³å‡¡çš„æŒ‘æˆ˜ï¼Œå› ä¸ºä» GPU åŠ è½½å’Œå¸è½½é…ç½®çŠ¶æ€æ¯”å†…å­˜æ˜ å°„æ–‡ä»¶æ›´æ˜‚è´µçš„æ“ä½œã€‚æˆ‘ä»¬è®¡åˆ’ç ”ç©¶ gg åç«¯å°† thunk è°ƒåº¦åˆ° GPU çš„é€‚å½“æœºåˆ¶ã€‚ è¿™æ˜¯ç»å¤§éƒ¨åˆ† serverless çš„é—®é¢˜å§ ","date":"2024-11-20","objectID":"/posts/paper-gg/:8:0","tags":["Paper Reading"],"title":"Paper Reading: From Laptop to Lambda: Outsourcing Everyday Jobs to Thousands of Transient Functional Containers","uri":"/posts/paper-gg/"},{"categories":null,"content":"Conclusion åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬æè¿°äº† ggï¼Œä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æ„å»ºå’Œæ‰§è¡Œçªå‘å¹¶è¡Œåº”ç”¨ç¨‹åºçš„æ¡†æ¶ã€‚gg æä¾›äº†ä¸€ä¸ªå¯ç§»æ¤çš„æŠ½è±¡ï¼šä¸€ä¸ªä¸­é—´è¡¨ç¤ºï¼ˆIRï¼‰ï¼Œå°†ä»»åŠ¡çš„æœªæ¥æ‰§è¡Œæ•è·ä¸ºè½»é‡çº§ Linux å®¹å™¨çš„ç»„åˆã€‚è¿™ä½¿å¾— gg èƒ½å¤Ÿæ”¯æŒæ–°æ—§åº”ç”¨ç¨‹åºï¼Œè¿™äº›åº”ç”¨ç¨‹åºåœ¨å„ç§è¯­è¨€ä¸­ä»è®¡ç®—å’Œå­˜å‚¨å¹³å°ä»¥åŠè§£å†³åº•å±‚æŒ‘æˆ˜çš„è¿è¡Œæ—¶ç‰¹æ€§ä¸­æŠ½è±¡å‡ºæ¥ï¼šä¾èµ–ç®¡ç†ã€æ»åè€…ç¼“è§£ã€æ”¾ç½®å’Œè®°å¿†åŒ–ã€‚ ","date":"2024-11-20","objectID":"/posts/paper-gg/:9:0","tags":["Paper Reading"],"title":"Paper Reading: From Laptop to Lambda: Outsourcing Everyday Jobs to Thousands of Transient Functional Containers","uri":"/posts/paper-gg/"},{"categories":null,"content":"Apiary: A DBMS-Backed Transactional Function-as-a-Service Framework æ¥è‡ª DBOS çš„ä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„é¡¹ç›®ï¼ŒDBOS è¿™ä¸ªé¡¹ç›®å»å¹´å…³æ³¨è¿‡ï¼Œtxn + serverless å¾ˆæœ‰è¶£çš„æ€è·¯ ä¼ ç»Ÿ FaaS å®¢æˆ·ç«¯è°ƒç”¨å‡½æ•°å»è¿æ¥ DB æŸ¥è¯¢ DBOS ç›´æ¥ DB as OSï¼Œæå‡ºä¸‡ç‰©éƒ½æ˜¯è¡¨çš„æ¦‚å¿µ https://juejin.cn/post/7345644573652582440 InfoQ å’Œ MeetDBOS çš„ä¸€äº›ä»‹ç» https://www.infoq.cn/article/r9eev0oqqs8qip31eutg \u003e https://www.infoq.com/news/2024/03/dbos-cloud-serverless/ è¿™ä¸€ç¯‡ Apiary åº”è¯¥æ˜¯å¼€æºç‰ˆæœ¬çš„ DBOSï¼ŒDBOS æœ¬èº«æ˜¯ä¸å¼€æºçš„ï¼ŒDBOS è®ºæ–‡è®¨è®ºäº†ä¸å°‘å®ç°å’Œ IPC ä¸ scheduler https://zhuanlan.zhihu.com/p/463722216 ä¸å‡¯å¤§ä½¬çš„ DBOS è§£è¯» ","date":"2024-11-16","objectID":"/posts/paper-apiary/:1:0","tags":["Paper Reading"],"title":"Paper Reading: Apiary: A DBMS-Integrated Transactional Function-as-a-Service Framework","uri":"/posts/paper-apiary/"},{"categories":null,"content":"Abstract å¼€å‘äººå‘˜è¶Šæ¥è¶Šå¤šåœ°ä½¿ç”¨å‡½æ•°å³æœåŠ¡ï¼ˆFaaSï¼‰å¹³å°æ¥æ„å»ºæ•°æ®å¯†é›†å‹åº”ç”¨ç¨‹åºï¼Œè¿™äº›åº”ç”¨ç¨‹åºéœ€è¦å¯¹æ•°æ®è¿›è¡Œä½å»¶è¿Ÿå’Œäº‹åŠ¡æ€§æ“ä½œï¼Œä¾‹å¦‚ç”¨äºå¾®æœåŠ¡æˆ– Web æœåŠ¡ã€‚ç„¶è€Œï¼Œç°æœ‰çš„ FaaS å¹³å°åœ¨è¿™äº›åº”ç”¨ç¨‹åºçš„æ”¯æŒä¸Šè¡¨ç°ä¸ä½³ï¼Œå› ä¸ºå®ƒä»¬åœ¨ç‰©ç†ä¸Šå’Œé€»è¾‘ä¸Šå°†åº”ç”¨ç¨‹åºé€»è¾‘ï¼ˆåœ¨äº‘å‡½æ•°ä¸­æ‰§è¡Œï¼‰ä¸æ•°æ®ç®¡ç†ï¼ˆé€šè¿‡è®¿é—®è¿œç¨‹å­˜å‚¨çš„äº¤äº’å¼äº‹åŠ¡å®Œæˆï¼‰åˆ†ç¦»å¼€æ¥ã€‚ç‰©ç†ä¸Šçš„åˆ†ç¦»æŸå®³äº†æ€§èƒ½ï¼Œè€Œé€»è¾‘ä¸Šçš„åˆ†ç¦»åˆ™ä½¿å¾—é«˜æ•ˆæä¾›äº‹åŠ¡ä¿è¯å’Œå®¹é”™æ€§å˜å¾—å¤æ‚ã€‚ æœ¬æ–‡ä»‹ç»äº†ä¸€ç§åä¸º Apiary çš„æ–°å‹ DBMS é›†æˆ FaaS å¹³å°ï¼Œç”¨äºéƒ¨ç½²å’Œç»„åˆå…·æœ‰å®¹é”™æ€§çš„äº‹åŠ¡æ€§å‡½æ•°ã€‚Apiary é€šè¿‡å°†åˆ†å¸ƒå¼ DBMS å¼•æ“å°è£…å¹¶å°†å…¶ç”¨ä½œå‡½æ•°æ‰§è¡Œã€æ•°æ®ç®¡ç†å’Œæ“ä½œæ—¥å¿—è®°å½•çš„ç»Ÿä¸€è¿è¡Œæ—¶ï¼Œä»è€Œåœ¨ç‰©ç†ä¸Šå…±ç½®å’Œé€»è¾‘ä¸Šé›†æˆå‡½æ•°æ‰§è¡Œå’Œæ•°æ®ç®¡ç†ï¼Œä»è€Œæä¾›ä¸åŒç±»ç³»ç»Ÿç›¸å½“æˆ–æ›´å¼ºçš„äº‹åŠ¡ä¿è¯ï¼ŒåŒæ—¶æ˜¾è‘—æé«˜æ€§èƒ½å’Œå¯è§‚å¯Ÿæ€§ã€‚ ç»“æœæ˜¾ç¤ºï¼Œåœ¨å¾®æœåŠ¡å·¥ä½œè´Ÿè½½ä¸Šï¼ŒApiary çš„è¡¨ç°ä¼˜äºå®ƒä»¬ 2 åˆ° 68 å€ï¼Œé€šè¿‡å‡å°‘é€šä¿¡å¼€é”€å®ç°äº†è¿™ä¸€ä¼˜åŠ¿ã€‚ ","date":"2024-11-16","objectID":"/posts/paper-apiary/:2:0","tags":["Paper Reading"],"title":"Paper Reading: Apiary: A DBMS-Integrated Transactional Function-as-a-Service Framework","uri":"/posts/paper-apiary/"},{"categories":null,"content":"Introduction FaaS æ¨¡å‹åœ¨æ•°æ®å¯†é›†å‹åº”ç”¨ç¨‹åºä¸­è¶Šæ¥è¶Šå—æ¬¢è¿ï¼šä¾‹å¦‚ç”µå­å•†åŠ¡ Web æœåŠ¡ç­‰éœ€è¦ä½å»¶è¿Ÿå’Œäº‹åŠ¡æ€§æ“ä½œçš„åº”ç”¨ç¨‹åºã€‚ç„¶è€Œï¼Œç°æœ‰çš„ FaaS å¹³å°åœ¨è¿™äº›åº”ç”¨ç¨‹åºçš„æ”¯æŒä¸Šè¡¨ç°ä¸ä½³ï¼Œå› ä¸ºå®ƒä»¬åœ¨ç‰©ç†ä¸Šå’Œé€»è¾‘ä¸Šå°†å‡½æ•°æ‰§è¡Œä¸æ•°æ®ç®¡ç†åˆ†ç¦»å¼€æ¥ï¼Œé‡‡ç”¨äº†å›¾ 1a æ‰€ç¤ºçš„æ¶æ„ï¼Œå¹¶åœ¨æ¯æ¬¡æ•°æ®æ“ä½œæ—¶è°ƒç”¨è¿œç¨‹ DBMS çœŸçš„å—ï¼Ÿè¿™é‡Œè¯´çš„æ˜¯ç”Ÿäº§è¿˜æ˜¯å­¦æœ¯çš„ faas æ¨¡å‹ã€‚ã€‚ ä¸ä¸€å®šæ‰€æœ‰ faas éƒ½ä¼šå»è°ƒç”¨ dbms æŠŠ é€»è¾‘ä¸Šçš„åˆ†ç¦»ä½¿å¾—å®¹é”™æ€§å’Œäº‹åŠ¡ä¿è¯å˜å¾—å¤æ‚ï¼Œå› ä¸ºå‡½æ•°å¯èƒ½ä¼šè¢«ä»»æ„åœ°é‡æ–°æ‰§è¡Œï¼Œè€Œäº‹åŠ¡ä¸èƒ½è·¨è¶Šå¤šä¸ªå‡½æ•°ã€‚å®ƒä»¬è¦ä¹ˆæä¾›ç‰©ç†ä¸Šçš„å…±ç½®ä»¥è·å¾—è‰¯å¥½çš„æ€§èƒ½ï¼Œè¦ä¹ˆæä¾›é€»è¾‘ä¸Šçš„é›†æˆä»¥è·å¾—å¼ºæœ‰åŠ›çš„ä¿è¯ï¼Œä½†æ— æ³•åŒæ—¶åšåˆ°ä¸¤è€…ã€‚ ä¾‹å¦‚ï¼ŒCloudburst[42]é€šè¿‡ä½¿ç”¨æœ¬åœ°ç¼“å­˜æ¥ç‰©ç†ä¸Šå…±ç½®è®¡ç®—å’Œæ•°æ®ï¼Œä½†ä¸æä¾›äº‹åŠ¡æ”¯æŒã€‚å…¶ä»–å¦‚ Boki[22]å’Œ Beldi[47]é€šè¿‡è¿œç¨‹å­˜å‚¨ä¸Šçš„å¤–éƒ¨äº‹åŠ¡ç®¡ç†å™¨æä¾›äº‹åŠ¡æ€§å‡½æ•°ï¼Œä½†è¿™å¢åŠ äº†å·²ç»å¾ˆé«˜çš„å­˜å‚¨è®¿é—®æ—¶é—´ï¼Œè¾¾åˆ°äº† 3 å€ã€‚ æœ¬æ–‡ä»‹ç»äº† Apiaryï¼Œä¸€ç§ç”¨äºæ•°æ®å¯†é›†å‹åº”ç”¨ç¨‹åºçš„äº‹åŠ¡æ€§ã€é«˜æ€§èƒ½ FaaS å¹³å°ã€‚ä¸ç°æœ‰å¹³å°ä¸åŒï¼ŒApiary é€šè¿‡å°è£…åˆ†å¸ƒå¼ DBMS å¼•æ“å¹¶å°†å…¶ç”¨ä½œå‡½æ•°æ‰§è¡Œã€æ•°æ®ç®¡ç†å’Œæ“ä½œæ—¥å¿—è®°å½•çš„ç»Ÿä¸€è¿è¡Œæ—¶ï¼Œä»è€Œåœ¨ç‰©ç†ä¸Šå…±ç½®å’Œé€»è¾‘ä¸Šé›†æˆå‡½æ•°æ‰§è¡Œå’Œæ•°æ®ç®¡ç†ï¼ˆå›¾ 1bï¼‰ã€‚æˆ‘ä»¬å°†å‡½æ•°ç¼–è¯‘ä¸ºå­˜å‚¨è¿‡ç¨‹ï¼Œå³åœ¨é SQL è¯­è¨€ä¸­è¿è¡Œçš„æœ¬åœ° DBMS äº‹åŠ¡ï¼Œä»è€Œä½¿å‡½æ•°æˆä¸ºæ§åˆ¶æµå’ŒåŸå­æ€§çš„åŸºæœ¬å•ä½ã€‚ç„¶åï¼Œæˆ‘ä»¬åˆ©ç”¨è¿™ç§é›†æˆæ¥æ”¯æŒé«˜æ•ˆã€å®¹é”™æ€§çš„å‡½æ•°ç»„åˆå’Œæ–°é¢–çš„å¯è§‚å¯Ÿæ€§èƒ½åŠ›ã€‚æˆ‘ä»¬è¯æ˜ï¼ŒApiary æä¾›äº†ï¼ˆaï¼‰ä¸åŒç±»å¹³å°ç›¸å½“æˆ–æ›´å¼ºçš„ä¿è¯ï¼Œï¼ˆbï¼‰ä¸æœ€å…ˆè¿›çš„ç³»ç»Ÿç›¸æ¯”ï¼Œæ€§èƒ½æå‡äº† 2 åˆ° 68 å€ï¼Œä»¥åŠï¼ˆcï¼‰è‡ªåŠ¨è·Ÿè¸ªåº”ç”¨ç¨‹åºä¸æ•°æ®åº“äº¤äº’ä»¥å®ç°å¯è§‚å¯Ÿæ€§ã€‚ è®¾è®¡ç”¨äºæ•°æ®å¯†é›†å‹åº”ç”¨ç¨‹åºçš„ FaaS å¹³å°çš„ä¸»è¦æŒ‘æˆ˜æ˜¯æä¾›é«˜æ•ˆã€å®¹é”™æ€§çš„å‡½æ•°ç»„åˆã€‚FaaS å¼€å‘è€…é€šè¿‡å°†å‡½æ•°ç»„åˆæˆå·¥ä½œæµ workflows æ¥ç¼–å†™å¤æ‚çš„ç¨‹åºã€‚ä¸ºäº†åœ¨æ•…éšœé¢å‰ä¿æŒç¨³å¥ï¼Œå·¥ä½œæµéœ€è¦å¼ºå¤§çš„æ‰§è¡Œä¿è¯ï¼šå®ƒä»¬å¿…é¡»å§‹ç»ˆè¿è¡Œåˆ°å®Œæˆï¼Œå¹¶ä¸”æ¯ä¸ªå‡½æ•°å¿…é¡»æ°å¥½æ‰§è¡Œä¸€æ¬¡ã€‚ç°æœ‰å¹³å°é€šè¿‡è¦æ±‚å‡½æ•°å…·æœ‰å¹‚ç­‰æ€§[6]æˆ–æ„å»ºæ˜‚è´µçš„å¤–éƒ¨äº‹åŠ¡ç®¡ç†å™¨[47]æ¥æä¾›è¿™äº›ä¿è¯ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ Apiary ä¸­å‡½æ•°å’Œæ•°æ®çš„é›†æˆï¼Œæ„å»ºä¸€ä¸ªå®¹é”™æ€§å‰ç«¯ï¼Œä»¥æœ€å°çš„å¼€å‘è€…è¦æ±‚å’Œä½å¼€é”€æä¾›è¿™äº›ä¿è¯ã€‚ç”±äºå‡½æ•°æ˜¯å­˜å‚¨è¿‡ç¨‹ï¼ŒApiary å¯ä»¥å¯¹å®ƒä»¬è¿›è¡Œæ£€æµ‹ï¼Œä»¥äº‹åŠ¡æ€§åœ°è®°å½•å®ƒä»¬åœ¨ DBMS ä¸­çš„æ‰§è¡Œæƒ…å†µã€‚å› æ­¤ï¼Œå¦‚æœå·¥ä½œæµæ‰§è¡Œå¤±è´¥ï¼Œå‰ç«¯å¯ä»¥é€šè¿‡ä»å¤´å¼€å§‹è°ƒç”¨å…¶å‡½æ•°æ¥å®‰å…¨åœ°æ¢å¤å®ƒï¼Œè·³è¿‡å·²ç»æ‰§è¡Œè¿‡çš„å‡½æ•°ã€‚ç„¶è€Œï¼Œnaively åœ°æ£€æµ‹ instrumenting æ‰€æœ‰å‡½æ•°æ˜¯æ˜‚è´µçš„ï¼Œä¼šé™ä½æ€§èƒ½é«˜è¾¾ 2.2 å€ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¼€å‘äº†ä¸€ç§æ–°é¢–çš„ç®—æ³•æ¥è¯†åˆ«å‡½æ•°ä½•æ—¶å¯ä»¥å®‰å…¨åœ°é‡æ–°æ‰§è¡Œï¼Œå°†å¼€é”€é™ä½åˆ° \u003c5%ã€‚ exectly once ä¿è¯ idempotent å¹‚ç­‰ Apiary è¿˜è§£å†³äº† FaaS å¼€å‘è€…é¢ä¸´çš„ä¸€ä¸ªå¸¸è§æŒ‘æˆ˜ï¼šäº†è§£åº”ç”¨ç¨‹åºå¦‚ä½•ä¸æ•°æ®äº¤äº’çš„å¯è§‚å¯Ÿæ€§ã€‚ tracing æ˜¯ dbos çš„ä¸€ä¸ªç‰¹è‰² æ€»ç»“èµ·æ¥ï¼Œæˆ‘ä»¬çš„è´¡çŒ®å¦‚ä¸‹ï¼š æˆ‘ä»¬æå‡ºäº† Apiaryï¼Œä¸€ç§äº‹åŠ¡æ€§ FaaS å¹³å°ï¼Œé€šè¿‡å°è£…åˆ†å¸ƒå¼ DBMS åœ¨ç‰©ç†ä¸Šå…±ç½®å’Œé€»è¾‘ä¸Šé›†æˆå‡½æ•°ä¸æ•°æ®ã€‚Apiary åœ¨æä¾›ç±»ä¼¼æˆ–æ›´å¼ºä¿è¯çš„åŒæ—¶ï¼Œæ€§èƒ½ä¼˜äºç ”ç©¶å’Œç”Ÿäº§å¹³å° 2 åˆ° 68 å€ã€‚ æˆ‘ä»¬åˆ©ç”¨ Apiary çš„æ¶æ„è®¾è®¡äº†ä¸€ä¸ª fault-tolerant frontendï¼Œç”¨äºç¼–æ’å‡½æ•°å·¥ä½œæµã€‚å®ƒä¿è¯äº†æ— è®ºæ˜¯å¦å‘ç”Ÿæ•…éšœï¼Œå·¥ä½œæµæ€»æ˜¯èƒ½è¿è¡Œåˆ°å®Œæˆï¼Œå¹¶ä¸”å…¶ä¸­çš„æ¯ä¸ªå‡½æ•°éƒ½æ°å¥½æ‰§è¡Œä¸€æ¬¡ã€‚ æˆ‘ä»¬åˆ©ç”¨ Apiary çš„æ¶æ„æ¥å¢å¼ºå¯è§‚å¯Ÿæ€§ï¼Œé€šè¿‡è‡ªåŠ¨æ£€æµ‹åº”ç”¨ç¨‹åºåŠå…¶ä¸æ•°æ®çš„äº¤äº’ï¼Œå®ç°äº†\u003c15%çš„å¼€é”€ï¼Œç›¸æ¯”æ‰‹åŠ¨æ—¥å¿—è®°å½•çš„ 92%å¼€é”€æœ‰äº†æ˜¾è‘—æ”¹è¿›ã€‚ ","date":"2024-11-16","objectID":"/posts/paper-apiary/:3:0","tags":["Paper Reading"],"title":"Paper Reading: Apiary: A DBMS-Integrated Transactional Function-as-a-Service Framework","uri":"/posts/paper-apiary/"},{"categories":null,"content":"Apiary Overview ","date":"2024-11-16","objectID":"/posts/paper-apiary/:4:0","tags":["Paper Reading"],"title":"Paper Reading: Apiary: A DBMS-Integrated Transactional Function-as-a-Service Framework","uri":"/posts/paper-apiary/"},{"categories":null,"content":"System Architecture Apiary çš„è®¾è®¡åŠ¨æœºæºäºä¸€ä¸ªå…³é”®è§‚å¯Ÿï¼šæ•°æ®å¯†é›†å‹åº”ç”¨ç¨‹åºåœ¨å…¶è¿è¡Œæ—¶ä¸­ï¼Œå¤§éƒ¨åˆ†æ—¶é—´è¦ä¹ˆåœ¨ä¸ DBMS é€šä¿¡ï¼Œè¦ä¹ˆåœ¨æ‰§è¡Œ DBMS æ“ä½œã€‚ è¿™æ˜¯å‡è®¾è¿˜æ˜¯è§‚å¯Ÿï¼Ÿ å…¶å®æˆ‘ä¸€ç›´ä¸æ˜ç™½ DBOS æ˜¯åšäº†ä¸ª serverless DB è¿˜æ˜¯ä»€ä¹ˆ çœ‹èµ·æ¥æ˜¯éå­˜ç®—åˆ†ç¦»çš„æ¶æ„ï¼Ÿ æˆ‘ä»¬å°† Apiary è®¾è®¡ä¸ºé€šè¿‡å°è£…åˆ†å¸ƒå¼ DBMS å¹¶å°†å‡½æ•°ç¼–è¯‘ä¸ºæ•°æ®åº“å­˜å‚¨è¿‡ç¨‹ï¼Œä»è€Œåœ¨ç‰©ç†ä¸Šå…±ç½®è®¡ç®—å’Œæ•°æ®ã€‚ç”±äºå­˜å‚¨è¿‡ç¨‹æ˜¯äº‹åŠ¡æ€§çš„ï¼Œè¿™ç§æ¶æ„ä¹Ÿåœ¨é€»è¾‘ä¸Šé›†æˆäº†å‡½æ•°æ‰§è¡Œå’Œæ•°æ®ç®¡ç†ï¼›æˆ‘ä»¬åˆ©ç”¨è¿™ç§é›†æˆæ¥é«˜æ•ˆåœ°æä¾›äº‹åŠ¡ä¿è¯ã€å®¹é”™æ€§å’Œå¯è§‚å¯Ÿæ€§ Clients å®¢æˆ·ç«¯é€šè¿‡å®¢æˆ·ç«¯åº“å‘å‰ç«¯å‘é€è¯·æ±‚ï¼Œä»¥è°ƒç”¨å·¥ä½œæµå’Œå‡½æ•°ï¼Œè¿™äº›å·¥ä½œæµå’Œå‡½æ•°åœ¨åç«¯æ‰§è¡Œã€‚å¼€å‘è€…ä½¿ç”¨æˆ‘ä»¬çš„ç¼–ç¨‹æ¥å£ç¼–å†™å‡½æ•°å¹¶ç»„åˆå·¥ä½œæµã€‚ Frontend å‰ç«¯æœåŠ¡å™¨å°†å®¢æˆ·ç«¯è¯·æ±‚è·¯ç”±å¹¶è®¤è¯åˆ°åç«¯ã€‚æ¯ä¸ªæœåŠ¡å™¨éƒ½æœ‰ä¸€ä¸ªè°ƒåº¦å™¨ï¼Œå®ƒé€šè¿‡åœ¨åç«¯è°ƒç”¨æ¯ä¸ªå‡½æ•°ï¼Œä¼ å…¥å…¶è¾“å…¥ï¼Œæ”¶é›†å…¶è¾“å‡ºä»¥å‘é€ç»™åç»­å‡½æ•°ï¼Œå¹¶å¼ºåˆ¶æ‰§è¡Œå®¹é”™ä¿è¯ï¼ˆÂ§3ï¼ŒÂ§4ï¼‰æ¥ç®¡ç†å·¥ä½œæµæ‰§è¡Œã€‚æœåŠ¡å™¨è¿˜åŒ…å«æ³¨å†Œå™¨ï¼Œè´Ÿè´£å‡½æ•°å’Œå·¥ä½œæµçš„æ³¨å†Œã€æ£€æµ‹å’Œç¼–è¯‘ã€‚ Backend åç«¯æ‰§è¡Œå‡½æ•°å¹¶ç®¡ç†æ•°æ®ã€‚å®ƒå°è£…äº†ä¸€ä¸ªåˆ†å¸ƒå¼ DBMS åŠå…¶å­˜å‚¨è¿‡ç¨‹ã€‚Apiary åœ¨ DBMS æœåŠ¡å™¨ä¸Šä»¥äº‹åŠ¡æ€§æ–¹å¼æ‰§è¡Œå‡½æ•°ï¼Œå¯¹å…¶è¿›è¡Œæ£€æµ‹ä»¥æä¾›å®¹é”™æ€§ï¼ˆÂ§3ï¼ŒÂ§4ï¼‰ï¼Œå¹¶æ•è·åº”ç”¨ç¨‹åºä¸æ•°æ®åº“äº¤äº’çš„ä¿¡æ¯ä»¥å®ç°å¯è§‚å¯Ÿæ€§ï¼ˆÂ§5ï¼‰ã€‚ç”±äºå‡½æ•°åœ¨ç‰©ç†ä¸Šä¸ DBMS å…±ç½®ï¼Œæˆ‘ä»¬ä¾èµ– DBMS çš„æœ¬åœ°å¼¹æ€§æ‰©å±•èƒ½åŠ›æ¥æ‰©å±•åç«¯ã€‚ ","date":"2024-11-16","objectID":"/posts/paper-apiary/:4:1","tags":["Paper Reading"],"title":"Paper Reading: Apiary: A DBMS-Integrated Transactional Function-as-a-Service Framework","uri":"/posts/paper-apiary/"},{"categories":null,"content":"Non-Goals Compute-Heavy Workloads Apiary çš„è®¾è®¡ä¸“æ³¨äºçŸ­ç”Ÿå‘½å‘¨æœŸçš„æ•°æ®å¯†é›†å‹åº”ç”¨ç¨‹åºï¼Œè€Œä¸æ˜¯é•¿æ—¶é—´è¿è¡Œçš„è®¡ç®—å¯†é›†å‹å·¥ä½œè´Ÿè½½ï¼Œå¦‚è§†é¢‘å¤„ç†[17]æˆ–æ‰¹é‡åˆ†æ[37] Non-Relational Data Models Apiary ç›®å‰ä»…æ”¯æŒå…³ç³»å‹æ•°æ®æ¨¡å‹ã€‚æˆ‘ä»¬ç›¸ä¿¡å¯ä»¥å°† Apiary æ‰©å±•ä»¥æ”¯æŒäº‹åŠ¡æ€§çš„éå…³ç³»å‹æ•°æ®åº“ï¼Œå¦‚ MongoDBï¼Œä½†è¿™è¶…å‡ºäº†æœ¬æ–‡çš„èŒƒå›´ã€‚ å…¶å®å‡ ä¸ªå¾®æœåŠ¡ benchmark ä¹Ÿæœ‰ mongodb æŠŠ ","date":"2024-11-16","objectID":"/posts/paper-apiary/:4:2","tags":["Paper Reading"],"title":"Paper Reading: Apiary: A DBMS-Integrated Transactional Function-as-a-Service Framework","uri":"/posts/paper-apiary/"},{"categories":null,"content":"Apiary Semantics ","date":"2024-11-16","objectID":"/posts/paper-apiary/:5:0","tags":["Paper Reading"],"title":"Paper Reading: Apiary: A DBMS-Integrated Transactional Function-as-a-Service Framework","uri":"/posts/paper-apiary/"},{"categories":null,"content":"Programming Interface é…’åº—é¢„è®¢æœåŠ¡çš„ä¾‹å­æ¥æ¦‚è¿°å…¶ç¼–ç¨‹æ¥å£ï¼Œè¯¥æœåŠ¡æ£€æŸ¥æˆ¿é—´æ˜¯å¦å¯ç”¨ï¼Œé¢„è®¢æˆ¿é—´ï¼Œç„¶åå‘é€ç¡®è®¤é‚®ä»¶ã€‚ Function Interface: Apiary è¦æ±‚å‡½æ•°éµå¾ªä¸‰æ¡è§„åˆ™ï¼š å‡½æ•°ä¸­çš„æ‰€æœ‰ SQL æŸ¥è¯¢å¿…é¡»é™æ€å®šä¹‰ defined statically ä¸ºå‚æ•°åŒ–é¢„å¤‡è¯­å¥ parameterized prepared statementsã€‚ å‡½æ•°å¿…é¡»æ˜¯ç¡®å®šæ€§ deterministic çš„ã€‚ å¤–éƒ¨æœåŠ¡æˆ– API è°ƒç”¨å¿…é¡»æ˜¯å¹‚ç­‰ idempotent çš„ã€‚ ç¬¬ä¸€æ¡è§„åˆ™æ”¯æŒé™æ€åˆ†æï¼ˆÂ§4ï¼‰å’Œæ•°æ®è·Ÿè¸ªä»¥å®ç°å¯è§‚å¯Ÿæ€§ï¼ˆÂ§5ï¼‰ï¼›æœ€åä¸¤æ¡è§„åˆ™æ”¯æŒå®ç°æ°å¥½ä¸€æ¬¡è¯­ä¹‰çš„å®é™…å®ç°ï¼ˆÂ§4ï¼‰ã€‚ Workflow Interface: å¼€å‘è€…ä½¿ç”¨å›¾ 5 ä¸­çš„æ¥å£å°†ç¨‹åºæ„é€ ä¸ºå‡½æ•°çš„å·¥ä½œæµã€‚æ¯ä¸ªå·¥ä½œæµæ˜¯ä¸€ä¸ªæœ‰å‘æ— ç¯å›¾ï¼ˆDAGï¼‰ï¼Œå…¶ä¸­èŠ‚ç‚¹æ˜¯å‡½æ•°ï¼Œè¾¹æ˜¯æ•°æ®æµï¼Œå‡½æ•°çš„è¾“å…¥æ˜¯å…¶çˆ¶å‡½æ•°çš„è¾“å‡ºã€‚å¼€å‘è€…ä»å‡½æ•°åˆ—è¡¨å’Œå°†æ—©æœŸå‡½æ•°çš„è¾“å‡ºæ˜ å°„åˆ°åæœŸå‡½æ•°è¾“å…¥çš„è§„èŒƒä¸­æ„å»ºå·¥ä½œæµã€‚ä¸å…è®¸é€’å½’æˆ–å¾ªç¯ä¾èµ–ã€‚ ","date":"2024-11-16","objectID":"/posts/paper-apiary/:5:1","tags":["Paper Reading"],"title":"Paper Reading: Apiary: A DBMS-Integrated Transactional Function-as-a-Service Framework","uri":"/posts/paper-apiary/"},{"categories":null,"content":"Transactional Semantics FaaS ç¨‹åºé€šå¸¸éœ€è¦äº‹åŠ¡ä¿è¯ï¼›ä¾‹å¦‚ï¼Œæˆ‘ä»¬çš„é…’åº—é¢„è®¢å·¥ä½œæµéœ€è¦äº‹åŠ¡æ¥ä¿è¯æˆ¿é—´ä¸ä¼šè¢«é‡å¤é¢„è®¢ã€‚ å› æ­¤ï¼ŒApiary åœ¨é€»è¾‘ä¸Šé›†æˆäº†å‡½æ•°æ‰§è¡Œå’Œæ•°æ®ç®¡ç†ï¼šæ¯ä¸ªå‡½æ•°åœ¨æ•°æ®åº“ä¸­ä½œä¸ºå¯åºåˆ—åŒ–çš„ ACID äº‹åŠ¡æ‰§è¡Œã€‚è¿™ä¸€è®¾è®¡çš„ä¸€ä¸ªå…³é”®å«ä¹‰æ˜¯ï¼Œå‡½æ•°æ—¢æ˜¯æ§åˆ¶æµçš„åŸºæœ¬å•ä½ï¼Œä¹Ÿæ˜¯åŸå­æ€§çš„åŸºæœ¬å•ä½ï¼›æˆ‘ä»¬åˆ©ç”¨è¿™ä¸€ç‚¹æ¥å®ç°å®¹é”™æ€§ï¼ˆÂ§4ï¼‰ï¼Œå¹¶è·Ÿè¸ªåº”ç”¨ç¨‹åºä¸æ•°æ®åº“çš„äº¤äº’ä»¥å®ç°å¯è§‚å¯Ÿæ€§ï¼ˆÂ§5ï¼‰ã€‚ ä¸€ä¸ªé‡è¦çš„é—®é¢˜æ˜¯æˆ‘ä»¬ä¸ºå·¥ä½œæµæä¾›ä»€ä¹ˆæ ·çš„äº‹åŠ¡è¯­ä¹‰ã€‚å¤©çœŸåœ°ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ•´ä¸ªå·¥ä½œæµåœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­æ‰§è¡Œï¼Œä½†è¿™ä¼šå¯¼è‡´ä¸å¿…è¦çš„ã€æ€§èƒ½è¾ƒå·®çš„å¤§å‹äº‹åŠ¡ ä½†å¼€å‘è€…é€šå¸¸éœ€è¦è·¨å¤šä¸ªå‡½æ•°çš„äº‹åŠ¡ä¿è¯ã€‚ä¾‹å¦‚ï¼Œåœ¨é…’åº—å·¥ä½œæµä¸­ï¼Œå‰ä¸¤ä¸ªå‡½æ•°ï¼ˆcheckAvail å’Œ reserveï¼‰å¿…é¡»åœ¨ä¸€æ¬¡äº‹åŠ¡ä¸­æ‰§è¡Œï¼Œä»¥ç¡®ä¿æˆ¿é—´åœ¨é¢„è®¢æ—¶ç¡®å®å¯ç”¨ã€‚ä¸ºäº†å¹³è¡¡è¿™äº›æƒè¡¡ï¼Œæˆ‘ä»¬æä¾›äº†å¤šå‡½æ•°äº‹åŠ¡ multi-function transactions: å¼€å‘è€…å¯ä»¥å°†å·¥ä½œæµä¸­çš„å¤šä¸ªå‡½æ•°åˆ†ç»„ï¼Œä»¥ä½œä¸ºå•ä¸ª ACID äº‹åŠ¡æ‰§è¡Œï¼Œå‰ææ˜¯å®ƒä»¬å½¢æˆå·¥ä½œæµå›¾çš„ä¸€ä¸ªè¿é€šå­å›¾ã€‚è¿™ç§è®¾è®¡ä½¿å¼€å‘è€…èƒ½å¤Ÿçµæ´»åœ°äº‹åŠ¡æ€§æ‰§è¡Œç›¸å…³æ“ä½œï¼Œä½†å°†ä¸ç›¸å…³çš„æ“ä½œåˆ†å¼€ï¼Œä»¥é¿å…è¿‡å¤§äº‹åŠ¡çš„æ€§èƒ½å¼€é”€ã€‚ é™åˆ¶è›®å¤§çš„ ","date":"2024-11-16","objectID":"/posts/paper-apiary/:5:2","tags":["Paper Reading"],"title":"Paper Reading: Apiary: A DBMS-Integrated Transactional Function-as-a-Service Framework","uri":"/posts/paper-apiary/"},{"categories":null,"content":"Fault-Tolerance Guarantees First, workflows run to completion å› æ­¤å³ä½¿è°ƒåº¦å™¨æˆ– DBMS æœåŠ¡å™¨çš„æ•…éšœå¯¼è‡´å·¥ä½œæµæ‰§è¡Œæš‚åœï¼Œå·¥ä½œæµæœ€ç»ˆä¹Ÿä¼šæ¢å¤ã€‚ Second, functions in workflows execute exactly once å› æ­¤å³ä½¿å·¥ä½œæµæˆ–å…¶ä»»ä½•å‡½æ•°å¤šæ¬¡å¤±è´¥å¹¶é‡æ–°å¯åŠ¨ï¼Œå·¥ä½œæµå¯¹åº”ç”¨ç¨‹åºçŠ¶æ€ï¼ˆåœ¨æ•°æ®åº“ä¸­ï¼‰çš„å½±å“ä¸å·¥ä½œæµä¸­çš„æ¯ä¸ªå‡½æ•°æ°å¥½æ‰§è¡Œä¸€æ¬¡çš„æ•ˆæœç›¸åŒã€‚ä¾‹å¦‚ï¼Œåœ¨é…’åº—å·¥ä½œæµä¸­ï¼ŒApiary ä¿è¯æˆ¿é—´åªè¢«é¢„è®¢ä¸€æ¬¡ï¼Œå¹¶ä¸”å¦‚æœé¢„è®¢æˆåŠŸï¼Œç¡®è®¤é‚®ä»¶æ€»æ˜¯ä¼šè¢«å‘é€ã€‚ ","date":"2024-11-16","objectID":"/posts/paper-apiary/:5:3","tags":["Paper Reading"],"title":"Paper Reading: Apiary: A DBMS-Integrated Transactional Function-as-a-Service Framework","uri":"/posts/paper-apiary/"},{"categories":null,"content":"Comparison with Related Systems åœ¨è¡¨ 1 ä¸­ï¼Œæˆ‘ä»¬å°† Apiary çš„è¯­ä¹‰ä¸ç›¸å…³ç³»ç»Ÿçš„è¯­ä¹‰è¿›è¡Œäº†æ¯”è¾ƒã€‚Apiary æä¾›çš„ä¿è¯ guarantees æ¯”å•†ä¸šç³»ç»Ÿå¦‚ AWS Step Functions[7]å’Œ Azure Durable Functions[31]è¦å¼ºå¾—å¤šã€‚è¿™äº›ç³»ç»Ÿæ”¯æŒè¿è¡Œåˆ°å®Œæˆçš„å·¥ä½œæµï¼Œä½†æ—¢ä¸æä¾›äº‹åŠ¡æ€§å‡½æ•°ä¿è¯ï¼Œä¹Ÿæ— æ³•çœ‹åˆ°åº”ç”¨ç¨‹åºæ•°æ®åº“ AWS Step Functions å£°ç§°å®ƒä¹Ÿå¯ä»¥æä¾›æ°å¥½ä¸€æ¬¡çš„è¯­ä¹‰ï¼Œä½†è¿™å®é™…ä¸Šæ˜¯ä¸€ä¸ªæœ€å¤šä¸€æ¬¡çš„ä¿è¯ï¼šå®ƒåœ¨å¤±è´¥æ—¶ä¸é‡è¯•ï¼Œè€Œæ˜¯ä¿è¯ä»»åŠ¡æ°¸è¿œä¸ä¼šè¿è¡Œè¶…è¿‡ä¸€æ¬¡ æ¯”èµ· lambdaï¼Œè¿™ç±»ç³»ç»Ÿåº”è¯¥æ›´åŠ é€‚åˆ dag ä»»åŠ¡ Apiary æä¾›çš„ä¿è¯ä¸äº‹åŠ¡æ€§ FaaS ç³»ç»Ÿå¦‚ Beldi[47]ã€Boki[22]å’Œ Transactional Statefun[15]ç±»ä¼¼ã€‚å®ƒä»¬éƒ½å…è®¸å¼€å‘è€…ä¸ºå•ä¸ªå‡½æ•°æä¾› ACID äº‹åŠ¡ä¿è¯ï¼Œå°½ç®¡ Transactional Statefun å®ç°äº†ä¸€ä¸ªæœ‰é™çš„â€œone-shotâ€æ¨¡å‹ï¼Œå…¶ä¸­äº‹åŠ¡ä¸­è¾ƒæ—©æŸ¥è¯¢çš„è¾“å‡ºä¸èƒ½ç”¨ä½œåŒä¸€äº‹åŠ¡ä¸­è¾ƒæ™šæŸ¥è¯¢çš„è¾“å…¥ã€‚æ‰€æœ‰ç³»ç»Ÿéƒ½ä¸ºå‡½æ•°æä¾›äº†æ°å¥½ä¸€æ¬¡çš„è¯­ä¹‰ï¼Œå¹¶æ”¯æŒè¿è¡Œåˆ°å®Œæˆçš„å·¥ä½œæµã€‚æ²¡æœ‰ä¸€ä¸ªç³»ç»Ÿä¸ºæ•´ä¸ªå·¥ä½œæµæä¾›äº‹åŠ¡ä¿è¯ï¼Œä½†æ‰€æœ‰ç³»ç»Ÿéƒ½æ”¯æŒåœ¨å•ä¸ªäº‹åŠ¡ä¸­è¿è¡Œå¤šä¸ªå‡½æ•°ï¼Œç±»ä¼¼äº Apiary çš„å¤šå‡½æ•°äº‹åŠ¡ã€‚åœ¨ Beldi å’Œ Boki ä¸­ï¼Œäº‹åŠ¡æ€§å‡½æ•°å¯ä»¥åŒæ­¥è°ƒç”¨å…¶ä»–å‡½æ•°ï¼Œå› æ­¤å®ƒä»¬éƒ½åœ¨ä¸€ä¸ªå¤§äº‹åŠ¡ä¸­æ‰§è¡Œã€‚åœ¨ Transactional Statefun ä¸­ï¼Œâ€œåè°ƒå™¨å‡½æ•°â€å¯ä»¥é€šè¿‡ä¸¤é˜¶æ®µæäº¤åè°ƒå¤šä¸ªå…¶ä»–å‡½æ•°ï¼Œä½¿å®ƒä»¬ä½œä¸ºä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œã€‚ç„¶è€Œï¼Œå°½ç®¡è¿™äº›ç³»ç»Ÿåœ¨è¿œç¨‹å­˜å‚¨ä¸Šæ„å»ºäº†æ˜‚è´µçš„å¤–éƒ¨äº‹åŠ¡ç®¡ç†å™¨ï¼ŒApiary é€šè¿‡ co-locating compute and data æ¥æœ€å°åŒ–äº‹åŠ¡å¼€é”€ã€‚ ä¸€ä¸ªé‡è¦çš„ç›¸å…³ç³»ç»Ÿç±»åˆ«æ˜¯å›´ç»•å› æœä¸€è‡´æ€§æ„å»ºçš„ FaaS å¹³å°ï¼Œå¦‚ Cloudburst[42]ã€Hydrocache[45]å’Œ FaaSTCC[27]ã€‚è¿™äº›ç³»ç»Ÿå°†æ•°æ®å­˜å‚¨åœ¨è¿œç¨‹é”®å€¼å­˜å‚¨ä¸­ï¼Œå¹¶ä½¿ç”¨æœ¬åœ°ç¼“å­˜æ¥æé«˜æ€§èƒ½ã€‚å®ƒä»¬æä¾›çš„æœ€å¼ºä¿è¯æ˜¯æ•´ä¸ªå·¥ä½œæµçš„ transactional causal consistencyï¼ˆTCCï¼‰ã€‚ TCC ä¿è¯å·¥ä½œæµåœ¨å®Œå…¨å®Œæˆä¹‹å‰ä¸èƒ½çœ‹åˆ°å…¶ä»–å·¥ä½œæµçš„æ•ˆæœï¼Œåªæœ‰å½“æ•´ä¸ªå·¥ä½œæµåœ¨ä¸€ä¸ªå¤šå‡½æ•°äº‹åŠ¡ä¸­æ‰§è¡Œæ—¶ï¼ŒApiary æˆ–å…¶ä»–äº‹åŠ¡æ€§ FaaS ç³»ç»Ÿæ‰èƒ½æä¾›è¿™ç§ä¿è¯ã€‚ç„¶è€Œï¼Œå¯¹äºå•ä¸ªå‡½æ•°ï¼ŒTCC æä¾›äº†ç›¸å¯¹è¾ƒå¼±çš„ä¿è¯ï¼Œå…è®¸ä¸¥é‡çš„å¼‚å¸¸ï¼Œå¦‚ stale reads å’Œ write-write conflictsã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒApiary å°†æ¯ä¸ªå‡½æ•°ä½œä¸ºå…·æœ‰å¯åºåˆ—åŒ–éš”ç¦»çš„ ACID äº‹åŠ¡è¿è¡Œï¼Œä¸å…è®¸è¿™äº›å¼‚å¸¸ã€‚æ­¤å¤–ï¼Œè¿™äº›ç³»ç»Ÿä»…æä¾›é”®å€¼ API è¿›è¡Œæ•°æ®ç®¡ç†ï¼Œè€Œ Apiary æ”¯æŒå…³ç³»æ¨¡å‹ã€‚ ","date":"2024-11-16","objectID":"/posts/paper-apiary/:5:4","tags":["Paper Reading"],"title":"Paper Reading: Apiary: A DBMS-Integrated Transactional Function-as-a-Service Framework","uri":"/posts/paper-apiary/"},{"categories":null,"content":"Fault-Tolerant Workflows run-to-completion workflow execution and exactly-once function execution. ","date":"2024-11-16","objectID":"/posts/paper-apiary/:6:0","tags":["Paper Reading"],"title":"Paper Reading: Apiary: A DBMS-Integrated Transactional Function-as-a-Service Framework","uri":"/posts/paper-apiary/"},{"categories":null,"content":"Handling Machine Failures Apiary å¿…é¡»åœ¨è°ƒåº¦å™¨æˆ– DBMS åç«¯æœåŠ¡å™¨æ•…éšœçš„æƒ…å†µä¸‹å¼ºåˆ¶æ‰§è¡Œå…¶æ‰§è¡Œä¿è¯ã€‚å¤§å¤šæ•°åˆ†å¸ƒå¼ DBMS å¯ä»¥ä»å…¶æœåŠ¡å™¨æ•…éšœä¸­æ¢å¤ï¼Œé€šå¸¸ä½¿ç”¨å¤åˆ¶å’Œæ—¥å¿—è®°å½•ã€‚ å•ä¸ªæœåŠ¡å™¨å¤±è´¥ï¼ŒDBMS å¯ä»¥é€šè¿‡æ•…éšœè½¬ç§»åˆ°å‰¯æœ¬è€Œä¸ä¼šæŸå¤±å¯ç”¨æ€§ï¼Œå› æ­¤å·¥ä½œæµæ‰§è¡Œä¸å—å½±å“ã€‚ å¤šä¸ªæœåŠ¡å™¨å¤±è´¥ï¼ŒDBMS å¯ä»¥ä»æŒä¹…æ—¥å¿—ä¸­æ¢å¤è€Œä¸ä¼šä¸¢å¤±æ•°æ®ï¼Œå› æ­¤è°ƒåº¦å™¨å¿…é¡»ç­‰åˆ°æ¢å¤å®Œæˆåå†æ¢å¤æ‰§è¡Œã€‚ å¦‚æœåœ¨å·¥ä½œæµæ‰§è¡ŒæœŸé—´è°ƒåº¦å™¨å¤±è´¥ï¼Œå…·æœ‰å¾…å¤„ç†å·¥ä½œæµè°ƒç”¨çš„å®¢æˆ·ç«¯ä¼šè¶…æ—¶ï¼Œç„¶åé‡æ–°æäº¤å…¶è°ƒç”¨ä»¥åœ¨æ–°è°ƒåº¦å™¨ä¸Šæ¢å¤éƒ¨åˆ†æ‰§è¡Œçš„å·¥ä½œæµã€‚ä¸ºäº†å”¯ä¸€æ ‡è¯†å·¥ä½œæµä»¥è¿›è¡Œæ¢å¤ï¼Œå®¢æˆ·ç«¯ä¸ºæ¯æ¬¡å·¥ä½œæµè°ƒç”¨ç”Ÿæˆä¸€ä¸ªå”¯ä¸€ IDï¼Œå¹¶ä½¿ç”¨æ•°æ®åº“ç”Ÿæˆçš„å”¯ä¸€å®¢æˆ·ç«¯ ID ä½œä¸ºå‰ç¼€ã€‚æ–°è°ƒåº¦å™¨å¿…é¡»ä»å¤±è´¥è°ƒåº¦å™¨åœæ­¢çš„åœ°æ–¹æ¢å¤å·¥ä½œæµæ‰§è¡Œï¼Œå®Œæˆå·¥ä½œæµè€Œä¸é‡æ–°æ‰§è¡Œä»»ä½•å·²å®Œæˆçš„å‡½æ•°ã€‚ç”±äº Apiary å°†å‡½æ•°ä½œä¸ºå­˜å‚¨è¿‡ç¨‹ä»¥äº‹åŠ¡æ€§æ–¹å¼è¿è¡Œï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ£€æµ‹å‡½æ•°åœ¨è¿”å›ä¹‹å‰ä»¥äº‹åŠ¡æ€§æ–¹å¼è®°å½•å…¶è¾“å‡ºï¼ˆä»¥äºŒè¿›åˆ¶æ ¼å¼åºåˆ—åŒ–ï¼‰æ¥å®ç°è¿™ä¸€ç‚¹ã€‚æ¯ä¸ªè®°å½•çš„è¾“å‡ºéƒ½ä¸ä¸€ä¸ªå”¯ä¸€å‡½æ•°è°ƒç”¨ ID ç›¸å…³è”ï¼Œè¯¥ ID æ´¾ç”Ÿè‡ªå·¥ä½œæµ IDï¼Œå¹¶ä¸”ä»…åœ¨å·¥ä½œæµçš„ç”Ÿå‘½å‘¨æœŸå†…ä¿ç•™ã€‚åœ¨é‡è¯•æœŸé—´ï¼Œè°ƒåº¦å™¨ä»å¼€å§‹æ¢å¤å·¥ä½œæµå¹¶ï¼ˆé‡æ–°ï¼‰è°ƒåº¦æ¯ä¸ªå‡½æ•°ã€‚å‡½æ•°é¦–å…ˆæ£€æŸ¥æ—©æœŸæ‰§è¡Œçš„è®°å½•ï¼Œå¦‚æœæ‰¾åˆ°ä¸€ä¸ªï¼Œåˆ™è¿”å›å®ƒè€Œä¸æ˜¯æ‰§è¡Œã€‚ å½“å‰å®ç°çš„å±€é™æ€§åœ¨äºå®ƒä¾èµ–å®¢æˆ·ç«¯æ£€æµ‹è°ƒåº¦å™¨æ•…éšœã€‚åœ¨æœªæ¥çš„å·¥ä½œä¸­ï¼Œæˆ‘ä»¬è®¡åˆ’é€šè¿‡è®©è°ƒåº¦å™¨å°†å·¥ä½œæµå…ƒæ•°æ®é¢„å†™åˆ° DBMS ä¸­ï¼Œå¹¶ä»¥å»ä¸­å¿ƒåŒ–çš„æ–¹å¼ç›¸äº’ ping ä»¥æ£€æµ‹æ•…éšœï¼ˆä½¿ç”¨ DBMS è¿›è¡Œå‘ç°ï¼‰æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ç„¶åï¼Œæ£€æµ‹åˆ°å¦ä¸€ä¸ªè°ƒåº¦å™¨æ•…éšœçš„è°ƒåº¦å™¨å¯ä»¥ä» DBMS ä¸­æ£€ç´¢å…¶å¾…å¤„ç†çš„å·¥ä½œæµå¹¶å®Œæˆå…¶æ‰§è¡Œï¼Œè€Œæ— éœ€å®¢æˆ·ç«¯å‚ä¸ã€‚ æ¯”å¦‚é…’åº—é¢„è®¢ï¼Œå¦‚æœæŸä¸ªå‡½æ•°å‡ºé”™ï¼Œå‘ç”Ÿé‡è¯•ï¼Œå”¯ä¸€æ ‡è¯† å®¢æˆ·ç«¯æ¥æ£€æµ‹è¶…æ—¶ï¼Œæ€ä¹ˆè®¾ç½®å‘¢ï¼Ÿ ","date":"2024-11-16","objectID":"/posts/paper-apiary/:6:1","tags":["Paper Reading"],"title":"Paper Reading: Apiary: A DBMS-Integrated Transactional Function-as-a-Service Framework","uri":"/posts/paper-apiary/"},{"categories":null,"content":"Optimizing Function Recording åè®®åœ¨æ•°æ®åº“ä¸­è®°å½•æ¯ä¸ªå‡½æ•°çš„è¾“å‡ºï¼Œä½†è¿™æ ·åšå¤©çœŸåœ°ä¼šå¯¼è‡´é«˜è¾¾ 2.2 å€çš„å¼€é”€ï¼Œå› ä¸ºå®ƒéœ€è¦åœ¨æ¯ä¸ªå‡½æ•°ä¸­æ‰§è¡Œé¢å¤–çš„æ•°æ®åº“æŸ¥æ‰¾å’Œæ›´æ–°ã€‚ ç„¶è€Œï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¯†åˆ«ä¸€äº›å‡½æ•°å¯ä»¥åœ¨ä¸è¿åæ°å¥½ä¸€æ¬¡è¯­ä¹‰çš„æƒ…å†µä¸‹å®‰å…¨åœ°é‡æ–°æ‰§è¡Œï¼Œä»è€Œå°†è¿™ç§å¼€é”€å‡å°‘åˆ°\u003c5%ï¼ˆåœ¨æˆ‘ä»¬æµ‹è¯•çš„æ‰€æœ‰å·¥ä½œè´Ÿè½½ä¸­ï¼‰ï¼Œå› æ­¤å®ƒä»¬çš„è¾“å‡ºä¸éœ€è¦è®°å½•ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ•´ä¸ªå·¥ä½œæµæ˜¯åªè¯»çš„ï¼Œå¦‚æœå…¶åŸå§‹æ‰§è¡Œå¤±è´¥ï¼Œå®ƒå¯ä»¥å®‰å…¨åœ°é‡æ–°æ‰§è¡Œï¼Œå› æ­¤æˆ‘ä»¬ä¸éœ€è¦è®°å½•å…¶ä»»ä½•å‡½æ•°ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¼€å‘äº†ä¸€ç§æ–°çš„ç®—æ³•ï¼Œç§°ä¸ºé€‰æ‹©æ€§å‡½æ•°è®°å½• selective function recordingï¼ˆSFRï¼‰ï¼Œä½¿ç”¨é™æ€åˆ†æåœ¨å·¥ä½œæµæ³¨å†Œæ—¶ç¡®å®šå“ªäº›å‡½æ•°å¿…é¡»è®°å½•ï¼Œå“ªäº›å¯ä»¥å®‰å…¨åœ°é‡æ–°æ‰§è¡Œã€‚ æˆ‘ä»¬å¿…é¡»è®°å½•ä»»ä½•æ‰§è¡Œ DBMS å†™æ“ä½œçš„å‡½æ•°ï¼Œä»¥ç¡®ä¿å†™æ“ä½œä¸ä¼šé‡æ–°æ‰§è¡Œï¼Œæ­¤å¤–ï¼Œå¦‚æœå­˜åœ¨ä»å®ƒåˆ°å¤šä¸ªä¸åŒè®°å½•å‡½æ•°æˆ–è‡³å°‘ä¸€ä¸ªè®°å½•å‡½æ•°å’Œæ±‡çš„ä¸ç›¸äº¤è·¯å¾„ï¼Œæˆ‘ä»¬å¿…é¡»è®°å½•ä¸€ä¸ªåªè¯»å‡½æ•°ã€‚ æˆ‘ä»¬åœ¨ç®—æ³• 1 ä¸­æ¦‚è¿°äº† SFR Correctness: æˆ‘ä»¬ä¸ä¿è¯æ‰¾åˆ°æœ€å°çš„è®°å½•å‡½æ•°é›† æ²¡ç»™è¯æ˜ï¼Œçœ‹ä¸Šå»æ˜¯ä¸ªæ‹“æ‰‘æ’åºï¼Œæ‰¾ç›¸å…³è”çš„ï¼Œä½†æ˜¯è¯´æ—¶é—´å¤æ‚åº¦å¾ˆä½ï¼Œæœ‰ç‚¹å¥‡æ€ª Complexity: æˆ‘ä»¬å¯ä»¥è®°å¿†åŒ–å·¥ä½œæµå›¾æœç´¢ï¼Œå› æ­¤ï¼ŒSFR çš„æ—¶é—´å¤æ‚åº¦ä¸º O(V + E)ï¼Œå…¶ä¸­ V æ˜¯å‡½æ•°çš„æ•°é‡ï¼ŒE æ˜¯å·¥ä½œæµå›¾ä¸­çš„è¾¹æ•°ã€‚æˆ‘ä»¬åªåœ¨æ¯æ¬¡å·¥ä½œæµæ³¨å†Œæ—¶è¿è¡Œæ­¤ç®—æ³•ä¸€æ¬¡ã€‚ ","date":"2024-11-16","objectID":"/posts/paper-apiary/:6:2","tags":["Paper Reading"],"title":"Paper Reading: Apiary: A DBMS-Integrated Transactional Function-as-a-Service Framework","uri":"/posts/paper-apiary/"},{"categories":null,"content":"Handling Function Failures Apiary è¿˜å¿…é¡»åœ¨å•ä¸ªå‡½æ•°å‡ºç°æ•…éšœæˆ–é”™è¯¯çš„æƒ…å†µä¸‹å¼ºåˆ¶æ‰§è¡Œå…¶æ‰§è¡Œä¿è¯ã€‚ ","date":"2024-11-16","objectID":"/posts/paper-apiary/:6:3","tags":["Paper Reading"],"title":"Paper Reading: Apiary: A DBMS-Integrated Transactional Function-as-a-Service Framework","uri":"/posts/paper-apiary/"},{"categories":null,"content":"Observability å¼€å‘è€…é€šå¸¸éœ€è¦äº†è§£åº”ç”¨ç¨‹åºå¦‚ä½•ä¸æ•°æ®äº¤äº’çš„ä¿¡æ¯ï¼Œä»¥ä¾¿ç”¨äºè°ƒè¯•ã€ç›‘æ§å’Œå®¡è®¡ç”¨é€”ï¼Œä¾‹å¦‚éªŒè¯ç¨‹åºæ˜¯å¦æœªä¸å½“è®¿é—®ç§æœ‰æ•°æ® ","date":"2024-11-16","objectID":"/posts/paper-apiary/:7:0","tags":["Paper Reading"],"title":"Paper Reading: Apiary: A DBMS-Integrated Transactional Function-as-a-Service Framework","uri":"/posts/paper-apiary/"},{"categories":null,"content":"Observability Interface Apiary æ£€æµ‹å·¥ä½œæµä»¥è·Ÿè¸ªå·¥ä½œæµå’Œå‡½æ•°æ‰§è¡Œçš„å†å²ï¼Œæ£€æµ‹æŸ¥è¯¢ä»¥è®°å½•æ•°æ®åº“æ“ä½œï¼Œç„¶åå°†è¿™äº›ä¿¡æ¯ç»“åˆèµ·æ¥ï¼Œåˆ›å»ºåº”ç”¨ç¨‹åºä¸æ•°æ®äº¤äº’çš„å®Œæ•´è®°å½•ã€‚ è·Ÿè¸ªå±‚è‡ªåŠ¨å°†æ­¤ä¿¡æ¯ spool åˆ°åˆ†ææ•°æ®åº“ï¼ˆåœ¨æˆ‘ä»¬çš„å®ç°ä¸­ï¼ŒVertica[43]ï¼‰ä»¥è¿›è¡Œé•¿æœŸå­˜å‚¨å’Œåˆ†æ ","date":"2024-11-16","objectID":"/posts/paper-apiary/:7:1","tags":["Paper Reading"],"title":"Paper Reading: Apiary: A DBMS-Integrated Transactional Function-as-a-Service Framework","uri":"/posts/paper-apiary/"},{"categories":null,"content":"Implementing Tracing Layer æˆ‘ä»¬åˆ©ç”¨ Apiary ä¸æ•°æ®çš„ç´§å¯†é›†æˆï¼Œå°†æ•°æ®åº“æŠ€æœ¯ï¼ˆå¦‚å˜æ›´æ•°æ®æ•è·å’ŒæŸ¥è¯¢é‡å†™[4, 20]ï¼‰é€‚åº”åˆ° FaaS ç¯å¢ƒä¸­ï¼Œæ„å»ºä¸€ä¸ªè·Ÿè¸ªå±‚ï¼Œä»¥é«˜æ•ˆæ•è·åº”ç”¨ç¨‹åºä¸æ•°æ®çš„äº¤äº’ã€‚ å½“ä¸€ä¸ªå‡½æ•°æ‰§è¡Œæ—¶ï¼Œè·Ÿè¸ªå±‚å‘ FunctionInvocations æ·»åŠ ä¸€ä¸ªæ¡ç›®ã€‚ å®é™…ä¸Šåº”è¯¥å°±æ˜¯ logï¼Ÿ CDC + å†™å…¥ ","date":"2024-11-16","objectID":"/posts/paper-apiary/:7:2","tags":["Paper Reading"],"title":"Paper Reading: Apiary: A DBMS-Integrated Transactional Function-as-a-Service Framework","uri":"/posts/paper-apiary/"},{"categories":null,"content":"Implementation ","date":"2024-11-16","objectID":"/posts/paper-apiary/:8:0","tags":["Paper Reading"],"title":"Paper Reading: Apiary: A DBMS-Integrated Transactional Function-as-a-Service Framework","uri":"/posts/paper-apiary/"},{"categories":null,"content":"Choosing a DBMS Apiary éœ€è¦ä¸€ä¸ªå…·æœ‰ä»¥ä¸‹å››ä¸ªç‰¹æ€§çš„åˆ†å¸ƒå¼ DBMSï¼š æ”¯æŒ ACID äº‹åŠ¡ã€‚ æ”¯æŒåœ¨å­˜å‚¨è¿‡ç¨‹ä¸­ä»¥äº‹åŠ¡æ€§æ–¹å¼è¿è¡Œé SQL è¯­è¨€çš„ç”¨æˆ·ä»£ç ã€‚ æ”¯æŒ change data captureï¼ˆç”¨äºå¯è§‚å¯Ÿæ€§ï¼ŒÂ§5.2ï¼‰ã€‚ æ”¯æŒå¼¹æ€§ DBMS é›†ç¾¤è°ƒæ•´å¤§å°ã€‚ å°½ç®¡è®¸å¤š DBMS å…·æœ‰è¿™äº›ç‰¹æ€§ï¼ˆä¾‹å¦‚ï¼ŒSingleStore[40]ï¼ŒYugabyte[46]ï¼‰ï¼Œæˆ‘ä»¬é€‰æ‹©äº† VoltDBï¼Œå› ä¸ºå®ƒèƒ½æœ€æœ‰æ•ˆåœ°æ‰§è¡Œæˆ‘ä»¬çš„ç›®æ ‡å·¥ä½œè´Ÿè½½ã€‚å¤§å¤šæ•°åˆ†å¸ƒå¼ DBMSï¼ŒåŒ…æ‹¬ VoltDBï¼Œé€šè¿‡æ•°æ®åˆ†åŒºæ¥æ‰©å±•ã€‚æˆ‘ä»¬è§‚å¯Ÿåˆ°ï¼Œåœ¨æˆ‘ä»¬çš„ç›®æ ‡å·¥ä½œè´Ÿè½½ä¸­ï¼Œå‡ ä¹æ‰€æœ‰äº‹åŠ¡éƒ½æ˜¯å•ç«™ç‚¹[24]çš„ï¼Œå¹¶ä¸”åªè®¿é—®å•ä¸ªåˆ†åŒºä¸­çš„æ•°æ®ã€‚VoltDB é«˜æ•ˆåœ°æ‰§è¡Œè¿™äº›äº‹åŠ¡ï¼Œåœ¨å†…å­˜ä¸­è¿è¡Œå®ƒä»¬åˆ°å®Œæˆï¼Œè€Œä¸éœ€è¦é”ã€‚ç„¶è€Œï¼ŒVoltDB çš„ä¸€ä¸ªé™åˆ¶æ˜¯å®ƒåœ¨å¤šç«™ç‚¹äº‹åŠ¡ä¸­æ•ˆç‡è¾ƒä½ï¼›ä¸€ä¸ªäº‹åŠ¡å¿…é¡»æŒæœ‰å…¨å±€é”æ‰èƒ½è®¿é—®å¤šä¸ªåˆ†åŒºä¸Šçš„æ•°æ®ã€‚æœ€è¿‘æœ‰ä¸€äº›ç ”ç©¶è¯•å›¾è§£å†³è¿™ä¸ªé—®é¢˜[49]ï¼Œä½†æˆ‘ä»¬æŠŠé«˜æ•ˆå®ç° multi-sited transactions å¤šç«™ç‚¹äº‹åŠ¡ç•™åˆ°æœªæ¥çš„å·¥ä½œä¸­ã€‚ ä¹‹å‰è§è¿‡ä¸€äº› serverless æ¡†æ¶ä¹Ÿç”¨ voltdb å®ç°ï¼Œæœ‰æœºä¼šçœ‹ä¸€ä¸‹ voltdb å¤šç«™ç‚¹äº‹åŠ¡ï¼šäº‹åŠ¡æ¶‰åŠå¤šä¸ªåˆ†åŒºçš„æ•°æ®ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸‹è®¢å•æ—¶ï¼Œéœ€è¦åŒæ—¶æ›´æ–°åº“å­˜å’Œè®¢å•ä¿¡æ¯ï¼Œè€Œè¿™ä¸¤ä¸ªæ•°æ®å¯èƒ½ä½äºä¸åŒçš„åˆ†åŒºã€‚ ","date":"2024-11-16","objectID":"/posts/paper-apiary/:8:1","tags":["Paper Reading"],"title":"Paper Reading: Apiary: A DBMS-Integrated Transactional Function-as-a-Service Framework","uri":"/posts/paper-apiary/"},{"categories":null,"content":"Compilation å½“å¼€å‘è€…åœ¨ Apiary ä¸­æ³¨å†Œå‡½æ•°å’Œå·¥ä½œæµæ—¶ï¼Œå®ƒå°†æ¯ä¸ªå‡½æ•°ç¼–è¯‘ä¸ºä¸€ä¸ªå­˜å‚¨è¿‡ç¨‹ï¼Œè¿™æ˜¯ä¸€ä¸ªåœ¨é SQL è¯­è¨€ä¸­è¿è¡Œçš„æœ¬åœ° DBMS äº‹åŠ¡ã€‚ åœ¨æˆ‘ä»¬çš„å®ç°ä¸­ï¼Œå‡½æ•°æä¾›çš„ä¿è¯ä¸ VoltDB äº‹åŠ¡ç›¸åŒï¼šå®ƒä»¬æ˜¯ ACID å’Œå¯åºåˆ—åŒ–çš„ã€‚ä¸ºäº†å®ç°å¤šå‡½æ•°äº‹åŠ¡ï¼ŒApiary å°†æ‰€æœ‰æ¶‰åŠçš„å‡½æ•°ç¼–è¯‘ä¸ºä¸€ä¸ªå­˜å‚¨è¿‡ç¨‹ã€‚ç¼–è¯‘åˆ†ä¸¤æ­¥è¿›è¡Œã€‚é¦–å…ˆï¼ŒApiary æ£€æµ‹æ¯ä¸ªå‡½æ•°ä»¥æ•è·åº”ç”¨ç¨‹åºä¸æ•°æ®åº“çš„äº¤äº’ï¼ˆÂ§5ï¼‰ï¼Œå¹¶è®°å½•å…¶æ‰§è¡Œä»¥å®ç°æ°å¥½ä¸€æ¬¡è¯­ä¹‰ï¼ˆÂ§4ï¼‰ã€‚ç„¶åï¼ŒApiary å°†æ£€æµ‹åçš„å‡½æ•°ï¼ˆæˆ–å¤šå‡½æ•°äº‹åŠ¡ï¼‰ç¼–è¯‘ä¸ºå­˜å‚¨è¿‡ç¨‹ï¼Œå¹¶å°†å…¶æ³¨å†Œåˆ° DBMS ä¸­ã€‚ Apiary æ‰©å±•äº† DBMS å­˜å‚¨è¿‡ç¨‹æ¥å£ï¼Œå› æ­¤å®ƒå¯ä»¥ç¼–è¯‘ä»»ä½•ä½¿ç”¨å…¶ç¼–ç¨‹æ¥å£ï¼ˆå›¾ 5ï¼‰å¹¶éµå¾ªÂ§3.1 ä¸­æ¦‚è¿°çš„è§„åˆ™çš„å‡½æ•°ã€‚æ­¤å¤–ï¼Œåœ¨æˆ‘ä»¬çš„åŸºäº VoltDB çš„å®ç°ä¸­ï¼Œç”±äº VoltDB å¯ä»¥é«˜æ•ˆæ‰§è¡Œå•ç«™ç‚¹äº‹åŠ¡ï¼Œæˆ‘ä»¬è®©å¼€å‘è€…æŒ‡å®šä¸€ä¸ªå‡½æ•°ï¼ˆæˆ–å¤šå‡½æ•°äº‹åŠ¡ï¼‰æ˜¯å¦æ˜¯å•ç«™ç‚¹çš„ï¼Œå¦‚æœæ˜¯ï¼Œå“ªä¸ªå‡½æ•°è¾“å…¥æŒ‡å®šäº†ç«™ç‚¹ã€‚ ","date":"2024-11-16","objectID":"/posts/paper-apiary/:8:2","tags":["Paper Reading"],"title":"Paper Reading: Apiary: A DBMS-Integrated Transactional Function-as-a-Service Framework","uri":"/posts/paper-apiary/"},{"categories":null,"content":"Evaluation physically co-locating compute and data, 7â€“68Ã— and research systems by 2â€“27Ã— By selectively instrumenting functions using the SFR algorithm, Apiary provides fault tolerance with overhead of \u003c5% compared to 2.2Ã— for a naive solution By instrumenting database operations and functions, Apiary captures information on application-database interactions critical to observability with overhead of \u003c15% as compared to 92% with manual logging ","date":"2024-11-16","objectID":"/posts/paper-apiary/:9:0","tags":["Paper Reading"],"title":"Paper Reading: Apiary: A DBMS-Integrated Transactional Function-as-a-Service Framework","uri":"/posts/paper-apiary/"},{"categories":null,"content":"Experimental Setup ","date":"2024-11-16","objectID":"/posts/paper-apiary/:9:1","tags":["Paper Reading"],"title":"Paper Reading: Apiary: A DBMS-Integrated Transactional Function-as-a-Service Framework","uri":"/posts/paper-apiary/"},{"categories":null,"content":"Baselines Microservice benchmark information ä»¥åå¯ä»¥ç”¨åˆ° ä¸ºä»€ä¹ˆ Apiary çš„å»¶è¿Ÿè¦æ¯” rpc æ›´ä¼˜ç§€ä¸€ç‚¹å‘¢ï¼Ÿ ä¸ªäººè®¤ä¸ºå°±æ˜¯å°‘äº†ä¸€å±‚é€šä¿¡ã€‚ã€‚ç›´æ¥è®¿é—®æ•°æ®åº“çš„æ„æ€ï¼Ÿ ","date":"2024-11-16","objectID":"/posts/paper-apiary/:9:2","tags":["Paper Reading"],"title":"Paper Reading: Apiary: A DBMS-Integrated Transactional Function-as-a-Service Framework","uri":"/posts/paper-apiary/"},{"categories":null,"content":"Microservice Workloads Shopã€‚è¿™ä¸ªåŸºå‡†æµ‹è¯•æ”¹ç¼–è‡ª Google Cloud çš„æ¼”ç¤º[19]ï¼Œæ¨¡æ‹Ÿäº†ä¸€ä¸ªæœåŠ¡ï¼Œç”¨æˆ·åœ¨å…¶ä¸­æµè§ˆåœ¨çº¿å•†åº—ï¼Œæ›´æ–°è´­ç‰©è½¦ï¼Œå¹¶ç»“è´¦å•†å“ã€‚ Hotelã€‚è¿™ä¸ªåŸºå‡†æµ‹è¯•æ¥è‡ª DeathStarBench[18]ï¼Œæ¨¡æ‹Ÿäº†æœç´¢å’Œé¢„è®¢é…’åº—æˆ¿é—´ã€‚æˆ‘ä»¬çš„å®ç°åŒ…å«ä¸€ä¸ªå¤šå‡½æ•°äº‹åŠ¡ï¼Œç±»ä¼¼äºå›¾ 6ï¼Œå…¶ä¸­éªŒè¯å’Œé¢„è®¢æ˜¯äº‹åŠ¡æ€§æ‰§è¡Œçš„ã€‚ Retwisã€‚è¿™ä¸ªåŸºå‡†æµ‹è¯•æ¥è‡ª Redis[38] ","date":"2024-11-16","objectID":"/posts/paper-apiary/:9:3","tags":["Paper Reading"],"title":"Paper Reading: Apiary: A DBMS-Integrated Transactional Function-as-a-Service Framework","uri":"/posts/paper-apiary/"},{"categories":null,"content":"End-to-End Benchmarks Apiary ä¼˜äº RPC æœåŠ¡å™¨åŸºå‡†çš„åŸå› æ˜¯å‡å°‘äº†é€šä¿¡å¼€é”€ï¼šå› ä¸ºå®ƒå°†æœåŠ¡ç¼–è¯‘ä¸ºåœ¨æ•°æ®åº“æœåŠ¡å™¨ä¸­è¿è¡Œçš„å­˜å‚¨è¿‡ç¨‹ï¼Œæ‰€ä»¥æ‰§è¡Œæ•°æ®åº“æ“ä½œæ‰€éœ€çš„å¾€è¿”æ¬¡æ•°æ›´å°‘ ","date":"2024-11-16","objectID":"/posts/paper-apiary/:9:4","tags":["Paper Reading"],"title":"Paper Reading: Apiary: A DBMS-Integrated Transactional Function-as-a-Service Framework","uri":"/posts/paper-apiary/"},{"categories":null,"content":"Comparing with Boki and Cloudburst Retwis æ˜¯è¯»å¯†é›†å‹çš„ï¼Œå› æ­¤ä¸ºäº†è¯„ä¼°å†™æ“ä½œçš„æ€§èƒ½å½±å“ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªå¾®åŸºå‡†æµ‹è¯•ï¼Œè¯¥æµ‹è¯•æ£€ç´¢å¹¶é€’å¢ä¸é”®å…³è”çš„è®¡æ•°å™¨ã€‚ æ²¡çœ‹è¿‡è¿™ä¸¤ç¯‡ ä½†æ˜¯ apiary çš„æ€§èƒ½å¥½åˆ°ç¦»è°±ï¼Œè®¤ä¸º cloudburst ç”¨ py å®ç°éƒ½æœ¬åœ°ç¼“å­˜æ…¢ï¼Œvoltdb è¯»æ›´å¿«ï¼Œå¤§é‡è¯»çš„æƒ…å†µæ›´å¥½ ","date":"2024-11-16","objectID":"/posts/paper-apiary/:9:5","tags":["Paper Reading"],"title":"Paper Reading: Apiary: A DBMS-Integrated Transactional Function-as-a-Service Framework","uri":"/posts/paper-apiary/"},{"categories":null,"content":"Fault-Tolerant Workflows Performance Analysis ","date":"2024-11-16","objectID":"/posts/paper-apiary/:9:6","tags":["Paper Reading"],"title":"Paper Reading: Apiary: A DBMS-Integrated Transactional Function-as-a-Service Framework","uri":"/posts/paper-apiary/"},{"categories":null,"content":"Enhancing Observability with Apiary å…¶å®æŒ‰ç†æ¥è¯´ï¼Œæˆ‘è§‰å¾— dbos/apiary æ›´å‡ºå½©çš„åœ°æ–¹æ˜¯ tracing å’Œ fault tolerance ä½†è®ºæ–‡å´æ²¡å¤§é‡è®²ï¼Œæ•´ä¸ªç»“æ„ä¹Ÿä¸æ˜¯å¾ˆå®Œå–„ï¼Œæ²¡ç¬¬ä¸€æ¬¡çœ‹ dbos é‚£ä¹ˆæœ‰æ„æ€ï¼Œæ¯”å¦‚è¯´ time travel, OpenTelemetry traces ","date":"2024-11-16","objectID":"/posts/paper-apiary/:9:7","tags":["Paper Reading"],"title":"Paper Reading: Apiary: A DBMS-Integrated Transactional Function-as-a-Service Framework","uri":"/posts/paper-apiary/"},{"categories":null,"content":"Cost Analysis ","date":"2024-11-16","objectID":"/posts/paper-apiary/:9:8","tags":["Paper Reading"],"title":"Paper Reading: Apiary: A DBMS-Integrated Transactional Function-as-a-Service Framework","uri":"/posts/paper-apiary/"},{"categories":null,"content":"Delta Lake: High-Performance ACID Table Storage over Cloud Object Stores https://github.com/delta-io/delta data lake? delta lake? data warehouse? databricks çš„è®ºæ–‡ DeltaLake ç±»ä¼¼çš„äº§å“æœ‰ Hudi, Iceberg, Apache Paimon å…¶ä»–è®ºæ–‡ç¬”è®° https://www.cnblogs.com/Aitozi/p/17552466.html å¤§æ•°æ®æŠ€æœ¯æ¢ä»£ä¹Ÿå¤ªå¿«äº†ï¼Œä½†åº•å±‚åŸç†æˆ‘è¿˜æ˜¯ä¸€é—®ä¸‰ä¸çŸ¥ï¼Œè¿˜å¾—ç»ƒ Towards Multi-Table Transactions in Delta Lake Delta 4.0 å°è¯•è§£å†³å¤šè¡¨äº‹åŠ¡çš„é—®é¢˜ï¼Œæ„Ÿè§‰æœ‰ç‚¹åƒ 2PC https://www.databricks.com/dataaisummit/session/towards-multi-table-transactions-delta-lake ","date":"2024-11-11","objectID":"/posts/paper-delta-lake/:1:0","tags":["Paper Reading"],"title":"Paper Reading: Delta Lake High-Performance ACID Table Storage over Cloud Object Stores","uri":"/posts/paper-delta-lake/"},{"categories":null,"content":"Abstract äº‘å¯¹è±¡å­˜å‚¨ï¼ˆå¦‚ Amazon S3ï¼‰æ˜¯åœ°çƒä¸Šæœ€å¤§ä¸”æœ€å…·æˆæœ¬æ•ˆç›Šçš„å­˜å‚¨ç³»ç»Ÿä¹‹ä¸€ ç„¶è€Œï¼Œå®ƒä»¬ä½œä¸ºé”®å€¼å­˜å‚¨çš„å®ç°æ–¹å¼ä½¿å¾—å®ç° ACID äº‹åŠ¡å’Œé«˜æ€§èƒ½å˜å¾—å›°éš¾ï¼šå…ƒæ•°æ®æ“ä½œï¼ˆå¦‚åˆ—å‡ºå¯¹è±¡ï¼‰æˆæœ¬é«˜æ˜‚ï¼Œä¸€è‡´æ€§ä¿è¯æœ‰é™ã€‚ åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº† Delta Lakeï¼Œè¿™æ˜¯ä¸€ä¸ªå¼€æºçš„ ACID è¡¨å­˜å‚¨å±‚ï¼Œæœ€åˆç”± Databricks å¼€å‘ï¼Œç”¨äºäº‘å¯¹è±¡å­˜å‚¨ã€‚Delta Lake ä½¿ç”¨ä¸€ä¸ªäº‹åŠ¡æ—¥å¿—ï¼Œè¯¥æ—¥å¿—è¢«å‹ç¼©ä¸º Apache Parquet æ ¼å¼ï¼Œä»¥æä¾› ACID å±æ€§ã€æ—¶é—´æ—…è¡Œï¼Œä»¥åŠå¯¹å¤§å‹è¡¨æ ¼æ•°æ®é›†ï¼ˆä¾‹å¦‚ï¼Œèƒ½å¤Ÿå¿«é€Ÿæœç´¢ä¸æŸ¥è¯¢ç›¸å…³çš„æ•°åäº¿ä¸ªè¡¨åˆ†åŒºï¼‰çš„å…ƒæ•°æ®æ“ä½œçš„æ˜¾è‘—åŠ é€Ÿã€‚ å®ƒè¿˜åˆ©ç”¨è¿™ä¸€è®¾è®¡æä¾›é«˜çº§åŠŸèƒ½ï¼Œå¦‚è‡ªåŠ¨æ•°æ®å¸ƒå±€ä¼˜åŒ–ã€æ›´æ–°æ’å…¥ã€ç¼“å­˜å’Œå®¡è®¡æ—¥å¿—ã€‚Delta Lake è¡¨å¯ä»¥ä» Apache Sparkã€Hiveã€Prestoã€Redshift å’Œå…¶ä»–ç³»ç»Ÿè®¿é—®ã€‚ data lake æå‡ºæ¯”è¾ƒæ—©ï¼Œè€Œ delta lake æ”¯æŒ ACID ","date":"2024-11-11","objectID":"/posts/paper-delta-lake/:2:0","tags":["Paper Reading"],"title":"Paper Reading: Delta Lake High-Performance ACID Table Storage over Cloud Object Stores","uri":"/posts/paper-delta-lake/"},{"categories":null,"content":"INTRODUCTION å› æ­¤ï¼Œè®¸å¤šç»„ç»‡ç°åœ¨ä½¿ç”¨ use cloud object stores to manage large structured datasets in data warehouses and data lakesã€‚ä¸»è¦çš„å¼€æºâ€œå¤§æ•°æ®â€ç³»ç»Ÿï¼ŒåŒ…æ‹¬ Apache Sparkã€Hive å’Œ Prestoï¼Œæ”¯æŒä½¿ç”¨ Apache Parquet å’Œ ORC [13, 12]ç­‰æ–‡ä»¶æ ¼å¼è¯»å†™äº‘å¯¹è±¡å­˜å‚¨ã€‚å•†ä¸šæœåŠ¡ï¼ŒåŒ…æ‹¬ AWS Athenaã€Google BigQuery å’Œ Redshift Spectrumï¼Œä¹Ÿå¯ä»¥ç›´æ¥æŸ¥è¯¢è¿™äº›ç³»ç»Ÿå’Œè¿™äº›å¼€æ”¾æ–‡ä»¶æ ¼å¼ã€‚ ä¸å¹¸çš„æ˜¯ï¼Œå°½ç®¡è®¸å¤šç³»ç»Ÿæ”¯æŒè¯»å†™äº‘å¯¹è±¡å­˜å‚¨ï¼Œä½†åœ¨è¿™äº›ç³»ç»Ÿä¸Šå®ç°é«˜æ€§èƒ½å’Œå¯å˜çš„è¡¨å­˜å‚¨æ˜¯å…·æœ‰æŒ‘æˆ˜æ€§çš„ï¼Œè¿™ä½¿å¾—åœ¨è¿™äº›ç³»ç»Ÿä¸Šå®ç°æ•°æ®ä»“åº“åŠŸèƒ½å˜å¾—å›°éš¾ã€‚ä¸ HDFS [5]ç­‰åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿæˆ– DBMS ä¸­çš„è‡ªå®šä¹‰å­˜å‚¨å¼•æ“ä¸åŒï¼Œå¤§å¤šæ•°äº‘å¯¹è±¡å­˜å‚¨ä»…ä»…æ˜¯é”®å€¼å­˜å‚¨ï¼Œæ²¡æœ‰è·¨é”®ä¸€è‡´æ€§ä¿è¯ã€‚å®ƒä»¬çš„æ€§èƒ½ç‰¹æ€§ä¹Ÿä¸åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿå¤§ä¸ç›¸åŒï¼Œéœ€è¦ç‰¹åˆ«æ³¨æ„ã€‚ äº‘å¯¹è±¡å­˜å‚¨å’Œåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ äº‘å¯¹è±¡å­˜å‚¨åº•å±‚å¯ä»¥æ˜¯ kv ä¹Ÿå¯ä»¥æ˜¯åˆ«çš„ï¼ŒS3 åº”è¯¥æ˜¯æ²¡å…¬å¼€åº•å±‚æ˜¯ä»€ä¹ˆ etcd, dynamoDB, redis å°±å…¸å‹çš„åˆ†å¸ƒå¼é”®å€¼å­˜å‚¨ï¼Œä¸€èˆ¬é€šè¿‡ä¸Šå±‚æä¾› ACID hdfs, ceph æ˜¯å…¸å‹çš„åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼Œ åœ¨äº‘å¯¹è±¡å­˜å‚¨ä¸­å­˜å‚¨å…³ç³»æ•°æ®é›†çš„æœ€å¸¸è§æ–¹å¼æ˜¯ä½¿ç”¨ Parquet å’Œ ORC ç­‰åˆ—å¼æ–‡ä»¶æ ¼å¼ï¼Œï¼Œå…¶ä¸­æ¯ä¸ªè¡¨å­˜å‚¨ä¸ºä¸€ç»„å¯¹è±¡ï¼ˆParquet æˆ– ORCâ€œæ–‡ä»¶â€ï¼‰ï¼Œå¯èƒ½æŒ‰æŸäº›å­—æ®µï¼ˆä¾‹å¦‚ï¼Œæ¯ä¸ªæ—¥æœŸçš„ä¸€ç»„å•ç‹¬å¯¹è±¡ï¼‰èšç±»ä¸ºâ€œåˆ†åŒºâ€ã€‚åªè¦å¯¹è±¡æ–‡ä»¶é€‚åº¦å¤§ï¼Œè¿™ç§æ–¹æ³•å¯ä»¥ä¸ºæ‰«æå·¥ä½œè´Ÿè½½æä¾›å¯æ¥å—çš„æ€§èƒ½ã€‚ç„¶è€Œï¼Œå®ƒä¸ºæ›´å¤æ‚çš„å·¥ä½œè´Ÿè½½å¸¦æ¥äº†æ­£ç¡®æ€§å’Œæ€§èƒ½æŒ‘æˆ˜ã€‚é¦–å…ˆï¼Œç”±äºå¤šå¯¹è±¡æ›´æ–°ä¸æ˜¯åŸå­çš„ï¼ŒæŸ¥è¯¢ä¹‹é—´æ²¡æœ‰éš”ç¦»ï¼šä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªæŸ¥è¯¢éœ€è¦æ›´æ–°è¡¨ä¸­çš„å¤šä¸ªå¯¹è±¡ï¼ˆä¾‹å¦‚ï¼Œåˆ é™¤æ‰€æœ‰ Parquet æ–‡ä»¶ä¸­å…³äºä¸€ä¸ªç”¨æˆ·çš„è®°å½•ï¼‰ï¼Œè¯»è€…å°†åœ¨æŸ¥è¯¢é€ä¸ªæ›´æ–°æ¯ä¸ªå¯¹è±¡æ—¶çœ‹åˆ°éƒ¨åˆ†æ›´æ–°ã€‚å›æ»šå†™æ“ä½œä¹Ÿå¾ˆå›°éš¾ï¼šå¦‚æœæ›´æ–°æŸ¥è¯¢å´©æºƒï¼Œè¡¨å°†å¤„äºæŸåçŠ¶æ€ã€‚å…¶æ¬¡ï¼Œå¯¹äºåŒ…å«æ•°ç™¾ä¸‡ä¸ªå¯¹è±¡çš„å¤§å‹è¡¨ï¼Œå…ƒæ•°æ®æ“ä½œæˆæœ¬é«˜æ˜‚ã€‚ä¾‹å¦‚ï¼ŒParquet æ–‡ä»¶åŒ…å«å¸¦æœ‰æœ€å°/æœ€å¤§ç»Ÿè®¡ä¿¡æ¯çš„é¡µè„šï¼Œå¯ç”¨äºåœ¨é€‰æ‹©æ€§æŸ¥è¯¢ä¸­è·³è¿‡è¯»å–å®ƒä»¬ã€‚åœ¨ HDFS ä¸Šè¯»å–è¿™æ ·çš„é¡µè„šå¯èƒ½åªéœ€å‡ æ¯«ç§’ï¼Œä½†äº‘å¯¹è±¡å­˜å‚¨çš„å»¶è¿Ÿè¦é«˜å¾—å¤šï¼Œä»¥è‡³äºè¿™äº›æ•°æ®è·³è¿‡æ£€æŸ¥å¯èƒ½æ¯”å®é™…æŸ¥è¯¢èŠ±è´¹æ›´é•¿æ—¶é—´ã€‚ Parquet åˆ—å­˜ æ ¹æ®æˆ‘ä»¬ä¸äº‘å®¢æˆ·åˆä½œçš„ç»éªŒï¼Œè¿™äº›ä¸€è‡´æ€§å’Œæ€§èƒ½é—®é¢˜ä¸ºä¼ä¸šæ•°æ®å›¢é˜Ÿå¸¦æ¥äº†é‡å¤§æŒ‘æˆ˜ã€‚å¤§å¤šæ•°ä¼ä¸šæ•°æ®é›†æ˜¯æŒç»­æ›´æ–°çš„ï¼Œå› æ­¤å®ƒä»¬éœ€è¦åŸå­å†™å…¥çš„è§£å†³æ–¹æ¡ˆï¼›å¤§å¤šæ•°å…³äºç”¨æˆ·çš„æ•°æ®é›†éœ€è¦è¡¨èŒƒå›´çš„æ›´æ–°æ¥å®æ–½éšç§æ”¿ç­–ï¼Œå¦‚ GDPR åˆè§„ [27]ï¼›å³ä½¿æ˜¯çº¯ç²¹çš„å†…éƒ¨æ•°æ®é›†ä¹Ÿå¯èƒ½éœ€è¦æ›´æ–°æ¥ä¿®å¤é”™è¯¯æ•°æ®ã€åˆå¹¶å»¶è¿Ÿè®°å½•ç­‰ã€‚æ®ä¼ é—»ï¼Œåœ¨ Databricks äº‘æœåŠ¡ï¼ˆ2014-2016 å¹´ï¼‰çš„æœ€åˆå‡ å¹´ï¼Œæˆ‘ä»¬æ”¶åˆ°çš„çº¦ä¸€åŠæ”¯æŒå‡çº§æ˜¯ç”±äºäº‘å­˜å‚¨ç­–ç•¥å¯¼è‡´çš„æ•°æ®æŸåã€ä¸€è‡´æ€§æˆ–æ€§èƒ½é—®é¢˜ï¼ˆä¾‹å¦‚ï¼Œæ’¤é”€å´©æºƒçš„æ›´æ–°ä½œä¸šçš„å½±å“ï¼Œæˆ–æé«˜è¯»å–æ•°ä¸‡ä¸ªå¯¹è±¡çš„æŸ¥è¯¢çš„æ€§èƒ½ï¼‰ã€‚ ä¸ºäº†è§£å†³è¿™äº›æŒ‘æˆ˜ï¼Œæˆ‘ä»¬è®¾è®¡äº† Delta Lakeï¼Œè¿™æ˜¯ä¸€ä¸ªåœ¨äº‘å¯¹è±¡å­˜å‚¨ä¸Šçš„ ACID è¡¨å­˜å‚¨å±‚ Delta Lake çš„æ ¸å¿ƒæ€æƒ³å¾ˆç®€å•ï¼š**æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªé¢„å†™æ—¥å¿—ï¼ˆwrite-ahead logï¼‰ä»¥ ACID æ–¹å¼ç»´æŠ¤å…³äºå“ªäº›å¯¹è±¡æ˜¯ Delta è¡¨ä¸€éƒ¨åˆ†çš„ä¿¡æ¯ï¼Œ**è¯¥æ—¥å¿—æœ¬èº«å­˜å‚¨åœ¨äº‘å¯¹è±¡å­˜å‚¨ä¸­ã€‚å¯¹è±¡æœ¬èº«ä»¥ Parquet ç¼–ç ï¼Œä½¿å¾—ä»å·²ç»èƒ½å¤Ÿå¤„ç† Parquet çš„å¼•æ“ç¼–å†™è¿æ¥å™¨å˜å¾—å®¹æ˜“ã€‚è¿™ç§è®¾è®¡å…è®¸å®¢æˆ·ç«¯ä»¥åºåˆ—åŒ–æ–¹å¼ä¸€æ¬¡æ€§æ›´æ–°å¤šä¸ªå¯¹è±¡ï¼Œç”¨å¦ä¸€ç»„å¯¹è±¡æ›¿æ¢å­é›†ç­‰ï¼ŒåŒæ—¶ä»ç„¶ä»å¯¹è±¡æœ¬èº«å®ç°é«˜å¹¶è¡Œè¯»å†™æ€§èƒ½ï¼ˆç±»ä¼¼äºåŸå§‹ Parquetï¼‰ã€‚æ—¥å¿—è¿˜åŒ…å«æ¯ä¸ªæ•°æ®æ–‡ä»¶çš„æœ€å°/æœ€å¤§ç»Ÿè®¡ä¿¡æ¯ç­‰å…ƒæ•°æ®ï¼Œä½¿å¾—å…ƒæ•°æ®æœç´¢æ¯”â€œå¯¹è±¡å­˜å‚¨ä¸­çš„æ–‡ä»¶â€æ–¹æ³•å¿«ä¸€ä¸ªæ•°é‡çº§ã€‚è‡³å…³é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬å°† Delta Lake è®¾è®¡ä¸ºæ‰€æœ‰å…ƒæ•°æ®éƒ½åœ¨åº•å±‚å¯¹è±¡å­˜å‚¨ä¸­ï¼Œå¹¶ä½¿ç”¨é’ˆå¯¹å¯¹è±¡å­˜å‚¨çš„ä¹è§‚å¹¶å‘åè®®å®ç°äº‹åŠ¡ï¼ˆç»†èŠ‚å› äº‘æä¾›å•†è€Œå¼‚ï¼‰ã€‚è¿™æ„å‘³ç€ä¸éœ€è¦è¿è¡ŒæœåŠ¡å™¨æ¥ç»´æŠ¤ Delta è¡¨çš„çŠ¶æ€ï¼›ç”¨æˆ·ä»…åœ¨è¿è¡ŒæŸ¥è¯¢æ—¶éœ€è¦å¯åŠ¨æœåŠ¡å™¨ï¼Œå¹¶äº«å—ç‹¬ç«‹æ‰©å±•è®¡ç®—å’Œå­˜å‚¨çš„å¥½å¤„ åŸºäºè¿™ç§äº‹åŠ¡æ€§è®¾è®¡ï¼Œæˆ‘ä»¬è¿˜åœ¨ Delta Lake ä¸­æ·»åŠ äº†å¤šä¸ªå…¶ä»–åŠŸèƒ½ï¼Œè¿™äº›åŠŸèƒ½åœ¨ä¼ ç»Ÿäº‘æ•°æ®æ¹–ä¸­ä¸å¯ç”¨ï¼Œä»¥è§£å†³å¸¸è§çš„å®¢æˆ·ç—›ç‚¹ï¼ŒåŒ…æ‹¬ï¼š Time travel to let users query point-in-time snapshots or roll back erroneous updates to their data. UPSERT, DELETE and MERGE operations, which efficiently rewrite the relevant objects to implement updates to archived data and compliance workflows (e.g., for GDPR [27]). Efficient streaming I/O, by letting streaming jobs write small objects into the table at low latency, then transactionally coalescing them into larger objects later for performance. Fast â€œtailingâ€ reads of the new data added to a table are also supported, so that jobs can treat a Delta table as a message bus. Caching: Because the objects in a Delta table and its log are immutable, cluster nodes can safely cache them on local storage. We leverage this in the Databricks cloud service to implement a transparent SSD cache for Delta tables. Data layout optimization: Our cloud service includes a feature that automatically optimizes the size of objects in a table and the clustering of data records (e.g., storing records in Zorder to achieve locality along multiple dimensions) without impacting running queries. Schema evolution, allowing Delta to continue reading old Parquet files without rewriting them if a tableâ€™s schema changes. Audit logging based on the transaction log è¿™äº›åŠŸèƒ½å…±åŒæé«˜äº†åœ¨äº‘å¯¹è±¡å­˜å‚¨ä¸­å¤„ç†æ•°æ®çš„æ˜“ç®¡ç†æ€§å’Œæ€§èƒ½ï¼Œå¹¶å®ç°äº†â€œæ¹–ä»“â€èŒƒå¼ï¼Œç»“åˆäº†æ•°æ®ä»“åº“å’Œæ•°æ®æ¹–çš„å…³é”®ç‰¹æ€§ï¼šæ ‡å‡† DBMS ç®¡ç†åŠŸèƒ½å¯ç›´æ¥ç”¨äºä½æˆæœ¬å¯¹è±¡å­˜å‚¨ã€‚ äº‹å®ä¸Šï¼Œæˆ‘ä»¬å‘ç°è®¸å¤š Databricks å®¢æˆ·å¯ä»¥é€šè¿‡ Delta Lake ç®€åŒ–å…¶æ•´ä½“æ•°æ®æ¶æ„ï¼Œç”¨æä¾›é€‚å½“åŠŸèƒ½çš„ Delta è¡¨æ›¿æ¢ä¹‹å‰ç‹¬ç«‹çš„æ•°æ®æ¹–ã€æ•°æ®ä»“åº“å’Œæµå­˜å‚¨ç³»ç»Ÿã€‚ å›¾ 1 å±•ç¤ºäº†ä¸€ä¸ªæç«¯ä¾‹å­ï¼Œä¸€ä¸ªåŒ…æ‹¬å¯¹è±¡å­˜å‚¨ã€æ¶ˆæ¯é˜Ÿåˆ—å’Œä¸¤ä¸ªæ•°æ®ä»“åº“çš„æ•°æ®ç®¡é“ï¼ˆæ¯ä¸ªä¸šåŠ¡æ™ºèƒ½å›¢é˜Ÿè¿è¡Œè‡ªå·±çš„è®¡ç®—èµ„æºï¼‰è¢«æ›¿æ¢ä¸ºä»…åœ¨å¯¹è±¡å­˜å‚¨ä¸Šçš„ Delta è¡¨ï¼Œä½¿ç”¨ Delta çš„æµå¼ I/O å’Œæ€§èƒ½ç‰¹æ€§è¿è¡Œ ETL å’Œ BIã€‚æ–°ç®¡é“ä»…ä½¿ç”¨ä½æˆæœ¬å¯¹è±¡å­˜å‚¨ï¼Œå¹¶åˆ›å»ºè¾ƒå°‘çš„æ•°æ®å‰¯æœ¬ï¼Œä»è€Œé™ä½äº†å­˜å‚¨æˆæœ¬å’Œç»´æŠ¤å¼€é”€ã€‚ å¼€æº Delta Lake é¡¹ç›® [26] åŒ…æ‹¬ä¸ Apache Sparkï¼ˆæ‰¹å¤„ç†æˆ–æµå¼ï¼‰ã€Hiveã€Prestoã€AWS Athenaã€Redshift å’Œ Snowflake çš„è¿æ¥å™¨ï¼Œå¹¶ä¸”å¯ä»¥åœ¨å¤šä¸ªäº‘å¯¹è±¡å­˜å‚¨ä¸Šæˆ– HDFS ä¸Šè¿è¡Œã€‚åœ¨æœ¬æ–‡çš„å…¶ä½™éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†ä»‹ç» Delta Lake çš„åŠ¨æœºå’Œè®¾è®¡ï¼Œä»¥åŠæ¨åŠ¨æˆ‘ä»¬è®¾è®¡çš„å®¢æˆ·ç”¨ä¾‹å’Œæ€§èƒ½å®éªŒã€‚ ","date":"2024-11-11","objectID":"/posts/paper-delta-lake/:3:0","tags":["Paper Reading"],"title":"Paper Reading: Delta Lake High-Performance ACID Table Storage over Cloud Object Stores","uri":"/posts/paper-delta-lake/"},{"categories":null,"content":"MOTIVATION: CHARACTERISTICS AND CHALLENGES OF OBJECT STORES ","date":"2024-11-11","objectID":"/posts/paper-delta-lake/:4:0","tags":["Paper Reading"],"title":"Paper Reading: Delta Lake High-Performance ACID Table Storage over Cloud Object Stores","uri":"/posts/paper-delta-lake/"},{"categories":null,"content":"Object Store APIs äº‘å¯¹è±¡å­˜å‚¨ï¼Œå¦‚ Amazon S3 [4]ã€Azure Blob Storage [17]ã€Google Cloud Storage [30] å’Œ OpenStack Swift [38]ï¼Œæä¾›äº†ä¸€ä¸ªç®€å•ä½†æ˜“äºæ‰©å±•çš„é”®å€¼å­˜å‚¨æ¥å£ã€‚è¿™äº›ç³»ç»Ÿå…è®¸ç”¨æˆ·åˆ›å»ºå­˜å‚¨å¤šä¸ªå¯¹è±¡çš„æ¡¶ï¼Œæ¯ä¸ªå¯¹è±¡æ˜¯ä¸€ä¸ªå¤§å°å¯è¾¾å‡  TB çš„äºŒè¿›åˆ¶å¤§å¯¹è±¡ï¼ˆä¾‹å¦‚ï¼Œåœ¨ S3 ä¸Šï¼Œå¯¹è±¡å¤§å°çš„é™åˆ¶æ˜¯ 5TB [4]ï¼‰ ä¸å¹¸çš„æ˜¯ï¼Œè¿™äº›å…ƒæ•°æ® API é€šå¸¸æ˜¯æ˜‚è´µçš„ï¼šä¾‹å¦‚ï¼ŒS3 çš„ LIST æ¯æ¬¡è°ƒç”¨æœ€å¤šè¿”å› 1000 ä¸ªé”®ï¼Œæ¯æ¬¡è°ƒç”¨éœ€è¦å‡ ååˆ°å‡ ç™¾æ¯«ç§’çš„æ—¶é—´ï¼Œå› æ­¤ä½¿ç”¨é¡ºåºå®ç°åˆ—å‡ºåŒ…å«æ•°ç™¾ä¸‡ä¸ªå¯¹è±¡çš„æ•°æ®é›†å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿçš„æ—¶é—´ã€‚ åœ¨è¯»å–å¯¹è±¡æ—¶ï¼Œäº‘å¯¹è±¡å­˜å‚¨é€šå¸¸æ”¯æŒå­—èŠ‚èŒƒå›´è¯·æ±‚ï¼Œå› æ­¤å¯ä»¥é«˜æ•ˆåœ°è¯»å–å¤§å¯¹è±¡ä¸­çš„æŸä¸ªèŒƒå›´ ä¸€äº›äº‘ä¾›åº”å•†è¿˜åœ¨ blob å­˜å‚¨ä¹‹ä¸Šå®ç°äº†åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿæ¥å£ï¼Œä¾‹å¦‚ Azure çš„ ADLS Gen2 [18]ï¼Œå®ƒæä¾›äº†ä¸ Hadoop çš„ HDFS ç±»ä¼¼çš„è¯­ä¹‰ï¼ˆä¾‹å¦‚ï¼Œç›®å½•å’ŒåŸå­é‡å‘½åï¼‰ã€‚å°½ç®¡å¦‚æ­¤ï¼ŒDelta Lake è§£å†³çš„è®¸å¤šé—®é¢˜ï¼Œå¦‚å°æ–‡ä»¶ [36] å’Œè·¨å¤šä¸ªç›®å½•çš„åŸå­æ›´æ–°ï¼Œå³ä½¿åœ¨åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿä¸Šä»ç„¶å­˜åœ¨â€”â€”å®é™…ä¸Šï¼Œå¤šä¸ªç”¨æˆ·åœ¨ HDFS ä¸Šè¿è¡Œ Delta Lakeã€‚ ","date":"2024-11-11","objectID":"/posts/paper-delta-lake/:4:1","tags":["Paper Reading"],"title":"Paper Reading: Delta Lake High-Performance ACID Table Storage over Cloud Object Stores","uri":"/posts/paper-delta-lake/"},{"categories":null,"content":"Consistency Properties æœ€æµè¡Œçš„äº‘å¯¹è±¡å­˜å‚¨ä¸ºæ¯ä¸ªé”®æä¾›æœ€ç»ˆä¸€è‡´æ€§ eventual consistency æ›´æ–°ä¸æ˜¯ç«‹åˆ»çœ‹åˆ° å…·ä½“çš„ä¸€è‡´æ€§æ¨¡å‹å› äº‘æä¾›å•†è€Œå¼‚ï¼Œå¯èƒ½ç›¸å½“å¤æ‚ã€‚ä½œä¸ºä¸€ä¸ªå…·ä½“çš„ä¾‹å­ï¼ŒAmazon S3 ä¸ºå†™å…¥æ–°å¯¹è±¡çš„å®¢æˆ·ç«¯æä¾›äº† read-after-write consistencyï¼Œè¿™æ„å‘³ç€åƒ S3 çš„ GET è¿™æ ·çš„è¯»å–æ“ä½œå°†åœ¨ PUT ä¹‹åè¿”å›å¯¹è±¡å†…å®¹ã€‚ negative caching æ˜¯ä»€ä¹ˆ ","date":"2024-11-11","objectID":"/posts/paper-delta-lake/:4:2","tags":["Paper Reading"],"title":"Paper Reading: Delta Lake High-Performance ACID Table Storage over Cloud Object Stores","uri":"/posts/paper-delta-lake/"},{"categories":null,"content":"Performance Characteristics åœ¨ä½¿ç”¨å¯¹è±¡å­˜å‚¨æ—¶å®ç°é«˜ååé‡éœ€è¦ä»”ç»†å¹³è¡¡å¤§å—é¡ºåº I/O å’Œå¹¶è¡Œæ€§ å¯¹äºè¯»å–æ“ä½œï¼Œæœ€ç»†ç²’åº¦çš„æ“ä½œæ˜¯è¯»å–é¡ºåºå­—èŠ‚èŒƒå›´ï¼Œå¦‚å‰æ‰€è¿°ã€‚æ¯ä¸ªè¯»å–æ“ä½œé€šå¸¸ä¼šäº§ç”Ÿè‡³å°‘ 5-10 æ¯«ç§’çš„åŸºç¡€å»¶è¿Ÿï¼Œå¹¶ä¸”éšåå¯ä»¥ä»¥å¤§çº¦ 50-100 MB/s çš„é€Ÿåº¦è¯»å–æ•°æ®ï¼Œå› æ­¤ä¸€ä¸ªæ“ä½œéœ€è¦è¯»å–è‡³å°‘å‡ ç™¾ KB çš„æ•°æ®æ‰èƒ½è¾¾åˆ°é¡ºåºè¯»å–å³°å€¼ååé‡çš„ä¸€åŠï¼Œå¹¶ä¸”éœ€è¦è¯»å–å‡  MB çš„æ•°æ®æ‰èƒ½æ¥è¿‘å³°å€¼ååé‡ã€‚æ­¤å¤–ï¼Œåœ¨å…¸å‹çš„è™šæ‹Ÿæœºé…ç½®ä¸­ï¼Œåº”ç”¨ç¨‹åºéœ€è¦å¹¶è¡Œè¿è¡Œå¤šä¸ªè¯»å–æ“ä½œä»¥æœ€å¤§åŒ–ååé‡ã€‚ä¾‹å¦‚ï¼ŒAWS ä¸Šæœ€å¸¸ç”¨äºåˆ†æçš„è™šæ‹Ÿæœºç±»å‹è‡³å°‘å…·æœ‰ 10 Gbps çš„ç½‘ç»œå¸¦å®½ï¼Œå› æ­¤å®ƒä»¬éœ€è¦å¹¶è¡Œè¿è¡Œ 8-10 ä¸ªè¯»å–æ“ä½œä»¥å……åˆ†åˆ©ç”¨è¿™ä¸€å¸¦å®½ã€‚ LIST æ“ä½œä¹Ÿéœ€è¦æ˜¾è‘—çš„å¹¶è¡Œæ€§æ¥å¿«é€Ÿåˆ—å‡ºå¤§é‡å¯¹è±¡ã€‚åœ¨ Delta Lake ä¸­ï¼Œå¯ç”¨å¯¹è±¡çš„å…ƒæ•°æ®ï¼ˆåŒ…æ‹¬å®ƒä»¬çš„åç§°å’Œæ•°æ®ç»Ÿè®¡ä¿¡æ¯ï¼‰å­˜å‚¨åœ¨ Delta æ—¥å¿—ä¸­ï¼Œä½†æˆ‘ä»¬ä¹Ÿåœ¨é›†ç¾¤ä¸Šå¹¶è¡Œè¯»å–æ­¤æ—¥å¿— å†™æ“ä½œé€šå¸¸å¿…é¡»æ›¿æ¢æ•´ä¸ªå¯¹è±¡ï¼ˆæˆ–è¿½åŠ åˆ°å¯¹è±¡ä¸­ï¼‰ï¼Œå¦‚ç¬¬ 2.1 èŠ‚æ‰€è¿°ã€‚è¿™æ„å‘³ç€å¦‚æœä¸€ä¸ªè¡¨é¢„è®¡ä¼šæ¥æ”¶ç‚¹æ›´æ–°ï¼Œé‚£ä¹ˆå…¶ä¸­çš„å¯¹è±¡åº”è¯¥ä¿æŒè¾ƒå°ï¼Œè¿™ä¸æ”¯æŒå¤§è¯»å–æ“ä½œç›¸çŸ›ç›¾ã€‚æˆ–è€…ï¼Œå¯ä»¥ä½¿ç”¨ log-structured storage format. Implications for Table Storage Keep frequently accessed data close-by sequentially, which generally leads to choosing columnar formats. Make objects large, but not too large. Large objects increase the cost of updating data (e.g., deleting all data about one user) because they must be fully rewritten. Avoid LIST operations, and make these operations request lexicographic key ranges when possible. ","date":"2024-11-11","objectID":"/posts/paper-delta-lake/:4:3","tags":["Paper Reading"],"title":"Paper Reading: Delta Lake High-Performance ACID Table Storage over Cloud Object Stores","uri":"/posts/paper-delta-lake/"},{"categories":null,"content":"Existing Approaches for Table Storage Directories of Files è¿™ç§æ–¹æ³•å¾ˆæœ‰å¸å¼•åŠ›ï¼Œå› ä¸ºè¡¨æ ¼â€œåªæ˜¯ä¸€å †å¯¹è±¡â€ï¼Œå¯ä»¥ä»è®¸å¤šå·¥å…·ä¸­è®¿é—®ï¼Œè€Œæ— éœ€è¿è¡Œä»»ä½•é¢å¤–çš„æ•°æ®å­˜å‚¨æˆ–ç³»ç»Ÿã€‚å®ƒèµ·æºäº HDFS ä¸Šçš„ Apache Hive [45]ï¼Œå¹¶ä¸åœ¨æ–‡ä»¶ç³»ç»Ÿä¸Šä½¿ç”¨ Parquetã€Hive å’Œå…¶ä»–å¤§æ•°æ®è½¯ä»¶ç›¸åŒ¹é…ã€‚ è¿™ç§æ–¹æ³•çš„æŒ‘æˆ˜ã€‚å¦‚å¼•è¨€ä¸­æ‰€è¿°ï¼Œâ€œåªæ˜¯ä¸€å †æ–‡ä»¶â€çš„æ–¹æ³•åœ¨äº‘å¯¹è±¡å­˜å‚¨ä¸Šå­˜åœ¨æ€§èƒ½å’Œä¸€è‡´æ€§é—®é¢˜ã€‚å®¢æˆ·é‡åˆ°çš„æœ€å¸¸è§çš„æŒ‘æˆ˜åŒ…æ‹¬ï¼š è·¨å¤šä¸ªå¯¹è±¡çš„åŸå­æ€§ç¼ºå¤±ï¼šä»»ä½•éœ€è¦å†™å…¥æˆ–æ›´æ–°å¤šä¸ªå¯¹è±¡çš„äº‹åŠ¡éƒ½å¯èƒ½é¢ä¸´éƒ¨åˆ†å†™å…¥å¯¹å…¶ä»–å®¢æˆ·ç«¯å¯è§çš„é£é™©ã€‚æ­¤å¤–ï¼Œå¦‚æœæ­¤ç±»äº‹åŠ¡å¤±è´¥ï¼Œæ•°æ®å°†å¤„äºæŸåçŠ¶æ€ã€‚ æœ€ç»ˆä¸€è‡´æ€§ï¼šå³ä½¿åœ¨æˆåŠŸçš„äº‹åŠ¡ä¸­ï¼Œå®¢æˆ·ç«¯ä¹Ÿå¯èƒ½çœ‹åˆ°ä¸€äº›æ›´æ–°çš„å¯¹è±¡ï¼Œè€Œçœ‹ä¸åˆ°å…¶ä»–å¯¹è±¡ã€‚ æ€§èƒ½ä¸ä½³ï¼šåˆ—å‡ºå¯¹è±¡ä»¥æ‰¾åˆ°ä¸æŸ¥è¯¢ç›¸å…³çš„å¯¹è±¡æ˜¯æ˜‚è´µçš„ï¼Œå³ä½¿å®ƒä»¬æŒ‰é”®åˆ†åŒºåˆ°ç›®å½•ä¸­ã€‚æ­¤å¤–ï¼Œè®¿é—®å­˜å‚¨åœ¨ Parquet æˆ– ORC æ–‡ä»¶ä¸­çš„æ¯ä¸ªå¯¹è±¡çš„ç»Ÿè®¡ä¿¡æ¯ä¹Ÿå¾ˆæ˜‚è´µï¼Œå› ä¸ºå®ƒéœ€è¦ä¸ºæ¯ä¸ªç‰¹å¾è¿›è¡Œé¢å¤–çš„é«˜å»¶è¿Ÿè¯»å–ã€‚ ç¼ºä¹ç®¡ç†åŠŸèƒ½ï¼šå¯¹è±¡å­˜å‚¨ä¸å®ç°æ•°æ®ä»“åº“ä¸­å¸¸è§çš„æ ‡å‡†å®ç”¨ç¨‹åºï¼Œå¦‚è¡¨æ ¼ç‰ˆæœ¬æ§åˆ¶æˆ–å®¡è®¡æ—¥å¿—ã€‚ Custom Storage Engines ä¾‹å¦‚ Snowflake æ•°æ®ä»“åº“ï¼Œå¯ä»¥é€šè¿‡åœ¨å•ç‹¬çš„å¼ºä¸€è‡´æ€§æœåŠ¡ä¸­è‡ªè¡Œç®¡ç†å…ƒæ•°æ®æ¥ç»•è¿‡äº‘å¯¹è±¡å­˜å‚¨çš„è®¸å¤šä¸€è‡´æ€§æŒ‘æˆ˜ï¼Œè¯¥æœåŠ¡æŒæœ‰å…³äºå“ªäº›å¯¹è±¡æ„æˆè¡¨æ ¼çš„ â€œsource of truthâ€ åœ¨è¿™äº›å¼•æ“ä¸­ï¼Œäº‘å¯¹è±¡å­˜å‚¨å¯ä»¥è¢«è§†ä¸ºä¸€ä¸ª dumb block deviceï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨æ ‡å‡†æŠ€æœ¯åœ¨äº‘å¯¹è±¡ä¸Šå®ç°é«˜æ•ˆçš„å…ƒæ•°æ®å­˜å‚¨ã€æœç´¢ã€æ›´æ–°ç­‰ã€‚ç„¶è€Œï¼Œè¿™ç§æ–¹æ³•éœ€è¦è¿è¡Œä¸€ä¸ªé«˜åº¦å¯ç”¨çš„æœåŠ¡æ¥ç®¡ç†å…ƒæ•°æ®ï¼Œè¿™å¯èƒ½å¾ˆæ˜‚è´µï¼Œåœ¨ä½¿ç”¨å¤–éƒ¨è®¡ç®—å¼•æ“æŸ¥è¯¢æ•°æ®æ—¶ä¼šå¢åŠ å¼€é”€ï¼Œå¹¶ä¸”å¯èƒ½å°†ç”¨æˆ·é”å®šåœ¨ä¸€ä¸ªæä¾›å•†ä¸Šã€‚ è¿™ç§æ–¹æ³•çš„æŒ‘æˆ˜ï¼š æ‰€æœ‰å¯¹è¡¨æ ¼çš„ I/O æ“ä½œéƒ½éœ€è¦è”ç³» metadata æœåŠ¡ï¼Œè¿™ä¼šå¢åŠ å…¶èµ„æºæˆæœ¬å¹¶é™ä½æ€§èƒ½å’Œå¯ç”¨æ€§ã€‚ä¾‹å¦‚ï¼Œå½“ä½¿ç”¨ Spark è®¿é—® Snowflake æ•°æ®é›†æ—¶ï¼Œä» Snowflake çš„ Spark è¿æ¥å™¨è¯»å–æ•°æ®ä¼šé€šè¿‡ Snowflake çš„æœåŠ¡æµå¼ä¼ è¾“æ•°æ®ï¼Œä¸ç›´æ¥ä»äº‘å¯¹è±¡å­˜å‚¨è¯»å–ç›¸æ¯”ï¼Œæ€§èƒ½æœ‰æ‰€é™ä½ã€‚ è¿æ¥åˆ°ç°æœ‰è®¡ç®—å¼•æ“éœ€è¦æ›´å¤šçš„å·¥ç¨‹å·¥ä½œæ¥å®ç°ï¼Œè€Œä¸æ˜¯é‡ç”¨ç°æœ‰çš„å¼€æ”¾æ ¼å¼ï¼ˆå¦‚ Parquetï¼‰ã€‚æ ¹æ®æˆ‘ä»¬çš„ç»éªŒï¼Œæ•°æ®å›¢é˜Ÿå¸Œæœ›åœ¨å…¶æ•°æ®ä¸Šä½¿ç”¨å¹¿æ³›çš„è®¡ç®—å¼•æ“ï¼ˆä¾‹å¦‚ Sparkã€TensorFlowã€PyTorch ç­‰ï¼‰ï¼Œå› æ­¤ä½¿è¿æ¥å™¨æ˜“äºå®ç°éå¸¸é‡è¦ã€‚ ä¸“æœ‰çš„å…ƒæ•°æ®æœåŠ¡å°†ç”¨æˆ·ç»‘å®šåˆ°ç‰¹å®šçš„æœåŠ¡æä¾›å•†ï¼Œè€ŒåŸºäºç›´æ¥è®¿é—®äº‘å­˜å‚¨ä¸­çš„å¯¹è±¡çš„æ–¹æ³•ä½¿ç”¨æˆ·èƒ½å¤Ÿå§‹ç»ˆä½¿ç”¨ä¸åŒçš„æŠ€æœ¯è®¿é—®å…¶æ•°æ®ã€‚ æ‰€ä»¥ç°åœ¨éƒ½ç”¨ open formats? iceberg æ˜¯æ–°çš„æŠ€æœ¯è¶‹åŠ¿å— Apache Hive ACID [32] é€šè¿‡ä½¿ç”¨ Hive Metastoreï¼ˆä¸€ä¸ªäº‹åŠ¡æ€§ RDBMSï¼Œå¦‚ MySQLï¼‰æ¥è·Ÿè¸ªå­˜å‚¨åœ¨ ORC æ ¼å¼ä¸­çš„è¡¨æ ¼çš„å¤šä¸ªæ›´æ–°æ–‡ä»¶ï¼Œåœ¨ HDFS æˆ–å¯¹è±¡å­˜å‚¨ä¸Šå®ç°äº†ç±»ä¼¼çš„æ–¹æ³•ã€‚ç„¶è€Œï¼Œè¿™ç§æ–¹æ³•å—åˆ°å…ƒæ•°æ®å­˜å‚¨æ€§èƒ½çš„é™åˆ¶ï¼Œæ ¹æ®æˆ‘ä»¬çš„ç»éªŒï¼Œå¯¹äºåŒ…å«æ•°ç™¾ä¸‡å¯¹è±¡çš„è¡¨æ ¼ï¼Œå…ƒæ•°æ®å­˜å‚¨å¯èƒ½æˆä¸ºç“¶é¢ˆã€‚ metastore metadata è¿™é‡Œä¸å¤ªç†è§£ï¼Œè¿™äº›æ•°æ®çš„ metadata ä¸ºä»€ä¹ˆè¦åˆ†å¼€å­˜å‘¢ Metadata in Object Stores. Delta Lake çš„æ–¹æ³•æ˜¯å°†äº‹åŠ¡æ—¥å¿—å’Œå…ƒæ•°æ®ç›´æ¥å­˜å‚¨åœ¨äº‘å¯¹è±¡å­˜å‚¨ä¸­ï¼Œå¹¶ä½¿ç”¨ä¸€ç»„å¯¹è±¡å­˜å‚¨æ“ä½œåè®®æ¥å®ç°åºåˆ—åŒ–ã€‚ è¡¨æ ¼ä¸­çš„æ•°æ®éšåä»¥ Parquet æ ¼å¼å­˜å‚¨ï¼Œä½¿å¾—åªè¦æœ‰ä¸€ä¸ªæœ€å°çš„è¿æ¥å™¨æ¥å‘ç°è¦è¯»å–çš„å¯¹è±¡é›†ï¼Œå°±å¯ä»¥ä»ä»»ä½•å·²ç»æ”¯æŒ Parquet çš„è½¯ä»¶ä¸­è½»æ¾è®¿é—®ã€‚å°½ç®¡æˆ‘ä»¬è®¤ä¸º Delta Lake æ˜¯ç¬¬ä¸€ä¸ªä½¿ç”¨è¿™ç§è®¾è®¡çš„ç³»ç»Ÿï¼ˆå§‹äº 2016 å¹´ï¼‰ï¼Œä½†å¦å¤–ä¸¤ä¸ªè½¯ä»¶åŒ…ç°åœ¨ä¹Ÿæ”¯æŒå®ƒâ€”â€”Apache Hudi [8] å’Œ Apache Iceberg [10]ã€‚Delta Lake æä¾›äº†è¿™äº›ç³»ç»Ÿä¸æ”¯æŒçš„è®¸å¤šç‹¬ç‰¹åŠŸèƒ½ï¼Œä¾‹å¦‚ Z-order èšç±»ã€ç¼“å­˜å’Œåå°ä¼˜åŒ–ã€‚æˆ‘ä»¬å°†åœ¨ç¬¬ 8 èŠ‚ä¸­æ›´è¯¦ç»†åœ°è®¨è®ºè¿™äº›ç³»ç»Ÿä¹‹é—´çš„ç›¸ä¼¼æ€§å’Œå·®å¼‚ã€‚ Iceberg, Hudi ç­‰æŠ€æœ¯ç›®å‰å·¥ä¸šç•Œåº”è¯¥æ˜¯å¾ˆæœ‰å‰æ™¯çš„ Deltalake çš„ç‰¹è‰²æ˜¯ä»€ä¹ˆï¼Ÿ ","date":"2024-11-11","objectID":"/posts/paper-delta-lake/:4:4","tags":["Paper Reading"],"title":"Paper Reading: Delta Lake High-Performance ACID Table Storage over Cloud Object Stores","uri":"/posts/paper-delta-lake/"},{"categories":null,"content":"DELTA LAKE STORAGE FORMAT AND ACCESS PROTOCOLS Delta Lake è¡¨æ ¼æ˜¯äº‘å¯¹è±¡å­˜å‚¨æˆ–æ–‡ä»¶ç³»ç»Ÿä¸Šçš„ä¸€ä¸ªç›®å½•ï¼Œå…¶ä¸­åŒ…å«è¡¨æ ¼å†…å®¹çš„æ–‡ä»¶å¯¹è±¡å’Œäº‹åŠ¡æ“ä½œçš„æ—¥å¿— (with occasional checkpoints) å®¢æˆ·ç«¯ä½¿ç”¨æˆ‘ä»¬ä¸ºäº‘å¯¹è±¡å­˜å‚¨ç‰¹æ€§å®šåˆ¶çš„ä¹è§‚å¹¶å‘æ§åˆ¶åè®®æ¥æ›´æ–°è¿™äº›æ•°æ®ç»“æ„ã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†æè¿° Delta Lake çš„å­˜å‚¨æ ¼å¼å’Œè¿™äº›è®¿é—®åè®®ã€‚æˆ‘ä»¬è¿˜å°†æè¿° Delta Lake çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼ŒåŒ…æ‹¬è¡¨æ ¼å†…çš„åºåˆ—åŒ–å’Œå¿«ç…§éš”ç¦»ã€‚ ","date":"2024-11-11","objectID":"/posts/paper-delta-lake/:5:0","tags":["Paper Reading"],"title":"Paper Reading: Delta Lake High-Performance ACID Table Storage over Cloud Object Stores","uri":"/posts/paper-delta-lake/"},{"categories":null,"content":"Storage Format å›¾ 2 å±•ç¤ºäº† Delta è¡¨æ ¼çš„å­˜å‚¨æ ¼å¼ã€‚æ¯ä¸ªè¡¨æ ¼éƒ½å­˜å‚¨åœ¨æ–‡ä»¶ç³»ç»Ÿç›®å½•ï¼ˆæ­¤å¤„ä¸º mytableï¼‰ä¸­ï¼Œæˆ–è€…ä½œä¸ºå¯¹è±¡å­˜å‚¨ä¸­ä»¥ç›¸åŒâ€œç›®å½•â€é”®å‰ç¼€å¼€å¤´çš„å¯¹è±¡ã€‚ Data Objects è¡¨æ ¼å†…å®¹å­˜å‚¨åœ¨ Apache Parquet å¯¹è±¡ä¸­ é€‰æ‹© Parquet ä½œä¸ºåº•å±‚æ•°æ®æ ¼å¼ï¼Œå› ä¸ºå®ƒé¢å‘åˆ—ï¼Œæä¾›å¤šç§å‹ç¼©æ›´æ–°ï¼Œæ”¯æŒåŠç»“æ„åŒ–æ•°æ®çš„åµŒå¥—æ•°æ®ç±»å‹ï¼Œå¹¶ä¸”åœ¨è®¸å¤šå¼•æ“ä¸­å·²ç»æœ‰é«˜æ€§èƒ½çš„å®ç°ã€‚åŸºäºç°æœ‰çš„å¼€æ”¾æ–‡ä»¶æ ¼å¼ä¹Ÿç¡®ä¿äº† Delta Lake å¯ä»¥ç»§ç»­åˆ©ç”¨ Parquet åº“çš„æ–°å‘å¸ƒæ›´æ–°ï¼Œå¹¶ç®€åŒ–äº†å¼€å‘ä¸å…¶ä»–å¼•æ“çš„è¿æ¥å™¨ï¼ˆç¬¬ 4.8 èŠ‚ï¼‰ã€‚å…¶ä»–å¼€æºæ ¼å¼ï¼Œå¦‚ ORC [12]ï¼Œå¯èƒ½ä¹Ÿèƒ½ä»¥ç±»ä¼¼çš„æ–¹å¼å·¥ä½œï¼Œä½† Parquet åœ¨ Spark ä¸­æ‹¥æœ‰æœ€æˆç†Ÿçš„æ”¯æŒã€‚ Delta ä¸­çš„æ¯ä¸ªæ•°æ®å¯¹è±¡éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„åç§°ï¼Œé€šå¸¸ç”±å†™å…¥è€…é€šè¿‡ç”Ÿæˆ GUID æ¥é€‰æ‹©ã€‚ç„¶è€Œï¼Œå“ªäº›å¯¹è±¡æ˜¯è¡¨æ ¼æ¯ä¸ªç‰ˆæœ¬çš„ç»„æˆéƒ¨åˆ†ç”±äº‹åŠ¡æ—¥å¿—å†³å®šã€‚ Log æ—¥å¿—å­˜å‚¨åœ¨è¡¨æ ¼å†…çš„_delta_log å­ç›®å½•ä¸­ã€‚å®ƒåŒ…å«ä¸€ç³»åˆ—å¸¦æœ‰é€’å¢çš„é›¶å¡«å……æ•°å­— ID çš„ JSON å¯¹è±¡ï¼Œç”¨äºå­˜å‚¨æ—¥å¿—è®°å½•ï¼Œä»¥åŠå¶å°”çš„æ£€æŸ¥ç‚¹ï¼Œç”¨äºç‰¹å®šæ—¥å¿—å¯¹è±¡ï¼Œä»¥ Parquet æ ¼å¼æ€»ç»“åˆ°è¯¥ç‚¹çš„æ—¥å¿—ã€‚æ­£å¦‚æˆ‘ä»¬åœ¨ç¬¬ 3.2 èŠ‚ä¸­è®¨è®ºçš„é‚£æ ·ï¼Œä¸€äº›ç®€å•çš„è®¿é—®åè®®ï¼ˆå–å†³äºæ¯ä¸ªå¯¹è±¡å­˜å‚¨ä¸­å¯ç”¨çš„åŸå­æ“ä½œï¼‰ç”¨äºåˆ›å»ºæ–°çš„æ—¥å¿—æ¡ç›®æˆ–æ£€æŸ¥ç‚¹ï¼Œå¹¶ä½¿å®¢æˆ·ç«¯å°±äº‹åŠ¡é¡ºåºè¾¾æˆä¸€è‡´ã€‚ æ¯ä¸ªæ—¥å¿—è®°å½•å¯¹è±¡ï¼ˆä¾‹å¦‚ï¼Œ000003.jsonï¼‰åŒ…å«ä¸€ä¸ªæ“ä½œæ•°ç»„ï¼Œè¿™äº›æ“ä½œåº”ç”¨äºè¡¨æ ¼çš„å‰ä¸€ä¸ªç‰ˆæœ¬ä»¥ç”Ÿæˆä¸‹ä¸€ä¸ªç‰ˆæœ¬ã€‚å¯ç”¨çš„æ“ä½œåŒ…æ‹¬ï¼š Change Metadata. Add or Remove Files. Protocol Evolution. Add Provenance Information. Update Application Transaction IDs. Log Checkpoints ä¸ºäº†æ€§èƒ½ï¼Œæœ‰å¿…è¦å®šæœŸå°†æ—¥å¿—å‹ç¼©æˆæ£€æŸ¥ç‚¹ã€‚æ£€æŸ¥ç‚¹ä»¥ Parquet æ ¼å¼å­˜å‚¨è¡¨æ ¼æ—¥å¿—ä¸­åˆ°æŸä¸ªæ—¥å¿—è®°å½• ID çš„æ‰€æœ‰éå†—ä½™æ“ä½œã€‚ ","date":"2024-11-11","objectID":"/posts/paper-delta-lake/:5:1","tags":["Paper Reading"],"title":"Paper Reading: Delta Lake High-Performance ACID Table Storage over Cloud Object Stores","uri":"/posts/paper-delta-lake/"},{"categories":null,"content":"Access Protocols Delta Lake çš„è®¿é—®åè®®æ—¨åœ¨è®©å®¢æˆ·ç«¯ä»…ä½¿ç”¨å¯¹è±¡å­˜å‚¨ä¸Šçš„æ“ä½œå®ç°åºåˆ—åŒ–äº‹åŠ¡ï¼Œå°½ç®¡å¯¹è±¡å­˜å‚¨å…·æœ‰æœ€ç»ˆä¸€è‡´æ€§ä¿è¯ã€‚ Reading from Tables åªè¯»äº‹åŠ¡ è¯»å–è¡¨æ ¼æ—¥å¿—ç›®å½•ä¸­çš„ _last_checkpoint å¯¹è±¡ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ï¼Œä»¥è·å–æœ€è¿‘çš„æ£€æŸ¥ç‚¹ IDã€‚ ä½¿ç”¨ LIST æ“ä½œï¼Œå…¶èµ·å§‹é”®æ˜¯æœ€åä¸€ä¸ªæ£€æŸ¥ç‚¹ IDï¼ˆå¦‚æœå­˜åœ¨ï¼‰ï¼Œå¦åˆ™ä¸º 0ï¼Œä»¥æŸ¥æ‰¾è¡¨æ ¼æ—¥å¿—ç›®å½•ä¸­ä»»ä½•æ›´æ–°çš„ .json å’Œ .parquet æ–‡ä»¶ã€‚ ä½¿ç”¨ä¸Šä¸€æ­¥ä¸­æ ‡è¯†çš„æ£€æŸ¥ç‚¹ï¼ˆå¦‚æœå­˜åœ¨ï¼‰å’Œåç»­æ—¥å¿—è®°å½•é‡å»ºè¡¨æ ¼çš„çŠ¶æ€â€”â€”å³ï¼Œå…·æœ‰æ·»åŠ è®°å½•ä½†æ²¡æœ‰ç›¸åº”åˆ é™¤è®°å½•çš„æ•°æ®å¯¹è±¡é›†åŠå…¶å…³è”çš„æ•°æ®ç»Ÿè®¡ä¿¡æ¯ã€‚ ä½¿ç”¨ç»Ÿè®¡ä¿¡æ¯è¯†åˆ«ä¸è¯»å–æŸ¥è¯¢ç›¸å…³çš„æ•°æ®å¯¹è±¡æ–‡ä»¶é›†ã€‚ æŸ¥è¯¢å¯¹è±¡å­˜å‚¨ä»¥è¯»å–ç›¸å…³çš„æ•°æ®å¯¹è±¡ï¼Œå¯èƒ½åœ¨é›†ç¾¤ä¸­å¹¶è¡Œè¿›è¡Œ æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œæ­¤åè®®è®¾è®¡ä¸ºåœ¨æ¯ä¸€æ­¥éƒ½ tolerate eventual consistency ç¬¬ä¸€æ­¥è¯»åˆ°æ—§çš„ï¼Œç¬¬äºŒæ­¥å¯èƒ½æ‹¿åˆ°æ–°çš„ï¼Ÿ Write Transactions å†™å…¥æ•°æ®çš„äº‹åŠ¡é€šå¸¸ä¼šæ ¹æ®äº‹åŠ¡ä¸­çš„æ“ä½œåˆ†ä¸ºæœ€å¤šäº”ä¸ªæ­¥éª¤ï¼š çœç•¥ç»†èŠ‚äº†ï¼Œè¿™ç¯‡è®ºæ–‡å›¾å¤ªå°‘äº†ï¼Œå¾ˆä¸æ¸…æ™° è¯·æ³¨æ„ï¼Œç¬¬äº”æ­¥ï¼Œå³å†™å…¥æ£€æŸ¥ç‚¹ç„¶åæ›´æ–° _last_checkpoint å¯¹è±¡ï¼Œä»…å½±å“æ€§èƒ½ï¼Œå®¢æˆ·ç«¯åœ¨æ­¤æ­¥éª¤ä¸­çš„ä»»ä½•åœ°æ–¹å¤±è´¥éƒ½ä¸ä¼šæŸåæ•°æ®ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå®¢æˆ·ç«¯æœªèƒ½å†™å…¥æ£€æŸ¥ç‚¹ï¼Œæˆ–è€…å†™å…¥äº†æ£€æŸ¥ç‚¹ Parquet å¯¹è±¡ä½†æ²¡æœ‰æ›´æ–° _last_checkpoint ï¼Œé‚£ä¹ˆå…¶ä»–å®¢æˆ·ç«¯ä»ç„¶å¯ä»¥ä½¿ç”¨è¾ƒæ—©çš„æ£€æŸ¥ç‚¹è¯»å–è¡¨æ ¼ã€‚å¦‚æœæ­¥éª¤ 4 æˆåŠŸï¼Œäº‹åŠ¡å°†åŸå­æäº¤ã€‚ Adding Log Records Atomically æ­¥éª¤ 4ï¼Œå³åˆ›å»º r + 1 çš„.json æ—¥å¿—è®°å½•å¯¹è±¡ï¼Œéœ€è¦æ˜¯åŸå­çš„ï¼šåªæœ‰ä¸€ä¸ªå®¢æˆ·ç«¯åº”è¯¥æˆåŠŸåˆ›å»ºå…·æœ‰è¯¥åç§°çš„å¯¹è±¡ã€‚ä¸å¹¸çš„æ˜¯ï¼Œå¹¶éæ‰€æœ‰å¤§è§„æ¨¡å­˜å‚¨ç³»ç»Ÿéƒ½å…·æœ‰åŸå­çš„â€œä¸å­˜åœ¨åˆ™æ”¾ç½®â€æ“ä½œï¼Œä½†æˆ‘ä»¬èƒ½å¤Ÿä¸ºä¸åŒçš„å­˜å‚¨ç³»ç»Ÿä»¥ä¸åŒçš„æ–¹å¼å®ç°æ­¤æ­¥éª¤ï¼š ä¸åŒ cloud provider ä¸åŒå®ç° AWS S3, Azure Blob, google cloud storage ","date":"2024-11-11","objectID":"/posts/paper-delta-lake/:5:2","tags":["Paper Reading"],"title":"Paper Reading: Delta Lake High-Performance ACID Table Storage over Cloud Object Stores","uri":"/posts/paper-delta-lake/"},{"categories":null,"content":"Available Isolation Levels Given Delta Lakeâ€™s concurrency control protocols, all transactions that perform writes are serializable, leading to a serial schedule in increasing order of log record IDs è¿™æ˜¯ç”±äºå†™å…¥äº‹åŠ¡çš„æäº¤åè®®ï¼Œå…¶ä¸­åªæœ‰ä¸€ä¸ªäº‹åŠ¡å¯ä»¥å†™å…¥æ¯ä¸ªè®°å½• ID çš„è®°å½•ã€‚ è¯»å–äº‹åŠ¡å¯ä»¥å®ç°å¿«ç…§éš”ç¦»æˆ–åºåˆ—åŒ–ã€‚ snapshot isolation å¿«ç…§éš”ç¦» å†™çš„äº‹åŠ¡éš”ç¦»çº§åˆ«å¾ˆé«˜ï¼Œæ˜¯åºåˆ—åŒ– ","date":"2024-11-11","objectID":"/posts/paper-delta-lake/:5:3","tags":["Paper Reading"],"title":"Paper Reading: Delta Lake High-Performance ACID Table Storage over Cloud Object Stores","uri":"/posts/paper-delta-lake/"},{"categories":null,"content":"Transaction Rates Delta Lake çš„å†™å…¥äº‹åŠ¡é€Ÿç‡å—é™äºå†™å…¥æ–°æ—¥å¿—è®°å½•çš„â€œä¸å­˜åœ¨åˆ™æ”¾ç½®â€æ“ä½œçš„å»¶è¿Ÿï¼Œå¦‚ç¬¬ 3.2.2 èŠ‚æ‰€è¿°ã€‚ä¸ä»»ä½•ä¹è§‚å¹¶å‘æ§åˆ¶åè®®ä¸€æ ·ï¼Œé«˜å†™å…¥äº‹åŠ¡é€Ÿç‡å°†å¯¼è‡´æäº¤å¤±è´¥ã€‚ æˆ‘ä»¬ç›¸ä¿¡ä¸€ä¸ªè‡ªå®šä¹‰çš„ LogStoreï¼Œç±»ä¼¼äºæˆ‘ä»¬çš„ S3 æäº¤æœåŠ¡ï¼Œå¯ä»¥é€šè¿‡åè°ƒå¯¹æ—¥å¿—çš„è®¿é—®æ¥æä¾›æ˜¾è‘—æ›´å¿«çš„æäº¤æ—¶é—´ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡åœ¨ä½å»¶è¿Ÿ DBMS ä¸­æŒä¹…åŒ–æ—¥å¿—çš„æœ«å°¾ï¼Œå¹¶å¼‚æ­¥å°†å…¶å†™å…¥å¯¹è±¡å­˜å‚¨ï¼‰ã€‚å½“ç„¶ï¼Œå¿«ç…§éš”ç¦»çº§åˆ«çš„è¯»å–äº‹åŠ¡ä¸ä¼šäº§ç”Ÿäº‰ç”¨ï¼Œå› ä¸ºå®ƒä»¬åªè¯»å–å¯¹è±¡å­˜å‚¨ä¸­çš„å¯¹è±¡ï¼Œå› æ­¤å¯ä»¥åŒæ—¶è¿è¡Œä»»æ„æ•°é‡çš„è¿™äº›äº‹åŠ¡ã€‚ æ¦‚å¿µå¤ªå¤šäº†è¿™é‡Œï¼Œ é¦–å…ˆï¼Œåœ¨æäº¤æ—¶ï¼Œå¦‚æœå¤šä¸ªäº‹åŠ¡å°è¯•æ›´æ–°åŒä¸€èµ„æºï¼Œå°±ä¼šå‘ç”Ÿå†²çªã€‚ç”±äºæ¯ä¸ªäº‹åŠ¡éƒ½è¯•å›¾å†™å…¥ç›¸åŒçš„æ—¥å¿—è®°å½•ä½ç½®ï¼Œè¿™äº›å†²çªä¼šå¯¼è‡´æŸäº›äº‹åŠ¡æäº¤å¤±è´¥ï¼Œéœ€è¦å›æ»šå’Œé‡è¯•ã€‚ LogSotre ç”¨äºç®¡ç†äº‹åŠ¡æ—¥å¿—è®°å½•ã€‚å®ƒè´Ÿè´£æ—¥å¿—çš„æŒä¹…åŒ–å’Œå­˜å–ï¼Œç¡®ä¿å†™å…¥æ“ä½œçš„åŸå­æ€§å’Œä¸€è‡´æ€§ã€‚ å¦‚æœéœ€è¦æ›´é«˜çš„å†™å…¥é€Ÿç‡ï¼Œå¯ä»¥é€šè¿‡å®šåˆ¶çš„ LogStore è¿›è¡Œä¼˜åŒ–ï¼Œå¦‚åœ¨ä½å»¶è¿Ÿæ•°æ®åº“ä¸­æŒä¹…åŒ–æ—¥å¿—ç»“å°¾ï¼Œå¹¶å¼‚æ­¥å†™å…¥å¯¹è±¡å­˜å‚¨ã€‚ ","date":"2024-11-11","objectID":"/posts/paper-delta-lake/:5:4","tags":["Paper Reading"],"title":"Paper Reading: Delta Lake High-Performance ACID Table Storage over Cloud Object Stores","uri":"/posts/paper-delta-lake/"},{"categories":null,"content":"HIGHER-LEVEL FEATURES IN DELTA ","date":"2024-11-11","objectID":"/posts/paper-delta-lake/:6:0","tags":["Paper Reading"],"title":"Paper Reading: Delta Lake High-Performance ACID Table Storage over Cloud Object Stores","uri":"/posts/paper-delta-lake/"},{"categories":null,"content":"Time Travel and Rollbacks ç”±äº Delta Lake çš„æ•°æ®å¯¹è±¡å’Œæ—¥å¿—æ˜¯ä¸å¯å˜çš„ï¼ŒDelta Lake ä½¿å¾—æŸ¥è¯¢æ•°æ®çš„è¿‡å»å¿«ç…§å˜å¾—ç®€å•ï¼Œå°±åƒå…¸å‹çš„ MVCC å®ç°ä¸€æ ·ã€‚ ","date":"2024-11-11","objectID":"/posts/paper-delta-lake/:6:1","tags":["Paper Reading"],"title":"Paper Reading: Delta Lake High-Performance ACID Table Storage over Cloud Object Stores","uri":"/posts/paper-delta-lake/"},{"categories":null,"content":"Efficient UPSERT, DELETE andMERGE åœ¨ä¼ ç»Ÿçš„æ•°æ®æ¹–å­˜å‚¨æ ¼å¼ä¸­ï¼Œä¾‹å¦‚ S3 ä¸Šçš„ Parquet æ–‡ä»¶ç›®å½•ï¼Œå¾ˆéš¾åœ¨ä¸åœæ­¢å¹¶å‘è¯»å–å™¨çš„æƒ…å†µä¸‹æ‰§è¡Œè¿™äº›æ›´æ–°ã€‚å³ä½¿å¦‚æ­¤ï¼Œæ›´æ–°ä½œä¸šä¹Ÿå¿…é¡»å°å¿ƒæ‰§è¡Œï¼Œå› ä¸ºä½œä¸šæœŸé—´çš„å¤±è´¥å°†ä½¿è¡¨æ ¼å¤„äºéƒ¨åˆ†æ›´æ–°çš„çŠ¶æ€ã€‚ä½¿ç”¨ Delta Lakeï¼Œæ‰€æœ‰è¿™äº›æ“ä½œéƒ½å¯ä»¥äº‹åŠ¡æ€§åœ°æ‰§è¡Œï¼Œé€šè¿‡ Delta æ—¥å¿—ä¸­çš„æ–°æ·»åŠ å’Œåˆ é™¤è®°å½•æ›¿æ¢ä»»ä½•æ›´æ–°çš„å¯¹è±¡ã€‚Delta Lake æ”¯æŒæ ‡å‡†çš„ SQL UPSERTã€DELETE å’Œ MERGE è¯­æ³•ã€‚ ","date":"2024-11-11","objectID":"/posts/paper-delta-lake/:6:2","tags":["Paper Reading"],"title":"Paper Reading: Delta Lake High-Performance ACID Table Storage over Cloud Object Stores","uri":"/posts/paper-delta-lake/"},{"categories":null,"content":"Streaming Ingest and Consumption è®¸å¤šæ•°æ®å›¢é˜Ÿå¸Œæœ›éƒ¨ç½²æµå¼ç®¡é“ä»¥å®æ—¶ ETL æˆ–èšåˆæ•°æ®ï¼Œä½†ä¼ ç»Ÿçš„äº‘æ•°æ®æ¹–éš¾ä»¥ç”¨äºæ­¤ç›®çš„ã€‚ Write Compaction. Exactly-Once Streaming Writes. Efficient Log Tailing. è¿™éƒ¨åˆ†éœ€è¦å†ä»”ç»†çœ‹çœ‹åŸæ–‡ https://www.vldb.org/pvldb/vol13/p3411-armbrust.pdf ","date":"2024-11-11","objectID":"/posts/paper-delta-lake/:6:3","tags":["Paper Reading"],"title":"Paper Reading: Delta Lake High-Performance ACID Table Storage over Cloud Object Stores","uri":"/posts/paper-delta-lake/"},{"categories":null,"content":"Data Layout Optimization OPTIMIZE Commandã€‚ç”¨æˆ·å¯ä»¥æ‰‹åŠ¨å¯¹è¡¨æ ¼è¿è¡Œ OPTIMIZE å‘½ä»¤ï¼Œè¯¥å‘½ä»¤åœ¨ä¸å½±å“æ­£åœ¨è¿›è¡Œçš„äº‹åŠ¡çš„æƒ…å†µä¸‹å‹ç¼©å°å¯¹è±¡ï¼Œå¹¶è®¡ç®—ä»»ä½•ç¼ºå¤±çš„ç»Ÿè®¡ä¿¡æ¯ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ­¤æ“ä½œæ—¨åœ¨ä½¿æ¯ä¸ªæ•°æ®å¯¹è±¡çš„å¤§å°ä¸º 1 GBï¼Œæˆ‘ä»¬å‘ç°æ­¤å€¼é€‚ç”¨äºè®¸å¤šå·¥ä½œè´Ÿè½½ï¼Œä½†ç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰æ­¤å€¼ã€‚ Z-Ordering by Multiple Attributes AUTO OPTIMIZE. ","date":"2024-11-11","objectID":"/posts/paper-delta-lake/:6:4","tags":["Paper Reading"],"title":"Paper Reading: Delta Lake High-Performance ACID Table Storage over Cloud Object Stores","uri":"/posts/paper-delta-lake/"},{"categories":null,"content":"Caching ç¼“å­˜æ˜¯å®‰å…¨çš„ï¼Œå› ä¸º Delta Lake è¡¨æ ¼ä¸­çš„æ•°æ®ã€æ—¥å¿—å’Œæ£€æŸ¥ç‚¹å¯¹è±¡æ˜¯ä¸å¯å˜çš„ã€‚æ­£å¦‚æˆ‘ä»¬åœ¨ç¬¬ 6 èŠ‚æ‰€ç¤ºï¼Œä»ç¼“å­˜ä¸­è¯»å–å¯ä»¥æ˜¾è‘—æé«˜æŸ¥è¯¢æ€§èƒ½ã€‚ ","date":"2024-11-11","objectID":"/posts/paper-delta-lake/:6:5","tags":["Paper Reading"],"title":"Paper Reading: Delta Lake High-Performance ACID Table Storage over Cloud Object Stores","uri":"/posts/paper-delta-lake/"},{"categories":null,"content":"Audit Logging ç•¥ ","date":"2024-11-11","objectID":"/posts/paper-delta-lake/:6:6","tags":["Paper Reading"],"title":"Paper Reading: Delta Lake High-Performance ACID Table Storage over Cloud Object Stores","uri":"/posts/paper-delta-lake/"},{"categories":null,"content":"Schema Evolution and Enforcement Delta Lake å¯ä»¥äº‹åŠ¡æ€§åœ°æ‰§è¡Œæ¨¡å¼æ›´æ”¹ï¼Œå¹¶åœ¨éœ€è¦æ—¶æ›´æ–°åº•å±‚å¯¹è±¡ï¼ˆä¾‹å¦‚ï¼Œåˆ é™¤ç”¨æˆ·ä¸å†å¸Œæœ›ä¿ç•™çš„åˆ—ï¼‰ã€‚ Schema Evolution + äº‹åŠ¡ï¼Œåº”è¯¥æ¯”è¾ƒå®‰å…¨ï¼Ÿ ","date":"2024-11-11","objectID":"/posts/paper-delta-lake/:6:7","tags":["Paper Reading"],"title":"Paper Reading: Delta Lake High-Performance ACID Table Storage over Cloud Object Stores","uri":"/posts/paper-delta-lake/"},{"categories":null,"content":"Connectors to Query and ETL Engines Delta Lake é€šè¿‡ Apache Spark çš„æ•°æ®æº API [16] æä¾›äº†å¯¹ Spark SQL å’Œç»“æ„åŒ–æµçš„å…¨åŠŸèƒ½è¿æ¥å™¨ã€‚æ­¤å¤–ï¼Œå®ƒç›®å‰è¿˜æä¾›äº†å¯¹å¤šä¸ªå…¶ä»–ç³»ç»Ÿçš„åªè¯»é›†æˆï¼šApache Hiveã€Prestoã€AWS Athenaã€AWS Redshift å’Œ Snowflakeï¼Œä½¿ç”¨æˆ·å¯ä»¥ä½¿ç”¨ç†Ÿæ‚‰çš„å·¥å…·æŸ¥è¯¢ Delta è¡¨æ ¼ï¼Œå¹¶å°†å®ƒä»¬ä¸è¿™äº›ç³»ç»Ÿä¸­çš„æ•°æ®è¿›è¡Œè¿æ¥ æ•°æ®å­˜å‚¨å±‚ Iceberg/Hudi/Delta Lake ç„¶åæ¥å…¥æŸ¥è¯¢å±‚ æ˜¯å¦æ˜¯ä¸€ç§å­˜ç®—åˆ†ç¦»ï¼Ÿ ","date":"2024-11-11","objectID":"/posts/paper-delta-lake/:6:8","tags":["Paper Reading"],"title":"Paper Reading: Delta Lake High-Performance ACID Table Storage over Cloud Object Stores","uri":"/posts/paper-delta-lake/"},{"categories":null,"content":"DELTA LAKE USE CASES åœ¨è¿™äº›ä½¿ç”¨æ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬å‘ç°å®¢æˆ·ç»å¸¸ä½¿ç”¨ Delta Lake æ¥ç®€åŒ–å…¶ä¼ä¸šæ•°æ®æ¶æ„ï¼Œé€šè¿‡ç›´æ¥åœ¨äº‘å¯¹è±¡å­˜å‚¨ä¸Šè¿è¡Œæ›´å¤šå·¥ä½œè´Ÿè½½ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªå…¼å…·æ•°æ®æ¹–å’Œäº‹åŠ¡åŠŸèƒ½çš„â€œæ¹–ä»“â€ç³»ç»Ÿã€‚ä¾‹å¦‚ï¼Œè€ƒè™‘ä¸€ä¸ªå…¸å‹çš„æ•°æ®ç®¡é“ï¼Œå®ƒä»å¤šä¸ªæ¥æºåŠ è½½è®°å½•â€”â€”ä¾‹å¦‚ï¼Œæ¥è‡ª OLTP æ•°æ®åº“çš„ CDC æ—¥å¿—å’Œæ¥è‡ªè®¾æ–½çš„ä¼ æ„Ÿå™¨æ•°æ®â€”â€”ç„¶åé€šè¿‡ ETL æ­¥éª¤ä¼ é€’ï¼Œä»¥ä½¿æ´¾ç”Ÿè¡¨æ ¼å¯ç”¨äºæ•°æ®ä»“åº“å’Œæ•°æ®ç§‘å­¦å·¥ä½œè´Ÿè½½ï¼ˆå¦‚å›¾ 1 æ‰€ç¤ºï¼‰ã€‚ä¼ ç»Ÿçš„å®ç°éœ€è¦ç»“åˆæ¶ˆæ¯é˜Ÿåˆ—ï¼ˆå¦‚ Apache Kafka [11]ï¼‰æ¥è®¡ç®—éœ€è¦å®æ—¶è®¡ç®—çš„ä»»ä½•ç»“æœï¼Œæ•°æ®æ¹–ç”¨äºé•¿æœŸå­˜å‚¨ï¼Œä»¥åŠæ•°æ®ä»“åº“ï¼ˆå¦‚ Redshift [3]ï¼‰ç”¨äºéœ€è¦åˆ©ç”¨ç´¢å¼•å’Œå¿«é€ŸèŠ‚ç‚¹é™„åŠ å­˜å‚¨è®¾å¤‡ï¼ˆä¾‹å¦‚ SSDï¼‰è¿›è¡Œå¿«é€Ÿåˆ†ææŸ¥è¯¢çš„ç”¨æˆ·ã€‚è¿™éœ€è¦å¤šä¸ªæ•°æ®å‰¯æœ¬ï¼Œå¹¶æŒç»­å°†æ•°æ®å¯¼å…¥æ¯ä¸ªç³»ç»Ÿã€‚é€šè¿‡ Delta Lakeï¼Œå¯ä»¥æ ¹æ®å·¥ä½œè´Ÿè½½å°†å…¶ä¸­å‡ ä¸ªå­˜å‚¨ç³»ç»Ÿæ›¿æ¢ä¸ºå¯¹è±¡å­˜å‚¨è¡¨æ ¼ï¼Œåˆ©ç”¨ ACID äº‹åŠ¡ã€æµå¼ I/O å’Œ SSD ç¼“å­˜ç­‰åŠŸèƒ½æ¥æ¢å¤æ¯ä¸ªä¸“ç”¨ç³»ç»Ÿä¸­çš„ä¸€äº›æ€§èƒ½ä¼˜åŒ–ã€‚å°½ç®¡ Delta Lake æ˜¾ç„¶ä¸èƒ½æ›¿ä»£æˆ‘ä»¬åˆ—å‡ºçš„æ‰€æœ‰ç³»ç»ŸåŠŸèƒ½ï¼Œä½†æˆ‘ä»¬å‘ç°ï¼Œåœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œå®ƒè‡³å°‘å¯ä»¥æ›¿ä»£å…¶ä¸­ä¸€äº›ã€‚Delta çš„è¿æ¥å™¨ï¼ˆÂ§4.8ï¼‰è¿˜æ”¯æŒä»è®¸å¤šç°æœ‰å¼•æ“æŸ¥è¯¢å®ƒã€‚ ä¸ºä»€ä¹ˆå°±ä¸éœ€è¦æ¶ˆæ¯é˜Ÿåˆ—äº†å‘¢ï¼Ÿå› ä¸º ACID å¯ä»¥åšæµæ‰¹ï¼Ÿ ä¸€èˆ¬ delta lake æœ‰é«˜ååå’Œä½å»¶è¿Ÿçš„ä¿è¯å— è€Œä¸”æœ¬èº«å°±å½“ä½œ data warehouse äº†ï¼Œæ¯”å¦‚ redshift, bigquery, snowflake ç­‰ç­‰ ","date":"2024-11-11","objectID":"/posts/paper-delta-lake/:7:0","tags":["Paper Reading"],"title":"Paper Reading: Delta Lake High-Performance ACID Table Storage over Cloud Object Stores","uri":"/posts/paper-delta-lake/"},{"categories":null,"content":"Data Engineering and ETL augmenting traditional enterprise data sources (e.g., pointof-sale events in OLTP system) ML workloads ","date":"2024-11-11","objectID":"/posts/paper-delta-lake/:7:1","tags":["Paper Reading"],"title":"Paper Reading: Delta Lake High-Performance ACID Table Storage over Cloud Object Stores","uri":"/posts/paper-delta-lake/"},{"categories":null,"content":"Data Warehousing and BI business intelligence The key technical features to support these workloads are usually efficient storage formats (e.g. columnar formats), data access optimizations such as clustering and indexing, fast storage hardware, and a suitably optimized query engine ","date":"2024-11-11","objectID":"/posts/paper-delta-lake/:7:2","tags":["Paper Reading"],"title":"Paper Reading: Delta Lake High-Performance ACID Table Storage over Cloud Object Stores","uri":"/posts/paper-delta-lake/"},{"categories":null,"content":"Compliance and Reproducibility MLflow æ˜¯ Databricks å¼€å‘çš„å¼€æºæ¨¡å‹ç®¡ç†å¹³å°ï¼Œå¯ä»¥è‡ªåŠ¨è®°å½•ç”¨äºè®­ç»ƒ ML æ¨¡å‹çš„æ•°æ®é›†ç‰ˆæœ¬ï¼Œå¹¶è®©å¼€å‘äººå‘˜é‡æ–°åŠ è½½å®ƒã€‚ ","date":"2024-11-11","objectID":"/posts/paper-delta-lake/:7:3","tags":["Paper Reading"],"title":"Paper Reading: Delta Lake High-Performance ACID Table Storage over Cloud Object Stores","uri":"/posts/paper-delta-lake/"},{"categories":null,"content":"Specialized Use Cases è®°å½•äº†å¹¿æ³›çš„è®¡ç®—æœºç³»ç»Ÿäº‹ä»¶ï¼Œä¾‹å¦‚ç½‘ç»œä¸Šçš„ TCP å’Œ UDP æµã€èº«ä»½éªŒè¯è¯·æ±‚ã€SSH ç™»å½•ç­‰ï¼Œå¹¶å°†å…¶è®°å½•åˆ°ä¸€ç»„è·¨åº¦è¾¾æ•° PB çš„ Delta Lake è¡¨æ ¼ä¸­ã€‚å¤šä¸ªç¨‹åºåŒ– ETLã€SQLã€å›¾åˆ†æå’Œæœºå™¨å­¦ä¹ ä½œä¸šéšååœ¨è¿™äº›è¡¨æ ¼ä¸Šè¿è¡Œï¼Œä»¥æœç´¢å·²çŸ¥æ¨¡å¼ï¼Œè¿™äº›æ¨¡å¼è¡¨æ˜å­˜åœ¨å…¥ä¾µï¼ˆä¾‹å¦‚ï¼Œæ¥è‡ªç”¨æˆ·çš„å¯ç–‘ç™»å½•äº‹ä»¶ï¼Œæˆ–ä¸€ç»„æœåŠ¡å™¨å¯¼å‡ºå¤§é‡æ•°æ®ï¼‰ã€‚å…¶ä¸­è®¸å¤šæ˜¯æµå¼ä½œä¸šï¼Œä»¥æœ€å°åŒ–æ£€æµ‹é—®é¢˜çš„æ—¶é—´ã€‚æ­¤å¤–ï¼Œè¶…è¿‡ 100 ååˆ†æå¸ˆç›´æ¥æŸ¥è¯¢æºå’Œæ´¾ç”Ÿçš„ Delta Lake è¡¨æ ¼ï¼Œä»¥è°ƒæŸ¥å¯ç–‘è­¦æŠ¥æˆ–è®¾è®¡æ–°çš„è‡ªåŠ¨åŒ–ç›‘æ§ä½œä¸šã€‚ å› æ­¤è¯¥ç»„ç»‡ä½¿ç”¨ Delta Lake çš„ ZORDER BY åŠŸèƒ½é‡æ–°æ’åˆ— Parquet å¯¹è±¡ä¸­çš„è®°å½•ï¼Œä»¥æä¾›è·¨å¤šä¸ªç»´åº¦çš„èšç±»ã€‚ å°½ç®¡ä¼ ç»Ÿçš„ç”Ÿç‰©ä¿¡æ¯å­¦å·¥å…·ä½¿ç”¨äº†è‡ªå®šä¹‰æ•°æ®æ ¼å¼ï¼ˆå¦‚ SAMã€BAM å’Œ VCF [34, 24]ï¼‰ï¼Œä½†è®¸å¤šç»„ç»‡ç°åœ¨å°†è¿™äº›æ•°æ®å­˜å‚¨åœ¨æ•°æ®æ¹–æ ¼å¼ï¼ˆå¦‚ Parquetï¼‰ä¸­ã€‚Big Data Genomics é¡¹ç›® [37] å¼€åˆ›äº†è¿™ç§æ–¹æ³•ã€‚Delta Lake é€šè¿‡å¯ç”¨å¿«é€Ÿçš„å¤šç»´æŸ¥è¯¢ï¼ˆé€šè¿‡ Z-orderingï¼‰ã€ACID äº‹åŠ¡å’Œé«˜æ•ˆçš„ UPSERT å’Œ MERGEï¼Œè¿›ä¸€æ­¥å¢å¼ºäº†ç”Ÿç‰©ä¿¡æ¯å­¦å·¥ä½œè´Ÿè½½ã€‚ ä½¿ç”¨ Delta Lake ç®¡ç†å¤šåª’ä½“æ•°æ®é›†ï¼Œä¾‹å¦‚ä¸Šä¼ åˆ°ç½‘ç«™çš„ä¸€ç»„å›¾åƒ ML è¿™é‡Œåˆ°åº•æ€ä¹ˆåšçš„ï¼Œå›¾ç‰‡äºŒè¿›åˆ¶ç¼–ç ï¼Œæ€ä¹ˆå˜æˆ parquet ","date":"2024-11-11","objectID":"/posts/paper-delta-lake/:7:4","tags":["Paper Reading"],"title":"Paper Reading: Delta Lake High-Performance ACID Table Storage over Cloud Object Stores","uri":"/posts/paper-delta-lake/"},{"categories":null,"content":"PERFORMANCE EXPERIMENTS ç ”ç©¶äº†ï¼ˆ1ï¼‰å…·æœ‰å¤§é‡å¯¹è±¡æˆ–åˆ†åŒºçš„è¡¨æ ¼å¯¹å¼€æºå¤§æ•°æ®ç³»ç»Ÿçš„å½±å“ï¼Œè¿™ä¿ƒä½¿ Delta Lake å†³å®šå°†å…ƒæ•°æ®å’Œç»Ÿè®¡ä¿¡æ¯é›†ä¸­åˆ°æ£€æŸ¥ç‚¹ä¸­ï¼Œä»¥åŠï¼ˆ2ï¼‰Z-ordering å¯¹æ¥è‡ªå¤§å‹ Delta Lake ä½¿ç”¨æ¡ˆä¾‹çš„é€‰æ‹©æ€§æŸ¥è¯¢å·¥ä½œè´Ÿè½½çš„å½±å“ã€‚æˆ‘ä»¬è¿˜å±•ç¤ºäº† Delta åœ¨ TPC-DS ä¸Šçš„æŸ¥è¯¢æ€§èƒ½ä¼˜äº Parquetï¼Œå¹¶ä¸”å¯¹å†™å…¥å·¥ä½œè´Ÿè½½æ²¡æœ‰æ˜¾è‘—çš„å¼€é”€ã€‚ ","date":"2024-11-11","objectID":"/posts/paper-delta-lake/:8:0","tags":["Paper Reading"],"title":"Paper Reading: Delta Lake High-Performance ACID Table Storage over Cloud Object Stores","uri":"/posts/paper-delta-lake/"},{"categories":null,"content":"Impact of Many Objects or Partitions Delta Lake çš„è®¸å¤šè®¾è®¡å†³ç­–æºäºäº‘å¯¹è±¡å­˜å‚¨ä¸­åˆ—å‡ºå’Œè¯»å–å¯¹è±¡çš„é«˜å»¶è¿Ÿ å°æ–‡ä»¶åœ¨ HDFS [36] ä¸­ä¹Ÿæ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œä½†åœ¨äº‘å­˜å‚¨ä¸­çš„æ€§èƒ½å½±å“æ›´ä¸¥é‡ã€‚ ","date":"2024-11-11","objectID":"/posts/paper-delta-lake/:8:1","tags":["Paper Reading"],"title":"Paper Reading: Delta Lake High-Performance ACID Table Storage over Cloud Object Stores","uri":"/posts/paper-delta-lake/"},{"categories":null,"content":"Impact of Z-Ordering Z-Ordering æ˜¯ä¸€ç§ç”¨äºå¤šç»´æ•°æ®çš„ç©ºé—´å¡«å……æ›²çº¿ä¼˜åŒ–æŠ€æœ¯ï¼Œæ—¨åœ¨æé«˜æ•°æ®è¯»å–æ€§èƒ½ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤§æ•°æ®ç¯å¢ƒä¸­ã€‚å®ƒé€šè¿‡å°†æ•°æ®æŒ‰å¤šç»´ç©ºé—´ä¸­çš„ Z å½¢é¡ºåºé‡æ–°æ’åºï¼Œæœ€å¤§é™åº¦åœ°æé«˜æ•°æ®çš„å±€éƒ¨æ€§ï¼Œä»è€Œæé«˜æŸ¥è¯¢æ•ˆç‡ã€‚Z-Ordering åœ¨å¤„ç†å…·æœ‰å¤šåˆ—è¿‡æ»¤æ¡ä»¶çš„æŸ¥è¯¢æ—¶ç‰¹åˆ«æœ‰æ•ˆ å¤šç»´æŸ¥è¯¢ï¼šå½“æŸ¥è¯¢åŒ…å«å¤šä¸ªè¿‡æ»¤æ¡ä»¶ï¼ˆå¦‚ age å’Œ incomeï¼‰æ—¶ï¼ŒZ-Ordering å¯ä»¥æ˜¾è‘—æé«˜æŸ¥è¯¢æ€§èƒ½ã€‚ å¤§æ•°æ®å¤„ç†ï¼šåœ¨å¤„ç†å¤§é‡æ•°æ®æ—¶ï¼Œé€šè¿‡ Z-Ordering å¯ä»¥å‡å°‘ I/O æ“ä½œï¼Œæé«˜æ•°æ®è¯»å–æ•ˆç‡ã€‚ ","date":"2024-11-11","objectID":"/posts/paper-delta-lake/:8:2","tags":["Paper Reading"],"title":"Paper Reading: Delta Lake High-Performance ACID Table Storage over Cloud Object Stores","uri":"/posts/paper-delta-lake/"},{"categories":null,"content":"TPC-DS Performance ä¸ºäº†è¯„ä¼° Delta Lake åœ¨æ ‡å‡† DBMS åŸºå‡†æµ‹è¯•ä¸­çš„ç«¯åˆ°ç«¯æ€§èƒ½ï¼Œæˆ‘ä»¬åœ¨ Databricks Runtimeï¼ˆæˆ‘ä»¬çš„ Apache Spark å®ç°ï¼‰ä¸Šä½¿ç”¨ Delta Lake å’Œ Parquet æ–‡ä»¶æ ¼å¼ï¼Œä»¥åŠåœ¨æµè¡Œäº‘æœåŠ¡ä¸­çš„ Spark å’Œ Presto å®ç°ä¸Šè¿è¡Œäº† TPC-DS åŠŸç‡æµ‹è¯• ","date":"2024-11-11","objectID":"/posts/paper-delta-lake/:8:3","tags":["Paper Reading"],"title":"Paper Reading: Delta Lake High-Performance ACID Table Storage over Cloud Object Stores","uri":"/posts/paper-delta-lake/"},{"categories":null,"content":"Write Performance ","date":"2024-11-11","objectID":"/posts/paper-delta-lake/:8:4","tags":["Paper Reading"],"title":"Paper Reading: Delta Lake High-Performance ACID Table Storage over Cloud Object Stores","uri":"/posts/paper-delta-lake/"},{"categories":null,"content":"DISCUSSION AND LIMITATIONS æˆ‘ä»¬åœ¨ Delta Lake ä¸Šçš„ç»éªŒè¡¨æ˜ï¼Œè®¸å¤šä¼ä¸šæ•°æ®å¤„ç†å·¥ä½œè´Ÿè½½å¯ä»¥åœ¨äº‘å¯¹è±¡å­˜å‚¨ä¸Šå®ç° ACID äº‹åŠ¡ï¼Œå¹¶ä¸”å®ƒä»¬å¯ä»¥æ”¯æŒå¤§è§„æ¨¡çš„æµå¼ã€æ‰¹å¤„ç†å’Œäº¤äº’å¼å·¥ä½œè´Ÿè½½ã€‚Delta Lake çš„è®¾è®¡ç‰¹åˆ«æœ‰å¸å¼•åŠ›ï¼Œå› ä¸ºå®ƒä¸éœ€è¦ä»»ä½•å…¶ä»–é‡é‡çº§ç³»ç»Ÿæ¥è°ƒè§£å¯¹äº‘å­˜å‚¨çš„è®¿é—®ï¼Œä½¿å…¶æ˜“äºéƒ¨ç½²ï¼Œå¹¶ä¸”å¯ä»¥ç›´æ¥ä»æ”¯æŒ Parquet çš„å¹¿æ³›æŸ¥è¯¢å¼•æ“è®¿é—®ã€‚Delta Lake å¯¹ ACID çš„æ”¯æŒç„¶åå¯ç”¨äº†å…¶ä»–å¼ºå¤§çš„æ€§èƒ½å’Œç®¡ç†åŠŸèƒ½ã€‚ å°½ç®¡å¦‚æ­¤ï¼ŒDelta Lake çš„è®¾è®¡å’Œå½“å‰å®ç°æœ‰ä¸€äº›é™åˆ¶ï¼Œè¿™äº›é™åˆ¶æ˜¯æœªæ¥å·¥ä½œçš„æœ‰è¶£é€”å¾„ã€‚é¦–å…ˆï¼ŒDelta Lake ç›®å‰ä»…åœ¨å•ä¸ªè¡¨æ ¼å†…æä¾›åºåˆ—åŒ–äº‹åŠ¡ï¼Œå› ä¸ºæ¯ä¸ªè¡¨æ ¼éƒ½æœ‰è‡ªå·±çš„äº‹åŠ¡æ—¥å¿—ã€‚è·¨å¤šä¸ªè¡¨æ ¼å…±äº«äº‹åŠ¡æ—¥å¿—å°†æ¶ˆé™¤è¿™ä¸€é™åˆ¶ï¼Œä½†å¯èƒ½ä¼šå¢åŠ é€šè¿‡ä¹è§‚å¹¶å‘è¿½åŠ æ—¥å¿—è®°å½•çš„äº‰ç”¨ã€‚å¯¹äºéå¸¸é«˜çš„äº‹åŠ¡é‡ï¼Œåè°ƒå™¨ä¹Ÿå¯ä»¥åœ¨ä¸æˆä¸ºæ•°æ®å¯¹è±¡çš„è¯»å†™è·¯å¾„ä¸€éƒ¨åˆ†çš„æƒ…å†µä¸‹è°ƒè§£å¯¹æ—¥å¿—çš„å†™è®¿é—®ã€‚ å…¶æ¬¡ï¼Œå¯¹äºæµå¼å·¥ä½œè´Ÿè½½ï¼ŒDelta Lake å—é™äºåº•å±‚äº‘å¯¹è±¡å­˜å‚¨çš„å»¶è¿Ÿã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨å¯¹è±¡å­˜å‚¨æ“ä½œå¾ˆéš¾å®ç°æ¯«ç§’çº§çš„æµå¼å»¶è¿Ÿã€‚ç„¶è€Œï¼Œæˆ‘ä»¬å‘ç°ï¼Œå¯¹äºå¸Œæœ›è¿è¡Œå¹¶è¡Œä½œä¸šçš„å¤§è§„æ¨¡ä¼ä¸šå·¥ä½œè´Ÿè½½ï¼Œä½¿ç”¨ Delta Lake è¡¨æ ¼çš„ç§’çº§å»¶è¿Ÿæ˜¯å¯ä»¥æ¥å—çš„ã€‚ ç¬¬ä¸‰ï¼ŒDelta Lake ç›®å‰ä¸æ”¯æŒäºŒçº§ç´¢å¼•ï¼ˆé™¤äº†æ¯ä¸ªæ•°æ®å¯¹è±¡çš„æœ€å°/æœ€å¤§ç»Ÿè®¡ä¿¡æ¯ï¼‰ï¼Œä½†æˆ‘ä»¬å·²ç»å¼€å§‹åŸå‹åŒ–åŸºäº Bloom è¿‡æ»¤å™¨çš„ç´¢å¼•ã€‚Delta çš„ ACID äº‹åŠ¡å…è®¸æˆ‘ä»¬ä¸åŸºç¡€æ•°æ®çš„æ›´æ”¹ä¸€èµ·äº‹åŠ¡æ€§åœ°æ›´æ–°æ­¤ç±»ç´¢å¼•ã€‚ ","date":"2024-11-11","objectID":"/posts/paper-delta-lake/:9:0","tags":["Paper Reading"],"title":"Paper Reading: Delta Lake High-Performance ACID Table Storage over Cloud Object Stores","uri":"/posts/paper-delta-lake/"},{"categories":null,"content":"RELATED WORK ","date":"2024-11-11","objectID":"/posts/paper-delta-lake/:10:0","tags":["Paper Reading"],"title":"Paper Reading: Delta Lake High-Performance ACID Table Storage over Cloud Object Stores","uri":"/posts/paper-delta-lake/"},{"categories":null,"content":"CONCLUSION ","date":"2024-11-11","objectID":"/posts/paper-delta-lake/:11:0","tags":["Paper Reading"],"title":"Paper Reading: Delta Lake High-Performance ACID Table Storage over Cloud Object Stores","uri":"/posts/paper-delta-lake/"},{"categories":null,"content":"Ownership: A Distributed Futures System for Fine-Grained Tasks åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„ä¸€äº›ä»»åŠ¡è°ƒåº¦çš„è®ºæ–‡ï¼Œæœ¬æ¥æ˜¯è¦çœ‹ Ray çš„ï¼ŒåŒæ ·éƒ½æ˜¯ UCB çš„ç ”ç©¶ï¼ˆåˆ†å¸ƒå¼æœºå™¨å­¦ä¹ æ¡†æ¶ï¼‰ Ownership æˆ‘ä¸€å¼€å§‹è¿˜ä»¥ä¸ºæ˜¯ Rust é‡Œçš„æ‰€æœ‰æƒæ¦‚å¿µï¼Œå¼„æ··äº†ï¼Œè®ºæ–‡ä¹Ÿæåˆ°è®¸å¤š Futures, distributed futures interface ä¹‹ç±»çš„ç¬¬ä¸€æ¬¡æ¥è§¦ï¼Œå®é™…ä¸Šæ˜¯ RPC çš„æ‰©å±• æœ€é‡è¦çš„æ¦‚å¿µæ˜¯ Distributed Memory + Ref + Future ä¸å†éœ€è¦ç»å…¸çš„ RPC å€¼ä¼ é€’ï¼Œ A call worker1 å¾—åˆ° o1 å°±è¿”å›å¼•ç”¨è€Œä¸æ˜¯ o1 A call worker2 å¾—åˆ° o2 è¿”å›å¼•ç”¨ A call worker2 o1+o2ï¼Œworker2 è§£å¼•ç”¨å» w1 æ‰¾ o1 future å°±æ˜¯å¼‚æ­¥ï¼Œä½†æ˜¯ è§£å¼•ç”¨çš„æ—¶å€™å°±ä¼šæœ‰å¾ˆå¤šé—®é¢˜ï¼Œæ‰€ä»¥æœ‰äº†è¿™ç¯‡è®ºæ–‡ï¼Œä½†çœ‹ä¸‹æ¥æ„Ÿè§‰ä¸»é¢˜ä¸å¤ªæ¸…æ™°ï¼Œæ•ˆæœä¹Ÿä¸å¤ªä¼˜ç§€ï¼Œä¸å¤ªä»¤äººä¿¡æœã€‚ ","date":"2024-11-10","objectID":"/posts/paper-ownership/:1:0","tags":["Paper Reading"],"title":"Paper Reading: Ownership: A Distributed Futures System for Fine-Grained Tasks","uri":"/posts/paper-ownership/"},{"categories":null,"content":"Abstract åˆ†å¸ƒå¼ Futures æ¥å£ distributed futures interface Distributed futures are an extension of RPC that combines futures and distributed memory åˆ†å¸ƒå¼ futures æ˜¯ä¸€ä¸ªå¼•ç”¨ï¼Œå…¶æœ€ç»ˆå€¼å¯èƒ½å­˜å‚¨åœ¨è¿œç¨‹èŠ‚ç‚¹ä¸Šã€‚ ç„¶åï¼Œåº”ç”¨ç¨‹åºå¯ä»¥åœ¨ä¸æŒ‡å®šæ‰§è¡Œæ—¶é—´æˆ–æ•°æ®ç§»åŠ¨ä½ç½®çš„æƒ…å†µä¸‹è¡¨è¾¾åˆ†å¸ƒå¼è®¡ç®—ã€‚ æœ€è¿‘çš„åˆ†å¸ƒå¼ Futures åº”ç”¨ç¨‹åºéœ€è¦æ‰§è¡Œç»†ç²’åº¦è®¡ç®—çš„èƒ½åŠ›ï¼Œå³åœ¨æ¯«ç§’çº§è¿è¡Œçš„ä»»åŠ¡ã€‚ä¸ç²—ç²’åº¦ä»»åŠ¡ç›¸æ¯”ï¼Œç»†ç²’åº¦ä»»åŠ¡éš¾ä»¥ä»¥å¯æ¥å—çš„ç³»ç»Ÿå¼€é”€æ‰§è¡Œã€‚ åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ç§ç”¨äºç»†ç²’åº¦ä»»åŠ¡çš„åˆ†å¸ƒå¼ Futures ç³»ç»Ÿï¼Œè¯¥ç³»ç»Ÿåœ¨ä¸ç‰ºç‰²æ€§èƒ½çš„æƒ…å†µä¸‹æä¾›å®¹é”™èƒ½åŠ›ã€‚æˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆåŸºäºä¸€ç§ç§°ä¸º Ownership çš„å…¨æ–°æ¦‚å¿µï¼Œè¯¥æ¦‚å¿µä¸ºæ¯ä¸ªå¯¹è±¡åˆ†é…ä¸€ä¸ªç³»ç»Ÿæ“ä½œçš„leaderã€‚æˆ‘ä»¬è¡¨æ˜ï¼Œè¿™ç§å»ä¸­å¿ƒåŒ–çš„æ¶æ„å¯ä»¥å®ç°æ°´å¹³æ‰©å±•ã€æ¯ä»»åŠ¡ 1 æ¯«ç§’çš„å»¶è¿Ÿå’Œå¿«é€Ÿæ•…éšœå¤„ç†ã€‚ ","date":"2024-11-10","objectID":"/posts/paper-ownership/:2:0","tags":["Paper Reading"],"title":"Paper Reading: Ownership: A Distributed Futures System for Fine-Grained Tasks","uri":"/posts/paper-ownership/"},{"categories":null,"content":"Introduction RPC æ˜¯æ„å»ºåˆ†å¸ƒå¼åº”ç”¨ç¨‹åºçš„æ ‡å‡†ï¼Œæœ€åˆçš„ææ¡ˆä½¿ç”¨åŒæ­¥è°ƒç”¨ synchronousï¼Œå°†è¿”å›å€¼å¤åˆ¶å›è°ƒç”¨è€… æœ€è¿‘çš„ä¸€äº›ç³»ç»Ÿ [4, 34, 37, 45] æ‰©å±•äº† RPCï¼Œä½¿å¾—ç³»ç»Ÿä¸ä»…å¯ä»¥ç®¡ç†åˆ†å¸ƒå¼é€šä¿¡ï¼Œè¿˜å¯ä»¥ä»£è¡¨åº”ç”¨ç¨‹åºç®¡ç†æ•°æ®ç§»åŠ¨å’Œå¹¶è¡Œæ€§ã€‚ PyTorch - Remote Reference Protocol. Ray è¿™äº›åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ä½¿ç”¨ rpcï¼ŒA èŠ‚ç‚¹è°ƒç”¨ B èŠ‚ç‚¹çš„æ–¹æ³•ï¼Œä¼ å…¥å‚æ•°ï¼Œè¿”å›ç»“æœæ˜¯ä¸€ä¸ªè¿œç¨‹å¼•ç”¨ rrefï¼Œå¯ä»¥é€šè¿‡ç§»åˆ°æœ¬åœ°è€Œä¸æ˜¯è¿”å›å€¼ Data movement: æŒ‰å€¼ä¼ é€’è¯­ä¹‰è¦æ±‚æ‰€æœ‰ RPC å‚æ•°é€šè¿‡ç›´æ¥å¤åˆ¶åˆ°è¯·æ±‚ä½“ä¸­å‘é€ç»™æ‰§è¡Œè€… ä¸ºäº†å‡å°‘æ•°æ®å¤åˆ¶ï¼Œä¸€äº› RPC ç³»ç»Ÿä½¿ç”¨åˆ†å¸ƒå¼å†…å­˜ï¼Œè¿™å…è®¸é€šè¿‡å¼•ç”¨ä¼ é€’å¤§å‚æ•°ï¼Œè€Œå°å‚æ•°ä»ç„¶å¯ä»¥é€šè¿‡å€¼ä¼ é€’ã€‚åœ¨æœ€ç†æƒ³çš„æƒ…å†µä¸‹ï¼Œå¦‚æœå‚æ•°å·²ç»ä½äºæ‰§è¡Œè€…æ‰€åœ¨çš„åŒä¸€èŠ‚ç‚¹ä¸Šï¼Œåˆ™é€šè¿‡å¼•ç”¨ä¼ é€’çš„ RPC å‚æ•°ä¸éœ€è¦å¤åˆ¶ã€‚è¯·æ³¨æ„ï¼Œä¸ä¼ ç»Ÿçš„ RPC ä¸€æ ·ï¼Œæˆ‘ä»¬ä½¿æ‰€æœ‰å€¼ä¸å¯å˜ï¼Œä»¥ç®€åŒ–ä¸€è‡´æ€§æ¨¡å‹å’Œå®ç°ã€‚ å€¼ä¸å¯ä»¥å˜ï¼Ÿç±»ä¼¼å‡½æ•°å¼ç¼–ç¨‹ï¼Ÿç¼ºç‚¹æ˜¯å†…å­˜ä½¿ç”¨å¢åŠ  Parallelism: ä¼ ç»Ÿçš„ RPC æ˜¯é˜»å¡çš„ï¼Œå› æ­¤åªæœ‰åœ¨æ”¶åˆ°å›å¤åæ‰ä¼šå°†æ§åˆ¶æƒè¿”å›ç»™è°ƒç”¨è€…ï¼ˆå›¾ 2aï¼‰ã€‚Futuresï¼ˆFuturesï¼‰æ˜¯ä¸€ç§æµè¡Œçš„æ–¹æ³•ï¼Œç”¨äºé€šè¿‡å¼‚æ­¥æ€§æ‰©å±• RPC [8, 29]ï¼Œå…è®¸ç³»ç»Ÿåœ¨å½¼æ­¤ä¹‹é—´ä»¥åŠä¸è°ƒç”¨è€…å¹¶è¡Œæ‰§è¡Œå‡½æ•°ã€‚é€šè¿‡ç»„åˆ [29, 37]ï¼Œå³å°† Futures ä½œä¸ºå‚æ•°ä¼ é€’ç»™å¦ä¸€ä¸ª RPCï¼Œåº”ç”¨ç¨‹åºè¿˜å¯ä»¥è¡¨è¾¾ Futures RPC çš„å¹¶è¡Œæ€§å’Œä¾èµ–å…³ç³»ã€‚ä¾‹å¦‚ï¼Œåœ¨å›¾ 2c ä¸­ï¼Œadd åœ¨ç¨‹åºå¼€å§‹æ—¶è¢«è°ƒç”¨ï¼Œä½†åªæœ‰åœ¨è®¡ç®—å‡º a å’Œ b ä¹‹åï¼Œç³»ç»Ÿæ‰ä¼šæ‰§è¡Œã€‚ Distributed futures: RPC çš„æ‰©å±•ï¼Œç»“åˆäº† Futures å’Œåˆ†å¸ƒå¼å†…å­˜ï¼šåˆ†å¸ƒå¼ Futures æ˜¯ä¸€ä¸ªå¼•ç”¨ï¼Œå…¶æœ€ç»ˆå€¼å¯èƒ½å­˜å‚¨åœ¨è¿œç¨‹èŠ‚ç‚¹ä¸Šï¼ˆå›¾ 2dï¼‰ã€‚ç„¶åï¼Œåº”ç”¨ç¨‹åºå¯ä»¥åœ¨ä¸æŒ‡å®šæ‰§è¡Œæ—¶é—´æˆ–æ•°æ®ç§»åŠ¨ä½ç½®çš„æƒ…å†µä¸‹è¡¨è¾¾åˆ†å¸ƒå¼è®¡ç®—ã€‚è¿™å¯¹äºå¼€å‘å¤„ç†å¤§é‡æ•°æ®çš„åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºæ¥è¯´æ˜¯ä¸€ä¸ªè¶Šæ¥è¶Šå—æ¬¢è¿çš„æ¥å£ã€‚ è¿™ä¸ª Future å¤ªè¿·æƒ‘äº†ï¼Œæˆ‘æ€»æŠŠ Rust é‡Œçš„ Future å¼‚æ­¥ç¼–ç¨‹å¼„æ·· å¯èƒ½è¿™ç§å¼‚æ­¥è®¡ç®—éƒ½å¯ä»¥å« Future / Promises Futures are a popular method for extending RPC with asynchrony ä¸å¹¸çš„æ˜¯ï¼Œç°æœ‰çš„åˆ†å¸ƒå¼ Futures ç³»ç»Ÿä»…é™äºç²—ç²’åº¦ä»»åŠ¡ åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ç§ç”¨äºç»†ç²’åº¦ä»»åŠ¡çš„åˆ†å¸ƒå¼ Futures ç³»ç»Ÿã€‚è™½ç„¶å…¶ä»–äºº [34, 37, 45] ä¹‹å‰å·²ç»å®ç°äº†åˆ†å¸ƒå¼ Futuresï¼Œä½†æˆ‘ä»¬çš„è´¡çŒ®åœ¨äºè¯†åˆ«å¹¶è§£å†³äº†åœ¨ä¸ç‰ºç‰²æ€§èƒ½çš„æƒ…å†µä¸‹ä¸ºç»†ç²’åº¦ä»»åŠ¡æä¾›å®¹é”™èƒ½åŠ›çš„æŒ‘æˆ˜ã€‚ 34 Ray, CIEL, Dask è¿™äº›éƒ½å®ç°äº†åˆ†å¸ƒå¼ Future ä¸»è¦æŒ‘æˆ˜æ˜¯åˆ†å¸ƒå¼ Futures åœ¨è¿›ç¨‹ä¹‹é—´å¼•å…¥äº†å…±äº«çŠ¶æ€ã€‚ç‰¹åˆ«æ˜¯ï¼Œä¸€ä¸ªå¯¹è±¡åŠå…¶å…ƒæ•°æ®ç”±å…¶å¼•ç”¨æŒæœ‰è€…ã€åˆ›å»ºå¯¹è±¡çš„ RPC æ‰§è¡Œè€…ä»¥åŠå…¶ç‰©ç†ä½ç½®å…±äº«ã€‚ä¸ºäº†ç¡®ä¿æ¯ä¸ªå¼•ç”¨æŒæœ‰è€…èƒ½å¤Ÿè§£å¼•ç”¨å€¼ï¼Œè¿›ç¨‹å¿…é¡»åè°ƒ coordinateï¼Œè¿™æ˜¯ä¸€ä¸ªåœ¨å­˜åœ¨æ•…éšœæ—¶éš¾ä»¥è§£å†³çš„é—®é¢˜ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œä¼ ç»Ÿçš„ RPC æ²¡æœ‰å…±äº«çŠ¶æ€ï¼Œå› ä¸ºæ•°æ®æ˜¯é€šè¿‡å€¼ä¼ é€’çš„ï¼Œå¹¶ä¸”è‡ªç„¶é¿å…äº†åè°ƒï¼Œè¿™å¯¹äºå¯æ‰©å±•æ€§å’Œä½å»¶è¿Ÿè‡³å…³é‡è¦ã€‚ ä¾‹å¦‚ï¼Œåœ¨å›¾ 2a ä¸­ï¼Œä¸€æ—¦ worker 1 å°† a å¤åˆ¶åˆ° driverï¼Œå®ƒ (worker1) å°±ä¸éœ€è¦å‚ä¸ä¸‹æ¸¸ add ä»»åŠ¡çš„æ‰§è¡Œã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œworker 1 åœ¨å›¾ 2d ä¸­å­˜å‚¨äº† aï¼Œå› æ­¤ä¸¤ä¸ª worker å¿…é¡»åè°ƒä»¥ç¡®ä¿ a åœ¨ worker 2 è¯»å–æ—¶è¶³å¤Ÿé•¿æ—¶é—´å¯ç”¨ã€‚æ­¤å¤–ï¼Œworker 1 å¿…é¡»åœ¨ worker 2 æ‰§è¡Œ add å¹¶ä¸”æ²¡æœ‰å…¶ä»–å¼•ç”¨æ—¶å¯¹ a è¿›è¡Œåƒåœ¾å›æ”¶ã€‚æœ€åï¼Œè¿›ç¨‹å¿…é¡»åè°ƒä»¥æ£€æµ‹å’Œæ¢å¤å¦ä¸€ä¸ªè¿›ç¨‹çš„æ•…éšœã€‚ ä»¥å‰ç³»ç»Ÿä¸­çš„å¸¸è§è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨é›†ä¸­å¼ä¸»èŠ‚ç‚¹æ¥å­˜å‚¨ç³»ç»ŸçŠ¶æ€å¹¶åè°ƒè¿™äº›æ“ä½œï¼Œç¡®ä¿å®¹é”™çš„ä¸€ç§ç®€å•æ–¹æ³•æ˜¯å°†ä¸æ“ä½œç›¸å…³çš„å…ƒæ•°æ®åŒæ­¥è®°å½•å’Œå¤åˆ¶åˆ°ä¸»èŠ‚ç‚¹ã€‚ Ray ä½¿ç”¨äº†ä¸»èŠ‚ç‚¹ Head Node https://docs.ray.io/en/latest/cluster/key-concepts.html åªè¦ä¿è¯ a ä¸ä¼šåœ¨è°ƒç”¨ add å‰è¢«åƒåœ¾å›æ”¶ï¼Ÿray ç”¨ head node æ¥ä»»åŠ¡è°ƒåº¦ã€èµ„æºç®¡ç† å› æ­¤ï¼Œåˆ†æ•£ç³»ç»ŸçŠ¶æ€å¯¹äºå¯æ‰©å±•æ€§æ˜¯å¿…è¦çš„ã€‚é—®é¢˜æ˜¯å¦‚ä½•åœ¨ä¸å¤æ‚åŒ–åè°ƒçš„æƒ…å†µä¸‹åšåˆ°è¿™ä¸€ç‚¹ã€‚æˆ‘ä»¬å·¥ä½œçš„å…³é”®è§è§£æ˜¯åˆ©ç”¨åº”ç”¨ç¨‹åºç»“æ„ï¼šåˆ†å¸ƒå¼ Futures å¯ä»¥é€šè¿‡å¼•ç”¨ä¼ é€’å…±äº«ï¼Œä½†å¤§å¤šæ•°åˆ†å¸ƒå¼ Futures åœ¨è°ƒç”¨è€…çš„èŒƒå›´å†…å…±äº«ã€‚ä¾‹å¦‚ï¼Œåœ¨å›¾ 1 ä¸­ï¼Œa_future è¢«åˆ›å»ºç„¶åä¼ é€’ç»™åŒä¸€èŒƒå›´å†…çš„ addã€‚ å› æ­¤ï¼Œæˆ‘ä»¬æå‡ºäº†æ‰€æœ‰æƒï¼Œä¸€ç§åœ¨ RPC executors ä¹‹é—´åˆ†æ•£ç³»ç»ŸçŠ¶æ€çš„æ–¹æ³•ã€‚ç‰¹åˆ«æ˜¯ï¼Œä»»åŠ¡çš„è°ƒç”¨è€…æ˜¯è¿”å›çš„ Futures åŠå…¶ç›¸å…³å…ƒæ•°æ®çš„æ‹¥æœ‰è€…ã€‚åœ¨å›¾ 2d ä¸­ï¼Œdriver æ‹¥æœ‰ aã€b å’Œ cã€‚ è¿™ä¸ªè§£å†³æ–¹æ¡ˆæœ‰ä¸‰ä¸ªä¼˜ç‚¹ã€‚é¦–å…ˆï¼Œå¯¹äº horizontal scalingï¼Œåº”ç”¨ç¨‹åºå¯ä»¥ä½¿ç”¨åµŒå¥—ä»»åŠ¡å°†ç³»ç»ŸçŠ¶æ€â€œåˆ†ç‰‡â€åˆ° worker ä¸Šã€‚ å…¶æ¬¡ï¼Œç”±äº Futures çš„æ‹¥æœ‰è€…æ˜¯ä»»åŠ¡çš„è°ƒç”¨è€…ï¼Œä»»åŠ¡å»¶è¿Ÿè¾ƒä½ï¼Œå› ä¸ºæ‰€éœ€çš„å…ƒæ•°æ®å†™å…¥è™½ç„¶æ˜¯åŒæ­¥çš„ï¼Œä½†å´æ˜¯æœ¬åœ°çš„ã€‚è¿™ä¸ä¸€è‡´æ€§å“ˆå¸Œç­‰åº”ç”¨ç¨‹åºæ— å…³çš„åˆ†ç‰‡æ–¹æ³•å½¢æˆå¯¹æ¯”ã€‚ç¬¬ä¸‰ï¼Œæ¯ä¸ª worker å®é™…ä¸Šæˆä¸ºäº†å®ƒæ‰€æ‹¥æœ‰çš„åˆ†å¸ƒå¼ Futures çš„é›†ä¸­å¼ä¸»èŠ‚ç‚¹ï¼Œç®€åŒ–äº†æ•…éšœå¤„ç†ã€‚ æ°´å¹³æ‰©å±•å°±æ˜¯åŠ æœºå™¨ å’Œä¸€è‡´æ€§å“ˆå¸Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿå†™å…¥å…ƒæ•°æ®å†™æœ¬åœ°ï¼Œä¸å…¶ä»–èŠ‚ç‚¹æ— å…³ï¼Ÿè€Œä¸€è‡´æ€§å“ˆå¸Œéœ€è¦æ‰€æœ‰èŠ‚ç‚¹éƒ½çŸ¥é“ï¼Ÿ ç³»ç»Ÿä¿è¯å¦‚æœ Futures çš„æ‹¥æœ‰è€…å­˜æ´»ï¼Œä»»ä½•æŒæœ‰è¯¥ Futures å¼•ç”¨çš„ä»»åŠ¡æœ€ç»ˆéƒ½å¯ä»¥è§£å¼•ç”¨è¯¥å€¼ã€‚è¿™æ˜¯å› ä¸ºæ‹¥æœ‰è€…å°†åè°ƒç³»ç»Ÿæ“ä½œï¼Œå¦‚å¼•ç”¨è®¡æ•°ï¼ˆç”¨äºå†…å­˜å®‰å…¨ï¼‰å’Œ lineage reconstructionï¼ˆç”¨äºæ¢å¤ï¼‰ã€‚å½“ç„¶ï¼Œå¦‚æœæ‹¥æœ‰è€…å¤±è´¥ï¼Œè¿™è¿˜ä¸å¤Ÿã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä¾èµ–äº lineage reconstruction å’Œå¯¹åº”ç”¨ç¨‹åºç»“æ„çš„ç¬¬äºŒä¸ªå…³é”®è§è§£ï¼šåœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œå¯¹åˆ†å¸ƒå¼æœªæ¥çš„å¼•ç”¨ç”±å¤±è´¥æ‹¥æœ‰è€…çš„åä»£ä»»åŠ¡æŒæœ‰ã€‚å¤±è´¥çš„ä»»åŠ¡å¯ä»¥é€šè¿‡å…¶æ‹¥æœ‰è€…çš„è¡€ç»Ÿé‡å»ºé‡æ–°åˆ›å»ºï¼Œåä»£ä»»åŠ¡ä¹Ÿå°†åœ¨æ­¤è¿‡ç¨‹ä¸­é‡æ–°åˆ›å»ºã€‚å› æ­¤ï¼Œä¸ futures çš„æ‹¥æœ‰è€…å…±äº«ä»»ä½•æŒæœ‰åˆ†å¸ƒå¼æœªæ¥å¼•ç”¨çš„ä»»åŠ¡æ˜¯å®‰å…¨çš„ã€‚ç”±äºæˆ‘ä»¬é¢„è®¡æ•…éšœç›¸å¯¹è¾ƒå°‘ï¼Œæˆ‘ä»¬è®¤ä¸ºè¿™ç§å‡å°‘ç³»ç»Ÿå¼€é”€å’Œå¤æ‚æ€§çš„å¥½å¤„è¶…è¿‡äº†æ•…éšœæ—¶é¢å¤–é‡æ–°æ‰§è¡Œçš„æˆæœ¬ã€‚ æ€»ä¹‹ï¼Œæˆ‘ä»¬çš„è´¡çŒ®æ˜¯ï¼š ä¸€ç§å…·æœ‰ transparent recovery å’Œ automatic memory management åˆ†å¸ƒå¼æœªæ¥çš„å»ä¸­å¿ƒåŒ–ç³»ç»Ÿã€‚ ä¸€ç§åŸºäº lineage reconstruction and fate sharing çš„è½»é‡çº§é€æ˜æ¢å¤æŠ€æœ¯ã€‚ åœ¨ Ray ç³»ç»Ÿ [34] ä¸­çš„å®ç°ï¼Œæä¾›äº†é«˜ååé‡ã€ä½å»¶è¿Ÿå’Œå¿«é€Ÿæ¢å¤ã€‚ åˆ†å¸ƒå¼æ•°æ®åº“åº”è¯¥æ¯”è¾ƒå¸¸ç”¨ checkpoint + log æ¥åšæ•…éšœæ¢å¤æŠŠï¼Ÿ ","date":"2024-11-10","objectID":"/posts/paper-ownership/:3:0","tags":["Paper Reading"],"title":"Paper Reading: Ownership: A Distributed Futures System for Fine-Grained Tasks","uri":"/posts/paper-ownership/"},{"categories":null,"content":"Distributed Futures ","date":"2024-11-10","objectID":"/posts/paper-ownership/:4:0","tags":["Paper Reading"],"title":"Paper Reading: Ownership: A Distributed Futures System for Fine-Grained Tasks","uri":"/posts/paper-ownership/"},{"categories":null,"content":"API åˆ†å¸ƒå¼æœªæ¥çš„ä¸»è¦ä¼˜åŠ¿åœ¨äºç³»ç»Ÿå¯ä»¥ transparently manage parallelism å’Œ data movement f æ˜¯è°ƒç”¨å‡½æ•°ï¼Œä¼ å…¥ x å¼•ç”¨ get(x) æ˜¯è§£å¼•ç”¨ï¼Œdel(x) åˆ é™¤å¼•ç”¨ Actor.f(x) å¸¦çŠ¶æ€è°ƒç”¨ f shared(x) è¿”å› shared çŠ¶æ€å¯ä»¥ä¼  x åˆ°å…¶ä»– workerï¼Œè€Œä¸ç”¨è§£å¼•ç”¨ f(shared x) ä¼ é€ x å½“ä½œ first-class ï¼Œä¼šè§£å¼•ç”¨ x Distributed Futures ç¼©å†™ DFut To spawn a task, è°ƒç”¨è€…è°ƒç”¨ä¸€ä¸ªè¿œç¨‹å‡½æ•°ï¼Œè¯¥å‡½æ•°ç«‹å³è¿”å›ä¸€ä¸ª DFutï¼ˆè¡¨ 1ï¼‰ã€‚å¯åŠ¨çš„ä»»åŠ¡åŒ…æ‹¬å‡½æ•°åŠå…¶å‚æ•°ã€èµ„æºéœ€æ±‚ç­‰ã€‚è¿”å›çš„ DFut å¼•ç”¨ç”±å‡½æ•°è¿”å›çš„å¯¹è±¡çš„å€¼ã€‚è°ƒç”¨è€…å¯ä»¥é€šè¿‡ get è§£å¼•ç”¨ DFutï¼Œè¿™æ˜¯ä¸€ä¸ªé˜»å¡è°ƒç”¨ï¼Œè¿”å›å¯¹è±¡çš„å‰¯æœ¬ã€‚è°ƒç”¨è€…å¯ä»¥åˆ é™¤ DFutï¼Œå°†å…¶ä»ä½œç”¨åŸŸä¸­ç§»é™¤ï¼Œå¹¶å…è®¸ç³»ç»Ÿå›æ”¶è¯¥å€¼ã€‚ä¸å…¶ä»–ç³»ç»Ÿ [34, 37, 45] ä¸€æ ·ï¼Œæ‰€æœ‰å¯¹è±¡éƒ½æ˜¯ä¸å¯å˜çš„ã€‚ é€šè¿‡ä»»åŠ¡è°ƒç”¨åˆ›å»º DFut åï¼Œè°ƒç”¨è€…å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼åˆ›å»ºå…¶ä»–å¼•ç”¨ã€‚é¦–å…ˆï¼Œè°ƒç”¨è€…å¯ä»¥å°† DFut ä½œä¸ºå‚æ•°ä¼ é€’ç»™å¦ä¸€ä¸ªä»»åŠ¡ã€‚DFut ä»»åŠ¡å‚æ•°ç”±ç³»ç»Ÿéšå¼è§£å¼•ç”¨ã€‚å› æ­¤ï¼Œä»»åŠ¡åªæœ‰åœ¨æ‰€æœ‰ä¸Šæ¸¸ä»»åŠ¡å®Œæˆåæ‰ä¼šå¼€å§‹ï¼Œæ‰§è¡Œè€…åªèƒ½çœ‹åˆ° DFut çš„å€¼ã€‚ å…¶æ¬¡ï¼ŒDFut å¯ä»¥ä½œä¸º first-class ä¼ é€’æˆ–è¿”å› [21]ï¼Œå³åœ¨ä¸è§£å¼•ç”¨çš„æƒ…å†µä¸‹ä¼ é€’ç»™å¦ä¸€ä¸ªä»»åŠ¡ã€‚è¡¨ 1 å±•ç¤ºäº†å¦‚ä½•å°† DFut è½¬æ¢ä¸º SharedDFutï¼Œä»¥ä¾¿ç³»ç»Ÿå¯ä»¥åŒºåˆ†ä½•æ—¶è§£å¼•ç”¨å‚æ•°ã€‚æˆ‘ä»¬å°†æ¥æ”¶ DFut çš„è¿›ç¨‹ç§°ä¸ºå€Ÿç”¨è€…ï¼Œä»¥åŒºåˆ«äºåŸå§‹è°ƒç”¨è€…ã€‚ä¸åŸå§‹è°ƒç”¨è€…ä¸€æ ·ï¼Œå€Ÿç”¨è€…å¯ä»¥é€šè¿‡ä¼ é€’ DFut æˆ–å†æ¬¡è½¬æ¢ä¸º SharedDFutï¼ˆåˆ›å»ºæ›´å¤šçš„å€Ÿç”¨è€…ï¼‰æ¥åˆ›å»ºå…¶ä»–å¼•ç”¨ã€‚ ä¸æœ€è¿‘çš„ç³»ç»Ÿ [4, 34, 45] ç±»ä¼¼ï¼Œæˆ‘ä»¬æ”¯æŒå¸¦æœ‰ actor çš„æœ‰çŠ¶æ€è®¡ç®—ã€‚è°ƒç”¨è€…é€šè¿‡è°ƒç”¨è¿œç¨‹æ„é€ å‡½æ•°æ¥åˆ›å»ºä¸€ä¸ª actorã€‚è¿™ç«‹å³è¿”å›å¯¹ actor çš„å¼•ç”¨ï¼ˆARefï¼‰ï¼Œå¹¶åœ¨è¿œç¨‹è¿›ç¨‹ä¸Šå¼‚æ­¥æ‰§è¡Œæ„é€ å‡½æ•°ã€‚ARef å¯ä»¥ç”¨äºå¯åŠ¨ç»‘å®šåˆ°åŒä¸€è¿›ç¨‹çš„ä»»åŠ¡ã€‚ä¸ DFut ç±»ä¼¼ï¼ŒARef æ˜¯ä¸€ç­‰å€¼ï¼Œå³è°ƒç”¨è€…å¯ä»¥å°† ARef è¿”å›æˆ–ä¼ é€’ç»™å¦ä¸€ä¸ªä»»åŠ¡ï¼Œç³»ç»Ÿä¼šåœ¨æ‰€æœ‰ ARef è¶…å‡ºä½œç”¨åŸŸåè‡ªåŠ¨æ”¶é›† actor è¿›ç¨‹ã€‚ Actor ç®¡ç†çŠ¶æ€è®¡ç®— ","date":"2024-11-10","objectID":"/posts/paper-ownership/:4:1","tags":["Paper Reading"],"title":"Paper Reading: Ownership: A Distributed Futures System for Fine-Grained Tasks","uri":"/posts/paper-ownership/"},{"categories":null,"content":"Applications åˆ†å¸ƒå¼æœªæ¥çš„å…¸å‹åº”ç”¨æ˜¯é‚£äº›éœ€è¦ RPC çš„çµæ´»æ€§ä»¥åŠæ•°æ®ç§»åŠ¨å’Œå¹¶è¡Œæ€§ä¼˜åŒ–çš„åº”ç”¨ã€‚ åˆ†å¸ƒå¼æœªæ¥ä¹‹å‰å·²è¢«æ¢ç´¢ç”¨äºæ•°æ®å¯†é›†å‹åº”ç”¨ï¼Œè¿™äº›åº”ç”¨æ— æ³•æœ‰æ•ˆåœ°è¡¨è¾¾æˆ–æ‰§è¡Œä¸ºæ•°æ®å¹¶è¡Œç¨‹åºã€‚Ciel è¯†åˆ«äº†åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­åŠ¨æ€æŒ‡å®šä»»åŠ¡çš„å…³é”®èƒ½åŠ›ï¼Œä¾‹å¦‚åŸºäºå…ˆå‰çš„ç»“æœï¼Œè€Œä¸æ˜¯é¢„å…ˆæŒ‡å®šæ•´ä¸ªå›¾ [37]ã€‚è¿™ä½¿å¾—æ–°çš„å·¥ä½œè´Ÿè½½æˆä¸ºå¯èƒ½ï¼Œä¾‹å¦‚åŠ¨æ€è§„åˆ’ï¼Œå®ƒæœ¬è´¨ä¸Šå…·æœ‰é€’å½’æ€§ ä»»åŠ¡è°ƒåº¦ï¼Ÿ Model serving: å›¾ 3a å±•ç¤ºäº†ä¸€ä¸ªåŸºäº GPU çš„å›¾åƒåˆ†ç±»ç®¡é“çš„ç¤ºä¾‹ã€‚æ¯ä¸ªå®¢æˆ·ç«¯å°†å…¶è¾“å…¥å›¾åƒä¼ é€’ç»™ä¸€ä¸ª Preprocess ä»»åŠ¡ï¼Œä¾‹å¦‚è°ƒæ•´å¤§å°ï¼Œç„¶åå°†è¿”å›çš„ DFut ä¸ä¸€ä¸ª Router actor å…±äº«ã€‚Router å®ç°äº†è°ƒåº¦ç­–ç•¥ï¼Œå¹¶é€šè¿‡å¼•ç”¨å°† DFut ä¼ é€’ç»™é€‰å®šçš„ Model actorã€‚ç„¶åï¼ŒRouter å°†ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ã€‚ actor é€šè¿‡ä¸¤ç§æ–¹å¼æé«˜æ€§èƒ½ï¼š(1) æ¯ä¸ª Model åœ¨å…¶æœ¬åœ° GPU å†…å­˜ä¸­ä¿æŒæƒé‡é¢„çƒ­ keeps weights warmï¼Œ(2) Router ç¼“å†²é¢„å¤„ç†çš„ DFutï¼Œç›´åˆ°å®ƒæœ‰ä¸€æ‰¹è¯·æ±‚ä¼ é€’ç»™ Modelï¼Œä»¥åˆ©ç”¨ GPU å¹¶è¡Œæ€§æé«˜ååé‡ã€‚é€šè¿‡åŠ¨æ€ä»»åŠ¡ï¼ŒRouter è¿˜å¯ä»¥é€‰æ‹©åœ¨è¶…æ—¶æ—¶åˆ·æ–°å…¶ç¼“å†²åŒºï¼Œä»¥å‡å°‘æ‰¹å¤„ç†å¸¦æ¥çš„å»¶è¿Ÿã€‚ First-class distributed futures å¯¹äºå‡å°‘è·¯ç”±å¼€é”€éå¸¸é‡è¦ã€‚å®ƒä»¬å…è®¸ Router å°†é¢„å¤„ç†å›¾åƒçš„å¼•ç”¨ä¼ é€’ç»™ Model actorï¼Œè€Œä¸æ˜¯å¤åˆ¶è¿™äº›å›¾åƒã€‚è¿™é¿å…äº†åœ¨ Router å¤„å½¢æˆç“¶é¢ˆï¼Œæˆ‘ä»¬åœ¨å›¾ 15a ä¸­å¯¹æ­¤è¿›è¡Œäº†è¯„ä¼°ã€‚è™½ç„¶åº”ç”¨ç¨‹åºå¯ä»¥ä½¿ç”¨ä¸­é—´å­˜å‚¨ç³»ç»Ÿæ¥å­˜å‚¨é¢„å¤„ç†å›¾åƒï¼Œä½†å®ƒå¿…é¡»ç®¡ç†é¢å¤–çš„å…³æ³¨ç‚¹ï¼Œå¦‚åƒåœ¾å›æ”¶å’Œæ•…éšœã€‚ Online video processing: è§†é¢‘å¤„ç†ç®—æ³•é€šå¸¸å…·æœ‰å¤æ‚çš„æ•°æ®ä¾èµ–å…³ç³»ï¼Œè¿™äº›ä¾èµ–å…³ç³»ä¸å— Apache Spark ç­‰æ•°æ®å¹¶è¡Œç³»ç»Ÿçš„è‰¯å¥½æ”¯æŒ [22, 43]ã€‚ä¾‹å¦‚ï¼Œè§†é¢‘ç¨³å®šï¼ˆå›¾ 3bï¼‰é€šè¿‡è·Ÿè¸ªå¸§ä¹‹é—´çš„å¯¹è±¡ï¼ˆFlowï¼‰ï¼Œå¯¹è¿™äº›è½¨è¿¹è¿›è¡Œç´¯ç§¯æ±‚å’Œï¼ˆCumSumï¼‰ï¼Œç„¶ååº”ç”¨ç§»åŠ¨å¹³å‡ï¼ˆSmoothï¼‰æ¥å·¥ä½œã€‚å¸§ä¸å¸§ä¹‹é—´çš„ä¾èµ–å…³ç³»å¾ˆå¸¸è§ï¼Œä¾‹å¦‚å›¾ 3b ä¸­å­˜å‚¨åœ¨ actor ä¸­çš„è§†é¢‘è§£ç çŠ¶æ€ã€‚æ¯ä¸ªé˜¶æ®µæ¯å¸§è¿è¡Œ 1-10 æ¯«ç§’ã€‚ Spark ä¸ºä»€ä¹ˆä¸è¡Œï¼Ÿæ˜¯ GPU é™åˆ¶è¿˜æ˜¯å¹¶è¡Œå…³ç³»ï¼Ÿ è®ºæ–‡ Scanner: Efficient video analysis at scale, Lightdb: A DBMS for virtual reality video. åœ¨è¿™ç§è®¾ç½®ä¸­ï¼Œå®‰å…¨å’ŒåŠæ—¶çš„åƒåœ¾å›æ”¶å¯èƒ½å…·æœ‰æŒ‘æˆ˜æ€§ï¼Œå› ä¸ºå•ä¸ªå¯¹è±¡ï¼ˆä¾‹å¦‚è§†é¢‘å¸§ï¼‰å¯èƒ½è¢«å¤šä¸ªä»»åŠ¡å¼•ç”¨ã€‚å®æ—¶è§†é¢‘å¤„ç†ä¹Ÿå¯¹å»¶è¿Ÿæ•æ„Ÿï¼šè¾“å‡ºå¿…é¡»ä»¥ä¸è¾“å…¥ç›¸åŒçš„å¸§é€Ÿç‡ç”Ÿæˆã€‚ä½å»¶è¿Ÿä¾èµ–äºå¸§ä¹‹é—´çš„æµæ°´çº¿å¹¶è¡Œæ€§ï¼Œå› ä¸ºåº”ç”¨ç¨‹åºæ— æ³•ç­‰å¾…å¤šä¸ªè¾“å…¥å¸§å‡ºç°æ‰å¼€å§‹æ‰§è¡Œ DFut çš„é”™è¯¯æ£€æµ‹å’Œé”™è¯¯æ¢å¤ ","date":"2024-11-10","objectID":"/posts/paper-ownership/:4:2","tags":["Paper Reading"],"title":"Paper Reading: Ownership: A Distributed Futures System for Fine-Grained Tasks","uri":"/posts/paper-ownership/"},{"categories":null,"content":"Overview ","date":"2024-11-10","objectID":"/posts/paper-ownership/:5:0","tags":["Paper Reading"],"title":"Paper Reading: Ownership: A Distributed Futures System for Fine-Grained Tasks","uri":"/posts/paper-ownership/"},{"categories":null,"content":"Requirements ç³»ç»Ÿä¿è¯æ¯ä¸ª DFut éƒ½å¯ä»¥è§£å¼•ç”¨åˆ°å…¶å€¼ã€‚è¿™æ¶‰åŠä¸‰ä¸ªé—®é¢˜ï¼šautomatic memory management, failure detection, and failure recovery. å°±æ˜¯æŠŠå€¼ä¼ é€’æ”¹æˆäº†å¼•ç”¨ä¼ é€’ å¯ä»¥å‡å°‘ç½‘ç»œä¼ é€’çš„å¤§å°ï¼Œä½†æ˜¯å¸¦æ¥çš„é—®é¢˜å´å¾ˆå¤šï¼Œç”Ÿå‘½å‘¨æœŸï¼Œé”™è¯¯æ£€æµ‹ï¼Œé”™è¯¯æ¢å¤ Automatic memory management: å¼•ç”¨è®¡æ•°ï¼Ÿ Failure detection: ç³»ç»Ÿæ£€æµ‹åˆ° DFut ç”±äº worker æ•…éšœè€Œæ— æ³•è§£å¼•ç”¨çš„æ—¶é—´ã€‚åœ¨æ²¡æœ‰æœªæ¥ä½†æœ‰åˆ†å¸ƒå¼å†…å­˜çš„æƒ…å†µä¸‹ï¼Œè¿™æ˜¯ç›´æ¥çš„ï¼Œå› ä¸ºåœ¨åˆ›å»ºå¼•ç”¨æ—¶å·²çŸ¥å€¼çš„ä½ç½®ã€‚ æœªæ¥çš„åŠ å…¥ä½¿æ•…éšœæ£€æµ‹å˜å¾—å¤æ‚ï¼Œå› ä¸ºå¯ä»¥åœ¨å€¼ä¹‹å‰åˆ›å»ºå¼•ç”¨ã€‚ å› æ­¤ï¼Œåœ¨å›¾ 4b ä¸­ï¼Œå½“ worker 2 æ¥æ”¶åˆ° add RPC æ—¶ï¼Œå¯èƒ½æ²¡æœ‰ a çš„ä½ç½®ã€‚ç„¶åï¼Œworker 2 å¿…é¡»å†³å®š f æ˜¯å¦ä»åœ¨æ‰§è¡Œï¼Œæˆ–è€…æ˜¯å¦å·²ç»å¤±è´¥ã€‚å¦‚æœæ˜¯å‰è€…ï¼Œé‚£ä¹ˆ worker 2 åº”è¯¥ç­‰å¾…ã€‚ä½†å¦‚æœå‘ç”Ÿæ•…éšœï¼Œç³»ç»Ÿå¿…é¡»æ¢å¤ aã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œç³»ç»Ÿå¿…é¡»è®°å½•æ‰€æœ‰ä»»åŠ¡çš„ä½ç½®ï¼Œå³å¾…å¤„ç†å¯¹è±¡ï¼Œè€Œä¸ä»…ä»…æ˜¯å·²åˆ›å»ºçš„å¯¹è±¡ã€‚ å¼‚æ­¥ Failure recovery: ç³»ç»Ÿè¿˜å¿…é¡»æä¾›ä¸€ç§ä»å¤±è´¥çš„ DFut ä¸­æ¢å¤çš„æ–¹æ³•ã€‚æœ€ä½è¦æ±‚æ˜¯å¦‚æœåº”ç”¨ç¨‹åºå°è¯•è§£å¼•ç”¨å¤±è´¥çš„ DFutï¼Œåˆ™æŠ›å‡ºé”™è¯¯ã€‚æˆ‘ä»¬è¿›ä¸€æ­¥æä¾›é€æ˜æ¢å¤çš„é€‰é¡¹ï¼Œå³ç³»ç»Ÿå°†æ¢å¤å¤±è´¥çš„ DFut çš„å€¼ã€‚ åœ¨æ²¡æœ‰åˆ†å¸ƒå¼å†…å­˜ä½†æœ‰ Future çš„æƒ…å†µä¸‹ï¼Œå¦‚æœä¸€ä¸ªè¿›ç¨‹å¤±è´¥ï¼Œæˆ‘ä»¬å°†å¤±å»è¯¥è¿›ç¨‹ä¸Šä»»ä½•å¾…å¤„ç†ä»»åŠ¡çš„å›å¤ã€‚å‡è®¾å¹‚ç­‰æ€§ï¼Œè¿™å¯ä»¥é€šè¿‡é‡è¯•æ¥æ¢å¤ï¼Œè¿™æ˜¯æŒ‰å€¼ä¼ é€’ RPC çš„å¸¸è§æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œåœ¨å›¾ 5a ä¸­ï¼Œdriver é€šè¿‡é‡æ–°æäº¤ add(a, b) æ¥æ¢å¤ã€‚æ•…éšœæ¢å¤å¾ˆç®€å•ï¼Œå› ä¸ºæ‰€æœ‰æ•°æ®éƒ½æ˜¯æŒ‰å€¼ä¼ é€’çš„ã€‚ ç„¶è€Œï¼Œåœ¨åˆ†å¸ƒå¼å†…å­˜çš„æƒ…å†µä¸‹ï¼Œä»»åŠ¡è¿˜å¯ä»¥åŒ…å«é€šè¿‡å¼•ç”¨ä¼ é€’çš„å‚æ•°ã€‚å› æ­¤ï¼ŒèŠ‚ç‚¹æ•…éšœå¯èƒ½å¯¼è‡´ä»ç„¶è¢«å¼•ç”¨çš„å¯¹è±¡å€¼ä¸¢å¤±ï¼Œå¦‚å›¾ 4b ä¸­çš„ bã€‚è§£å†³è¿™ä¸ªé—®é¢˜çš„ä¸€ä¸ªå¸¸è§æ–¹æ³•æ˜¯è®°å½•æ¯ä¸ªå¯¹è±¡çš„ lineageï¼Œå³åœ¨è¿è¡Œæ—¶ç”Ÿæˆå¯¹è±¡çš„å­å›¾ [17, 30, 56]ã€‚ç„¶åï¼Œç³»ç»Ÿéå†ä¸¢å¤±å¯¹è±¡çš„è¡€ç»Ÿï¼Œå¹¶é€šè¿‡ä»»åŠ¡é‡æ–°æ‰§è¡Œé€’å½’åœ°é‡å»ºå¯¹è±¡åŠå…¶ä¾èµ–å…³ç³»ã€‚è¿™ç§æ–¹æ³•å‡å°‘äº†æ—¥å¿—è®°å½•çš„è¿è¡Œæ—¶å¼€é”€ï¼Œå› ä¸ºæ•°æ®æœ¬èº«æ²¡æœ‰è®°å½•ï¼Œå¹¶ä¸”éƒ¨åˆ†å¤±è´¥åå¿…é¡»é‡åšçš„å·¥ä½œï¼Œå› ä¸ºåˆ†å¸ƒå¼å†…å­˜ä¸­ç¼“å­˜çš„å¯¹è±¡ä¸éœ€è¦é‡æ–°è®¡ç®—ã€‚å°½ç®¡å¦‚æ­¤ï¼Œå®ç°ä½è¿è¡Œæ—¶å¼€é”€ä»ç„¶å¾ˆå›°éš¾ï¼Œå› ä¸ºè¡€ç»Ÿæœ¬èº«å¿…é¡»åœ¨è¿è¡Œæ—¶è®°å½•å’Œæ”¶é›†ï¼Œå¹¶ä¸”å¿…é¡»èƒ½å¤Ÿæ‰¿å—æ•…éšœã€‚ è¯·æ³¨æ„ï¼Œæˆ‘ä»¬ç‰¹åˆ«å…³æ³¨ object recoveryï¼Œå¹¶ä¸”ä¸ä¹‹å‰çš„ç³»ç»Ÿ [34, 37, 56] ä¸€æ ·ï¼Œå‡è®¾å¹‚ç­‰æ€§ä»¥ç¡®ä¿æ­£ç¡®æ€§ã€‚å› æ­¤ï¼Œæˆ‘ä»¬çš„æŠ€æœ¯ç›´æ¥é€‚ç”¨äºå¹‚ç­‰å‡½æ•°å’Œå…·æœ‰åªè¯»ã€ checkpointable æˆ–ç¬æ€çŠ¶æ€çš„ actorï¼Œæ­£å¦‚æˆ‘ä»¬åœ¨å›¾ 15c ä¸­è¯„ä¼°çš„é‚£æ ·ã€‚è™½ç„¶è¿™ä¸æ˜¯æˆ‘ä»¬çš„é‡ç‚¹ï¼Œä½†è¿™äº›æŠ€æœ¯ä¹Ÿå¯ä»¥ä¸å·²çŸ¥çš„ actor çŠ¶æ€æ¢å¤æŠ€æœ¯ç»“åˆä½¿ç”¨ [17, 34]ï¼Œä¾‹å¦‚ nondeterministic execution çš„æ¢å¤ [52]ã€‚ Metadata requirements: åœ¨æ­£å¸¸æ“ä½œæœŸé—´ï¼Œç³»ç»Ÿå¿…é¡»è‡³å°‘è®°å½•ä»¥ä¸‹å†…å®¹ï¼š(1) æ¯ä¸ªå¯¹è±¡å€¼çš„ä½ç½®ï¼Œä»¥ä¾¿å¼•ç”¨æŒæœ‰è€…å¯ä»¥æ£€ç´¢å®ƒï¼Œ(2) å¯¹è±¡æ˜¯å¦ä»ç„¶è¢«å¼•ç”¨ï¼Œä»¥ç¡®ä¿å®‰å…¨çš„åƒåœ¾å›æ”¶ã€‚å¯¹äºæ•…éšœæ£€æµ‹å’Œæ¢å¤ï¼Œç³»ç»Ÿè¿˜å¿…é¡»åˆ†åˆ«è®°å½• (3) æ¯ä¸ª pending å¯¹è±¡çš„ä½ç½®ï¼Œå³ä»»åŠ¡ä½ç½®ï¼Œä»¥åŠ (4) å¯¹è±¡è¡€ç»Ÿã€‚ å…³é”®é—®é¢˜æ˜¯ä½•æ—¶ä»¥åŠåœ¨å“ªé‡Œè®°å½•è¿™äº›ç³»ç»Ÿå…ƒæ•°æ®ï¼Œä»¥ç¡®ä¿å…¶ä¸€è‡´æ€§å’Œå®¹é”™æ€§ã€‚ åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå…ƒæ•°æ®çš„å¼‚æ­¥æ›´æ–°æ˜¯å®‰å…¨çš„ï¼Œå³ç³»ç»Ÿå…ƒæ•°æ®ä¸ç³»ç»ŸçŠ¶æ€ä¹‹é—´å­˜åœ¨æš‚æ—¶ä¸ä¸€è‡´ å¦ä¸€æ–¹é¢ï¼Œæ•…éšœå¤„ç†æ‰€éœ€çš„å…ƒæ•°æ®ç†æƒ³æƒ…å†µä¸‹åº”åŒæ­¥æ›´æ–°ã€‚ æ‰€ä»¥åˆ°åº•æ˜¯å¼‚æ­¥è¿˜æ˜¯åŒæ­¥æ›´æ–°ï¼Ÿ ","date":"2024-11-10","objectID":"/posts/paper-ownership/:5:1","tags":["Paper Reading"],"title":"Paper Reading: Ownership: A Distributed Futures System for Fine-Grained Tasks","uri":"/posts/paper-ownership/"},{"categories":null,"content":"Existing solutions Centralized master: ä½¿ç”¨åŒæ­¥æ›´æ–°çš„é›†ä¸­å¼ä¸»èŠ‚ç‚¹è¿›è¡Œæ•…éšœå¤„ç†ï¼Œä½†è¿™ç§è®¾è®¡ä¹Ÿä¼šå¢åŠ æ˜¾è‘—çš„è¿è¡Œæ—¶å¼€é”€ï¼Œæ•…éšœæ£€æµ‹è¦æ±‚ä¸»èŠ‚ç‚¹åœ¨è°ƒåº¦ä¹‹å‰è®°å½•ä»»åŠ¡çš„è®¡åˆ’ä½ç½®ï¼Œè¿™ä½¿å¾—ä¸»èŠ‚ç‚¹æˆä¸ºå¯æ‰©å±•æ€§å’Œå»¶è¿Ÿçš„ç“¶é¢ˆã€‚ä¸»èŠ‚ç‚¹å¯ä»¥é€šè¿‡åˆ†ç‰‡æ¥æé«˜å¯æ‰©å±•æ€§ï¼Œä½†è¿™ä¼šä½¿åè°ƒå¤šä¸ªå¯¹è±¡çš„æ“ä½œï¼ˆå¦‚åƒåœ¾å›æ”¶å’Œè¡€ç»Ÿé‡å»ºï¼‰å˜å¾—å¤æ‚ã€‚æ­¤å¤–ï¼Œå»¶è¿Ÿå¼€é”€æ˜¯æ ¹æœ¬æ€§çš„ã€‚æ¯ä¸ªä»»åŠ¡è°ƒç”¨å¿…é¡»é¦–å…ˆè”ç³»ä¸»èŠ‚ç‚¹ï¼Œå³ä½¿ä¸å¤åˆ¶å…ƒæ•°æ®ä»¥å®ç°å®¹é”™ï¼Œä¹Ÿä¼šåœ¨æ‰§è¡Œçš„å…³é”®è·¯å¾„ä¸Šå¢åŠ è‡³å°‘ä¸€æ¬¡ RTTã€‚ Distributed leases: è¿™ç±»ä¼¼äºå¼‚æ­¥æ›´æ–°çš„é›†ä¸­å¼ä¸»èŠ‚ç‚¹ï¼Œè¿™ç§è®¾è®¡é€šè¿‡åˆ†ç‰‡å®ç°æ°´å¹³å¯æ‰©å±•æ€§ï¼Œå¹¶å‡å°‘ä»»åŠ¡å»¶è¿Ÿï¼Œå› ä¸ºå…ƒæ•°æ®æ˜¯å¼‚æ­¥å†™å…¥çš„ã€‚ç„¶è€Œï¼Œä¾èµ–æ—¶é—´æ¥åè°ƒç³»ç»ŸçŠ¶æ€ä¼šå‡æ…¢æ¢å¤é€Ÿåº¦ï¼ˆå›¾ 14ï¼‰ã€‚æ­¤å¤–ï¼Œè¿™ç§å»ä¸­å¿ƒåŒ–æ–¹æ³•å¼•å…¥äº†ä¸€ä¸ªæ–°é—®é¢˜ï¼šå·¥ä½œèŠ‚ç‚¹è¿˜å¿…é¡»åœ¨è°åº”è¯¥æ¢å¤å¯¹è±¡ï¼ˆå³é‡æ–°æ‰§è¡Œåˆ›å»ºä»»åŠ¡ï¼‰ä¸Šè¿›è¡Œåè°ƒã€‚è¿™åœ¨é›†ä¸­å¼æ–¹æ¡ˆä¸­å¾ˆç®€å•ï¼Œå› ä¸ºä¸»èŠ‚ç‚¹åè°ƒæ‰€æœ‰æ¢å¤æ“ä½œã€‚ åœ¨ Kubernetes ä¸­ï¼Œç§Ÿçº¦æœºåˆ¶ç”¨äºèŠ‚ç‚¹å¿ƒè·³å’Œç»„ä»¶çº§åˆ«çš„é¢†å¯¼è€…é€‰ä¸¾ åˆ†å¸ƒå¼åŸç†ä»‹ç» https://lrita.github.io/images/posts/distribution/%E5%88%86%E5%B8%83%E5%BC%8F%E5%8E%9F%E7%90%86%E4%BB%8B%E7%BB%8D.pdf åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„ leaseï¼ˆç§Ÿçº¦ï¼‰æœºåˆ¶ https://lrita.github.io/2018/10/29/lease-in-distributed-system/ åŸºäº PAXSO ç®—æ³•çš„ï¼Œæ—¶é’Ÿæ¼‚ç§»æœ‰ä¸Šç•Œçš„éƒ¨åˆ†åŒæ­¥ç½‘ç»œçš„ lease(ç§Ÿçº¦)ç®—æ³• https://lrita.github.io/images/posts/distribution/flease-fault-tolerant-and-decentralized-lease-coordination-for-distributed-systems.pdf è¿™é‡Œæåˆ°çš„ç­‰å¾…ç§Ÿçº¦è¿‡æœŸï¼Œé‚£æˆ‘å°†ç§Ÿçº¦å¯¿å‘½è°ƒä½ï¼Œä¸æ–­ç»­çº¦èƒ½å¦è§£å†³å‘¢ï¼Ÿ è‡³äºè°æ¥æ¢å¤ï¼Œç”¨ä¸»èŠ‚ç‚¹åè°ƒå…¶å®æŒºå¥½çš„ï¼Ÿè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ Ray ç»§ç»­ç”¨ head node å§ ","date":"2024-11-10","objectID":"/posts/paper-ownership/:5:2","tags":["Paper Reading"],"title":"Paper Reading: Ownership: A Distributed Futures System for Fine-Grained Tasks","uri":"/posts/paper-ownership/"},{"categories":null,"content":"Our solution: Ownership æˆ‘ä»¬å·¥ä½œçš„å…³é”®è§è§£æ˜¯â€œshardâ€é›†ä¸­å¼ä¸»èŠ‚ç‚¹ä»¥æé«˜å¯æ‰©å±•æ€§ï¼Œä½†åŸºäºåº”ç”¨ç¨‹åºç»“æ„æ¥å®ç°ä½è¿è¡Œæ—¶å¼€é”€å’Œç®€å•çš„æ•…éšœå¤„ç†ã€‚ åœ¨æ‰€æœ‰æƒä¸­ï¼Œè°ƒç”¨ä»»åŠ¡çš„å·¥ä½œèŠ‚ç‚¹å­˜å‚¨ä¸è¿”å›çš„ DFut ç›¸å…³çš„å…ƒæ•°æ®ã€‚ä¸é›†ä¸­å¼ä¸»èŠ‚ç‚¹ä¸€æ ·ï¼Œå®ƒåè°ƒæ“ä½œï¼Œå¦‚ä»»åŠ¡è°ƒåº¦ï¼Œä»¥ç¡®ä¿å®ƒçŸ¥é“ä»»åŠ¡ä½ç½®ï¼Œå¹¶è¿›è¡Œåƒåœ¾å›æ”¶ã€‚ä¾‹å¦‚ï¼Œåœ¨å›¾ 6d ä¸­ï¼Œworker 1 æ‹¥æœ‰ X å’Œ Yã€‚ é€‰æ‹©ä»»åŠ¡çš„è°ƒç”¨è€…ä½œä¸ºæ‰€æœ‰è€…çš„åŸå› æ˜¯ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œå®ƒæ˜¯è®¿é—®å…ƒæ•°æ®æœ€é¢‘ç¹çš„å·¥ä½œèŠ‚ç‚¹ã€‚è°ƒç”¨è€…é€šè¿‡ä»»åŠ¡è°ƒç”¨å‚ä¸ DFut çš„åˆå§‹åˆ›å»ºï¼Œå¹¶é€šè¿‡å°† DFut ä¼ é€’ç»™å…¶ä»– RPC æ¥åˆ›å»ºå…¶ä»–å¼•ç”¨ã€‚å› æ­¤ï¼Œä»»åŠ¡è°ƒç”¨å»¶è¿Ÿæœ€å°ï¼Œå› ä¸ºè®¡åˆ’ä½ç½®æ˜¯æœ¬åœ°å†™å…¥çš„ã€‚ç±»ä¼¼åœ°ï¼Œå¦‚æœ DFut ä¿æŒåœ¨æ‰€æœ‰è€…çš„ä½œç”¨åŸŸå†…ï¼Œåƒåœ¾å›æ”¶çš„å¼€é”€å¾ˆä½ï¼Œå› ä¸ºå½“æ‰€æœ‰è€…å°† DFut ä¼ é€’ç»™å¦ä¸€ä¸ª RPC æ—¶ï¼Œå¯ä»¥åœ¨æœ¬åœ°æ›´æ–° DFut çš„å¼•ç”¨è®¡æ•°ã€‚å¯¹äºå°å¯¹è±¡ï¼Œè¿™äº›å¼€é”€å¯ä»¥è¿›ä¸€æ­¥å‡å°‘ï¼Œè¿™äº›å¯¹è±¡å¯ä»¥æŒ‰å€¼ä¼ é€’ï¼Œå°±åƒæ²¡æœ‰åˆ†å¸ƒå¼å†…å­˜ä¸€æ ·ï¼ˆå‚è§ç¬¬ 4.2 èŠ‚ï¼‰ã€‚ å½“ç„¶ï¼Œå¦‚æœæ‰€æœ‰ä»»åŠ¡éƒ½ç”±å•ä¸ªé©±åŠ¨ç¨‹åºæäº¤ï¼Œå°±åƒåœ¨ BSP ç¨‹åºä¸­é‚£æ ·ï¼Œæ‰€æœ‰æƒæœºåˆ¶å°†æ— æ³•æ‰©å±•åˆ°é©±åŠ¨ç¨‹åºçš„ååé‡ä¹‹å¤–ã€‚ä»»ä½•åŠ¨æ€ä»»åŠ¡ç³»ç»Ÿä¹Ÿæ˜¯å¦‚æ­¤ã€‚ç„¶è€Œï¼Œé€šè¿‡æ‰€æœ‰æƒæœºåˆ¶ï¼Œåº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡å°†æ§åˆ¶é€»è¾‘åˆ†å¸ƒåœ¨å¤šä¸ªåµŒå¥—ä»»åŠ¡ä¸­æ¥æ°´å¹³æ‰©å±•ï¼Œè€Œä¸æ˜¯åƒä¸€è‡´æ€§å“ˆå¸Œï¼ˆå›¾ 12eï¼‰è¿™æ ·çš„åº”ç”¨ç¨‹åºæ— å…³çš„æ–¹æ³•ã€‚æ­¤å¤–ï¼Œworker è¿›ç¨‹æŒæœ‰ç³»ç»Ÿå…ƒæ•°æ®çš„å¤§éƒ¨åˆ†ã€‚è¿™ä¸ä¹‹å‰çš„è§£å†³æ–¹æ¡ˆå½¢æˆå¯¹æ¯”ï¼Œä¹‹å‰çš„è§£å†³æ–¹æ¡ˆå°†æ‰€æœ‰å…ƒæ•°æ®æ¨é€åˆ°ç³»ç»Ÿçš„é›†ä¸­å¼æˆ–æ¯ä¸ªèŠ‚ç‚¹çš„è¿›ç¨‹ä¸­ï¼Œé™åˆ¶äº†å•ä¸ªèŠ‚ç‚¹åœ¨æ‹¥æœ‰è®¸å¤š worker è¿›ç¨‹æ—¶çš„å‚ç›´å¯æ‰©å±•æ€§ï¼ˆå›¾ 12ï¼‰ã€‚ å•ä¸ªèŠ‚ç‚¹ï¼Œsingle failureï¼Ÿ ç„¶è€Œï¼Œæœ‰äº›é—®é¢˜æ˜¯å‡è®¾æ€§èƒ½è¶³å¤Ÿçš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨å®Œå…¨é›†ä¸­å¼è®¾è®¡æ›´å®¹æ˜“è§£å†³çš„ï¼š First-class futures ç¬¬ä¸€ç±»æœªæ¥ï¼ˆç¬¬ 2 èŠ‚ï¼‰å…è®¸éæ‰€æœ‰è€…è¿›ç¨‹å¼•ç”¨ DFutã€‚è™½ç„¶è®¸å¤šåº”ç”¨ç¨‹åºå¯ä»¥åœ¨æ²¡æœ‰ç¬¬ä¸€ç±»æœªæ¥çš„æƒ…å†µä¸‹ç¼–å†™ï¼ˆå›¾ 3bï¼‰ï¼Œä½†å®ƒä»¬åœ¨æŸäº›æƒ…å†µä¸‹å¯¹æ€§èƒ½è‡³å…³é‡è¦ã€‚ä¾‹å¦‚ï¼Œå›¾ 3a ä¸­çš„æ¨¡å‹æœåŠ¡åº”ç”¨ç¨‹åºä½¿ç”¨ç¬¬ä¸€ç±»æœªæ¥å°†ä»»åŠ¡è°ƒç”¨å§”æ‰˜ç»™åµŒå¥—ä»»åŠ¡ï¼Œè€Œæ— éœ€è§£å¼•ç”¨å’Œå¤åˆ¶å‚æ•°ã€‚ç¬¬ä¸€ç±» DFut å¯èƒ½ä¼šç¦»å¼€æ‰€æœ‰è€…çš„èŒƒå›´ï¼Œå› æ­¤æˆ‘ä»¬å¿…é¡»è€ƒè™‘åœ¨åƒåœ¾å›æ”¶æœŸé—´çš„æƒ…å†µã€‚æˆ‘ä»¬é¿å…åœ¨æ‰€æœ‰è€…å¤„é›†ä¸­å¼•ç”¨è®¡æ•°ï¼Œå› ä¸ºè¿™å°†è¿èƒŒå§”æ‰˜çš„ç›®çš„ã€‚ç›¸åï¼Œæˆ‘ä»¬ä½¿ç”¨åˆ†å¸ƒå¼åˆ†å±‚å¼•ç”¨è®¡æ•°åè®®ï¼ˆç¬¬ 4.2 èŠ‚ï¼‰ã€‚æ¯ä¸ªå€Ÿç”¨è€…ä»£è¡¨æ‰€æœ‰è€…å­˜å‚¨ DFut çš„æœ¬åœ°å¼•ç”¨è®¡æ•°ï¼ˆè¡¨ 2ï¼‰ï¼Œå¹¶åœ¨æœ¬åœ°å¼•ç”¨è®¡æ•°è¾¾åˆ°é›¶æ—¶é€šçŸ¥æ‰€æœ‰è€…ã€‚æ‰€æœ‰è€…å†³å®šä½•æ—¶å¯ä»¥å®‰å…¨åœ°å›æ”¶å¯¹è±¡ã€‚æˆ‘ä»¬ä½¿ç”¨å¼•ç”¨è®¡æ•°æ–¹æ³•è€Œä¸æ˜¯è¿½è¸ª [42] æ¥é¿å…å…¨å±€æš‚åœã€‚ Owner recovery: å¦‚æœä¸€ä¸ª worker å¤±è´¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¹Ÿä¼šä¸¢å¤±å…¶æ‹¥æœ‰çš„å…ƒæ•°æ®ã€‚ä¸ºäº†å®ç°é€æ˜æ¢å¤ï¼Œç³»ç»Ÿå¿…é¡»åœ¨æ–°è¿›ç¨‹ä¸Šæ¢å¤ worker çš„çŠ¶æ€ï¼Œå¹¶é‡æ–°å…³è”ä¸ä¹‹å‰æ‹¥æœ‰çš„ DFut ç›¸å…³çš„çŠ¶æ€ï¼ŒåŒ…æ‹¬ä»»ä½•å€¼çš„å‰¯æœ¬ã€å¼•ç”¨æŒæœ‰è€…å’ŒæŒ‚èµ·çš„ä»»åŠ¡ã€‚æˆ‘ä»¬é€‰æ‹©äº†ä¸€ç§æœ€å°åŒ–çš„æ–¹æ³•ï¼Œä¿è¯è¿›åº¦ï¼Œä½†å¯èƒ½ä¼šåœ¨å¤±è´¥æ—¶å¢åŠ é¢å¤–çš„é‡æ–°æ‰§è¡Œæˆæœ¬ï¼šæˆ‘ä»¬ä¸æ‰€æœ‰è€…å…±äº«å¯¹è±¡å’Œä»»ä½•å¼•ç”¨æŒæœ‰è€…çš„å‘½è¿ï¼Œç„¶åä½¿ç”¨è¡Œè¸ªé‡å»ºæ¥æ¢å¤å¯¹è±¡å’Œæ‰€æœ‰è€…çš„ä»»ä½•å‘½è¿å…±äº«çš„å­ä»»åŠ¡ï¼ˆç¬¬ 4.3 èŠ‚ï¼‰ã€‚è¿™ç§æ–¹æ³•å¢åŠ äº†æœ€å°çš„è¿è¡Œæ—¶å¼€é”€ï¼Œå¹¶ä¸”æ˜¯æ­£ç¡®çš„ï¼Œå³åº”ç”¨ç¨‹åºå°†æ¢å¤åˆ°ä¹‹å‰çš„çŠ¶æ€ï¼Œå¹¶ä¸”ç³»ç»Ÿä¿è¯ä¸ä¼šå‘ç”Ÿèµ„æºæ³„æ¼ã€‚æœªæ¥çš„æ‰©å±•æ˜¯æŒä¹…åŒ–æ‰€æœ‰è€…çš„çŠ¶æ€ï¼Œä»¥æœ€å°åŒ–æ¢å¤æ—¶é—´ï¼Œä½†ä»£ä»·æ˜¯å¢åŠ æ¢å¤å¤æ‚æ€§å’Œè¿è¡Œæ—¶å¼€é”€ Ray æ–‡æ¡£è¯´ç›®å‰ä¸æ”¯æŒ owner recovery ä½†ä¸ºä»€ä¹ˆè®ºæ–‡è¿™é‡Œè¯´é›†ä¸­å¼è®¾è®¡å®¹æ˜“è§£å†³å‘¢ ","date":"2024-11-10","objectID":"/posts/paper-ownership/:5:3","tags":["Paper Reading"],"title":"Paper Reading: Ownership: A Distributed Futures System for Fine-Grained Tasks","uri":"/posts/paper-ownership/"},{"categories":null,"content":"Ownership Design é›†ç¾¤ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹æ‰˜ç®¡ä¸€ä¸ªæˆ–å¤šä¸ª workerï¼ˆé€šå¸¸æ¯ä¸ªæ ¸å¿ƒä¸€ä¸ªï¼‰ï¼Œä¸€ä¸ªè°ƒåº¦å™¨å’Œä¸€ä¸ªå¯¹è±¡å­˜å‚¨ worker ä½¿ç”¨ä¸€ä¸ªæ‰€æœ‰æƒè¡¨æ¥è®°å½•å®ƒæ‰€å¤„ç†çš„ä»»åŠ¡å’Œæ•°æ® The distributed memory layer (Section 4.2) consists of an immutable distributed object store (Figure 7d) with Locations stored at the owner å…·ä½“ç»†èŠ‚çœ‹è®ºæ–‡ ","date":"2024-11-10","objectID":"/posts/paper-ownership/:6:0","tags":["Paper Reading"],"title":"Paper Reading: Ownership: A Distributed Futures System for Fine-Grained Tasks","uri":"/posts/paper-ownership/"},{"categories":null,"content":"Task scheduling Owner å¦‚ä½•åè°ƒä»»åŠ¡è°ƒåº¦ åœ¨è¾ƒé«˜å±‚æ¬¡ä¸Šï¼Œæ‰€æœ‰è€…å°†æ¯ä¸ªä»»åŠ¡åˆ†æ´¾åˆ°åˆ†å¸ƒå¼è°ƒåº¦å™¨é€‰æ‹©çš„ä½ç½®ã€‚è¿™ç¡®ä¿äº†æ‰€æœ‰æƒè¡¨ä¸­çš„ä»»åŠ¡ä½ç½®ä¸åˆ†æ´¾åŒæ­¥æ›´æ–°ã€‚æˆ‘ä»¬å‡è®¾ä¸€ä¸ªæŠ½è±¡çš„è°ƒåº¦ç­–ç•¥ï¼Œè¯¥ç­–ç•¥æ¥æ”¶èµ„æºè¯·æ±‚å¹¶è¿”å›åº”åˆ†é…èµ„æºèŠ‚ç‚¹çš„ IDã€‚è¯¥ç­–ç•¥è¿˜å¯èƒ½æ›´æ–°å…¶å†³ç­–ï¼Œä¾‹å¦‚ç”±äºèµ„æºå¯ç”¨æ€§çš„å˜åŒ–ã€‚ å›¾ 8c å±•ç¤ºäº†åˆ†æ´¾ä»»åŠ¡çš„åè®®ã€‚åœ¨ä»»åŠ¡è°ƒç”¨æ—¶ï¼Œè°ƒç”¨è€…ï¼Œå³è¿”å›çš„ DFut çš„æ‰€æœ‰è€…ï¼Œé¦–å…ˆä»å…¶æœ¬åœ°è°ƒåº¦å™¨è¯·æ±‚èµ„æºã€‚è¯·æ±‚æ˜¯ä¸€ä¸ªå…ƒç»„ï¼ŒåŒ…å«ä»»åŠ¡æ‰€éœ€çš„èµ„æºï¼ˆä¾‹å¦‚ï¼Œ{â€œCPUâ€: 1}ï¼‰å’Œåˆ†å¸ƒå¼å†…å­˜ä¸­çš„å‚æ•°ã€‚å¦‚æœç­–ç•¥é€‰æ‹©æœ¬åœ°èŠ‚ç‚¹ï¼Œè°ƒåº¦å™¨æ¥å—è¯·æ±‚ï¼šå®ƒè·å–å‚æ•°ï¼Œåˆ†é…èµ„æºï¼Œç„¶åå°†æœ¬åœ° worker ç§Ÿç»™æ‰€æœ‰è€…ã€‚å¦åˆ™ï¼Œè°ƒåº¦å™¨æ‹’ç»è¯·æ±‚å¹¶å°†æ‰€æœ‰è€…é‡å®šå‘åˆ°ç­–ç•¥é€‰æ‹©çš„èŠ‚ç‚¹ã€‚ åœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œè°ƒåº¦å™¨éƒ½ä¼šå‘æ‰€æœ‰è€…è¿”å›æ–°ä½ç½®ï¼šè¦ä¹ˆæ˜¯ç§Ÿç”¨çš„ worker çš„ IDï¼Œè¦ä¹ˆæ˜¯å¦ä¸€ä¸ªèŠ‚ç‚¹çš„ IDã€‚æ‰€æœ‰è€…åœ¨å°†ä»»åŠ¡åˆ†æ´¾åˆ°è¯¥ä½ç½®ä¹‹å‰ï¼Œå°†å…¶å­˜å‚¨åœ¨å…¶æœ¬åœ°æ‰€æœ‰æƒè¡¨ä¸­ã€‚å¦‚æœè¯·æ±‚è¢«æ¥å—ï¼Œæ‰€æœ‰è€…ç›´æ¥å°†ä»»åŠ¡å‘é€ç»™ç§Ÿç”¨çš„ worker æ‰§è¡Œï¼›å¦åˆ™ï¼Œå®ƒåœ¨ä¸‹ä¸€ä¸ªè°ƒåº¦å™¨é‡å¤è¯¥åè®®ã€‚ å› æ­¤ï¼Œæ‰€æœ‰è€…æ€»æ˜¯å°†ä»»åŠ¡åˆ†æ´¾åˆ°å…¶ä¸‹ä¸€ä¸ªä½ç½®ï¼Œç¡®ä¿ä»»åŠ¡çš„æŒ‚èµ·ä½ç½®ï¼ˆè¡¨ 2ï¼‰åŒæ­¥æ›´æ–°ã€‚è¿™ä¹Ÿå…è®¸æ‰€æœ‰è€…åœ¨ä»»åŠ¡çš„èµ„æºéœ€æ±‚å¾—åˆ°æ»¡è¶³æ—¶ï¼Œé€šè¿‡ç›´æ¥å°†ä»»åŠ¡åˆ†æ´¾ç»™å·²ç§Ÿç”¨çš„ worker æ¥ç»•è¿‡è°ƒåº¦å™¨ã€‚ä¾‹å¦‚ï¼Œåœ¨å›¾ 8d ä¸­ï¼Œworker 1 é‡ç”¨äº†ä»èŠ‚ç‚¹ 2 ç§Ÿç”¨çš„èµ„æºæ¥æ‰§è¡Œ Cã€‚æ‰€æœ‰è€…åœ¨é…ç½®çš„è¶…æ—¶æ—¶é—´åæˆ–æ²¡æœ‰æ›´å¤šä»»åŠ¡éœ€è¦åˆ†æ´¾æ—¶è¿”å›ç§Ÿçº¦ã€‚æˆ‘ä»¬ç›®å‰ä¸é‡ç”¨å…·æœ‰ä¸åŒåˆ†å¸ƒå¼å†…å­˜ä¾èµ–å…³ç³»çš„ä»»åŠ¡çš„èµ„æºï¼Œå› ä¸ºè¿™äº›èµ„æºç”±è°ƒåº¦å™¨è·å–ã€‚æˆ‘ä»¬å°†å…¶ä»–ç§Ÿçº¦æ’¤é”€å’Œå·¥ä½œé‡ç”¨çš„ç­–ç•¥ç•™å¾…æœªæ¥çš„å·¥ä½œã€‚ å·¥ä½œé‡ç”¨åˆ°åº•æ˜¯ä»€ä¹ˆæ„æ€ ä»»åŠ¡æ‰§è¡Œå‰çš„æœ€åæƒ…å†µ RTT æ•°é‡é«˜äºä¹‹å‰çš„è§£å†³æ–¹æ¡ˆï¼Œå› ä¸ºæ¯ä¸ªç­–ç•¥å†³ç­–éƒ½è¿”å›ç»™æ‰€æœ‰è€…ï¼ˆå›¾ 8eï¼‰ã€‚ç„¶è€Œï¼Œä¹‹å‰è§£å†³æ–¹æ¡ˆçš„ååé‡å—åˆ°é™åˆ¶ï¼ˆå›¾ 12ï¼‰ï¼Œå› ä¸ºå®ƒä»¬æ— æ³•æ”¯æŒç›´æ¥çš„ worker-to-worker è°ƒåº¦ï¼ˆå›¾ 8dï¼‰ã€‚è¿™æ˜¯å› ä¸º worker ä¸å­˜å‚¨ç³»ç»ŸçŠ¶æ€ï¼Œå› æ­¤æ‰€æœ‰ä»»åŠ¡å¿…é¡»é€šè¿‡ä¸»èŠ‚ç‚¹æˆ–æ¯ä¸ªèŠ‚ç‚¹çš„è°ƒåº¦å™¨æ¥æ›´æ–°ä»»åŠ¡ä½ç½®ï¼ˆå›¾ 8a å’Œ 8bï¼‰ã€‚ è¿™é‡Œå¾ˆå¥‡æ€ªï¼Œè¯´ååé‡æ˜¯ç”±äº worker2worker è°ƒåº¦é™åˆ¶äº†ï¼Œé‚£å¯¹äº lease å‘¢ï¼Ÿ Actor scheduling ç³»ç»Ÿè°ƒåº¦ actor æ„é€ ä»»åŠ¡çš„æ–¹å¼ä¸æ™®é€šä»»åŠ¡ç±»ä¼¼ã€‚ç„¶è€Œï¼Œåœ¨å®Œæˆä¹‹åï¼Œæ‰€æœ‰è€…æŒæœ‰ worker çš„ç§Ÿçº¦ï¼Œç›´åˆ° actor ä¸å†è¢«å¼•ç”¨ï¼ˆç¬¬ 4.2 èŠ‚ï¼‰ï¼Œå¹¶ä¸” worker åªèƒ½æ‰§è¡Œé€šè¿‡ç›¸åº” ARef æäº¤çš„ actor ä»»åŠ¡ã€‚ ","date":"2024-11-10","objectID":"/posts/paper-ownership/:6:1","tags":["Paper Reading"],"title":"Paper Reading: Ownership: A Distributed Futures System for Fine-Grained Tasks","uri":"/posts/paper-ownership/"},{"categories":null,"content":"Memory management Allocation å¯¹äºå°å¯¹è±¡ï¼Œå¤åˆ¶å¯èƒ½æ¯”é€šè¿‡åˆ†å¸ƒå¼å†…å­˜ä¼ é€’æ›´å¿«ï¼Œåè€…éœ€è¦æ›´æ–°å¯¹è±¡ç›®å½•ï¼Œä»è¿œç¨‹èŠ‚ç‚¹è·å–å¯¹è±¡ç­‰ã€‚å› æ­¤ï¼Œåœ¨å¯¹è±¡åˆ›å»ºæ—¶ï¼Œç³»ç»Ÿæ ¹æ®å¤§å°é€æ˜åœ°é€‰æ‹©æ˜¯æŒ‰å€¼ä¼ é€’è¿˜æ˜¯æŒ‰å¼•ç”¨ä¼ é€’ã€‚ Dereferencing Reclamation Actors ","date":"2024-11-10","objectID":"/posts/paper-ownership/:6:2","tags":["Paper Reading"],"title":"Paper Reading: Ownership: A Distributed Futures System for Fine-Grained Tasks","uri":"/posts/paper-ownership/"},{"categories":null,"content":"Failure recovery Failure detection. æ•…éšœé€šçŸ¥åŒ…å« worker æˆ–èŠ‚ç‚¹ IDï¼Œå‘å¸ƒç»™æ‰€æœ‰ workerã€‚Worker ä¸äº¤æ¢å¿ƒè·³ï¼›worker æ•…éšœç”±å…¶æœ¬åœ°è°ƒåº¦å™¨å‘å¸ƒã€‚èŠ‚ç‚¹æ•…éšœé€šè¿‡èŠ‚ç‚¹ä¹‹é—´äº¤æ¢å¿ƒè·³æ¥æ£€æµ‹ï¼Œæ‰€æœ‰ worker ä¸å…¶èŠ‚ç‚¹ fate-shareã€‚ åœ¨æ¥æ”¶åˆ°èŠ‚ç‚¹æˆ– worker æ•…éšœé€šçŸ¥åï¼Œæ¯ä¸ª worker æ‰«æå…¶æœ¬åœ°æ‰€æœ‰æƒè¡¨ä»¥æ£€æµ‹ DFut æ•…éšœã€‚DFut åœ¨ä¸¤ç§æƒ…å†µä¸‹è¢«è®¤ä¸ºæ˜¯å¤±è´¥çš„ï¼š1ï¼‰é€šè¿‡æ¯”è¾ƒ Location å­—æ®µï¼Œä¸¢å¤±æ‹¥æœ‰çš„å¯¹è±¡ï¼ˆå›¾ 10aï¼‰ï¼Œæˆ– 2ï¼‰é€šè¿‡æ¯”è¾ƒ Owner å­—æ®µï¼Œä¸¢å¤±æ‰€æœ‰è€…ï¼ˆå›¾ 11aï¼‰ã€‚æˆ‘ä»¬æ¥ä¸‹æ¥åˆ†åˆ«ä½¿ç”¨è¡Œè¸ªé‡å»ºå’Œå‘½è¿å…±äº«æ¥è®¨è®ºè¿™ä¸¤ç§æƒ…å†µçš„å¤„ç† è¯·æ³¨æ„ï¼Œéæ‰€æœ‰è€…ä¸éœ€è¦æ£€æµ‹å¯¹è±¡çš„ä¸¢å¤±ã€‚ä¾‹å¦‚ï¼Œåœ¨å›¾ 10a ä¸­ï¼ŒèŠ‚ç‚¹ 2 åœ¨ worker 3 æ¥æ”¶åˆ° C æ—¶å¤±è´¥ã€‚å½“ worker 3 åœ¨æ‰€æœ‰è€…å¤„æŸ¥æ‰¾ X æ—¶ï¼Œå¯èƒ½æ‰¾ä¸åˆ°ä»»ä½•ä½ç½®ã€‚ä» worker 3 çš„è§’åº¦æ¥çœ‹ï¼Œè¿™æ„å‘³ç€èŠ‚ç‚¹ 2 çš„ç›®å½•å†™å…¥è¢«å»¶è¿Ÿï¼Œæˆ–è€…èŠ‚ç‚¹ 2 å¤±è´¥ã€‚Worker 3 ä¸éœ€è¦å†³å®šæ˜¯å“ªä¸€ç§ï¼›å®ƒåªéœ€ç­‰å¾… X çš„æ‰€æœ‰è€…å¤„ç†æ•…éšœã€‚ Object recovery: The owner recovers a lost value through lineage reconstruction Owner recovery. æ‰€æœ‰è€…æ•…éšœå¯èƒ½å¯¼è‡´â€œdangling pointerâ€ï¼šæ— æ³•è§£å¼•ç”¨çš„ DFutã€‚å¦‚æœå¯¹è±¡åŒæ—¶ä»åˆ†å¸ƒå¼å†…å­˜ä¸­ä¸¢å¤±ï¼Œå°±ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚ä¾‹å¦‚ï¼Œå¦‚æœèŠ‚ç‚¹ 2 ä¹Ÿå¤±è´¥ï¼Œå›¾ 11a ä¸­çš„ C å°†ä¼šæŒ‚èµ·ã€‚ æˆ‘ä»¬ä½¿ç”¨å‘½è¿å…±äº«æ¥ç¡®ä¿ç³»ç»Ÿåœ¨æ‰€æœ‰è€…å¤±è´¥æ—¶èƒ½å¤Ÿç»§ç»­è¿è¡Œã€‚é¦–å…ˆï¼Œæ‰€æœ‰è€…åŠå…¶ä»»ä½•å¼•ç”¨æŒæœ‰è€…æŒæœ‰çš„æ‰€æœ‰èµ„æºéƒ½è¢«å›æ”¶ã€‚å…·ä½“æ¥è¯´ï¼Œåœ¨æ¥æ”¶åˆ°æ‰€æœ‰è€…å¤±è´¥çš„é€šçŸ¥åï¼Œåˆ†å¸ƒå¼å¯¹è±¡å­˜å‚¨é‡Šæ”¾å¯¹è±¡ï¼ˆå¦‚æœå­˜åœ¨ï¼‰æˆ–è°ƒåº¦å±‚å›æ”¶ worker ç§Ÿçº¦ï¼ˆå¦‚æœå¯¹è±¡æ­£åœ¨ç­‰å¾…ï¼‰ï¼Œå¦‚å›¾ 11b æ‰€ç¤ºã€‚æ‰€æœ‰å¼•ç”¨æŒæœ‰è€…ï¼Œå³å€Ÿç”¨è€…å’Œä¾èµ–ä»»åŠ¡ï¼Œä¹Ÿä¸æ‰€æœ‰è€…å…±äº«å‘½è¿ ç„¶åï¼Œä¸ºäº†æ¢å¤å…±äº«å‘½è¿çš„çŠ¶æ€ï¼Œæˆ‘ä»¬ä¾èµ–äºè¡Œè¸ªé‡å»ºã€‚ç‰¹åˆ«æ˜¯ï¼Œåœ¨å¤±è´¥çš„æ‰€æœ‰è€…ä¸Šæ‰§è¡Œçš„ä»»åŠ¡æˆ– actor æœ¬èº«å¿…é¡»ç”±å¦ä¸€ä¸ªè¿›ç¨‹æ‹¥æœ‰ã€‚è¯¥è¿›ç¨‹æœ€ç»ˆå°†é‡æ–°æäº¤å¤±è´¥çš„ä»»åŠ¡ã€‚å½“æ–°çš„æ‰€æœ‰è€…é‡æ–°æ‰§è¡Œæ—¶ï¼Œå®ƒå°†é‡æ–°åˆ›å»ºå…¶å…ˆå‰çš„çŠ¶æ€ï¼Œæ— éœ€ç³»ç»Ÿå¹²é¢„ã€‚ä¾‹å¦‚ï¼Œå›¾ 11a ä¸­ A çš„æ‰€æœ‰è€…æœ€ç»ˆå°†é‡æ–°æäº¤ Aï¼ˆå›¾ 11bï¼‰ï¼Œè¿™å°†å†æ¬¡æäº¤ B å’Œ Cã€‚ ä¸ºäº†æ­£ç¡®æ€§ï¼Œæˆ‘ä»¬è¯æ˜æ‰€æœ‰å…ˆå‰çš„å¼•ç”¨æŒæœ‰è€…éƒ½è¢«é‡æ–°åˆ›å»ºï¼Œå¹¶å¸¦æœ‰æ–°æ‰€æœ‰è€…çš„åœ°å€ã€‚è€ƒè™‘è®¡ç®— DFut x å€¼çš„ä»»åŠ¡ Tã€‚T æœ€åˆåœ¨ worker W ä¸Šæ‰§è¡Œï¼Œå¹¶åœ¨æ¢å¤æœŸé—´åœ¨ W0 ä¸Šé‡æ–°æ‰§è¡Œã€‚APIï¼ˆç¬¬ 2 èŠ‚ï¼‰æä¾›äº†ä¸‰ç§åˆ›å»ºå¯¹ x çš„å¦ä¸€ä¸ªå¼•ç”¨çš„æ–¹æ³•ï¼šï¼ˆ1ï¼‰å°† x ä½œä¸ºä»»åŠ¡å‚æ•°ä¼ é€’ï¼Œï¼ˆ2ï¼‰å°† x è½¬æ¢ä¸º SharedDFut ç„¶åä½œä¸ºä»»åŠ¡å‚æ•°ä¼ é€’ï¼Œï¼ˆ3ï¼‰ä» T è¿”å› xã€‚ ","date":"2024-11-10","objectID":"/posts/paper-ownership/:6:3","tags":["Paper Reading"],"title":"Paper Reading: Ownership: A Distributed Futures System for Fine-Grained Tasks","uri":"/posts/paper-ownership/"},{"categories":null,"content":"Evaluation æˆ‘ä»¬ä¸ä¸‰ä¸ªåŸºçº¿è¿›è¡Œäº†æ¯”è¾ƒï¼šï¼ˆ1ï¼‰ä¸€ä¸ªæ²¡æœ‰åˆ†å¸ƒå¼å†…å­˜çš„æœªæ¥ä½†æŒ‰å€¼ä¼ é€’çš„æ¨¡å‹ï¼Œç±»ä¼¼äºå›¾ 2cï¼Œï¼ˆ2ï¼‰ä¸€ä¸ªåŸºäºç§Ÿçº¦çš„å»ä¸­å¿ƒåŒ–ç³»ç»Ÿç”¨äºåˆ†å¸ƒå¼æœªæ¥ï¼ˆRay v0.7ï¼‰ï¼Œï¼ˆ3ï¼‰ä¸€ä¸ªé›†ä¸­å¼ä¸»èŠ‚ç‚¹ç”¨äºåˆ†å¸ƒå¼æœªæ¥ï¼ˆRay v0.7 ä¿®æ”¹ä¸ºåœ¨ä»»åŠ¡æ‰§è¡Œå‰å†™å…¥é›†ä¸­å¼ä¸»èŠ‚ç‚¹ï¼‰ã€‚ Task submission is divided across multiple intermediate drivers, either colocated on the m5.8xlarge head node or spread with one m5.8xlarge node per driver ","date":"2024-11-10","objectID":"/posts/paper-ownership/:7:0","tags":["Paper Reading"],"title":"Paper Reading: Ownership: A Distributed Futures System for Fine-Grained Tasks","uri":"/posts/paper-ownership/"},{"categories":null,"content":"Microbenchmarks Throughput and scalability. We could not produce stable results for pass-by-value with large objects due to the lack of backpressure in our implementation å½“é©±åŠ¨ç¨‹åºåˆ†æ•£æ—¶ï¼ˆå›¾ 12b å’Œ 12dï¼‰ï¼Œæ‰€æœ‰æƒå’Œç§Ÿçº¦éƒ½çº¿æ€§æ‰©å±•ã€‚åœ¨å›¾ 12b ä¸­ï¼Œæ‰€æœ‰æƒæ¯”ç§Ÿçº¦æ‰©å±•å¾—æ›´å¥½ï¼Œå› ä¸ºæ›´å¤šçš„å·¥ä½œè¢«å¸è½½åˆ° worker è¿›ç¨‹ä¸Šã€‚åœ¨å›¾ 12d ä¸­ï¼Œæ‰€æœ‰æƒå’Œç§Ÿçº¦å®ç°äº†ç±»ä¼¼çš„ååé‡ï¼Œä½†æ‰€æœ‰æƒç³»ç»Ÿè¿˜åŒ…æ‹¬å†…å­˜å®‰å…¨ï¼ˆç¬¬ 4.2 èŠ‚ï¼‰ã€‚é›†ä¸­å¼è®¾è®¡ï¼ˆ2 ä¸ªåˆ†ç‰‡ï¼‰çº¿æ€§æ‰©å±•åˆ° âˆ¼60 ä¸ªèŠ‚ç‚¹ã€‚æ·»åŠ æ›´å¤šåˆ†ç‰‡ä¼šæé«˜è¿™ä¸ªé˜ˆå€¼ï¼Œä½†åªæ˜¯å¸¸æ•°æ•°é‡ã€‚ æ˜¯ä¸æ˜¯æœ‰ç‚¹å‡è¿™é‡Œçš„ small object æµ‹è¯•ï¼Œpass by value è‚¯å®šä¸éœ€è¦åˆ†å¸ƒå¼å†…å­˜ï¼Œownership åˆè°ƒä¼˜å°å¯¹è±¡ï¼Œå¦ä¸¤ä¸ªå‘¢ï¼Ÿ å¤§å¯¹è±¡ colocated ä¸ºä»€ä¹ˆ ownership å¥½ä¸€ç‚¹ spread å¤šä¸ª driver å…¶å®åº”è¯¥éƒ½å·®ä¸å¤šæˆ‘è§‰å¾—ï¼Œå› ä¸ºåˆ†æ•£äº†ä»»åŠ¡éƒ½æ˜¯å¹¶è¡Œï¼Ÿè¿™é‡Œå’Œ lease æ€§èƒ½å…¶å®å¾ˆæ¥è¿‘ Scaling through borrowing Latency è¯¥ worker è¦ä¹ˆä¸é©±åŠ¨ç¨‹åºä½äºåŒä¸€èŠ‚ç‚¹ï¼ˆâ€œæœ¬åœ°â€ï¼‰ï¼Œè¦ä¹ˆä½äºå•ç‹¬çš„ m5.16xlarge èŠ‚ç‚¹ä¸Šï¼ˆâ€œè¿œç¨‹â€ï¼‰ é¦–å…ˆï¼Œåˆ†å¸ƒå¼å†…å­˜åœ¨æ‰€æœ‰æƒ…å†µä¸‹éƒ½æ¯”æŒ‰å€¼ä¼ é€’å®ç°äº†æ›´å¥½çš„å»¶è¿Ÿï¼Œå› ä¸ºè¿™äº›ç³»ç»Ÿé¿å…äº†ä»é©±åŠ¨ç¨‹åºåˆ° worker çš„ä¸å¿…è¦ä»»åŠ¡å‚æ•°å‰¯æœ¬ã€‚ å…¶æ¬¡ï¼Œä¸é›†ä¸­å¼å’Œç§Ÿçº¦ç›¸æ¯”ï¼Œæ‰€æœ‰æƒå¹³å‡å®ç°äº† 1.6 å€çš„æ›´ä½å»¶è¿Ÿã€‚è¿™æ˜¯å› ä¸ºï¼ˆ1ï¼‰èƒ½å¤Ÿåœ¨æ‰€æœ‰è€…æœ¬åœ°å†™å…¥å…ƒæ•°æ®ï¼Œè€Œä¸æ˜¯è¿œç¨‹è¿›ç¨‹ï¼Œä»¥åŠï¼ˆ2ï¼‰èƒ½å¤Ÿé‡ç”¨ç§Ÿç”¨çš„èµ„æºï¼Œåœ¨è®¸å¤šæƒ…å†µä¸‹ç»•è¿‡è°ƒåº¦å±‚ï¼ˆç¬¬ 4.1 èŠ‚ï¼‰ã€‚ å¦‚æœä»»åŠ¡çš„èµ„æºéœ€æ±‚å¾—åˆ°æ»¡è¶³ï¼Œæ‰€æœ‰è€…è¿˜å¯ä»¥ç»•è¿‡è°ƒåº¦å™¨ï¼Œç›´æ¥å°†ä»»åŠ¡åˆ†æ´¾ç»™å·²ç§Ÿç”¨çš„å·¥äººã€‚ in Figure 8d, worker 1 reuses the resources leased from node 2 in Figure 8c to execute C. Recovery ","date":"2024-11-10","objectID":"/posts/paper-ownership/:7:1","tags":["Paper Reading"],"title":"Paper Reading: Ownership: A Distributed Futures System for Fine-Grained Tasks","uri":"/posts/paper-ownership/"},{"categories":null,"content":"End-to-end applications Model Serving æ‰€æœ‰æƒå’Œé›†ä¸­å¼å®ç°äº†ç›¸åŒçš„ä¸­ä½æ•°å»¶è¿Ÿï¼ˆ54msï¼‰ï¼Œä½†é›†ä¸­å¼çš„å°¾éƒ¨å»¶è¿Ÿé«˜å‡º 9 å€ï¼ˆ1 ç§’ vs. 108msï¼‰ Online video processing. å›¾ 15b æ˜¾ç¤ºäº†æ²¡æœ‰æ•…éšœçš„å»¶è¿Ÿã€‚æ‰€æœ‰ç³»ç»Ÿå®ç°äº†ç›¸ä¼¼çš„ä¸­ä½æ•°å»¶è¿Ÿï¼ˆâˆ¼65msï¼‰ï¼Œä½†ç§Ÿçº¦å’Œé›†ä¸­å¼çš„å°¾éƒ¨å»¶è¿Ÿè¾ƒé•¿ï¼ˆåˆ†åˆ«ä¸º 1208ms å’Œ 1923msï¼‰ã€‚ åŸºäºç§Ÿçº¦çš„æ¢å¤å¾ˆæ…¢ï¼Œå› ä¸ºè§£ç å™¨ actor å¿…é¡»é‡æ”¾æ‰€æœ‰ä»»åŠ¡ï¼Œå¹¶ä¸”æ¯ä¸ªä»»åŠ¡ä»ç§Ÿçº¦åˆ°æœŸä¸­ç´¯ç§¯å¼€é”€ã€‚ç”±äºç§Ÿçº¦å®ç°æ— æ³•å®‰å…¨åœ°åƒåœ¾å›æ”¶è¡€ç»Ÿï¼Œå› æ­¤æ£€æŸ¥ç‚¹ actor æ˜¯ä¸å¯è¡Œçš„ã€‚ ä¾‹å¦‚ï¼Œå½“èµ„æºçš„æ‰€æœ‰æƒéœ€è¦è½¬ç§»æˆ–é‡Šæ”¾æ—¶ï¼Œç§Ÿçº¦æœºåˆ¶å¯èƒ½æ— æ³•å¯é åœ°è¿½è¸ªè¿™äº›å˜åŒ–ï¼Œå¯¼è‡´æœªä½¿ç”¨çš„èµ„æºæ— æ³•è¢«åŠæ—¶å›æ”¶ã€‚ etcd ç§Ÿçº¦æ’¤é”€ åˆ†å¸ƒå¼åƒåœ¾å›æ”¶ DGC application-level checkpoints (O+CP) ","date":"2024-11-10","objectID":"/posts/paper-ownership/:7:2","tags":["Paper Reading"],"title":"Paper Reading: Ownership: A Distributed Futures System for Fine-Grained Tasks","uri":"/posts/paper-ownership/"},{"categories":null,"content":"Conclusion ä¸€äº›é—®é¢˜ median latency éƒ½å·®ä¸å¤šï¼Œä½†æ˜¯ ownership å°¾éƒ¨å»¶è¿Ÿå¾ˆå¥½ï¼Œå·®åˆ«åœ¨å“ªï¼Ÿæ˜¯å› ä¸ºé«˜è´Ÿè½½å‡ºç°äº†ç“¶é¢ˆï¼Ÿ O+CP(Redis) æ˜¯ä¸æ˜¯æ²¡æœ‰æ§åˆ¶å˜é‡å•Šã€‚ã€‚O+CP; WF å‘¢ï¼Ÿ Ray does not support recovery from owner failure. ä½ è§‰å¾—æ˜¯ä¸ºä»€ä¹ˆï¼Ÿå› ä¸º metadata ä¸¢å¤±äº†ï¼Œè®¡æ•°ä¹Ÿä¸¢å¤±äº†ï¼Œæ‰€ä»¥ä¹Ÿæ˜¯ä¸ªç“¶é¢ˆ fate share æ˜¯ä¸æ˜¯éš¾ä»¥å®ç° Spark / Ray / MapReduce by default is using centralized architecture, master/ head node Ray \u003c v0.8 is using lease manager? Ownership å‡è®¾ä»»åŠ¡éƒ½æ˜¯ DAG / Tree ObjectRef æ˜¯æœ‰ scope çš„å¯ä»¥ä¼ é€’ æˆ‘è§‰å¾— Ownership owner recovery å¤ªå‡äº†ï¼Œæ‰€æœ‰ owner metadata éƒ½ä¸¢äº† w3 è¿”å›åˆ°ä¸€ä¸ªå¤±è´¥èŠ‚ç‚¹ï¼Ÿç„¶åæ‰¾åˆ° owner çš„ owner æ¥é‡å»ºï¼Ÿè¿™ä¸æ˜¯æœ€åçš„æƒ…å†µå— é‚£ä¹ˆæœ‰æ²¡æœ‰æ›´å¥½çš„åŠæ³•å‘¢ï¼Œæ¯”æ–¹è¯´ä¸æ˜¯é‡å»ºæ‰€æœ‰ï¼Œè€Œæ˜¯åŒæ­¥è¿™ä¸ª DAG é‡Œæ‰€æœ‰çš„ ownership è¡¨ï¼Œåªé‡å»ºé‚£ä¸€ä¸ªï¼Ÿ https://docs.google.com/document/d/1tBw9A4j62ruI5omIJbMxly-la5w4q_TjyJgJL_jN2fI/preview?tab=t.0 Some of the trade-offs that come with ownership are: To resolve an ObjectRef, the objectâ€™s owner must be reachable. This means that an object will fate-share with its owner. See Object failures and Object spilling for more information about object recovery and persistence. Ownership currently cannot be transferred. (Individual) The first question is: What do you think of Ownershipâ€™s design? Do you buy it? Or which one do you prefer, centralized head node, distributed lease, or Ownership, why? Personally, I prefer distributed lease design because itâ€™s simpler and widely used. For example, Kubernetes uses leases and implements resource management and error tolerance based on leases. Previous versions of Ray utilized centralized head node design and combined with leases. However, since it is difficult to handle garbage collection under lease, and ownership provides better throughput and tail latency because it facilitates worker-to-worker task scheduling and worker reuse. I prefer the Ownership model. (Group Discussion) The purpose of Ownership is to support fault tolerance with distributed memory and distributed future, while also improving throughput and latency. Refer to some memory management papers we read before, software-defined far memory, AIFM, fastswap. Do you think that ownership can be application-aware or resources-aware? like utilizing some data structure from AIFM to allow the owner to release some cold data in advance, so we could reuse the worker? What will the potential problems be? (Group Discussion, optional if time permits) We have learned that many distributed systems utilize logs to achieve fault tolerance. For instance, Delta Lake employs Write-Ahead Logs to support consistency and ACID properties. The paper mentions some future work in section 7, it says that it might support a spectrum of application recovery requirements. For example, we could extend ownership with options to recover actor state. Do you think logs or global object store can be used to implement future like this or even time travel? What metadata do we need? (Whiteboard Question) According to Rayâ€™s documentation, Ray does not support Owner recovery and does not support ownership transfer even though the latest version is build on top of Ownership. What do you think is the reason? Personally, I believe it is because losing all ownership record makes it difficult to rebuild lineage reconstruction. If you were to design it, do you think it could be solved through ownership transfer? For example, use the head node design and adding the feature of ownership transfer, when the owner fails, let the head node restart the owner node and transfer the ownership copy from a certain worker node to the owner node, making the node the owner again. There might be some consistency issues here, and this is an open question, you can present your solution as well as what you think might be the issue? ","date":"2024-11-10","objectID":"/posts/paper-ownership/:8:0","tags":["Paper Reading"],"title":"Paper Reading: Ownership: A Distributed Futures System for Fine-Grained Tasks","uri":"/posts/paper-ownership/"},{"categories":null,"content":"ä¸ºä»€ä¹ˆå¯ç”¨å†…å­˜ä¼šè¿œè¶…ç‰©ç†å†…å­˜ï¼Ÿ ç»“åˆä¸€äº›æ‚ä¸ƒæ‚å…«çš„æ–‡ç« çœ‹çœ‹ https://www.cnblogs.com/binlovetech/p/17571929.html ä¸ºä»€ä¹ˆè¦ä»æ“ä½œç‰©ç†å†…å­˜è½¬å‘æ“ä½œè™šæ‹Ÿå†…å­˜ï¼Ÿ ä¿æŠ¤å†…å­˜ï¼Œæ¯ä¸ªè¿›ç¨‹ä½¿ç”¨çš„å†…å­˜ç‹¬ç«‹ã€éš”ç¦» å¤šè¿›ç¨‹ï¼Œå†…å­˜ç®¡ç†ï¼Œè¿è¡Œæ›´å¤šåº”ç”¨ å±€éƒ¨æ€§ ","date":"2024-11-07","objectID":"/posts/memo-class-1/:1:0","tags":["System","Memory"],"title":"é˜…è¯»ç¬”è®°ï¼šç¼–ç¨‹é«˜æ‰‹å¿…å­¦çš„å†…å­˜çŸ¥è¯† 01","uri":"/posts/memo-class-1/"},{"categories":null,"content":"å±€éƒ¨æ€§åŸç† æ—¶é—´å±€éƒ¨æ€§ï¼šæœªæ¥å¯èƒ½å†æ¬¡è®¿é—® ç©ºé—´å±€éƒ¨æ€§ï¼šå†…å­˜ä½ç½®å¯èƒ½å†æ¬¡è®¿é—® æ¯ä¸ªè¿›ç¨‹éƒ½ç‹¬äº« 128T çš„è™šæ‹Ÿå†…å­˜ç©ºé—´ æ˜¯æ¯ä¸ªè¿›ç¨‹å—ï¼Ÿä¸ºä»€ä¹ˆæ˜¯ 128Tï¼Œ2^64 æ‰€ä»¥éšæ„å®šï¼Ÿå†…æ ¸æ€å‘¢ ä¸ºä»€ä¹ˆè¦è®¾è®¡é‚£ä¹ˆå¤§ 128T å¾ˆå¤šéƒ½ç”¨ä¸å®Œå§ è™šæ‹Ÿå†…å­˜è®©æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰ç‹¬ç«‹çš„ã€ç§æœ‰çš„å†…å­˜ç©ºé—´ï¼Œè€Œä¸”æ¯”å¯ç”¨çš„ç‰©ç†å†…å­˜è¦å¤§å¾—å¤š è™šæ‹Ÿå†…å­˜æ˜¯åªæœ‰ç”¨çš„æ—¶å€™æ‰ä¼šæ˜ å°„å—ï¼Œæ‰€ä»¥å¯ä»¥ä»»æ„åˆ†é…ï¼Ÿ ","date":"2024-11-07","objectID":"/posts/memo-class-1/:1:1","tags":["System","Memory"],"title":"é˜…è¯»ç¬”è®°ï¼šç¼–ç¨‹é«˜æ‰‹å¿…å­¦çš„å†…å­˜çŸ¥è¯† 01","uri":"/posts/memo-class-1/"},{"categories":null,"content":"è™šæ‹Ÿå†…å­˜ æ“ä½œç³»ç»Ÿç®¡ç†è™šæ‹Ÿå†…å­˜å’Œç‰©ç†å†…å­˜æ˜ å°„ï¼Œé€šè¿‡é¡µç®¡ç† ç¨‹åº malloc çš„æ—¶å€™ä¼šå‘ç”Ÿé¡µåˆ†é…ï¼Œä½†ä¸ä¸€å®šå‘ç”Ÿæ˜ å°„ï¼Œç›´åˆ°éœ€è¦è¯»å†™çš„æ—¶å€™æ‰ä¼šçœŸæ­£åˆ†é…å†…å­˜é¡µé¢ ä¸ºä»€ä¹ˆæ˜¯ 128T å‘¢ï¼Œå› ä¸º 64 ä½æœºå™¨ï¼Œ2^64 æ˜¯å¾ˆå¤§çš„ï¼Œåªç”¨äº†ä½ 48 ä½ä¹Ÿå°±æ˜¯ 2^48 = 256Tï¼Œå†…æ ¸æ€å’Œç”¨æˆ·æ€å„ä¸€åŠ è‡³äº 32 ä½æœºå™¨ï¼Œ2^32 å°±åªæœ‰ 4G äº†ï¼Œå†…æ ¸æ€ 1Gï¼Œç”¨æˆ·æ€ 3G è™šæ‹Ÿåœ°å€ç©ºé—´ è€Œä¸”ç”¨æˆ·æ€éƒ½æ˜¯ä½ä½åˆ°é«˜ä½ï¼Œå†…æ ¸ä»é«˜åˆ°ä½ ","date":"2024-11-07","objectID":"/posts/memo-class-1/:1:2","tags":["System","Memory"],"title":"é˜…è¯»ç¬”è®°ï¼šç¼–ç¨‹é«˜æ‰‹å¿…å­¦çš„å†…å­˜çŸ¥è¯† 01","uri":"/posts/memo-class-1/"},{"categories":null,"content":"é¡µè¡¨ CPU é€šè¿‡ MMU å†…å­˜ç®¡ç†å•å…ƒæ˜ å°„è™šæ‹Ÿå†…å­˜åˆ°ç‰©ç†å†…å­˜ï¼Œé€šè¿‡æ“ä½œç³»ç»Ÿè®¾ç½®é¡µè¡¨ é¡µè¡¨æ˜¯ç”± PTE é¡µè¡¨é¡¹ç»„æˆçš„æ•°ç»„ï¼Œè™šæ‹Ÿç©ºé—´æ¯ä¸ªåœ°å€æ¯ä¸ªé¡µéƒ½æœ‰ PTE å¯¹åº” PTE ä¹Ÿæœ‰ä¸€äº› metadataï¼Œæ¯”å¦‚é¡µé¢è¯»å†™æƒé™ï¼Œæ˜¯å¦å­˜åœ¨çš„æœ‰æ•ˆä½ã€è„ä½ç­‰ç­‰ é¡µè¡¨é¡¹å¤§å°æ˜¯å¤šå°‘ï¼Ÿ4 å­—èŠ‚ï¼Ÿ è¿™æ ·é¡µè¡¨ 1024 ä¸ªé¡µè¡¨é¡¹ä¹Ÿæ˜¯ 4K å æ®ä¸€ä¸ªé¡µï¼Ÿé¡µå¤§å°ä¹Ÿæ˜¯ 4Kï¼Ÿ è¿™æ ·ä¸€ä¸ªé¡µè¡¨é¡¹å¯¹åº” 4K é¡µï¼Œä¸€ä¸ªé¡µè¡¨å°±æ”¯æŒ 4M é¡µç›®å½•è¡¨ç”± Page Directory Entry PDE ç»„æˆï¼Œæ¯ä¸ª PDE å¯¹åº”ä¸€ä¸ªé¡µè¡¨ï¼ˆå¼€å§‹çš„ç‰©ç†ä½ç½®ï¼‰ï¼Œæ„æˆäº†å¤šçº§é¡µè¡¨ç»“æ„ã€‚ å¤šçº§é¡µè¡¨ï¼Œ64 ä½å¤„ç†å™¨ä¸Šæœ‰æ›´å¤šçº§çš„é¡µè¡¨ ","date":"2024-11-07","objectID":"/posts/memo-class-1/:2:0","tags":["System","Memory"],"title":"é˜…è¯»ç¬”è®°ï¼šç¼–ç¨‹é«˜æ‰‹å¿…å­¦çš„å†…å­˜çŸ¥è¯† 01","uri":"/posts/memo-class-1/"},{"categories":null,"content":"CPU - çœŸå®åœ°å€ ç»™å®šè™šæ‹Ÿåœ°å€ï¼Œå¦‚ä½•æ˜ å°„åˆ°ç‰©ç†åœ°å€ï¼Ÿ CPU - å¯„å­˜å™¨ (é¡µç›®å½•åŸºå€å¯„å­˜å™¨ CR3): ç¡®å®šé¡µç›®å½•åœ°å€ï¼ˆæœ€é«˜çº§é¡µè¡¨åŸºåœ°å€ï¼‰ï¼Œåœ¨ MMU æ‰¾åˆ°å­˜å‚¨ç€è™šæ‹Ÿåœ°å€åˆ°ç‰©ç†åœ°å€è½¬æ¢é¡µè¡¨é¡¹ PDE é¡µç›®å½•é¡¹ï¼š32 ä½è™šæ‹Ÿåœ°å€æ‹†æˆ 10, 10, 12 ä½ä¸‰æ®µï¼Œé¡µç›®å½•è¡¨åŠåœ°å€å¯ä»¥é€šè¿‡è®¡ç®—æ‰¾åˆ°é¡µç›®å½•é¡¹ é¡µç›®å½•é¡¹ - é¡µè¡¨ - é¡µè¡¨é¡¹ï¼šï¼ˆçœç•¥å†…éƒ¨è®¡ç®—ç»†èŠ‚ï¼‰ è™šæ‹Ÿåœ°å€ - ç‰©ç†åœ°å€ï¼šé¡µè¡¨é¡¹è®°å½•ç‰©ç†åœ°å€ å¯¹äº 64 ä½æœºå™¨ï¼Œä½¿ç”¨äº† 48 ä½è™šæ‹Ÿåœ°å€ï¼Œæœ‰ 4 çº§é¡µè¡¨ +---------------------+ | Page Directory Base | é¡µç›®å½•åŸºåœ°å€ (Page Directory Base Address) +---------------------+ | v +---------------------+ | Page Directory | é¡µç›®å½•è¡¨ (Page Directory Table) +---------------------+ | Page Directory Entry| é¡µç›®å½•é¡¹ (Page Directory Entry) +---------------------+ | v +---------------------+ | Page Table | é¡µè¡¨ (Page Table) +---------------------+ | Page Table Entry | é¡µè¡¨é¡¹ (Page Table Entry) +---------------------+ | v +---------------------+ | Physical Address | ç‰©ç†åœ°å€ (Physical Address) +---------------------+ ","date":"2024-11-07","objectID":"/posts/memo-class-1/:3:0","tags":["System","Memory"],"title":"é˜…è¯»ç¬”è®°ï¼šç¼–ç¨‹é«˜æ‰‹å¿…å­¦çš„å†…å­˜çŸ¥è¯† 01","uri":"/posts/memo-class-1/"},{"categories":null,"content":"é¡µé¢ SWAP ä¸ç»å¸¸ä½¿ç”¨çš„é¡µé¢ï¼Œä¼šè¢«æ¢å‡ºå†…å­˜ï¼Œå­˜åœ¨ç¡¬ç›˜ swap åŒºåŸŸï¼Œæä¾›ç»™æ–°çš„è™šæ‹Ÿå†…å­˜ é¡µé¢è°ƒåº¦ç®—æ³•å¦‚ä½•å®ç°ï¼Ÿ FIFO? è¿˜æ˜¯ RR? æœ‰ä»€ä¹ˆåŒºåˆ«? ","date":"2024-11-07","objectID":"/posts/memo-class-1/:4:0","tags":["System","Memory"],"title":"é˜…è¯»ç¬”è®°ï¼šç¼–ç¨‹é«˜æ‰‹å¿…å­¦çš„å†…å­˜çŸ¥è¯† 01","uri":"/posts/memo-class-1/"},{"categories":null,"content":"AIFM: High-Performance, Application-Integrated Far Memory Disaggregated Memory é¢†åŸŸçš„è®ºæ–‡ï¼Œä¹‹å‰ç¨å¾®çœ‹äº†ä¸€ç‚¹ï¼ŒæŒºæœ‰æ„æ€çš„ä»åº”ç”¨å±‚é¢ç”¨è¿œç«¯å†…å­˜ Zhenyuan Ruan, Malte Schwarzkopf å’Œ Adam Belayï¼Œzhenyuan åœ¨ osdi 20 ä¸­äº†ä¸å°‘è®ºæ–‡ï¼Œå¾ˆå¤šéƒ½å’Œè§£è€¦å†…å­˜æœ‰å…³ï¼Œéå¸¸æœ‰æ„æ€ã€‚adam æ­¤å¤–è¿˜æœ‰ caladan ç­‰ï¼Œå¤ªææ€–äº†ã€‚ ","date":"2024-11-06","objectID":"/posts/paper-aifm/:1:0","tags":["Paper Reading"],"title":"Paper Reading: AIFM: High-Performance, Application-Integrated Far Memory (OSDI 20)","uri":"/posts/paper-aifm/"},{"categories":null,"content":"Abstract application-integrated far memory (AIFM) å®ƒé€šè¿‡ä¸€ä¸ªç®€å•çš„ API å°†è¿œç¨‹çš„â€œè¿œç«¯â€å†…å­˜æä¾›ç»™åº”ç”¨ç¨‹åºï¼Œå¹¶å…·æœ‰é«˜æ€§èƒ½ã€‚AIFM å®ç°äº†ä¸æœ¬åœ° RAM ç›¸åŒçš„å¸¸è§æƒ…å†µè®¿é—®å»¶è¿Ÿï¼›å®ƒé¿å…äº†åŸºäºåˆ†é¡µçš„æ–¹æ³•æ‰€é­å—çš„è¯»å†™æ”¾å¤§ï¼›å®ƒå…è®¸æ•°æ®ç»“æ„å·¥ç¨‹å¸ˆæ„å»ºå¯è¿œç¨‹è®¿é—®çš„ã€æ··åˆè¿‘/è¿œç«¯å†…å­˜æ•°æ®ç»“æ„ï¼›å¹¶ä¸”å®ƒä½¿è¿œç«¯å†…å­˜å¯¹åº”ç”¨ç¨‹åºå¼€å‘è€…é€æ˜ä¸”æ˜“äºä½¿ç”¨ã€‚ è¯»å†™æ”¾å¤§ å°† application-level semantics æš´éœ²ç»™é«˜æ€§èƒ½è¿è¡Œæ—¶ï¼Œä½¿å¾—é«˜æ•ˆçš„è¿œç¨‹å†…å­˜æˆä¸ºå¯èƒ½ã€‚å¼€å‘è€…ä½¿ç”¨ AIFM çš„ API æ¥ä½¿åˆ†é…å¯è¿œç¨‹è®¿é—®ï¼ŒAIFM çš„è¿è¡Œæ—¶è´Ÿè´£å¯¹è±¡çš„äº¤æ¢è¿›å‡ºã€é¢„å–å’Œå†…å­˜ç–æ•£ã€‚ ç¨‹åºè¯­ä¹‰æ˜¯ä»€ä¹ˆæ„æ€ æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªåŸå‹ Web åº”ç”¨ç¨‹åºå‰ç«¯ã€ä¸€ä¸ªçº½çº¦å¸‚å‡ºç§Ÿè½¦æ•°æ®åˆ†æå·¥ä½œè´Ÿè½½ã€ä¸€ä¸ªç±»ä¼¼ memcached çš„é”®å€¼ç¼“å­˜å’Œ Snappy å‹ç¼©æ¥è¯„ä¼° AIFMã€‚å°† AIFM çš„è¿œç¨‹å†…å­˜æ·»åŠ åˆ°è¿™äº›åº”ç”¨ç¨‹åºä¸­ï¼Œå¢åŠ äº†å®ƒä»¬çš„å¯ç”¨å†…å­˜è€Œæ²¡æœ‰æ€§èƒ½æŸå¤±ã€‚AIFM çš„æ€§èƒ½ä¼˜äº Fastswapï¼Œè¿™æ˜¯ä¸€ä¸ªæœ€å…ˆè¿›çš„å†…æ ¸é›†æˆã€åŸºäºåˆ†é¡µçš„è¿œç«¯å†…å­˜ç³»ç»Ÿï¼Œæ€§èƒ½æå‡é«˜è¾¾ 61 å€ã€‚ å®é™…ä¸Šæˆ‘è§‰å¾—è¦å¯¹è¿™äº›åº”ç”¨çš„ç±»å‹åšä¸ªè¯„ä¼°ï¼Œåˆ°åº•æ˜¯ IO å¯†é›†å‹è¿˜æ˜¯å†…å­˜å¯†é›†å‹ å†å°±æ˜¯å¯¹äºäº‘å¹³å°å†…å­˜è¶…å–ï¼Œè¿œç«¯å†…å­˜æœ‰è¿™æ–¹é¢çš„è®¨è®ºå—ï¼Ÿ ","date":"2024-11-06","objectID":"/posts/paper-aifm/:2:0","tags":["Paper Reading"],"title":"Paper Reading: AIFM: High-Performance, Application-Integrated Far Memory (OSDI 20)","uri":"/posts/paper-aifm/"},{"categories":null,"content":"Introduction Google [73] å’Œé˜¿é‡Œå·´å·´ [46] çš„æœåŠ¡å™¨å¹³å‡å†…å­˜åˆ©ç”¨ç‡ä¸º 60%ï¼ŒæœåŠ¡å™¨ä¹‹é—´çš„å·®å¼‚å¾ˆå¤§ï¼Œè€Œå¹³å‡ CPU åˆ©ç”¨ç‡çº¦ä¸º 40%ã€‚ å½“ä»Šçš„æ“ä½œç³»ç»Ÿä¸»è¦é€šè¿‡äº¤æ¢æœºåˆ¶æ”¯æŒå†…å­˜å¼¹æ€§ï¼Œé€šè¿‡å°†æœªä½¿ç”¨çš„ç‰©ç†å†…å­˜é¡µæ¨é€åˆ°è¾ƒæ…¢çš„å†…å­˜å±‚ï¼ˆå¦‚ç£ç›˜æˆ–è¿œç¨‹å†…å­˜ï¼‰æ¥é‡Šæ”¾ RAMã€‚ä½†æ“ä½œç³»ç»Ÿçš„äº¤æ¢æœºåˆ¶åœ¨å›ºå®šä¸”ç²—ç²’åº¦ä¸Šæ“ä½œï¼Œå¹¶äº§ç”Ÿå¤§é‡å¼€é”€ã€‚ä¸ºäº†äº¤æ¢ä¸€ä¸ªé¡µé¢ï¼Œæ“ä½œç³»ç»Ÿå¿…é¡»å¤„ç†é¡µé¢é”™è¯¯ï¼Œè¿™éœ€è¦è¿›å…¥å†…æ ¸å¹¶ç­‰å¾…æ•°æ®åˆ°è¾¾ æ­¤å¤–ï¼ŒLinux å†…æ ¸åœ¨ç­‰å¾…äº¤æ¢æ•°æ®æ—¶ä¼šæ—‹è½¬ï¼Œä»¥é¿å…ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œä¸­æ–­å¤„ç†çš„å¼€é”€ã€‚è¿™æ„å‘³ç€ç­‰å¾…æ—¶é—´ï¼ˆä½¿ç”¨ Fastswap çš„ RDMA åç«¯å¤§çº¦ä¸º 15-20k ä¸ªå‘¨æœŸï¼‰è¢«æµªè´¹äº†ã€‚ æˆ‘ä»¬æè¿°äº†ä¸€ç§æ ¹æœ¬ä¸åŒçš„æ–¹æ³•ï¼šåº”ç”¨ç¨‹åºé›†æˆçš„è¿œç«¯å†…å­˜ï¼ˆAIFMï¼‰ï¼Œå®ƒå°†äº¤æ¢ç»‘å®šåˆ°å•ä¸ªåº”ç”¨ç¨‹åºçº§åˆ«çš„å†…å­˜å¯¹è±¡ï¼Œè€Œä¸æ˜¯è™šæ‹Ÿå†…å­˜ï¼ˆVMï¼‰é¡µé¢çš„æŠ½è±¡ã€‚å¼€å‘è€…ç¼–å†™å¯è¿œç¨‹è®¿é—®çš„æ•°æ®ç»“æ„ï¼Œå…¶æ”¯æŒçš„å†…å­˜å¯ä»¥æ˜¯æœ¬åœ°çš„å’Œâ€œè¿œç«¯â€çš„â€”â€”å³åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šâ€”â€”è€Œä¸å½±å“å¸¸è§æƒ…å†µä¸‹çš„å»¶è¿Ÿæˆ–åº”ç”¨ç¨‹åºååé‡ã€‚å½“ AIFM æ£€æµ‹åˆ°å†…å­˜å‹åŠ›æ—¶ï¼Œå…¶è¿è¡Œæ—¶ä¼šäº¤æ¢å‡ºå¯¹è±¡ï¼Œå¹¶å°†æ‰€æœ‰æŒ‡å‘è¯¥å¯¹è±¡çš„æŒ‡é’ˆè½¬æ¢ä¸ºè¿œç¨‹æŒ‡é’ˆã€‚å½“åº”ç”¨ç¨‹åºè§£å¼•ç”¨è¿œç¨‹æŒ‡é’ˆæ—¶ï¼Œä¸€ä¸ªè½»é‡çº§çš„ç»¿è‰²çº¿ç¨‹è¿è¡Œæ—¶ä¼šå°†å¯¹è±¡æ¢å¤åˆ°æœ¬åœ°å†…å­˜ã€‚è¿è¡Œæ—¶çš„ä½ä¸Šä¸‹æ–‡åˆ‡æ¢æˆæœ¬å…è®¸å…¶ä»–ç»¿è‰²çº¿ç¨‹åœ¨ç­‰å¾…å‘¨æœŸå†…è¿›è¡Œæœ‰æ•ˆåˆ©ç”¨ï¼Œè¿™éšè—äº†è¿œç¨‹è®¿é—®å»¶è¿Ÿå¹¶ä¿æŒäº†é«˜ååé‡ã€‚ç”±äºè¿™äº›å¿«é€Ÿçš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼ŒAIFM åœ¨è®¿é—® 4KB å¯¹è±¡æ—¶æ¯”åŸºäºé¡µé¢çš„æ–¹æ³•é«˜å‡º 81%çš„ååé‡ï¼Œå¹¶ä¸”ç”±äº AIFM é¿å…äº†æ”¾å¤§ï¼Œå®ƒåœ¨è®¿é—®å°å¯¹è±¡æ—¶å®ç°äº† 6.8 å€çš„é«˜ååé‡ï¼ˆå›¾ 1ï¼‰ã€‚ user level æ‰€ä»¥è¿˜æ˜¯æ¯”è¾ƒå¥½çš„ï¼Ÿä¸è¿‡è¿˜å¾—çœ‹çœ‹å…·ä½“å®ç° è‡³äºè¿™é‡Œæåˆ°çš„è¯»å†™æ”¾å¤§ï¼Œåº”è¯¥æ˜¯è¯´è¯»å†™å°å¯¹è±¡ä½†ä»ç„¶æ“ä½œ 4KB é¡µé¢çš„äº‹æƒ…ï¼Ÿ AIFM çš„ç¼–ç¨‹æ¥å£åŸºäºå››ä¸ªå…³é”®æ€æƒ³ï¼šä¸€ä¸ªå¿«é€Ÿã€ä½å¼€é”€çš„å¯è¿œç¨‹è®¿é—®æŒ‡é’ˆæŠ½è±¡ï¼Œä¸€ä¸ªæ— æš‚åœçš„å†…å­˜ evacuatorï¼Œå…è®¸æ•°æ®ç»“æ„å‘è¿è¡Œæ—¶ä¼ è¾¾è¯­ä¹‰ä¿¡æ¯çš„è¿è¡Œæ—¶ APIï¼Œä»¥åŠä¸€ä¸ªå¸®åŠ©å°†è½»é‡è®¡ç®—å¸è½½åˆ°è¿œç¨‹å†…å­˜çš„è¿œç¨‹è®¾å¤‡æ¥å£ã€‚è¿™äº› AIFM API å…è®¸æ•°æ®ç»“æ„å·¥ç¨‹å¸ˆè½»æ¾æ„å»ºæ··åˆæœ¬åœ°/è¿œç¨‹æ•°æ®ç»“æ„ï¼Œå¹¶æä¾›ç±»ä¼¼äº C++ æ ‡å‡†åº“æ•°æ®ç»“æ„çš„å¼€å‘è€…ä½“éªŒã€‚ æ— æš‚åœçš„å†…å­˜ç–æ•£å™¨ç¡®ä¿åº”ç”¨ç¨‹åºçº¿ç¨‹æ°¸è¿œä¸ä¼šå› äº¤æ¢è€Œç»å†å»¶è¿Ÿå³°å€¼ã€‚å› ä¸ºæ•°æ®ç»“æ„å‘è¿è¡Œæ—¶ä¼ è¾¾äº†å®ƒä»¬çš„è¯­ä¹‰ï¼ŒAIFM æ”¯æŒè‡ªå®šä¹‰é¢„å–å’Œç¼“å­˜ç­–ç•¥â€”â€”ä¾‹å¦‚ï¼Œåœ¨å¯è¿œç¨‹è®¿é—®çš„åˆ—è¡¨ä¸­é¢„å–è¿œç¨‹æ•°æ®ï¼Œå¹¶é¿å…æ±¡æŸ“æœ¬åœ°å†…å­˜ç¼“å­˜çš„è¿œç¨‹æ•°æ®æµã€‚æœ€åï¼ŒAIFM çš„å¸è½½å‡å°‘äº†æ•°æ®ç§»åŠ¨ï¼Œå¹¶ç¼“è§£äº†å¤§å¤šæ•°è¿œç«¯å†…å­˜ç³»ç»Ÿç»å†çš„ç½‘ç»œç“¶é¢ˆã€‚ æ— æš‚åœæ˜¯æ€ä¹ˆå®ç°çš„ï¼Œå‡å°‘æ•°æ®ç§»åŠ¨ä¹Ÿå°±æ˜¯å‡å°‘è¯»å†™æ”¾å¤§ï¼Ÿ Our prototype is limited to unshared far memory objects on a single memory server. Future work may add multi-server support, devise strategies for dynamic sizing of remote memory, or investigate sharing. è¿™é™åˆ¶çœ‹ç€å¾ˆå¥‡æ€ªï¼Œæ‰€ä»¥æ²¡æœ‰ç½‘ç»œé€šä¿¡ï¼Ÿ ","date":"2024-11-06","objectID":"/posts/paper-aifm/:3:0","tags":["Paper Reading"],"title":"Paper Reading: AIFM: High-Performance, Application-Integrated Far Memory (OSDI 20)","uri":"/posts/paper-aifm/"},{"categories":null,"content":"Background and Related Work å½“ä»Šæ“ä½œç³»ç»Ÿä¸»è¦é€šè¿‡å°†ç‰©ç†å†…å­˜é¡µäº¤æ¢åˆ°äºŒçº§å­˜å‚¨æ¥å®ç°å†…å­˜å¼¹æ€§ï¼Œæ¯”å¦‚ç£ç›˜ æœ€è¿‘çš„ç ”ç©¶è€ƒè™‘å°†äº¤æ¢åˆ°æ›´å¿«çš„å†…å­˜å±‚æˆ–è¿œç«¯å†…å­˜ï¼Œä¾‹å¦‚ä¸»æœºçš„è¿œç¨‹å†…å­˜æˆ–å‹ç¼©ç¼“å­˜ã€‚ç”±äºäº¤æ¢ä¸å†…æ ¸è™šæ‹Ÿå†…å­˜å­ç³»ç»Ÿé›†æˆï¼Œå› æ­¤å¯¹ç”¨æˆ·ç©ºé—´åº”ç”¨ç¨‹åºæ˜¯é€æ˜çš„ã€‚ä½†è¿™ç§é€æ˜æ€§ transparency ä¹Ÿè¿«ä½¿äº¤æ¢ç²’åº¦ä¸ºæœ€å°çš„è™šæ‹Ÿå†…å­˜åŸè¯­ï¼Œå³ 4KB é¡µé¢ã€‚ç»“åˆå°äº 4KB çš„å†…å­˜å¯¹è±¡ï¼Œè¿™å¯¼è‡´ I/O æ”¾å¤§ï¼šå½“è®¿é—®ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå†…æ ¸å¿…é¡»ç‹¬ç«‹äºå¯¹è±¡çš„å®é™…å†…å­˜å¤§å°äº¤æ¢ä¸€ä¸ªå®Œæ•´çš„ 4KB é¡µé¢ã€‚æ­¤å¤–ï¼Œæä¾›åº”ç”¨ç¨‹åºè¯­ä¹‰ä¿¡æ¯ï¼Œå¦‚é¢„æœŸçš„å†…å­˜è®¿é—®æ¨¡å¼ã€é€‚å½“çš„é¢„å–ç­–ç•¥æˆ–å†…å­˜çƒ­åº¦ï¼Œä»…é™äºç²—ç•¥å’Œä¸çµæ´»çš„æ¥å£ï¼Œå¦‚ madviseã€‚ é€æ˜æ€§æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿç³»ç»Ÿéšè—äº†å…·ä½“åŸç†ï¼Œç›´æ¥ç”¨ï¼Ÿ AIFM ä»¥ä¸åŒäºäº¤æ¢çš„æ–¹å¼ä½¿ç”¨è¿œç«¯å†…å­˜ï¼Œé€šè¿‡åœ¨å¯¹è±¡ç²’åº¦è€Œä¸æ˜¯é¡µé¢ç²’åº¦ä¸Šæ“ä½œâ€”â€”è¿™ä¸€æƒ³æ³•å€Ÿé‰´äº†åˆ†å¸ƒå¼å…±äº«å†…å­˜ï¼ˆè§ä¸‹æ–‡ï¼‰ã€å†…å­˜å‹ç¼©[75]å’Œ SSD å­˜å‚¨[1]çš„å…ˆå‰å·¥ä½œã€‚è¿™äº›ç ”ç©¶éƒ½æŒ‡å‡ºé¡µé¢çº§ I/O æ”¾å¤§æ˜¯ä¸€ä¸ªå…³é”®åŠ¨æœºã€‚AIFM ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆå’Œå— C++ å¼±æŒ‡é’ˆ[69]å’Œ Folly RCU ä¿æŠ¤[26]å¯å‘çš„è§£å¼•ç”¨èŒƒå›´ï¼Œæä¾›å¯¹è¿œç«¯å†…å­˜çš„é€æ˜è®¿é—®ã€‚ åˆ†å¸ƒå¼å…±äº«å†…å­˜ æœ‰æ„æ€ï¼Œè¿™ä¸€ç¯‡è®ºæ–‡è¿˜æ˜¯è›®åå‘å­˜å‚¨è®¾è®¡çš„ å“ˆå“ˆ RCU è¿˜æ˜¯æ²¡çœ‹ Disaggregated and distributed shared memory: åˆ†è§£å†…å­˜[58]æŒ‡çš„æ˜¯ä¸€ç§ç¡¬ä»¶æ¶æ„ï¼Œå…¶ä¸­å¿«é€Ÿç»“æ„å°†ä¸»æœºè¿æ¥åˆ°å†…å­˜æ± [29, 33]ï¼Œè¿™å¯èƒ½ç”±é›†ç¾¤èŒƒå›´çš„æ“ä½œç³»ç»Ÿç®¡ç†[33, 66]ã€‚åˆ†è§£å†…å­˜éœ€è¦å°šæœªæŠ•å…¥ç”Ÿäº§çš„æ–°ç¡¬ä»¶ã€‚AIFM ä¸“æ³¨äºå½“ä»Šç¡¬ä»¶çš„è½¯ä»¶è§£å†³æ–¹æ¡ˆã€‚ åˆ†å¸ƒå¼å…±äº«å†…å­˜ï¼ˆDSMï¼‰é€šè¿‡æ¶ˆæ¯ä¼ é€’æä¾›å…±äº«å†…å­˜çš„æŠ½è±¡ã€‚å› ä¸ºDSMéœ€è¦ä¸€ä¸ªç¼“å­˜ä¸€è‡´æ€§åè®®ï¼Œè¿™ä¼šæŸå®³æ€§èƒ½ã€‚ Technologies to access remote data: TCP/IP æ˜¯è®¿é—®è¿œç¨‹æ•°æ®çš„ä¸»å¯¼åè®®ï¼ŒAIFM ç›®å‰ä½¿ç”¨ TCP/IPã€‚TCP/IP å­˜åœ¨æ›´å¿«çš„æ›¿ä»£æ–¹æ¡ˆï¼Œå¯ä»¥è¿›ä¸€æ­¥æ”¹è¿› AIFMï¼Œä½†è¿™äº›æŠ€æœ¯ä¸ AIFM çš„å…³é”®æ€æƒ³æ­£äº¤æˆ–äº’è¡¥ã€‚AIFM ä¸éœ€è¦ä¸“é—¨çš„ç¡¬ä»¶ï¼ŒRDMA æ˜¯ä¸€ç§æ—§æŠ€æœ¯ï¼Œæœ€è¿‘åœ¨ä»¥å¤ªç½‘ä¸Šå®ç°äº†å•†å“åŒ–[32]ï¼Œå¼•èµ·äº†æ–°çš„å…´è¶£ã€‚è®¸å¤šå·¥ä½œè‡´åŠ›äºåœ¨ä¸€èˆ¬[39, 51, 76]æˆ–ç‰¹å®šåº”ç”¨ç¨‹åºï¼ˆå¦‚é”®å€¼å­˜å‚¨[38, 49]æˆ–æ•°æ®åº“ç³»ç»Ÿ[11]ï¼‰ä¸­é«˜æ•ˆä½¿ç”¨ RDMA å¦ä¸€ä¸ªå¥½å¥‡çš„ç‚¹æ˜¯ï¼Œæ—¢ç„¶æå‡åˆ° user-levelï¼Œä¸ºä»€ä¹ˆä¸åšæ›´æ·±å…¥çš„ç”¨æˆ·ç½‘ç»œæ ˆå‘¢ ä½† AIFM åˆ°åº•ç”¨ä¸ç”¨ RDMAï¼Ÿ Abstractions for remote data: è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼ˆRPCï¼‰å¹¿æ³›ç”¨äºè®¿é—®è¿œç¨‹æ•°æ®ï¼ŒåŒ…æ‹¬é€šè¿‡ RDMA[19, 71]æˆ– TCP/IP[37]ã€‚è€Œè¿œç¨‹æ•°æ®çš„æ•°æ®ç»“æ„åº“[4, 15]ä¸ºå¼€å‘è€…æä¾›äº†æ˜ å°„ã€é›†åˆã€å¤šé›†åˆã€åˆ—è¡¨å’Œå…¶ä»–ç†Ÿæ‚‰çš„æ„é€ ã€‚è¿™ä¸æŒä¹…å†…å­˜çš„æ•°æ®ç»“æ„åº“[59, 62]çš„ç²¾ç¥ç›¸ä¼¼ã€‚AIFM æä¾›äº†ä¸€ä¸ªæ›´ä½çº§åˆ«çš„æœåŠ¡ï¼Œå¸®åŠ©ç¨‹åºå‘˜å¼€å‘è¿™äº›æ•°æ®ç»“æ„ã€‚ I/O amplification: Garbage collection and memory evacuation: åœ¨ AIFM ä¸­å°†å¯¹è±¡ç§»åŠ¨åˆ°è¿œç¨‹å†…å­˜ï¼ˆâ€œç–æ•£â€ï¼‰ä¸æ‰˜ç®¡è¯­è¨€ä¸­çš„æ ‡è®°-å‹ç¼©åƒåœ¾æ”¶é›†ï¼ˆGCï¼‰å¯†åˆ‡ç›¸å…³ã€‚AIFM æ—¨åœ¨é€šè¿‡å°†å†·ä½†æ´»è·ƒçš„å¯¹è±¡ cold, but live objectsç§»åŠ¨åˆ°è¿œç¨‹å†…å­˜æ¥å¢åŠ å†…å­˜å®¹é‡ï¼Œè€Œ GC åˆ™ä¸“æ³¨äºé‡Šæ”¾æ­»å¯¹è±¡çš„å†…å­˜ AIFMæ²¡æœ‰å‘æ˜æ–°çš„ç–æ•£ç®—æ³•ï¼Œè€Œæ˜¯ä»GCæ–‡çŒ®ä¸­å€Ÿé‰´äº†æ€æƒ³ï¼Œå¹¶å°†å…¶é€‚åº”äºè¿œç«¯å†…å­˜ç³»ç»Ÿã€‚ä¸GCç±»ä¼¼ï¼ŒAIFMåˆ©ç”¨è¯»/å†™å±éšœæ¥ç»´æŠ¤å¯¹è±¡çƒ­åº¦ è¯»å†™å±éšœä¹Ÿæ˜¯ä¸ªå¾ˆæœ‰è¶£çš„æŠ€æœ¯ ä½† AIFM ä½¿ç”¨ä¸€ä¸ªå­—èŠ‚çš„çƒ­åº¦è®¡æ•°å™¨è€Œä¸æ˜¯ä¸€ä¸ªæ¯”ç‰¹æ ‡å¿—ï¼Œå…è®¸æ›´ç»†ç²’åº¦çš„æ›¿æ¢ç­–ç•¥ã€‚ä¸ AIFM ç±»ä¼¼ï¼Œä¸€äº›å¤åˆ¶æ”¶é›†å™¨é€šè¿‡åœ¨ GC æœŸé—´åˆ†ç¦»çƒ­æ•°æ®å’Œå†·æ•°æ®æ¥ä¼˜åŒ–æ•°æ®å±€éƒ¨æ€§ï¼Œä½†ç›®æ ‡ä¸åŒçš„å†…å­˜å±‚æ¬¡ç»“æ„ï¼›ä¾‹å¦‚ï¼Œç¼“å­˜-DRAM å±‚æ¬¡ç»“æ„[34]ï¼ŒDRAM-NVM å±‚æ¬¡ç»“æ„[5, 79, 80]å’Œ DRAM-ç£ç›˜å±‚æ¬¡ç»“æ„[14]ã€‚æœ€åï¼Œå†…å­˜ç–æ•£ä¼šå¹²æ‰°ç”¨æˆ·ä»»åŠ¡å¹¶å½±å“å…¶æ€§èƒ½ã€‚ä¸ºäº†å‡å°‘å¹²æ‰°ï¼ŒAIFM é‡‡ç”¨äº†ä¸æ‰˜ç®¡è¯­è¨€ä¸­çš„æ— æš‚åœ GC ç®—æ³•[20]ç±»ä¼¼çš„æ–¹æ³•ï¼Œè€Œä¸æ˜¯åœæ­¢ä¸–ç•Œçš„ GC ç®—æ³•[36]ã€‚ pauseless GC algorithms ä¸çŸ¥é“æ˜¯ä¸æ˜¯ Java ç°åœ¨ç”¨çš„ï¼Œä½†å¥½åƒä¹Ÿéœ€è¦ä¸€äº›å°æš‚åœï¼Œæ¯”å¦‚ JDK 12 Shenandoah GC å’Œ ZGC Cliff Click, Gil Tene, and Michael Wolf. â€œThe pauseless GC algorithmâ€. In: ACM/USENIX international conference on Virtual execution environments (VEE). 2005. ","date":"2024-11-06","objectID":"/posts/paper-aifm/:4:0","tags":["Paper Reading"],"title":"Paper Reading: AIFM: High-Performance, Application-Integrated Far Memory (OSDI 20)","uri":"/posts/paper-aifm/"},{"categories":null,"content":"Motivation å†…æ ¸åˆ†é¡µæœºåˆ¶åœ¨è®¿é—®è¿œç«¯å†…å­˜çš„åŸºæœ¬æˆæœ¬ä¸Šå¼•å…¥äº†å¤§é‡å¼€é”€ã€‚è€ƒè™‘å›¾ 2ï¼Œå®ƒåˆ†è§£äº† Linuxï¼ˆv5.0.0ï¼‰ä» SSD æ£€ç´¢äº¤æ¢å‡ºçš„é¡µé¢çš„æˆæœ¬ã€‚è®¾å¤‡çš„ç¡¬ä»¶å»¶è¿Ÿçº¦ä¸º 6Âµsï¼Œä½†ç”±äºä¸é”å®šï¼ˆP1ï¼ŒP5ï¼‰ã€è™šæ‹Ÿå†…å­˜ç®¡ç†ï¼ˆP2ï¼ŒP3ï¼ŒP5ï¼‰ã€è®°è´¦ï¼ˆP4ï¼‰å’Œè¯»å– I/O æ”¾å¤§ï¼ˆP3ï¼‰ç›¸å…³çš„å¼€é”€ï¼ŒLinux éœ€è¦è¶…è¿‡ 15Âµsï¼ˆ2.5 å€ï¼‰ã€‚æ­¤å¤–ï¼Œç”±äºä¸Šä¸‹æ–‡åˆ‡æ¢çš„é«˜æˆæœ¬ï¼ŒLinux åœ¨ç­‰å¾…æ•°æ®æ—¶ä¼šæ—‹è½¬ï¼ˆP3ï¼‰ï¼Œæµªè´¹äº† 11.7Âµs çš„å¯èƒ½è®¡ç®—æ—¶é—´ã€‚ è¿™é‡Œçš„å‡ ä¸ª phase å¯ä»¥è¯¦ç»†è®²è®² Linux Kernel swapping P1 page fault, trap P2 Lock -\u003e PTE é¡µè¡¨è·å–é¡µé¢ç£ç›˜ä½ç½® -\u003e allocate page frame é¡µé¢å¸§ -\u003e swap cache entry P3 read IO è¯·æ±‚ -\u003e spin æ£€æŸ¥ IO æ˜¯å¦å®Œæˆ -\u003e é¡µé¢è¿›å…¥ LRU P4 cgroup è®¡æ•°ï¼Œæ›´æ–°å†…å­˜ä½¿ç”¨æƒ…å†µ -\u003e å›æ”¶å†…å­˜å¦‚æœè¶…è¿‡äº†é™åˆ¶ P5 é¡µé¢æ˜ å°„ PTE -\u003e è§£é” ä½†æ˜¯ AIFM ç›´æ¥è¯·æ±‚ IOï¼Œè¿›å…¥ context switch ç„¶åç”¨åç¨‹ç­‰å¾…ï¼Œæœ€åä¸Šä¸‹æ–‡åˆ‡æ¢å›å» ","date":"2024-11-06","objectID":"/posts/paper-aifm/:5:0","tags":["Paper Reading"],"title":"Paper Reading: AIFM: High-Performance, Application-Integrated Far Memory (OSDI 20)","uri":"/posts/paper-aifm/"},{"categories":null,"content":"AIFM Design ","date":"2024-11-06","objectID":"/posts/paper-aifm/:6:0","tags":["Paper Reading"],"title":"Paper Reading: AIFM: High-Performance, Application-Integrated Far Memory (OSDI 20)","uri":"/posts/paper-aifm/"},{"categories":null,"content":"Overview AIFM é¢å‘ä¸¤ä¸ªç¾¤ä½“ï¼šåº”ç”¨ç¨‹åºå¼€å‘è€…å’Œæ•°æ®ç»“æ„å¼€å‘è€…ã€‚ å¯¹äºåº”ç”¨ç¨‹åºå¼€å‘è€…æ¥è¯´ï¼Œä½¿ç”¨è¿œç«¯å†…å­˜ç¼–ç¨‹åº”ç”¨ç¨‹åºåº”è¯¥æ„Ÿè§‰å‡ ä¹ä¸ä½¿ç”¨çº¯æœ¬åœ°æ•°æ®ç»“æ„ç¼–ç¨‹ç›¸åŒã€‚ç‰¹åˆ«æ˜¯ï¼Œå¼€å‘è€…ä¸åº”è¯¥éœ€è¦çŸ¥é“ä¸€ä¸ªå¯¹è±¡å½“å‰æ˜¯æœ¬åœ°çš„è¿˜æ˜¯è¿œç¨‹çš„ï¼ˆå³è¿œç«¯å†…å­˜æ˜¯é€æ˜çš„ï¼‰ å¯¹å¼€å‘è€…æ¥è¯´ç”¨æ³•å’Œ std åº”è¯¥ä¸€æ ·ï¼Ÿ RemHashtable\u003ckey_t, int\u003e hashtable; RemArray\u003cdata_t\u003e arr; å¯è¿œç¨‹è®¿é—®çš„å†…å­˜æ•°æ®ç»“æ„æœ¬èº«ï¼ˆä¸Šé¢çš„ RemHashtable å’Œ RemArrayï¼‰ç”±æ•°æ®ç»“æ„å·¥ç¨‹å¸ˆç¼–å†™ï¼Œä»–ä»¬ä½¿ç”¨ AIFM çš„è¿è¡Œæ—¶ API å°†å¯è¿œç¨‹è®¿é—®çš„å†…å­˜å¯¹è±¡åŒ…å«åœ¨ä»–ä»¬çš„æ•°æ®ç»“æ„ä¸­ å½“å†…å­˜å˜å¾—ç´§å¼ æ—¶ï¼ŒAIFM çš„è¿è¡Œæ—¶ä¼šå°†å…¶ä¸­ä¸€äº›å†…å­˜å¯¹è±¡ç§»åŠ¨åˆ°è¿œç¨‹å†…å­˜ï¼›å½“æ•°æ®ç»“æ„éœ€è¦è®¿é—®è¿œç¨‹å¯¹è±¡æ—¶ï¼ŒAIFM è¿è¡Œæ—¶ä¼šè·å–å®ƒä»¬ã€‚æ•°æ®ç»“æ„å·¥ç¨‹å¸ˆæœ‰å¾ˆå¤§çš„è®¾è®¡è‡ªç”±åº¦ï¼šä»–ä»¬å¯ä»¥å®Œå…¨ä¾èµ– AIFM æ¥è·å–è¿œç¨‹å¯¹è±¡ï¼Œæˆ–è€…ä»–ä»¬å¯ä»¥åœ¨è¿œç¨‹ç«¯éƒ¨ç½²è‡ªå®šä¹‰é€»è¾‘ã€‚ è¿™é‡Œçš„ç§»åŠ¨æ˜¯æ€ä¹ˆå‘ç”Ÿçš„ï¼Ÿæ¶ˆè€—æ˜¯ä»€ä¹ˆï¼Œæ€ä¹ˆç›‘æ§å†…å­˜ç´§å¼ å‘¢ï¼Ÿæ˜¯å¦ä¼šè¢«åˆ«çš„ä¿®æ”¹å‘¢ï¼Ÿä»€ä¹ˆæ—¶å€™å›æ”¶å‘¢ ","date":"2024-11-06","objectID":"/posts/paper-aifm/:6:1","tags":["Paper Reading"],"title":"Paper Reading: AIFM: High-Performance, Application-Integrated Far Memory (OSDI 20)","uri":"/posts/paper-aifm/"},{"categories":null,"content":"Remoteable Memory Abstractions We designed the abstractions such that they impose minimal overheads (as low as three micro-ops) on â€œhot pathâ€ access to local objects, and try to ensure that the â€œcold pathâ€ remote access incurs little latency above hardware limits Remoteable Pointers Memory representation. å”¯ä¸€å¯è¿œç¨‹è®¿é—®æŒ‡é’ˆï¼ˆå¯¹åº”äº C++çš„ std::unique_ptrï¼‰çš„å¤§å°ä¸æ™®é€š 64 ä½æŒ‡é’ˆç›¸åŒï¼Œè€Œå…±äº«æŒ‡é’ˆï¼ˆå¯¹åº”äº C++çš„ std::shared_ptrï¼‰çš„å®½åº¦ä¸º 128 ä½ã€‚å›¾ 4 æ˜¾ç¤ºäº†å¯è¿œç¨‹è®¿é—®å”¯ä¸€æŒ‡é’ˆçš„å†…å­˜å¸ƒå±€ã€‚æ ¹æ®å¯è¿œç¨‹è®¿é—®æŒ‡é’ˆæ˜¯æœ¬åœ°è¿˜æ˜¯è¿œç¨‹ï¼Œæˆ‘ä»¬é‡‡ç”¨ä¸åŒçš„æ ¼å¼ã€‚å¦‚æœå†…å­˜æ˜¯æœ¬åœ°çš„ï¼ˆå›¾ 4aï¼‰ï¼ŒæŒ‡é’ˆåœ¨å…¶ä½ 47 ä½ä¸­åŒ…å«ä¸€ä¸ªè™šæ‹Ÿå†…å­˜åœ°å€ï¼ˆè¶³ä»¥è¡¨ç¤ºç”¨æˆ·ç©ºé—´åœ°å€ï¼‰ï¼Œå¹¶åœ¨é«˜ 17 ä½ä¸­åŒ…å«æ§åˆ¶ä½ï¼ŒåŒ…æ‹¬æ ‡å‡†çš„è„ä½ï¼ˆDï¼‰å’Œå­˜åœ¨ä½ï¼ˆPï¼‰ï¼ˆå‚è€ƒé¡µè¡¨ï¼‰ã€‚å®ƒè¿˜åŒ…å«ç”¨äºè·Ÿè¸ªæŒ‡é’ˆæ˜¯å¦çƒ­ï¼ˆHï¼‰ä»¥åŠæ˜¯å¦æ­£åœ¨å¹¶å‘ç–æ•£ï¼ˆEï¼‰çš„ä½ã€‚å¯¹äºå”¯ä¸€æŒ‡é’ˆï¼Œå…±äº«ä½ï¼ˆSï¼‰è®¾ç½®ä¸º 0ã€‚æˆ‘ä»¬å°† Dã€E å’Œ H ä½æŒ‰å­—èŠ‚å¯¹é½ï¼Œå…è®¸æ¯ä¸ªä½ç”±å˜å¼‚å™¨å’Œè¿è¡Œæ—¶ç–æ•£å™¨å¹¶å‘ä¸”åŸå­åœ°è®¿é—®ï¼Œå› ä¸ºå­—èŠ‚æ˜¯æœ€å°çš„è¯»/å†™å•ä½ã€‚ API: æ¸…å• 1 æ˜¾ç¤ºäº†å¯è¿œç¨‹è®¿é—®å”¯ä¸€æŒ‡é’ˆçš„ APIï¼ˆå…±äº«æŒ‡é’ˆçš„ API å¤§è‡´ç›¸åŒï¼‰ã€‚RemUniquePtr æœ‰ä¸¤ä¸ªæ„é€ å‡½æ•°ï¼šä¸€ä¸ªç”¨äºå·²ç»æœ¬åœ°çš„å¯¹è±¡ï¼Œå¦ä¸€ä¸ªç”¨äºå½“å‰è¿œç¨‹çš„å¯¹è±¡ã€‚ç¬¬äºŒä¸ªæ„é€ å‡½æ•°å…è®¸æ•°æ®ç»“æ„å½¢æˆæŒ‡å‘å½“å‰è¿œç¨‹å¯¹è±¡çš„å¯è¿œç¨‹è®¿é—®æŒ‡é’ˆã€‚è¿™æœ‰åŠ©äºæ•°æ®ç»“æ„å·¥ç¨‹å¸ˆä»å…¶æ•°æ®ç»“æ„ä¸­å¼•ç”¨è¿œç¨‹å¯¹è±¡ï¼Œè€Œæ— éœ€è·å–è¿™äº›å¯¹è±¡ã€‚ è¦å°†è¿œç¨‹æŒ‡é’ˆè½¬æ¢ä¸ºæœ¬åœ°æŒ‡é’ˆï¼Œç¨‹åºå‘˜é€šè¿‡ deref å’Œ deref_mut API æ–¹æ³•è¿›è¡Œè§£å¼•ç”¨ã€‚ Dereferencing è¿è¡Œæ—¶ä¼šæ£€æŸ¥å¯è¿œç¨‹è®¿é—®æŒ‡é’ˆçš„å­˜åœ¨ä½ã€‚å¦‚æœå¯¹è±¡æ˜¯æœ¬åœ°çš„ï¼Œå®ƒå°†è®¾ç½®çƒ­ä½å¹¶è¿”å›å­˜å‚¨åœ¨æŒ‡é’ˆä¸­çš„åœ°å€ã€‚å¦åˆ™ï¼Œè¿è¡Œæ—¶ä¼šä»è¿œç¨‹æœåŠ¡å™¨è·å–å¯¹è±¡ï¼Œè®¾ç½®çƒ­ä½å’Œè„ä½ï¼ˆåœ¨ deref_mut ä¸­ï¼‰ï¼Œå¹¶è¿”å›æŒ‡å‘æ•°æ®çš„æœ¬åœ°æŒ‡é’ˆã€‚ Dereference Scopes æœªæ¥ï¼ŒAIFM å¯èƒ½ä¼šåˆ©ç”¨é™æ€åˆ†ææ¥æ•æ‰ç”Ÿå‘½å‘¨æœŸè¿è§„ï¼Œå¦‚ Rust ç¼–è¯‘å™¨ Evacuation Handlers æ•°æ®ç»“æ„å¼€å‘è€…é€šè¿‡è°ƒç”¨ RegisterEvacHandler æ³¨å†Œä»–ä»¬çš„ç–æ•£å¤„ç†å™¨ã€‚ç–æ•£å¤„ç†å™¨ä¸å”¯ä¸€çš„æ•°æ®ç»“æ„ ID ç»‘å®šï¼Œæ¯ä¸ªæ•°æ®ç»“æ„åœ¨å…¶æ„é€ å‡½æ•°ä¸­åˆ†é…è¯¥ IDï¼Œæ•°æ®ç»“æ„å·¥ç¨‹å¸ˆå¿…é¡»ä¸€è‡´ä½¿ç”¨è¯¥ IDã€‚è¿™æ ·ï¼Œä¸åŒçš„æ•°æ®ç»“æ„æˆ–åŒä¸€æ•°æ®ç»“æ„çš„å®ä¾‹å¯ä»¥åœ¨åŒä¸€ä¸ªåº”ç”¨ç¨‹åºä¸­å…±å­˜ï¼Œè€Œè¿è¡Œæ—¶ä¼šè°ƒç”¨é€‚å½“çš„å¤„ç†å™¨ Remote Devices Semantic Hints Hotness tracking å†…å­˜ç–æ•£å™¨ä½¿ç”¨æ­¤çƒ­åº¦ä¿¡æ¯æ¥ç¡®ä¿é¢‘ç¹è®¿é—®çš„å¯¹è±¡æ˜¯æœ¬åœ°çš„ Prefetching AIFM åŒ…å«ä¸€ä¸ªåº“ï¼Œæ•°æ®ç»“æ„å¯ä»¥ä½¿ç”¨è¯¥åº“æ¥ç»´æŠ¤æ¯ä¸ªçº¿ç¨‹çš„è§£å¼•ç”¨ä½ç½®å†å²çª—å£ï¼Œå¹¶ä½¿ç”¨æœ‰é™çŠ¶æ€æœºï¼ˆFSMï¼‰é¢„æµ‹æœªæ¥çš„è®¿é—® Nontemporal Access å¯¹äºæ²¡æœ‰æ—¶é—´å±€éƒ¨æ€§çš„å¯¹è±¡çš„å¯è¿œç¨‹è®¿é—®æŒ‡é’ˆï¼Œé™åˆ¶ç”¨äºå­˜å‚¨å…¶å¯¹è±¡æ•°æ®çš„æœ¬åœ°å†…å­˜æ˜¯æœ‰æ„ä¹‰çš„ æ²¡æœ‰æ—¶é—´å±€éƒ¨æ€§ï¼Œå°±æ˜¯æœªæ¥å¯èƒ½ä¸å†è®¿é—®ï¼Ÿå¯ä»¥ç«‹å³å›æ”¶ è™½ç„¶å¾ˆè¯¦ç»†ï¼Œä½†æˆ‘è§‰å¾—è¿™éƒ¨åˆ†è®²çš„è¿˜æ˜¯ä¸å¤Ÿæ¸…æ¥šä¸å¤Ÿç›´è§‚ ","date":"2024-11-06","objectID":"/posts/paper-aifm/:6:2","tags":["Paper Reading"],"title":"Paper Reading: AIFM: High-Performance, Application-Integrated Far Memory (OSDI 20)","uri":"/posts/paper-aifm/"},{"categories":null,"content":"AIFM Runtime AIFM çš„è¿è¡Œæ—¶å»ºç«‹åœ¨â€œç»¿è‰²â€çº¿ç¨‹ï¼ˆè½»é‡çº§ç”¨æˆ·çº§çº¿ç¨‹ï¼‰ã€å†…æ ¸æ—è·¯ TCP/IP ç½‘ç»œæ ˆå’Œæ— æš‚åœå†…å­˜ç–æ•£å™¨ä¹‹ä¸Šã€‚åº”ç”¨ç¨‹åºå°†è¿è¡Œæ—¶é“¾æ¥åˆ°å…¶ç”¨æˆ·ç©ºé—´è¿›ç¨‹ä¸­ã€‚è¿™ä½¿æˆ‘ä»¬èƒ½å¤Ÿä¸ AIFM çš„æŠ½è±¡å…±åŒè®¾è®¡è¿è¡Œæ—¶ï¼Œå¹¶æä¾›é«˜æ€§èƒ½çš„è¿œç«¯å†…å­˜ï¼Œè€Œä¸ä¾èµ–äºä»»ä½•æ“ä½œç³»ç»Ÿå†…æ ¸æŠ½è±¡ã€‚ ","date":"2024-11-06","objectID":"/posts/paper-aifm/:7:0","tags":["Paper Reading"],"title":"Paper Reading: AIFM: High-Performance, Application-Integrated Far Memory (OSDI 20)","uri":"/posts/paper-aifm/"},{"categories":null,"content":"Hiding Remote Access Latency ç°æœ‰çš„æ“ä½œç³»ç»Ÿå†…æ ¸çº¿ç¨‹æ”¯ä»˜é«˜ä¸Šä¸‹æ–‡åˆ‡æ¢æˆæœ¬ï¼šä¾‹å¦‚ï¼Œåœ¨ Linux ä¸Šï¼Œé‡æ–°è°ƒåº¦ä»»åŠ¡å¤§çº¦éœ€è¦ 500nsã€‚è¿™äº›æˆæœ¬æ˜¯è¿œç¨‹å†…å­˜å»¶è¿Ÿçš„éå¹³å‡¡éƒ¨åˆ†ï¼Œå› æ­¤ Linux å’Œ Fastswap é‡‡ç”¨äº†ä¸€ç§è®¾è®¡ï¼Œå³åœ¨ç­‰å¾…ç½‘ç»œå“åº”æ—¶å¿™ç­‰å¾…[6]ã€‚è¿™é¿å…äº†ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€ï¼Œä½†ä¹Ÿæµªè´¹äº†å‡ ä¸ªå¾®ç§’çš„å¤„ç†æ—¶é—´ã€‚è¿™ç§æ–¹æ³•è¿˜å¯¹ç½‘ç»œæä¾›å•†æ–½åŠ äº†å·¨å¤§å‹åŠ›ï¼Œè¦æ±‚æ”¯æŒæ›´ä½çš„å»¶è¿Ÿï¼Œä»¥å‡å°‘æµªè´¹çš„å‘¨æœŸ[9, 28]ã€‚AIFM é‡‡ç”¨äº†ä¸åŒçš„æ–¹æ³•ï¼šå®ƒä¾èµ–äºä½å¼€é”€çš„ç»¿è‰²çº¿ç¨‹ï¼Œåœ¨ç­‰å¾…è¿œç¨‹æ•°æ®è·å–æ—¶æ‰§è¡Œåº”ç”¨ç¨‹åºå·¥ä½œã€‚ å…¶å®æ˜¯å¾ˆç®€å•çš„æ€è·¯ï¼Œç”¨åç¨‹ï¼Œå¼‚æ­¥ IO ä½†æ˜¯ç¼ºç‚¹å‘¢ï¼Œè¿™äº›åç¨‹æ€ä¹ˆè°ƒåº¦å‘¢ ","date":"2024-11-06","objectID":"/posts/paper-aifm/:7:1","tags":["Paper Reading"],"title":"Paper Reading: AIFM: High-Performance, Application-Integrated Far Memory (OSDI 20)","uri":"/posts/paper-aifm/"},{"categories":null,"content":"Remoteable Memory Layout å¯¹äº AIFM ç®¡ç†çš„æœ¬åœ°å†…å­˜ï¼Œå…¶è¿è¡Œæ—¶é‡‡ç”¨äº†æ—¥å¿—ç»“æ„å†…å­˜[63]çš„æ€æƒ³ï¼Œå°†æœ¬åœ°å¯è¿œç¨‹è®¿é—®å†…å­˜æŒ‰æ—¥å¿—ç²’åº¦åˆ†å‰²å’Œç®¡ç† ","date":"2024-11-06","objectID":"/posts/paper-aifm/:7:2","tags":["Paper Reading"],"title":"Paper Reading: AIFM: High-Performance, Application-Integrated Far Memory (OSDI 20)","uri":"/posts/paper-aifm/"},{"categories":null,"content":"Pauseless Memory Evacuator è¿è¡Œæ—¶çš„å†…å­˜ç–æ•£å™¨å°†å†·å¯¹è±¡ç§»åŠ¨åˆ°è¿œç¨‹æœåŠ¡å™¨ Log Selection Phase. Concurrent Marking Phase Evacuator Waiting Phase. å¥½å¥‡è¿™ç§é˜¶æ®µè¦ä¸è¦é”ï¼Œè¿˜æ˜¯è¯´ä½¿ç”¨è¯»å†™å±éšœ + RCU + CAS å°±å¤Ÿäº† mutator: å¦‚æœå˜å¼‚å™¨çº¿ç¨‹éšåè§£å¼•ç”¨æŒ‡å‘è¿è¡Œæ—¶æ­£åœ¨ç–æ•£çš„å¯¹è±¡çš„æŒ‡é’ˆï¼Œå˜å¼‚å™¨ä¼šçœ‹åˆ°ç–æ•£ä½å·²è®¾ç½®ã€‚ä¸€ä¸ªç®€å•çš„æ–¹æ³•æ˜¯æ­¤æ—¶é˜»å¡å˜å¼‚å™¨çº¿ç¨‹ â€œå˜å¼‚å™¨â€ï¼ˆmutatorï¼‰æ˜¯æŒ‡åº”ç”¨ç¨‹åºçº¿ç¨‹? Consistent with literature on garbage collection (GC), we refer to normal application threads as mutator threads i Concurrent Evacuation Phase. ","date":"2024-11-06","objectID":"/posts/paper-aifm/:7:3","tags":["Paper Reading"],"title":"Paper Reading: AIFM: High-Performance, Application-Integrated Far Memory (OSDI 20)","uri":"/posts/paper-aifm/"},{"categories":null,"content":"Co-design with the Thread Scheduler å½“è¿è¡Œæ—¶é¢ä¸´å†…å­˜å‹åŠ›æ—¶ï¼Œç–æ•£æ˜¯ä¸€é¡¹ç´§æ€¥ä»»åŠ¡ã€‚ä½¿ç”¨ç®€å•çš„çº¿ç¨‹è°ƒåº¦å™¨ï¼Œç–æ•£å¯èƒ½ä¼šè¢«å˜å¼‚å™¨çº¿ç¨‹é¥¿æ­»ï¼Œå¯¼è‡´å†…å­˜ä¸è¶³é”™è¯¯å’Œåº”ç”¨ç¨‹åºå´©æºƒã€‚ æˆ‘ä»¬éœ€è¦è§£å†³ä¸¤ä¸ªæŒ‘æˆ˜ã€‚é¦–å…ˆï¼Œå¤§é‡å˜å¼‚å™¨çº¿ç¨‹å¯èƒ½æ¯”ç–æ•£æ›´å¿«åœ°åˆ†é…å†…å­˜ã€‚å…¶æ¬¡ï¼Œç–æ•£æœ‰æ—¶ä¼šåœ¨å˜å¼‚å™¨çº¿ç¨‹çš„è§£å¼•ç”¨èŒƒå›´å†…é˜»å¡ï¼Œè¿™é€ æˆäº†ä¸€ä¸ªå›°å¢ƒã€‚ä¸€æ–¹é¢ï¼Œè°ƒåº¦å™¨éœ€è¦æ‰§è¡Œå˜å¼‚å™¨çº¿ç¨‹ï¼Œä»¥ä¾¿å®ƒä»¬å¯ä»¥è§£é™¤ç–æ•£çš„é˜»å¡ã€‚å¦ä¸€æ–¹é¢ï¼Œæ‰§è¡Œå˜å¼‚å™¨çº¿ç¨‹å¯èƒ½ä¼šæ¶ˆè€—æ›´å¤šå†…å­˜ã€‚ ","date":"2024-11-06","objectID":"/posts/paper-aifm/:7:4","tags":["Paper Reading"],"title":"Paper Reading: AIFM: High-Performance, Application-Integrated Far Memory (OSDI 20)","uri":"/posts/paper-aifm/"},{"categories":null,"content":"Remoteable Data Structure Examples ç•¥ ","date":"2024-11-06","objectID":"/posts/paper-aifm/:8:0","tags":["Paper Reading"],"title":"Paper Reading: AIFM: High-Performance, Application-Integrated Far Memory (OSDI 20)","uri":"/posts/paper-aifm/"},{"categories":null,"content":"Implementation AIFM çš„å®ç°åŒ…æ‹¬æ ¸å¿ƒè¿è¡Œæ—¶åº“ï¼ˆÂ§5ï¼‰å’Œæ•°æ®ç»“æ„åº“ï¼ˆÂ§6ï¼‰ã€‚æ ¸å¿ƒè¿è¡Œæ—¶å»ºç«‹åœ¨ Shenango[55]ä¹‹ä¸Šï¼Œä»¥åˆ©ç”¨å…¶å¿«é€Ÿçš„ç”¨æˆ·çº§çº¿ç¨‹è¿è¡Œæ—¶å’Œ I/O æ ˆã€‚ æ€ªä¸å¾—è¯´è¿™ä¹ˆå¤šçº¿ç¨‹ï¼Œç”¨äº† Shenango æˆ‘ä»¬å°†ä¸¤ä¸ªè¿œç«¯å†…å­˜åç«¯é›†æˆåˆ° AIFM ä¸­ï¼šä¸€ä¸ªåŸºäº DPDK çš„ TCP æ ˆçš„è¿œç¨‹å†…å­˜æœåŠ¡å™¨ï¼Œä»¥åŠä¸€ä¸ªä½¿ç”¨ SPDK å­˜å‚¨æ ˆçš„ NVMe SSDã€‚ä¸è¿œç¨‹å†…å­˜åç«¯ä¸åŒï¼ŒSSD åç«¯ä¸æ”¯æŒæ´»åŠ¨çš„è¿œç¨‹ç»„ä»¶ï¼ˆå› ä¸ºå­˜å‚¨é©±åŠ¨å™¨æ²¡æœ‰é€šç”¨è®¡ç®—å•å…ƒï¼‰ï¼Œå¹¶ä¸”ç”±äºå…¶å›ºå®šå—å¤§å°çš„é™åˆ¶ï¼Œå­˜åœ¨å›ºæœ‰çš„ I/O æ”¾å¤§ã€‚æˆ‘ä»¬çš„è¯„ä¼°ä¸»è¦é›†ä¸­åœ¨è¿œç¨‹å†…å­˜åç«¯ã€‚ å½“å‰å®ç°æœ‰ä¸€äº›é™åˆ¶ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬ä¸æ”¯æŒ TCP å¸è½½æˆ– RDMAï¼Œè¿™ä¼šå‡å°‘æˆ‘ä»¬è¿è¡Œæ—¶çš„ CPU å¼€é”€ã€‚ ","date":"2024-11-06","objectID":"/posts/paper-aifm/:9:0","tags":["Paper Reading"],"title":"Paper Reading: AIFM: High-Performance, Application-Integrated Far Memory (OSDI 20)","uri":"/posts/paper-aifm/"},{"categories":null,"content":"Evaluation ","date":"2024-11-06","objectID":"/posts/paper-aifm/:10:0","tags":["Paper Reading"],"title":"Paper Reading: AIFM: High-Performance, Application-Integrated Far Memory (OSDI 20)","uri":"/posts/paper-aifm/"},{"categories":null,"content":"End-to-end Performance Web æœåŠ¡ å…¶æ¬¡ï¼Œæˆ‘ä»¬è¿˜ç§»æ¤äº†ä¸€ä¸ªå¼€æºçš„ C++ DataFrame åº“[16]ï¼Œå…¶æ¥å£ç±»ä¼¼äº Pandas[56]ï¼Œä»¥äº†è§£æ‰€éœ€çš„ç§»æ¤å·¥ä½œé‡å’Œ AIFM å¯¹ç°æœ‰åº”ç”¨ç¨‹åºçš„æ€§èƒ½ã€‚ æˆ‘ä»¬å°†ä¸¤ç§ AIFM è®¾ç½®ï¼ˆå¸¦æœ‰å’Œä¸å¸¦æœ‰æ•°ç»„å…ƒç´ çš„éä¸´æ—¶è§£å¼•ç”¨ï¼‰ä¸ Fastswap[6]å’Œç†æƒ³åŒ–çš„åŸºçº¿ï¼ˆæ‰€æœ‰ 26GB éƒ½åœ¨æœ¬åœ°å†…å­˜ä¸­ï¼‰è¿›è¡Œæ¯”è¾ƒã€‚AIFM çš„è‰¯å¥½ç»“æœå°†æ˜¾ç¤ºå…¶æ€§èƒ½ä¼˜äº Fastswapï¼Œéä¸´æ—¶æ•°ç»„è®¿é—®çš„å¥½å¤„ï¼Œå¹¶ä¸”æ€§èƒ½ä¸æ¯”å°†æ‰€æœ‰æ•°æ®ä¿å­˜åœ¨æœ¬åœ°å†…å­˜ä¸­ä½å¾ˆå¤šã€‚ åœ¨å›¾å·¦ä¾§ï¼ˆ5%æœ¬åœ°å†…å­˜ï¼‰ï¼ŒAIFM åœ¨å“ˆå¸Œè¡¨ï¼ˆ52%ï¼‰å’Œæ•°ç»„ï¼ˆ89%ï¼‰ä¸­çœ‹åˆ°é«˜ç¼ºå¤±ç‡ï¼Œå› ä¸º AIFM çš„éä¸´æ—¶æ•°ç»„è§£å¼•ç”¨ç¡®ä¿å¤§éƒ¨åˆ†æœ¬åœ°å†…å­˜ä¸“ç”¨äºå“ˆå¸Œè¡¨æ¡ç›®ã€‚ç›¸åº”åœ°ï¼Œæ•°ç»„ç¼ºå¤±ç‡ä¸‹é™å¾—æ›´æ…¢ï¼Œå¹¶ä¸å¯ç”¨æœ¬åœ°å†…å­˜æˆæ¯”ä¾‹ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒFastswapï¼ˆæ­¤å¤„æœªæ˜¾ç¤ºï¼‰åœ¨ä¸¤ä¸ªæ•°æ®ç»“æ„ä¸­éƒ½æœ‰é«˜ç¼ºå¤±ç‡ï¼Œå› ä¸ºå…¶åŸºäºé¡µé¢çš„æ–¹æ³•ç®¡ç†æœ¬åœ°å†…å­˜æ•ˆç‡ä½ä¸‹ã€‚ ä¸ºä»€ä¹ˆè¿™é‡Œ web åº”ç”¨éƒ½æ˜¯ 8K å¯¹è±¡å‘¢ï¼Ÿ ","date":"2024-11-06","objectID":"/posts/paper-aifm/:10:1","tags":["Paper Reading"],"title":"Paper Reading: AIFM: High-Performance, Application-Integrated Far Memory (OSDI 20)","uri":"/posts/paper-aifm/"},{"categories":null,"content":"DataFrame Application æˆ‘ä»¬å°†ä¸€ä¸ªæµè¡Œçš„å¼€æº C++ DataFrame åº“[16]ç§»æ¤åˆ° AIFM çš„ API ä¸­ã€‚è¯¥åº“ä¸­ä½¿ç”¨çš„ä¸»è¦æ•°æ®ç»“æ„æ˜¯ä¸€ä¸ªå­˜å‚¨ DataFrame åˆ—å’Œç´¢å¼•çš„ std::vectorï¼Œæˆ‘ä»¬å°†å…¶æ›¿æ¢ä¸ºå¯ç”¨äº† AIFM çš„ç­‰æ•ˆæ•°æ®ç»“æ„ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å¢åŠ äº†å¯¹å¸è½½å…³é”®æ“ä½œçš„æ”¯æŒï¼Œè¿™äº›æ“ä½œè®¡ç®—å¼ºåº¦ä½ä½†å†…å­˜è®¿é—®é¢‘ç‡é«˜ã€‚æˆ‘ä»¬é€šè¿‡ä½¿ç”¨ AIFM çš„è¿œç¨‹è®¾å¤‡ APIï¼ˆÂ§4.2.4ï¼‰å¸è½½ä¸‰ä¸ªæ“ä½œæ¥å®ç°è¿™ä¸€ç‚¹ã€‚Copy å’Œ Shuffle æ“ä½œå¤åˆ¶ä¸€ä¸ªå‘é‡ï¼ˆå³ DataFrame åˆ—ï¼‰ï¼ŒShuffle è¿˜é€šè¿‡å¦ä¸€ä¸ªåˆ—ä¸­çš„ç´¢å¼•ä½ç½®é‡æ–°æ’åºè¡Œï¼›Aggregate è®¡ç®—èšåˆå€¼ï¼ˆæ€»å’Œã€å¹³å‡å€¼ç­‰ï¼‰ã€‚è¿™ä¸‰ç§æ“ä½œç”¨äºäº”ä¸ª DataFrame API è°ƒç”¨ï¼ŒåŒ…æ‹¬è¿‡æ»¤å™¨ã€åˆ—åˆ›å»ºã€æ’åºå’Œèšåˆï¼ˆè¡¨ 1ï¼‰ã€‚ä¸ºäº†å®ç°è¶³ä»¥è¿è¡Œçº½çº¦å¸‚å‡ºç§Ÿè½¦è¡Œç¨‹åˆ†æå·¥ä½œè´Ÿè½½[53]çš„è¦†ç›–èŒƒå›´ï¼Œæˆ‘ä»¬åœ¨ DataFrame åº“ï¼ˆ24.3k è¡Œä»£ç ï¼‰ä¸­ä¿®æ”¹äº† 1,192 è¡Œä»£ç ï¼Œå¹¶ç¼–å†™äº† 233 è¡Œè¿œç¨‹è®¾å¤‡ä»£ç ã€‚è¿™äº›ä¿®æ”¹ç”±ä¸€ä½ä½œè€…èŠ±è´¹äº†å¤§çº¦äº”å¤©æ—¶é—´ã€‚ è¿™ä¿®æ”¹æŒºç´¯çš„ å›¾ 7 æ˜¾ç¤ºäº†ç»“æœã€‚å³ä½¿åªæœ‰ 1GB çš„æœ¬åœ°å†…å­˜ï¼ˆ3.2%ï¼‰ï¼ŒAIFM ä¹Ÿèƒ½è¾¾åˆ°å†…å­˜ååé‡çš„ 78%ï¼Œå¹¶ä¸”ä»å¤§çº¦ 20%ï¼ˆ6GBï¼‰çš„æœ¬åœ°å†…å­˜å¼€å§‹è¶…è¿‡ç†æƒ³æ€§èƒ½çš„ 95%ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒFastswap åœ¨ 1GB æ—¶ä»…è¾¾åˆ°å†…å­˜æ€§èƒ½çš„ 20%ï¼Œå¹¶ä¸”åªæœ‰åœ¨è¶…è¿‡ 90%çš„å·¥ä½œé›†åœ¨æœ¬åœ°å†…å­˜ä¸­æ—¶æ‰æ¥è¿‘å®ƒã€‚AIFM çš„é«˜æ€§èƒ½æ¥è‡ªäºé¿å… Fastswap çš„é¡µé¢é”™è¯¯å¼€é”€ï¼Œå¹¶é€šè¿‡å¸è½½è®¡ç®—å¼ºåº¦ä½çš„æ“ä½œæ¥å‡å°‘æ˜‚è´µçš„ç½‘ç»œæ•°æ®ç§»åŠ¨ã€‚åœ¨æ²¡æœ‰å¸è½½çš„æƒ…å†µä¸‹ï¼ŒAIFM ä¼˜äº Fastswapï¼Œç›´åˆ° 60%çš„å·¥ä½œé›†åœ¨æœ¬åœ°ï¼Œå› ä¸º Fastswap ä¼šé¢‘ç¹å‘ç”Ÿæ¬¡è¦é”™è¯¯ã€‚è¶…è¿‡ 60%åï¼ŒFastswap çš„é”™è¯¯ç‡ä¸‹é™åˆ°è¶³ä»¥ä½¿å¤§å¤šæ•°å†…å­˜è®¿é—®ä¼˜äº AIFM å¯¹è®¡ç®—å¼ºåº¦ä½çš„æ“ä½œçš„è§£å¼•ç”¨æ—¶é—´å¼€é”€ï¼ˆä¾‹å¦‚ï¼Œå†…å­˜å¤åˆ¶ï¼‰ã€‚å°†è¿™äº›æ“ä½œå¸è½½åˆ°è¿œç¨‹ä¾§æœ‰åŠ©äº AIFM é¿å…è¿™ç§æˆæœ¬ï¼Œè€Œé«˜è®¡ç®—å¼ºåº¦çš„æ“ä½œæ‘Šé”€äº†è§£å¼•ç”¨æˆæœ¬å¹¶åœ¨æœ¬åœ°å‘ç”Ÿã€‚æˆ‘ä»¬è¿˜ä¸º AIFM åŸå‹åŒ–äº†ä¸€ä¸ªæ‰¹å¤„ç† APIï¼Œå½“æ— æ³•å¸è½½æ—¶ï¼Œè¯¥ API åœ¨å‘é‡å…ƒç´ ç»„ä¹‹é—´æ‘Šé”€äº†è§£å¼•ç”¨å¼€é”€ï¼Œå¹¶å‘ç°å®ƒå°†æ²¡æœ‰å¸è½½çš„ AIFM ååé‡æé«˜åˆ°å†…å­˜ååé‡çš„ 60-80%ã€‚æˆ‘ä»¬ç›¸ä¿¡è¿™å¯èƒ½æ˜¯ AIFM API çš„ä¸€ä¸ªå¾ˆå¥½çš„æœªæ¥è¡¥å……ï¼Œä»¥åŠ é€Ÿå¿…é¡»åœ¨æœ¬åœ°æ‰§è¡Œçš„è®¡ç®—å¼ºåº¦ä½çš„æ“ä½œã€‚ å›¾ 8 åˆ†è§£äº†å¸è½½çš„å½±å“ã€‚å¸è½½ Copy è´¡çŒ®äº†æœ€å¤§çš„ååé‡å¢ç›Šï¼ˆ18%-38%ï¼‰ï¼›å¸è½½ Shuffle è´¡çŒ®äº† 2.9%-13%ï¼›å¸è½½ Aggregate è´¡çŒ®äº† 4.5%-12%ã€‚è¿™äº›ç»“æœè¡¨æ˜ï¼ŒAIFM åœ¨æœ¬åœ°å†…å­˜è¾ƒå°çš„æƒ…å†µä¸‹ä¸ºå®é™…å·¥ä½œè´Ÿè½½å®ç°äº†é«˜æ€§èƒ½ï¼Œå¹¶ä¸”å½“å·¥ä½œè´Ÿè½½åŒ…æ‹¬è®¡ç®—å¼ºåº¦ä½çš„æ“ä½œæ—¶ï¼ŒAIFM çš„æ“ä½œå¸è½½å¯¹äºè‰¯å¥½çš„æ€§èƒ½è‡³å…³é‡è¦ã€‚ AIFM çš„é«˜æ€§èƒ½æ¥è‡ªäºé¿å… Fastswap çš„é¡µé¢é”™è¯¯å¼€é”€ï¼Œå¹¶é€šè¿‡å¸è½½è®¡ç®—å¼ºåº¦ä½çš„æ“ä½œæ¥å‡å°‘æ˜‚è´µçš„ç½‘ç»œæ•°æ®ç§»åŠ¨ã€‚ æ€ä¹ˆç†è§£ï¼Ÿ å¸è½½ copy, shuffle, agg åˆ°è¿œç«¯å†…å­˜æ„Ÿè§‰ä¸é”™ ä½†æ²¡æœ‰å¯ç”¨ RDMA è¿˜æ˜¯å¾ˆå¯æƒœçš„ ","date":"2024-11-06","objectID":"/posts/paper-aifm/:10:2","tags":["Paper Reading"],"title":"Paper Reading: AIFM: High-Performance, Application-Integrated Far Memory (OSDI 20)","uri":"/posts/paper-aifm/"},{"categories":null,"content":"Can Far Memory Improve Job Throughput? memory disaggregation å†…å­˜è§£è€¦çš„è®ºæ–‡ï¼Œç¨å¾®çœ‹çœ‹ ","date":"2024-11-05","objectID":"/posts/paper-fastswap/:1:0","tags":["Paper Reading"],"title":"Paper Reading: Can Far Memory Improve Job Throughput? (Fastswap)","uri":"/posts/paper-fastswap/"},{"categories":null,"content":"Abstract éšç€å†…å­˜éœ€æ±‚çš„å¢åŠ å’Œå†…å­˜æŠ€æœ¯è¿›æ­¥çš„æ”¾ç¼“ï¼Œå¤§å‹è®¡ç®—é›†ç¾¤ä¸­ä¸»å†…å­˜çš„å¯ç”¨æ€§è¶Šæ¥è¶Šæˆä¸ºç“¶é¢ˆã€‚ ç§è§£å†³æ–¹æ¡ˆæ˜¯å†…å­˜è§£è€¦ï¼Œå³ä½œä¸šå¯ä»¥è¿œç¨‹è®¿é—®å…¶ä»–æœåŠ¡å™¨ä¸Šçš„å†…å­˜ï¼Œæˆ–ç§°ä¸ºè¿œç«¯å†…å­˜ æœ¬æ–‡é¦–å…ˆä»‹ç»äº†æ›´å¿«çš„äº¤æ¢æœºåˆ¶å’Œä¸€ä¸ªæ”¯æŒè¿œç«¯å†…å­˜çš„é›†ç¾¤è°ƒåº¦å™¨ï¼Œä½¿å…¶èƒ½å¤Ÿåœ¨æœºæ¶ rack è§„æ¨¡ä¸Šæ”¯æŒè¿œç«¯å†…å­˜ã€‚ memory-intensive workloads æœºæ¶è§„æ¨¡æ˜¯ä»€ä¹ˆï¼Œä¸€ä¸ªæ¶å­ä¸Šçš„ä¸€å †æœºå™¨ï¼Ÿ ","date":"2024-11-05","objectID":"/posts/paper-fastswap/:2:0","tags":["Paper Reading"],"title":"Paper Reading: Can Far Memory Improve Job Throughput? (Fastswap)","uri":"/posts/paper-fastswap/"},{"categories":null,"content":"Introduction å†…å­˜å¯†é›†å‹å·¥ä½œè´Ÿè½½ï¼ˆå¦‚æœºå™¨å­¦ä¹ åº”ç”¨å’Œé”®å€¼å­˜å‚¨ï¼‰çš„æ—¥ç›Šæµè¡Œï¼Œ è™½ç„¶è¿œç«¯å†…å­˜å¹¶ä¸å‡å°‘è¿è¡Œå•ä¸ªä½œä¸šæ‰€éœ€çš„å†…å­˜æ€»é‡ï¼Œä¹Ÿä¸ä½¿å†…å­˜æ›´ä¾¿å®œæˆ–æ›´å¯†é›†ï¼Œä½†å®ƒç¡®å®æ„å‘³ç€ä½œä¸šä¸å¿…å±€é™äºæœ¬åœ°å†…å­˜ï¼Œè€Œæ˜¯å¯ä»¥åˆ©ç”¨é›†ç¾¤ä¸­å…¶ä»–ä½ç½®çš„å†…å­˜ã€‚è¿™ç»•è¿‡äº†â€œå†…å­˜å®¹é‡å¢™â€[48]ï¼Œå¹¶å¢åŠ äº†å†…å­˜è·¨ä½œä¸šå…±äº«çš„æ•ˆç‡ã€‚ google åˆ©ç”¨ zswap æ¥å®ç°è¿œç«¯å†…å­˜ï¼Œå’Œè¿™é‡Œæåˆ°çš„æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿä»–ä»¬çš„ bigtable è¡¨ç°å¥½åƒä¹Ÿä¸€èˆ¬ï¼Œæ²¡æœ‰é™ä½å¤ªå¤šçš„æˆæœ¬ æ²¡æœ‰ç»™å…¶ä»–çš„æ€§èƒ½å‚æ•°ï¼Œæœ¬ç¯‡å€’æ˜¯å¾ˆåœ¨æ„ååé‡ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯åŠ¨æ€è´Ÿè½½æˆ–è€…çªå‘è´Ÿè½½ ä½¿è¿œç«¯å†…å­˜å®ç”¨åŒ–é¢ä¸´ä¸¤å¤§éšœç¢ã€‚ ç¬¬ä¸€ä¸ªéšœç¢åœ¨äºå¦‚ä½•è®¾è®¡è®¿é—®è¿œç«¯å†…å­˜æ‰€éœ€çš„äº¤æ¢æœºåˆ¶ï¼Œå› ä¸ºç°æœ‰ç³»ç»Ÿé€šè¿‡ RDMA è¿›è¡Œäº¤æ¢æ—¶ï¼Œç”±äº head-of-line blocking, and to handling interrupts and page reclamation on the critical path of page fault resolution, å¯¼è‡´å»¶è¿Ÿå’Œååé‡ä¸ä½³ã€‚æˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ªåä¸º Fastswap çš„ Linux äº¤æ¢ç³»ç»Ÿï¼Œè¯¥ç³»ç»Ÿé€šè¿‡ RDMA ä¼˜åŒ–ä½¿ç”¨è¿œç«¯å†…å­˜ã€‚ å¤´é˜»å¡ï¼ŒHOL blocking é˜Ÿåˆ—å¤´éƒ¨å¤„ç†ç¼“æ…¢ï¼ŒRDMA ä½¿ç”¨é˜Ÿåˆ—ç®¡ç†ï¼Œå®¹æ˜“å‘ç”Ÿå¤´é˜»å¡ ä¸å…¶ä»–äº¤æ¢ç³»ç»Ÿä¸€æ ·ï¼Œå®ƒå¯¹åº”ç”¨ç¨‹åºå’Œå¼€å‘è€…éƒ½æ˜¯é€æ˜çš„ã€‚æ­¤å¤–ï¼Œå®ƒç›´æ¥ä¸ Linux æ§åˆ¶ç»„[5]äº¤äº’ï¼Œå…è®¸ Fastswap å¼ºåˆ¶æ‰§è¡Œæœ¬åœ°å†…å­˜åˆ†é…ã€‚Fastswap é€šè¿‡å°†å…³é”®è·¯å¾„ä¸Šçš„é¡µé¢è·å–å¼•å¯¼åˆ°å•ç‹¬çš„é˜Ÿåˆ—æ¥é˜²æ­¢å¤´é˜»å¡ã€‚æ­¤å¤–ï¼Œå®ƒé€šè¿‡è½®è¯¢å…³é”®é¡µé¢æ“ä½œçš„å®Œæˆæƒ…å†µï¼Œå¹¶å°†å†…å­˜å›æ”¶å¸è½½åˆ°ä¸“ç”¨ CPUï¼Œä»è€Œå‡å°‘å…³é”®è·¯å¾„ä¸Šçš„å»¶è¿Ÿã€‚å› æ­¤ï¼ŒFastswap å®ç°äº†\u003c5 å¾®ç§’çš„è¿œç¨‹é¡µé¢è®¿é—®å»¶è¿Ÿï¼Œä½¿åº”ç”¨ç¨‹åºèƒ½å¤Ÿä»¥ 10 Gbps çš„é€Ÿåº¦ï¼ˆå•çº¿ç¨‹ï¼‰å’Œ 25 Gbps çš„é€Ÿåº¦ï¼ˆå¤šçº¿ç¨‹ï¼‰è®¿é—®è¿œç«¯å†…å­˜ã€‚Infiniswap[34]æ˜¯æœ€æ¥è¿‘çš„ç›¸å…³å·¥ä½œï¼ŒFastswap çš„å¸¦å®½åœ¨å•çº¿ç¨‹æ—¶æ¯” Infiniswap é«˜ 1.51 å€ï¼Œåœ¨å¤šçº¿ç¨‹æ—¶é«˜ 2.54 å€ï¼ˆç¦ç”¨å¤‡ä»½ç£ç›˜æ—¶ï¼‰ critical path æ˜¯å†³å®šæ•´ä¸ªä»»åŠ¡å®Œæˆæ—¶é—´çš„æœ€é•¿è·¯å¾„ï¼Ÿæ¯”å¦‚ page fault, interrupts, reclaim? ç¬¬äºŒä¸ªéšœç¢åœ¨äºå¦‚ä½•å†³å®šå°†æ¯ä¸ªä½œä¸šçš„å†…å­˜éœ€æ±‚åœ¨æœ¬åœ°å†…å­˜å’Œè¿œç«¯å†…å­˜ä¹‹é—´è¿›è¡Œåˆ†é…ã€‚ ä½¿ç”¨è¿œç«¯å†…å­˜åœ¨æŸç§ç¨‹åº¦ä¸Šæ˜¯ä¸€ä¸ªè£…ç®±é—®é¢˜ï¼šå¦‚ä½•åœ¨æ¯ä¸ªæœåŠ¡å™¨ä¸Šç»™å®šæ•°é‡çš„æœ¬åœ°å†…å­˜å’Œå¤§é‡è¿œç«¯å†…å­˜çš„æƒ…å†µä¸‹ï¼Œä»¥æœ€å¿«çš„é€Ÿåº¦å¤„ç†å·¥ä½œè´Ÿè½½ï¼Œå¹¶ä¸”æ¯ä¸ªä½œä¸šå¿…é¡»åˆ†é…æ»¡è¶³å…¶éœ€æ±‚æ€»é‡çš„å†…å­˜ï¼ˆæœ¬åœ°å’Œè¿œç¨‹ï¼‰ï¼Ÿ ä¸ºä»€ä¹ˆä¸æ˜¯è‚¯å®šä¼˜å…ˆæœ¬åœ°å‘¢ï¼Ÿ ä¸ºæ­¤ï¼Œæˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ªè¿œç«¯å†…å­˜æ„ŸçŸ¥çš„é›†ç¾¤è°ƒåº¦å™¨ï¼Œåˆ©ç”¨è¿œç«¯å†…å­˜æ¥æé«˜ä½œä¸šååé‡ã€‚å½“ä¸€ä¸ªæ–°ä½œä¸šåˆ°è¾¾æ—¶ï¼Œè°ƒåº¦å™¨å¯ä»¥å°†ä½œä¸šæ”¾ç½®åœ¨ä¸€ä¸ªåˆå§‹å¯ç”¨æœ¬åœ°å†…å­˜ä¸è¶³ä»¥å¤„ç†æ‰€æœ‰åˆ†é…ç»™å®ƒçš„ä½œä¸šçš„æœåŠ¡å™¨ä¸Šã€‚ç„¶åï¼Œæˆ‘ä»¬çš„è°ƒåº¦å™¨å‡å°‘è¯¥æœåŠ¡å™¨ä¸Šä¸€äº›ç°æœ‰ä½œä¸šä½¿ç”¨çš„æœ¬åœ°å†…å­˜ï¼Œå¹¶ä½¿ç”¨è¿œç«¯å†…å­˜ç¡®ä¿æ‰€æœ‰ä½œä¸šéƒ½èƒ½è®¿é—®è¶³å¤Ÿçš„æ€»å†…å­˜ã€‚è¿™ç§ç­–ç•¥æ˜¯å¦æœ‰ç›Šå°šä¸æ˜ç¡®ï¼Œå› ä¸ºä½¿ç”¨è¿œç«¯å†…å­˜ä¸å¯é¿å…åœ°ä¼šå‡æ…¢å•ä¸ªä½œä¸šçš„é€Ÿåº¦ï¼ˆå› ä¸ºè®¿é—®è¿œç«¯å†…å­˜æ¯”è®¿é—®æœ¬åœ°å†…å­˜æ…¢å¾—å¤šï¼‰ã€‚ç„¶è€Œï¼Œä½¿ç”¨è¿œç«¯å†…å­˜ä¹Ÿå¯ä»¥ä½¿æ›´å¤šä½œä¸šåœ¨å•ä¸ªæœåŠ¡å™¨ä¸ŠåŒæ—¶è¿è¡Œï¼Œå°½ç®¡é€Ÿåº¦è¾ƒæ…¢ï¼Œè¿™å¯èƒ½ä¼šæé«˜æ•´ä½“ååé‡ã€‚æˆ‘ä»¬å¹¿æ³›ç ”ç©¶äº†è¿™ç§æƒè¡¡ï¼Œå¹¶æŠ¥å‘Šäº†åœ¨ä½•ç§æƒ…å†µä¸‹ä½¿ç”¨è¿œç«¯å†…å­˜å¯ä»¥æé«˜æ•´ä½“ååé‡ï¼Œä»¥åŠè¿™ä¸ä»…å¢åŠ æœ¬åœ°å†…å­˜é‡çš„æ¯”è¾ƒã€‚æ®æˆ‘ä»¬æ‰€çŸ¥ï¼Œè¿™æ˜¯å¯¹è¿™äº›é—®é¢˜çš„é¦–æ¬¡ç³»ç»Ÿæ€§æ¢ç´¢ã€‚ ä¸€ç§ trade off è¿˜æ˜¯æ— æ„ä¹‰ï¼Ÿ æ”¹è¿›çš„äº¤æ¢ç³»ç»Ÿ Fastswap å’Œé›†ç¾¤è°ƒåº¦å™¨çš„ç»“åˆæä¾›äº†å¯¹ cluster-wide far memory çš„æ”¯æŒï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º CFMï¼Œä½†æˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªé›†ç¾¤æ¨¡æ‹Ÿå™¨ We find that far memory is not a panacea ç³»ç»Ÿè®¾è®¡æ²¡æœ‰é“¶å¼¹ å¦‚æœå†…å­˜éœ€æ±‚è¿œå¤§äºå¯ç”¨å†…å­˜ï¼Œé‚£ä¹ˆé€šè¿‡å¢åŠ æ¯ä¸ªæœåŠ¡å™¨çš„æœ¬åœ°å†…å­˜è€Œä¸æ˜¯å°†ç­‰é‡çš„å†…å­˜æ·»åŠ åˆ°å…±äº«çš„è¿œç«¯å†…å­˜æœåŠ¡å™¨ä¸Šï¼Œå¯ä»¥è·å¾—æ›´å¥½çš„æ€§èƒ½ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬å‘ç°è¿œç«¯å†…å­˜åœ¨å•ä¸ªæœºæ¶çš„ä¸¤ä¸ªå…³é”®åœºæ™¯ä¸­æä¾›äº†æ˜¾è‘—çš„å¥½å¤„ï¼šï¼ˆ1ï¼‰å¦‚æœå·¥ä½œè´Ÿè½½æ˜¯å†…å­˜å¯†é›†å‹çš„ï¼ˆå³å†…å­˜å¯ç”¨æ€§è€Œä¸æ˜¯æ ¸å¿ƒå¯ç”¨æ€§æ˜¯ç“¶é¢ˆï¼‰ï¼Œå°†è®¡ç®—èŠ‚ç‚¹è½¬æ¢ä¸ºè¿œç«¯å†…å­˜æœåŠ¡å™¨å¯ä»¥å¯¼è‡´ï¼ˆåœ¨æˆ‘ä»¬ç ”ç©¶çš„æƒ…å†µä¸‹ï¼‰ä¸åŸå§‹æœºæ¶ç›¸æ¯”å¤§çº¦ 10% çš„ååé‡æå‡ï¼Œå°½ç®¡ä¸¤ç§æœºæ¶é…ç½®çš„å†…å­˜æ€»é‡ç›¸åŒã€‚ï¼ˆ2ï¼‰å¦‚æœæ“ä½œå‘˜å¸Œæœ›é€‚åº¦å¢åŠ æœºæ¶çš„å†…å­˜å®¹é‡ï¼Œå‘å†…å­˜æœåŠ¡å™¨æ·»åŠ å†…å­˜å…è®¸æ›´ç»†ç²’åº¦çš„å¢åŠ ï¼Œè¿™ä»ç„¶ä¼šå¯¼è‡´æ˜¾è‘—çš„æ€§èƒ½æå‡ï¼Œè€Œå‡çº§æ¯ä¸ªæœåŠ¡å™¨çš„æœ¬åœ°å†…å­˜åªèƒ½ä»¥æ›´å¤§çš„ï¼ˆå› æ­¤æ›´æ˜‚è´µçš„ï¼‰å¢é‡è¿›è¡Œï¼ˆæ­£å¦‚æˆ‘ä»¬åœ¨ä¸‹ä¸€èŠ‚ä¸­è®¨è®ºçš„é‚£æ ·ï¼‰ã€‚ ","date":"2024-11-05","objectID":"/posts/paper-fastswap/:3:0","tags":["Paper Reading"],"title":"Paper Reading: Can Far Memory Improve Job Throughput? (Fastswap)","uri":"/posts/paper-fastswap/"},{"categories":null,"content":"Context ","date":"2024-11-05","objectID":"/posts/paper-fastswap/:4:0","tags":["Paper Reading"],"title":"Paper Reading: Can Far Memory Improve Job Throughput? (Fastswap)","uri":"/posts/paper-fastswap/"},{"categories":null,"content":"Memory Provisioning é‡è¦çš„æ˜¯è¦è®°ä½ï¼Œæœ¬åœ°å†…å­˜åªèƒ½ä»¥ç²—ç²’åº¦è¿›è¡Œé…ç½®ã€‚ å•¥æ„æ€ï¼Ÿè·Ÿ DIMM æ’æ§½æœ‰å…³ï¼Ÿ ","date":"2024-11-05","objectID":"/posts/paper-fastswap/:4:1","tags":["Paper Reading"],"title":"Paper Reading: Can Far Memory Improve Job Throughput? (Fastswap)","uri":"/posts/paper-fastswap/"},{"categories":null,"content":"Deployment Scenarios æˆ‘ä»¬ä¸»è¦ä¸æ˜¯è€ƒè™‘ green-field deployments ä½†æˆ‘ä»¬çš„ä¸»è¦å…³æ³¨ç‚¹æ˜¯é€æ­¥å‡çº§ç°æœ‰éƒ¨ç½²ã€‚ä»–ä»¬ç°æœ‰çš„æ•°æ®ä¸­å¿ƒå¾€å¾€å·²ç»å¡«æ»¡äº†æ‰€æœ‰ DIMM æ’æ§½ã€‚è¿™åœ¨ç»æµä¸Šæ˜¯åˆç†çš„ï¼Œå› ä¸ºæ¯å•ä½å†…å­˜çš„æˆæœ¬éšç€ DIMM å®¹é‡çš„å¢åŠ è€Œå¢åŠ ï¼Œå› æ­¤é…ç½®ç»™å®šæ•°é‡çš„å†…å­˜çš„æœ€ä¾¿å®œæ–¹å¼æ˜¯ä½¿ç”¨æ‰€æœ‰å¯ç”¨çš„ DIMM æ’æ§½ã€‚ green-field deployments ç»¿åœºéƒ¨ç½²ï¼Œæ˜¯ä»å¤´å¼€å§‹ï¼Œå…¨æ–°çš„éƒ¨ç½² è™½ç„¶è¿œç«¯å†…å­˜æœ‰å¯èƒ½æé«˜é›†ç¾¤ååé‡ï¼Œä½†è¿™ä¼šä»¥å•ä¸ªä½œä¸šè¿è¡Œæ—¶é—´å˜æ…¢ä¸ºä»£ä»·ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è®¤ä¸ºè¿œç«¯å†…å­˜æœ€é€‚åˆé‚£äº›ä¸»è¦æŒ‡æ ‡æ˜¯ä½œä¸šååé‡çš„åº”ç”¨ï¼Œè€Œä¸æ˜¯é¢å‘å®¢æˆ·æˆ–å¯¹å»¶è¿Ÿæ•æ„Ÿçš„åº”ç”¨ï¼›è¿™æ˜¯æœ¬æ–‡çš„é‡ç‚¹ã€‚ ","date":"2024-11-05","objectID":"/posts/paper-fastswap/:4:2","tags":["Paper Reading"],"title":"Paper Reading: Can Far Memory Improve Job Throughput? (Fastswap)","uri":"/posts/paper-fastswap/"},{"categories":null,"content":"CFM Overview CFM çš„ç›®æ ‡æ˜¯é€šè¿‡åˆ©ç”¨ä¸“ç”¨å†…å­˜æœåŠ¡å™¨ä¸Šçš„è¿œç«¯å†…å­˜æ¥æé«˜é›†ç¾¤çš„ç«¯åˆ°ç«¯ä½œä¸šååé‡ã€‚ å°½ç®¡ä¹‹å‰çš„ç ”ç©¶å·²ç»æ¢ç´¢äº†å¯ç”¨è¿œç«¯å†…å­˜çš„æœºåˆ¶ï¼Œå¹¶å±•ç¤ºäº†å•ä¸ªä½œä¸šåœ¨äº¤æ¢æ—¶çš„æ€§èƒ½ä¼˜åŠ¿ï¼ˆä¾‹å¦‚ï¼Œ[34]ï¼‰ï¼Œä½†æ®æˆ‘ä»¬æ‰€çŸ¥ï¼Œæ²¡æœ‰å…ˆå‰çš„ç ”ç©¶åœ¨æœºæ¶è§„æ¨¡ä¸Šå±•ç¤ºäº†è¿œç«¯å†…å­˜çš„æ€§èƒ½æ”¹è¿›ã€‚æˆ‘ä»¬ä¸“æ³¨äºæ”¹è¿›ç«¯åˆ°ç«¯å®Œæˆæ—¶é—´ï¼Œå³å®Œæˆæ‰§è¡Œä½œä¸šåˆ—è¡¨æ‰€éœ€çš„æ—¶é—´ã€‚åœ¨é«˜å±‚æ¬¡ä¸Šï¼ŒCFM çš„æ–¹æ³•ï¼ˆÂ§3.1ï¼‰ä¸å…ˆå‰çš„å·¥ä½œç›¸ä¼¼ï¼Œä½† CFM å…‹æœäº†å‡ ä¸ªå…³é”®æŒ‘æˆ˜ï¼ˆÂ§3.2ï¼‰ï¼Œè¿™äº›æŒ‘æˆ˜ä½¿å¾—ä»Šå¤©éš¾ä»¥ä»è¿œç«¯å†…å­˜ä¸­è·å¾—é›†ç¾¤è§„æ¨¡çš„æ”¶ç›Šã€‚ è¿™é‡Œæåˆ°å•ä¸ªä½œä¸šæ€§èƒ½æé«˜çš„è®ºæ–‡æ˜¯ Juncheng Gu, Youngmoon Lee, Yiwen Zhang, Mosharaf Chowdhury, and Kang G. Shin. 2017. Efficient Memory Disaggregation with INFINISWAP. In Symposium on Networked Systems Design and Implementation (NSDIâ€™17). 649â€“667. ","date":"2024-11-05","objectID":"/posts/paper-fastswap/:5:0","tags":["Paper Reading"],"title":"Paper Reading: Can Far Memory Improve Job Throughput? (Fastswap)","uri":"/posts/paper-fastswap/"},{"categories":null,"content":"Approach åœ¨ CFM ä¸­ï¼Œåº”ç”¨ç¨‹åºé€šè¿‡ RDMA äº¤æ¢æ¥åˆ©ç”¨è¿œç«¯å†…å­˜ã€‚CFM ä½¿ç”¨ Linux æ§åˆ¶ç»„æ¥å¼ºåˆ¶æ‰§è¡Œå†…å­˜åˆ†é…ã€‚ Swapping: åº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡ä¸¤ç§å¹¿æ³›çš„æ–¹å¼åˆ©ç”¨è¿œç«¯å†…å­˜ï¼šé€æ˜åœ°ï¼ˆæ— éœ€åº”ç”¨ç¨‹åºä¿®æ”¹ï¼‰ï¼Œæˆ–é€šè¿‡æ˜¾å¼ä¸”å¯èƒ½æ˜¯è‡ªå®šä¹‰çš„ APIã€‚ ç›¸åï¼Œç±»ä¼¼äº Infiniswap [34]ï¼ŒCFM é€šè¿‡äº¤æ¢å®ç°è¿œç«¯å†…å­˜ï¼Œè¿™æ˜¯ä¸€ç§ç°æœ‰çš„æœºåˆ¶ï¼Œå°†è™šæ‹Ÿå†…å­˜æ‰©å±•åˆ°ç‰©ç†å¯ç”¨å†…å­˜ä¹‹å¤–ã€‚å½“ CPU è®¿é—®ç‰©ç†å†…å­˜ä¸­ä¸å­˜åœ¨çš„é¡µé¢ä¸­çš„å†…å­˜åœ°å€æ—¶ï¼Œä¼šå¼•å‘é¡µé¢æ•…éšœï¼Œé¡µé¢æ•…éšœå¤„ç†ç¨‹åºé€æ˜åœ°å°†é¡µé¢å†…å®¹ä»äº¤æ¢ç©ºé—´è·å–åˆ°æœ¬åœ°å†…å­˜ä¸­ã€‚ä¼ ç»Ÿä¸Šï¼Œäº¤æ¢ç©ºé—´ä½äºç£ç›˜ä¸Šï¼Œç”±æ­¤äº§ç”Ÿçš„æ¯«ç§’çº§è®¿é—®å»¶è¿Ÿå¯¹å·¥ä½œè´Ÿè½½å¼•å…¥äº†å¤§ä¸”éš¾ä»¥ç†è§£çš„æ€§èƒ½å¼€é”€ã€‚ç„¶è€Œï¼Œäº¤æ¢æœ¬èº«å¹¶ä¸æ„å‘³ç€æ¯«ç§’çº§çš„å»¶è¿Ÿï¼Œå¹¶ä¸”éšç€ä»Šå¤©çš„å¾®ç§’çº§ç½‘ç»œå»¶è¿Ÿï¼Œé€šè¿‡ç½‘ç»œäº¤æ¢åˆ°è¿œç«¯å†…å­˜æœ‰å¯èƒ½è·å¾—è‰¯å¥½çš„æ€§èƒ½ã€‚ Cgroups: CFM ä½¿ç”¨ Linux æ§åˆ¶ç»„ï¼ˆcgroupsï¼‰[5]æ¥enforces æ‰§è¡Œæ¯ä¸ªä½œä¸šçš„æœ¬åœ°å†…å­˜æ¶ˆè€—é™åˆ¶ã€‚æ§åˆ¶ç»„æ§åˆ¶åˆ†é…ç»™ä¸€ç»„è¿›ç¨‹çš„ç‰©ç†å†…å­˜é‡ï¼ŒCFM ä½¿ç”¨äº¤æ¢ç³»ç»Ÿå°†å¤šä½™çš„å†…å­˜ä¿æŒåœ¨è¿œç«¯å†…å­˜ä¸­ã€‚ Control Groupsï¼Œcgroups RDMA: CFM åˆ©ç”¨ RDMA è¿›è¡Œä½å»¶è¿Ÿè®¿é—®è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„å†…å­˜ã€‚CFM ä½¿ç”¨ one-sided read and write æ“ä½œï¼Œè¿™äº›æ“ä½œå¯ä»¥åœ¨ä¸ä½¿ç”¨è¿œç¨‹ CPU çš„æƒ…å†µä¸‹è®¿é—®å†…å­˜,é€šå¸¸ï¼ŒRDMA æ“ä½œæäº¤åˆ°æœ¬åœ°é˜Ÿåˆ—å¯¹ï¼Œç„¶åç”±æœ¬åœ° RDMA NIC å¤„ç†ã€‚ä¸€æ—¦æ“ä½œå®Œæˆï¼ŒNIC å°†å®Œæˆæƒ…å†µå‘å¸ƒåˆ°å®Œæˆé˜Ÿåˆ—ï¼›å®Œæˆé˜Ÿåˆ—å¯ä»¥é…ç½®ä¸ºåœ¨å®Œæˆåˆ°è¾¾æ—¶å¼•å‘ä¸­æ–­ï¼Œæˆ–ä¿æŒé™é»˜ï¼ŒæœŸæœ›å®ƒä»¬å°†è¢«è½®è¯¢ã€‚ä¼ ç»Ÿä¸Šï¼ŒRDMA ç»•è¿‡è¿œç¨‹å’Œæœ¬åœ°æ“ä½œç³»ç»Ÿï¼Œä½† RDMA ä¹Ÿæä¾›äº†ä¸€ä¸ªå†…æ ¸ API ä¾›é©±åŠ¨ç¨‹åºä½¿ç”¨ï¼›CFM åˆ©ç”¨æ­¤ API é€šè¿‡ç½‘ç»œäº¤æ¢é¡µé¢ã€‚ ä»€ä¹ˆ APIï¼Ÿ ","date":"2024-11-05","objectID":"/posts/paper-fastswap/:5:1","tags":["Paper Reading"],"title":"Paper Reading: Can Far Memory Improve Job Throughput? (Fastswap)","uri":"/posts/paper-fastswap/"},{"categories":null,"content":"Challenges and Contributions ä¸¤ä¸ªä¸»è¦æŒ‘æˆ˜ï¼šå¿«é€Ÿäº¤æ¢å’Œå†³å®šå¦‚ä½•åœ¨æœ¬åœ°å’Œè¿œç«¯å†…å­˜ä¹‹é—´è°ƒåº¦ä½œä¸š Fast Swapping RDMA äº¤æ¢è®¾å¤‡å·²ç»åœ¨å…ˆå‰çš„ç ”ç©¶ä¸­è¿›è¡Œäº†æ¢ç´¢ï¼Œä¾‹å¦‚ Infiniswap [34]å’Œ HPBD [47]ã€‚ç„¶è€Œï¼Œè¿™äº›æ–¹æ³•æ— æ³•ç»´æŒå½“ä»Šåº”ç”¨ç¨‹åºæ‰€éœ€çš„é«˜æ€§èƒ½ ä¸ºäº†éšè—æœªæ¥é¡µé¢æ•…éšœçš„ I/O å»¶è¿Ÿï¼Œæ“ä½œç³»ç»Ÿé€šå¸¸é€šè¿‡åœ¨æ¯æ¬¡é¡µé¢æ•…éšœæ—¶è·å–å¤šä¸ªé¡µé¢æ¥å®ç°é¡µé¢é¢„å–ã€‚ä¸å¹¸çš„æ˜¯ï¼Œåœ¨ Linux ä¸­ï¼Œæ•…éšœé¡µé¢â€”â€”åº”ç”¨ç¨‹åºå½“å‰æ‰€éœ€çš„é¡µé¢â€”â€”å¯èƒ½ä½äºè¦é¢„å–çš„å¯¹é½é¡µé¢çª—å£ä¸­çš„ä»»ä½•ä½ç½®ã€‚å› æ­¤ä½¿ç”¨ Linux é»˜è®¤çš„é¢„å–çª—å£å¤§å° 8ï¼Œå¤´é˜»å¡å¯èƒ½ä¼šå»¶è¿Ÿæ•…éšœå¤„ç†æ•°åå¾®ç§’ã€‚ åœ¨ç°æœ‰çš„é€šè¿‡ RDMA è¿›è¡Œäº¤æ¢çš„ç³»ç»Ÿä¸­ï¼ŒCPU é€šè¿‡ä¸­æ–­é€šçŸ¥ RDMA æ“ä½œï¼ˆä¾‹å¦‚ï¼Œè¯»å–è¿œç¨‹é¡µé¢ï¼‰å·²å®Œæˆã€‚è¿™ç§ä¸­æ–­å¤„ç†å‘ç”Ÿåœ¨å…³é”®è·¯å¾„ä¸Šâ€”â€”åœ¨é¡µé¢æ•…éšœå¤„ç†ç¨‹åºèƒ½å¤Ÿè¿”å›åˆ°åº”ç”¨ç¨‹åºä¹‹å‰â€”â€”å¹¶ä¸”å¯èƒ½ä¼šå¢åŠ  10 å¾®ç§’æˆ–æ›´å¤šçš„é¡µé¢æ•…éšœå¤„ç†æ—¶é—´[13]ã€‚ åœ¨æ•…éšœé¡µé¢çš„å†…å®¹è¢«è¯»å…¥æœ¬åœ°å†…å­˜åï¼Œæ“ä½œç³»ç»Ÿé€šè¿‡å¢åŠ å…¶å†…å­˜è®¡æ•°å™¨å°†å…¶è®¡å…¥å…¶æ§åˆ¶ç»„ã€‚å¦‚æœæ§åˆ¶ç»„å†…å­˜é™åˆ¶è¢«è¶…è¿‡ï¼Œåˆ™éœ€è¦å›æ”¶å¤šä½™çš„é¡µé¢ã€‚ä¸ Linux ä¸­çš„ç³»ç»ŸèŒƒå›´å›æ”¶ä¸åŒï¼Œæ§åˆ¶ç»„ä¸­çš„å†…å­˜å›æ”¶æ€»æ˜¯ç›´æ¥è¿›è¡Œçš„ï¼Œå³åœ¨ç¦»å¼€é¡µé¢æ•…éšœå¤„ç†ç¨‹åºå¹¶è¿”å›åˆ°åº”ç”¨ç¨‹åºä¹‹å‰ã€‚å› æ­¤ï¼Œæ•´ä¸ªå›æ”¶è¿‡ç¨‹ï¼ˆæŸ¥æ‰¾è¦å›æ”¶çš„é¡µé¢ï¼Œå°†å®ƒä»¬å†™å…¥äº¤æ¢è®¾å¤‡ï¼Œå¹¶å°†é¡µé¢è¿”å›å†…æ ¸ä»¥ä¾›é‡ç”¨ï¼‰ä¼šå»¶è¿Ÿé¡µé¢æ•…éšœè§£å†³ã€‚ CFM å¼•å…¥äº†ä¸€ä¸ªåä¸º Fastswapï¼ˆÂ§4ï¼‰çš„æ›´å¿«çš„äº¤æ¢ç³»ç»Ÿï¼Œå…‹æœäº†æ‰€æœ‰è¿™ä¸‰ä¸ªæŒ‘æˆ˜ï¼Œä½¿ CFM èƒ½å¤Ÿå®ç°æ¯”ç°æœ‰ç³»ç»Ÿï¼ˆå¦‚ Infiniswapï¼‰æ›´ä½çš„å»¶è¿Ÿå’Œæ›´é«˜çš„è¿œç¨‹äº¤æ¢ååé‡ï¼ˆÂ§6.4ï¼‰ã€‚ Cluster Scheduling è®¸å¤šç°æœ‰çš„è°ƒåº¦å™¨é€šè¿‡åœ¨æ ¸å¿ƒã€å†…å­˜å’Œå…¶ä»–èµ„æºä¹‹é—´è°ƒåº¦ä½œä¸šæ¥å®ç°é›†ç¾¤èµ„æºçš„æœ‰æ•ˆå…±äº«ã€‚ç„¶è€Œï¼Œç°æœ‰è°ƒåº¦å™¨ä¸è€ƒè™‘è¿œç«¯å†…å­˜ï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä»¬ä¸æ”¯æŒè°ƒåº¦å†…å­˜å¯ä»¥åœ¨æœ¬åœ°å’Œè¿œç«¯å†…å­˜ä¹‹é—´åŠ¨æ€åˆ†å‰²çš„ä½œä¸šï¼Œä¹Ÿä¸æŒ‡å®šå¦‚ä½•æœ€å¥½åœ°åœ¨å…±äº«åŒä¸€æœºå™¨çš„å¤šä¸ªä½œä¸šä¹‹é—´åˆ†é…æœ¬åœ°å†…å­˜ã€‚CFM æå‡ºäº†ä¸€ç§é›†ä¸­çš„è¿œç«¯å†…å­˜æ„ŸçŸ¥è°ƒåº¦å™¨ï¼ˆÂ§5ï¼‰ï¼Œåœ¨å°†ä½œä¸šåˆ†é…ç»™æœºå™¨æ—¶è€ƒè™‘è¿œç«¯å†…å­˜ï¼Œå¹¶å†³å®šå¦‚ä½•åœ¨ä¸åŒä½œä¸šä¹‹é—´åˆ’åˆ†æœ¬åœ°å†…å­˜ä»¥ä¼˜åŒ–å®Œæˆæ—¶é—´ã€‚ ","date":"2024-11-05","objectID":"/posts/paper-fastswap/:5:2","tags":["Paper Reading"],"title":"Paper Reading: Can Far Memory Improve Job Throughput? (Fastswap)","uri":"/posts/paper-fastswap/"},{"categories":null,"content":"Fastswap ä½†æˆ‘ä»¬å‘ç°ï¼Œè¦å®ç°æ›´é«˜çš„äº¤æ¢æ€§èƒ½ï¼Œéœ€è¦å¯¹é¡µé¢æ•…éšœå¤„ç†ç¨‹åºã€äº¤æ¢ç³»ç»Ÿå’Œæ§åˆ¶ç»„å†…å­˜æ§åˆ¶å™¨è¿›è¡Œä¿®æ”¹ã€‚æˆ‘ä»¬é€šè¿‡ä¿®æ”¹å¤§çº¦ 300 è¡Œå†…æ ¸ä»£ç å’Œä¸º Linux 4.11 ç¼–å†™äº†ä¸€ä¸ªæ–°çš„ 1200 è¡Œä»£ç çš„è®¾å¤‡é©±åŠ¨ç¨‹åºæ¥å®ç° Fastswap æé«˜åˆ†é¡µæ€§èƒ½å…·æœ‰æŒ‘æˆ˜æ€§ã€‚è™½ç„¶è®¸å¤šç³»ç»Ÿä¸“æ³¨äºåœ¨æ¯«ç§’æ—¶é—´å°ºåº¦ä¸Šè¿›è¡Œæ”¹è¿›[35, 46]ï¼Œä½†æˆ‘ä»¬çš„ç³»ç»ŸåŠ›æ±‚å®ç°å¾®ç§’å°ºåº¦çš„äº¤æ¢ã€‚æˆ‘ä»¬åœ¨æœ¬èŠ‚ä¸­è®¨è®ºçš„å¤§å¤šæ•°æœºåˆ¶å‘ç”Ÿåœ¨ç¨‹åºæ‰§è¡Œæš‚åœæ—¶ã€‚å› æ­¤ï¼Œæˆ‘ä»¬èŠ‚çœçš„æ¯ä¸€å¾®ç§’éƒ½æ˜¯è¿”å›ç»™åº”ç”¨ç¨‹åºçš„è®¡ç®—æ—¶é—´ã€‚ ?? ä»–æ˜¯æ€ä¹ˆå®ç°å¾®ç§’çº§åˆ«çš„ ","date":"2024-11-05","objectID":"/posts/paper-fastswap/:6:0","tags":["Paper Reading"],"title":"Paper Reading: Can Far Memory Improve Job Throughput? (Fastswap)","uri":"/posts/paper-fastswap/"},{"categories":null,"content":"RDMA Backend åœ¨ Fastswap ä¸­ï¼Œæ“ä½œç³»ç»Ÿä½¿ç”¨ RDMA åç«¯ä¸ RDMA NIC äº¤äº’ å¦‚å›¾ 2 æ‰€ç¤ºï¼Œåç«¯ç”¨äºæ‰€æœ‰äº¤æ¢æ“ä½œç±»å‹ï¼šé¡µé¢æ•…éšœã€é¢„å–å’Œå†…å­˜å›æ”¶ã€‚å°½ç®¡ä¹‹å‰çš„ç ”ç©¶å·²ç»å°† RDMA åç«¯æš´éœ²ä¸ºå—è®¾å¤‡ block device æ˜¯ä»€ä¹ˆï¼Ÿ Queue pairs: ç»™å®šé˜Ÿåˆ—å¯¹ä¸­çš„ RDMA è¯·æ±‚ç”± NIC å¤„ç†å•å…ƒæŒ‰é¡ºåºå¤„ç†ï¼Œå¦‚æœä¸åŒç±»åˆ«çš„äº¤æ¢æ“ä½œå…±äº«ä¸€ä¸ªé˜Ÿåˆ—ï¼Œå…³é”®æ“ä½œâ€”â€”ä¾‹å¦‚ï¼Œæ•…éšœé¡µé¢çš„è¯»å–å’Œè¢«é©±é€é¡µé¢çš„å†™å…¥â€”â€”å°†æ’åœ¨ä¸å¤ªç´§æ€¥çš„é¢„å–è¯»å–ä¹‹åã€‚Fastswap é€šè¿‡ä¸ºæ¯ä¸ª CPU ä½¿ç”¨ä¸¤ä¸ª RDMA é˜Ÿåˆ—å¯¹æ¥é¿å…è¿™ç§å¤´é˜»å¡ï¼Œä¸€ä¸ªç”¨äºå…³é”®è·¯å¾„ä¸Šçš„æ“ä½œï¼Œä¸€ä¸ªç”¨äºé¢„å–ã€‚ Frontswap interface: Frontswap å‡è®¾å…¶æ“ä½œæ˜¯åŒæ­¥å®Œæˆçš„[3]ï¼Œå³åœ¨ Frontswap æ“ä½œå®Œæˆåï¼Œæ‰§è¡Œæ§åˆ¶æ‰ä¼šè¿”å›åˆ°äº¤æ¢ç³»ç»Ÿã€‚å› æ­¤ï¼Œå®ƒæ²¡æœ‰æä¾›åŒºåˆ†å…³é”®è·¯å¾„ä¸Šçš„æ“ä½œå’Œéå…³é”®æ“ä½œçš„æœºåˆ¶ã€‚å› æ­¤ï¼ŒFastswap å¢å¼ºäº† Frontswap æ¥å£ï¼Œä»¥åŒºåˆ†å…³é”®å’Œéå…³é”®æ“ä½œï¼Œä½¿ RDMA åç«¯èƒ½å¤Ÿå°†è¯·æ±‚å¼•å¯¼åˆ°é€‚å½“çš„é˜Ÿåˆ—å¯¹ã€‚ åŠ é˜Ÿåˆ—å°±å®Œäº† ","date":"2024-11-05","objectID":"/posts/paper-fastswap/:6:1","tags":["Paper Reading"],"title":"Paper Reading: Can Far Memory Improve Job Throughput? (Fastswap)","uri":"/posts/paper-fastswap/"},{"categories":null,"content":"Page Fault Handler Fastswap é€šè¿‡ä¸¤ç§å…³é”®æ–¹å¼ä¿®æ”¹é¡µé¢æ•…éšœå¤„ç†ç¨‹åºã€‚ é¦–å…ˆï¼Œå®ƒæŒ‡ç¤ºäº¤æ¢ç³»ç»Ÿä»¥ä¸åŒçš„æ–¹å¼å¤„ç†æ•…éšœé¡µé¢å’Œé¢„å–é¡µé¢ï¼Œå¦‚ä¸Šæ‰€è¿°ã€‚å…¶æ¬¡ï¼ŒFastswap ä¿®æ”¹äº¤æ¢ç³»ç»Ÿï¼Œé¦–å…ˆè¯»å–æ•…éšœé¡µé¢ï¼Œç„¶åè¯»å–é¢„å–çª—å£å†…çš„å‰©ä½™é¡µé¢ åœ¨å‘å‡ºæ‰€æœ‰è¯»å–æ“ä½œåï¼ŒFastswap è½®è¯¢ç­‰å¾…æ•…éšœè¯»å–å®Œæˆã€‚é€šè¿‡é¦–å…ˆå‘å‡ºæ•…éšœè¯»å–ï¼Œæˆ‘ä»¬é‡å äº†ä¸ºé¢„å–è¯»å–åˆ†é…ç‰©ç†é¡µé¢çš„å»¶è¿Ÿå’Œå‘å‡ºé¢„å– RDMA è¯»å–çš„å»¶è¿Ÿï¼Œä¸æ•…éšœé¡µé¢çš„ RDMA è¯»å–ã€‚å›¾ 3 å±•ç¤ºäº† Fastswap å¦‚ä½•å¤„ç†é¡µé¢æ•…éšœåŠå…¶ç›¸å…³çš„é¢„å–ã€‚ åˆ†åˆ«å¤„ç†æ•…éšœé¡µé¢å’Œé¢„å–é¡µé¢æœ€å°åŒ–äº†é”™è¿‡é¢„å–çš„æˆæœ¬ã€‚ä¾‹å¦‚ï¼Œå‡è®¾é¡µé¢æ•…éšœ 1 å‘ç”Ÿåœ¨åœ°å€ F1ï¼Œå¹¶æœ‰ä¸€ç»„ç›¸å…³çš„é¢„å–é¡µé¢ P1ã€‚æˆ‘ä»¬çš„äº¤æ¢ç³»ç»Ÿå°†å‘å‡º F1 å’Œ P1 çš„è¯»å–æ“ä½œï¼Œå¹¶è½®è¯¢ç›´åˆ° F1 çš„è¯»å–å®Œæˆã€‚æ­¤æ—¶ï¼Œé¡µé¢æ•…éšœå¤„ç†ç¨‹åºå°†è¿”å›åˆ°ç”¨æˆ·ç©ºé—´ã€‚ç„¶åï¼Œå‡è®¾é¡µé¢æ•…éšœ 2 å‘ç”Ÿåœ¨åœ°å€ F2ï¼Œå…¶ä¸­ F2 \u003c P1ï¼ˆå³é¢„å–æœªå‘½ä¸­ï¼‰ã€‚Fastswap å¯ä»¥åœ¨ä¸ç­‰å¾… P1 ä¸­çš„ä»»ä½•é¡µé¢çš„æƒ…å†µä¸‹è·å– F2ï¼Œè€Œä¹‹å‰çš„ç³»ç»Ÿåˆ™éœ€è¦ç­‰å¾… P1 ä¸­çš„æ‰€æœ‰é¡µé¢å®Œæˆåæ‰èƒ½å®Œæˆ F2 çš„è¯»å– fastswap å°±æ˜¯æŠŠé¢„è¯»çš„ä¼˜å…ˆçº§é™ä½äº†ï¼Ÿ ","date":"2024-11-05","objectID":"/posts/paper-fastswap/:6:2","tags":["Paper Reading"],"title":"Paper Reading: Can Far Memory Improve Job Throughput? (Fastswap)","uri":"/posts/paper-fastswap/"},{"categories":null,"content":"Memory Reclaim æˆ‘ä»¬å·²ç»ä»‹ç»äº† Fastswap äº¤æ¢ç³»ç»Ÿå¦‚ä½•å°†é¡µé¢ä»è¿œç«¯å†…å­˜å¸¦å…¥æœ¬åœ°å†…å­˜ã€‚ç°åœ¨æˆ‘ä»¬æè¿° Fastswap å¦‚ä½•å›æ”¶å†…å­˜ï¼Œä»¥ç¡®ä¿è¿›ç¨‹ä¸ä¼šä½¿ç”¨è¶…è¿‡å…¶å…è®¸ä»½é¢çš„æœ¬åœ°å†…å­˜ã€‚Fastswap é€šè¿‡ä¿®æ”¹æ§åˆ¶ç»„å†…å­˜æ§åˆ¶å™¨ï¼Œå°†å›æ”¶æ“ä½œä»é¡µé¢æ•…éšœå¤„ç†çš„å…³é”®è·¯å¾„ä¸Šç§»é™¤ã€‚ ä¼ ç»Ÿä¸Šï¼Œåœ¨è¯»å–æ•…éšœé¡µé¢åï¼Œå†…å­˜æ§åˆ¶å™¨å°†é¡µé¢è®¡å…¥å…¶æ§åˆ¶ç»„ã€‚ç„¶åï¼Œæ§åˆ¶å™¨æ£€æŸ¥æ§åˆ¶ç»„æ˜¯å¦æœ‰è¶…è¿‡å…¶å…è®¸ä»½é¢çš„å†…å­˜ã€‚å¦‚æœæœ‰å¤šä½™çš„é¡µé¢ï¼Œå®ƒä»¬ä¼šè¢«ç›´æ¥å›æ”¶ï¼Œå¹¶å¯èƒ½è¢«é©±é€åˆ°è¿œç«¯å†…å­˜ã€‚ç›´æ¥å›æ”¶å‘ç”Ÿåœ¨é¡µé¢æ•…éšœå¤„ç†ç¨‹åºçš„ä¸Šä¸‹æ–‡ä¸­ï¼Œå› æ­¤å®ƒä¼šé˜»æ­¢ CPU è¿”å›åˆ°ç”¨æˆ·ç©ºé—´å¹¶ç»§ç»­å·¥ä½œè´Ÿè½½æ‰§è¡Œã€‚ Linux ä¸­çš„å†…å­˜å›æ”¶å‡ºä¹æ„æ–™åœ°æ˜‚è´µï¼Œå½“æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºæœ‰ 50%çš„å†…å­˜ä½äºè¿œç«¯å†…å­˜æ—¶ï¼Œæ¶ˆè€—äº† 62-85%çš„å†…æ ¸æ—¶é—´ã€‚ä¸ºäº†å‡å°‘è¿™äº›æˆæœ¬ï¼Œæ¯å½“èŠ‚ç‚¹ä½¿ç”¨è¿œç«¯å†…å­˜æ—¶ï¼Œæˆ‘ä»¬ä¿®æ”¹çš„å†…å­˜æ§åˆ¶å™¨å°†å†…å­˜å›æ”¶å¸è½½åˆ°ä¸“ç”¨å›æ”¶ CPUï¼ˆå›¾ 2ï¼‰ï¼›æˆ‘ä»¬ç§°ä¹‹ä¸ºå¸è½½å›æ”¶ offloaded reclaimã€‚å¸è½½å†…å­˜å›æ”¶å…è®¸å¯¼è‡´é¡µé¢æ•…éšœçš„ CPU åœ¨ä¸éœ€è¦èŠ±è´¹æ—¶é—´è¿›è¡Œç›´æ¥å›æ”¶çš„æƒ…å†µä¸‹è¿”å›åˆ°ç”¨æˆ·ç©ºé—´ã€‚æœ€è¿‘çš„åŠªåŠ›å·²ç»ä½¿ç”¨äº†ç±»ä¼¼çš„æ–¹æ³•æ¥å¸è½½å†·å†…å­˜å‹ç¼©[43]å’Œæ•°æ®åŒ…å¤„ç†[22, 52]åˆ°ä¸“ç”¨ CPUã€‚ æ— è®ºå†…å­˜å›æ”¶æ˜¯ç›´æ¥çš„è¿˜æ˜¯å¸è½½çš„ï¼Œåœ¨å°†é¡µé¢é©±é€åˆ°è¿œç«¯å†…å­˜æ—¶ï¼Œæˆ‘ä»¬éƒ½ä¼šè½®è¯¢å®ƒä»¬çš„å®Œæˆæƒ…å†µã€‚åªæœ‰åœ¨é¡µé¢å†™å…¥è¿œç«¯å†…å­˜å®Œæˆåï¼Œé¡µé¢æ‰èƒ½å®Œå…¨å›æ”¶ã€‚ ","date":"2024-11-05","objectID":"/posts/paper-fastswap/:6:3","tags":["Paper Reading"],"title":"Paper Reading: Can Far Memory Improve Job Throughput? (Fastswap)","uri":"/posts/paper-fastswap/"},{"categories":null,"content":"Far Memory-Aware Scheduler â€¦ åé¢éƒ½çœç•¥äº†ï¼Œå®éªŒä¹Ÿè·³è¿‡ï¼Œæ€ªæ€ªçš„ ä½¿ç”¨äº†å®šä¹‰çš„å‡ ä¸ªå‚æ•°ï¼Œè´Ÿè½½ / é›†ç¾¤é…ç½®å·®ä¸å¤šï¼Œçœ‹è¿œç«¯å†…å­˜ä¼šè°ƒç”¨å¤šå°‘ï¼Œç„¶ååšäº†ä¸€ä¸ªæœ€ä¼˜åŒ–é—®é¢˜ï¼Œæœ€å¤§ (A - B) / C, Aâˆ’B is the total local memory-time product saving, C is the total far memory-time product æ›´æƒ³çœ‹æ¯ä¸ªç»„ä»¶çš„è¡¨ç°è€Œä¸æ˜¯è¿™ç§ ","date":"2024-11-05","objectID":"/posts/paper-fastswap/:7:0","tags":["Paper Reading"],"title":"Paper Reading: Can Far Memory Improve Job Throughput? (Fastswap)","uri":"/posts/paper-fastswap/"},{"categories":null,"content":"Software-Defined Far Memory in Warehouse-Scale Computers zswap å‹ç¼©å†…å­˜çš„ä¸€ç¯‡è®ºæ–‡ï¼Œä½¿ç”¨è¿œç«¯å†…å­˜æ¥é™ä½æˆæœ¬ éœ€è¦ç†è§£ä»€ä¹ˆæ˜¯ cold memoeryï¼Œä»€ä¹ˆæ˜¯ zswap æ€ä¹ˆåšå‹ç¼© zswap linux manual, https://www.kernel.org/doc/html/v4.18/vm/zswap.html ä½¿ç”¨äº† ML åš Autotunner æœ‰æ„æ€çš„æ˜¯ï¼ŒASPLOS 19 åœ¨ Providence RIï¼ŒHoard (å†…å­˜ç®¡ç†) æ˜¯å½“å¹´çš„ Influential Paper Winner è‡³äº Far Memory ä½œç”¨åº”è¯¥æ˜¯å¾ˆæœ‰å‰é€”çš„ï¼Œé™¤äº† Google æåˆ°çš„ WSC ä»“åº“çº§è´Ÿè½½ï¼Œæˆ‘è§‰å¾—ä¸€äº›æ•°æ®åº“ä¹Ÿå¯ä»¥åº”ç”¨ï¼Œå°¤å…¶æ˜¯è®ºæ–‡æåˆ° Bigtable ç»“åˆ é™¤äº† zswap far memo, ä¹Ÿæœ‰ application-integrated far memory (Brown), Fastswap(UCB) ç­‰ç­‰æ¯”è¾ƒæœ‰æ„æ€çš„ è¿˜æœ‰ä¸€ç¯‡ OSDI 22 best paper çœ‹ç€æœ‰æ„æ€ MemLiner: Lining up Tracing and Application for a Far-Memory-Friendly Runtime ","date":"2024-10-30","objectID":"/posts/paper-far-memory/:1:0","tags":["Paper Reading"],"title":"Paper Reading: Software-Defined Far Memory in Warehouse-Scale Computers","uri":"/posts/paper-far-memory/"},{"categories":null,"content":"Abstract éšç€å†…å­˜éœ€æ±‚çš„å¢åŠ å’ŒæŠ€æœ¯æ‰©å±•é€Ÿåº¦çš„å‡ç¼“ï¼Œä»“åº“çº§è®¡ç®—æœºï¼ˆWSCï¼‰çš„ total cost of ownershipï¼ˆTCOï¼‰é¢ä¸´ç€é‡è¦çš„æŒ‘æˆ˜ã€‚ ä¸€ä¸ªæœ‰å‰æ™¯çš„æƒ³æ³•æ˜¯é€šè¿‡æ·»åŠ ä¸€ä¸ªæ›´ä¾¿å®œä½†é€Ÿåº¦è¾ƒæ…¢çš„ â€œfar memoryâ€ å±‚çº§æ¥é™ä½å†…å­˜çš„ TCOï¼Œå¹¶ä½¿ç”¨å®ƒæ¥å­˜å‚¨ä¸å¸¸è®¿é—®ï¼ˆæˆ–å†·ï¼‰çš„æ•°æ®ã€‚ ç„¶è€Œï¼Œå¼•å…¥è¿œç«¯å†…å­˜å±‚çº§å¸¦æ¥äº†æ–°çš„æŒ‘æˆ˜ï¼ŒåŒ…æ‹¬åŠ¨æ€å“åº”å·¥ä½œè´Ÿè½½å¤šæ ·æ€§å’Œå˜åŒ–ã€æœ€å°åŒ–å®¹é‡é—²ç½®ä»¥åŠå¤„ç† brownfield (legacy) éƒ¨ç½²ã€‚ TCO æ€»æ‹¥æœ‰æˆæœ¬ï¼Œå°±æ˜¯æ€»æˆæœ¬ï¼Ÿæ¯”å¦‚æœåŠ¡å™¨ä»·æ ¼ã€ç»´æŠ¤ä»·æ ¼ä»€ä¹ˆçš„å§ è¿œç«¯å†…å­˜ï¼Œèƒ½ç†è§£æˆç±»ä¼¼ S3 å—ï¼Ÿ é—®é¢˜å°±æ˜¯å…¼å®¹ã€åŠ¨æ€è´Ÿè½½ä»€ä¹ˆçš„ æˆ‘ä»¬æå‡ºäº†ä¸€ç§æ–°é¢–çš„è½¯ä»¶å®šä¹‰æ–¹æ³•æ¥å®ç°è¿œç«¯å†…å­˜ï¼Œé€šè¿‡ä¸»åŠ¨å‹ç¼©å†·å†…å­˜é¡µæ¥åœ¨è½¯ä»¶ä¸­æœ‰æ•ˆåœ°åˆ›å»ºä¸€ä¸ªè¿œç«¯å†…å­˜å±‚çº§ã€‚æˆ‘ä»¬çš„ç«¯åˆ°ç«¯ç³»ç»Ÿè®¾è®¡åŒ…æ‹¬æ–°çš„æ–¹æ³•æ¥å®šä¹‰æ€§èƒ½æœåŠ¡çº§åˆ«ç›®æ ‡ï¼ˆSLOï¼‰ï¼Œä¸€ç§åœ¨æ»¡è¶³ SLO çš„åŒæ—¶è¯†åˆ«å†·å†…å­˜é¡µçš„æœºåˆ¶ï¼Œä»¥åŠæˆ‘ä»¬åœ¨æ“ä½œç³»ç»Ÿå†…æ ¸å’ŒèŠ‚ç‚¹ä»£ç†ä¸­çš„å®ç°ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜è®¾è®¡äº†åŸºäºå­¦ä¹ çš„è‡ªåŠ¨è°ƒä¼˜ï¼Œä»¥å®šæœŸé€‚åº”æ•´ä¸ªæœºç¾¤çš„å˜åŒ–ï¼Œè€Œæ— éœ€äººå·¥å¹²é¢„ã€‚ è‡ª 2016 å¹´ä»¥æ¥ï¼Œæˆ‘ä»¬çš„ç³»ç»Ÿå·²åœ¨è°·æ­Œçš„ WSC ä¸­æˆåŠŸéƒ¨ç½²ï¼ŒæœåŠ¡äºæ•°åƒä¸ªç”Ÿäº§æœåŠ¡ã€‚æˆ‘ä»¬çš„è½¯ä»¶å®šä¹‰è¿œç«¯å†…å­˜åœ¨ç›¸å¯¹è‰¯å¥½çš„è®¿é—®é€Ÿåº¦ï¼ˆ6 Âµsï¼‰ä¸‹æ˜¾è‘—é™ä½äº†æˆæœ¬ï¼ˆ67%æˆ–æ›´é«˜çš„å†…å­˜æˆæœ¬å‡å°‘ï¼‰ï¼Œå¹¶å…è®¸æˆ‘ä»¬å­˜å‚¨ç›¸å½“å¤§æ¯”ä¾‹çš„ä¸å¸¸è®¿é—®æ•°æ®ï¼ˆå¹³å‡ 20%ï¼‰ï¼Œä»è€Œåœ¨ä»“åº“è§„æ¨¡ä¸Šå®ç°äº†æ˜¾è‘—çš„ TCO èŠ‚çœã€‚ ","date":"2024-10-30","objectID":"/posts/paper-far-memory/:2:0","tags":["Paper Reading"],"title":"Paper Reading: Software-Defined Far Memory in Warehouse-Scale Computers","uri":"/posts/paper-far-memory/"},{"categories":null,"content":"Introduction æ‰©å±• WSC é€šå¸¸å—é™äºåœ¨æ€§èƒ½å’Œæˆæœ¬æ•ˆç›Šæ–¹é¢æ‰©å±•è¡Œä¸ºæœ€å¼±çš„ç»„ä»¶ã€‚ è¿‘å¹´æ¥ï¼ŒDRAM å·²æˆä¸ºæ‰©å±• WSC çš„å…³é”®ç“¶é¢ˆã€‚è®¾å¤‡çº§æ‰©å±•é€Ÿåº¦çš„å‡ç¼“ï¼ˆæ‘©å°”å®šå¾‹çš„ç»ˆç»“[35]ï¼‰é˜»æ­¢äº†æ¯ GB DRAM æˆæœ¬çš„é™ä½[25, 27]ã€‚åŒæ—¶ï¼Œå†…å­˜è®¡ç®—çš„æ™®åŠï¼Œç‰¹åˆ«æ˜¯å¤§æ•°æ®å·¥ä½œè´Ÿè½½ï¼Œå¯¼è‡´äº† DRAM éœ€æ±‚çš„çˆ†ç‚¸æ€§å¢é•¿ã€‚è¿™ä¸¤ä¸ªè¶‹åŠ¿å¯¼è‡´äº†è¿‘å¹´æ¥å…¨çƒ DRAM ä¾›åº”çŸ­ç¼ºï¼Œå¯¹ WSC çš„æˆæœ¬æ•ˆç›Šæ‰©å±•æ„æˆäº†ä¸¥é‡æŒ‘æˆ˜ã€‚ ä¸€ä¸ªæœ‰å‰æ™¯çš„æ–¹å‘æ˜¯å¼•å…¥ç¬¬äºŒçº§å†…å­˜æˆ–è¿œç«¯å†…å­˜ï¼Œä»¥é™ä½å†…å­˜æ‹¥æœ‰æˆæœ¬ã€‚è¿œç«¯å†…å­˜æ˜¯ä»‹äº DRAM å’Œé—ªå­˜ä¹‹é—´çš„ä¸€å±‚ï¼Œæ¯ GB æˆæœ¬ä½äº DRAMï¼Œæ€§èƒ½é«˜äºé—ªå­˜ã€‚é€šè¿‡åœ¨å†…å­˜å±‚æ¬¡ç»“æ„ä¸­å¼•å…¥è¿œç«¯å†…å­˜å¹¶å°†ä¸å¸¸è®¿é—®ï¼ˆæˆ–å†·ï¼‰æ•°æ®å­˜å‚¨åˆ°è¿œç«¯å†…å­˜ä¸­ï¼Œç³»ç»Ÿå¯ä»¥åœ¨è¾ƒä½çš„ DRAM å®¹é‡ä¸‹æ‰§è¡Œç›¸åŒçš„å·¥ä½œï¼Œæˆ–è€…åœ¨æ¯å°æœºå™¨ä¸Šæ‰“åŒ…æ›´å¤šçš„å·¥ä½œï¼Œä»è€Œé™ä½æ€»æ‹¥æœ‰æˆæœ¬ï¼ˆTCOï¼‰ã€‚ç°ä»£ WSC åŠå…¶ä¸Šè¿è¡Œçš„åº”ç”¨ç¨‹åºå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼Œåœ¨éƒ¨ç½²ç¬¬äºŒçº§å†…å­˜æ—¶æå‡ºäº†ç‹¬ç‰¹çš„éœ€æ±‚ï¼š Near-zero tolerance to application slowdown, WSC å¯¹æ€§èƒ½æˆæœ¬æ¯”éå¸¸æ•æ„Ÿï¼Œä½†åº”ç”¨ç¨‹åºçš„å‡é€Ÿå¯èƒ½å¯¼è‡´ä¸å¯æ¢å¤çš„æœåŠ¡çº§åˆ«åè®®ï¼ˆSLAï¼‰è¿è§„ï¼Œ Heterogeneity of applications åœ¨ç°ä»£ WSC ä¸Šè¿è¡Œçš„åº”ç”¨ç¨‹åºè¶Šæ¥è¶Šå¤šæ ·åŒ– Dynamic cold memory behavior WSC åœ¨å·¥ä½œè´Ÿè½½æ··åˆå’Œ/æˆ–åˆ©ç”¨ç‡ï¼ˆä¾‹å¦‚ï¼Œæ˜¼å¤œæ¨¡å¼ï¼‰æ–¹é¢è¡¨ç°å‡ºåŠ¨æ€å˜åŒ–ï¼Œå¯¼è‡´æ¯å°æœºå™¨å¯åˆ©ç”¨è¿œç«¯å†…å­˜æŠ€æœ¯çš„æœ‰æ•ˆå†…å­˜å¤§å°å‘ç”Ÿå˜åŒ–ã€‚å› æ­¤ï¼Œè¿‘ç«¯å’Œè¿œç«¯å†…å­˜ä¹‹é—´çš„æœ€ä½³æ¯”ä¾‹ä¸ä»…å–å†³äºå½“å‰è¿è¡Œçš„å·¥ä½œè´Ÿè½½ï¼Œè€Œä¸”éšæ—¶é—´å˜åŒ–ã€‚å› æ­¤ï¼Œå¸Œæœ›é™ä½é—²ç½®è¿œç«¯å†…å­˜å®¹é‡çš„ TCO å½±å“ï¼Œæˆ–è€…åœ¨ä¾›åº”æ–¹é¢å…·æœ‰çµæ´»æ€§ã€‚ åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬è§£å†³äº†ä¸Šè¿° WSC æ‹¥æœ‰æˆæœ¬çš„æŒ‘æˆ˜ï¼Œ æˆ‘ä»¬å±•ç¤ºäº†å¯¹çœŸå®ä¸–ç•Œ WSC çš„æœºç¾¤èŒƒå›´çºµå‘æè¿°ï¼Œé‡åŒ–äº†æ¯å°æœºå™¨å¯ç”¨å†·å†…å­˜é‡çš„å·¨å¤§å˜åŒ–ã€‚æˆ‘ä»¬å‘ç°ï¼Œå†·å†…å­˜é‡åœ¨ä¸åŒé›†ç¾¤ä¹‹é—´ä» 1%åˆ° 61%ä¸ç­‰ï¼Œå³ä½¿åœ¨åŒä¸€é›†ç¾¤å†…ï¼Œæ ¹æ®åº”ç”¨ç¨‹åºæ··åˆå’Œä¸€å¤©ä¸­çš„æ—¶é—´ï¼Œå†·å†…å­˜é‡ä¹Ÿä» 1% åˆ° 52% ä¸ç­‰ã€‚è¿™ç§èŒƒå›´éœ€è¦çµæ´»çš„è¿œç«¯å†…å­˜ä¾›åº”ï¼Œè€Œä¸æ˜¯å›ºå®šå®¹é‡çš„è¿œç«¯å†…å­˜ã€‚ æˆ‘ä»¬å±•ç¤ºäº†ä¸€ç§è½¯ä»¶å®šä¹‰çš„è¿œç«¯å†…å­˜æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ˜“äºè·å–ï¼Œæä¾›çµæ´»æ€§ improves time to market, ä½¿å†…å­˜ TCO å˜å¾—å¯è¡Œã€‚ å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬å±•ç¤ºäº† zswap[1]ï¼Œä¸€ä¸ª Linux å†…æ ¸æœºåˆ¶ï¼Œå¯ä»¥å°†å†…å­˜å‹ç¼©å­˜å‚¨åœ¨ DRAM ä¸­ï¼Œå¯ä»¥ç”¨äºå®ç°è½¯ä»¶å®šä¹‰çš„è¿œç«¯å†…å­˜ï¼Œæä¾› single-digit Âµs of latency at tail.ã€‚æˆ‘ä»¬è¿˜å±•ç¤ºäº†æˆ‘ä»¬ä¸»åŠ¨å°†å†·é¡µç§»åŠ¨åˆ°è¾ƒæ…¢çš„è¿œç«¯å†…å­˜çš„æ–¹æ³•ï¼Œåœ¨ä»ä½è®¿é—®ç‡çš„é¡µä¸­è·å–å†…å­˜å®¹é‡æ–¹é¢è¡¨ç°è‰¯å¥½ï¼Œè€Œä¸æ˜¯åœ¨æœºå™¨å†…å­˜å‹åŠ›ä¸‹çš„è¢«åŠ¨æ–¹æ³•ã€‚ æˆ‘ä»¬è®¨è®ºäº†æˆ‘ä»¬çš„æ–¹æ³•çš„è®¾è®¡å’Œå®ç°ã€‚æˆ‘ä»¬çš„æ§åˆ¶å¹³é¢åŒ…æ‹¬ï¼ˆ1ï¼‰ä¸€ä¸ªæ”¶é›†å†…å­˜è®¿é—®ç»Ÿè®¡ä¿¡æ¯å¹¶å°†å†·å†…å­˜é¡µäº¤æ¢åˆ°è¿œç«¯å†…å­˜çš„å†…æ ¸æœºåˆ¶ï¼Œä»¥åŠï¼ˆ2ï¼‰ä¸€ä¸ªæ ¹æ®åº”ç”¨ç¨‹åºè¡Œä¸ºæ§åˆ¶å†…æ ¸æœºåˆ¶æ¿€è¿›ç¨‹åº¦çš„èŠ‚ç‚¹ä»£ç†ã€‚æˆ‘ä»¬çš„è®¾è®¡åŸºäºæ˜ç¡®å®šä¹‰çš„æœåŠ¡çº§åˆ«ç›®æ ‡ï¼ˆSLOï¼‰ï¼Œå¹¶ä¸”å¯ä»¥æ¨å¹¿åˆ°å…¶ä»–ç±»å‹çš„è¿œç«¯å†…å­˜è®¾å¤‡ã€‚ æˆ‘ä»¬å®ç°äº†ä¸€ä¸ªåŸºäºæœºå™¨å­¦ä¹ çš„è‡ªåŠ¨è°ƒä¼˜ç³»ç»Ÿï¼Œæ ¹æ®æœºç¾¤èŒƒå›´çš„è¡Œä¸ºä¼˜åŒ–æ§åˆ¶å¹³é¢ã€‚å®ƒåŒ…æ‹¬ä¸€ä¸ªå¿«é€Ÿè¿œç«¯å†…å­˜æ¨¡å‹ï¼Œä¼°è®¡åœ¨ä¸åŒé…ç½®ä¸‹æ•´ä¸ª WSC çš„è¿œç«¯å†…å­˜è¡Œä¸ºï¼Œå¹¶ç”±ç§°ä¸ºé«˜æ–¯è¿‡ç¨‹ï¼ˆGPï¼‰Bandit[17, 21, 39]çš„æœºå™¨å­¦ä¹ ç®—æ³•æŒ‡å¯¼è®¾è®¡ç©ºé—´æ¢ç´¢ã€‚è¿™ä½¿å¾—æ•´ä¸ªç³»ç»Ÿèƒ½å¤Ÿé€‚åº”æ•´ä¸ª WSC çš„é•¿æœŸè¡Œä¸ºå˜åŒ– æˆ‘ä»¬å±•ç¤ºäº†æ¥è‡ªçœŸå®ä¸–ç•Œç”¨ä¾‹çš„è¯„ä¼°æ•°æ®ï¼ŒåŒ…æ‹¬åœ¨ç”Ÿäº§å·¥ä½œè´Ÿè½½æ··åˆä¸­çš„çºµå‘ç ”ç©¶å’Œä¸ Bigtable[10]çš„æ¡ˆä¾‹ç ”ç©¶ã€‚æˆ‘ä»¬çš„ç³»ç»Ÿå¯ä»¥è¿ç§» 20-30%çš„ä¸å¸¸ç”¨æ•°æ®ï¼Œä¿ƒè¿› 4-5%çš„å†…å­˜ TCO èŠ‚çœï¼ˆåœ¨ WSC è§„æ¨¡ä¸‹ä¸ºæ•°ç™¾ä¸‡ç¾å…ƒï¼‰ï¼ŒåŒæ—¶å¯¹å¤šæ ·åŒ–çš„åº”ç”¨ç¨‹åºå½±å“å¾®ä¹å…¶å¾®ã€‚æˆ‘ä»¬çš„åŸºäºæœºå™¨å­¦ä¹ çš„è‡ªåŠ¨è°ƒä¼˜å™¨ç›¸å¯¹äºåŸºäºå¯å‘å¼çš„æ–¹æ³•ï¼Œé¢å¤–æé«˜äº†æˆ‘ä»¬ç³»ç»Ÿçš„æ•ˆç‡ 30%ã€‚ è¿™ä¸ª Gaussian Process (GP) Bandit åœ¨è°ƒä¼˜é‡Œè›®å¸¸è§çš„ï¼Œæ•°æ®åº“è°ƒä¼˜ç­‰ç­‰ ä½†æ•ˆæœæœ‰è¿™ä¹ˆå¥½å— ","date":"2024-10-30","objectID":"/posts/paper-far-memory/:3:0","tags":["Paper Reading"],"title":"Paper Reading: Software-Defined Far Memory in Warehouse-Scale Computers","uri":"/posts/paper-far-memory/"},{"categories":null,"content":"Background and Motivation ","date":"2024-10-30","objectID":"/posts/paper-far-memory/:4:0","tags":["Paper Reading"],"title":"Paper Reading: Software-Defined Far Memory in Warehouse-Scale Computers","uri":"/posts/paper-far-memory/"},{"categories":null,"content":"Far Memory è¿œç«¯å†…å­˜æ˜¯ä»‹äº DRAM å’Œé—ªå­˜ä¹‹é—´çš„ä¸€å±‚ï¼Œæ¯ GB æˆæœ¬ä½äº DRAMï¼Œæ€§èƒ½é«˜äºé—ªå­˜ã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬æ¦‚è¿°äº†å…ˆå‰ç ”ç©¶ä¸­æ¢è®¨çš„è¿œç«¯å†…å­˜æŠ€æœ¯ï¼Œå¹¶ä» WSC çš„è§’åº¦è®¨è®ºäº†å®ƒä»¬çš„ç‰¹ç‚¹ã€‚ Non-volatile memoryï¼ˆNVMï¼‰æ˜¯ä¸€ç§æ–°å…´çš„å†…å­˜æŠ€æœ¯ï¼Œå…¶å®ç°äº†æ¯” DRAM æ›´é«˜çš„å¯†åº¦ï¼ˆå› æ­¤æ¯ GB æˆæœ¬æ›´ä½ï¼‰å’ŒåŸºäºæ–°ææ–™çš„æ•°æ®æŒä¹…æ€§ã€‚è¿„ä»Šä¸ºæ­¢ï¼Œç›¸å¯¹äº DRAMï¼Œå¤§å¤šæ•° NVM æŠ€æœ¯æ˜¾ç¤ºå‡ºæ›´é«˜çš„å»¶è¿Ÿï¼ˆä»æ•°ç™¾çº³ç§’åˆ°æ•°åå¾®ç§’ï¼‰ã€æ›´ä½çš„å¸¦å®½ï¼ˆå•æ•° GB/sï¼‰ä»¥åŠè¯»/å†™ä¸å¯¹ç§°æ€§ï¼ˆå³å†™å…¥æ¯”è¯»å–æ…¢ï¼‰ã€‚åœ¨è®¿é—®æ¥å£æ–¹é¢ï¼Œå¸‚åœºä¸Šä¸»è¦æœ‰ä¸¤ç§ç±»å‹çš„ NVM è®¾å¤‡ï¼šå†…å­˜æ€»çº¿ï¼ˆä¾‹å¦‚ï¼ŒNVDIMM-P [37]ï¼ŒIntel Optane DC æŒä¹…å†…å­˜ [20] ç­‰ï¼‰å’Œ PCIe æ€»çº¿ï¼ˆä¾‹å¦‚ï¼ŒIntel Optane DC SSD [20]ï¼Œä¸‰æ˜Ÿ Z-SSD [38] ç­‰ï¼‰ã€‚ä¸¤è€…çš„ä¸»è¦åŒºåˆ«åœ¨äºï¼Œå‰è€…å…è®¸ä»¥ç¼“å­˜å—ç²’åº¦å¯¹ NVM è¿›è¡ŒåŠ è½½/å­˜å‚¨è®¿é—®ï¼Œè€Œåè€…åˆ™é€šè¿‡ç±»ä¼¼äºå­˜å‚¨è®¾å¤‡çš„é¡µé¢ç²’åº¦è®¿é—®æ¥å£ï¼Œæ•°æ®åœ¨è®¿é—®ä¹‹å‰å¿…é¡»ä» NVM å¤åˆ¶åˆ°ä¸»å†…å­˜ã€‚å› æ­¤ï¼Œå‰è€…é€šå¸¸æä¾›å¯¹å­˜å‚¨åœ¨ NVM ä¸­çš„æ•°æ®çš„æ›´å¿«è®¿é—®ï¼Œä½†éœ€è¦ CPU ç«¯çš„ç¡¬ä»¶æ”¯æŒã€‚è®¸å¤šå½“å‰çš„ NVM è®¾å¤‡ä»…ä»¥å›ºå®šé¢„è®¾å¤§å°æä¾›ã€‚è¿™å¯èƒ½ä¼šåœ¨ WSC çš„ä¸Šä¸‹æ–‡ä¸­å¯¼è‡´èµ„æºé—²ç½®ã€‚ Remote memory. å†…å­˜åˆ†è§£[30]æ˜¯ä¸€ç§ä½¿ç”¨è¿œç¨‹æœºå™¨çš„å†…å­˜ä½œä¸ºäº¤æ¢è®¾å¤‡çš„æ–¹æ³•ã€‚å®ƒé€šè¿‡åˆ©ç”¨è¿œç¨‹æœºå™¨ä¸­çš„æœªä½¿ç”¨å†…å­˜[18, 29]ï¼Œæˆ–é€šè¿‡æ„å»ºä»…ç”¨äºä¸ºè®¸å¤šæœºå™¨æä¾›å…±äº«å†…å­˜æ± çš„å†…å­˜è®¾å¤‡[30, 31]æ¥å®ç°ã€‚è¿™ä¸¤ç§å®ç°æ–¹å¼éƒ½é€šè¿‡åœ¨é›†ç¾¤ä¸­çš„æœºå™¨ä¹‹é—´å¹³è¡¡å†…å­˜ä½¿ç”¨ï¼Œå‡å°‘äº†æ¯å°æœºå™¨è¿‡åº¦é…ç½®å†…å­˜å®¹é‡çš„éœ€æ±‚ã€‚è®¿é—®è¿œç¨‹é¡µé¢éœ€è¦ä¸€åˆ°æ•°åå¾®ç§’çš„æ—¶é—´ï¼Œå…·ä½“å–å†³äºé›†ç¾¤å¤§å°å’Œç½‘ç»œç»“æ„é€Ÿåº¦ã€‚åœ¨ WSC çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œè¿œç¨‹å†…å­˜æœ‰ä¸€äº›æœ‰è¶£çš„æŒ‘æˆ˜éœ€è¦è§£å†³ï¼Œç„¶åæ‰èƒ½éƒ¨ç½²ä»¥å®ç°å†…å­˜ TCO èŠ‚çœ[6]ã€‚é¦–å…ˆï¼Œå°†å†…å­˜é¡µé¢äº¤æ¢åˆ°è¿œç¨‹æœºå™¨ä¼šæ‰©å¤§æ¯å°æœºå™¨çš„æ•…éšœåŸŸï¼Œä½¿é›†ç¾¤æ›´å®¹æ˜“å—åˆ°ç¾éš¾æ€§æ•…éšœçš„å½±å“ã€‚å…¶æ¬¡ï¼Œåœ¨ç¦»å¼€æœºå™¨ä¹‹å‰ï¼Œå¿…é¡»å¯¹æ­£åœ¨äº¤æ¢çš„é¡µé¢è¿›è¡ŒåŠ å¯†ï¼Œä»¥ç¬¦åˆ WSC åº”ç”¨ç¨‹åºå¤„ç†æ•æ„Ÿä¿¡æ¯æ—¶é€šå¸¸è®¾å®šçš„ä¸¥æ ¼å®‰å…¨è¦æ±‚ã€‚ç¬¬ä¸‰ï¼Œè®¸å¤š WSC åº”ç”¨ç¨‹åºå¯¹å°¾éƒ¨å»¶è¿Ÿæ•æ„Ÿ[7]ï¼Œä½†å¯¹äºé›†ç¾¤æˆ–æœºæ¶æ¥è¯´ï¼Œé™åˆ¶å°¾éƒ¨å»¶è¿Ÿæ¯”å¯¹å•å°æœºå™¨æ›´éš¾ã€‚ è¿œç«¯å†…å­˜ï¼šå®¹é”™æ€§ï¼Ÿå®‰å…¨æ€§ï¼Ÿ ","date":"2024-10-30","objectID":"/posts/paper-far-memory/:4:1","tags":["Paper Reading"],"title":"Paper Reading: Software-Defined Far Memory in Warehouse-Scale Computers","uri":"/posts/paper-far-memory/"},{"categories":null,"content":"Far Memory in a Real-World WSC: Opportunities and Challenges æœ‰è®¸å¤šæ–¹æ³•å¯ä»¥å®šä¹‰å†…å­˜é¡µçš„å†·åº¦ã€‚æˆ‘ä»¬å…³æ³¨åŸºäºä»¥ä¸‹ä¸¤ä¸ªåŸåˆ™çš„å®šä¹‰ï¼šï¼ˆ1ï¼‰é€šè¿‡å°†è¶…è¿‡ T ç§’æœªè®¿é—®çš„å†…å­˜é¡µåˆ†ç±»ä¸ºå†·é¡µï¼Œæ¥ä½“ç°æ—¶é—´å±€éƒ¨æ€§çš„ä»·å€¼ï¼›ï¼ˆ2ï¼‰é€šè¿‡æµ‹é‡å¯¹å†·å†…å­˜é¡µçš„è®¿é—®é€Ÿç‡ï¼ˆç§°ä¸ºæå‡ç‡ï¼‰ï¼Œä½œä¸ºè¿œç«¯å†…å­˜å¯¹åº”ç”¨ç¨‹åºå½±å“çš„ä»£ç†ã€‚è¿™ä¸¤ä¸ªåŸåˆ™æ˜¯æˆ‘ä»¬å†·é¡µè¯†åˆ«æœºåˆ¶çš„åŸºçŸ³ï¼ˆåœ¨ç¬¬ 4 èŠ‚ä¸­è§£é‡Šï¼‰ã€‚ å›¾ 1 æ˜¾ç¤ºäº†åœ¨ä¸åŒ T å€¼ä¸‹ï¼ŒWSC ä¸­è¿è¡Œçš„æ¯ä¸ªä½œä¸šçš„å†·å†…å­˜ç™¾åˆ†æ¯”å’Œæå‡ç‡çš„æœºç¾¤èŒƒå›´å¹³å‡å€¼ã€‚ç”±äºè¾ƒä½çš„ T å€¼ä¼šåœ¨å†…å­˜é¡µç”Ÿå‘½å‘¨æœŸçš„è¾ƒæ—©é˜¶æ®µå°†å…¶åˆ†ç±»ä¸ºå†·é¡µï¼Œå› æ­¤å®ƒä¼šè¯†åˆ«æ›´å¤šçš„å†·é¡µã€‚åœ¨æœ€æ¿€è¿›çš„è®¾ç½® T = 120 ç§’æ—¶ï¼Œæˆ‘ä»¬è§‚å¯Ÿåˆ°å¹³å‡ 32% çš„å†…å­˜ä½¿ç”¨æ˜¯å†·çš„ã€‚è¿™ä¸€å¤§æ¯”ä¾‹çš„å†·å†…å­˜å±•ç¤ºäº†è¿œç«¯å†…å­˜åœ¨çœŸå®ä¸–ç•Œ WSC ä¸­çš„å·¨å¤§æ½œåŠ›ã€‚ å¦ä¸€æ–¹é¢ï¼Œéšç€ç³»ç»Ÿåœ¨è¯†åˆ«å†·å†…å­˜æ–¹é¢å˜å¾—æ›´åŠ æ¿€è¿›ï¼Œè¿œç«¯å†…å­˜çš„æ€§èƒ½å¼€é”€ä¹Ÿä¼šå¢åŠ ã€‚åœ¨ T = 120 ç§’æ—¶ï¼Œåº”ç”¨ç¨‹åºå¹³å‡æ¯åˆ†é’Ÿè®¿é—®å…¶æ€»å†·å†…å­˜çš„ 15%ã€‚æ ¹æ®è¿‘ç«¯å†…å­˜å’Œè¿œç«¯å†…å­˜ä¹‹é—´çš„ç›¸å¯¹æ€§èƒ½å·®å¼‚ï¼Œè¿™ä¸€è®¿é—®ç‡å¯èƒ½ä¼šæ˜¾è‘—é™ä½åº”ç”¨ç¨‹åºæ€§èƒ½ï¼ŒæŠµæ¶ˆè¿œç«¯å†…å­˜çš„ TCO èŠ‚çœã€‚ å†·å†…å­˜ç™¾åˆ†æ¯”ä¸æ€§èƒ½å¼€é”€ä¹‹é—´çš„è¿™ç§æƒè¡¡å…³ç³»ä¿ƒä½¿éœ€è¦ä¸€ä¸ªå¼ºå¤§çš„æ§åˆ¶ç®—æ³•ï¼Œè¯¥ç®—æ³•å¯ä»¥åœ¨æœ€å¤§åŒ–å‰è€…çš„åŒæ—¶æœ€å°åŒ–åè€…ã€‚åœ¨æœ¬å°èŠ‚çš„å…¶ä½™éƒ¨åˆ†ï¼Œä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬å°†å‡è®¾ T = 120 ç§’ã€‚ å›¾ 2 å±•ç¤ºäº†åœ¨ 10 ä¸ªé›†ç¾¤ä¸­æ¯å°æœºå™¨çš„å†·å†…å­˜ç™¾åˆ†æ¯”åˆ†å¸ƒï¼ˆå³å†·å†…å­˜æ€»å¤§å°é™¤ä»¥æ¯å°æœºå™¨çš„å†…å­˜ä½¿ç”¨é‡ï¼‰ï¼Œ**æ¯ä¸ªé›†ç¾¤æœ€å¤šåŒ…å«æ•°ä¸‡å°æœºå™¨ã€‚**æˆ‘ä»¬å‘ç°ï¼Œå³ä½¿åœ¨åŒä¸€é›†ç¾¤å†…ï¼Œå†·å†…å­˜ç™¾åˆ†æ¯”ä¹Ÿä» 1% åˆ° 52% ä¸ç­‰ã€‚å¦‚æœæˆ‘ä»¬å°†æ¯å°æœºå™¨çš„è¿œç«¯å†…å­˜å®¹é‡é…ç½®ä¸ºæ€»å†…å­˜å®¹é‡çš„ 20%ï¼Œé‚£ä¹ˆä¸€äº›æœºå™¨å°†æœ‰æ¯”å¯ç”¨è¿œç«¯å†…å­˜å®¹é‡å¤š 30%çš„å†·å†…å­˜ã€‚å¦ä¸€æ–¹é¢ï¼Œé…ç½®ä¸º 50% å°†å¯¼è‡´ä¸€äº›æœºå™¨çš„è¿‘ç«¯å†…å­˜å®¹é‡ä¸è¶³ï¼Œå¯¼è‡´è¿‡å¤šçš„æ€§èƒ½å¼€é”€ã€‚ä» TCO çš„è§’åº¦æ¥çœ‹ï¼Œè¿™ä¸¤ç§æ–¹æ³•éƒ½ä¸ç†æƒ³ã€‚ æ­¤å¤–ï¼Œåº”ç”¨ç¨‹åºè¡Œä¸ºå¢åŠ äº†å¦ä¸€ä¸ªç»´åº¦çš„å¯å˜æ€§ã€‚å›¾ 3 æè¿°äº†æ¯ä¸ªä½œä¸šä¸­å†·å†…å­˜ç™¾åˆ†æ¯”çš„åˆ†å¸ƒï¼ˆåœ¨ä½œä¸šæ‰§è¡Œè¿‡ç¨‹ä¸­å¹³å‡ï¼‰ã€‚å¯¹äºå‰ 10%çš„ä½œä¸šï¼Œè‡³å°‘ 43%çš„å†…å­˜ä½¿ç”¨æ˜¯å†·çš„ï¼›å¯¹äºå 10%çš„ä½œä¸šï¼Œè¿™ä¸€æ¯”ä¾‹é™è‡³ä½äº 9%ã€‚è¿™ç§å¼‚è´¨æ€§ï¼ŒåŠ ä¸Šç°ä»£ WSC ä¸Šè¿è¡Œçš„å¤§é‡ä½œä¸šï¼Œä½¿å¾—ä¸ºæ¯ä¸ªåº”ç”¨ç¨‹åºä¼˜åŒ–è¿œç«¯å†…å­˜å˜å¾—ä¸åˆ‡å®é™…ã€‚ æ€»ä¹‹ï¼Œå°†å†·å†…å­˜å­˜å‚¨åˆ°æ›´ä¾¿å®œä½†é€Ÿåº¦è¾ƒæ…¢çš„è¿œç«¯å†…å­˜å…·æœ‰åœ¨ WSC ä¸­èŠ‚çœ TCO çš„å·¨å¤§æ½œåŠ›ã€‚ä½†è¦å®ç°è¿™ä¸€ç‚¹ï¼Œç³»ç»Ÿå¿…é¡»ï¼ˆ1ï¼‰èƒ½å¤Ÿå‡†ç¡®æ§åˆ¶å…¶æ¿€è¿›ç¨‹åº¦ï¼Œä»¥æœ€å°åŒ–å¯¹åº”ç”¨ç¨‹åºæ€§èƒ½çš„å½±å“ï¼›ï¼ˆ2ï¼‰èƒ½å¤Ÿé€‚åº”ä¸åŒæœºå™¨ã€é›†ç¾¤å’Œä½œä¸šä¹‹é—´å†·å†…å­˜è¡Œä¸ºçš„å¯å˜æ€§ã€‚ ","date":"2024-10-30","objectID":"/posts/paper-far-memory/:4:2","tags":["Paper Reading"],"title":"Paper Reading: Software-Defined Far Memory in Warehouse-Scale Computers","uri":"/posts/paper-far-memory/"},{"categories":null,"content":"Software-defined Far Memory We show a software-defined approach to far memory implementation, which we have adopted and deployed at Google. ç‰¹åˆ«æ˜¯ï¼Œæˆ‘ä»¬æè®®é‡‡ç”¨ zswap [1]ä½œä¸ºç°æˆçš„è¿œç«¯å†…å­˜è§£å†³æ–¹æ¡ˆã€‚åœ¨ Linux å†…æ ¸ï¼ˆ3.11+ï¼‰ä¸­ï¼Œzswap ä½œä¸ºä¸€ä¸ªäº¤æ¢è®¾å¤‡ï¼Œæ—¨åœ¨é¿å…æœºå™¨å†…å­˜è€—å°½ã€‚ zswap åœ¨æ‰‹æœºç«¯ä½¿ç”¨æ¯”è¾ƒå¸¸è§ï¼Œç»å¸¸ç”¨äºå†…å­˜å‹ç¼©ä¿ç•™æ›´å¤šçš„ RAMï¼Œæ¯”å¦‚ä¸€ä¸ªåº”ç”¨æœ€è¿‘å¾ˆå°‘ä½¿ç”¨çš„é¡µé¢ï¼Œå¯ä»¥è¢«å‹ç¼©é‡Šæ”¾ï¼ŒèŠ‚çœå†…å­˜ é™¤äº†å‹ç¼©ï¼Œä¹Ÿç”¨äº swapï¼Œå‹ç¼©é¡µåˆ°å‹ç¼©æ± è€Œä¸æ˜¯æ”¾å›ç£ç›˜ï¼Œç­‰ä¸‹æ¬¡è®¿é—®è§£å‹ç¼©æ”¾å›å†…å­˜ï¼Œå‡å°‘ç£ç›˜ IO ä½¿ç”¨ lzo, zstd ç­‰å‹ç¼©ç®—æ³•ï¼Œ ç”¨æ—¶é—´æ¢ç©ºé—´å’Œæˆæœ¬çš„æ„æ€ï¼Ÿ ç›¸åï¼Œæˆ‘ä»¬é‡‡å–äº†ä¸€ç§ä¸»åŠ¨çš„æ–¹æ³•ï¼Œä½¿ç”¨ zswap åœ¨å†…å­˜ä¸­å­˜å‚¨å†·å‹ç¼©é¡µï¼Œå¹¶åœ¨è½¯ä»¶ä¸­å®ç°è¿œç«¯å†…å­˜ã€‚å‹ç¼©å†…å­˜é¡µå…è®¸æˆ‘ä»¬åœ¨å†…å­˜ä¸­æ‰“åŒ…æ›´å¤šæ•°æ®ï¼ˆå³æ¯ GB æˆæœ¬æ›´ä½ï¼‰ï¼Œä»£ä»·æ˜¯å¢åŠ è®¿é—®æ—¶é—´ã€‚ä» TCO çš„è§’åº¦æ¥çœ‹ï¼Œè¿™ä¸ä»»ä½•å…¶ä»–è¿œç«¯å†…å­˜å®ç°æ²¡æœ‰æœ¬è´¨åŒºåˆ«ã€‚ ","date":"2024-10-30","objectID":"/posts/paper-far-memory/:5:0","tags":["Paper Reading"],"title":"Paper Reading: Software-Defined Far Memory in Warehouse-Scale Computers","uri":"/posts/paper-far-memory/"},{"categories":null,"content":"Advantages of Software-defined Far Memory Reliability zswap å°†æ•…éšœåŸŸé™åˆ¶åœ¨ä¸€å°æœºå™¨å†…ï¼Œå°†ç¾éš¾æ€§æ•…éšœé™åˆ¶åœ¨å•å°æœºå™¨ä¸Šï¼ŒåŒæ—¶é¿å…äº†è¿œç¨‹å†…å­˜çš„å®‰å…¨æ€§å’Œå¯é æ€§æŒ‘æˆ˜ã€‚æ­¤å¤–ï¼Œå®ƒä¸å¼•å…¥é¢å¤–çš„ç¡¬ä»¶ç»„ä»¶ï¼Œç®€åŒ–äº†ç³»ç»Ÿè®¾è®¡ã€å®ç°ã€æµ‹è¯•ã€éƒ¨ç½²å’Œç›‘æ§ã€‚ Time to deployment zswap ä½œä¸ºä¸€ç§è½¯ä»¶æ–¹æ³•ï¼Œå¯ä»¥ä»¥æ›´çŸ­çš„æ—¶é—´å’Œæ›´ä½çš„æˆæœ¬éƒ¨ç½²ï¼Œå¹¶ä¸”ä¸éœ€è¦è·¨ä¾›åº”å•†åˆä½œï¼Œå› ä¸ºä¸éœ€è¦ä»»ä½•ç‰¹æ®Šç¡¬ä»¶ï¼ˆä¾‹å¦‚ NVMï¼‰ è¯·æ³¨æ„ï¼Œéƒ¨ç½²é€Ÿåº¦å¯¹äº WSC è‡³å…³é‡è¦ No new hardware cost ä¸å…¶ä»–è¿œç«¯å†…å­˜æŠ€æœ¯ä¸åŒï¼Œzswap é€šè¿‡ç”¨ CPU å‘¨æœŸï¼ˆç”¨äºå‹ç¼©å’Œè§£å‹ç¼©ï¼‰æ¢å–å†…å­˜èŠ‚çœã€‚ Adaptive to dynamic application behavior WSC ä¸­å·¥ä½œè´Ÿè½½æ··åˆå’Œå†…å­˜è®¿é—®æ¨¡å¼çš„å˜åŒ–ï¼ˆç¬¬ 2.2 èŠ‚ï¼‰å¯¼è‡´æ¯å°æœºå™¨å’Œè·¨æœºå™¨çš„å†·å†…å­˜å¤§å°å‘ç”Ÿå˜åŒ–ã€‚zswap å¯ä»¥é€šè¿‡åŠ¨æ€è°ƒæ•´åˆ†é…ç»™ä½œä¸šçš„å†…å­˜å®¹é‡ï¼ˆé€šè¿‡å‹ç¼©æ›´å¤šæˆ–æ›´å°‘çš„å†…å­˜ï¼‰æ¥é€‚åº”è¿™ç§å˜åŒ–ã€‚å³ä½¿åœ¨å¦‚æ­¤åŠ¨æ€çš„æƒ…å†µä¸‹ï¼Œzswap ä»ç„¶å¯ä»¥å®ç°å†…å­˜ CapEx èŠ‚çœï¼Œå› ä¸ºå¹³å‡è·¨æ•°ä¸‡å°æœºå™¨ä½¿å†…å­˜èŠ‚çœåœ¨é›†ç¾¤çº§åˆ«ç¨³å®šï¼Œè¿™æ˜¯æˆ‘ä»¬é…ç½®å®¹é‡çš„æ–¹å¼ï¼ˆç¬¬ 6.1 èŠ‚ï¼‰ã€‚è¿™ä½¿å¾— zswap ä¸é‚£äº›ä¸€æ—¦éƒ¨ç½²å®¹é‡å°±éš¾ä»¥æ”¹å˜çš„è¿œç«¯å†…å­˜è§£å†³æ–¹æ¡ˆæœ‰æ‰€ä¸åŒã€‚æ­¤å¤–ï¼Œå®ƒè¿˜ä½¿å¾—åœ¨ä¸æ”¹å˜ç¡¬ä»¶é…ç½®çš„æƒ…å†µä¸‹ï¼Œæ›´å¿«åœ°å°è¯•ä¸åŒè®¾ç½®æˆä¸ºå¯èƒ½ã€‚ ç¼ºç‚¹å‘¢ï¼Ÿ å¹³å¸¸ç©ºé—²çš„æœºå™¨æ— æ³•åº”å¯¹çªå‘è´Ÿè½½ï¼Ÿç¨³å®šæ€§ï¼Ÿ ","date":"2024-10-30","objectID":"/posts/paper-far-memory/:5:1","tags":["Paper Reading"],"title":"Paper Reading: Software-Defined Far Memory in Warehouse-Scale Computers","uri":"/posts/paper-far-memory/"},{"categories":null,"content":"Challenges in Software-defined Far Memory WSC ä¸­è¿œç«¯å†…å­˜çš„æ§åˆ¶æœºåˆ¶éœ€è¦ï¼ˆ1ï¼‰ä¸¥æ ¼æ§åˆ¶æ€§èƒ½å‡é€Ÿä»¥æ»¡è¶³å®šä¹‰çš„ SLOï¼Œä»¥åŠï¼ˆ2ï¼‰ä½ CPU å¼€é”€ï¼Œä»¥ä¾¿æœ€å¤§åŒ–ä»è¿œç«¯å†…å­˜è·å¾—çš„ TCO èŠ‚çœã€‚å°½ç®¡ zswap åœ¨ WSC çš„è¿œç«¯å†…å­˜è®¾è®¡ä¸­è¡¨ç°å‡ºæœ‰åˆ©çš„ç‰¹æ€§ï¼Œä½†å…¶æ§åˆ¶å¹³é¢å¹¶ä¸æ»¡è¶³ä¸Šè¿°æ ‡å‡†ã€‚è¿™æ˜¯å› ä¸º Linux å†…æ ¸ä¸­çš„ zswap åœ¨å¯ç”¨æ—¶ä»…åœ¨ç›´æ¥å›æ”¶ï¼ˆå³å½“ä¸»æœºå†…å­˜èŠ‚ç‚¹è€—å°½å†…å­˜æ—¶ï¼‰æ—¶è§¦å‘ï¼Œå¹¶å°è¯•å‹ç¼©é¡µé¢ç›´åˆ°æœ‰è¶³å¤Ÿçš„ç©ºé—´é¿å…å†…å­˜ä¸è¶³çš„æƒ…å†µï¼Œä»è€Œæš‚åœåº”ç”¨ç¨‹åºçš„åˆ†é…ã€‚è¿™ç§æœºåˆ¶å­˜åœ¨ä»¥ä¸‹ç¼ºç‚¹ï¼šï¼ˆ1ï¼‰ç”±äº zswap è§£å‹ç¼©å¯¼è‡´çš„æ€§èƒ½å¼€é”€æ˜¯æ— é™çš„ï¼Œï¼ˆ2ï¼‰æœ€åä¸€åˆ»çš„çªå‘å‹ç¼©å¼€é”€å¯¹å°¾éƒ¨å»¶è¿Ÿäº§ç”Ÿè´Ÿé¢å½±å“ï¼ŒæŸå®³ WSC åº”ç”¨ç¨‹åºçš„æœåŠ¡çº§åˆ«æŒ‡æ ‡ï¼ˆSLIï¼‰ï¼Œä»¥åŠï¼ˆ3ï¼‰å†…å­˜èŠ‚çœç›´åˆ°æœºå™¨å®Œå…¨é¥±å’Œæ—¶æ‰å®ç°ã€‚äº‹å®ä¸Šï¼Œæˆ‘ä»¬åœ¨éƒ¨ç½²è¿‡ç¨‹ä¸­ç¡®å®è¯„ä¼°äº†è¿™ç§æ–¹æ³•ï¼Œä½†è§‚å¯Ÿåˆ°åº”ç”¨ç¨‹åºæ€§èƒ½çš„æ˜¾è‘—ä¸‹é™ï¼Œå¯¹ TCO äº§ç”Ÿäº†è´Ÿé¢å½±å“ã€‚ æ­¤å¤–ï¼ŒWSC çš„ DRAM ä¸­çš„æ¯ä¸€æ¡æ•°æ®å¹¶ä¸éƒ½é€‚åˆé€šè¿‡å‹ç¼©æ¥èŠ‚çœï¼Œå½“ zswap é€‰æ‹©å‹ç¼©è¿™äº›æ•°æ®æ—¶ï¼Œä¼šå¯¼è‡´æµªè´¹çš„å‘¨æœŸæœºä¼šæˆæœ¬ã€‚ä¾‹å¦‚ï¼Œå†…å­˜ä¸­çš„è§†é¢‘æ•°æ®å¯èƒ½ä¸åƒæ–‡æœ¬æ•°æ®é‚£æ ·å¯å‹ç¼©ã€‚ æœ‰äº›ä¸èƒ½å‹ç¼©ï¼Ÿ å› æ­¤ï¼Œåœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ªç«¯åˆ°ç«¯çš„ä»“åº“çº§ç³»ç»Ÿï¼Œè¯¥ç³»ç»Ÿè¯†åˆ«å†·é¡µå¹¶ä¸»åŠ¨å°†å…¶è¿ç§»åˆ°è¿œç«¯å†…å­˜ï¼ŒåŒæ—¶å°†æ€§èƒ½è§†ä¸ºé¦–è¦çº¦æŸã€‚å…³é”®é—®é¢˜æ˜¯å†·é¡µæœ‰å¤šå†·ï¼Ÿæˆ–è€…å†·é¡µçš„å®šä¹‰æ˜¯ä»€ä¹ˆï¼Ÿå†·é¡µè¯†åˆ«ç®—æ³•çš„è´¨é‡å°†å½±å“å†…å­˜èŠ‚çœå’Œåº”ç”¨ç¨‹åºå½±å“ã€‚ ","date":"2024-10-30","objectID":"/posts/paper-far-memory/:5:2","tags":["Paper Reading"],"title":"Paper Reading: Software-Defined Far Memory in Warehouse-Scale Computers","uri":"/posts/paper-far-memory/"},{"categories":null,"content":"Cold Page Identification Mechanism æˆ‘ä»¬çš„ç›®æ ‡æ˜¯è®¾è®¡ä¸€ä¸ªå¼ºå¤§ä¸”æœ‰æ•ˆçš„æ§åˆ¶å¹³é¢ï¼Œç”¨äºå¤§è§„æ¨¡éƒ¨ç½² zswapã€‚ä¸ Linux å†…æ ¸ä¸­çš„ zswap æˆ–å…¶ä»–äº¤æ¢æœºåˆ¶ä¸€æ ·ï¼Œæˆ‘ä»¬çš„ç³»ç»Ÿåœ¨è¿ç§»è¿‘ç«¯å†…å­˜ï¼ˆä¾‹å¦‚ï¼ŒDRAMï¼‰å’Œè¿œç«¯å†…å­˜ï¼ˆä¾‹å¦‚ï¼Œzswapï¼‰ä¹‹é—´çš„é¡µé¢æ—¶ï¼Œä»¥æ“ä½œç³»ç»Ÿé¡µé¢ç²’åº¦å·¥ä½œã€‚è¿™ä½¿å¾—æ— éœ€ç¡¬ä»¶ä¿®æ”¹å³å¯é‡‡ç”¨è¿œç«¯å†…å­˜ã€‚ ä¸ç°æœ‰ zswap æœºåˆ¶çš„ä¸»è¦åŒºåˆ«åœ¨äºä½•æ—¶å‹ç¼©é¡µé¢ï¼Œæˆ–ä½•æ—¶å°†é¡µé¢ä»è¿‘ç«¯å†…å­˜è¿ç§»åˆ°è¿œç«¯å†…å­˜ã€‚ä¸ Linux å†…æ ¸ä¸­çš„ zswap ä¸åŒï¼Œæˆ‘ä»¬çš„ç³»ç»Ÿåœ¨åå°è¯†åˆ«å†·å†…å­˜é¡µå¹¶ä¸»åŠ¨å‹ç¼©å®ƒä»¬ï¼Œä»¥ä¾¿é¢å¤–çš„ç©ºé—²å†…å­˜å¯ä»¥ç”¨äºè°ƒåº¦æ›´å¤šä½œä¸šåˆ°æœºå™¨ä¸Šã€‚ä¸€æ—¦è®¿é—®å‹ç¼©é¡µé¢ï¼Œzswap ä¼šè§£å‹ç¼©é¡µé¢å¹¶å°†å…¶ä¿æŒåœ¨è§£å‹ç¼©çŠ¶æ€ï¼Œä»¥é¿å…åå¤äº§ç”Ÿè§£å‹ç¼©å¼€é”€ã€‚è¿™äº›é¡µé¢åœ¨å°†æ¥å˜å†·æ—¶å†æ¬¡æœ‰èµ„æ ¼è¿›è¡Œå‹ç¼©ã€‚ å‹ç¼©çš„æ˜¯å†·é¡µé¢ï¼Œ å¤šå‡ºæ¥çš„å†…å­˜ç»™è°ç”¨å‘¢ï¼Ÿ ","date":"2024-10-30","objectID":"/posts/paper-far-memory/:6:0","tags":["Paper Reading"],"title":"Paper Reading: Software-Defined Far Memory in Warehouse-Scale Computers","uri":"/posts/paper-far-memory/"},{"categories":null,"content":"Definition of Cold Pages æˆ‘ä»¬çš„ç³»ç»Ÿæ ¹æ®æ¯ä¸ªé¡µé¢ä¸Šæ¬¡è®¿é—®åçš„æ—¶é—´ï¼ˆç®€ç§°ä¸º ageï¼‰æ¥è¯†åˆ«å†·é¡µã€‚å½“é¡µé¢è¶…è¿‡ T ç§’æœªè¢«è®¿é—®æ—¶ï¼Œå®ƒè¢«è®¤ä¸ºæ˜¯å†·çš„ã€‚æˆ‘ä»¬ç§° T ä¸º cold age thresholdï¼Œå®ƒå†³å®šäº†ç³»ç»Ÿè¯†åˆ«å†·å†…å­˜é¡µçš„æ¿€è¿›ç¨‹åº¦ã€‚æˆ‘ä»¬åŸºäºå…ˆå‰çš„å·¥ä½œ[28, 42, 46]è®¾è®¡äº†è¿™ä¸€æœºåˆ¶ã€‚ å†·å¹´é¾„é˜ˆå€¼å¯¹å†…å­˜èŠ‚çœå’Œæ€§èƒ½å¼€é”€æœ‰ç›´æ¥å½±å“ã€‚è¿‡æ—©åœ°å°†é¡µé¢åˆ†ç±»ä¸ºå†·é¡µå¯èƒ½ä¼šå°†å®ƒä»¬æ˜ å°„åˆ°è¿œç«¯å†…å­˜ï¼Œå¯¼è‡´æ€§èƒ½ä¸‹é™ã€‚æˆ‘ä»¬çš„ç³»ç»Ÿè¯•å›¾æ‰¾åˆ°æ»¡è¶³ç»™å®šæ€§èƒ½çº¦æŸçš„æœ€ä½å†·å¹´é¾„é˜ˆå€¼ï¼Œä»¥ä¾¿åœ¨æ˜ç¡®å®šä¹‰çš„ SLO ä¸‹æœ€å¤§åŒ–å†…å­˜èŠ‚çœï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹æ–‡è®¨è®ºè¿™ä¸€ç‚¹ã€‚ T æ€ä¹ˆæ‰¾ï¼Œå’Œ SLO æœ‰å…³ï¼Ÿ ","date":"2024-10-30","objectID":"/posts/paper-far-memory/:6:1","tags":["Paper Reading"],"title":"Paper Reading: Software-Defined Far Memory in Warehouse-Scale Computers","uri":"/posts/paper-far-memory/"},{"categories":null,"content":"Performance SLO for Far Memory åœ¨ WSC ç¯å¢ƒä¸­ï¼Œç›´æ¥å…³è”å†·å†…å­˜é˜ˆå€¼å¯¹åº”ç”¨ç¨‹åºæ€§èƒ½çš„å½±å“æ˜¯å…·æœ‰æŒ‘æˆ˜æ€§çš„ï¼Œå› ä¸ºä¸åŒåº”ç”¨ç¨‹åºçš„æ€§èƒ½æŒ‡æ ‡å…·æœ‰å¤šæ ·æ€§ï¼Œè¿™äº›æŒ‡æ ‡æœ¬èº«å¯èƒ½ä»å»¶è¿Ÿæ•æ„Ÿï¼ˆä¾‹å¦‚ï¼Œé¢å‘ç”¨æˆ·çš„ç½‘é¡µå‰ç«¯ï¼‰åˆ°ååé‡å¯¼å‘ï¼ˆä¾‹å¦‚ï¼Œæœºå™¨å­¦ä¹ è®­ç»ƒç®¡é“ï¼‰ä¸ç­‰ã€‚ Promotion rate è¿œç«¯å†…å­˜çš„æ€§èƒ½å¼€é”€æ¥è‡ªäºè®¿é—®å­˜å‚¨åœ¨è¿œç«¯å†…å­˜ä¸­çš„é¡µé¢ï¼ˆæˆ‘ä»¬ç§°è¿™ç§æ“ä½œä¸ºæå‡ï¼‰ï¼Œç”±äºè¿œç«¯å†…å­˜ä¸­çš„é¡µé¢ä¸€æ—¦è¢«è®¿é—®å°±ä¼šè¿ç§»åˆ°è¿‘ç«¯å†…å­˜ï¼Œæå‡ç‡ç­‰åŒäºå•ä½æ—¶é—´å†…è®¿é—®çš„è¿œç«¯å†…å­˜ä¸­å”¯ä¸€é¡µé¢çš„æ•°é‡ã€‚ Target promotion rate ä¸åŒçš„åº”ç”¨ç¨‹åºå¯¹æå‡ç‡çš„æ€§èƒ½æ•æ„Ÿåº¦ä¸åŒã€‚ä¾‹å¦‚ï¼Œåœ¨ç›¸åŒçš„ç»å¯¹æå‡ç‡æ°´å¹³ä¸‹ï¼Œå°ä½œä¸šæ¯”å¤§ä½œä¸šæ›´æœ‰å¯èƒ½ç»å†æ›´é«˜çš„æ€§èƒ½å¼€é”€ï¼Œå› ä¸ºå‰è€…å¯èƒ½å…·æœ‰æ›´é«˜çš„è¿œç«¯å†…å­˜è®¿é—®æ¯”ä¾‹ã€‚è¿™éœ€è¦ä¸€ç§æ–¹æ³•æ¥é€šè¿‡ä»£è¡¨æ¯ä¸ªä½œä¸šâ€œå¤§å°â€çš„æŒ‡æ ‡æ¥å½’ä¸€åŒ–ç»å¯¹æå‡ç‡ã€‚ ä¸ºä»€ä¹ˆå°ä½œä¸šå¯èƒ½æ›´é«˜æ€§èƒ½å¼€é”€ï¼Ÿä¸ºä»€ä¹ˆå…·æœ‰æ›´é«˜çš„è¿œç«¯å†…å­˜è®¿é—®æ¯”ä¾‹ï¼Œæ˜¯ä¸ª rateï¼Ÿ å› æ­¤ï¼Œæˆ‘ä»¬è®¾è®¡æˆ‘ä»¬çš„ç³»ç»Ÿï¼Œä½¿æå‡ç‡ä¿æŒåœ¨æ¯åˆ†é’Ÿåº”ç”¨ç¨‹åºå·¥ä½œé›†å¤§å°çš„ P% ä»¥ä¸‹ï¼Œè¿™ä½œä¸ºè¿œç«¯å†…å­˜æ€§èƒ½çš„æœåŠ¡çº§åˆ«ç›®æ ‡ï¼ˆSLOï¼‰ã€‚ æˆ‘ä»¬å°†åº”ç”¨ç¨‹åºçš„å·¥ä½œé›†å¤§å°å®šä¹‰ä¸ºåœ¨æœ€å°å†·å¹´é¾„é˜ˆå€¼ï¼ˆåœ¨æˆ‘ä»¬çš„ç³»ç»Ÿä¸­ä¸º 120 ç§’ï¼‰å†…è®¿é—®çš„æ€»é¡µé¢æ•°ã€‚æ¯åˆ†é’Ÿçš„å·¥ä½œé›†å¤§å°ä½œä¸ºä½œä¸šå†…å­˜å¸¦å®½ä½¿ç”¨çš„ä»£ç†ï¼Œæ ¹æ®æˆ‘ä»¬çš„è¯„ä¼°ï¼Œè¿™ä¸ä½œä¸šå¯¹è¿œç«¯å†…å­˜è®¿é—®çš„æ€§èƒ½æ•æ„Ÿåº¦ç›¸å…³ã€‚æˆ‘ä»¬çš„ SLO ç¡®ä¿åº”ç”¨ç¨‹åºçš„å·¥ä½œé›†ä¸è¶…è¿‡ P%æ¥è‡ªè¿œç«¯å†…å­˜ï¼Œä»è€Œé™åˆ¶è¿œç«¯å†…å­˜çš„æ€§èƒ½å¼€é”€ã€‚P çš„ç¡®åˆ‡å€¼å–å†³äºè¿‘ç«¯å†…å­˜å’Œè¿œç«¯å†…å­˜ä¹‹é—´çš„æ€§èƒ½å·®å¼‚ã€‚å¯¹äºæˆ‘ä»¬çš„éƒ¨ç½²ï¼Œæˆ‘ä»¬è¿›è¡Œäº†ä¸ºæœŸæ•°æœˆçš„ A/B æµ‹è¯•ï¼Œå¹¶åœ¨ç”Ÿäº§å·¥ä½œè´Ÿè½½ä¸­é€šè¿‡ç»éªŒç¡®å®š P ä¸º 0.2% / minã€‚åœ¨è¿™ä¸ªç›®æ ‡æå‡ç‡æ°´å¹³ä¸‹ï¼Œä½œä¸šçš„å‹ç¼©/è§£å‹ç¼©ç‡è¶³å¤Ÿä½ï¼Œä¸ä¼šå¹²æ‰°åŒä¸€æœºå™¨ä¸Šçš„å…¶ä»–å…±å­˜ä½œä¸šã€‚ cold memory è¶Šå¤§ promotion rate è¶Šå¤§ï¼Œ promotion rateï¼šè®¿é—®è¿œç«¯ cold memory çš„é¢‘ç‡ å¼ºåˆ¶æå‡ç‡ä½äºç›®æ ‡å€¼å¯ä»¥é˜²æ­¢åº”ç”¨ç¨‹åºçš„çªå‘è§£å‹ç¼©ï¼Œå› ä¸ºä»å®šä¹‰ä¸Šé™åˆ¶äº†è§£å‹ç¼©é€Ÿç‡ã€‚åœ¨æå°‘æ•°æƒ…å†µä¸‹ï¼Œå¦‚æœæ¿€è¿›æˆ–ç›¸å…³çš„è§£å‹ç¼©çªå‘å¯¼è‡´æœºå™¨å› è§£å‹ç¼©å‹ç¼©é¡µé¢è€Œè€—å°½å†…å­˜ï¼Œæˆ‘ä»¬é€šè¿‡æ€æ­»å¹¶é‡æ–°è°ƒåº¦å…¶ä»–æœºå™¨ä¸Šçš„ä½ä¼˜å…ˆçº§ä½œä¸šæ¥é€‰æ‹©æ€§ eviction ã€‚æˆ‘ä»¬çš„ WSC æ§åˆ¶å¹³é¢[40]ä¸ºç”¨æˆ·æä¾›äº†ä¸€ä¸ª eviction SLOï¼Œåœ¨ 18 ä¸ªæœˆçš„å®é™…ç”Ÿäº§ä¸­ä»æœªè¢«è¿åï¼ŒåŒæ—¶æˆ‘ä»¬å®ç°äº†å†…å­˜èŠ‚çœã€‚ ","date":"2024-10-30","objectID":"/posts/paper-far-memory/:6:2","tags":["Paper Reading"],"title":"Paper Reading: Software-Defined Far Memory in Warehouse-Scale Computers","uri":"/posts/paper-far-memory/"},{"categories":null,"content":"Controlling the Cold Age Threshold ä¸ºäº†ç¡®å®šæ»¡è¶³æå‡ç‡ SLO çš„æœ€ä½ Cold Age Thresholdï¼Œæˆ‘ä»¬ä¼°è®¡åº”ç”¨ç¨‹åºåœ¨ä¸åŒå†·å¹´é¾„é˜ˆå€¼ä¸‹çš„æå‡ç‡ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬åœ¨æ“ä½œç³»ç»Ÿå†…æ ¸ä¸­ä¸ºæ¯ä¸ªä½œä¸šæ„å»ºä¸€ä¸ª a promotion histogram ï¼Œå…¶ä¸­ï¼Œå¯¹äºæ¯ä¸ªå†·é¡µé˜ˆå€¼ Tï¼Œæˆ‘ä»¬è®°å½•æ€»æå‡ç‡ï¼Œè¿™äº›é¡µé¢æ¯”é˜ˆå€¼ T æ›´å†·ã€‚ ä½œä¸€ä¸ªä¾‹å­ï¼Œå‡è®¾ä¸€ä¸ªåº”ç”¨ç¨‹åºæœ‰ä¸¤ä¸ªå†…å­˜é¡µ A å’Œ Bï¼Œåˆ†åˆ«åœ¨ 5 åˆ†é’Ÿå’Œ 10 åˆ†é’Ÿå‰è¢«è®¿é—®ï¼Œå¹¶ä¸”ä¸¤ä¸ªé¡µé¢éƒ½åœ¨ 1 åˆ†é’Ÿå‰å†æ¬¡è¢«è®¿é—®ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæå‡ç›´æ–¹å›¾è¿”å› T = 8 åˆ†é’Ÿçš„ 1 æ¬¡æå‡/åˆ†é’Ÿï¼Œå› ä¸ºåªæœ‰ B åœ¨ T = 8 åˆ†é’Ÿæ—¶ä¼šè¢«è®¤ä¸ºæ˜¯å†·çš„ï¼Œå½“ä¸¤ä¸ªé¡µé¢åœ¨ä¸€åˆ†é’Ÿå‰è¢«è®¿é—®æ—¶ã€‚ç±»ä¼¼åœ°ï¼Œå®ƒè¿”å› T = 2 åˆ†é’Ÿçš„ 2 æ¬¡æå‡/åˆ†é’Ÿï¼Œå› ä¸ºç°åœ¨ A å’Œ B åœ¨ T = 2 åˆ†é’Ÿæ—¶éƒ½ä¼šè¢«è®¤ä¸ºæ˜¯å†·çš„ã€‚æˆ‘ä»¬åœ¨ç¬¬ 5.1 èŠ‚ä¸­è®¨è®ºäº†æˆ‘ä»¬çš„å®ç°ã€‚ ä¸ºä»€ä¹ˆ T ä¸€å®šè¦ä½å‘¢ è™½ç„¶æå‡ç›´æ–¹å›¾è®©æˆ‘ä»¬é€‰æ‹©äº†è¿‡å»æœ€å¥½çš„å†·å¹´é¾„é˜ˆå€¼ï¼Œä½†å®ƒä¸ä¸€å®šæ˜¯æœªæ¥çš„æœ€ä½³é˜ˆå€¼ã€‚Ideally, the control algorithm has to give us a stable threshold over time so as to reduce unnecessary compression and decompression costs. åŒæ—¶ï¼Œç³»ç»Ÿå¿…é¡»å¯¹åº”ç”¨ç¨‹åºæ´»åŠ¨çš„çªç„¶å³°å€¼åšå‡ºå“åº”ï¼Œå¹¶é¿å…é•¿æ—¶é—´è¿‡åº¦å‹ç¼©å†…å­˜ã€‚å› æ­¤ï¼Œæˆ‘ä»¬çš„ç³»ç»ŸåŸºäºä»¥ä¸‹åŸåˆ™æ§åˆ¶é˜ˆå€¼ï¼š å®ƒè·Ÿè¸ªè¿‡å»æ¯ä¸ª 1 åˆ†é’Ÿå‘¨æœŸå†…çš„æœ€ä½³å†·å¹´é¾„é˜ˆå€¼ï¼Œå¹¶ä½¿ç”¨å®ƒä»¬çš„ K ç™¾åˆ†ä½æ•°ä½œä¸ºä¸‹ä¸€ä¸ª 1 åˆ†é’Ÿçš„é˜ˆå€¼ã€‚é€šè¿‡è¿™æ ·åšï¼Œå®ƒåœ¨ç¨³å®šçŠ¶æ€ä¸‹å°†è¿å SLO çº¦(100 - K)% çš„æ—¶é—´ã€‚ å¦‚æœæœ€åä¸€åˆ†é’Ÿçš„å†·å¹´é¾„é˜ˆå€¼é«˜äºè¿‡å»çš„ K ç™¾åˆ†ä½æ•°ï¼ˆå³ä½œä¸šåœ¨è¿‡å»ä¸€åˆ†é’Ÿçš„å†·å†…å­˜è®¿é—®é‡é«˜äºè¿‡å»è¡Œä¸ºçš„ K ç™¾åˆ†ä½æ•°ï¼‰ï¼Œæˆ‘ä»¬ä½¿ç”¨å‰è€…ï¼Œä»¥ä¾¿ç³»ç»Ÿèƒ½å¤Ÿå¿«é€Ÿå“åº”åº”ç”¨ç¨‹åºæ´»åŠ¨çš„çªç„¶å¢åŠ ã€‚ ç”±äºç®—æ³•ä¾èµ–äºæ¯ä¸ªä½œä¸šçš„å†å²è®°å½•ï¼Œæˆ‘ä»¬åœ¨ä½œä¸šæ‰§è¡Œçš„å‰ S ç§’å†…ç¦ç”¨ zswapï¼Œä»¥é¿å…åŸºäºä¸å……åˆ†çš„ä¿¡æ¯åšå‡ºå†³ç­–ã€‚ ","date":"2024-10-30","objectID":"/posts/paper-far-memory/:6:3","tags":["Paper Reading"],"title":"Paper Reading: Software-Defined Far Memory in Warehouse-Scale Computers","uri":"/posts/paper-far-memory/"},{"categories":null,"content":"Calculating the Size of Cold Memory æˆ‘ä»¬æœºåˆ¶çš„æœ€åä¸€éƒ¨åˆ†æ˜¯ä¼°è®¡ä¸åŒå†·å¹´é¾„é˜ˆå€¼ä¸‹çš„å†·å†…å­˜å¤§å°ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬çš„ç³»ç»Ÿä¸ºç»™å®šçš„ä¸€ç»„é¢„å®šä¹‰å†·å¹´é¾„é˜ˆå€¼æ„å»ºæ¯ä¸ªä½œä¸šçš„å†·é¡µç›´æ–¹å›¾ã€‚åœ¨è¿™ä¸ªç›´æ–¹å›¾ä¸­ï¼Œå¯¹äºæ¯ä¸ªå†·å¹´é¾„é˜ˆå€¼ Tï¼Œæˆ‘ä»¬è®°å½•è‡³å°‘ T ç§’æœªè¢«è®¿é—®çš„é¡µé¢æ•°é‡ã€‚è¿™äº›ä¿¡æ¯ç”¨äºï¼ˆ1ï¼‰ä¼°è®¡ä½œä¸šçš„å·¥ä½œé›†å¤§å°ï¼ˆç”¨äºå½’ä¸€åŒ–æå‡ç‡ï¼›è§ç¬¬ 4.2 èŠ‚ï¼‰å’Œï¼ˆ2ï¼‰å¯¹ä¸åŒå†·å¹´é¾„é˜ˆå€¼ä¸‹çš„æ½œåœ¨å†…å­˜èŠ‚çœè¿›è¡Œç¦»çº¿åˆ†æï¼ˆç¬¬ 5.3 èŠ‚ï¼‰ã€‚ ","date":"2024-10-30","objectID":"/posts/paper-far-memory/:6:4","tags":["Paper Reading"],"title":"Paper Reading: Software-Defined Far Memory in Warehouse-Scale Computers","uri":"/posts/paper-far-memory/"},{"categories":null,"content":"System Implementation åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†åœ¨æ“ä½œç³»ç»Ÿå†…æ ¸å’ŒèŠ‚ç‚¹ä»£ç†ä¸­å®ç°çš„å†·é¡µè¯†åˆ«æœºåˆ¶ï¼Œä»¥åŠç”¨äºå®ƒçš„è‡ªåŠ¨è°ƒä¼˜ç³»ç»Ÿã€‚æˆ‘ä»¬åŸºäº zswapï¼ˆä¸€ä¸ª readily available Linux featureï¼‰å±•ç¤ºäº†æˆ‘ä»¬çš„ç³»ç»Ÿè®¾è®¡å¹¶è¿›è¡Œäº†è¯„ä¼°ï¼Œä½†æˆ‘ä»¬çš„è®¾è®¡å¯ä»¥æ¨å¹¿åˆ°å…¶ä»–ç±»å‹çš„è¿œç«¯å†…å­˜æŠ€æœ¯ï¼Œå› ä¸ºæˆ‘ä»¬çš„æ§åˆ¶å¹³é¢ä¸ä¾èµ–äºä»»ä½•ç‰¹å®šçš„è¿œç«¯å†…å­˜è®¾å¤‡ã€‚ å›¾ 4 å±•ç¤ºäº†æˆ‘ä»¬ç³»ç»Ÿè®¾è®¡çš„é«˜çº§å›¾ã€‚åœ¨æ¯å°ç”Ÿäº§æœºå™¨ä¸Šï¼Œæˆ‘ä»¬çš„å®šåˆ¶ Linux å†…æ ¸ï¼ˆç¬¬ 5.1 èŠ‚ï¼‰å’ŒèŠ‚ç‚¹ä»£ç†ï¼ˆç¬¬ 5.2 èŠ‚ï¼‰è°ƒæ•´å†·å¹´é¾„é˜ˆå€¼å¹¶æ”¶é›†æ¯ä¸ªä½œä¸šçš„ç»Ÿè®¡ä¿¡æ¯ã€‚ä½¿ç”¨ä½œä¸šçš„å†å²æ•°æ®ï¼Œæˆ‘ä»¬ä½¿ç”¨æœºå™¨å­¦ä¹ æ¥è°ƒæ•´èŠ‚ç‚¹ä»£ç†çš„å‚æ•°ï¼ˆç¬¬ 5.3 èŠ‚ï¼‰ã€‚ ä¸ä¾èµ–ç¡¬ä»¶ ","date":"2024-10-30","objectID":"/posts/paper-far-memory/:7:0","tags":["Paper Reading"],"title":"Paper Reading: Software-Defined Far Memory in Warehouse-Scale Computers","uri":"/posts/paper-far-memory/"},{"categories":null,"content":"Kernel æˆ‘ä»¬ä½¿ç”¨ Linux çš„å†…å­˜ cgroupï¼ˆmemcgï¼‰[2]æ¥éš”ç¦» WSC ä¸­çš„ä½œä¸šã€‚è½¯ä»¶å®šä¹‰çš„è¿œç«¯å†…å­˜æ„å»ºåœ¨ zswap ä¹‹ä¸Šã€‚æˆ‘ä»¬è¿è¡Œä¸¤ä¸ªå…¨æœºèŒƒå›´çš„å†…æ ¸å®ˆæŠ¤è¿›ç¨‹ï¼Œå³ kstaled å’Œ kreclaimdï¼Œä»¥æ”¶é›†è¿œç«¯å†…å­˜ç»Ÿè®¡ä¿¡æ¯å¹¶å°†é¡µé¢ç§»åŠ¨åˆ°è¿œç«¯å†…å­˜ã€‚æˆ‘ä»¬é¦–å…ˆè®¨è®ºæˆ‘ä»¬çš„ zswap å®ç°ä»¥åŠåœ¨æˆ‘ä»¬çš„ç”Ÿäº§ç¯å¢ƒä¸­è¿›è¡Œéç ´åæ€§éƒ¨ç½²æ‰€éœ€çš„ä¿®æ”¹ã€‚ cgroup https://tech.meituan.com/2015/03/31/cgroups.html ç¾å›¢çš„æ–‡ç« ç‰¹åˆ«å¥½ stale d reclaim d zswap æˆ‘ä»¬é€šè¿‡å‡ ä¸ªé’ˆå¯¹ WSC éƒ¨ç½²å®šåˆ¶çš„åŠŸèƒ½å¢å¼ºäº†ä¸Šæ¸¸ Linux çš„ zswap å®ç°ã€‚æˆ‘ä»¬ä½¿ç”¨ lzo ç®—æ³•æ¥å®ç°ä½ CPU å¼€é”€çš„å‹ç¼©å’Œè§£å‹ç¼©ã€‚ ä¸€æ—¦ zswap å‹ç¼©äº†ä¸€ä¸ªé¡µé¢ï¼Œå®ƒå°±ä¼šåˆ†é…å†…å­˜æ¥å­˜å‚¨å‹ç¼©çš„æœ‰æ•ˆè½½è·ã€‚æˆ‘ä»¬ä½¿ç”¨ zsmalloc ä½œä¸ºå‹ç¼©æ•°æ®åŒºåŸŸã€‚æˆ‘ä»¬ä¸ºæ¯å°æœºå™¨ç»´æŠ¤ä¸€ä¸ªå…¨å±€çš„ zsmalloc åŒºåŸŸï¼Œå¹¶åœ¨éœ€è¦æ—¶ç”±èŠ‚ç‚¹ä»£ç†è§¦å‘æ˜¾å¼å‹ç¼©æ¥å£ã€‚è™½ç„¶æ¯ä¸ª memcg çš„ zsmalloc åŒºåŸŸçœ‹èµ·æ¥æ›´ç›´è§‚ï¼Œå› ä¸ºæˆ‘ä»¬ç”¨ memcg å°è£…äº†ä½œä¸šï¼Œä½†å®ƒä¼šå¯¼è‡´æ¯ä¸ª zsmalloc åŒºåŸŸä¸åŒç¨‹åº¦çš„å¤–éƒ¨ç¢ç‰‡åŒ–ï¼Œå› ä¸º WSC é€šå¸¸æ¯å°æœºå™¨æ‰“åŒ…æ•°åæˆ–æ•°ç™¾ä¸ªä½œä¸šã€‚æˆ‘ä»¬æœ€åˆä½¿ç”¨æ¯ä¸ª memcg çš„ zsmalloc åŒºåŸŸçš„ç ”ç©¶å‘ç°ï¼Œæ¯å¤©æœ‰æ•°åƒä¸ªå®ä¾‹çš„åŒºåŸŸç¢ç‰‡åŒ–åˆ°è´Ÿæ”¶ç›Šçš„ç¨‹åº¦ã€‚ zsmalloc æ˜¯ä¸€ä¸ªåŸºäº slab çš„å†…å­˜åˆ†é…å™¨ï¼Œæ—¨åœ¨æœ‰æ•ˆåœ°å­˜å‚¨å„ç§å‹ç¼©çº§åˆ«çš„é¡µé¢ã€‚ å®ƒä»¥æœ€å°‘çš„ç¢ç‰‡é‡å®ç°äº†æœ€é«˜çš„å­˜å‚¨å¯†åº¦ã€‚ åœ¨ä½å†…å­˜æ¡ä»¶ä¸‹å·¥ä½œè‰¯å¥½ã€‚zsmalloc åªèƒ½åˆ†é…å¤§å°ä¸è¶…è¿‡ PAGE_SIZE çš„å¯¹è±¡ https://docs.kernel.org/mm/zsmalloc.html memcg æ˜¯ Linux æ“ä½œç³»ç»Ÿä¸­çš„å†…å­˜æ§åˆ¶ç»„ï¼ˆmemcg, memory control groupï¼‰ï¼Œcgroup ä¸ºä»€ä¹ˆæ˜¯ lzoï¼Ÿå¿« We compared several compression algorithms, including lzo, lz4, and snappy, and concluded that lzo shows the best trade-off between compression speed and efficiency. æ ¹æ®ç»éªŒï¼Œå­˜å‚¨å¤§äº 2990 å­—èŠ‚çš„ zsmalloc æœ‰æ•ˆè½½è·ï¼ˆ4 KiB x86 é¡µé¢çš„ 73%ï¼‰æ²¡æœ‰æ”¶ç›Šï¼Œå…¶ä¸­å…ƒæ•°æ®å¼€é”€å˜å¾—é«˜äºå‹ç¼©é¡µé¢çš„èŠ‚çœã€‚å½“å°è¯•å‹ç¼©äº§ç”Ÿå¤§äºè¯¥æœ‰æ•ˆè½½è·çš„é¡µé¢æ—¶ï¼Œæˆ‘ä»¬å°†å…¶æ ‡è®°ä¸ºä¸å¯å‹ç¼©å¹¶æ‹’ç»å®ƒã€‚ä¸å¯å‹ç¼©çŠ¶æ€é˜»æ­¢ zswap å°è¯•é‡æ–°å‹ç¼©è¯¥é¡µé¢ï¼Œå¹¶åœ¨ kstaledï¼ˆè§ä¸‹æ–‡ï¼‰æ£€æµ‹åˆ°ä¸è¯¥é¡µé¢å…³è”çš„ä»»ä½• PTE å˜è„æ—¶æ¸…é™¤ã€‚ åªå‹ç¼©å°é¡µé¢ï¼Ÿ å½“ä½œä¸šè¾¾åˆ°å…¶å†…å­˜é™åˆ¶æ—¶ï¼Œæˆ‘ä»¬å…³é—­ zswap è€Œä¸æ˜¯å°†å…¶ç”¨ä½œäº¤æ¢è®¾å¤‡ã€‚è¿™æ˜¯å› ä¸º WSC åº”ç”¨ç¨‹åºæ›´å–œæ¬¢â€œå¿«é€Ÿå¤±è´¥â€å¹¶åœ¨é›†ç¾¤ä¸­çš„å…¶ä»–åœ°æ–¹é‡æ–°å¯åŠ¨ï¼Œä¾é å…¶å®¹é”™ç‰¹æ€§[7]ï¼Œè€Œä¸æ˜¯åœ¨å†…æ ¸æ¨¡å¼ä¸‹æµªè´¹ CPU å‘¨æœŸè¯•å›¾é¿å…ä½œä¸šæŠ¢å ã€‚å®ƒè¿˜ä½¿ zswap ä¸é›†ç¾¤èŒƒå›´è°ƒåº¦å™¨çš„å…¸å‹è¡Œä¸ºä¸€è‡´ï¼Œå½“å®ƒä»¬è€—å°½å†…å­˜æ—¶ï¼Œè°ƒåº¦å™¨ä¼šæ€æ­»å°½åŠ›è€Œä¸ºçš„ä½œä¸šã€‚ å½“æœºå™¨è€—å°½å†…å­˜æ—¶ï¼Œå†…æ ¸å°†åœ¨æ•…éšœè¿›ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨ç›´æ¥å†…å­˜å›æ”¶ã€‚èŠ‚ç‚¹ä»£ç†ä¸ºæ¯ä¸ª memcg ç»´æŠ¤ä¸€ä¸ªâ€œè½¯â€é™åˆ¶ï¼Œç›¸å½“äºå…¶å·¥ä½œé›†å¤§å°ï¼ˆä½¿ç”¨ç¬¬ 4.2 èŠ‚ä¸­çš„æ–¹æ³•ç¡®å®šï¼‰ï¼Œå†…æ ¸ä¸ä¼šåœ¨æ­¤é˜ˆå€¼ä»¥ä¸‹å›æ”¶ã€‚è¿™ä¿æŠ¤äº†é«˜ä¼˜å…ˆçº§ä½œä¸šçš„å·¥ä½œé›†ï¼Œå¹¶é˜²æ­¢å›æ”¶ä½œä¸šçº¿ç¨‹èŠ±è´¹è¿‡å¤šçš„å‘¨æœŸè¿›è¡Œ zswapï¼ŒåŒæ—¶å¼ºåŒ–äº†ä½ä¼˜å…ˆçº§ä½œä¸šâ€œå¿«é€Ÿå¤±è´¥â€çš„åå¥½ã€‚ kstaled æˆ‘ä»¬å®šæœŸæ‰«æé¡µè¡¨é¡¹ä¸­å­˜åœ¨çš„è®¿é—®ä½ï¼Œä»¥æ¨æ–­é¡µé¢æ˜¯å¦åœ¨ç»™å®šæ—¶é—´æ®µå†…è¢«è®¿é—®[4, 19]ã€‚æˆ‘ä»¬åˆ©ç”¨ kstaledï¼Œä¸€ä¸ªå†…æ ¸å®ˆæŠ¤è¿›ç¨‹ a kernel daemonï¼ŒåŸºäºè®¿é—®ä½ä¿¡æ¯è·Ÿè¸ªæ‰€æœ‰æœ‰èµ„æ ¼è¿›è¡Œå†…å­˜å›æ”¶çš„ç‰©ç†é¡µé¢çš„å¹´é¾„[28]ã€‚ åœ¨æ¯ä¸ªæ‰«æå‘¨æœŸå†…ï¼Œkstaled éå†è¿›ç¨‹é¡µè¡¨ä»¥è¯»å–æ¯ä¸ªç‰©ç†é¡µé¢çš„è®¿é—®ä½ã€‚å¦‚æœé¡µé¢çš„è®¿é—®ä½è¢«è®¾ç½®ï¼Œkstaled å°†ç›¸åº”é¡µé¢çš„å¹´é¾„è®¾ç½®ä¸ºé›¶ï¼›å¦åˆ™ï¼Œå®ƒå¢åŠ å¹´é¾„ã€‚å®ƒè¿˜æ¸…é™¤è®¿é—®ä½ä»¥æ£€æµ‹é¡µé¢çš„ä»»ä½•æœªæ¥è®¿é—®ã€‚å¦‚æœç‰©ç†é¡µé¢æ˜ å°„åœ¨å¤šä¸ªé¡µè¡¨ä¸­ï¼Œkstaled ä»…åœ¨ä»»ä½•é¡µè¡¨ä¸­è®¿é—®ä½æœªè®¾ç½®æ—¶å¢åŠ å¹´é¾„ æˆ‘ä»¬çš„ kstaled ç‰ˆæœ¬å°†é¡µé¢çš„å¹´é¾„å­˜å‚¨åœ¨ perpage metadata structure ä¸­ï¼Œä»¥ä¾¿å…¶ä»–ä½¿ç”¨é¡µé¢è®¿é—®æ¨¡å¼çš„å†…æ ¸ç»„ä»¶ï¼ˆå¦‚ç›´æ¥å›æ”¶ï¼‰å¯ä»¥åˆ©ç”¨ kstaled å·²ç»æ”¶é›†çš„ä¿¡æ¯ã€‚æˆ‘ä»¬ä½¿ç”¨æ¯é¡µ 8 ä½æ¥ç¼–ç é¡µé¢çš„å¹´é¾„ã€‚ç”±äºæˆ‘ä»¬å°†è¿™äº›ä½æ‰“åŒ…åœ¨ Linux å†…æ ¸ä¸­å·²ç»ç»´æŠ¤çš„ struct page å…ƒæ•°æ®ç»“æ„ä¸­ï¼Œå› æ­¤æˆ‘ä»¬ä¸ä¼šä¸ºè·Ÿè¸ªå¹´é¾„äº§ç”Ÿä»»ä½•å­˜å‚¨å¼€é”€ã€‚æˆ‘ä»¬ä»¥ 120 ç§’çš„é¢‘ç‡è¿è¡Œ kstaledã€‚ä½¿ç”¨ 8 ä½å¹´é¾„ï¼Œæˆ‘ä»¬å¯ä»¥è·Ÿè¸ªé•¿è¾¾ 8.5 å°æ—¶ï¼ˆ= 255 Ã— 120 ç§’ï¼‰çš„å¹´é¾„ã€‚ æ¯å½“ kstaled æ›´æ–°é¡µé¢çš„å¹´é¾„æ—¶ï¼Œå®ƒè¿˜ä¼šæ›´æ–°ä¸¤ä¸ªæ¯ä¸ªä½œä¸šçš„ç›´æ–¹å›¾ï¼šï¼ˆ1ï¼‰å†·å¹´é¾„ç›´æ–¹å›¾ï¼Œä¸€ä¸ªé¡µé¢å¹´é¾„çš„ç›´æ–¹å›¾ï¼Œè·Ÿè¸ªé¡µé¢æœªè¢«è®¿é—®çš„æ—¶é—´ Tï¼›ï¼ˆ2ï¼‰æå‡ç›´æ–¹å›¾ï¼Œè®°å½•é¡µé¢è¢«è®¿é—®æ—¶çš„å¹´é¾„ã€‚è¿™äº›ç›´æ–¹å›¾å¯¼å‡ºåˆ°èŠ‚ç‚¹ä»£ç†ï¼Œå¹¶ç”¨äºç¡®å®šå†·é¡µå¹´é¾„é˜ˆå€¼ï¼Œå¦‚ç¬¬ 4.3 èŠ‚æ‰€è¿°ã€‚ To minimize the CPU overhead of kstaled, we empirically tune its scan period while trading off for finer-grained page access information.å¹³å‡è€Œè¨€ï¼Œkstaled ä½œä¸ºä¼˜å…ˆçº§è¾ƒä½çš„åå°ä»»åŠ¡è¿è¡Œæ—¶ï¼Œæ¶ˆè€—ä¸åˆ°ä¸€ä¸ªé€»è¾‘ CPU æ ¸å¿ƒçš„ 11%ã€‚ empirically? kreclaimd ä¸€æ—¦èŠ‚ç‚¹ä»£ç†ä½¿ç”¨ kstaled æ„å»ºçš„å¹´é¾„ç›´æ–¹å›¾å¹¶è®¾ç½®å†·å¹´é¾„é˜ˆå€¼ï¼Œkreclaimd å°†æ¯ä¸ªé¡µé¢çš„å¹´é¾„ä¸é¡µé¢æ‰€å±ä½œä¸šçš„å†·å¹´é¾„é˜ˆå€¼è¿›è¡Œæ¯”è¾ƒï¼Œå¹¶å›æ”¶æ‰€æœ‰å¹´é¾„è¶…è¿‡é˜ˆå€¼çš„é¡µé¢ã€‚ æˆ‘ä»¬é€šè¿‡å°†å†·é¡µé¢ç§»åŠ¨åˆ° zswap æ¥å›æ”¶ DRAM ä¸­çš„å†·é¡µé¢ï¼Œä»è€Œé‡Šæ”¾ DRAM å®¹é‡ä»¥æœåŠ¡çƒ­åº”ç”¨ç¨‹åºé¡µé¢ã€‚è®¿é—®æ—¶ï¼Œå‹ç¼©é¡µé¢ä¼šè¢«è§£å‹ç¼©ã€‚kreclaimd åœ¨ä»»ä½•å…¶ä»–åº”ç”¨ç¨‹åºæœªä½¿ç”¨çš„ç©ºé—²å‘¨æœŸä¸­è¿è¡Œï¼Œä½œä¸ºä¸€ä¸ªä¸å¼•äººæ³¨ç›®çš„åå°ä»»åŠ¡å®ç°å†…å­˜æ”¶ç›Šã€‚ è¯·æ³¨æ„ï¼Œæˆ‘ä»¬åªè€ƒè™‘æœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼ˆLRUï¼‰åˆ—è¡¨[3]ä¸­çš„é¡µé¢æ˜ å°„åˆ°è¿œç«¯å†…å­˜ã€‚ä¾‹å¦‚ï¼Œå¦‚æœé¡µé¢è¢«æ ‡è®°ä¸ºä¸å¯é©±é€æˆ–é”å®šåœ¨å†…å­˜ä¸­ï¼ˆmlockedï¼‰ï¼Œæˆ‘ä»¬ä¸ä¼šå°†å…¶æ˜ å°„åˆ°è¿œç«¯å†…å­˜ã€‚è¿™æœ‰åŠ©äºæˆ‘ä»¬é¿å…æµªè´¹ CPU å‘¨æœŸåœ¨ä¸å¯ç§»åŠ¨çš„é¡µé¢ä¸Šã€‚ ","date":"2024-10-30","objectID":"/posts/paper-far-memory/:7:1","tags":["Paper Reading"],"title":"Paper Reading: Software-Defined Far Memory in Warehouse-Scale Computers","uri":"/posts/paper-far-memory/"},{"categories":null,"content":"Node Agent æ¯å°æœºå™¨ä¸Šè¿è¡Œçš„èŠ‚ç‚¹ä»£ç†ï¼ˆåœ¨æˆ‘ä»¬çš„é›†ç¾¤ç®¡ç†ç³»ç»Ÿä¸­ç§°ä¸º Borglet [40]ï¼‰åŠ¨æ€æ§åˆ¶æ¯ä¸ªä½œä¸šçš„å†·å¹´é¾„é˜ˆå€¼ã€‚ä½¿ç”¨ç¬¬ 4.3 èŠ‚ä¸­æè¿°çš„ç®—æ³•ï¼Œå®ƒé€šè¿‡æ¯åˆ†é’Ÿè¯»å–å†…æ ¸ç»Ÿè®¡ä¿¡æ¯å¹¶è®¡ç®—è¿‡å»ä¸€åˆ†é’Ÿçš„æœ€ä½å†·å¹´é¾„é˜ˆå€¼ï¼ˆä¸è¿åç›®æ ‡æå‡ç‡ï¼‰ï¼Œæ„å»ºè¿‡å»æœ€ä½³å†·å¹´é¾„é˜ˆå€¼çš„æ± ã€‚ç„¶åï¼Œå®ƒåœ¨æ¯ä¸ªä½œä¸šæ‰§è¡Œå¼€å§‹åçš„ S ç§’å†…å¯ç”¨ zswapï¼Œå°†é˜ˆå€¼è®¾ç½®ä¸ºæ± ä¸­ä¸‹ä¸€ä¸ªä¸€åˆ†é’Ÿçš„ K ç™¾åˆ†ä½æ•°ã€‚èŠ‚ç‚¹ä»£ç†å®šæœŸå°†æ¯ä¸ªä½œä¸šçš„å†·å†…å­˜ç»Ÿè®¡ä¿¡æ¯ä»å†…æ ¸å¯¼å‡ºåˆ°å¤–éƒ¨æ•°æ®åº“ï¼Œä»¥ä¿ƒè¿›ç¦»çº¿åˆ†æå’Œç›‘æ§ã€‚ ","date":"2024-10-30","objectID":"/posts/paper-far-memory/:7:2","tags":["Paper Reading"],"title":"Paper Reading: Software-Defined Far Memory in Warehouse-Scale Computers","uri":"/posts/paper-far-memory/"},{"categories":null,"content":"ML-based Autotuner æˆ‘ä»¬çš„ç³»ç»Ÿå°†å‰é¢è®¨è®ºçš„ K å’Œ S ä½œä¸ºå¯è°ƒå‚æ•°ï¼Œä»¥è°ƒæ•´æ§åˆ¶å¹³é¢çš„æ¿€è¿›ç¨‹åº¦ã€‚ç„¶è€Œï¼Œæ‰‹åŠ¨ä¸€æ¬¡æ€§è°ƒæ•´è¿™äº›å‚æ•°æ¶‰åŠåœ¨ç”Ÿäº§ç³»ç»Ÿä¸­è¿›è¡Œå¤šæ¬¡è¿­ä»£å’Œ A/B æµ‹è¯•ï¼Œè¿™æ—¢å†’é™©åˆè€—æ—¶ï¼Œå¹¶ä¸”å®¹æ˜“å—åˆ°å·¥ä½œè´Ÿè½½è¡Œä¸ºéšæ—¶é—´å˜åŒ–çš„å½±å“ã€‚ æ®æˆ‘ä»¬æ‰€çŸ¥ï¼Œè¿™æ˜¯é¦–æ¬¡å°† GP Bandit ç”¨äºä¼˜åŒ– WSCã€‚ K ä»£è¡¨å†·å¹´é¾„é˜ˆå€¼çš„ç™¾åˆ†ä½æ•° S ä»£è¡¨ä½œä¸šæ‰§è¡Œå¼€å§‹åçš„ç­‰å¾…æ—¶é—´ï¼ˆä»¥ç§’ä¸ºå•ä½ï¼‰ï¼Œåœ¨è¿™æ®µæ—¶é—´å†…ç¦ç”¨ zswapã€‚ çœç•¥ ML å†…å®¹ï¼Œä¸è¿‡ç”¨ Bandit è°ƒä¼˜ WSC çš„æƒ³æ³•çœŸçš„å¾ˆå‰å®³ï¼Œè¿™ä¸€ç¯‡è®ºæ–‡éå¸¸ç²¾å½©ï¼Œéƒ½æ˜¯å¾ˆç®€å•çš„æƒ³æ³•ï¼Œä½†æ˜¯æ•ˆæœå¾ˆä¸é”™ ä¸è®ºæ˜¯ lzo, zswap, cgroup éƒ½æ˜¯ç°æœ‰çš„ï¼Œè¿˜æ˜¯ bandit è°ƒä¼˜ï¼Œä¹Ÿéƒ½æ˜¯å­˜åœ¨å¾ˆä¹…çš„æ–¹æ³• ä¼°è®¡ä¹Ÿå°± google å›¢é˜Ÿèƒ½é‡åˆ° wsc ä¸­çš„ç°å®é—®é¢˜ï¼Œç‰¹å®šé—®é¢˜ ç‰¹å®šè§£æ³•ï¼Œå¾ˆ practical ","date":"2024-10-30","objectID":"/posts/paper-far-memory/:7:3","tags":["Paper Reading"],"title":"Paper Reading: Software-Defined Far Memory in Warehouse-Scale Computers","uri":"/posts/paper-far-memory/"},{"categories":null,"content":"Evaluation cold memory coverage as a metric æˆ‘ä»¬å°†å†·å†…å­˜è¦†ç›–ç‡å®šä¹‰ä¸ºå­˜å‚¨åœ¨è¿œç«¯å†…å­˜ï¼ˆå³å‹ç¼©ï¼‰ä¸­çš„æ€»å†…å­˜å¤§å°é™¤ä»¥åœ¨æœ€ä½å¯èƒ½å†·å¹´é¾„é˜ˆå€¼ï¼ˆåœ¨æˆ‘ä»¬çš„ç³»ç»Ÿä¸­ä¸º 120 ç§’ï¼‰ä¸‹çš„æ€»å†·å†…å­˜å¤§å°ã€‚ä»æ¦‚å¿µä¸Šè®²ï¼Œè¿™æ˜¯å­˜å‚¨åœ¨è¿œç«¯å†…å­˜ä¸­çš„å†·å†…å­˜çš„ç™¾åˆ†æ¯”ï¼Œå¹¶æš—ç¤ºæˆ‘ä»¬çš„ç³»ç»Ÿä¸ä¸Šç•Œæœ‰å¤šæ¥è¿‘ï¼Œå³æ‰€æœ‰åœ¨ 120 ç§’æˆ–æ›´é•¿æ—¶é—´å†…æœªè¢«è®¿é—®çš„é¡µé¢éƒ½å¯ä»¥å­˜å‚¨åœ¨è¿œç«¯å†…å­˜ä¸­è€Œä¸ä¼šå¯¼è‡´æ€§èƒ½ä¸‹é™ã€‚ å›¾ 5 æ˜¾ç¤ºäº†éšæ—¶é—´å˜åŒ–çš„å†·å†…å­˜è¦†ç›–ç‡çš„æœºç¾¤èŒƒå›´å¹³å‡å€¼ï¼Œå¹¶æ ‡æ³¨äº†ç›¸å…³çš„æ—¶é—´çº¿ã€‚ç¬¬ä¸€é˜¶æ®µï¼ˆA åˆ° Bï¼‰éƒ¨ç½²äº† zswapï¼Œå…¶é™æ€å‚æ•°å€¼ç”±æœ‰é™çš„å°è§„æ¨¡å®éªŒæä¾›ã€‚ç„¶åï¼Œåœ¨ç¬¬äºŒé˜¶æ®µï¼ˆC åˆ° Dï¼‰ï¼Œæˆ‘ä»¬æ¨å‡ºäº†æˆ‘ä»¬çš„è‡ªåŠ¨è°ƒä¼˜å™¨åŠå…¶å‚æ•°å€¼å»ºè®®ã€‚ cold mem coverage è¶Šé«˜ï¼Œæ„å‘³ç€è¶Šå¤šå†…å­˜èƒ½é‡Šæ”¾å‡ºæ¥æä¾›è°ƒç”¨ å›¾ 6 æ˜¾ç¤ºäº†å‰ 10 ä¸ªæœ€å¤§é›†ç¾¤ä¸­æœºå™¨çš„å†·å†…å­˜è¦†ç›–ç‡åˆ†å¸ƒã€‚ä¸ç¬¬ 2.2 èŠ‚ä¸­çš„å†·å†…å­˜åˆ†æä¸€æ ·ï¼Œæˆ‘ä»¬è§‚å¯Ÿåˆ°ä¸åŒæœºå™¨ä¹‹é—´çš„å†·å†…å­˜è¦†ç›–ç‡èŒƒå›´å¾ˆå¤§ï¼Œå³ä½¿åœ¨åŒä¸€é›†ç¾¤å†…ä¹Ÿæ˜¯å¦‚æ­¤ã€‚è¿™å±•ç¤ºäº† zswap åœ¨è¿œç«¯å†…å­˜å®¹é‡æ–¹é¢çš„çµæ´»æ€§ä¼˜åŠ¿ã€‚ ä¸åŒä»»åŠ¡çš„é›†ç¾¤ï¼Œcoverage è¡¨ç°ä¹Ÿä¸é”™ è™½ç„¶å†·å†…å­˜è¦†ç›–ç‡éšæœºå™¨å’Œæ—¶é—´å˜åŒ–ï¼Œä½†é›†ç¾¤çº§åˆ«çš„æ¯”ç‡ä¸€ç›´ç¨³å®šï¼Œè¿™ä½¿æˆ‘ä»¬èƒ½å¤Ÿå°† zswap çš„å†·å†…å­˜è¦†ç›–ç‡è½¬æ¢ä¸ºæ›´ä½çš„å†…å­˜é…ç½®ã€‚åœ¨å†·å†…å­˜è¦†ç›–ç‡ä¸º 20%ï¼Œå†·å†…å­˜æ¯”ç‡çš„ä¸Šé™ä¸º 32%ï¼ˆå›¾ 1ï¼‰ï¼Œä»¥åŠå‹ç¼©é¡µé¢çš„æˆæœ¬é™ä½ 67%ï¼ˆç¬¬ 6.3 èŠ‚ï¼‰çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„ç³»ç»Ÿä»¥é€æ˜çš„æ–¹å¼å®ç°äº† 4-5%çš„ DRAM TCO å‡å°‘ã€‚è¿™äº›èŠ‚çœæ˜¯åœ¨æ€§èƒ½ SLI æ²¡æœ‰å·®å¼‚çš„æƒ…å†µä¸‹å®ç°çš„ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹æ–‡è®¨è®ºã€‚ SLI, indicatorï¼ŒæŒ‡æ ‡ SLO, objective åŸºäº SLIï¼Œæ‰¿è¯ºè´¨é‡ï¼Œç›®æ ‡ SLA, agreegment å®¢æˆ·åè®® ","date":"2024-10-30","objectID":"/posts/paper-far-memory/:8:0","tags":["Paper Reading"],"title":"Paper Reading: Software-Defined Far Memory in Warehouse-Scale Computers","uri":"/posts/paper-far-memory/"},{"categories":null,"content":"Cold Memory Coverage ","date":"2024-10-30","objectID":"/posts/paper-far-memory/:8:1","tags":["Paper Reading"],"title":"Paper Reading: Software-Defined Far Memory in Warehouse-Scale Computers","uri":"/posts/paper-far-memory/"},{"categories":null,"content":"Performance Impact æˆ‘ä»¬ä½¿ç”¨ä¸¤ä¸ªæŒ‡æ ‡æ¥è¡¡é‡æˆ‘ä»¬ç³»ç»Ÿçš„æ€§èƒ½å½±å“ï¼šæå‡ç‡å’Œ CPU å¼€é”€ã€‚å‰è€…æ˜¯è¿œç«¯å†…å­˜çš„æ€§èƒ½ SLIï¼ˆç¬¬ 4 èŠ‚ï¼‰ï¼Œå¯ä»¥æ¨å¹¿åˆ°å…¶ä»–ç±»å‹çš„è¿œç«¯å†…å­˜è®¾å¤‡ã€‚ CPU å¼€é”€æ˜¾ç¤ºäº†ä½¿ç”¨ zswap ä½œä¸ºè¿œç«¯å†…å­˜æ‰€æ¶ˆè€—çš„å‘¨æœŸã€‚ promotion rate åœ¨æˆ‘çœ‹æ¥å€’æ˜¯å¾ˆéš¾ç›´è§‚ç†è§£ æˆ‘ä»¬é€šè¿‡å‡ ä¸ªæœˆçš„ A/B å®éªŒæ‰‹åŠ¨ç¡®å®šäº† K å’Œ S çš„å€¼ï¼Œè¿™äº›å®éªŒæ¥è‡ªæˆ‘ä»¬æ ¹æ®ç»éªŒçŒœæµ‹çš„å‡ ä¸ªå€™é€‰é…ç½®ã€‚æˆ‘ä»¬è§‚å¯Ÿåˆ°ä¸¤ç§æƒ…å†µä¸‹çš„æå‡ç‡éƒ½éå¸¸ä½ï¼›æå‡ç‡çš„ç¬¬ 98 ç™¾åˆ†ä½æ•°æ¯åˆ†é’Ÿä½äºå·¥ä½œé›†å¤§å°çš„ 0.2%ã€‚è¿™è¡¨æ˜æˆ‘ä»¬çš„å†·é¡µè¯†åˆ«æœºåˆ¶å‡†ç¡®åœ°å°†ä¸å¸¸è®¿é—®çš„é¡µé¢åˆ†ç±»ä¸ºè¿œç«¯å†…å­˜çš„æœ‰æ•ˆå€™é€‰è€…ã€‚ This demonstrates that our cold page identification mechanism accurately classifies infrequently accessed pages to be effective candidates for far memory ç»´æŒæå‡ç‡ä½ï¼Œå°±è¯´æ˜æ˜¯çœŸçš„å‹ç¼©äº†é‚£äº› least è®¿é—®çš„ å›¾çš„çºµåæ ‡å¾ˆå¥‡æ€ªæ˜¯ CDF of Job countï¼Œæ¨ªåæ ‡åè€Œæ˜¯ promotion rate æˆ–è€… CPU overhead è€Œä¸”åŒæ · cdfï¼Œpromotion rate ML æ–¹æ³•å¢åŠ äº†ï¼Œè¯´æ˜è¿˜æ˜¯æ‰‹é€‰å¥½ï¼Ÿä½†æå‡ä¸å¤šï¼Œè¯´æ˜è®­ç»ƒæ‹Ÿåˆè¿˜è¡Œ å‹ç¼©å¸¦æ¥çš„ cpu overhead ä¹Ÿä¸æ˜¯å¾ˆå¤šï¼Œéƒ½åœ¨ 0.10% ä»¥ä¸‹ å›¾ 8 è¿˜è¡¨æ˜ï¼Œæˆ‘ä»¬ç³»ç»Ÿçš„æœºå™¨çº§ CPU å¼€é”€ä¹Ÿéå¸¸ä½ï¼Œä» TCO çš„è§’åº¦æ¥çœ‹ï¼Œä¸æ•´ä¸ª WSC å¹³å‡ 20%çš„å†·å†…å­˜è¦†ç›–ç‡ï¼ˆå›¾ 5ï¼‰ç›¸æ¯”ï¼Œè¿™ç§ CPU å¼€é”€å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚ ","date":"2024-10-30","objectID":"/posts/paper-far-memory/:8:2","tags":["Paper Reading"],"title":"Paper Reading: Software-Defined Far Memory in Warehouse-Scale Computers","uri":"/posts/paper-far-memory/"},{"categories":null,"content":"Compression Characteristics zswap ç»™ç³»ç»Ÿå¸¦æ¥äº†ä¸¤ç§é¢å¤–çš„æˆæœ¬ã€‚é¦–å…ˆï¼Œå‹ç¼©é¡µé¢ä»ç„¶å­˜å‚¨åœ¨ DRAM ä¸­ï¼Œè¿™ä½¿å¾—å®é™…å†…å­˜èŠ‚çœå–å†³äºæ•°æ®çš„å‹ç¼©æ¯”ã€‚å…¶æ¬¡ï¼Œå‹ç¼©é¡µé¢æŒ‰éœ€è§£å‹ç¼©ï¼Œè¿™ä¼šåœ¨è®¿é—®å‹ç¼©é¡µé¢æ—¶äº§ç”Ÿæ€§èƒ½å¼€é”€ã€‚æœ¬å°èŠ‚æ ¹æ®ä»æ•´ä¸ª WSC æ”¶é›†çš„ç»Ÿè®¡æ•°æ®é‡åŒ–è¿™ä¸¤ä¸ªæ–¹é¢ã€‚å›¾ 9a å±•ç¤ºäº†æ¯ä¸ªä½œä¸šä¸­å‹ç¼©é¡µé¢çš„å¹³å‡å‹ç¼©æ¯”åˆ†å¸ƒï¼Œä¸åŒ…æ‹¬ä¸å¯å‹ç¼©é¡µé¢ï¼Œè¿™äº›é¡µé¢å¹³å‡å å†·å†…å­˜çš„ 31%ã€‚å°½ç®¡ zswap ä½¿ç”¨è½»é‡çº§å‹ç¼©ç®—æ³•æ¥æœ€å°åŒ–å…¶ CPU å¼€é”€ï¼Œä½†å®ƒåœ¨ä¸­ä½æ•°ä¸Šå®ç°äº† 3 å€çš„å‹ç¼©æ¯”ï¼ˆå³ 67%çš„å†…å­˜èŠ‚çœï¼‰ã€‚å‹ç¼©æ¯”ä» 2 å€åˆ° 6 å€ä¸ç­‰ï¼Œè¿™å–å†³äºåº”ç”¨ç¨‹åºç‰¹æ€§ã€‚ä¾‹å¦‚ï¼Œå¤šåª’ä½“æ•°æ®å’ŒåŠ å¯†çš„ç»ˆç«¯ç”¨æˆ·å†…å®¹å³ä½¿åœ¨å†·çŠ¶æ€ä¸‹ä¹Ÿæ˜¯ä¸å¯å‹ç¼©çš„ã€‚ è§†é¢‘å¤„ç†çš„é›†ç¾¤å‘¢ï¼Ÿ Decomp. Latency (Î¼s) ä¸æ˜¯å¾ˆé«˜ï¼Œéƒ½æ˜¯ä¸ªä½çš„ ","date":"2024-10-30","objectID":"/posts/paper-far-memory/:8:3","tags":["Paper Reading"],"title":"Paper Reading: Software-Defined Far Memory in Warehouse-Scale Computers","uri":"/posts/paper-far-memory/"},{"categories":null,"content":"Case Study with Bigtable æœ€åï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªæ¡ˆä¾‹ç ”ç©¶æ¥é‡åŒ–æˆ‘ä»¬çš„è¿œç«¯å†…å­˜ç³»ç»Ÿå¯¹åº”ç”¨ç¨‹åºçº§åˆ«æ€§èƒ½æŒ‡æ ‡ï¼ˆä¾‹å¦‚ï¼Œæ¯å‘¨æœŸæŒ‡ä»¤æ•°[45]ï¼‰çš„å½±å“ã€‚æˆ‘ä»¬çš„ç›®æ ‡åº”ç”¨ç¨‹åºæ˜¯ Bigtable[10]ï¼Œè¿™æ˜¯æˆ‘ä»¬ DRAM çš„æœ€å¤§æ¶ˆè´¹è€…ä¹‹ä¸€ï¼Œå®ƒå°† PB çº§çš„æ•°æ®å­˜å‚¨åœ¨å­˜å‚¨ä¸­ï¼Œå¹¶ä»¥å†…å­˜ç¼“å­˜çš„æ–¹å¼ä¸ºè®¸å¤šç”Ÿäº§æœåŠ¡æä¾›æ¯ç§’æ•°ç™¾ä¸‡æ¬¡æ“ä½œçš„æœåŠ¡ã€‚ æ‰¾ä¸ªæ—¶é—´çœ‹ bigtable ä½†æ²¡æ‡‚è¿™é‡Œå’Œ bigtable ç»“åˆæœ‰ä»€ä¹ˆæ˜¾è‘—åŒºåˆ«ï¼Œ IPC å‡ ä¹ä¸å˜ï¼Œæ²¡æœ‰å½±å“ï¼Ÿ ä½†æ˜¯å†·å†…å­˜è¦†ç›–ç‡è¿˜æœ‰ 5-15% è¡¨ç¤ºä¹Ÿæœ‰æå‡ï¼Œä½†æ˜¯æˆ‘æƒ³çœ‹æ›´å¤š metricsï¼Œå»¶è¿Ÿï¼Œæˆæœ¬ï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰å‘¢ ","date":"2024-10-30","objectID":"/posts/paper-far-memory/:8:4","tags":["Paper Reading"],"title":"Paper Reading: Software-Defined Far Memory in Warehouse-Scale Computers","uri":"/posts/paper-far-memory/"},{"categories":null,"content":"Related Work ","date":"2024-10-30","objectID":"/posts/paper-far-memory/:9:0","tags":["Paper Reading"],"title":"Paper Reading: Software-Defined Far Memory in Warehouse-Scale Computers","uri":"/posts/paper-far-memory/"},{"categories":null,"content":"Conclusion ä¸éœ€è¦ç¡¬ä»¶ã€ä¸éœ€è¦ç¡¬ä»¶è¿œç«¯å†…å­˜ã€ä¸éœ€è¦å¯æŒä¹…åŒ–å†…å­˜ ç”¨ age æ¥è¿½è¸ªï¼Œè€Œä¸æ˜¯ç”¨æ•°ä½ç­‰ç­‰ ä¼˜ç‚¹è›®å¤šçš„ï¼Œéå¸¸å‰å®³çš„ä¸€ç¯‡è®ºæ–‡ google å¯èƒ½æ›´æ³¨é‡ä¸å½±å“ SLAã€æ€§èƒ½å’Œå¯é æ€§ï¼Œè¿™éƒ½æ˜¯å¾ˆ practical çš„ è‡³äºä¸ºä»€ä¹ˆæ··å…¥ä¸€ä¸ª ML æŒºå¥‡æ€ªçš„å…¶å®ã€‚ã€‚å¯èƒ½é‚£æ—¶å€™æµè¡Œå§ ","date":"2024-10-30","objectID":"/posts/paper-far-memory/:10:0","tags":["Paper Reading"],"title":"Paper Reading: Software-Defined Far Memory in Warehouse-Scale Computers","uri":"/posts/paper-far-memory/"},{"categories":null,"content":"Beyond malloc efficiency to fleet efficiency: a hugepage-aware memory allocator tcmalloc æ˜¯ google å¼€å‘çš„é«˜æ€§èƒ½å†…å­˜åˆ†é…å™¨ thread-caching mallocï¼Œè€Œ temeraire æ˜¯æœ¬æ–‡æå‡ºçš„ï¼Œæ”¹è¿› tcmallocï¼Œæ”¹è¿›å¤§é¡µåˆ†é…å‡å°‘å†…å­˜ç¢ç‰‡ã€‚https://github.com/google/tcmalloc ç®€å•æ¥è¯´ï¼Œå†…å­˜ç®¡ç†å¦‚ malloc åœ¨å †ä¸Šåˆ†é…å†…å­˜ï¼Œä½¿ç”¨ä¸€ä¸ªå†…å­˜æ± ï¼ˆé€šå¸¸æ˜¯é“¾è¡¨æ•°æ®ç»“æ„ï¼‰ç®¡ç†å·²åˆ†é…å’Œæœªåˆ†é…çš„å†…å­˜å— åˆ†é…æ—¶ï¼Œæ‰¾ä¸€ä¸ªè¶³å¤Ÿå¤§çš„ç©ºé—²å—åˆ†é…ç»™ç”¨æˆ·ï¼Œå¦åˆ™å‘ç³»ç»Ÿç”³è¯·æ›´å¤šå†…å­˜ï¼Œmalloc ä¸€èˆ¬ä¼šè¿”å›å¯¹é½çš„åœ°å€çš„æŒ‡é’ˆ ä½† malloc å­˜åœ¨å†…å­˜ç¢ç‰‡çš„é—®é¢˜ï¼Œå†…éƒ¨å’Œå¤–éƒ¨ç¢ç‰‡ï¼Œæ¯”å¦‚ malloc(1) ä½†å…¶å®ä¼šåˆ†é…æ›´å¤§çš„å†…å­˜å—ï¼ˆå¯¹é½ï¼‰ï¼Œæ‰€ä»¥æœ‰å†…éƒ¨ç¢ç‰‡ å¤–éƒ¨ç¢ç‰‡ï¼š10k(free) | 5k (busy) | 100k (free) è¿™æ—¶å€™ç”³è¯· 15k å†…å­˜ï¼Œç¬¬ä¸€æ®µä¸è¿ç»­ç”¨ä¸äº† è‡³äº brk() ä¹‹ç±»çš„ç³»ç»Ÿè°ƒç”¨å¯ä»¥çœ‹ä¸€äº›ç»å…¸å…«è‚¡ç†è§£ å°æ— codingï¼š https://xiaolincoding.com/os/3_memory/malloc.html ã€æ“ä½œç³»ç»Ÿã€‘mallocã€free å®ç°åŸç†ï¼š https://imageslr.com/2020/malloc.html malloc å­˜åœ¨ä¸å°‘é—®é¢˜ï¼Œä¸ä»…æ˜¯å†…å­˜ç¢ç‰‡çš„é—®é¢˜ï¼Œmalloc åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹è¡¨ç°ä¹Ÿä¸ä½³ï¼Œéœ€è¦ç”¨åˆ°é”æ¥ä¿æŠ¤å†…å­˜åˆ†é…å’Œé‡Šæ”¾å¹¶é¿å…ç«äº‰ã€‚è€Œ tcmalloc é‡‡ç”¨äº†çº¿ç¨‹æœ¬åœ°ç¼“å­˜ (Thread Local Cache) æ¥å‡å°‘é”ç«äº‰ï¼Œå¯¹äºå°å†…å­˜å—ï¼Œç›´æ¥ä»ç¼“å­˜åˆ†é…ã€‚ Go å°±é‡‡ç”¨äº†ç±»ä¼¼ TCmalloc çš„è®¾è®¡æ¥ç®¡ç†å†…å­˜ http://legendtkl.com/2015/12/11/go-memory/ tcmalloc: https://goog-perftools.sourceforge.net/doc/tcmalloc.html å›¾è§£ï¼šhttps://zhuanlan.zhihu.com/p/29216091 ã€æ€§èƒ½ã€‘tcmalloc ä½¿ç”¨å’ŒåŸç†ï¼šhttps://www.cnblogs.com/bandaoyu/p/16752421.html è‡³äº jemalloc, ptmalloc, tcmalloc çš„åŒºåˆ«ï¼Œå¯ä»¥çœ‹çœ‹ https://wenfh2020.com/2021/11/14/question-design-memory-pool/ tcmalloc ä½¿ç”¨è‡ªæ—‹é”åˆ†é…å¤§å†…å­˜ï¼Œä½†è¿™ä¹Ÿæœ‰é—®é¢˜ï¼Œå¤§å†…å­˜è¾ƒå¤šçš„æƒ…å†µä¸‹ï¼Ÿæ‰€ä»¥æœ¬æ–‡æå‡º TEMERAIRE æ¥ä¼˜åŒ–ã€‚ ","date":"2024-10-27","objectID":"/posts/paper-hugepage/:1:0","tags":["Paper Reading"],"title":"Paper Reading: Temeraire, Hugepage aware memory allocator","uri":"/posts/paper-hugepage/"},{"categories":null,"content":"Abstract Memory allocation represents significant compute cost at the warehouse scale ä¸€ç§ç»å…¸çš„ä¼˜åŒ–æ–¹æ³•æ˜¯æé«˜åˆ†é…å™¨çš„æ•ˆç‡ï¼Œä»¥æœ€å°åŒ–åˆ†é…å™¨ä»£ç æ‰€æ¶ˆè€—çš„å‘¨æœŸã€‚ ç„¶è€Œï¼Œå†…å­˜åˆ†é…å†³ç­–è¿˜é€šè¿‡æ•°æ®å¸ƒå±€å½±å“æ•´ä½“åº”ç”¨ç¨‹åºæ€§èƒ½ï¼Œæä¾›äº†é€šè¿‡ä½¿ç”¨æ›´å°‘çš„ç¡¬ä»¶èµ„æºå®Œæˆæ›´å¤šåº”ç”¨ç¨‹åºå·¥ä½œæ¥æé«˜æ•´ä¸ª fleetwide ç”Ÿäº§åŠ›çš„æœºä¼šã€‚åœ¨æ­¤ï¼Œæˆ‘ä»¬èšç„¦äºå¤§é¡µè¦†ç›–ç‡ hugepage coverageã€‚æˆ‘ä»¬æå‡ºäº† TEMERAIREï¼Œè¿™æ˜¯ TCMALLOC çš„ä¸€ä¸ªå¤§é¡µæ„ŸçŸ¥å¢å¼ºç‰ˆæœ¬ï¼Œæ—¨åœ¨å‡å°‘åº”ç”¨ç¨‹åºä»£ç ä¸­çš„ CPU å¼€é”€ã€‚æˆ‘ä»¬è®¨è®ºäº† TEMERAIRE çš„è®¾è®¡ä¸å®ç°ï¼ŒåŒ…æ‹¬å¤§é¡µæ„ŸçŸ¥å†…å­˜å¸ƒå±€çš„ç­–ç•¥ï¼Œä»¥æœ€å¤§åŒ–å¤§é¡µè¦†ç›–ç‡å¹¶æœ€å°åŒ–ç¢ç‰‡ fragmentation å¼€é”€ã€‚æˆ‘ä»¬å±•ç¤ºäº†é’ˆå¯¹ 8 ä¸ªåº”ç”¨ç¨‹åºçš„ç ”ç©¶ï¼Œå°†æ¯ç§’è¯·æ±‚æ•°ï¼ˆRPSï¼‰æé«˜äº† 7.7%ï¼Œå¹¶å°† RAM ä½¿ç”¨é‡å‡å°‘äº† 2.4%ã€‚ æˆ‘ä»¬è¿˜å±•ç¤ºäº†åœ¨æœºç¾¤ fleet è§„æ¨¡ä¸Šè¿›è¡Œçš„ 1% å®éªŒç»“æœä»¥åŠåœ¨è°·æ­Œä»“åº“ warehouse è§„æ¨¡è®¡ç®—æœºä¸­çš„é•¿æœŸéƒ¨ç½²æƒ…å†µã€‚è¿™å¸¦æ¥äº† 6% çš„ TLB æœªå‘½ä¸­åœæ»å‡å°‘ï¼Œä»¥åŠ 26% çš„ç”±äºç¢ç‰‡å¯¼è‡´çš„å†…å­˜æµªè´¹å‡å°‘ã€‚æœ€åï¼Œæˆ‘ä»¬è®¨è®ºäº†æ”¹è¿›åˆ†é…å™¨å¼€å‘è¿‡ç¨‹çš„é¢å¤–æŠ€æœ¯ä»¥åŠæœªæ¥å†…å­˜åˆ†é…å™¨çš„æ½œåœ¨ä¼˜åŒ–ç­–ç•¥ã€‚ ","date":"2024-10-27","objectID":"/posts/paper-hugepage/:2:0","tags":["Paper Reading"],"title":"Paper Reading: Temeraire, Hugepage aware memory allocator","uri":"/posts/paper-hugepage/"},{"categories":null,"content":"Introduction datacenter tax: within a warehouse-scale computer (WSC) is the cumulative time spent on common service overheads, such as serialization, RPC communication, compression, copying, and memory allocation WSC å·¥ä½œè´Ÿè½½çš„å¤šæ ·æ€§[23]æ„å‘³ç€æˆ‘ä»¬é€šå¸¸æ— æ³•é€šè¿‡ä¼˜åŒ–å•ä¸ªåº”ç”¨ç¨‹åºæ¥æ˜¾è‘—æé«˜æ•´ä¸ªç³»ç»Ÿçš„æ•ˆç‡ï¼Œå› ä¸ºæˆæœ¬åˆ†æ•£åœ¨è®¸å¤šç‹¬ç«‹çš„å·¥ä½œè´Ÿè½½ä¸Šã€‚ ç›¸æ¯”ä¹‹ä¸‹ï¼Œä¸“æ³¨äºæ•°æ®ä¸­å¿ƒç¨çš„ç»„æˆéƒ¨åˆ†å¯ä»¥åœ¨æ•´ä½“ä¸Šå®ç°æ˜¾è‘—çš„æ€§èƒ½å’Œæ•ˆç‡æå‡ï¼Œå› ä¸ºè¿™äº›ä¼˜åŒ–å¯ä»¥åº”ç”¨äºæ•´ä¸ªç±»åˆ«çš„åº”ç”¨ç¨‹åºã€‚è¿‡å»å‡ å¹´ä¸­ï¼Œæˆ‘ä»¬çš„å›¢é˜Ÿä¸“æ³¨äºminimizing the cost of memory allocation decisionsï¼Œå–å¾—äº†æ˜¾è‘—æˆæ•ˆ é€šè¿‡å¤§å¹…å‡å°‘å†…å­˜åˆ†é…æ‰€èŠ±è´¹çš„æ—¶é—´ï¼Œå®ç°äº†æ•´ä¸ªç³»ç»Ÿçš„æ”¶ç›Šã€‚ä½†æˆ‘ä»¬ä¸ä»…èƒ½å¤Ÿä¼˜åŒ–è¿™äº›ç»„æˆéƒ¨åˆ†çš„æˆæœ¬ã€‚é€šè¿‡æ”¹å˜ allocator æ¥æé«˜åº”ç”¨ç¨‹åºä»£ç çš„æ•ˆç‡ï¼Œä¹Ÿèƒ½å¸¦æ¥æ˜¾è‘—çš„æ”¶ç›Šã€‚æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬è€ƒè™‘å¦‚ä½•é€šè¿‡æé«˜å†…å­˜åˆ†é…å™¨æä¾›çš„ hugepage coverage æ¥ä¼˜åŒ–åº”ç”¨ç¨‹åºæ€§èƒ½ã€‚ Cache and Translation Lookaside Buffer (TLB) misses æ˜¯ç°ä»£ç³»ç»Ÿä¸­ä¸»è¦çš„æ€§èƒ½å¼€é”€ã€‚åœ¨ WSC ä¸­ï¼Œå†…å­˜å¢™[44]é—®é¢˜æ˜¾è‘—ï¼šä¸€é¡¹åˆ†æ[23]æ˜¾ç¤ºï¼Œ50% cycles å› å†…å­˜åœæ»ã€‚æˆ‘ä»¬è‡ªå·±çš„å·¥ä½œè´Ÿè½½åˆ†æå‘ç°ï¼Œå¤§çº¦ 20% çš„å‘¨æœŸå›  TLB æœªå‘½ä¸­è€Œåœæ»ã€‚ Hugepages are a processor feature, å¯ä»¥æ˜¾è‘—å‡å°‘ TLB æœªå‘½ä¸­çš„æ¬¡æ•°åŠå…¶æˆæœ¬ å¤§é¡µçš„å¢åŠ å¤§å°ä½¿å¾—ç›¸åŒæ•°é‡çš„ TLB æ¡ç›®èƒ½å¤Ÿæ˜ å°„æ›´å¤§èŒƒå›´çš„å†…å­˜ã€‚åœ¨æ‰€ç ”ç©¶çš„ç³»ç»Ÿä¸­ï¼Œå¤§é¡µè¿˜å‡å°‘äº†æœªå‘½ä¸­+å¡«å……çš„æ€»åœæ»æ—¶é—´ï¼Œå› ä¸ºå®ƒä»¬çš„é¡µè¡¨è¡¨ç¤ºéœ€è¦éå†çš„å±‚çº§å°‘äº†ä¸€å±‚ã€‚ å¤§é¡µï¼Œå¦‚æœ TLB æ˜ å°„ 2MB çš„é¡µé¢ï¼Œ1G åªéœ€è¦ 512 ä¸ªé¡µé¢ï¼Œå‡å°‘äº†æ˜ å°„æ•°é‡ è™½ç„¶åˆ†é…å™¨æ— æ³•ä¿®æ”¹ç”¨æˆ·ä»£ç è®¿é—®çš„å†…å­˜é‡ï¼Œç”šè‡³æ— æ³•æ”¹å˜è®¿é—®å¯¹è±¡çš„æ¨¡å¼ï¼Œä½†å®ƒå¯ä»¥ä¸æ“ä½œç³»ç»Ÿåˆä½œå¹¶æ§åˆ¶æ–°åˆ†é…çš„å†…å­˜å¸ƒå±€ã€‚é€šè¿‡ä¼˜åŒ–å¤§é¡µè¦†ç›–ç‡ï¼Œåˆ†é…å™¨å¯ä»¥å‡å°‘ TLB æœªå‘½ä¸­ã€‚åœ¨ C å’Œ C++ç­‰è¯­è¨€ä¸­ï¼Œå†…å­˜å¸ƒå±€å†³ç­–è¿˜å¿…é¡»å¤„ç†å…¶å†³ç­–æ˜¯æœ€ç»ˆçš„åæœï¼šå¯¹è±¡ä¸€æ—¦åˆ†é…å°±æ— æ³•ç§»åŠ¨[11]ã€‚åˆ†é…å¸ƒå±€å†³ç­–åªèƒ½åœ¨åˆ†é…æ—¶è¿›è¡Œä¼˜åŒ–ã€‚è¿™ç§æ–¹æ³•ä¸æˆ‘ä»¬åœ¨è¯¥é¢†åŸŸçš„å…ˆå‰å·¥ä½œç›¸åï¼Œå› ä¸ºæˆ‘ä»¬å¯èƒ½ä¼šå¢åŠ åˆ†é…çš„ CPU æˆæœ¬ï¼Œå¢åŠ æ•°æ®ä¸­å¿ƒç¨ï¼Œä½†é€šè¿‡å‡å°‘å…¶ä»–åœ°æ–¹çš„å¤„ç†å™¨åœæ»æ¥å¼¥è¡¥ã€‚è¿™æé«˜äº†åº”ç”¨ç¨‹åºæŒ‡æ ‡ï¼Œå¦‚æ¯ç§’è¯·æ±‚æ•°ï¼ˆRPSï¼‰ã€‚ TEMERAIRE çš„è®¾è®¡ï¼šæˆ‘ä»¬è®¾è®¡äº† TEMERAIREï¼Œè¿™æ˜¯ TCMALLOC çš„ä¸€ä¸ªå¤§é¡µæ„ŸçŸ¥å¢å¼ºç‰ˆæœ¬ï¼Œæ—¨åœ¨å‡å°‘åº”ç”¨ç¨‹åºä»£ç ä¸­çš„ CPU å¼€é”€ã€‚æˆ‘ä»¬æå‡ºäº†å¤§é¡µæ„ŸçŸ¥å†…å­˜å¸ƒå±€çš„ç­–ç•¥ï¼Œä»¥æœ€å¤§åŒ–å¤§é¡µè¦†ç›–ç‡å¹¶æœ€å°åŒ–ç¢ç‰‡å¼€é”€ã€‚ åœ¨å¤æ‚çœŸå®ä¸–ç•Œåº”ç”¨å’Œ WSC è§„æ¨¡ä¸­çš„è¯„ä¼°ï¼šæˆ‘ä»¬åœ¨ WSC ä¸­å¯¹ TEMERAIRE è¿›è¡Œäº†è¯„ä¼°ï¼Œæµ‹é‡äº†åœ¨æˆ‘ä»¬çš„åŸºç¡€è®¾æ–½ä¸­è¿è¡Œçš„ 8 ä¸ªåº”ç”¨ç¨‹åºçš„æ ·æœ¬ï¼Œè§‚å¯Ÿåˆ°æ¯ç§’è¯·æ±‚æ•°ï¼ˆRPSï¼‰å¢åŠ äº† 7.7%ï¼ŒRAM ä½¿ç”¨é‡å‡å°‘äº† 2.4%ã€‚å°†è¿™äº›æŠ€æœ¯åº”ç”¨äºè°·æ­Œ WSC ä¸­çš„æ‰€æœ‰åº”ç”¨ç¨‹åºï¼Œå¸¦æ¥äº† 6%çš„ TLB æœªå‘½ä¸­åœæ»å‡å°‘ï¼Œä»¥åŠ 26%çš„ç”±äºç¢ç‰‡å¯¼è‡´çš„å†…å­˜æµªè´¹å‡å°‘ã€‚ ä¼˜åŒ–å†…å­˜åˆ†é…å™¨æ”¹è¿›å¼€å‘è¿‡ç¨‹çš„ç­–ç•¥ï¼šæˆ‘ä»¬ä½¿ç”¨è·Ÿè¸ªã€é¥æµ‹å’Œåœ¨ä»“åº“è§„æ¨¡ä¸Šçš„å®éªŒç›¸ç»“åˆçš„æ–¹æ³•ï¼Œæå‡ºäº†ä¼˜åŒ–å†…å­˜åˆ†é…å™¨æ”¹è¿›å¼€å‘è¿‡ç¨‹çš„ç­–ç•¥ã€‚ ","date":"2024-10-27","objectID":"/posts/paper-hugepage/:3:0","tags":["Paper Reading"],"title":"Paper Reading: Temeraire, Hugepage aware memory allocator","uri":"/posts/paper-hugepage/"},{"categories":null,"content":"The challenges of coordinating Hugepages è™šæ‹Ÿå†…å­˜éœ€è¦é€šè¿‡ç§°ä¸º Translation Looka- side Buffers (TLBs) çš„ç¼“å­˜å°†ç”¨æˆ·ç©ºé—´åœ°å€è½¬æ¢ä¸ºç‰©ç†åœ°å€ TLB çš„æ¡ç›®æ•°é‡æœ‰é™ï¼Œå¯¹äºè®¸å¤šåº”ç”¨ç¨‹åºï¼Œæ•´ä¸ª TLB ä»…è¦†ç›–ä½¿ç”¨é»˜è®¤é¡µé¢å¤§å°çš„æ€»å†…å­˜å ç”¨çš„ä¸€å°éƒ¨åˆ†ã€‚ç°ä»£å¤„ç†å™¨é€šè¿‡æ”¯æŒ TLB ä¸­çš„å¤§é¡µæ¥å¢åŠ è¿™ç§è¦†ç›–èŒƒå›´ã€‚ä¸€ä¸ªå¯¹é½çš„å¤§é¡µï¼ˆåœ¨ x86 ä¸Šé€šå¸¸ä¸º 2MiBï¼‰ä»…å ç”¨ä¸€ä¸ª TLB æ¡ç›®ã€‚å¤§é¡µé€šè¿‡å¢åŠ  TLB çš„æœ‰æ•ˆå®¹é‡å¹¶å‡å°‘ TLB æœªå‘½ä¸­æ¥å‡å°‘åœæ» ä¼ ç»Ÿçš„åˆ†é…å™¨ manage memory in page-sized chunksã€‚ å¯¹äºå°†å†…å­˜é‡Šæ”¾å›æ“ä½œç³»ç»Ÿçš„åˆ†é…å™¨ï¼ˆåœ¨ä»“åº“è§„æ¨¡ä¸­ï¼Œæˆ‘ä»¬æ‹¥æœ‰é•¿æ—¶é—´è¿è¡Œçš„å…·æœ‰åŠ¨æ€å·¥ä½œå‘¨æœŸçš„è´Ÿè½½ï¼Œè¿™æ˜¯å¿…è¦çš„ï¼‰æ¥è¯´ï¼Œé¢ä¸´æ›´å¤§çš„æŒ‘æˆ˜ã€‚Transparent Huge Pages (THP) ä¸ºå†…æ ¸æä¾›äº†æœºä¼šï¼Œä½¿å…¶èƒ½å¤Ÿåœ¨é¡µè¡¨ä¸­ä½¿ç”¨å¤§é¡µè¦†ç›–è¿ç»­çš„é¡µé¢ã€‚è¡¨é¢ä¸Šçœ‹ï¼Œå†…å­˜åˆ†é…å™¨åªéœ€åˆ†é…å¯¹é½ä¸”å¤§å°ä¸ºå¤§é¡µçš„å†…å­˜å—å³å¯åˆ©ç”¨è¿™ç§æ”¯æŒã€‚ éå¤§é¡µå¯¹é½çš„å†…å­˜åŒºåŸŸçš„è¿”å›éœ€è¦å†…æ ¸ä½¿ç”¨è¾ƒå°çš„é¡µé¢æ¥è¡¨ç¤ºå‰©ä½™éƒ¨åˆ†ï¼Œä»è€Œå‰Šå¼±äº†å†…æ ¸æä¾›å¤§é¡µçš„èƒ½åŠ›ï¼Œå¹¶å¯¹å‰©ä½™ä½¿ç”¨çš„é¡µé¢æ–½åŠ äº†æ€§èƒ½æˆæœ¬ã€‚ æ¯”å¦‚ç”¨æˆ·ç”³è¯· 3MBï¼Œå…¶ä¸­å¤§é¡µå¯ä»¥ç»™ 2MB å‰©ä¸‹çš„éå¯¹é½ï¼Œç”¨å°é¡µ æˆ–è€…ï¼Œåˆ†é…å™¨å¯ä»¥åœ¨æ•´ä¸ªå¤§é¡µå˜ä¸ºç©ºé—²ä¹‹å‰ä¸å°†å…¶è¿”å›ç»™æ“ä½œç³»ç»Ÿã€‚è¿™ä¿ç•™äº†å¤§é¡µè¦†ç›–ï¼Œä½†ç›¸å¯¹äºå®é™…ä½¿ç”¨æƒ…å†µï¼Œå¯èƒ½ä¼šå¯¼è‡´æ˜¾è‘—çš„æ”¾å¤§æ•ˆåº”ï¼Œä½¿å†…å­˜é—²ç½®ã€‚DRAM æ˜¯éƒ¨ç½² WSC çš„æ˜¾è‘—æˆæœ¬[27]ã€‚åˆ†é…å™¨åœ¨ç®¡ç†å¤–éƒ¨ç¢ç‰‡ï¼ˆå³å—ä¸­å¤ªå°è€Œæ— æ³•ç”¨äºè¯·æ±‚åˆ†é…çš„æœªä½¿ç”¨ç©ºé—´ï¼‰æ–¹é¢åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­éå¸¸é‡è¦ã€‚ä¾‹å¦‚ï¼Œè€ƒè™‘å›¾ 1 ä¸­çš„åˆ†é…ã€‚ç»è¿‡è¿™ä¸€ç³»åˆ—åˆ†é…åï¼Œæœ‰ 2 ä¸ªå•ä½çš„ç©ºé—²ç©ºé—´ã€‚é€‰æ‹©æ˜¯ä½¿ç”¨å°é¡µï¼Œè¿™ä¼šå¯¼è‡´è¾ƒä½çš„ç¢ç‰‡åŒ–ä½† TLB æ¡ç›®ä½¿ç”¨æ•ˆç‡è¾ƒä½ï¼Œæˆ–è€…ä½¿ç”¨å¤§é¡µï¼Œè¿™å…·æœ‰ TLB æ•ˆç‡ä½†ç¢ç‰‡åŒ–è¾ƒé«˜ã€‚ å›¾ä¸€ï¼Œå¤§é¡µå¸¦æ¥çš„ç¢ç‰‡ é€šè¿‡å¯†é›†åœ°å°†åˆ†é…ä¸å¤§é¡µè¾¹ç•Œå¯¹é½ï¼Œä¼˜å…ˆä½¿ç”¨åˆ†é…çš„å¤§é¡µï¼Œå¹¶ï¼ˆç†æƒ³æƒ…å†µä¸‹ï¼‰ä»¥ç›¸åŒçš„å¯¹é½æ–¹å¼è¿”å›æœªä½¿ç”¨çš„å†…å­˜ï¼Œæ¥ä¸å…¶ç»“æœåˆä½œã€‚å¤§é¡µæ„ŸçŸ¥çš„åˆ†é…å™¨æœ‰åŠ©äºåœ¨ç”¨æˆ·çº§åˆ«ç®¡ç†å†…å­˜è¿ç»­æ€§ã€‚ç›®æ ‡æ˜¯æœ€å¤§é™åº¦åœ°å°†åˆ†é…æ‰“åŒ…åˆ°æ¥è¿‘æ»¡çš„å¤§é¡µä¸Šï¼Œåä¹‹äº¦ç„¶ï¼Œæœ€å°åŒ–åœ¨ç©ºï¼ˆæˆ–è¾ƒç©ºï¼‰å¤§é¡µä¸Šä½¿ç”¨çš„ç©ºé—´ï¼Œä»¥ä¾¿å®ƒä»¬å¯ä»¥ä½œä¸ºå®Œæ•´çš„å¤§é¡µè¿”å›ç»™æ“ä½œç³»ç»Ÿã€‚è¿™æœ‰æ•ˆåœ°ä½¿ç”¨å†…å­˜ï¼Œå¹¶ä¸å†…æ ¸çš„é€æ˜å¤§é¡µæ”¯æŒè‰¯å¥½äº¤äº’ã€‚æ­¤å¤–ï¼Œæ›´ä¸€è‡´åœ°åˆ†é…å’Œé‡Šæ”¾å¤§é¡µå½¢æˆäº†ä¸€ä¸ªç§¯æçš„åé¦ˆå¾ªç¯ï¼šå‡å°‘å†…æ ¸çº§åˆ«çš„ç¢ç‰‡åŒ–ï¼Œå¹¶æé«˜æœªæ¥åˆ†é…ç”±å¤§é¡µæ”¯æŒçš„å¯èƒ½æ€§ã€‚ ","date":"2024-10-27","objectID":"/posts/paper-hugepage/:4:0","tags":["Paper Reading"],"title":"Paper Reading: Temeraire, Hugepage aware memory allocator","uri":"/posts/paper-hugepage/"},{"categories":null,"content":"Overview of TCMALLOC TCMALLOC æ˜¯ä¸€ç§åœ¨å¤§è§„æ¨¡åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨çš„å†…å­˜åˆ†é…å™¨ï¼Œå¸¸è§äº WSC ç¯å¢ƒä¸­ã€‚å®ƒå±•ç¤ºäº†å¼ºå¤§çš„æ€§èƒ½[21]ã€‚æˆ‘ä»¬çš„è®¾è®¡ç›´æ¥å»ºç«‹åœ¨ TCMALLOC çš„ç»“æ„ä¸Šã€‚ å›¾ 2 å±•ç¤ºäº† TCMALLOC ä¸­å†…å­˜çš„ç»„ç»‡æ–¹å¼ã€‚å¯¹è±¡æŒ‰å¤§å°è¿›è¡Œéš”ç¦»ã€‚é¦–å…ˆï¼ŒTCMALLOC å°†å†…å­˜åˆ’åˆ†ä¸ºå¯¹é½ page size çš„ spansã€‚ TCMALLOC çš„ç»“æ„ç”±å…¶å¯¹é©±åŠ¨ä»»ä½•å†…å­˜åˆ†é…å™¨çš„ä¸¤ä¸ªç›¸åŒé—®é¢˜çš„å›ç­”æ‰€å®šä¹‰ã€‚ æˆ‘ä»¬å¦‚ä½•é€‰æ‹©å¯¹è±¡å¤§å°å¹¶ç»„ç»‡å…ƒæ•°æ®ä»¥æœ€å°åŒ–ç©ºé—´å¼€é”€å’Œç¢ç‰‡åŒ–ï¼Ÿ æˆ‘ä»¬å¦‚ä½•å¯æ‰©å±•åœ°æ”¯æŒå¹¶å‘åˆ†é…ï¼Ÿ è¶³å¤Ÿå¤§çš„åˆ†é…ç”±ä»…åŒ…å«åˆ†é…å¯¹è±¡çš„ span æ¥æ»¡è¶³ã€‚å…¶ä»– span åŒ…å«å¤šä¸ªç›¸åŒå¤§å°ï¼ˆsizeclassï¼‰çš„è¾ƒå°å¯¹è±¡ã€‚â€œå°â€å¯¹è±¡å¤§å°çš„ç•Œé™æ˜¯ 256 KiBã€‚åœ¨è¿™ä¸ªâ€œå°â€é˜ˆå€¼å†…ï¼Œåˆ†é…è¯·æ±‚è¢«å‘ä¸Šèˆå…¥åˆ° 100 ä¸ª sizeclass ä¹‹ä¸€ã€‚ spans å¤§å°æ€ä¹ˆå®šä¹‰ï¼Ÿå°å¯¹è±¡æ˜¯ä»€ä¹ˆ è¿™é‡Œçš„ å¯¹è±¡ object æŒ‡çš„æ˜¯å†…å­˜å— TCMALLOC å°†å¯¹è±¡å­˜å‚¨åœ¨ä¸€ç³»åˆ—ç¼“å­˜ä¸­ï¼Œå¦‚å›¾ 3 æ‰€ç¤ºã€‚span ä»ç®€å•çš„ pageheap ä¸­åˆ†é…ï¼Œpageheap è·Ÿè¸ªæ‰€æœ‰æœªä½¿ç”¨çš„é¡µé¢å¹¶è¿›è¡Œæœ€ä½³é€‚åº”åˆ†é…ã€‚ pageheap è¿˜è´Ÿè´£åœ¨å¯èƒ½çš„æƒ…å†µä¸‹å°†ä¸å†éœ€è¦çš„å†…å­˜è¿”å›ç»™æ“ä½œç³»ç»Ÿã€‚ ä¸å…¶åœ¨ free()è·¯å¾„ä¸Šæ‰§è¡Œæ­¤æ“ä½œï¼Œä¸å¦‚å®šæœŸè°ƒç”¨ä¸€ä¸ªä¸“ç”¨çš„ release-memory æ–¹æ³•ï¼Œæ—¨åœ¨ç»´æŒä¸€ä¸ªå¯é…ç½®çš„ç¨³å®šé‡Šæ”¾é€Ÿç‡ï¼ˆMB/sï¼‰ã€‚è¿™æ˜¯ä¸€ç§ heuristic æ–¹æ³•ï¼ŒTCMALLOC å¸Œæœ›åœ¨ç¨³æ€ä¸‹å°½å¯èƒ½å°‘åœ°ä½¿ç”¨å†…å­˜ï¼Œé¿å…ä½¿ç”¨å…ˆå‰æä¾›çš„å†…å­˜æ¥çœç•¥æ˜‚è´µçš„ç³»ç»Ÿåˆ†é…ã€‚ å®šæœŸé‡Šæ”¾ï¼ŒGCï¼Ÿé‚£éœ€è¦ stop the world å— ç†æƒ³æƒ…å†µä¸‹ï¼ŒTCMALLOC ä¼šè¿”å›ç”¨æˆ·ä»£ç å°†ä¸å†éœ€è¦çš„æ‰€æœ‰å†…å­˜ã€‚å†…å­˜éœ€æ±‚å˜åŒ–ä¸å¯é¢„æµ‹ï¼Œè¿™ä½¿å¾—åœ¨åŒæ—¶ä¿ç•™å†…å­˜ä»¥é¿å…ç³»ç»Ÿè°ƒç”¨å’Œé¡µé¢é”™è¯¯çš„æƒ…å†µä¸‹ï¼Œè¿”å›å°†æœªä½¿ç”¨çš„å†…å­˜å˜å¾—å…·æœ‰æŒ‘æˆ˜æ€§ã€‚å…³äºå†…å­˜è¿”å›ç­–ç•¥çš„æ›´å¥½å†³ç­–å…·æœ‰å¾ˆé«˜çš„ä»·å€¼ï¼Œå¹¶åœ¨ç¬¬ 7 èŠ‚ä¸­è¿›è¡Œäº†è®¨è®ºã€‚ TCMALLOC é¦–å…ˆå°è¯•ä»â€œæœ¬åœ°â€ç¼“å­˜ä¸­æä¾›åˆ†é…ï¼Œç±»ä¼¼äºå¤§å¤šæ•°ç°ä»£åˆ†é…å™¨[9,12,20,39]ã€‚æœ€åˆè¿™äº›æ˜¯æ‰€è°“çš„æ¯ä¸ªçº¿ç¨‹ç¼“å­˜ï¼ˆper-Thread Cachesï¼‰ï¼Œä¸ºæ¯ä¸ª sizeclass å­˜å‚¨ä¸€ä¸ªç©ºé—²å¯¹è±¡åˆ—è¡¨ã€‚ä¸ºäº†å‡å°‘å­¤ç«‹å†…å­˜å¹¶æé«˜é«˜åº¦çº¿ç¨‹åŒ–åº”ç”¨ç¨‹åºçš„é‡ç”¨ç‡ï¼ŒTCMALLOC ç°åœ¨ä½¿ç”¨æ¯ä¸ªè¶…çº¿ç¨‹æœ¬åœ°ç¼“å­˜ã€‚ å½“æœ¬åœ°ç¼“å­˜æ²¡æœ‰é€‚å½“ sizeclass çš„å¯¹è±¡æ¥æ»¡è¶³è¯·æ±‚ï¼ˆæˆ–åœ¨å°è¯•é‡Šæ”¾åæœ‰å¤ªå¤šå¯¹è±¡ï¼‰æ—¶ï¼Œè¯·æ±‚ä¼šè·¯ç”±åˆ°è¯¥ sizeclass çš„å•ä¸ªä¸­å¤®ç¼“å­˜ã€‚è¿™æœ‰ä¸¤ä¸ªç»„æˆéƒ¨åˆ†â€”â€”ä¸€ä¸ªå°çš„å¿«é€Ÿã€å—äº’æ–¥é”ä¿æŠ¤çš„ä¼ è¾“ç¼“å­˜ transfer cacheï¼ˆåŒ…å«è¯¥ sizeclass çš„æ‰å¹³æ•°ç»„å¯¹è±¡ï¼‰å’Œä¸€ä¸ªå¤§çš„ã€å—äº’æ–¥é”ä¿æŠ¤çš„ä¸­å¤®ç©ºé—²åˆ—è¡¨ central freelistï¼ŒåŒ…å«åˆ†é…ç»™è¯¥ sizeclass çš„æ‰€æœ‰ span ï¼›å¯ä»¥ä»è¿™äº› span ä¸­è·å–å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥å°†å¯¹è±¡è¿”å›ç»™è¿™äº› span ã€‚å½“ä¸€ä¸ª span ä¸­çš„æ‰€æœ‰å¯¹è±¡éƒ½è¿”å›åˆ°ä¸­å¤®ç©ºé—²åˆ—è¡¨ä¸­çš„ span æ—¶ï¼Œè¯¥ span å°†è¿”å›åˆ° pageheapã€‚ Sizeclass æ˜¯æŒ‡å†…å­˜åˆ†é…å™¨æ ¹æ®ä¸åŒå¤§å°çš„å†…å­˜å—å¯¹å†…å­˜è¿›è¡Œåˆ†ç±»çš„æ–¹æ³•ã€‚åœ¨ TCMALLOC ä¸­ï¼Œsizeclass ç”¨äºå°†å†…å­˜å—åˆ’åˆ†ä¸ºç‰¹å®šå¤§å°çš„ç±»åˆ«ï¼Œæ¯ä¸ªç±»åˆ«å¯¹åº”ä¸€å®šèŒƒå›´çš„å†…å­˜å—å¤§å°ã€‚ ä¸¾ä¸ªä¾‹å­ï¼š Sizeclass 1: ç®¡ç† 8 å­—èŠ‚çš„å†…å­˜å—ã€‚ Sizeclass 2: ç®¡ç† 16 å­—èŠ‚çš„å†…å­˜å—ã€‚ Sizeclass 3: ç®¡ç† 32 å­—èŠ‚çš„å†…å­˜å—ã€‚ Sizeclass 4: ç®¡ç† 64 å­—èŠ‚çš„å†…å­˜å—ã€‚ åœ¨æˆ‘ä»¬çš„ WSC ä¸­ï¼Œå¤§å¤šæ•°åˆ†é…éƒ½å¾ˆå°ï¼ˆ50%çš„åˆ†é…ç©ºé—´æ˜¯ â‰¤ 8192 å­—èŠ‚çš„å¯¹è±¡ï¼‰ï¼Œå¦‚å›¾ 4 æ‰€ç¤ºã€‚è¿™äº›å¯¹è±¡éšåè¢«èšåˆåˆ°è·¨åº¦ä¸­ã€‚pageheap ä¸»è¦åˆ†é… 1 é¡µæˆ– 2 é¡µçš„è·¨åº¦ï¼Œå¦‚å›¾ 5 æ‰€ç¤ºã€‚80%çš„è·¨åº¦å°äºä¸€ä¸ªå¤§é¡µã€‚ â€œstackâ€ ç¼“å­˜çš„è®¾è®¡ä½¿ç³»ç»Ÿå…·æœ‰æœ‰ç”¨çš„æ¨¡å—åŒ–ç‰¹æ€§ï¼ŒTCMALLOC çš„ pageheap æœ‰ä¸€ä¸ªç®€å•çš„æ¥å£æ¥ç®¡ç†å†…å­˜ï¼ŒNew(N)ï¼ŒDelete(S)ï¼ŒRelease(N) ","date":"2024-10-27","objectID":"/posts/paper-hugepage/:5:0","tags":["Paper Reading"],"title":"Paper Reading: Temeraire, Hugepage aware memory allocator","uri":"/posts/paper-hugepage/"},{"categories":null,"content":"TEMERAIREâ€™s approach TEMERAIRE æ˜¯æœ¬æ–‡å¯¹ TCMALLOC çš„è´¡çŒ®ï¼Œå®ƒç”¨ä¸€ä¸ªæ—¨åœ¨æœ€å¤§é™åº¦å¡«å……ï¼ˆå’Œæ¸…ç©ºï¼‰å¤§é¡µçš„è®¾è®¡æ›¿æ¢äº† pageheapã€‚ æˆ‘ä»¬å¼€å‘äº†å¯å‘å¼æ–¹æ³•ï¼Œå°†åˆ†é…å¯†é›†åœ°æ‰“åŒ…åˆ°é«˜ä½¿ç”¨ç‡çš„å¤§é¡µä¸Šï¼Œå¹¶åŒæ—¶å½¢æˆå®Œå…¨æœªä½¿ç”¨çš„å¤§é¡µä»¥è¿”å›ç»™æ“ä½œç³»ç»Ÿã€‚ Slack æ˜¯æŒ‡åˆ†é…è¯·æ±‚çš„å¤§å°ä¸ä¸‹ä¸€ä¸ªå®Œæ•´å¤§é¡µä¹‹é—´çš„å·®è·ã€‚ä»æ“ä½œç³»ç»Ÿåˆ†é…çš„è™šæ‹Ÿåœ°å€ç©ºé—´åœ¨æ²¡æœ‰ reserving physical memory æ—¶æ˜¯ unbacked çš„ã€‚åœ¨ä½¿ç”¨æ—¶ï¼Œå®ƒç”±æ“ä½œç³»ç»Ÿæ”¯æŒï¼Œé€šè¿‡ç‰©ç†å†…å­˜æ˜ å°„ã€‚æˆ‘ä»¬å¯ä»¥å†æ¬¡å°†å†…å­˜é‡Šæ”¾ç»™æ“ä½œç³»ç»Ÿï¼Œä½¿å…¶å†æ¬¡ unbackedã€‚æˆ‘ä»¬ä¸»è¦åœ¨å¤§é¡µ boundaries å†…æ‰“åŒ…ï¼Œä½†ä½¿ç”¨å¤§é¡µ regions æ¥è·¨å¤§é¡µè¾¹ç•Œæ‰“åŒ…åˆ†é…ã€‚ slack æ¯”å¦‚ç”³è¯· 5MB å¾—åˆ° 3 ä¸ª 2MB å¤§é¡µï¼Œgap å°±æ˜¯ 1MB ç”³è¯·å®Œæˆåï¼Œç‰©ç†å†…å­˜è¿˜æ²¡æœ‰åˆ†é…ï¼Œå¤„äº unbacked çŠ¶æ€ï¼Œå½“ç”¨çš„æ—¶å€™æ‰æ˜ å°„ Total memory demand varies unpredictably with time, but not every allocation is released. Completely draining hugepages implies packing memory at hugepage granularity. Draining hugepages gives us new release decision points Mistakes are costly, but work is not. æˆ‘ä»¬çš„åˆ†é…å™¨é€šè¿‡å§”æ‰˜ç»™å‡ ä¸ªå­ç»„ä»¶æ¥å®ç°å…¶æ¥å£ï¼Œå¦‚å›¾ 6 æ‰€ç¤ºã€‚æ¯ä¸ªç»„ä»¶éƒ½ç‰¢è®°ä¸Šè¿°åŸåˆ™ï¼Œå¹¶é’ˆå¯¹å…¶å¤„ç†çš„æœ€ä½³åˆ†é…ç±»å‹è¿›è¡Œä¸“é—¨åŒ–ã€‚æ ¹æ®åŸåˆ™#4ï¼Œwe emphasize smart placement over speed è™½ç„¶ TEMERAIRE çš„å…·ä½“å®ç°ä¸ TCMALLOC å†…éƒ¨ç»“æ„ç›¸å…³ï¼Œä½†å¤§å¤šæ•°ç°ä»£åˆ†é…å™¨å…±äº«ç±»ä¼¼çš„é¡µé¢ï¼ˆæˆ–æ›´é«˜ï¼‰ç²’åº¦çš„å¤§åå¤‡åˆ†é…ï¼Œå¦‚ TCMALLOC çš„è·¨åº¦ï¼šæ¯”è¾ƒ jemalloc çš„â€œextentsâ€[20]ï¼ŒHoard çš„â€œsuperblocksâ€[9]ï¼Œå’Œ mimalloc çš„â€œpagesâ€[29]ã€‚Hoard çš„ 8KB superblocks ç›´æ¥é€šè¿‡â€˜mmapâ€˜åˆ†é…ï¼Œé˜²æ­¢å¤§é¡µè¿ç»­æ€§ã€‚è¿™äº› superblocks å¯ä»¥æ”¹ä¸ºå¯†é›†åœ°æ‰“åŒ…åˆ°å¤§é¡µä¸Šã€‚mimalloc å°†å…¶ 64KiB+çš„â€œpagesâ€æ”¾ç½®åœ¨â€œsegmentsâ€ä¸­ï¼Œä½†è¿™äº›æ˜¯æŒ‰çº¿ç¨‹ç»´æŠ¤çš„ï¼Œè¿™é˜»ç¢äº†è¿›ç¨‹æ®µä¹‹é—´çš„å¯†é›†æ‰“åŒ…ã€‚æ€¥åˆ‡åœ°å°†é¡µé¢è¿”å›ç»™æ“ä½œç³»ç»Ÿå¯ä»¥æœ€å°åŒ–è¿™é‡Œçš„ RAM æˆæœ¬ï¼Œä½†ä¼šåˆ†è§£å¤§é¡µã€‚è¿™äº›åˆ†é…å™¨ä¹Ÿå¯ä»¥ä»ç±»ä¼¼ TEMERAIRE çš„å¤§é¡µæ„ŸçŸ¥åˆ†é…å™¨ä¸­å—ç›Šã€‚ jemalloc, hoard éƒ½æ˜¯å¾ˆå¥½çš„å†…å­˜åˆ†é…å™¨ jemalloc ä¹Ÿé‡‡ç”¨äº† temeraire çš„ç­–ç•¥ï¼Œé‡‡ç”¨äº†å¯å‘å¼çš„é¿å…ç¢ç‰‡ï¼Œä½†ä¸å®Œå…¨ä¸€æ · https://github.com/jemalloc/jemalloc/issues/2301 ","date":"2024-10-27","objectID":"/posts/paper-hugepage/:6:0","tags":["Paper Reading"],"title":"Paper Reading: Temeraire, Hugepage aware memory allocator","uri":"/posts/paper-hugepage/"},{"categories":null,"content":"The overall algorithm å›¾ 7 åˆ†é…ç®—æ³•ï¼Œ å¦‚æœå¤§äº 1Gï¼Œè°ƒç”¨ HugeCacheï¼Œslack ä¸é‡è¦ å¦‚æœå°äº 1MB é‡‡ç”¨ HugeFillerï¼Œè°ƒç”¨å¤§é¡µ å¦‚æœ 1M-2M ä¹‹é—´ï¼Œå°è¯• HugeFiller å¤ç”¨å†…å­˜ï¼Œå¤„ç†å°è¯·æ±‚ï¼Œæ‰“åŒ…åˆ° hugepage 2M ä¹‹ä¸Šçš„ç”¨ HugeRegion æ¥åˆ†é…ï¼Œå¦‚æœä¸å¤Ÿå°± HugeCache åˆ†é…å¤§é¡µ æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æœ€å¤§é™åº¦åœ°å‡å°‘ç”Ÿæˆçš„ slackï¼Œå¦‚æœæˆ‘ä»¬ç¡®å®ç”Ÿæˆäº† slackï¼Œåˆ™å°†å…¶é‡ç”¨äºå…¶ä»–åˆ†é…ï¼ˆå¦‚åŒä»»ä½•é¡µé¢çº§åˆ«çš„ç¢ç‰‡åŒ–ä¸€æ ·ï¼‰ã€‚ åœ¨æ‰€æœ‰ç»„ä»¶èƒŒåæ˜¯ HugeAllocatorï¼Œå®ƒå¤„ç†è™šæ‹Ÿå†…å­˜å’Œæ“ä½œç³»ç»Ÿã€‚å®ƒä¸ºå…¶ä»–ç»„ä»¶æä¾›æœªæ”¯æŒçš„å†…å­˜ï¼Œè¿™äº›ç»„ä»¶å¯ä»¥æ”¯æŒå¹¶ä¼ é€’ä¸‹å»ã€‚æˆ‘ä»¬è¿˜ç»´æŠ¤ä¸€ä¸ªbacked å®Œå…¨ç©ºçš„å¤§é¡µç¼“å­˜ï¼Œç§°ä¸º HugeCache HugeCache å¤„äº backedï¼ŒåŸå› æ˜¯ä»€ä¹ˆï¼Ÿ æˆ‘ä»¬ä¿æŒä¸€ä¸ªéƒ¨åˆ†å¡«å……çš„å•ä¸ªå¤§é¡µåˆ—è¡¨ï¼ˆHugeFillerï¼‰ï¼Œè¿™äº›å¤§é¡µå¯ä»¥é€šè¿‡åç»­çš„å°åˆ†é…å¯†é›†å¡«å……ã€‚åœ¨æ²¿å¤§é¡µè¾¹ç•Œæ‰“åŒ…åˆ†é…æ•ˆç‡ä½ä¸‹çš„åœ°æ–¹ï¼Œæˆ‘ä»¬å®ç°äº†ä¸€ä¸ªä¸“é—¨çš„åˆ†é…å™¨ï¼ˆHugeRegionï¼‰ã€‚ å¯¹äº exact multiple of hugepage size æˆ–é‚£äº›è¶³å¤Ÿå¤§ä»¥è‡³äº slack æ— å…³ç´§è¦çš„åˆ†é…ï¼Œæˆ‘ä»¬ç›´æ¥è½¬å‘åˆ° HugeCacheã€‚ ä¸­ç­‰å¤§å°çš„åˆ†é…ï¼ˆä»‹äº 1MiB å’Œ 1GiB ä¹‹é—´ï¼‰é€šå¸¸ä¹Ÿä» HugeCache åˆ†é…ï¼Œæœ€åä¸€æ­¥æ˜¯æèµ  slackã€‚ä¾‹å¦‚ï¼Œä» HugeCache åˆ†é…çš„ 4.5 MiB ä¼šäº§ç”Ÿ 1.5 MiB çš„ slackï¼Œè¿™æ˜¯ä¸€ä¸ªä¸å¯æ¥å—çš„é«˜å¼€é”€æ¯”ç‡ã€‚TEMERAIRE é€šè¿‡å‡è£… the last hugepage of the request has a single â€œleadingâ€ allocation on itï¼ˆå›¾ 8ï¼‰ï¼Œå°†è¯¥ slack æèµ ç»™ HugeFillerã€‚ å½“è¿™æ ·çš„å¤§è·¨åº¦è¢«é‡Šæ”¾æ—¶ï¼Œåˆ†é…å™¨è¿˜å°†æ ‡è®°ä¸ºè™šæ„çš„å‰å¯¼åˆ†é…ä¸ºç©ºé—²ã€‚å¦‚æœ slack æœªè¢«ä½¿ç”¨ï¼Œå®ƒå°†ä¸å‰©ä½™éƒ¨åˆ†ä¸€èµ·è¿”å›åˆ°å°¾éƒ¨å¤§é¡µã€‚å¦åˆ™ï¼Œå°¾éƒ¨å¤§é¡µå°†ç•™åœ¨ HugeFiller ä¸­ï¼Œåªæœ‰å‰ N-1 ä¸ªå¤§é¡µè¿”å›åˆ° HugeCacheã€‚ å¯¹äºæŸäº›åˆ†é…æ¨¡å¼ï¼Œä¸­ç­‰å¤§å°çš„åˆ†é…äº§ç”Ÿçš„ slack æ¯”æˆ‘ä»¬å¯ä»¥åœ¨ä¸¥æ ¼çš„ 2MiB ç®±å­ä¸­ç”¨è¾ƒå°åˆ†é…å¡«å……çš„æ›´å¤šã€‚ä¾‹å¦‚ï¼Œè®¸å¤š 1.1MiB çš„åˆ†é…æ¯ä¸ªå¤§é¡µå°†äº§ç”Ÿ 0.9MiB çš„ slackï¼ˆè§å›¾ 12ï¼‰ã€‚å½“æˆ‘ä»¬æ£€æµ‹åˆ°è¿™ç§æ¨¡å¼æ—¶ï¼ŒHugeRegion åˆ†é…å™¨è·¨å¤§é¡µè¾¹ç•Œæ”¾ç½®åˆ†é…ï¼Œä»¥æœ€å°åŒ–è¿™ç§å¼€é”€ã€‚ å°è¯·æ±‚ï¼ˆ\u003c= 1MiBï¼‰æ€»æ˜¯ä» HugeFiller æä¾›ã€‚å¯¹äºä»‹äº 1MiB å’Œå¤§é¡µä¹‹é—´çš„åˆ†é…ï¼Œæˆ‘ä»¬è¯„ä¼°å‡ ä¸ªé€‰é¡¹ï¼š HugeFillerï¼šå¦‚æœæˆ‘ä»¬æœ‰å¯ç”¨ç©ºé—´ï¼Œæˆ‘ä»¬ä½¿ç”¨å®ƒå¹¶ä¹äºå¡«å……ä¸€ä¸ªå¤§éƒ¨åˆ†ä¸ºç©ºçš„å¤§é¡µã€‚ HugeFiller æ— æ³•æ»¡è¶³è¿™äº›è¯·æ±‚ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥è€ƒè™‘ HugeRegionï¼›å¦‚æœæˆ‘ä»¬æœ‰å¯ä»¥æ»¡è¶³è¯·æ±‚çš„åˆ†é…åŒºåŸŸï¼Œæˆ‘ä»¬å°±è¿™æ ·åšã€‚å¦‚æœæ²¡æœ‰åŒºåŸŸå­˜åœ¨ï¼ˆæˆ–è€…å®ƒä»¬éƒ½å¤ªæ»¡äº†ï¼‰ï¼Œæˆ‘ä»¬è€ƒè™‘åˆ†é…ä¸€ä¸ªï¼Œä½†åªæœ‰åœ¨æµ‹é‡åˆ°é«˜æ¯”ä¾‹çš„ slack ä¸å°åˆ†é…æ—¶æ‰è¿™æ ·åšï¼ˆå¦‚ä¸‹æ‰€è¿°ï¼‰ã€‚ å¦åˆ™ï¼Œæˆ‘ä»¬ä» HugeCache åˆ†é…ä¸€ä¸ªå®Œæ•´çš„å¤§é¡µã€‚è¿™ä¼šäº§ç”Ÿ slackï¼Œä½†æˆ‘ä»¬é¢„è®¡å®ƒå°†è¢«æœªæ¥çš„åˆ†é…å¡«å……ã€‚ æˆ‘ä»¬åœ¨ TEMERAIRE ä¸­åšå‡ºä¸€ä¸ªè®¾è®¡é€‰æ‹©ï¼Œå³å…³å¿ƒå¤–éƒ¨ç¢ç‰‡åŒ–åˆ°å¤§é¡µçº§åˆ«ï¼Œä½†åŸºæœ¬ä¸Šä¸å…³å¿ƒè¶…è¿‡è¿™ä¸ªçº§åˆ«ï¼ˆä½†è§ç¬¬ 4.5 èŠ‚ä¸­çš„ä¾‹å¤–ï¼‰ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªå…·æœ‰å•ä¸ª 1 GiB ç©ºé—²èŒƒå›´çš„ç³»ç»Ÿå’Œå¦ä¸€ä¸ªå…·æœ‰ 512 ä¸ªä¸è¿ç»­ç©ºé—²å¤§é¡µçš„ç³»ç»Ÿåœ¨ TEMERAIRE ä¸­å¤„ç†å¾—åŒæ ·å¥½ã€‚åœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œåˆ†é…å™¨é€šå¸¸ä¼šå°†æ‰€æœ‰æœªä½¿ç”¨çš„ç©ºé—´è¿”å›ç»™æ“ä½œç³»ç»Ÿï¼›ä¸€ä¸ª 1 GiB çš„æ–°åˆ†é…å°†éœ€è¦åœ¨ä»»ä¸€æƒ…å†µä¸‹å¼•å…¥å†…å­˜é”™è¯¯ã€‚åœ¨ç¢ç‰‡åŒ–çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†åœ¨æ–°çš„è™šæ‹Ÿå†…å­˜ä¸Šè¿™æ ·åšã€‚æœªè¢«æ´»åŠ¨åˆ†é…å ç”¨ä¸”ä¸æ¶ˆè€—ç‰©ç†å†…å­˜çš„è™šæ‹Ÿåœ°å€èŒƒå›´çš„æµªè´¹ä¸æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œå› ä¸ºå¯¹äº 64 ä½åœ°å€ç©ºé—´ï¼Œè™šæ‹Ÿå†…å­˜å®é™…ä¸Šæ˜¯å…è´¹çš„ã€‚ ","date":"2024-10-27","objectID":"/posts/paper-hugepage/:6:1","tags":["Paper Reading"],"title":"Paper Reading: Temeraire, Hugepage aware memory allocator","uri":"/posts/paper-hugepage/"},{"categories":null,"content":"HugeAllocator HugeAllocator è·Ÿè¸ªæ˜ å°„çš„è™šæ‹Ÿå†…å­˜ã€‚æ‰€æœ‰æ“ä½œç³»ç»Ÿæ˜ å°„éƒ½åœ¨è¿™é‡Œè¿›è¡Œã€‚å®ƒå­˜å‚¨å¤§é¡µå¯¹é½çš„æœªæ”¯æŒèŒƒå›´ï¼ˆå³æ²¡æœ‰å…³è”ç‰©ç†å†…å­˜çš„èŒƒå›´ï¼‰ã€‚è™šæ‹Ÿå†…å­˜å‡ ä¹æ˜¯å…è´¹çš„ï¼Œå› æ­¤æˆ‘ä»¬è¿½æ±‚ç®€å•å’Œåˆç†çš„é€Ÿåº¦ã€‚æˆ‘ä»¬çš„å®ç°ä½¿ç”¨ treap[40]è·Ÿè¸ªæœªä½¿ç”¨çš„èŒƒå›´ã€‚æˆ‘ä»¬é€šè¿‡å…¶æœ€å¤§åŒ…å«èŒƒå›´å¢å¼ºå­æ ‘ï¼Œè¿™ä½¿æˆ‘ä»¬èƒ½å¤Ÿå¿«é€Ÿé€‰æ‹©ä¸€ä¸ªè¿‘ä¼¼æœ€ä½³é€‚åº”ã€‚ ","date":"2024-10-27","objectID":"/posts/paper-hugepage/:6:2","tags":["Paper Reading"],"title":"Paper Reading: Temeraire, Hugepage aware memory allocator","uri":"/posts/paper-hugepage/"},{"categories":null,"content":"HugeCache HugeCache è·Ÿè¸ªä»¥å®Œæ•´å¤§é¡µç²’åº¦æ”¯æŒçš„å†…å­˜èŒƒå›´ã€‚HugeFiller å¡«å……å’Œæ¸…ç©ºæ•´ä¸ªå¤§é¡µçš„ä¸€ä¸ªç»“æœæ˜¯ï¼Œæˆ‘ä»¬éœ€è¦å†³å®šä½•æ—¶å°†ç©ºå¤§é¡µè¿”å›ç»™æ“ä½œç³»ç»Ÿã€‚æˆ‘ä»¬ä¼šåæ‚”è¿”å›æˆ‘ä»¬å°†å†æ¬¡éœ€è¦çš„å†…å­˜ï¼ŒåŒæ ·ä¹Ÿä¼šåæ‚”ä¸è¿”å›å°†åœ¨ç¼“å­˜ä¸­é—²ç½®çš„å†…å­˜ã€‚æ€¥åˆ‡åœ°è¿”å›å†…å­˜æ„å‘³ç€æˆ‘ä»¬è¿›è¡Œç³»ç»Ÿè°ƒç”¨ä»¥è¿”å›å†…å­˜ï¼Œå¹¶åœ¨é‡æ–°ä½¿ç”¨æ—¶å¼•å…¥é¡µé¢é”™è¯¯ã€‚ä»…åœ¨ TCMALLOC çš„å®šæœŸé‡Šæ”¾çº¿ç¨‹è¯·æ±‚çš„é€Ÿç‡ä¸‹é‡Šæ”¾å†…å­˜æ„å‘³ç€å†…å­˜è¢«é—²ç½®ã€‚ è€ƒè™‘å›¾ 9 ä¸­çš„äººå·¥ç¨‹åºï¼Œæ²¡æœ‰é¢å¤–çš„å †åˆ†é…ã€‚åœ¨å¾ªç¯çš„æ¯æ¬¡è¿­ä»£ä¸­ï¼Œâ€˜Newâ€˜éœ€è¦ä¸€ä¸ªæ–°çš„å¤§é¡µå¹¶å°†å…¶æ”¾ç½®åœ¨ HugeFiller ä¸­ã€‚â€˜Deleteâ€˜ç§»é™¤åˆ†é…ï¼Œç°åœ¨å¤§é¡µå®Œå…¨ç©ºé—²ã€‚æ€¥åˆ‡åœ°è¿”å›å°†è¦æ±‚æ¯æ¬¡è¿­ä»£éƒ½è¿›è¡Œç³»ç»Ÿè°ƒç”¨ï¼Œå¯¹äºè¿™ä¸ªç®€å•ä½†ç—…æ€çš„ç¨‹åºæ¥è¯´ã€‚ 512K ç›´æ¥èµ° Fillerï¼Œ æˆ‘ä»¬è·Ÿè¸ª 2 ç§’æ»‘åŠ¨çª—å£å†…çš„éœ€æ±‚å‘¨æœŸæ€§ï¼Œå¹¶è®¡ç®—æ‰€è§çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ï¼ˆdemandminï¼Œdemandmaxï¼‰ã€‚æ¯å½“å†…å­˜è¿”å›åˆ° HugeCache æ—¶ï¼Œå¦‚æœç¼“å­˜å°†å¤§äº demandmax âˆ’ demandminï¼Œæˆ‘ä»¬å°†å¤§é¡µè¿”å›ç»™æ“ä½œç³»ç»Ÿã€‚æˆ‘ä»¬è¿˜å°è¯•äº†å…¶ä»–ç®—æ³•ï¼Œä½†è¿™ä¸ªç®—æ³•ç®€å•ä¸”è¶³ä»¥æ•æ‰æˆ‘ä»¬çœ‹åˆ°çš„ç»éªŒåŠ¨æ€ã€‚åªè¦æˆ‘ä»¬çš„çª—å£éœ€æ±‚çœ‹åˆ°äº†æ–°å¤§å°çš„éœ€æ±‚ï¼Œç¼“å­˜å°±å¯ä»¥å¢é•¿ã€‚åœ¨æŒ¯è¡ä½¿ç”¨ä¸­ï¼Œè¿™å°†ï¼ˆé”™è¯¯åœ°ï¼‰é‡Šæ”¾å†…å­˜ä¸€æ¬¡ï¼Œç„¶åï¼ˆæ­£ç¡®åœ°ï¼‰ä»é‚£æ—¶èµ·ä¿æŒå®ƒã€‚å›¾ 10 æ˜¾ç¤ºäº† Tensorflow å·¥ä½œè´Ÿè½½çš„ç¼“å­˜å¤§å°ï¼Œè¯¥å·¥ä½œè´Ÿè½½é€šè¿‡å¤§å¹…æŒ¯è¡ä½¿ç”¨ï¼›æˆ‘ä»¬ç´§å¯†è·Ÿè¸ªå®é™…éœ€è¦çš„å†…å­˜ã€‚ æ²¡æ‡‚ ","date":"2024-10-27","objectID":"/posts/paper-hugepage/:6:3","tags":["Paper Reading"],"title":"Paper Reading: Temeraire, Hugepage aware memory allocator","uri":"/posts/paper-hugepage/"},{"categories":null,"content":"HugeFiller HugeFiller æ»¡è¶³æ¯ä¸ªé€‚åˆå•ä¸ªå¤§é¡µçš„å°åˆ†é…ã€‚è¿™æ»¡è¶³äº†å¤§å¤šæ•°åˆ†é…ï¼ˆ78% of the pageheap is backed by the HugeFiller on average across the fleetï¼‰ï¼Œå¹¶ä¸”æ˜¯æˆ‘ä»¬ç³»ç»Ÿä¸­æœ€é‡è¦çš„â€”â€”ä¹Ÿæ˜¯æœ€ä¼˜åŒ–çš„â€”â€”ç»„ä»¶ã€‚åœ¨ç»™å®šçš„å¤§é¡µå†…ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ª**ç®€å•ï¼ˆä¸”å¿«é€Ÿï¼‰**çš„ best-fit algorithm æ¥æ”¾ç½®åˆ†é…ï¼›æŒ‘æˆ˜åœ¨äºå†³å®šåœ¨å“ªä¸ªå¤§é¡µä¸Šæ”¾ç½®åˆ†é…ã€‚ è¿™ä¸ªç»„ä»¶è§£å†³äº†æˆ‘ä»¬çš„ binpacking problemï¼šæˆ‘ä»¬çš„ç›®æ ‡æ˜¯å°†å¤§é¡µåˆ†æˆä¸€äº›ä¿æŒæœ€å¤§å¡«å……ï¼Œè€Œå…¶ä»–ä¸€äº›ä¿æŒç©ºæˆ–è¿‘ç©ºã€‚æœ€ç©ºçš„å¤§é¡µå¯ä»¥è¢«å›æ”¶ï¼ˆå¯èƒ½æ ¹æ®éœ€è¦åˆ†è§£å¤§é¡µï¼‰ï¼ŒåŒæ—¶æœ€å°åŒ–å¯¹å¤§é¡µè¦†ç›–çš„å½±å“ï¼Œå› ä¸ºå¯†é›†å¡«å……çš„é¡µé¢è¦†ç›–äº†å¤§éƒ¨åˆ†ä½¿ç”¨å†…å­˜çš„å¤§é¡µã€‚ä½†æ¸…ç©ºå¤§é¡µå…·æœ‰æŒ‘æˆ˜æ€§ï¼Œå› ä¸ºæˆ‘ä»¬ä¸èƒ½ä¾èµ–ä»»ä½•ç‰¹å®šçš„åˆ†é…æ¶ˆå¤±ã€‚ æ¬¡è¦ç›®æ ‡æ˜¯æœ€å¤§é™åº¦åœ°å‡å°‘æ¯ä¸ªå¤§é¡µå†…çš„ç¢ç‰‡åŒ–ï¼Œä»¥ä½¿æ–°è¯·æ±‚æ›´æœ‰å¯èƒ½è¢«æ»¡è¶³ã€‚å¦‚æœç³»ç»Ÿéœ€è¦ä¸€ä¸ªæ–°çš„ K é¡µè·¨åº¦ï¼Œå¹¶ä¸”æ²¡æœ‰ â‰¥ K é¡µçš„ç©ºé—²èŒƒå›´å¯ç”¨ï¼Œæˆ‘ä»¬éœ€è¦ä» HugeCache è·å–ä¸€ä¸ªå¤§é¡µã€‚è¿™ä¼šåˆ›å»º(2MiB âˆ’ K âˆ— pagesize)çš„ slackï¼Œæµªè´¹ç©ºé—´ã€‚ è¿™ç»™æˆ‘ä»¬ä¸¤ä¸ªä¼˜å…ˆè€ƒè™‘çš„ç›®æ ‡ã€‚å› ä¸ºæˆ‘ä»¬å¸Œæœ›æœ€å¤§åŒ–å¤§é¡µå®Œå…¨ç©ºé—²çš„æ¦‚ç‡ï¼Œè¿‘ç©ºçš„å¤§é¡µæ˜¯å®è´µçš„ã€‚å› ä¸ºæˆ‘ä»¬éœ€è¦æœ€å°åŒ–ç¢ç‰‡åŒ–ï¼Œå…·æœ‰é•¿ç©ºé—²èŒƒå›´çš„å¤§é¡µä¹Ÿæ˜¯å®è´µçš„ã€‚ä¸¤ä¸ªä¼˜å…ˆçº§éƒ½é€šè¿‡ä¿ç•™å…·æœ‰æœ€é•¿ç©ºé—²èŒƒå›´çš„å¤§é¡µæ¥æ»¡è¶³ï¼Œå› ä¸ºè¾ƒé•¿çš„ç©ºé—²èŒƒå›´å¿…é¡»å…·æœ‰è¾ƒå°‘çš„åœ¨ä½¿ç”¨å—ã€‚æˆ‘ä»¬ç›¸åº”åœ°å°†å¤§é¡µç»„ç»‡æˆæ’åºåˆ—è¡¨ï¼Œåˆ©ç”¨æ¯ä¸ªå¤§é¡µçš„ç»Ÿè®¡æ•°æ®ã€‚ åœ¨æ¯ä¸ªå¤§é¡µå†…ï¼Œæˆ‘ä»¬è·Ÿè¸ªä½¿ç”¨é¡µçš„ä½å›¾ï¼›ä¸ºäº†ä»æŸä¸ªå¤§é¡µå¡«å……è¯·æ±‚ï¼Œæˆ‘ä»¬ä»è¯¥ä½å›¾ä¸­è¿›è¡Œæœ€ä½³é€‚åº”æœç´¢ã€‚ æ¬¡è¦ç›®æ ‡æ‰æ˜¯å‡å°‘å¤§é¡µå†…éƒ¨ç¢ç‰‡ï¼Ÿ the longest free range (L), the number of contiguous pages not already allocated, the total number of allocations (A), the total number of used pages (U). è¿™ä¸‰ä¸ªç»Ÿè®¡æ•°æ®å†³å®šäº†å¤§é¡µçš„ä¼˜å…ˆé¡ºåºä»¥æ”¾ç½®åˆ†é…ã€‚æˆ‘ä»¬é€‰æ‹©å…·æœ‰æœ€ä½è¶³å¤Ÿ L å’Œæœ€é«˜ A çš„å¤§é¡µã€‚å¯¹äº K é¡µçš„åˆ†é…ï¼Œæˆ‘ä»¬é¦–å…ˆåªè€ƒè™‘æœ€é•¿ç©ºé—²èŒƒå›´è¶³å¤Ÿçš„å¤§é¡µï¼ˆL â‰¥ Kï¼‰ã€‚è¿™å†³å®šäº†ä¸€ä¸ªå¤§é¡µæ˜¯å¦æ˜¯å¯èƒ½çš„åˆ†é…ç›®æ ‡ã€‚ åœ¨ L â‰¥ K çš„å¤§é¡µä¸­ï¼Œæˆ‘ä»¬æŒ‰ fullness ä¼˜å…ˆæ’åºã€‚å¤§é‡çš„å®éªŒä½¿æˆ‘ä»¬é€‰æ‹©äº† Aï¼Œè€Œä¸æ˜¯ Uã€‚ å®éªŒè¯æ˜ï¼Œä¼˜å…ˆåˆ†é…æ•°é‡ï¼Ÿ This choice is motivated by a radioactive decay-type allocation model å…¶ä¸­æ¯ä¸ªåˆ†é…ï¼Œæ— è®ºå¤§å°ï¼Œéƒ½æœ‰å¯èƒ½å˜å¾—ç©ºé—²ï¼ˆå…·æœ‰æŸç§æ¦‚ç‡ pï¼‰ã€‚åœ¨è¿™ä¸ªæ¨¡å‹ä¸­ï¼Œå…·æœ‰ 5 ä¸ªåˆ†é…çš„å¤§é¡µæœ‰ p^5 \u003c\u003c p çš„æ¦‚ç‡å˜å¾—ç©ºé—²ï¼›å› æ­¤ï¼Œæˆ‘ä»¬åº”è¯¥éå¸¸å¼ºçƒˆåœ°é¿å…ä»åˆ†é…éå¸¸å°‘çš„å¤§é¡µä¸­åˆ†é…ã€‚ç‰¹åˆ«æ˜¯ï¼Œè¿™ä¸ªæ¨¡å‹é¢„æµ‹ A æ˜¯ä¸€ä¸ªæ¯” U æ›´å¥½çš„â€œç©ºé—²åº¦â€æ¨¡å‹ï¼šå¤§å°ä¸º M çš„ä¸€ä¸ªåˆ†é…æ¯”å¤§å°ä¸º 1 çš„ M ä¸ªåˆ†é…æ›´æœ‰å¯èƒ½è¢«é‡Šæ”¾ã€‚ çœ‹ä¸æ‡‚ï¼Œç•¥è¿‡æ¦‚ç‡æ¨¡å‹ L â‰¥ Kï¼šé¦–å…ˆé€‰æ‹©å…·æœ‰è¶³å¤Ÿç©ºé—²é¡µçš„å·¨é¡µã€‚ æŒ‰ A æ’åºï¼šåœ¨ç¬¦åˆæ¡ä»¶çš„å·¨é¡µä¸­ï¼Œä¼˜å…ˆé€‰æ‹©å·²åˆ†é…æ•°è¾ƒå¤šçš„å·¨é¡µï¼ˆå› ä¸ºåœ¨æ”¾å°„æ€§è¡°å˜æ¨¡å‹ä¸‹ï¼Œè¿™æ ·çš„å·¨é¡µæ›´æœ‰å¯èƒ½å®Œå…¨å˜ä¸ºç©ºé—²é¡µï¼‰ã€‚ æˆ‘ä»¬çš„ç­–ç•¥ä¸æœ€ä½³é€‚åº”ä¸åŒã€‚è€ƒè™‘ä¸€ä¸ªå¤§é¡µ X æœ‰ä¸€ä¸ª 3 é¡µçš„é—´éš™å’Œä¸€ä¸ª 10 é¡µçš„é—´éš™ï¼Œå¦ä¸€ä¸ªå¤§é¡µ Y æœ‰ä¸€ä¸ª 5 é¡µçš„é—´éš™ã€‚æœ€ä½³é€‚åº”ä¼šé€‰æ‹© Xã€‚æˆ‘ä»¬çš„ç­–ç•¥é€‰æ‹© Yã€‚è¿™ä¸ªç­–ç•¥æœ‰æ•ˆï¼Œå› ä¸ºæˆ‘ä»¬æ­£åœ¨å¯»æ‰¾åˆ†é…åœ¨æœ€ç¢ç‰‡åŒ–çš„é¡µé¢ä¸Šï¼Œå› ä¸ºç¢ç‰‡åŒ–çš„é¡µé¢ä¸å¤ªå¯èƒ½å®Œå…¨ç©ºé—²ã€‚å¦‚æœæˆ‘ä»¬éœ€è¦ï¼Œæ¯”å¦‚ 3 é¡µï¼Œé‚£ä¹ˆæœ€å¤šåŒ…å« 3 ä¸ªå¯ç”¨é¡µçš„é—´éš™çš„é¡µé¢æ›´æœ‰å¯èƒ½æ˜¯ç¢ç‰‡åŒ–çš„ï¼Œå› æ­¤æ˜¯å¥½çš„åˆ†é…å€™é€‰è€…ã€‚åœ¨æ”¾å°„æ€§è¡°å˜æ¨¡å‹ä¸‹ï¼Œé è¿‘å¤§é—´éš™çš„åˆ†é…ä¸ä»»ä½•å…¶ä»–åˆ†é…ä¸€æ ·å¯èƒ½å˜å¾—ç©ºé—²ï¼Œè¿™å¯èƒ½å¯¼è‡´è¿™äº›é—´éš™æ˜¾è‘—å¢é•¿ï¼›ç„¶åå®ƒä»¬å¯ä»¥ç”¨äºå¤§åˆ†é…ã€‚æˆ‘ä»¬å°† 10 é¡µçš„é—´éš™è§†ä¸ºå®è´µï¼Œå¹¶é¿å…åœ¨å…¶é™„è¿‘åˆ†é…ï¼Œé™¤éæ²¡æœ‰å…¶ä»–é€‰æ‹©ï¼Œè¿™å…è®¸å®ƒå¢é•¿ã€‚ ä»¤äººæƒŠè®¶çš„æ˜¯ï¼Œè¿™ä¸ªç®€å•çš„ç­–ç•¥æ˜¾è‘—ä¼˜äºå…¨å±€æœ€ä½³é€‚åº”ç®—æ³•â€”â€”å°†è¯·æ±‚æ”¾ç½®åœ¨ä»»ä½•å¤§é¡µä¸­æœ€æ¥è¿‘å…¶å¤§å°çš„å•ä¸ªé—´éš™ä¸­ã€‚æœ€ä½³é€‚åº”å°†éå¸¸æ˜‚è´µâ€”â€”æˆ‘ä»¬ä¸èƒ½ä¸ºæ¯ä¸ªè¯·æ±‚æœç´¢ 10-100K å¤§é¡µï¼Œä½†ä»¤äººéå¸¸åç›´è§‰çš„æ˜¯ï¼Œå®ƒä¹Ÿä¼šäº§ç”Ÿæ›´é«˜çš„ç¢ç‰‡åŒ–ã€‚æœ€ä½³é€‚åº”å¯¹äºä¸€èˆ¬ç¢ç‰‡åŒ–é—®é¢˜è¿œéæœ€ä½³ç»“æœå¹¶ä¸æ˜¯æ–°å‘ç°[36]ï¼Œä½†çœ‹åˆ°å®ƒåœ¨è¿™é‡Œæœ‰å¤šç³Ÿç³•æ˜¯å¾ˆæœ‰è¶£çš„ã€‚ best fit ä¸ä¸€å®šæ˜¯æœ€ä¼˜çš„ï¼Œæ˜¯å› ä¸ºå±€éƒ¨ä¸ä¸€å®šå…¨å±€ï¼Ÿåè€Œä¼šæœ‰æ›´å¤šçš„ç¢ç‰‡ å›¾ 11 è¯æ˜äº† LFR éšç€éœ€æ±‚å†…å­˜é™ä½ä¹Ÿåœ¨é™ä½ ","date":"2024-10-27","objectID":"/posts/paper-hugepage/:6:4","tags":["Paper Reading"],"title":"Paper Reading: Temeraire, Hugepage aware memory allocator","uri":"/posts/paper-hugepage/"},{"categories":null,"content":"HugeRegion HugeCacheï¼ˆåŠå…¶èƒŒåçš„ HugeAllocatorï¼‰è¶³ä»¥å¤„ç†å¤§åˆ†é…ï¼Œå…¶ä¸­èˆå…¥åˆ°å®Œæ•´å¤§é¡µçš„æˆæœ¬å¾ˆå°ã€‚HugeFiller å¯¹äºå¯ä»¥æ‰“åŒ…åˆ°å•ä¸ªå¤§é¡µçš„å°åˆ†é…æ•ˆæœå¾ˆå¥½ã€‚HugeRegion åˆ™ä»‹äºä¸¤è€…ä¹‹é—´ã€‚ è€ƒè™‘ä¸€ä¸ªè¯·æ±‚ 1.1 MiB å†…å­˜çš„æƒ…å†µã€‚æˆ‘ä»¬ä» HugeFiller ä¸­æä¾›å®ƒï¼Œç•™ä¸‹ 2 MiB å¤§é¡µä¸­æœªä½¿ç”¨çš„ 0.9 MiB å†…å­˜ï¼šslack ç©ºé—´ã€‚HugeFiller å‡è®¾ slack å°†è¢«æœªæ¥çš„å°åˆ†é…ï¼ˆ\u003c1MiBï¼‰å¡«å……ï¼Œé€šå¸¸ç¡®å®å¦‚æ­¤ï¼šæˆ‘ä»¬è§‚å¯Ÿåˆ°çš„æœºç¾¤èŒƒå›´å†…å°åˆ†é…ä¸ slack çš„å­—èŠ‚æ¯”ç‡ä¸º 15:1ã€‚åœ¨æé™æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥æƒ³è±¡ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶åªè¯·æ±‚ 1.1 MiB è·¨åº¦ï¼Œå¦‚å›¾ 12 æ‰€ç¤ºã€‚ ","date":"2024-10-27","objectID":"/posts/paper-hugepage/:6:5","tags":["Paper Reading"],"title":"Paper Reading: Temeraire, Hugepage aware memory allocator","uri":"/posts/paper-hugepage/"},{"categories":null,"content":"Memory Release ","date":"2024-10-27","objectID":"/posts/paper-hugepage/:6:6","tags":["Paper Reading"],"title":"Paper Reading: Temeraire, Hugepage aware memory allocator","uri":"/posts/paper-hugepage/"},{"categories":null,"content":"Evaluation of TEMERAIRE Googleâ€™s WSC workloads. å› æ­¤ï¼Œæˆ‘ä»¬æ£€æŸ¥äº† IPC æŒ‡æ ‡ï¼ˆä½œä¸ºç”¨æˆ·ååé‡çš„ä»£ç†ï¼‰ï¼Œå¹¶åœ¨å¯èƒ½çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è·å¾—äº†åº”ç”¨ç¨‹åºçº§åˆ«çš„æ€§èƒ½æŒ‡æ ‡ï¼Œä»¥è¯„ä¼°å·¥ä½œè´Ÿè½½åœ¨æˆ‘ä»¬æœåŠ¡å™¨ä¸Šçš„ç”Ÿäº§åŠ›ï¼ˆä¾‹å¦‚ï¼Œæ¯æ ¸å¿ƒæ¯ç§’è¯·æ±‚æ•°ï¼‰ã€‚ ","date":"2024-10-27","objectID":"/posts/paper-hugepage/:7:0","tags":["Paper Reading"],"title":"Paper Reading: Temeraire, Hugepage aware memory allocator","uri":"/posts/paper-hugepage/"},{"categories":null,"content":"Application Case Studies Tensorflow search1, search2, ads1, ads2â€¦ Spanner åˆ†å¸ƒå¼æ•°æ®åº“ loadbalancer redis å¯¹äºå…·æœ‰å®šæœŸé‡Šæ”¾çš„ 8 ä¸ªåº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬è§‚å¯Ÿåˆ°å¹³å‡ CPU æ”¹è¿›ä¸º 7.7%ï¼Œå¹³å‡ RAM å‡å°‘ä¸º 2.4%ã€‚å…¶ä¸­ä¸¤ä¸ªå·¥ä½œè´Ÿè½½æ²¡æœ‰çœ‹åˆ°å†…å­˜å‡å°‘ã€‚TEMERAIRE çš„ HugeCache è®¾è®¡å¾ˆå¥½åœ°å¤„ç†äº† Tensorflow çš„åˆ†é…æ¨¡å¼ï¼Œä½†æ— æ³•å½±å“å…¶çªå‘éœ€æ±‚ã€‚Spanner å°†å…¶ç¼“å­˜æœ€å¤§åŒ–åˆ°æŸä¸ªå†…å­˜é™åˆ¶ï¼Œå› æ­¤å‡å°‘ TCMALLOC çš„å¼€é”€æ„å‘³ç€åœ¨ç›¸åŒçš„å†…å­˜å ç”¨ä¸‹å¯ä»¥ç¼“å­˜æ›´å¤šçš„åº”ç”¨ç¨‹åºæ•°æ®ã€‚ è¿™äº›åº”ç”¨çœ‹ç€æŒºæœ‰æ„æ€ï¼Œä¸çŸ¥é“æœ‰æ²¡æœ‰å¼€æº tensorflow æ”¹è¿›æ˜¯æœ€å¤§çš„ å†…å­˜å¤§éƒ¨åˆ†éƒ½ä¼šå‡å°‘ ä¸ºä»€ä¹ˆ IPC ä¼šå¢åŠ ï¼Ÿæ˜¯æ¯å‘¨æœŸæŒ‡ä»¤æ•°å—ï¼Œå¯ä»¥è¡¨ç¤ºæ€§èƒ½æ›´å¥½ï¼Œç¼“å­˜å‘½ä¸­æ›´é«˜ï¼Ÿ page fault ä¸Šå‡äº†ï¼Œå‡ ä¹ 2x è¿™ä¸ä¼šæœ‰å½±å“å—ï¼Ÿ ","date":"2024-10-27","objectID":"/posts/paper-hugepage/:7:1","tags":["Paper Reading"],"title":"Paper Reading: Temeraire, Hugepage aware memory allocator","uri":"/posts/paper-hugepage/"},{"categories":null,"content":"Conclusion In warehouse scale computers, TLB lookup penalties are one of the most significant compute costs facing large applications. TEMERAIRE optimizes the whole WSC by changing the memory allocator to make hugepage-conscious placement decisions while minimizing fragmentation. Application case studies of key workloads from Googleâ€™s WSCs show RPS/CPU increased by 7.7% and RAM usage decreased by 2.4%. Experiments at fleet scale and longitudinal data during the rollout at Google showed a 6% reduction in cycles spent in TLB misses, and 26% reduction in memory wasted due to fragmentation. Since the memory system is the biggest bottleneck in WSC applications, there are further opportunities to accelerate application performance by improving how the allocator organizes memory and interacts with the OS. æ²¡çœ‹åˆ° temeraire æ˜¯æ€ä¹ˆå¤„ç†é«˜å¹¶å‘åœºæ™¯çš„ï¼Œè¿˜æ˜¯è¯´æ²¿ç”¨ tcmalloc çš„è®¾è®¡ï¼Ÿ ","date":"2024-10-27","objectID":"/posts/paper-hugepage/:8:0","tags":["Paper Reading"],"title":"Paper Reading: Temeraire, Hugepage aware memory allocator","uri":"/posts/paper-hugepage/"},{"categories":null,"content":"Making Kernel Bypass Practical for the Cloud with Junction NSDI 24 çš„è®ºæ–‡ motivation è¿˜æ˜¯å’Œä»¥å‰çš„ç±»ä¼¼ï¼ŒOS kernel æ¯”å¦‚ TCP æ ˆå¸¦æ¥äº† IO overheadsï¼Œåœ¨ cloud/datacenter æœ‰å¾ˆå¤š OS bypass æŠ€æœ¯ï¼Œä½†ç›®å‰ cloud å¾ˆéš¾å®ç° åŸå› ä¸»è¦æ˜¯ density å’Œ compatibility åªæœ‰å°‘é‡åº”ç”¨å¯ä»¥ Github Repo: https://github.com/JunctionOS/junction ","date":"2024-10-21","objectID":"/posts/paper-junction/:1:0","tags":["Paper Reading"],"title":"Paper Reading: Making Kernel Bypass Practical for the Cloud with Junction","uri":"/posts/paper-junction/"},{"categories":null,"content":"Abstract å†…æ ¸æ—è·¯ç³»ç»Ÿç›¸å¯¹äºä¼ ç»Ÿçš„æ“ä½œç³»ç»Ÿï¼ˆOSesï¼‰åœ¨ç½‘ç»œå¯†é›†å‹åº”ç”¨çš„ååé‡å’Œå°¾éƒ¨å»¶è¿Ÿæ–¹é¢å±•ç¤ºäº†æ•°é‡çº§çš„æ”¹è¿›ã€‚ç„¶è€Œï¼Œä¸ºäº†å®ç°å¦‚æ­¤å“è¶Šçš„æ€§èƒ½ï¼Œå®ƒä»¬ä¾èµ–äºä¸“ç”¨èµ„æºï¼ˆä¾‹å¦‚ï¼Œspinning cores, pinned memoryï¼‰ï¼Œå¹¶éœ€è¦åº”ç”¨ç¨‹åºçš„é‡å†™ã€‚è¿™å¯¹äºäº‘è¿è¥å•†æ¥è¯´æ˜¯ä¸å¯å–çš„ï¼Œ ç”±äºè¿™ä¸¤ä¸ªåŸå› ï¼Œç°æœ‰çš„å†…æ ¸æ—è·¯æŠ€æœ¯åœ¨äº‘ç¯å¢ƒä¸­æ˜¯ä¸åˆ‡å®é™…çš„ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å±•ç¤ºäº†è¿™äº›å¦¥åå¹¶éè§£é”å†…æ ¸æ—è·¯å…¨éƒ¨å¥½å¤„çš„å¿…è¦æ¡ä»¶ã€‚æˆ‘ä»¬æå‡ºäº† Junctionï¼Œè¿™æ˜¯ç¬¬ä¸€ä¸ªèƒ½å¤Ÿåœ¨æœºå™¨ä¸Šå¯†é›†æ‰“åŒ…æ•°åƒä¸ªå®ä¾‹ï¼ŒåŒæ—¶æä¾›ä¸æœªä¿®æ”¹çš„ Linux åº”ç”¨ç¨‹åºå…¼å®¹æ€§çš„å†…æ ¸æ—è·¯ç³»ç»Ÿã€‚ Junction çš„æ‰©å±•èƒ½åŠ›æ¯”ç°æœ‰çš„å†…æ ¸æ—è·¯ç³»ç»Ÿé«˜å‡º 19-62 å€ï¼Œå¹¶ä¸”å¯ä»¥åœ¨ä¸è¿›è¡Œä»£ç æ›´æ”¹çš„æƒ…å†µä¸‹å®ç°ç›¸ä¼¼æˆ–æ›´å¥½çš„æ€§èƒ½ã€‚æ­¤å¤–ï¼ŒJunction ä¸ºä»¥å‰ä¸æ”¯æŒå†…æ ¸æ—è·¯çš„åº”ç”¨ç¨‹åºå¸¦æ¥äº†æ˜¾è‘—çš„æ€§èƒ½æå‡ï¼ŒåŒ…æ‹¬é‚£äº›ä¾èµ–äº Goã€Javaã€Node å’Œ Python ç­‰è¿è¡Œæ—¶ç³»ç»Ÿçš„åº”ç”¨ç¨‹åºã€‚åœ¨ä¸åŸç”Ÿ Linux çš„æ¯”è¾ƒä¸­ï¼ŒJunction åœ¨ä¸ƒä¸ªåº”ç”¨ç¨‹åºä¸­å°†ååé‡æé«˜äº† 1.6-7.0 å€ï¼ŒåŒæ—¶ä½¿ç”¨çš„æ ¸å¿ƒæ•°é‡å‡å°‘äº† 1.2-3.8 å€ã€‚ æ€§èƒ½å¾ˆå¤¸å¼  ","date":"2024-10-21","objectID":"/posts/paper-junction/:2:0","tags":["Paper Reading"],"title":"Paper Reading: Making Kernel Bypass Practical for the Cloud with Junction","uri":"/posts/paper-junction/"},{"categories":null,"content":"Introduction ç½‘ç»œå¯†é›†å‹åº”ç”¨ä»å†…æ ¸æ—è·¯ç³»ç»Ÿä¸­è·å¾—äº†æ˜¾è‘—çš„æ€§èƒ½æå‡ï¼ˆå³å°¾éƒ¨å»¶è¿Ÿå’Œååé‡çš„æ•°é‡çº§æ”¹å–„ï¼‰ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯å°†ç½‘ç»œé˜Ÿåˆ—æ˜ å°„åˆ°ç”¨æˆ·ç©ºé—´ï¼Œä½¿å¾—åº”ç”¨ç¨‹åºå¯ä»¥ç›´æ¥ä¸ç½‘å¡é€šä¿¡ï¼Œä»è€Œé¿å…å†…æ ¸å¼€é”€ã€‚ Junction æ˜¯ä¸€ä¸ªé’ˆå¯¹äº‘åº”ç”¨ï¼ˆå¦‚å¾®æœåŠ¡ã€æ— æœåŠ¡å™¨ç­‰ï¼‰çš„æ–°å‹å†…æ ¸æ—è·¯ç³»ç»Ÿï¼Œä¸ä¹‹å‰çš„å†…æ ¸æ—è·¯ç³»ç»Ÿç±»ä¼¼ï¼ŒJunction æä¾›äº†æ˜¾è‘—çš„æ€§èƒ½æå‡ï¼ŒåŒ…æ‹¬æ›´é«˜çš„ååé‡å’Œæ›´å¤§çš„ CPU æ•ˆç‡ï¼Œä»¥åŠç›¸å¯¹äºä¼ ç»Ÿæ“ä½œç³»ç»Ÿçš„å°¾éƒ¨å»¶è¿Ÿæ•°é‡çº§çš„å‡å°‘ã€‚ Junction åœ¨ä¿æŒåº”ç”¨ç¨‹åºä¹‹é—´ä¸¥æ ¼éš”ç¦»çš„åŒæ—¶ï¼Œæä¾›äº†æ¯”ç°æœ‰äº‘éš”ç¦»æ–¹æ¡ˆæ›´çª„çš„æ”»å‡»é¢ã€‚ æ€§èƒ½æŒ‡æ ‡ï¼šååé‡ï¼ŒCPU æ•ˆç‡ï¼Œå°¾éƒ¨å»¶è¿Ÿ ä¹‹å‰çš„å†…æ ¸æ—è·¯ç³»ç»Ÿåšå‡ºäº†ä¸€äº›å¦¥åï¼Œä½¿å¾—å®ƒä»¬åœ¨äº‘ç¯å¢ƒä¸­ä¸åˆ‡å®é™…ã€‚ä¾‹å¦‚ï¼Œå®ƒä»¬éœ€è¦ä¸“ç”¨çš„ã€ç¹å¿™æ—‹è½¬çš„æ ¸å¿ƒå’Œå›ºå®šå†…å­˜ï¼Œå› æ­¤åœ¨æœºå™¨ä¸Šåªèƒ½æ‰“åŒ…éå¸¸å°‘çš„å®ä¾‹ã€‚æ­¤å¤–ï¼Œå®ƒä»¬å¯¹ç¼–ç¨‹æ¨¡å‹è¿›è¡Œäº†é‡å¤§æ›´æ”¹[6, 14, 21, 33, 52]ï¼Œè¿™ç ´åäº†å…¼å®¹æ€§å¹¶ç‰ºç‰²äº†ç°æœ‰è½¯ä»¶çš„å·¨å¤§æŠ•èµ„ã€‚æœ€åï¼Œå¤§å¤šæ•°å†…æ ¸æ—è·¯ç³»ç»Ÿæœ¬èº«ä¸æä¾›éš”ç¦»ï¼Œå› æ­¤å¿…é¡»ä¸è™šæ‹ŸåŒ–ç»“åˆï¼ˆåŠå…¶ç›¸å…³çš„å¼€é”€ï¼Œå¦‚ VM é€€å‡ºæˆæœ¬ã€åµŒå¥—é¡µè¡¨ç­‰ï¼‰æ‰èƒ½åœ¨äº‘ç¯å¢ƒä¸­å®‰å…¨éƒ¨ç½²ã€‚ Junction é€šè¿‡ä¸€ç³»åˆ—è®¾è®¡è´¡çŒ®ï¼Œåœ¨ä¸åšå‡ºè¿™äº›å¦¥åçš„æƒ…å†µä¸‹ä¿ç•™äº†å†…æ ¸æ—è·¯çš„å…¨éƒ¨æ€§èƒ½ä¼˜åŠ¿ï¼Œè¿™äº›è´¡çŒ®é’ˆå¯¹éš”ç¦»ã€å¯†åº¦å’Œå…¼å®¹æ€§ã€‚ä¸ºäº†åœ¨é¿å…è™šæ‹ŸåŒ–å¼€é”€çš„åŒæ—¶å®ç°å¼ºéš”ç¦»ï¼ŒJunction åœ¨æ¯ä¸ªå®ä¾‹å†…éƒ¨è¿è¡Œä¸€ä¸ªæ™®é€šçš„ Linux è¿›ç¨‹ï¼Œå¹¶å®‰è£…ä¸€ä¸ªé™åˆ¶ç³»ç»Ÿè°ƒç”¨è®¿é—®çš„è¿‡æ»¤å™¨ã€‚åœ¨å®ä¾‹å†…éƒ¨ï¼ŒJunction ä½œä¸ºä¸€ä¸ªåº“è¿è¡Œï¼Œä¸åº”ç”¨ç¨‹åºå…±äº«ä¸€ä¸ªåœ°å€ç©ºé—´ã€‚ç”±äº Junction èƒ½å¤Ÿåœ¨å†…æ ¸æ—è·¯ç¡¬ä»¶ï¼ˆå¦‚ç½‘å¡é˜Ÿåˆ—ã€CPU ç‰¹æ€§ç­‰ï¼‰ä¹‹ä¸Šæ„å»ºå…¶æ‰€æœ‰æ“ä½œç³»ç»ŸæŠ½è±¡ï¼Œå› æ­¤å®ƒåªéœ€è¦ä¸å†…æ ¸è¿›è¡Œæœ€å°‘çš„äº¤äº’ï¼Œä»…è¶³ä»¥å®ç°èµ„æºå¤ç”¨ï¼ˆâ‰ˆ åå‡ ä¸ªç³»ç»Ÿè°ƒç”¨ï¼‰ã€‚ ä¸ºäº†å®ç°é«˜å¯†åº¦ï¼ŒJunction é«˜æ•ˆåœ°å¤ç”¨äº†æ ¸å¿ƒå’Œå†…å­˜ã€‚ ä¸ºæ­¤ï¼ŒJunction åˆ›æ–°åœ°ä½¿ç”¨äº†ç½‘å¡ç¡¬ä»¶ç‰¹æ€§ï¼Œè¯¥ç‰¹æ€§åœ¨ä¸“ç”¨é˜Ÿåˆ—ä¸Šä¼ é€’æ•°æ®åŒ…åˆ°è¾¾é€šçŸ¥ï¼Œè€Œä¸æ˜¯è¦æ±‚æ¯ä¸ªæ¥æ”¶é˜Ÿåˆ—å•ç‹¬è½®è¯¢ã€‚ Junction è¿˜å®‰å…¨åœ°æš´éœ²äº† Linux é¡µé¢ç¼“å­˜ï¼Œä»¥åœ¨å®ä¾‹ä¹‹é—´å…±äº«åªè¯»å†…å­˜ pull -\u003e push ä¸ºäº†å®ç° Linux å…¼å®¹æ€§ï¼ŒJunction æä¾›äº† Linux å†…æ ¸ç³»ç»Ÿè°ƒç”¨æ¥å£çš„è‡ªæœ‰å®ç°ã€‚è¿™åœ¨ä¿æŒå†…æ ¸æ—è·¯æ€§èƒ½ä¼˜åŠ¿çš„åŒæ—¶æ˜¯ä¸€é¡¹æŒ‘æˆ˜ã€‚Junction åˆ©ç”¨å…¶ä¸åº”ç”¨ç¨‹åºè¿è¡Œåœ¨åŒä¸€åœ°å€ç©ºé—´çš„äº‹å®ï¼Œè§£é”äº†æœ€å°åŒ–å…¼å®¹æ€§æˆæœ¬çš„ä¼˜åŒ–ã€‚ä¾‹å¦‚ï¼ŒJunction å®‰å…¨åœ°å°†ç³»ç»Ÿè°ƒç”¨è½¬æ¢ä¸ºå‡½æ•°è°ƒç”¨ï¼Œé¿å…ç¬æ€æ‰§è¡Œç¼“è§£ï¼Œç›´æ¥è®¿é—®å‚æ•°è€Œä¸å¤åˆ¶å®ƒä»¬ï¼Œåˆ©ç”¨æœªå®šä¹‰è¡Œä¸ºæ¶ˆé™¤é”å®šï¼Œå¹¶ä½¿ç”¨å‘é‡æŒ‡ä»¤è€Œä¸éœ€è¦ä¿å­˜å’Œæ¢å¤å¯„å­˜å™¨çŠ¶æ€ã€‚Junction è¿˜æä¾›äº†ç°æœ‰å†…æ ¸æ—è·¯ç³»ç»Ÿä¸­ç¼ºå¤±çš„è®¸å¤šæ“ä½œç³»ç»Ÿç‰¹æ€§ï¼ˆå¦‚ä¿¡å·ã€çº¿ç¨‹æœ¬åœ°å­˜å‚¨ã€éšæœºæ€§ã€æ–‡ä»¶ç³»ç»Ÿã€å®šæ—¶å™¨ç­‰ï¼‰ï¼Œä½†è¿™äº›ç‰¹æ€§å¯¹äºæ”¯æŒäº‘åº”ç”¨è‡³å…³é‡è¦ã€‚å®ƒé€šè¿‡åˆ©ç”¨ç°ä»£ CPU æ‰©å±•æ¥é¿å…é™·å…¥å†…æ ¸ï¼Œä»è€Œä¿æŒäº†å†…æ ¸æ—è·¯çš„æ–¹æ³•æ¥æä¾›è¿™äº›ç‰¹æ€§ã€‚ å’Œåº”ç”¨ç¨‹åºåœ¨åŒä¸€åœ°å€çš„å¥½å¤„æ˜¯ä»€ä¹ˆ è¿™æ ·çš„äº‘ç›¸å…³çš„è®¾è®¡ï¼Œåœ¨ä¸ªäººçœ‹æ¥æ˜¯æ¯”è¾ƒä¼˜ç§€çš„ï¼Œä¿è¯å…¼å®¹æ€§åšæ€§èƒ½ï¼Œæ›´åŠ å®é™… ","date":"2024-10-21","objectID":"/posts/paper-junction/:3:0","tags":["Paper Reading"],"title":"Paper Reading: Making Kernel Bypass Practical for the Cloud with Junction","uri":"/posts/paper-junction/"},{"categories":null,"content":"Background \u0026 Motivation å†…æ ¸æ—è·¯ç³»ç»Ÿæ¶ˆé™¤äº†å†…æ ¸åœ¨ç½‘ç»œæ•°æ®è·¯å¾„ä¸­çš„è§’è‰²ï¼Œå¹¶å°†å…¶æ›¿æ¢ä¸ºä¸€ä¸ªä¼˜åŒ–çš„ç”¨æˆ·çº§ç½‘ç»œæ ˆï¼Œè¯¥æ ˆç›´æ¥ä¸ç½‘å¡é€šä¿¡ã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆè®¨è®ºä¸ºä»€ä¹ˆç°æœ‰çš„å†…æ ¸æ—è·¯æ–¹æ³•å­˜åœ¨ç¼ºé™·ï¼Œé˜»ç¢äº†å…¶åœ¨äº‘ç¯å¢ƒä¸­çš„é‡‡ç”¨ï¼Œç‰¹åˆ«æ˜¯åœ¨å¯†åº¦å’Œå…¼å®¹æ€§è‡³å…³é‡è¦çš„äº‘ç¯å¢ƒä¸­ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è®¨è®ºå½“å‰ä½¿å†…æ ¸æ—è·¯æ›´å…·é€šç”¨æ€§çš„è¿›å±•ã€‚æœ€åï¼Œæˆ‘ä»¬è®¨è®ºç¼ºä¹å®‰å…¨æ€§å¦‚ä½•è¿›ä¸€æ­¥åŠ å‰§è¿™äº›é—®é¢˜ã€‚ Density challenges ä¸å¹¸çš„æ˜¯ï¼Œå½“å‰çš„å†…æ ¸æ—è·¯ç³»ç»Ÿåªèƒ½åœ¨æœºå™¨ä¸Šæ”¯æŒæœ‰é™æ•°é‡çš„å®ä¾‹ã€‚ä¸€ä¸ªä¸»è¦é—®é¢˜æ˜¯å¹¿æ³›ä½¿ç”¨ç¹å¿™æ—‹è½¬å’Œä¸“ç”¨æ ¸å¿ƒ[30, 67]ã€‚å› ä¸ºè¿™ç§æ–¹æ³•è¦æ±‚æ¯ä¸ªå®ä¾‹è‡³å°‘ä¸€ä¸ªæ ¸å¿ƒï¼ˆé€šå¸¸æ›´å¤šï¼‰ï¼Œæ‰€ä»¥å®ä¾‹çš„æœ€å¤§æ•°é‡å—é™äºæ ¸å¿ƒæ•°é‡ã€‚ æ–°çš„ CPU è°ƒåº¦æ–¹æ³•é€šè¿‡åŠ å¿«æ ¸å¿ƒåˆ†é…å¯ä»¥å…‹æœè¿™ä¸€é™åˆ¶ï¼Œå¹¶åœ¨ä¸ç‰ºç‰²å°¾éƒ¨å»¶è¿Ÿçš„æƒ…å†µä¸‹æ¶ˆé™¤ç¹å¿™æ—‹è½¬çš„æµªè´¹[15, 42, 50]ã€‚ç„¶è€Œï¼Œè¿™äº›ç³»ç»Ÿä¾èµ–äºä¸“ç”¨æ ¸å¿ƒæ¥è¿›è¡Œè°ƒåº¦å†³ç­–ï¼Œå› æ­¤å…¶å¯æ‰©å±•æ€§ä»ç„¶æœ‰é™ã€‚ä¾‹å¦‚ï¼ŒCaladan ç”±äºå…¶è°ƒåº¦å™¨æ ¸å¿ƒçš„ç“¶é¢ˆï¼Œæ— æ³•æ‰©å±•åˆ°æ•°ç™¾ä¸ªå®ä¾‹ä»¥ä¸Šã€‚ æœ€åï¼Œå†…æ ¸æ—è·¯ç³»ç»Ÿçš„å†…å­˜å ç”¨ä¹Ÿæ˜¯å®ç°é«˜å¯†åº¦çš„ä¸€ä¸ªé‡å¤§éšœç¢ã€‚ Compatibility challenges. ç†æƒ³æƒ…å†µä¸‹ï¼Œå†…æ ¸æ—è·¯ç³»ç»Ÿåº”æ”¯æŒæœªä¿®æ”¹çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ç°æœ‰çš„å†…æ ¸æ—è·¯ç³»ç»Ÿåè€Œè¦æ±‚å¼€å‘äººå‘˜ç§»æ¤åº”ç”¨ç¨‹åº Making kernel bypass general purpose. æœ€è¿‘æœ‰å‡ ä¸ªåŠªåŠ›ä½¿å†…æ ¸æ—è·¯æ›´å…·é€šç”¨æ€§ã€‚ä¾‹å¦‚ï¼Œé€šå¸¸å†…æ ¸æ—è·¯ç³»ç»Ÿä½¿ç”¨ run-to-completion æ¥ä¼˜åŒ–çŸ­è¯·æ±‚[6]ï¼Œä½†è¿™åœ¨è¯·æ±‚æœåŠ¡æ—¶é—´åˆ†æ•£æ—¶ä¼šå¯¼è‡´é«˜å°¾éƒ¨å»¶è¿Ÿã€‚Shinjuku[29]å’Œ PersÃ©phone[9]åˆ†åˆ«é€šè¿‡é«˜æ•ˆã€ç»†ç²’åº¦çš„æŠ¢å å’Œå°†çŸ­è¯·æ±‚å¼•å¯¼åˆ°å•ç‹¬çš„æ ¸å¿ƒæ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚è®¸å¤šå†…æ ¸æ—è·¯ç³»ç»Ÿè¿˜ä½¿ç”¨â€œæ— å…±äº«â€è®¾è®¡ï¼Œè¿™åœ¨è´Ÿè½½ä¸å¹³è¡¡æ—¶ä¼šæŸå®³å°¾éƒ¨å»¶è¿Ÿï¼ŒZygOS é€šè¿‡å·¥ä½œçªƒå–è§£å†³äº†è¿™ä¸ªé—®é¢˜[47]ã€‚Demikernel åœ¨ä¸åŒçš„ç¡¬ä»¶åç«¯ï¼ˆå¦‚ RDMA ä¸ä»¥å¤ªç½‘ï¼‰ä¹‹ä¸Šæä¾›äº†ç»Ÿä¸€çš„æŠ½è±¡ï¼Œä»¥å‡å°‘å¼€å‘äººå‘˜çš„å·¥ä½œé‡[67]ã€‚æœ€åï¼ŒArachne[50]å’Œ Shenango[42]å±•ç¤ºäº†çº¿ç¨‹åŒ–å¯ä»¥å˜å¾—è¶³å¤Ÿå¿«ï¼Œä»¥ä¾¿ä¸å†…æ ¸æ—è·¯ç½‘ç»œä¸€èµ·ä½¿ç”¨ã€‚Junction é‡‡ç”¨äº†è¿™äº›ç³»ç»Ÿä¸­çš„å‡ ä¸ªæƒ³æ³•ï¼ŒåŒæ—¶è§£å†³äº†ä¹‹å‰æœªè§£å†³çš„å¯†åº¦å’Œå…¼å®¹æ€§æŒ‘æˆ˜ã€‚ Security challenges å¤§å¤šæ•°å†…æ ¸æ—è·¯ç³»ç»Ÿå›é¿éš”ç¦»ï¼Œå¿…é¡»ä»¥ root æƒé™è¿è¡Œã€‚å› æ­¤ï¼Œå®ƒä»¬ä¾èµ–å…¶ä»–éš”ç¦»æœºåˆ¶æ‰èƒ½åœ¨äº‘ä¸­å®‰å…¨éƒ¨ç½²ã€‚æœ€å¯è¡Œçš„é€‰æ‹©æ˜¯è®©æ¯ä¸ªå®ä¾‹åœ¨å•ç‹¬çš„è™šæ‹Ÿæœºä¸­è¿è¡Œï¼Œä½†è¿™ä¼šå¢åŠ å¼€é”€ï¼ŒåŒ…æ‹¬é¢å¤–çš„ TLB æœªå‘½ä¸­ã€VM é€€å‡ºæˆæœ¬å’Œç”±å®¢æˆ·å†…æ ¸å¼•èµ·çš„æ›´å¤§çš„å†…å­˜å ç”¨ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè™šæ‹Ÿæœºä¹Ÿæ— æ³•åˆ©ç”¨é¡µé¢ç¼“å­˜ï¼Œè¿™è¿›ä¸€æ­¥é™åˆ¶äº†å®ƒä»¬çš„å¯†åº¦ã€‚ ","date":"2024-10-21","objectID":"/posts/paper-junction/:4:0","tags":["Paper Reading"],"title":"Paper Reading: Making Kernel Bypass Practical for the Cloud with Junction","uri":"/posts/paper-junction/"},{"categories":null,"content":"Junction Overview Junction çš„æ¦‚è¿°ï¼Œå¹¶çªå‡ºäº†å…¶ä¸»è¦ç»„ä»¶ã€‚Junction è®¾è®¡ç”¨äºåœ¨æœºå™¨ä¸Šå¤„ç†æ•°åƒä¸ªå®ä¾‹ã€‚ä¸€ä¸ªå®ä¾‹æ˜¯ä¸€ä¸ªéš”ç¦»çš„å®¹å™¨ï¼Œè¿è¡Œä¸€ä¸ªæˆ–å¤šä¸ªåº”ç”¨ç¨‹åºäºŒè¿›åˆ¶æ–‡ä»¶ã€‚ä»ä¸»æœºå†…æ ¸çš„è§’åº¦æ¥çœ‹ï¼Œè¿™ä¸ªå®¹å™¨ç”±ä¸€ä¸ªå•ä¸€è¿›ç¨‹ï¼ˆç§°ä¸º kProcï¼‰å’Œä¸€ç»„å›ºå®šçš„çº¿ç¨‹ï¼ˆç§°ä¸º kThreadsï¼‰ç»„æˆï¼Œè¿™äº›çº¿ç¨‹åœ¨å¯åŠ¨æ—¶é™æ€åˆå§‹åŒ–ã€‚kThreads ç”±ä¸€ä¸ªé›†ä¸­å¼è°ƒåº¦å™¨è°ƒåº¦åˆ°æ ¸å¿ƒä¸Šï¼ˆå›¾ 1 çš„å·¦ä¾§ï¼‰ã€‚ä¸€ä¸ªå®ä¾‹å¯ä»¥åœ¨å…¶å…±äº«åœ°å€ç©ºé—´ä¸­åŠ è½½å’Œè¿è¡Œå¤šä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆå°†æ¯ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶æ”¾ç½®åœ¨è™šæ‹Ÿå†…å­˜çš„ä¸åŒåç§»é‡å¤„ï¼‰ã€‚å®ä¾‹ä¸­çš„æ¯ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶åœ¨ä¸€ä¸ªç§°ä¸º uProc çš„ç”¨æˆ·ç©ºé—´è¿›ç¨‹æŠ½è±¡ä¸­è¿è¡Œã€‚ Junction å†…æ ¸çš„å‰¯æœ¬åœ¨æ¯ä¸ªå®ä¾‹å†…éƒ¨è¿è¡Œï¼Œå¹¶ä¸ uProcs å…±äº«ä¸€ä¸ªåœ°å€ç©ºé—´ã€‚å®ƒç›´æ¥å¤„ç†æ¥è‡ª uProcs çš„ç³»ç»Ÿè°ƒç”¨ï¼Œå¹¶åœ¨ç”¨æˆ·ç©ºé—´ä¸­æä¾›æ“ä½œç³»ç»ŸæŠ½è±¡ï¼ˆå¦‚çº¿ç¨‹ã€ç½‘ç»œã€æ–‡ä»¶ç³»ç»Ÿã€ä¿¡å·ç­‰ï¼‰ï¼Œç±»ä¼¼äºåº“æ“ä½œç³»ç»Ÿ[10, 46]ã€‚Junction å†…æ ¸æ”¯æŒ Linux ç³»ç»Ÿè°ƒç”¨æ¥å£ï¼Œå› æ­¤å®ƒå¯ä»¥è¿è¡Œç°æœ‰è½¯ä»¶è€Œæ— éœ€ä¿®æ”¹ã€‚ Junction å†…æ ¸ä½¿ç”¨å†…æ ¸æ—è·¯ç¡¬ä»¶ ç½‘ç»œå’Œé€šä¿¡ã€‚ä¸å…¶ä»–å†…æ ¸æ—è·¯ç³»ç»Ÿç±»ä¼¼ï¼ŒJunction å®ä¾‹ä¸ºæ¯ä¸ª kThread æä¾›ä¸€å¯¹ NIC å‘é€å’Œæ¥æ”¶é˜Ÿåˆ—ã€‚è¿™é€šè¿‡å…è®¸å¹¶å‘è®¿é—® NIC è€Œæ— éœ€åŒæ­¥æ¥æé«˜æ€§èƒ½ã€‚Junction å†…æ ¸æä¾›äº†ä¸€ä¸ªé«˜æ€§èƒ½çš„ TCP/IP å’Œ UDP ç½‘ç»œæ ˆï¼Œä½¿ uProcs èƒ½å¤Ÿä¸å¤–ç•Œé€šä¿¡ã€‚åŒä¸€å®ä¾‹ä¸­çš„ uProcs å¯ä»¥ä½¿ç”¨æ ‡å‡†çš„è¿›ç¨‹é—´é€šä¿¡ï¼ˆIPCï¼‰åŸè¯­ï¼ˆå¦‚ç®¡é“ï¼‰ç›¸äº’é€šä¿¡ï¼Œä½†åŒä¸€ä¸»æœºä¸Šçš„ä¸åŒå®ä¾‹åªèƒ½é€šè¿‡ NIC çš„ç¯å›ç½‘ç»œè¿›è¡Œé€šä¿¡ã€‚ çº¿ç¨‹ã€‚Junction å†…æ ¸åŒ…å«ä¸€ä¸ªé«˜æ€§èƒ½çš„ç”¨æˆ·çº§çº¿ç¨‹åº“ï¼Œè¯¥åº“ä½¿ç”¨å·¥ä½œçªƒå–æ¥å¹³è¡¡è½»é‡çº§ç”¨æˆ·çº§çº¿ç¨‹ï¼ˆuThreadsï¼‰åœ¨ kThreads ä¹‹é—´çš„è´Ÿè½½ã€‚uProc çº¿ç¨‹ï¼ˆå³åœ¨å¯åŠ¨æ—¶æˆ–é€šè¿‡ clone3()åˆ›å»ºçš„çº¿ç¨‹ï¼‰æ˜ å°„åˆ° uThreadsã€‚uThreads è¿˜ç”¨äºå„ç§å†…éƒ¨ä»»åŠ¡ï¼Œå¦‚ç½‘ç»œåè®®å¤„ç†ã€‚æ¯ä¸ª kThread è¿è¡Œä¸€ä¸ªè°ƒåº¦å¾ªç¯ï¼Œè½®è¯¢æœ¬åœ°é˜Ÿåˆ—ä¸­çš„æ•°æ®åŒ…å’Œè¶…æ—¶ï¼Œå¹¶è¿è¡ŒæŒ‚èµ·çš„ uThreadsã€‚ æ ¸å¿ƒè°ƒåº¦ã€‚Junction ä¾èµ–äºå¾®å†…æ ¸é£æ ¼çš„è°ƒåº¦å™¨æ¥è¿›è¡Œæ ¸å¿ƒåˆ†é…å†³ç­–[15, 23, 42, 48]ã€‚å®ƒåœ¨ä¸“ç”¨æ ¸å¿ƒä¸Šè¿è¡Œï¼Œå¹¶ç¹å¿™è½®è¯¢æ§åˆ¶ä¿¡å·ä»¥å†³å®šä½•æ—¶ä»¥åŠå¦‚ä½•å°†æ ¸å¿ƒåˆ†é…ç»™æ¯ä¸ªå®ä¾‹ï¼ˆå¦‚å›¾ 1 ä¸­çš„çº¢è‰²åŒç®­å¤´æ‰€ç¤ºï¼‰ã€‚å®ä¾‹åœ¨ç©ºé—²æ—¶å¯ä»¥ä½¿ç”¨å°‘è‡³é›¶ä¸ªæ ¸å¿ƒï¼Œå¦‚æœéœ€æ±‚åˆç†ï¼Œåˆ™å¯ä»¥ä½¿ç”¨å¤šä¸ªæ ¸å¿ƒï¼ˆç›´è‡³æ¯ä¸ªå®ä¾‹çš„é™åˆ¶ï¼‰ã€‚å¯¹äºæ¯ä¸ªå®ä¾‹ï¼Œè°ƒåº¦å™¨ç›‘æ§çº¿ç¨‹å’Œç½‘ç»œé˜Ÿåˆ—ä¸­çš„è®¡æ—¶å™¨åˆ°æœŸå’Œæ’é˜Ÿå»¶è¿Ÿï¼Œè¿™äº›ä¿¡æ¯é€šè¿‡å…±äº«å†…å­˜å¯¹è°ƒåº¦å™¨å¯è§ã€‚å½“è°ƒåº¦å™¨å°†æ ¸å¿ƒæˆäºˆå®ä¾‹æ—¶ï¼Œå®ƒä¼šä»ä¸­é€‰æ‹©ä¸€ä¸ªç©ºé—²çš„ kThreadï¼Œå¹¶å°†å…¶å›ºå®šåœ¨è¯¥æ ¸å¿ƒä¸Šï¼Œç›´åˆ°æˆäºˆç»“æŸ é™¤äº†æ‰§è¡Œæ ¸å¿ƒåˆ†é…å¤–ï¼Œè°ƒåº¦å™¨è¿˜é€šè¿‡å‘é€ç”¨æˆ· IPIï¼ˆUIPIï¼‰[25]æ¥ååŠ©çº¿ç¨‹åº“å®ç°ç»†ç²’åº¦çš„æ—¶é—´ç‰‡è½®è½¬ï¼Œä»¥å¤„ç†è¿è¡Œ uThread å·²è¶…è¿‡å…¶æ—¶é—´ç‰‡é‡å­çš„æ ¸å¿ƒã€‚è¿™ç¡®ä¿äº†æ‰€æœ‰ uThreads éƒ½èƒ½å–å¾—è¿›å±•ï¼Œå¹¶ä¸”æ•°æ®åŒ…é˜Ÿåˆ—èƒ½åŠæ—¶æ¸…ç©ºã€‚å½“æœåŠ¡æ—¶é—´åˆ†æ•£åº¦é«˜æ—¶ï¼Œè¿™å¯¹å‡å°‘å°¾éƒ¨å»¶è¿Ÿä¹Ÿæ˜¯æœ‰åˆ©çš„[29]ã€‚ä½œä¸ºä¸€ç§ä¼˜åŒ–ï¼Œè¿™äº›ä¸­æ–­ä»…åœ¨æœ‰æ’é˜Ÿæ•°æ®åŒ…æˆ–å¯è¿è¡Œçº¿ç¨‹ç­‰å¾…å¤„ç†æ—¶å‘é€ã€‚ ç”±äº Junction æ—¨åœ¨æ”¯æŒæ•°åƒä¸ªå®ä¾‹ï¼Œå®ƒé‡‡ç”¨äº†æ–°é¢–çš„æŠ€æœ¯æ¥ç¡®ä¿æ§åˆ¶ä¿¡å·èƒ½å¤Ÿä»¥å¯æ‰©å±•çš„æ–¹å¼è¿›è¡Œç›‘æ§ã€‚è®¡æ—¶å™¨è½®è·Ÿè¸ªæ¯ä¸ªå®ä¾‹çš„ä¸‹ä¸€ä¸ªè¶…æ—¶æ—¶é—´ï¼Œè€Œ NIC äº‹ä»¶é˜Ÿåˆ—æä¾›æ•°æ®åŒ…åˆ°è¾¾çš„é€šçŸ¥ã€‚è¿™äº›å‡å°‘äº†è°ƒåº¦å™¨å¿…é¡»è½®è¯¢æ¯ä¸ªå®ä¾‹å†…éƒ¨å…±äº«çŠ¶æ€ä»¥ç¡®å®šå…¶æ˜¯å¦å¯ä»¥ä»é¢å¤–æ ¸å¿ƒä¸­å—ç›Šçš„é¢‘ç‡ã€‚æˆ‘ä»¬åœ¨ç¬¬ 5 èŠ‚ä¸­æ›´è¯¦ç»†åœ°è®¨è®ºäº†è¿™äº›ä¼˜åŒ–ã€‚ ","date":"2024-10-21","objectID":"/posts/paper-junction/:5:0","tags":["Paper Reading"],"title":"Paper Reading: Making Kernel Bypass Practical for the Cloud with Junction","uri":"/posts/paper-junction/"},{"categories":null,"content":"Security ä¼ ç»Ÿè§‚ç‚¹è®¤ä¸ºï¼Œåº”ä½¿ç”¨è™šæ‹Ÿæœºä½œä¸ºäº‘çš„éš”ç¦»è¾¹ç•Œï¼Œä»¥å‡å°‘ä¸å—ä¿¡ä»»ä»£ç ä¸ä¸»æœºå†…æ ¸ä¹‹é—´çš„äº¤äº’ã€‚ç„¶è€Œï¼Œè™šæ‹ŸåŒ–ä»ç„¶ä¼šæ‰§è¡Œä¸»æœºå†…æ ¸ä¸­å¤§é‡å—ä¿¡ä»»çš„ä»£ç ï¼Œä»è€Œå¯¼è‡´æ˜¾è‘—çš„æ”»å‡»é¢[3, 65]ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒJunction ç›´æ¥åœ¨å†…æ ¸æ—è·¯ç¡¬ä»¶ä¹‹ä¸Šæä¾›æ“ä½œç³»ç»ŸæŠ½è±¡ï¼Œæ˜¾è‘—å‡å°‘äº†å¯¹ä¸»æœºå†…æ ¸çš„ä¾èµ–ã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†æ›´è¯¦ç»†åœ°è®¨è®º Junction çš„å®‰å…¨è®¾è®¡ã€‚ æ²¡æ‡‚ ","date":"2024-10-21","objectID":"/posts/paper-junction/:6:0","tags":["Paper Reading"],"title":"Paper Reading: Making Kernel Bypass Practical for the Cloud with Junction","uri":"/posts/paper-junction/"},{"categories":null,"content":"Threat Model ","date":"2024-10-21","objectID":"/posts/paper-junction/:6:1","tags":["Paper Reading"],"title":"Paper Reading: Making Kernel Bypass Practical for the Cloud with Junction","uri":"/posts/paper-junction/"},{"categories":null,"content":"Host Kernel Isolation Page cache? ","date":"2024-10-21","objectID":"/posts/paper-junction/:6:2","tags":["Paper Reading"],"title":"Paper Reading: Making Kernel Bypass Practical for the Cloud with Junction","uri":"/posts/paper-junction/"},{"categories":null,"content":"Optimizing for Density Junction çš„ç›®æ ‡æ˜¯æä¾›é«˜ç½‘ç»œååé‡å’Œä½å»¶è¿Ÿï¼Œç±»ä¼¼äºç°æœ‰çš„å†…æ ¸æ—è·¯ç³»ç»Ÿï¼ŒåŒæ—¶è¿˜èƒ½åœ¨æœºå™¨ä¸Šæ‰“åŒ…æ›´å¤šçš„å®ä¾‹ã€‚è¿™è¦æ±‚æˆ‘ä»¬è§£å†³ä¸ä½¿ç”¨å¤§é‡ NIC æ¥æ”¶é˜Ÿåˆ—ç›¸å…³çš„å‡ ä¸ªé—®é¢˜ã€‚ ä»ç„¶å¿…é¡»ä¸ºæ¯ä¸ªå®ä¾‹åˆ†é…è¶³å¤Ÿçš„æ¥æ”¶é˜Ÿåˆ—ï¼Œä»¥ä¾¿æ¯ä¸ªå¯èƒ½è¿è¡Œçš„ kThread éƒ½æœ‰ä¸€ä¸ªå¯ç”¨çš„é˜Ÿåˆ—ã€‚å› æ­¤ï¼Œæ‰€éœ€çš„é˜Ÿåˆ—æ•°é‡æ˜¯æ¯ä¸ªå®ä¾‹çš„æœ€å¤§æ ¸å¿ƒæ•°ä¹˜ä»¥å®ä¾‹æ•°é‡ã€‚ ç°ä»£ç½‘å¡å¯ä»¥è½»æ¾æ‰©å±•åˆ°æ•°åƒä¸ªé˜Ÿåˆ—ï¼Œä½†ä½¿ç”¨å®ƒä»¬åœ¨æœºå™¨ä¸Šæ‰“åŒ…è®¸å¤šå®ä¾‹ä»ç„¶é¢ä¸´é‡å¤§æŒ‘æˆ˜ã€‚é¦–å…ˆï¼Œç¼“å†²åŒºå†…å­˜æ¶ˆè€—æ˜¯å¯†åº¦çš„å…³é”®é™åˆ¶ï¼Œå› ä¸ºæ¯ä¸ªæ¥æ”¶é˜Ÿåˆ—å¿…é¡»å‘å¸ƒè¶³å¤Ÿçš„ç¼“å†²åŒºä»¥å®¹çº³æœ€åæƒ…å†µä¸‹çš„æ•°æ®åŒ…çªå‘ï¼Œè¿™åœ¨æ ¸å¿ƒä¹‹é—´çš„æµé‡ä¸å‡åŒ€æ—¶ä¼šåŠ å‰§ã€‚å…¶æ¬¡ï¼Œæ ¸å¿ƒè°ƒåº¦å™¨è½®è¯¢æ¯ä¸ªé˜Ÿåˆ—çš„æˆæœ¬å˜å¾—è¿‡é«˜ï¼Œç¼“å­˜æ±¡æŸ“å¯¼è‡´æ€§èƒ½å´©æºƒã€‚æˆ‘ä»¬ç°åœ¨æ›´è¯¦ç»†åœ°è®¨è®ºæˆ‘ä»¬é’ˆå¯¹è¿™äº›é—®é¢˜çš„è§£å†³æ–¹æ¡ˆã€‚ é˜Ÿåˆ—æ•°é‡å¾ˆå¤š ","date":"2024-10-21","objectID":"/posts/paper-junction/:7:0","tags":["Paper Reading"],"title":"Paper Reading: Making Kernel Bypass Practical for the Cloud with Junction","uri":"/posts/paper-junction/"},{"categories":null,"content":"Minimizing Buffer Memory Consumption ","date":"2024-10-21","objectID":"/posts/paper-junction/:7:1","tags":["Paper Reading"],"title":"Paper Reading: Making Kernel Bypass Practical for the Cloud with Junction","uri":"/posts/paper-junction/"},{"categories":null,"content":"Scalable Queue Polling é¦–å…ˆï¼Œå®ƒä»¥æ–°é¢–çš„æ–¹å¼ä½¿ç”¨ä¸€ç»„ç½‘å¡ç‰¹æ€§æ¥é¿å…æŒç»­è½®è¯¢ç©ºé—²ç½‘ç»œé˜Ÿåˆ—ã€‚Junction ä¸ºè°ƒåº¦å™¨æ ¸å¿ƒåˆ†é…äº†ä¸€ä¸ªå•ä¸€çš„äº‹ä»¶é˜Ÿåˆ—å’Œä¸“ç”¨çš„é—¨é“ƒé¡µé¢ã€‚æ¯æ¬¡è°ƒåº¦å™¨è§‚å¯Ÿåˆ°ä¸€ä¸ªç©ºæ¥æ”¶é˜Ÿåˆ—æ—¶ï¼Œå®ƒä¼šé€šè¿‡æ ‡è®°å½“å‰å¤´æŒ‡é’ˆçš„ç´¢å¼•å¹¶å†™å…¥é—¨é“ƒæ¥æ­¦è£…é˜Ÿåˆ—ã€‚å½“æ•°æ®åŒ…åˆ°è¾¾ä¸€ä¸ªæ­¦è£…é˜Ÿåˆ—æ—¶ï¼Œç½‘å¡å°†ä¸€ä¸ªäº‹ä»¶å†™å…¥äº‹ä»¶é˜Ÿåˆ—å¹¶è§£é™¤é˜Ÿåˆ—çš„æ­¦è£…ã€‚è°ƒåº¦å™¨ä¸æ–­è½®è¯¢äº‹ä»¶é˜Ÿåˆ—ï¼Œå¹¶åœ¨æ•°æ®åŒ…åˆ°è¾¾ç©ºé—²é˜Ÿåˆ—æ—¶ç«‹å³åšå‡ºååº”ã€‚æ­¤ç‰¹æ€§åœ¨ç°ä»£ Mellanox ç½‘å¡ä¸Šå¯ç”¨ã€‚ ç¡¬ä»¶é™åˆ¶å¿…é¡»ç”¨æ–°çš„ï¼Ÿ ","date":"2024-10-21","objectID":"/posts/paper-junction/:7:2","tags":["Paper Reading"],"title":"Paper Reading: Making Kernel Bypass Practical for the Cloud with Junction","uri":"/posts/paper-junction/"},{"categories":null,"content":"Linux Compatibility ","date":"2024-10-21","objectID":"/posts/paper-junction/:8:0","tags":["Paper Reading"],"title":"Paper Reading: Making Kernel Bypass Practical for the Cloud with Junction","uri":"/posts/paper-junction/"},{"categories":null,"content":"Adapting OS Features to Kernel Bypass ELK åŠ è½½å™¨ vfork() ","date":"2024-10-21","objectID":"/posts/paper-junction/:8:1","tags":["Paper Reading"],"title":"Paper Reading: Making Kernel Bypass Practical for the Cloud with Junction","uri":"/posts/paper-junction/"},{"categories":null,"content":"Performance Optimizations seccomp æ‹¦æˆª ","date":"2024-10-21","objectID":"/posts/paper-junction/:8:2","tags":["Paper Reading"],"title":"Paper Reading: Making Kernel Bypass Practical for the Cloud with Junction","uri":"/posts/paper-junction/"},{"categories":null,"content":"Implementation ","date":"2024-10-21","objectID":"/posts/paper-junction/:9:0","tags":["Paper Reading"],"title":"Paper Reading: Making Kernel Bypass Practical for the Cloud with Junction","uri":"/posts/paper-junction/"},{"categories":null,"content":"Evaluation è¿™é‡Œçš„å‡ ä¸ªä¾‹å­è¿˜æ˜¯æŒºæœ‰æ„æ€çš„ ","date":"2024-10-21","objectID":"/posts/paper-junction/:10:0","tags":["Paper Reading"],"title":"Paper Reading: Making Kernel Bypass Practical for the Cloud with Junction","uri":"/posts/paper-junction/"},{"categories":null,"content":"Methodology åªè¯´äº†åº”ç”¨ï¼Œä½†æ˜¯æ€ä¹ˆæ²¡è¯´å¼€äº†å¤šå°‘ instancesï¼Ÿ ","date":"2024-10-21","objectID":"/posts/paper-junction/:10:1","tags":["Paper Reading"],"title":"Paper Reading: Making Kernel Bypass Practical for the Cloud with Junction","uri":"/posts/paper-junction/"},{"categories":null,"content":"Comparison to other kernel bypass systems ","date":"2024-10-21","objectID":"/posts/paper-junction/:10:2","tags":["Paper Reading"],"title":"Paper Reading: Making Kernel Bypass Practical for the Cloud with Junction","uri":"/posts/paper-junction/"},{"categories":null,"content":"Density æ¨ªåæ ‡æ˜¯ number of applications Linux å†…å­˜å ç”¨å‡ ä¹ä¸åŠ¨ ä½†æ˜¯ FireCracker, Caladan å ç”¨å¾ˆé«˜ Junction å‘ˆçº¿æ€§å¢åŠ ï¼Œä¸ºä»€ä¹ˆä¼šå¢åŠ å‘¢ï¼Ÿé˜Ÿåˆ—ï¼Ÿ ","date":"2024-10-21","objectID":"/posts/paper-junction/:10:3","tags":["Paper Reading"],"title":"Paper Reading: Making Kernel Bypass Practical for the Cloud with Junction","uri":"/posts/paper-junction/"},{"categories":null,"content":"Compatibility ","date":"2024-10-21","objectID":"/posts/paper-junction/:10:4","tags":["Paper Reading"],"title":"Paper Reading: Making Kernel Bypass Practical for the Cloud with Junction","uri":"/posts/paper-junction/"},{"categories":null,"content":"Attack Surface Junction ä½¿ç”¨å†…æ ¸æ—è·¯æŠ€æœ¯å‡å°‘äº†ç›¸å¯¹äºç°æœ‰ä»¥å®‰å…¨æ€§ä¸ºé‡ç‚¹çš„åº“æ“ä½œç³»ç»Ÿçš„ä¸»æœºå†…æ ¸æ”»å‡»é¢ã€‚ èƒ½æä¾› attack å®‰å…¨æ€§çš„æµ‹è¯•å€’æ˜¯å¾ˆæœ‰æ„æ€ ","date":"2024-10-21","objectID":"/posts/paper-junction/:10:5","tags":["Paper Reading"],"title":"Paper Reading: Making Kernel Bypass Practical for the Cloud with Junction","uri":"/posts/paper-junction/"},{"categories":null,"content":"Performance Analysis Performance optimizations Pinned memory ","date":"2024-10-21","objectID":"/posts/paper-junction/:10:6","tags":["Paper Reading"],"title":"Paper Reading: Making Kernel Bypass Practical for the Cloud with Junction","uri":"/posts/paper-junction/"},{"categories":null,"content":"Discussion ç¡¬ä»¶é™åˆ¶ï¼ŒCPUã€NIC ","date":"2024-10-21","objectID":"/posts/paper-junction/:11:0","tags":["Paper Reading"],"title":"Paper Reading: Making Kernel Bypass Practical for the Cloud with Junction","uri":"/posts/paper-junction/"},{"categories":null,"content":"Conclusion .. å›«å›µåæ£ çœ‹ä¸å¤ªæ‡‚é‡Œé¢çš„ä¸€äº›è®¾è®¡ï¼Œçœ‹å®Œä¹Ÿä¸çŸ¥é“æ€ä¹ˆå®ç°çš„å†…æ ¸æ—è·¯ï¼Œæ›´åƒæ˜¯ userspace ä¹‹ç±»çš„ evaluation ä¹Ÿæ²¡æ¯”è¾ƒ cpu å ç”¨ç‡ä»€ä¹ˆçš„ æ¯ä¸ªæ ¸å¿ƒä¸€ä¸ª buffer queue æ”¹æˆäº† shared buffer queue å…¼å®¹æ€§å’Œ density åº”è¯¥æ˜¯æœ€äº®çœ¼çš„ï¼Œæ€§èƒ½å¯èƒ½å—ç¡¬ä»¶é™åˆ¶å¾ˆä¸¥é‡ è®ºæ–‡å¤ªä¹±äº†ï¼Œæ„Ÿè§‰ä»–ä»¬è®¾è®¡åº”è¯¥æ˜¯å¾ˆå¤šä¸œè¥¿å¯ä»¥è®²çš„ ","date":"2024-10-21","objectID":"/posts/paper-junction/:12:0","tags":["Paper Reading"],"title":"Paper Reading: Making Kernel Bypass Practical for the Cloud with Junction","uri":"/posts/paper-junction/"},{"categories":null,"content":"Appendix UIPI Support ","date":"2024-10-21","objectID":"/posts/paper-junction/:13:0","tags":["Paper Reading"],"title":"Paper Reading: Making Kernel Bypass Practical for the Cloud with Junction","uri":"/posts/paper-junction/"},{"categories":null,"content":"Firecracker: Lightweight Virtualization for Serverless Applications å¼€æºçš„ VMM ä¸å¤ªæ„Ÿå…´è¶£ï¼Œçœ‹ä¸€çœ¼ presentation å’Œå®ç°ç»†èŠ‚å°±è¿‡äº† æ¯” QEMU è½»é‡çº§ï¼Œæ›´æ³¨é‡å‡ ä¸ªä¸“ç”¨åœºæ™¯ æ¯”å¦‚æ²¡æœ‰ BIOS æ²¡æœ‰ PCI å’Œå®¹å™¨åŒ–ç»“åˆæ¯”è¾ƒå¥½ motivation æ¥è‡ª EC2 å¤ªå¤§ï¼Œlambda åˆå¤ªå°ï¼Œä¸€äº›éš”ç¦» å…¼å®¹æ€§çœ‹ç€ä¸é”™ï¼Œå’Œ linux æ˜¯å…¼å®¹çš„ soft allocation æ˜¯æŒ‡è¶…å–å—ï¼Œéœ€è¦çš„æ—¶å€™æ‰å®é™…åˆ†é… è§£å†³çš„é—®é¢˜ï¼šQEMU/KVM éš¾ä»¥æ”¯æŒè¿è¡Œå¤šä¸ªè™šæ‹Ÿæœºï¼ŸLXC éš”ç¦»æ€§è¾ƒå¼±ï¼ŸLibOS å…¼å®¹æ€§é—®é¢˜ï¼Ÿè¯­è¨€ VM æ¯”å¦‚ JVM éš”ç¦»å…¼å®¹æ€§é—®é¢˜ï¼Ÿ æ€§èƒ½æ¯”è¾ƒäº† QEMU å’Œ FC çš„ä¸€äº›æŒ‡æ ‡ï¼šboot time (serial \u0026\u0026 50 parallel) åè€…ç”Ÿäº§ç¯å¢ƒè¡¨ç°ä¸€èˆ¬ï¼Œ QD1 IO latency vs bare metal (æ·±åº¦ä¸ºä¸€ï¼Œç±»ä¼¼ä¸²è¡Œ) QD32 IO throughput vs bare metal ï¼ˆååé‡è¡¨ç°å¾ˆå·®ï¼Œè¢« QEMU å®Œè™ï¼Œå¯èƒ½è§‰å¾—è¿˜éœ€è¦ä¿®æ”¹ iouring ä¹‹ç±»çš„ï¼‰ é˜Ÿåˆ—æ·±åº¦ä¸‹çš„ IO å»¶è¿Ÿå’Œååé‡ ä¸»è¦è¿˜æ˜¯å‡ ä¸ªé—®é¢˜ï¼šå…¼å®¹æ€§ï¼Œæ€§èƒ½å…¼å®¹æ€§ï¼Œä¸€äº›åŒ…ç®¡ç† rpm çš„ä¸ç¡®å®šæ€§ï¼Œ å¯ä»¥åšçš„è¿˜æœ‰ IO æå‡ã€scheduling (tail latency)ã€æ­£ç¡®æ€§è¯æ˜ (isolation) ä¸€äº› feature æ¯”å¦‚ snapshot rust-vmm å…¶ä»–ä¸€äº›åˆ†äº«ï¼šhttps://draveness.me/papers-firecracker/ https://easoncao.com/firecracker-paper-reading/#%E7%B8%BD%E7%B5%90 ","date":"2024-10-16","objectID":"/posts/paper-firecracker/:1:0","tags":["Paper Reading"],"title":"Paper Reading: Firecracker ","uri":"/posts/paper-firecracker/"},{"categories":null,"content":"Choosing an Isolation Solution ","date":"2024-10-16","objectID":"/posts/paper-firecracker/:2:0","tags":["Paper Reading"],"title":"Paper Reading: Firecracker ","uri":"/posts/paper-firecracker/"},{"categories":null,"content":"Xen and the Art of Virtualization Xen æ˜¯å¼€æºçš„è™šæ‹ŸåŒ–é¡¹ç›®ï¼Œhttps://xenproject.org/ æœ¬æ–‡äº 2003 å¹´å‘å¸ƒï¼Œå·²ç» 20 å¹´è¿‡å»äº†ï¼Œå’Œç›®å‰çš„è™šæ‹ŸåŒ–æŠ€æœ¯åˆæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿæ¯”å¦‚å®¹å™¨åŒ–æˆ– Intel VT-X ç­‰ç­‰ï¼Ÿ ç›´æ¥è¿è¡Œåœ¨è®¡ç®—æœºç¡¬ä»¶ä¹‹ä¸Šçš„ç”¨ä»¥æ›¿ä»£æ“ä½œç³»ç»Ÿçš„è½¯ä»¶å±‚ï¼Œè™šæ‹ŸåŒ–åˆåˆ†ä¸¤ç±»ã€para virtualization å’Œ hardware virtualization åŠè™šæ‹ŸåŒ–å’Œå®Œå…¨è™šæ‹ŸåŒ– åŠè™šæ‹ŸåŒ–ï¼Œè¶…è™šæ‹ŸåŒ–ï¼Œä¹Ÿå°±æ˜¯ Xenï¼Œè™šæ‹ŸæœºçŸ¥é“è‡ªå·±æ˜¯ Xen Hypervisorï¼Œä¹Ÿèƒ½è¯†åˆ«å…¶ä»–è¿è¡Œåœ¨ç›¸åŒç¯å¢ƒçš„è™šæ‹Ÿæœº å®Œå…¨è™šæ‹ŸåŒ–ï¼Œç¡¬ä»¶è™šæ‹ŸåŒ–ï¼Œè™šæ‹Ÿæœºä¼šè§‰å¾—è‡ªå·±ç›´æ¥è¿è¡Œåœ¨ç¡¬ä»¶ä¸Š æ„Ÿè§‰ç›®å‰çš„ä¸»æµè¿˜æ˜¯ KVM (QEMU)ï¼Œå†…æ ¸æ€åŸºç¡€ä¸Šåšè™šæ‹ŸåŒ–ï¼Œå¯ä»¥é‡ç”¨è®¸å¤šä»£ç ï¼Œæ¯”å¦‚å†…å­˜ç®¡ç†ã€‚ äº‹å®ä¹Ÿæ­£æ˜¯å¦‚æ­¤ï¼Œç›®å‰å…³äºè™šæ‹ŸåŒ–æŠ€æœ¯ï¼Œå¤§éƒ¨åˆ†äººéƒ½ä¼šé€‰æ‹© KVM è€Œä¸æ˜¯ Xenï¼Œè€Œä¸” Xen èƒ½ç”¨çš„ Linux ç‰ˆæœ¬éå¸¸å¤è€ ä¼¼ä¹ Linux å¼€å‘ç¤¾åŒºæ¯”å¦‚ Linus å’Œ Xen å¼€å‘äººå‘˜ä¹Ÿæœ‰äº‰åµï¼Œè´¨ç–‘ä»–ä»¬çš„ä»£ç ä¸è§„èŒƒç­‰ç­‰ã€‚ åœ¨ 2017 å¹´ Amazon EC2 ä¹Ÿå»æ‰äº† Xen (å®‰å…¨é—®é¢˜ï¼Ÿè¿˜æ˜¯è¯´éš¾ä»¥ä¿®å¤) å…³äº Xen ä¸ºä»€ä¹ˆå‘å±•å‡ºç°é—®é¢˜ï¼Œæœ€åæ¯”ä¸è¿‡ KVM çš„ç›¸å…³çš„å†å²å¯ä»¥çœ‹ä¸€çœ‹ https://wangxu.me/translation/2009/03/22/xen-to-kernel/index.html https://fosschef.wordpress.com/2011/06/17/xen-the-road-of-the-life/ ","date":"2024-10-12","objectID":"/posts/paper-xen-vir/:1:0","tags":["Paper Reading"],"title":"Paper Reading: Xen and the Art of Virtualization","uri":"/posts/paper-xen-vir/"},{"categories":null,"content":"ABSTRACT è®¸å¤šç³»ç»Ÿå·²ç»è¢«è®¾è®¡å‡ºæ¥ï¼Œå®ƒä»¬åˆ©ç”¨è™šæ‹ŸåŒ–æŠ€æœ¯æ¥ç»†åˆ†ç°ä»£è®¡ç®—æœºçš„ä¸°å¯Œèµ„æºã€‚ä¸€äº›ç³»ç»Ÿéœ€è¦ä¸“é—¨çš„ç¡¬ä»¶ï¼Œæˆ–è€…æ— æ³•æ”¯æŒé€šç”¨æ“ä½œç³»ç»Ÿã€‚ä¸€äº›ç³»ç»Ÿä»¥æ€§èƒ½ä¸ºä»£ä»·å®ç°äº† 100% çš„äºŒè¿›åˆ¶å…¼å®¹æ€§ã€‚å…¶ä»–ç³»ç»Ÿåˆ™ä¸ºäº†é€Ÿåº¦è€Œç‰ºç‰²äº†å®‰å…¨æ€§æˆ–åŠŸèƒ½æ€§ã€‚å¾ˆå°‘æœ‰ç³»ç»Ÿæä¾›èµ„æºéš”ç¦»æˆ–æ€§èƒ½ä¿è¯ï¼›å¤§å¤šæ•°ç³»ç»Ÿåªæä¾›å°½åŠ›è€Œä¸ºçš„èµ„æºåˆ†é…ï¼Œå­˜åœ¨æœåŠ¡æ‹’ç»çš„é£é™©ã€‚ This paper presents Xen, an x86 virtual machine monitor which allows multiple commodity operating systems to share conventional hardware in a safe and resource managed fashion, åŒæ—¶ä¸ç‰ºç‰²æ€§èƒ½æˆ–åŠŸèƒ½ã€‚è¿™æ˜¯é€šè¿‡æä¾›ä¸€ä¸ªç†æƒ³åŒ–çš„è™šæ‹ŸæœºæŠ½è±¡æ¥å®ç°çš„ï¼Œæ“ä½œç³»ç»Ÿå¦‚ Linuxã€BSD å’Œ Windows XP å¯ä»¥ä»¥æœ€å°çš„åŠªåŠ›ç§»æ¤åˆ°è¿™ä¸ªæŠ½è±¡ä¸Šã€‚ æˆ‘ä»¬çš„è®¾è®¡ç›®æ ‡æ˜¯åŒæ—¶åœ¨ä¸€å°ç°ä»£æœåŠ¡å™¨ä¸Šæ‰˜ç®¡å¤šè¾¾ 100 ä¸ªè™šæ‹Ÿæœºå®ä¾‹ã€‚Xen é‡‡ç”¨çš„è™šæ‹ŸåŒ–æ–¹æ³•éå¸¸é«˜æ•ˆï¼šæˆ‘ä»¬å…è®¸åƒ Linux å’Œ Windows XP è¿™æ ·çš„æ“ä½œç³»ç»ŸåŒæ—¶æ‰˜ç®¡ï¼Œæ€§èƒ½å¼€é”€å‡ ä¹å¯ä»¥å¿½ç•¥ä¸è®¡â€”â€”æœ€å¤šæ¯”éè™šæ‹ŸåŒ–æƒ…å†µé«˜å‡ºå‡ ä¸ªç™¾åˆ†ç‚¹ã€‚æˆ‘ä»¬åœ¨ä¸€ç³»åˆ—å¾®åŸºå‡†æµ‹è¯•å’Œç³»ç»Ÿçº§æµ‹è¯•ä¸­æ˜¾è‘—ä¼˜äºç«äº‰çš„å•†ä¸šå’Œå…è´¹è§£å†³æ–¹æ¡ˆã€‚ ","date":"2024-10-12","objectID":"/posts/paper-xen-vir/:2:0","tags":["Paper Reading"],"title":"Paper Reading: Xen and the Art of Virtualization","uri":"/posts/paper-xen-vir/"},{"categories":null,"content":"INTRODUCTION ç°ä»£è®¡ç®—æœºè¶³å¤Ÿå¼ºå¤§ï¼Œå¯ä»¥åˆ©ç”¨è™šæ‹ŸåŒ–æŠ€æœ¯æ¥å‘ˆç°è®¸å¤šè¾ƒå°çš„è™šæ‹Ÿæœºï¼ˆVMï¼‰çš„å‡è±¡ï¼Œæ¯ä¸ªè™šæ‹Ÿæœºè¿è¡Œä¸€ä¸ªå•ç‹¬çš„æ“ä½œç³»ç»Ÿå®ä¾‹ã€‚ åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº† Xenï¼Œä¸€ç§é«˜æ€§èƒ½çš„èµ„æºç®¡ç†è™šæ‹Ÿæœºç›‘è§†å™¨ï¼ˆVMMï¼‰ï¼Œå®ƒæ”¯æŒè¯¸å¦‚æœåŠ¡å™¨æ•´åˆ[42, 8]ã€å…±ç½®æ‰˜ç®¡è®¾æ–½[14]ã€åˆ†å¸ƒå¼ Web æœåŠ¡[43]ã€å®‰å…¨è®¡ç®—å¹³å°[12, 16]å’Œåº”ç”¨ç¨‹åºç§»åŠ¨æ€§[26, 37]ç­‰åº”ç”¨ã€‚ ä¸ºä»€ä¹ˆè¦å« Monitor æˆ–è€… Hypervisor Xen åº”è¯¥æ˜¯ç›´æ¥è·‘åœ¨ç¡¬ä»¶ä¸Šï¼Œè€Œ VMware åº”è¯¥æ˜¯è·‘åœ¨æ“ä½œç³»ç»Ÿä¸Š æˆåŠŸåœ°å°†ä¸€å°æœºå™¨åˆ†åŒºä»¥æ”¯æŒå¤šä¸ªæ“ä½œç³»ç»Ÿçš„å¹¶å‘æ‰§è¡Œæå‡ºäº†å‡ ä¸ªæŒ‘æˆ˜ã€‚é¦–å…ˆï¼Œè™šæ‹Ÿæœºå¿…é¡»ç›¸äº’éš”ç¦»ï¼šä¸€ä¸ªè™šæ‹Ÿæœºçš„æ‰§è¡Œä¸åº”ä¸åˆ©åœ°å½±å“å¦ä¸€ä¸ªè™šæ‹Ÿæœºçš„æ€§èƒ½ã€‚å½“è™šæ‹Ÿæœºç”±ç›¸äº’ä¸ä¿¡ä»»çš„ç”¨æˆ·æ‹¥æœ‰æ—¶ï¼Œè¿™ä¸€ç‚¹å°¤ä¸ºé‡è¦ã€‚å…¶æ¬¡ï¼Œæœ‰å¿…è¦æ”¯æŒå„ç§ä¸åŒçš„æ“ä½œç³»ç»Ÿï¼Œä»¥é€‚åº”æµè¡Œåº”ç”¨ç¨‹åºçš„å¼‚æ„æ€§ã€‚ç¬¬ä¸‰ï¼Œè™šæ‹ŸåŒ–å¼•å…¥çš„æ€§èƒ½å¼€é”€åº”è¯¥å¾ˆå°ã€‚ Xen ä½¿ç”¨æˆ·èƒ½å¤ŸåŠ¨æ€å®ä¾‹åŒ–ä¸€ä¸ªæ“ä½œç³»ç»Ÿæ¥æ‰§è¡Œä»–ä»¬æƒ³è¦çš„ä»»ä½•æ“ä½œã€‚ æœ‰å¤šç§æ–¹æ³•å¯ä»¥åœ¨å…±äº«æœºå™¨ä¸Šæ„å»ºæ‰˜ç®¡å¤šä¸ªåº”ç”¨ç¨‹åºå’ŒæœåŠ¡çš„ç³»ç»Ÿã€‚ä¹Ÿè®¸æœ€ç®€å•çš„æ–¹æ³•æ˜¯éƒ¨ç½²ä¸€ä¸ªæˆ–å¤šä¸ªè¿è¡Œæ ‡å‡†æ“ä½œç³»ç»Ÿï¼ˆå¦‚ Linux æˆ– Windowsï¼‰çš„ä¸»æœºï¼Œç„¶åå…è®¸ç”¨æˆ·å®‰è£…æ–‡ä»¶å¹¶å¯åŠ¨è¿›ç¨‹â€”â€”åº”ç”¨ç¨‹åºä¹‹é—´çš„ä¿æŠ¤ç”±ä¼ ç»Ÿçš„æ“ä½œç³»ç»ŸæŠ€æœ¯æä¾›ã€‚ç»éªŒè¡¨æ˜ï¼Œç”±äºçœ‹ä¼¼ä¸ç›¸å…³çš„åº”ç”¨ç¨‹åºä¹‹é—´çš„å¤æ‚é…ç½®äº¤äº’ï¼Œç³»ç»Ÿç®¡ç†å¯èƒ½ä¼šè¿…é€Ÿæˆä¸ºä¸€é¡¹è€—æ—¶çš„ä»»åŠ¡ã€‚ this paper focuses on the VMM æ›´é‡è¦çš„æ˜¯ï¼Œè¿™æ ·çš„ç³»ç»Ÿä¸èƒ½å……åˆ†æ”¯æŒæ€§èƒ½éš”ç¦»ï¼›ä¸€ä¸ªè¿›ç¨‹çš„è°ƒåº¦ä¼˜å…ˆçº§ã€å†…å­˜éœ€æ±‚ã€ç½‘ç»œæµé‡å’Œç£ç›˜è®¿é—®ä¼šå½±å“å…¶ä»–è¿›ç¨‹çš„æ€§èƒ½ã€‚å½“æœ‰è¶³å¤Ÿçš„èµ„æºåˆ†é…å’Œå°é—­çš„ç”¨æˆ·ç»„ï¼ˆå¦‚è®¡ç®—ç½‘æ ¼æˆ–å®éªŒæ€§ PlanetLab å¹³å°[33]çš„æƒ…å†µï¼‰æ—¶ï¼Œè¿™å¯èƒ½æ˜¯å¯ä»¥æ¥å—çš„ï¼Œä½†åœ¨èµ„æºè¶…é¢é¢„è®¢æˆ–ç”¨æˆ·ä¸åˆä½œçš„æƒ…å†µä¸‹åˆ™ä¸ç„¶ã€‚ æœ€é‡è¦çš„é—®é¢˜å°±æ˜¯æ€§èƒ½éš”ç¦» è§£å†³è¿™ä¸ªé—®é¢˜çš„ä¸€ç§æ–¹æ³•æ˜¯å‘æ“ä½œç³»ç»Ÿæ·»åŠ å¯¹æ€§èƒ½éš”ç¦»çš„æ”¯æŒã€‚è¿™åœ¨ä¸€å®šç¨‹åº¦ä¸Šå·²ç»é€šè¿‡èµ„æºå®¹å™¨[3]ã€Linux/RK[32]ã€QLinux[40]å’Œ SILK[4]å¾—åˆ°äº†è¯æ˜ã€‚è¿™ç§æ–¹æ³•çš„ä¸€ä¸ªå›°éš¾æ˜¯ç¡®ä¿æ‰€æœ‰èµ„æºä½¿ç”¨éƒ½å½’å› äºæ­£ç¡®çš„è¿›ç¨‹â€”â€”ä¾‹å¦‚ï¼Œè€ƒè™‘ç”±äºç¼“å†²åŒºç¼“å­˜æˆ–é¡µé¢æ›¿æ¢ç®—æ³•å¯¼è‡´çš„åº”ç”¨ç¨‹åºä¹‹é—´çš„å¤æ‚äº¤äº’ã€‚è¿™å®é™…ä¸Šæ˜¯æ“ä½œç³»ç»Ÿå†…éƒ¨çš„â€œQoS crosstalkâ€é—®é¢˜[41]ã€‚åœ¨è¾ƒä½çº§åˆ«è¿›è¡Œå¤šè·¯å¤ç”¨å¯ä»¥ç¼“è§£è¿™ä¸ªé—®é¢˜ï¼Œæ­£å¦‚ Exokernel[23]å’Œ Nemesis[27]æ“ä½œç³»ç»Ÿæ‰€å±•ç¤ºçš„é‚£æ ·ã€‚ä»»åŠ¡ä¹‹é—´çš„æ— æ„æˆ–ä¸å¸Œæœ›çš„äº¤äº’è¢«æœ€å°åŒ–ã€‚ æˆ‘ä»¬ä½¿ç”¨ç›¸åŒçš„åŸºæœ¬æ–¹æ³•æ¥æ„å»º Xenï¼Œå®ƒåœ¨æ•´ä¸ªæ“ä½œç³»ç»Ÿçš„ç²’åº¦ä¸Šå¤šè·¯å¤ç”¨ç‰©ç†èµ„æºï¼Œå¹¶èƒ½å¤Ÿæä¾›å®ƒä»¬ä¹‹é—´çš„æ€§èƒ½éš”ç¦»ã€‚ä¸è¿›ç¨‹çº§å¤šè·¯å¤ç”¨ç›¸æ¯”ï¼Œè¿™ä¹Ÿå…è®¸ä¸€ç³»åˆ—å®¢æˆ·æ“ä½œç³»ç»Ÿä¼˜é›…åœ°å…±å­˜ï¼Œè€Œä¸æ˜¯å¼ºåˆ¶æ‰§è¡Œç‰¹å®šçš„åº”ç”¨ç¨‹åºäºŒè¿›åˆ¶æ¥å£ã€‚è¿™ç§çµæ´»æ€§æ˜¯æœ‰ä»£ä»·çš„â€”â€”è¿è¡Œä¸€ä¸ªå®Œæ•´çš„æ“ä½œç³»ç»Ÿæ¯”è¿è¡Œä¸€ä¸ªè¿›ç¨‹æ›´é‡é‡çº§ï¼Œæ— è®ºæ˜¯åˆå§‹åŒ–ï¼ˆä¾‹å¦‚å¯åŠ¨æˆ–æ¢å¤ä¸ fork å’Œ exec ç›¸æ¯”ï¼‰è¿˜æ˜¯èµ„æºæ¶ˆè€—ã€‚ multiplexes physical resources at the granularity of an entire operating system æ“ä½œç³»ç»Ÿç²’åº¦ä¸Šè¿›è¡Œï¼Œå¤šè·¯å¤ç”¨ç‰©ç†èµ„æºå¬ä¸Šå»æŒºæœ‰æ„æ€ â€œQoS crosstalkâ€ï¼ˆæœåŠ¡è´¨é‡ä¸²æ‰°ï¼‰æ˜¯æŒ‡åœ¨å¤šä»»åŠ¡æˆ–å¤šç”¨æˆ·ç¯å¢ƒä¸­ï¼Œä¸€ä¸ªä»»åŠ¡æˆ–ç”¨æˆ·çš„æ“ä½œå¯¹å…¶ä»–ä»»åŠ¡æˆ–ç”¨æˆ·çš„æ€§èƒ½äº§ç”Ÿä¸å¸Œæœ›çš„ã€éé¢„æœŸçš„å½±å“ã€‚è¿™ç§å½±å“é€šå¸¸æ˜¯ç”±äºèµ„æºå…±äº«å’Œè°ƒåº¦ç­–ç•¥å¯¼è‡´çš„ï¼Œå¯èƒ½ä¼šé™ä½æ•´ä½“ç³»ç»Ÿçš„æœåŠ¡è´¨é‡ï¼ˆQoSï¼‰ã€‚ æ¯”å¦‚ç¼“å­˜æ±¡æŸ“ã€èµ„æºäº‰ç”¨ å¯¹äºæˆ‘ä»¬æœ€å¤š 100 ä¸ªæ‰˜ç®¡æ“ä½œç³»ç»Ÿå®ä¾‹çš„ç›®æ ‡ï¼Œæˆ‘ä»¬è®¤ä¸ºè¿™ä¸ªä»£ä»·æ˜¯å€¼å¾—çš„ï¼›å®ƒå…è®¸ä¸ªäººç”¨æˆ·ä»¥èµ„æºæ§åˆ¶çš„æ–¹å¼è¿è¡Œæœªä¿®æ”¹çš„äºŒè¿›åˆ¶æ–‡ä»¶æˆ–äºŒè¿›åˆ¶æ–‡ä»¶é›†åˆï¼ˆä¾‹å¦‚ï¼Œä¸€ä¸ª Apache æœåŠ¡å™¨å’Œä¸€ä¸ª PostgreSQL åç«¯ï¼‰ã€‚æ­¤å¤–ï¼Œå®ƒæä¾›äº†æé«˜çš„çµæ´»æ€§ï¼Œå› ä¸ºç”¨æˆ·å¯ä»¥åŠ¨æ€åˆ›å»ºå…¶è½¯ä»¶æ‰€éœ€çš„ç²¾ç¡®æ‰§è¡Œç¯å¢ƒã€‚é¿å…äº†å„ç§æœåŠ¡å’Œåº”ç”¨ç¨‹åºä¹‹é—´ä¸å¹¸çš„é…ç½®äº¤äº’ï¼ˆä¾‹å¦‚ï¼Œæ¯ä¸ª Windows å®ä¾‹ç»´æŠ¤è‡ªå·±çš„æ³¨å†Œè¡¨ï¼‰ã€‚ è¿™é‡Œçš„ binary æ˜¯ä»€ä¹ˆï¼Œç¨‹åºè¿›ç¨‹ï¼Ÿ ","date":"2024-10-12","objectID":"/posts/paper-xen-vir/:3:0","tags":["Paper Reading"],"title":"Paper Reading: Xen and the Art of Virtualization","uri":"/posts/paper-xen-vir/"},{"categories":null,"content":"XEN: APPROACH \u0026 OVERVIEW åœ¨ä¼ ç»Ÿçš„è™šæ‹Ÿæœºç›‘è§†å™¨ï¼ˆVMMï¼‰ä¸­ï¼Œæš´éœ²çš„è™šæ‹Ÿç¡¬ä»¶åœ¨åŠŸèƒ½ä¸Šä¸åº•å±‚æœºå™¨ç›¸åŒã€‚è™½ç„¶ full virtualization å…·æœ‰å…è®¸æ‰˜ç®¡æœªä¿®æ”¹æ“ä½œç³»ç»Ÿçš„æ˜æ˜¾ä¼˜åŠ¿ï¼Œä½†å®ƒä¹Ÿæœ‰è®¸å¤šç¼ºç‚¹ã€‚è¿™å¯¹äºæ™®éçš„ IA-32 æˆ– x86 æ¶æ„å°¤ä¸ºæ˜æ˜¾ã€‚ x86 æ¶æ„çš„è®¾è®¡ä»æœªè€ƒè™‘è¿‡å…¨è™šæ‹ŸåŒ–æ”¯æŒã€‚æŸäº›ç‰¹æƒæŒ‡ä»¤å¿…é¡»ç”± VMM å¤„ç†ä»¥å®ç°æ­£ç¡®çš„è™šæ‹ŸåŒ–ï¼Œä½†åœ¨æƒé™ä¸è¶³çš„æƒ…å†µä¸‹æ‰§è¡Œè¿™äº›æŒ‡ä»¤ä¼šé™é»˜å¤±è´¥ï¼Œè€Œä¸æ˜¯å¼•å‘æ–¹ä¾¿çš„ trap [36]ã€‚é«˜æ•ˆåœ°è™šæ‹ŸåŒ– x86 å†…**å­˜ç®¡ç†å•å…ƒï¼ˆMMUï¼‰**ä¹Ÿå¾ˆå›°éš¾ã€‚ VMware çš„ ESX Server[10]åŠ¨æ€é‡å†™æ‰˜ç®¡æœºå™¨ä»£ç çš„éƒ¨åˆ†å†…å®¹ï¼Œä»¥åœ¨å¯èƒ½éœ€è¦ VMM å¹²é¢„çš„ä»»ä½•åœ°æ–¹æ’å…¥é™·é˜±ã€‚è¿™ç§è½¬æ¢åº”ç”¨äºæ•´ä¸ªå®¢æˆ·æ“ä½œç³»ç»Ÿå†…æ ¸ï¼ˆä¼´éšç€ç›¸å…³çš„è½¬æ¢ã€æ‰§è¡Œå’Œç¼“å­˜æˆæœ¬ï¼‰ï¼Œå› ä¸ºæ‰€æœ‰éé™·é˜±çš„ç‰¹æƒæŒ‡ä»¤éƒ½å¿…é¡»è¢«æ•è·å’Œå¤„ç†ã€‚ESX Server å®ç°äº†ç³»ç»Ÿç»“æ„ï¼ˆå¦‚é¡µè¡¨ï¼‰çš„å½±å­ç‰ˆæœ¬ï¼Œå¹¶é€šè¿‡æ•è·æ¯æ¬¡æ›´æ–°å°è¯•æ¥ä¿æŒä¸è™šæ‹Ÿè¡¨çš„ä¸€è‡´æ€§â€”â€”è¿™ç§æ–¹æ³•å¯¹äºæ›´æ–°å¯†é›†å‹æ“ä½œï¼ˆå¦‚åˆ›å»ºæ–°çš„åº”ç”¨ç¨‹åºè¿›ç¨‹ï¼‰å…·æœ‰é«˜æˆæœ¬ã€‚ ESX Server å…¨è™šæ‹ŸåŒ– metal Hypervisor å°½ç®¡ x86 çš„å¤æ‚æ€§ï¼Œå…¨è™šæ‹ŸåŒ–è¿˜æœ‰å…¶ä»–åå¯¹ç†ç”±ã€‚ç‰¹åˆ«æ˜¯åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ‰˜ç®¡æ“ä½œç³»ç»Ÿæ—¢çœ‹åˆ°çœŸå®èµ„æºåˆçœ‹åˆ°è™šæ‹Ÿèµ„æºæ˜¯å¯å–çš„ï¼šæä¾›çœŸå®å’Œè™šæ‹Ÿæ—¶é—´å…è®¸å®¢æˆ·æ“ä½œç³»ç»Ÿæ›´å¥½åœ°æ”¯æŒæ—¶é—´æ•æ„Ÿä»»åŠ¡ï¼Œå¹¶æ­£ç¡®å¤„ç† TCP è¶…æ—¶å’Œ RTT ä¼°è®¡ï¼Œè€Œæš´éœ²çœŸå®æœºå™¨åœ°å€å…è®¸å®¢æˆ·æ“ä½œç³»ç»Ÿé€šè¿‡ä½¿ç”¨ superpages [30]æˆ– page coloring [24]æ¥æé«˜æ€§èƒ½ã€‚ æˆ‘ä»¬é€šè¿‡æä¾›ä¸€ä¸ªä¸åº•å±‚ç¡¬ä»¶ç›¸ä¼¼ä½†ä¸å®Œå…¨ç›¸åŒçš„è™šæ‹ŸæœºæŠ½è±¡æ¥é¿å…å…¨è™šæ‹ŸåŒ–çš„ç¼ºç‚¹â€”â€”è¿™ç§æ–¹æ³•è¢«ç§°ä¸ºåŠè™šæ‹ŸåŒ–[43]ã€‚è¿™æœ‰æœ›æé«˜æ€§èƒ½ï¼Œå°½ç®¡å®ƒç¡®å®éœ€è¦å¯¹å®¢æˆ·æ“ä½œç³»ç»Ÿè¿›è¡Œä¿®æ”¹ã€‚ç„¶è€Œï¼Œé‡è¦çš„æ˜¯è¦æ³¨æ„ï¼Œæˆ‘ä»¬ä¸éœ€è¦æ›´æ”¹åº”ç”¨ç¨‹åºäºŒè¿›åˆ¶æ¥å£ï¼ˆABIï¼‰ï¼Œå› æ­¤ä¸éœ€è¦å¯¹å®¢æˆ·åº”ç”¨ç¨‹åºè¿›è¡Œä¿®æ”¹ã€‚ xen æ˜¯åŠè™šæ‹ŸåŒ–ï¼Œæ”¯æŒ x86 å’Œ ARM ç­‰ç­‰ åº”è¯¥ä¹Ÿæ”¯æŒ HVM å…¨è™šæ‹ŸåŒ– åŠè™šæ‹ŸåŒ–éœ€è¦ç‰¹å®šå†…æ ¸çš„æ“ä½œç³»ç»Ÿï¼Œå¦‚åŸºäº Linux paravirt_ops(Linux å†…æ ¸çš„ä¸€å¥—ç¼–è¯‘é€‰é¡¹)æ¡†æ¶çš„ Linux å†…æ ¸ï¼Œè€Œ Windows æ“ä½œç³»ç»Ÿç”±äºå…¶å°é—­æ€§åˆ™ä¸èƒ½è¢« XEN çš„åŠè™šæ‹ŸåŒ–æ‰€æ”¯æŒï¼Œ ä¸éœ€è¦ä¿®æ”¹å®¢æˆ·åº”ç”¨ç¨‹åºæ˜¯å¾ˆé‡è¦çš„ æˆ‘ä»¬å°†è¿„ä»Šä¸ºæ­¢çš„è®¨è®ºæç‚¼ä¸ºä¸€ç»„è®¾è®¡åŸåˆ™ï¼š æ”¯æŒæœªä¿®æ”¹çš„åº”ç”¨ç¨‹åºäºŒè¿›åˆ¶æ–‡ä»¶æ˜¯è‡³å…³é‡è¦çš„ï¼Œå¦åˆ™ç”¨æˆ·ä¸ä¼šè¿‡æ¸¡åˆ° Xenã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»è™šæ‹ŸåŒ–ç°æœ‰æ ‡å‡† ABI æ‰€éœ€çš„æ‰€æœ‰æ¶æ„ç‰¹æ€§ã€‚ æ”¯æŒå®Œæ•´çš„å¤šåº”ç”¨ç¨‹åºæ“ä½œç³»ç»Ÿå¾ˆé‡è¦ï¼Œå› ä¸ºè¿™å…è®¸åœ¨å•ä¸ªå®¢æˆ·æ“ä½œç³»ç»Ÿå®ä¾‹ä¸­è™šæ‹ŸåŒ–å¤æ‚çš„æœåŠ¡å™¨é…ç½®ã€‚ åŠè™šæ‹ŸåŒ–å¯¹äºåœ¨ä¸åˆä½œçš„æœºå™¨æ¶æ„ï¼ˆå¦‚ x86ï¼‰ä¸Šè·å¾—é«˜æ€§èƒ½å’Œå¼ºèµ„æºéš”ç¦»æ˜¯å¿…è¦çš„ã€‚ å³ä½¿åœ¨åˆä½œçš„æœºå™¨æ¶æ„ä¸Šï¼Œå®Œå…¨éšè—èµ„æºè™šæ‹ŸåŒ–å¯¹å®¢æˆ·æ“ä½œç³»ç»Ÿçš„å½±å“ä¹Ÿä¼šå¸¦æ¥æ­£ç¡®æ€§å’Œæ€§èƒ½çš„é£é™©ã€‚ ABI å®šä¹‰åº”ç”¨ç¨‹åºå¦‚ä½•åœ¨äºŒè¿›åˆ¶çº§åˆ«ä¸ç³»ç»Ÿäº¤äº’ è¯·æ³¨æ„ï¼Œæˆ‘ä»¬åŠè™šæ‹ŸåŒ–çš„ x86 æŠ½è±¡ä¸æœ€è¿‘çš„ Denali é¡¹ç›®[44]æå‡ºçš„æŠ½è±¡æœ‰å¾ˆå¤§ä¸åŒã€‚Denali æ—¨åœ¨æ”¯æŒæ•°åƒä¸ªè¿è¡Œç½‘ç»œæœåŠ¡çš„è™šæ‹Ÿæœºï¼Œå…¶ä¸­ç»å¤§å¤šæ•°æ˜¯å°è§„æ¨¡ä¸”ä¸å—æ¬¢è¿çš„ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒXen æ—¨åœ¨æ‰©å±•åˆ°å¤§çº¦ 100 ä¸ªè¿è¡Œè¡Œä¸šæ ‡å‡†åº”ç”¨ç¨‹åºå’ŒæœåŠ¡çš„è™šæ‹Ÿæœºã€‚é‰´äºè¿™äº›éå¸¸ä¸åŒçš„ç›®æ ‡ï¼Œå°† Denali çš„è®¾è®¡é€‰æ‹©ä¸æˆ‘ä»¬çš„åŸåˆ™è¿›è¡Œå¯¹æ¯”æ˜¯æœ‰ç›Šçš„ã€‚ é¦–å…ˆï¼ŒDenali ä¸é’ˆå¯¹ç°æœ‰çš„ ABIï¼Œå› æ­¤å¯ä»¥ä»å…¶è™šæ‹Ÿæœºæ¥å£ä¸­çœç•¥æŸäº›æ¶æ„ç‰¹æ€§ã€‚ å…¶æ¬¡ï¼ŒDenali å®ç°ä¸è§£å†³åœ¨å•ä¸ªå®¢æˆ·æ“ä½œç³»ç»Ÿå†…æ”¯æŒåº”ç”¨ç¨‹åºå¤šè·¯å¤ç”¨æˆ–å¤šåœ°å€ç©ºé—´çš„é—®é¢˜ã€‚ç±»ä¼¼äº Exokernel ä¸­çš„ libOS çš„æ–¹å¼æ˜¾å¼é“¾æ¥åˆ° Ilwaco å®¢æˆ·æ“ä½œç³»ç»Ÿå®ä¾‹ã€‚ å› æ­¤ï¼Œæ¯ä¸ªè™šæ‹Ÿæœºæœ¬è´¨ä¸Šæ‰˜ç®¡ä¸€ä¸ªå•ç”¨æˆ·å•åº”ç”¨ç¨‹åºçš„æ— ä¿æŠ¤â€œæ“ä½œç³»ç»Ÿâ€ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œåœ¨ Xen ä¸­ï¼Œå•ä¸ªè™šæ‹Ÿæœºæ‰˜ç®¡ä¸€ä¸ªçœŸå®çš„æ“ä½œç³»ç»Ÿï¼Œè¯¥æ“ä½œç³»ç»Ÿæœ¬èº«å¯ä»¥å®‰å…¨åœ°å¤šè·¯å¤ç”¨æ•°åƒä¸ªæœªä¿®æ”¹çš„ç”¨æˆ·çº§è¿›ç¨‹ã€‚å°½ç®¡å·²ç»å¼€å‘äº†ä¸€ä¸ªåŸå‹è™šæ‹Ÿ MMUï¼Œè¿™å¯èƒ½æœ‰åŠ©äº Denali åœ¨è¿™ä¸€é¢†åŸŸ[44]ï¼Œä½†æˆ‘ä»¬ä¸çŸ¥é“ä»»ä½•å·²å‘è¡¨çš„æŠ€æœ¯ç»†èŠ‚æˆ–è¯„ä¼°ã€‚ ç¬¬ä¸‰ï¼Œåœ¨ Denali æ¶æ„ä¸­ï¼ŒVMM performs all paging to and from diskï¼Œè¿™å¯èƒ½ä¸è™šæ‹ŸåŒ–å±‚ç¼ºä¹å†…å­˜ç®¡ç†æ”¯æŒæœ‰å…³ã€‚VMM ä¸­åˆ†é¡µä¸æˆ‘ä»¬æ€§èƒ½éš”ç¦»çš„ç›®æ ‡ç›¸åï¼šæ¶æ„çš„è™šæ‹Ÿæœºå¯ä»¥é¼“åŠ±æŠ–åŠ¨è¡Œä¸ºï¼Œä¸å…¬å¹³åœ°å‰¥å¤ºå…¶ä»–è™šæ‹Ÿæœºçš„ CPU æ—¶é—´å’Œç£ç›˜å¸¦å®½ã€‚åœ¨ Xen ä¸­ï¼Œæˆ‘ä»¬æœŸæœ›æ¯ä¸ªå®¢æˆ·æ“ä½œç³»ç»Ÿä½¿ç”¨å…¶è‡ªå·±çš„ä¿è¯å†…å­˜é¢„ç•™å’Œç£ç›˜åˆ†é…æ¥æ‰§è¡Œè‡ªå·±çš„åˆ†é¡µï¼ˆè¿™ä¸€æƒ³æ³•ä¹‹å‰å·²è¢« self-paging [20]åˆ©ç”¨ï¼‰ æœ€åï¼ŒDenali è™šæ‹ŸåŒ–äº†æ‰€æœ‰æœºå™¨èµ„æºçš„â€œå‘½åç©ºé—´â€ï¼Œè®¤ä¸ºå¦‚æœè™šæ‹Ÿæœºæ— æ³•å‘½åèµ„æºï¼Œå°±æ— æ³•è®¿é—®å…¶ä»–è™šæ‹Ÿæœºçš„èµ„æºåˆ†é…ï¼ˆä¾‹å¦‚ï¼Œè™šæ‹Ÿæœºå¯¹ç¡¬ä»¶åœ°å€ä¸€æ— æ‰€çŸ¥ï¼ŒåªçŸ¥é“ Denali ä¸ºå…¶åˆ›å»ºçš„è™šæ‹Ÿåœ°å€ï¼‰ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œæˆ‘ä»¬è®¤ä¸ºåœ¨è™šæ‹Ÿæœºç›‘è§†å™¨å†…çš„å®‰å…¨è®¿é—®æ§åˆ¶è¶³ä»¥ç¡®ä¿ä¿æŠ¤ï¼›æ­¤å¤–ï¼Œå¦‚å‰æ‰€è¿°ï¼Œæœ‰å¼ºæœ‰åŠ›çš„æ­£ç¡®æ€§å’Œæ€§èƒ½è®ºæ®æ”¯æŒä½¿ç‰©ç†èµ„æºç›´æ¥å¯¹å®¢æˆ·æ“ä½œç³»ç»Ÿå¯è§ã€‚ åœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†æè¿° Xen å¯¼å‡ºçš„è™šæ‹ŸæœºæŠ½è±¡ï¼Œå¹¶è®¨è®ºå®¢æˆ·æ“ä½œç³»ç»Ÿå¿…é¡»å¦‚ä½•ä¿®æ”¹ä»¥ç¬¦åˆè¿™ä¸€æŠ½è±¡ã€‚è¯·æ³¨æ„ï¼Œåœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†æœ¯è¯­â€œå®¢æˆ·æ“ä½œç³»ç»Ÿ guest operating systemâ€ ä¿ç•™ç»™ Xen å¯ä»¥æ‰˜ç®¡çš„æ“ä½œç³»ç»Ÿä¹‹ä¸€ï¼Œå¹¶ä½¿ç”¨æœ¯è¯­â€œåŸŸ domainâ€æ¥æŒ‡ä»£åœ¨å…¶ä¸­æ‰§è¡Œå®¢æˆ·æ“ä½œç³»ç»Ÿçš„è¿è¡Œè™šæ‹Ÿæœºï¼› We call Xen itself the hypervisor since it operates at a higher privilege level than the supervisor code of the guest operating systems that it hosts ","date":"2024-10-12","objectID":"/posts/paper-xen-vir/:4:0","tags":["Paper Reading"],"title":"Paper Reading: Xen and the Art of Virtualization","uri":"/posts/paper-xen-vir/"},{"categories":null,"content":"The Virtual Machine Interface è¡¨ 1 æ¦‚è¿°äº†åŠè™šæ‹ŸåŒ– x86 æ¥å£ï¼Œåˆ†ä¸ºç³»ç»Ÿä¸‰å¤§æ–¹é¢ï¼šå†…å­˜ç®¡ç†ã€CPU å’Œè®¾å¤‡ I/Oã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ä¾æ¬¡è®¨è®ºæ¯ä¸ªæœºå™¨å­ç³»ç»Ÿï¼Œå¹¶è®¨è®ºå®ƒä»¬åœ¨æˆ‘ä»¬åŠè™šæ‹ŸåŒ–æ¶æ„ä¸­çš„å‘ˆç°æ–¹å¼ã€‚è¯·æ³¨æ„ï¼Œå°½ç®¡æˆ‘ä»¬çš„å®ç°ä¸­æŸäº›éƒ¨åˆ†ï¼ˆå¦‚å†…å­˜ç®¡ç†ï¼‰æ˜¯ç‰¹å®šäº x86 çš„ï¼Œä½†è®¸å¤šæ–¹é¢ï¼ˆå¦‚æˆ‘ä»¬çš„è™šæ‹Ÿ CPU å’Œ I/O è®¾å¤‡ï¼‰å¯ä»¥è½»æ¾åº”ç”¨äºå…¶ä»–æœºå™¨æ¶æ„ã€‚æ­¤å¤–ï¼Œx86 åœ¨æŸäº›æ–¹é¢ä¸å…¶ä»– RISC é£æ ¼å¤„ç†å™¨å­˜åœ¨æ˜¾è‘—å·®å¼‚ï¼Œä¾‹å¦‚ï¼Œé«˜æ•ˆè™šæ‹ŸåŒ–ç¡¬ä»¶é¡µè¡¨æ¯”è™šæ‹ŸåŒ–è½¯ä»¶ç®¡ç†çš„ TLB æ›´ä¸ºå›°éš¾ã€‚ Memory management Virtualizing memory æ— ç–‘æ˜¯åŠè™šæ‹ŸåŒ–æ¶æ„ä¸­æœ€å›°éš¾çš„éƒ¨åˆ†ï¼Œæ— è®ºæ˜¯ä»è™šæ‹Ÿæœºç›‘è§†å™¨æ‰€éœ€çš„æœºåˆ¶è¿˜æ˜¯ä»ç§»æ¤æ¯ä¸ªå®¢æˆ·æ“ä½œç³»ç»Ÿæ‰€éœ€çš„ä¿®æ”¹æ¥çœ‹ã€‚å¦‚æœæ¶æ„æä¾›è½¯ä»¶ç®¡ç†çš„ TLBï¼Œè¿™é¡¹ä»»åŠ¡ä¼šæ›´å®¹æ˜“ï¼Œå› ä¸ºè¿™äº› TLB å¯ä»¥ä»¥ç®€å•çš„æ–¹å¼é«˜æ•ˆè™šæ‹ŸåŒ–[13]ã€‚å¸¦æ ‡ç­¾çš„ TLB æ˜¯å¤§å¤šæ•°æœåŠ¡å™¨çº§ RISC æ¶æ„ï¼ˆåŒ…æ‹¬ Alphaã€MIPS å’Œ SPARCï¼‰æ”¯æŒçš„å¦ä¸€ä¸ªæœ‰ç”¨åŠŸèƒ½ã€‚å°†åœ°å€ç©ºé—´æ ‡è¯†ç¬¦æ ‡ç­¾ä¸æ¯ä¸ª TLB æ¡ç›®ç›¸å…³è”ï¼Œå…è®¸è™šæ‹Ÿæœºç›‘è§†å™¨å’Œæ¯ä¸ªå®¢æˆ·æ“ä½œç³»ç»Ÿåœ¨å•ç‹¬çš„åœ°å€ç©ºé—´ä¸­é«˜æ•ˆå…±å­˜ï¼Œå› ä¸ºä¸éœ€è¦åœ¨è½¬ç§»æ‰§è¡Œæ—¶åˆ·æ–°æ•´ä¸ª TLBã€‚ ä¸å¹¸çš„æ˜¯ï¼Œx86 æ²¡æœ‰è½¯ä»¶ç®¡ç†çš„ TLBï¼›ç›¸åï¼ŒTLB æœªå‘½ä¸­ç”±å¤„ç†å™¨é€šè¿‡ç¡¬ä»¶éå†é¡µè¡¨ç»“æ„è‡ªåŠ¨å¤„ç†ã€‚å› æ­¤ï¼Œä¸ºäº†å®ç°æœ€ä½³æ€§èƒ½ï¼Œå½“å‰åœ°å€ç©ºé—´çš„æ‰€æœ‰æœ‰æ•ˆé¡µç¿»è¯‘åº”å­˜åœ¨äºç¡¬ä»¶å¯è®¿é—®çš„é¡µè¡¨ä¸­ã€‚æ­¤å¤–ï¼Œç”±äº TLB æœªå¸¦æ ‡ç­¾ï¼Œåœ°å€ç©ºé—´åˆ‡æ¢é€šå¸¸éœ€è¦å®Œå…¨åˆ·æ–° TLBã€‚é‰´äºè¿™äº›é™åˆ¶ï¼Œæˆ‘ä»¬åšå‡ºäº†ä¸¤ä¸ªå†³å®šï¼š(i) å®¢æˆ·æ“ä½œç³»ç»Ÿè´Ÿè´£åˆ†é…å’Œç®¡ç†ç¡¬ä»¶é¡µè¡¨ï¼ŒXen ä»…åœ¨ç¡®ä¿å®‰å…¨å’Œéš”ç¦»çš„æƒ…å†µä¸‹è¿›è¡Œæœ€å°ç¨‹åº¦çš„å‚ä¸ï¼›(ii) Xen å­˜åœ¨äºæ¯ä¸ªåœ°å€ç©ºé—´çš„é¡¶éƒ¨ 64MB åŒºåŸŸï¼Œä»è€Œåœ¨è¿›å…¥å’Œç¦»å¼€è™šæ‹Ÿæœºç›‘è§†å™¨æ—¶é¿å… TLB åˆ·æ–°ã€‚ æ¯å½“å®¢æˆ·æ“ä½œç³»ç»Ÿéœ€è¦ä¸€ä¸ªæ–°çš„é¡µè¡¨æ—¶ï¼ˆä¾‹å¦‚ï¼Œå› ä¸ºæ­£åœ¨åˆ›å»ºä¸€ä¸ªæ–°è¿›ç¨‹ï¼‰ï¼Œå®ƒä¼šä»è‡ªå·±çš„å†…å­˜é¢„ç•™ä¸­åˆ†é…å¹¶åˆå§‹åŒ–ä¸€ä¸ªé¡µé¢ï¼Œå¹¶å°†å…¶æ³¨å†Œåˆ° Xenã€‚æ­¤æ—¶ï¼Œæ“ä½œç³»ç»Ÿå¿…é¡»æ”¾å¼ƒå¯¹é¡µè¡¨å†…å­˜çš„ç›´æ¥å†™æƒé™ï¼šæ‰€æœ‰åç»­æ›´æ–°å¿…é¡»ç”± Xen éªŒè¯ã€‚è¿™é™åˆ¶äº†æ›´æ–°çš„æ–¹å¼ï¼ŒåŒ…æ‹¬åªå…è®¸æ“ä½œç³»ç»Ÿæ˜ å°„å…¶æ‹¥æœ‰çš„é¡µé¢ï¼Œå¹¶ç¦æ­¢å¯¹é¡µè¡¨çš„å¯å†™æ˜ å°„ã€‚å®¢æˆ·æ“ä½œç³»ç»Ÿå¯ä»¥æ‰¹é‡æ›´æ–°è¯·æ±‚ï¼Œä»¥åˆ†æ‘Šè¿›å…¥è™šæ‹Ÿæœºç›‘è§†å™¨çš„å¼€é”€ã€‚æ¯ä¸ªåœ°å€ç©ºé—´çš„é¡¶éƒ¨ 64MB åŒºåŸŸï¼Œä¿ç•™ç»™ Xenï¼Œä¸å¯ç”±å®¢æˆ·æ“ä½œç³»ç»Ÿè®¿é—®æˆ–é‡æ–°æ˜ å°„ã€‚ç„¶è€Œï¼Œè¿™ä¸ªåœ°å€åŒºåŸŸä¸è¢«ä»»ä½•å¸¸è§çš„ x86 ABI ä½¿ç”¨ï¼Œå› æ­¤è¿™ä¸ªé™åˆ¶ä¸ä¼šç ´ååº”ç”¨ç¨‹åºå…¼å®¹æ€§ã€‚ åˆ†æ®µä»¥ç±»ä¼¼çš„æ–¹å¼è™šæ‹ŸåŒ–ï¼Œé€šè¿‡éªŒè¯å¯¹ç¡¬ä»¶æ®µæè¿°ç¬¦è¡¨çš„æ›´æ–°ã€‚x86 æ®µæè¿°ç¬¦çš„å”¯ä¸€é™åˆ¶æ˜¯ï¼š(i) å®ƒä»¬å¿…é¡»æ¯” Xen å…·æœ‰æ›´ä½çš„ç‰¹æƒï¼Œ(ii) å®ƒä»¬ä¸å¾—å…è®¸è®¿é—® Xen ä¿ç•™çš„åœ°å€ç©ºé—´éƒ¨åˆ†ã€‚ CPU è™šæ‹ŸåŒ– CPU å¯¹å®¢æˆ·æ“ä½œç³»ç»Ÿæœ‰å‡ ä¸ªå½±å“ã€‚ä¸»è¦çš„æ˜¯ï¼Œåœ¨æ“ä½œç³»ç»Ÿä¹‹ä¸‹æ’å…¥ä¸€ä¸ªè™šæ‹Ÿæœºç›‘è§†å™¨è¿åäº†æ“ä½œç³»ç»Ÿæ˜¯ç³»ç»Ÿä¸­æœ€ç‰¹æƒå®ä½“çš„é€šå¸¸å‡è®¾ã€‚ä¸ºäº†ä¿æŠ¤è™šæ‹Ÿæœºç›‘è§†å™¨å…å—æ“ä½œç³»ç»Ÿé”™è¯¯è¡Œä¸ºçš„å½±å“ï¼ˆä»¥åŠåŸŸä¹‹é—´çš„ç›¸äº’ä¿æŠ¤ï¼‰ï¼Œå®¢æˆ·æ“ä½œç³»ç»Ÿå¿…é¡»ä¿®æ”¹ä¸ºåœ¨è¾ƒä½çš„ç‰¹æƒçº§åˆ«ä¸Šè¿è¡Œã€‚ è®¸å¤šå¤„ç†å™¨æ¶æ„åªæä¾›ä¸¤ä¸ªç‰¹æƒçº§åˆ«ã€‚ å†…æ ¸æ¨¡å¼ï¼Œç”¨æˆ·æ¨¡å¼ å’Œ x86 é‡Œçš„ ring0-3 æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ åœ¨ x86 ä¸Šå¯ä»¥é«˜æ•ˆåœ°è™šæ‹ŸåŒ–ç‰¹æƒçº§åˆ«ï¼Œå› ä¸ºå®ƒåœ¨ç¡¬ä»¶ä¸Šæ”¯æŒå››ä¸ªä¸åŒçš„ç‰¹æƒçº§åˆ«ã€‚x86 ç‰¹æƒçº§åˆ«é€šå¸¸è¢«ç§°ä¸ºç¯ï¼Œç¼–å·ä»é›¶ï¼ˆæœ€é«˜ç‰¹æƒï¼‰åˆ°ä¸‰ï¼ˆæœ€ä½ç‰¹æƒï¼‰ã€‚ æ“ä½œç³»ç»Ÿä»£ç é€šå¸¸åœ¨ç¯ 0 ä¸­æ‰§è¡Œï¼Œå› ä¸ºæ²¡æœ‰å…¶ä»–ç¯å¯ä»¥æ‰§è¡Œç‰¹æƒæŒ‡ä»¤ï¼Œè€Œç¯ 3 é€šå¸¸ç”¨äºåº”ç”¨ç¨‹åºä»£ç ã€‚æ®æˆ‘ä»¬æ‰€çŸ¥ï¼Œè‡ª OS/2 ä»¥æ¥ï¼Œç¯ 1 å’Œç¯ 2 æ²¡æœ‰è¢«ä»»ä½•çŸ¥åçš„ x86 æ“ä½œç³»ç»Ÿä½¿ç”¨è¿‡ã€‚ä»»ä½•éµå¾ªè¿™ç§å¸¸è§å®‰æ’çš„æ“ä½œç³»ç»Ÿéƒ½å¯ä»¥é€šè¿‡ä¿®æ”¹å…¶åœ¨ç¯ 1 ä¸­æ‰§è¡Œæ¥ç§»æ¤åˆ° Xenã€‚è¿™å¯ä»¥é˜²æ­¢å®¢æˆ·æ“ä½œç³»ç»Ÿç›´æ¥æ‰§è¡Œç‰¹æƒæŒ‡ä»¤ï¼ŒåŒæ—¶å®ƒä»ç„¶å®‰å…¨åœ°ä¸åœ¨ç¯ 3 ä¸­è¿è¡Œçš„åº”ç”¨ç¨‹åºéš”ç¦»ã€‚ x86 å¯ä»¥è¿™ä¹ˆå¹²ï¼Œé‚£å…¶ä»–æ¶æ„å‘¢ï¼ŒARM ä¹Ÿæœ‰ Exception Level 0-3 é€šå¸¸åªæœ‰ä¸¤ç§ç±»å‹çš„å¼‚å¸¸é¢‘ç¹å‘ç”Ÿï¼Œè¶³ä»¥å½±å“ç³»ç»Ÿæ€§èƒ½ï¼šç³»ç»Ÿè°ƒç”¨ï¼ˆé€šå¸¸é€šè¿‡è½¯ä»¶å¼‚å¸¸å®ç°ï¼‰å’Œé¡µé¢é”™è¯¯ã€‚æˆ‘ä»¬é€šè¿‡å…è®¸æ¯ä¸ªå®¢æˆ·æ“ä½œç³»ç»Ÿæ³¨å†Œä¸€ä¸ªâ€œå¿«é€Ÿâ€å¼‚å¸¸å¤„ç†ç¨‹åºæ¥æé«˜ç³»ç»Ÿè°ƒç”¨çš„æ€§èƒ½ï¼Œè¯¥å¤„ç†ç¨‹åºç”±å¤„ç†å™¨ç›´æ¥è®¿é—®ï¼Œæ— éœ€é€šè¿‡ç¯ 0 é—´æ¥è®¿é—®ï¼›åœ¨å°†æ­¤å¤„ç†ç¨‹åºå®‰è£…åˆ°ç¡¬ä»¶å¼‚å¸¸è¡¨ä¹‹å‰è¿›è¡ŒéªŒè¯ã€‚ä¸å¹¸çš„æ˜¯ï¼Œæ— æ³•å°†ç›¸åŒçš„æŠ€æœ¯åº”ç”¨äºé¡µé¢é”™è¯¯å¤„ç†ç¨‹åºï¼Œå› ä¸ºåªæœ‰ç¯ 0 ä¸­çš„ä»£ç å¯ä»¥ä»å¯„å­˜å™¨ CR2 è¯»å–æ•…éšœåœ°å€ï¼›å› æ­¤ï¼Œé¡µé¢é”™è¯¯å¿…é¡»å§‹ç»ˆé€šè¿‡ Xen ä¼ é€’ï¼Œä»¥ä¾¿å¯ä»¥ä¿å­˜æ­¤å¯„å­˜å™¨å€¼ä»¥åœ¨ç¯ 1 ä¸­è®¿é—®ã€‚ page fault ç¡®å®æ˜¯ä¸ªé—®é¢˜ é€šè¿‡åœ¨å‘ Xen å‘ˆç°å¼‚å¸¸å¤„ç†ç¨‹åºæ—¶éªŒè¯å®ƒä»¬æ¥ç¡®ä¿å®‰å…¨æ€§ã€‚å”¯ä¸€éœ€è¦çš„æ£€æŸ¥æ˜¯å¤„ç†ç¨‹åºçš„ä»£ç æ®µä¸æŒ‡å®šåœ¨ç¯ 0 ä¸­æ‰§è¡Œã€‚ç”±äºæ²¡æœ‰å®¢æˆ·æ“ä½œç³»ç»Ÿå¯ä»¥åˆ›å»ºè¿™æ ·çš„æ®µï¼Œå› æ­¤å°†æŒ‡å®šçš„æ®µé€‰æ‹©å™¨ä¸ Xen ä¿ç•™çš„ä¸€å°éƒ¨åˆ†é™æ€å€¼è¿›è¡Œæ¯”è¾ƒå°±è¶³å¤Ÿäº†ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä»»ä½•å…¶ä»–å¤„ç†ç¨‹åºé—®é¢˜éƒ½åœ¨å¼‚å¸¸ä¼ æ’­æœŸé—´ä¿®å¤â€”â€”ä¾‹å¦‚ï¼Œå¦‚æœå¤„ç†ç¨‹åºçš„ä»£ç æ®µä¸å­˜åœ¨æˆ–å¤„ç†ç¨‹åºæœªåˆ†é¡µåˆ°å†…å­˜ä¸­ï¼Œåˆ™åœ¨ Xen æ‰§è¡Œè¿”å›å¤„ç†ç¨‹åºçš„ iret æŒ‡ä»¤æ—¶å°†å‘ç”Ÿé€‚å½“çš„æ•…éšœã€‚Xen é€šè¿‡æ£€æŸ¥æ•…éšœç¨‹åºè®¡æ•°å™¨å€¼æ¥æ£€æµ‹è¿™äº›â€œåŒé‡æ•…éšœâ€ï¼šå¦‚æœåœ°å€ä½äºå¼‚å¸¸è™šæ‹ŸåŒ–ä»£ç ä¸­ï¼Œåˆ™ç»ˆæ­¢æœ‰é—®é¢˜çš„å®¢æˆ·æ“ä½œç³»ç»Ÿã€‚ ç”± Xen æ¥éªŒè¯ï¼Œæ¯”å¦‚æ£€æŸ¥ä»£ç æ®µï¼Œæ£€æŸ¥ç‰¹æƒçº§åˆ«ã€é™æ€å€¼ å¼‚å¸¸ä¼ æ’­ä¿®å¤ï¼Œæ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ è¯·æ³¨æ„ï¼Œå³ä½¿å¯¹äºç›´æ¥ç³»ç»Ÿè°ƒç”¨å¤„ç†ç¨‹åºï¼Œè¿™ç§â€œæ‡’æƒ°â€æ£€æŸ¥ä¹Ÿæ˜¯å®‰å…¨çš„ï¼šå½“ CPU å°è¯•ç›´æ¥è·³è½¬åˆ°å®¢æˆ·æ“ä½œç³»ç»Ÿå¤„ç†ç¨‹åºæ—¶ï¼Œå°†å‘ç”Ÿè®¿é—®æ•…éšœã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ•…éšœåœ°å€å°†åœ¨ Xen ä¹‹å¤–ï¼ˆå› ä¸º Xen æ°¸è¿œä¸ä¼šæ‰§è¡Œå®¢æˆ·æ“ä½œç³»ç»Ÿçš„ç³»ç»Ÿè°ƒç”¨ï¼‰ï¼Œå› æ­¤æ•…éšœä»¥æ­£å¸¸æ–¹å¼è™šæ‹ŸåŒ–ã€‚å¦‚æœæ•…éšœçš„ä¼ æ’­å¯¼è‡´è¿›ä¸€æ­¥çš„ â€œdouble faultâ€ï¼Œåˆ™å¦‚ä¸Šæ‰€è¿°ç»ˆæ­¢å®¢æˆ·æ“ä½œç³»ç»Ÿã€‚ Device I/OS ä¸é€šå¸¸åœ¨å®Œå…¨è™šæ‹ŸåŒ–ç¯å¢ƒä¸­æ¨¡æ‹Ÿç°æœ‰ç¡¬ä»¶è®¾å¤‡ä¸åŒï¼ŒXen æš´éœ²äº†ä¸€ç»„å¹²å‡€ä¸”ç®€å•çš„è®¾å¤‡æŠ½è±¡ã€‚è¿™ä½¿æˆ‘ä»¬èƒ½å¤Ÿè®¾è®¡ä¸€ä¸ªæ—¢é«˜æ•ˆåˆæ»¡è¶³æˆ‘ä»¬å¯¹ä¿æŠ¤å’Œéš”ç¦»è¦æ±‚çš„æ¥å£ã€‚ä¸ºæ­¤ï¼ŒI/O æ•°æ®é€šè¿‡ Xen åœ¨æ¯ä¸ªåŸŸä¹‹é—´ä¼ è¾“ï¼Œä½¿ç”¨å…±äº«å†…å­˜ã€å¼‚æ­¥ç¼“å†²åŒºæè¿°ç¬¦ç¯ã€‚è¿™äº›ç¯æä¾›äº†ä¸€ç§é«˜æ€§èƒ½çš„é€šä¿¡æœºåˆ¶ï¼Œç”¨äºåœ¨ç³»ç»Ÿä¸­å‚ç›´ä¼ é€’ç¼“å†²åŒºä¿¡æ¯ï¼ŒåŒæ—¶å…è®¸ Xen é«˜æ•ˆåœ°æ‰§è¡ŒéªŒè¯æ£€æŸ¥ï¼ˆä¾‹å¦‚ï¼Œæ£€æŸ¥ç¼“å†²åŒºæ˜¯å¦åŒ…å«åœ¨åŸŸçš„å†…å­˜é¢„ç•™ä¸­ï¼‰ã€‚ ç±»ä¼¼äºç¡¬ä»¶ä¸­æ–­ï¼ŒXen æ”¯æŒä¸€ç§è½»é‡çº§çš„äº‹ä»¶ä¼ é€’æœºåˆ¶ï¼Œç”¨äºå‘åŸŸå‘é€å¼‚æ­¥é€šçŸ¥ã€‚è¿™äº›é€šçŸ¥é€šè¿‡æ›´æ–°å¾…å¤„ç†äº‹ä»¶ç±»å‹çš„ä½å›¾æ¥å®ç°ï¼Œå¹¶ä¸”å¯ä»¥é€‰æ‹©æ€§åœ°è°ƒç”¨ç”±å®¢æˆ·æ“ä½œç³»ç»ŸæŒ‡å®šçš„äº‹ä»¶å¤„ç†ç¨‹åºã€‚è¿™äº›å›è°ƒå¯ä»¥æ ¹æ®å®¢æˆ·æ“ä½œç³»ç»Ÿçš„åˆ¤æ–­â€œæš‚åœâ€â€”â€”ä¾‹å¦‚ï¼Œä¸ºäº†é¿å…é¢‘ç¹å”¤é†’é€šçŸ¥å¸¦æ¥çš„é¢å¤–å¼€é”€ã€‚ domain åˆ°åº•æ˜¯ä¸€ä¸ªè™šæ‹Ÿæœºå®ä¾‹è¿˜æ˜¯ä»€ä¹ˆ ","date":"2024-10-12","objectID":"/posts/paper-xen-vir/:4:1","tags":["Paper Reading"],"title":"Paper Reading: Xen and the Art of Virtualization","uri":"/posts/paper-xen-vir/"},{"categories":null,"content":"The Cost of Porting an OS to Xen XP ä¸å¥½ç§»æ¤ è¿™æ ·çš„ç§»æ¤æ„Ÿè§‰å¾ˆè´¹åŠ›ï¼Œé™¤éæ˜¯å¼€æºçš„ OSï¼Œé—­æºçš„æ„Ÿè§‰éš¾ä»¥æ“ä½œ ","date":"2024-10-12","objectID":"/posts/paper-xen-vir/:4:2","tags":["Paper Reading"],"title":"Paper Reading: Xen and the Art of Virtualization","uri":"/posts/paper-xen-vir/"},{"categories":null,"content":"Control and Management Domain 0 è·‘äº†ä¸€ä¸ª guestOS è´Ÿè´£ control software ï¼ŒXenoLinux åº”è¯¥ä¹Ÿæ˜¯ Xen çš„ å…¶ä»– guestOs å¯ä»¥æ˜¯ xenoLinux ä¹Ÿå¯ä»¥æ˜¯ xenoBSD ç­‰ç­‰ separate policy from mechanism wherever possible å°½ç®¡è™šæ‹Ÿæœºç›‘è§†å™¨å¿…é¡»åœ¨æ•°æ®è·¯å¾„æ–¹é¢ï¼ˆä¾‹å¦‚ï¼Œåœ¨åŸŸä¹‹é—´è°ƒåº¦ CPUï¼Œåœ¨ä¼ è¾“ä¹‹å‰è¿‡æ»¤ç½‘ç»œåŒ…ï¼Œæˆ–åœ¨è¯»å–æ•°æ®å—æ—¶æ‰§è¡Œè®¿é—®æ§åˆ¶ï¼‰è¿›è¡Œå‚ä¸ï¼Œä½†æ²¡æœ‰å¿…è¦è®©å®ƒå‚ä¸æˆ–ç”šè‡³äº†è§£æ›´é«˜å±‚æ¬¡çš„é—®é¢˜ï¼Œä¾‹å¦‚å¦‚ä½•å…±äº« CPUï¼Œæˆ–æ¯ä¸ªåŸŸå¯ä»¥ä¼ è¾“å“ªç§ç±»å‹çš„åŒ…ã€‚ ç”±æ­¤äº§ç”Ÿçš„æ¶æ„æ˜¯ï¼Œè™šæ‹Ÿæœºç›‘è§†å™¨æœ¬èº«åªæä¾›åŸºæœ¬çš„æ§åˆ¶æ“ä½œã€‚è¿™äº›æ“ä½œé€šè¿‡ä¸€ä¸ªå¯ä»¥ä»æˆæƒåŸŸè®¿é—®çš„æ¥å£å¯¼å‡ºï¼›æ½œåœ¨å¤æ‚çš„ç­–ç•¥å†³ç­–ï¼Œå¦‚å‡†å…¥æ§åˆ¶ï¼Œæœ€å¥½ç”±åœ¨ running over a guest OS ä¸Šè¿è¡Œçš„ç®¡ç†è½¯ä»¶æ‰§è¡Œï¼Œè€Œä¸æ˜¯åœ¨ç‰¹æƒè™šæ‹Ÿæœºç›‘è§†å™¨ä»£ç ä¸­æ‰§è¡Œã€‚ è¿™ä¸ªæ€è·¯æ„Ÿè§‰å’Œ kvm / hyper-v å®Œå…¨è™šæ‹ŸåŒ–åŒºåˆ«çš„è¿˜æ˜¯å¾ˆå¤§çš„ ","date":"2024-10-12","objectID":"/posts/paper-xen-vir/:4:3","tags":["Paper Reading"],"title":"Paper Reading: Xen and the Art of Virtualization","uri":"/posts/paper-xen-vir/"},{"categories":null,"content":"DETAILED DESIGN ","date":"2024-10-12","objectID":"/posts/paper-xen-vir/:5:0","tags":["Paper Reading"],"title":"Paper Reading: Xen and the Art of Virtualization","uri":"/posts/paper-xen-vir/"},{"categories":null,"content":"Control Transfer: Hypercalls and Events Xen ä¸ä¸Šå±‚åŸŸä¹‹é—´çš„æ§åˆ¶äº¤äº’å­˜åœ¨ä¸¤ç§æœºåˆ¶ï¼šåŸŸå¯ä»¥ä½¿ç”¨ Hypercalls å‘ Xen è¿›è¡ŒåŒæ­¥è°ƒç”¨ï¼Œè€Œ Xen ä½¿ç”¨å¼‚æ­¥äº‹ä»¶æœºåˆ¶å‘åŸŸä¼ é€’é€šçŸ¥ã€‚ hypercall æ¥å£å…è®¸åŸŸæ‰§è¡Œ synchronous software trap è¿›å…¥è™šæ‹Ÿæœºç›‘è§†å™¨ä»¥æ‰§è¡Œç‰¹æƒæ“ä½œï¼Œç±»ä¼¼äºä¼ ç»Ÿæ“ä½œç³»ç»Ÿä¸­ä½¿ç”¨ç³»ç»Ÿè°ƒç”¨çš„æ–¹å¼ã€‚è¶…è°ƒç”¨çš„ä¸€ä¸ªç¤ºä¾‹ç”¨é€”æ˜¯è¯·æ±‚ä¸€ç»„é¡µè¡¨æ›´æ–°ï¼Œå…¶ä¸­ Xen éªŒè¯å¹¶åº”ç”¨æ›´æ–°åˆ—è¡¨ï¼Œå¹¶åœ¨å®Œæˆåå°†æ§åˆ¶æƒè¿”å›ç»™è°ƒç”¨åŸŸã€‚ Xen ä¸åŸŸä¹‹é—´çš„é€šä¿¡é€šè¿‡å¼‚æ­¥äº‹ä»¶æœºåˆ¶æä¾›ï¼Œè¯¥æœºåˆ¶å–ä»£äº†è®¾å¤‡ä¸­æ–­çš„å¸¸è§„ä¼ é€’æœºåˆ¶ï¼Œå¹¶å…è®¸å¯¹é‡è¦äº‹ä»¶ï¼ˆå¦‚åŸŸç»ˆæ­¢è¯·æ±‚ï¼‰è¿›è¡Œè½»é‡çº§é€šçŸ¥ã€‚ç±»ä¼¼äºä¼ ç»Ÿçš„ Unix ä¿¡å·ï¼Œåªæœ‰å°‘æ•°äº‹ä»¶ï¼Œæ¯ä¸ªäº‹ä»¶ç”¨äºæ ‡è®°ç‰¹å®šç±»å‹çš„å‘ç”Ÿã€‚ä¾‹å¦‚ï¼Œäº‹ä»¶ç”¨äºæŒ‡ç¤ºå·²é€šè¿‡ç½‘ç»œæ¥æ”¶åˆ°æ–°æ•°æ®ï¼Œæˆ–è™šæ‹Ÿç£ç›˜è¯·æ±‚å·²å®Œæˆã€‚ å¾…å¤„ç†äº‹ä»¶ Pending events å­˜å‚¨åœ¨æ¯ä¸ªåŸŸçš„ä½æ©ç ä¸­ï¼ŒXen åœ¨è°ƒç”¨ç”±å®¢æˆ·æ“ä½œç³»ç»ŸæŒ‡å®šçš„äº‹ä»¶å›è°ƒå¤„ç†ç¨‹åºä¹‹å‰æ›´æ–°è¯¥ä½æ©ç ã€‚å›è°ƒå¤„ç†ç¨‹åºè´Ÿè´£é‡ç½®å¾…å¤„ç†äº‹ä»¶é›†ï¼Œå¹¶ä»¥é€‚å½“çš„æ–¹å¼å“åº”é€šçŸ¥ã€‚åŸŸå¯ä»¥é€šè¿‡è®¾ç½® Xen å¯è¯»çš„è½¯ä»¶æ ‡å¿—æ˜¾å¼æ¨è¿Ÿäº‹ä»¶å¤„ç†ï¼šè¿™ç±»ä¼¼äºåœ¨çœŸå®å¤„ç†å™¨ä¸Šç¦ç”¨ä¸­æ–­ã€‚ ","date":"2024-10-12","objectID":"/posts/paper-xen-vir/:5:1","tags":["Paper Reading"],"title":"Paper Reading: Xen and the Art of Virtualization","uri":"/posts/paper-xen-vir/"},{"categories":null,"content":"Data Transfer: I/O Rings The presence of a hypervisor means there is an additional protection domain between guest OSes and I/O devices, so it is crucial that a data transfer mechanism be provided that allows data to move vertically through the system with as little overhead as possible resource management event notification ä¸ºäº†èµ„æºè´£ä»»ï¼Œæˆ‘ä»¬è¯•å›¾åœ¨ä»è®¾å¤‡æ¥æ”¶åˆ°ä¸­æ–­æ—¶æœ€å°åŒ–å°†æ•°æ®å¤šè·¯åˆ†è§£åˆ°ç‰¹å®šåŸŸæ‰€éœ€çš„å·¥ä½œâ€”â€”ç®¡ç†ç¼“å†²åŒºçš„å¼€é”€ç¨åè¿›è¡Œï¼Œè®¡ç®—å¯èƒ½å½’å› äºé€‚å½“çš„åŸŸã€‚ ç±»ä¼¼åœ°ï¼Œå°½å¯èƒ½ç”±ç›¸å…³åŸŸæä¾›ç”¨äºè®¾å¤‡ I/O çš„å†…å­˜ï¼Œä»¥é˜²æ­¢å…±äº«ç¼“å†²æ± ä¸­å›ºæœ‰çš„ä¸²æ‰°ï¼›åœ¨æ•°æ®ä¼ è¾“æœŸé—´ï¼Œé€šè¿‡åœ¨ Xen ä¸­å›ºå®šåº•å±‚é¡µå¸§æ¥ä¿æŠ¤ I/O ç¼“å†²åŒºã€‚ å›¾ 2 å±•ç¤ºäº†æˆ‘ä»¬ I/O æè¿°ç¬¦ç¯çš„ç»“æ„ã€‚ç¯æ˜¯ç”±åŸŸåˆ†é…çš„æè¿°ç¬¦çš„å¾ªç¯é˜Ÿåˆ—ï¼Œä½†å¯ä»¥ä» Xen å†…éƒ¨è®¿é—®ã€‚æè¿°ç¬¦ä¸ç›´æ¥åŒ…å« I/O æ•°æ®ï¼›ç›¸åï¼ŒI/O æ•°æ®ç¼“å†²åŒºç”±å®¢æˆ·æ“ä½œç³»ç»Ÿå¸¦å¤–åˆ†é…ï¼Œå¹¶é€šè¿‡ I/O æè¿°ç¬¦é—´æ¥å¼•ç”¨ã€‚å¯¹æ¯ä¸ªç¯çš„è®¿é—®åŸºäºä¸¤å¯¹ç”Ÿäº§è€…-æ¶ˆè´¹è€…æŒ‡é’ˆï¼šåŸŸåœ¨ç¯ä¸Šæ”¾ç½®è¯·æ±‚ï¼Œæ¨è¿›è¯·æ±‚ç”Ÿäº§è€…æŒ‡é’ˆï¼ŒXen ç§»é™¤è¿™äº›è¯·æ±‚è¿›è¡Œå¤„ç†ï¼Œæ¨è¿›ç›¸å…³çš„è¯·æ±‚æ¶ˆè´¹è€…æŒ‡é’ˆã€‚å“åº”ä»¥ç±»ä¼¼çš„æ–¹å¼æ”¾å›ç¯ä¸­ï¼Œåªæ˜¯ Xen ä½œä¸ºç”Ÿäº§è€…ï¼Œå®¢æˆ·æ“ä½œç³»ç»Ÿä½œä¸ºæ¶ˆè´¹è€…ã€‚æ²¡æœ‰è¦æ±‚æŒ‰é¡ºåºå¤„ç†è¯·æ±‚ï¼šå®¢æˆ·æ“ä½œç³»ç»Ÿä¸ºæ¯ä¸ªè¯·æ±‚å…³è”ä¸€ä¸ªå”¯ä¸€æ ‡è¯†ç¬¦ï¼Œè¯¥æ ‡è¯†ç¬¦åœ¨ç›¸å…³å“åº”ä¸­é‡ç°ã€‚è¿™å…è®¸ Xen ç”±äºè°ƒåº¦æˆ–ä¼˜å…ˆçº§è€ƒè™‘è€Œæ˜ç¡®åœ°é‡æ–°æ’åº I/O æ“ä½œã€‚ è¿™é‡Œçš„ IO ring å’Œ NIC çš„æ˜¯ä¸æ˜¯å¾ˆç±»ä¼¼ è¿™ç§ç»“æ„è¶³å¤Ÿé€šç”¨ï¼Œå¯ä»¥æ”¯æŒå¤šç§ä¸åŒçš„è®¾å¤‡èŒƒå¼ã€‚ä¾‹å¦‚ï¼Œä¸€ç»„â€œè¯·æ±‚â€å¯ä»¥ä¸ºç½‘ç»œæ•°æ®åŒ…æ¥æ”¶æä¾›ç¼“å†²åŒºï¼›éšåçš„â€œå“åº”â€ç„¶åé€šçŸ¥è¿™äº›ç¼“å†²åŒºä¸­æ•°æ®åŒ…çš„åˆ°è¾¾ã€‚åœ¨å¤„ç†ç£ç›˜è¯·æ±‚æ—¶ï¼Œé‡æ–°æ’åºæ˜¯æœ‰ç”¨çš„ï¼Œå› ä¸ºå®ƒå…è®¸åœ¨ Xen ä¸­è°ƒåº¦å®ƒä»¬ä»¥æé«˜æ•ˆç‡ï¼Œå¹¶ä¸”ä½¿ç”¨å¸¦å¤–ç¼“å†²åŒºçš„æè¿°ç¬¦ä½¿å¾—å®ç°é›¶æ‹·è´ä¼ è¾“å˜å¾—å®¹æ˜“ã€‚ Xen å®ç°äº†é›¶æ‹·è´å— https://wiki.xenproject.org/wiki/Xen_4.3_Block_Protocol_Scalability blkback/blkfront æˆ‘ä»¬å°†è¯·æ±‚æˆ–å“åº”çš„ç”Ÿäº§ä¸å¦ä¸€æ–¹çš„é€šçŸ¥è§£è€¦ï¼šåœ¨è¯·æ±‚çš„æƒ…å†µä¸‹ï¼ŒåŸŸå¯ä»¥åœ¨è°ƒç”¨è¶…è°ƒç”¨ä»¥æé†’ Xen ä¹‹å‰å°†å¤šä¸ªæ¡ç›®æ’é˜Ÿï¼›åœ¨å“åº”çš„æƒ…å†µä¸‹ï¼ŒåŸŸå¯ä»¥é€šè¿‡æŒ‡å®šå“åº”é˜ˆå€¼æ•°é‡æ¥æ¨è¿Ÿé€šçŸ¥äº‹ä»¶çš„ä¼ é€’ã€‚è¿™å…è®¸æ¯ä¸ªåŸŸæ ¹æ®å»¶è¿Ÿå’Œååé‡è¦æ±‚è¿›è¡Œæƒè¡¡ï¼Œç±»ä¼¼äº ArseNIC åƒå…†ä»¥å¤ªç½‘æ¥å£ä¸­çš„æµé‡æ„ŸçŸ¥ä¸­æ–­è°ƒåº¦ ","date":"2024-10-12","objectID":"/posts/paper-xen-vir/:5:2","tags":["Paper Reading"],"title":"Paper Reading: Xen and the Art of Virtualization","uri":"/posts/paper-xen-vir/"},{"categories":null,"content":"Subsystem Virtualization CPU scheduling Xen ç›®å‰æ ¹æ® Borrowed Virtual Timeï¼ˆBVTï¼‰è°ƒåº¦ç®—æ³•[11]è°ƒåº¦åŸŸï¼Œå› ä¸ºå®ƒæ—¢èŠ‚çœå·¥ä½œé‡ï¼Œåˆæœ‰ä¸€ä¸ªç‰¹æ®Šçš„æœºåˆ¶ç”¨äºä½å»¶è¿Ÿå”¤é†’ï¼ˆæˆ–è°ƒåº¦ï¼‰åŸŸï¼Œå½“å®ƒæ¥æ”¶åˆ°äº‹ä»¶æ—¶ã€‚å¿«é€Ÿè°ƒåº¦å¯¹äºæœ€å°åŒ–è™šæ‹ŸåŒ–å¯¹è®¾è®¡ä¸ºåŠæ—¶è¿è¡Œçš„æ“ä½œç³»ç»Ÿå­ç³»ç»Ÿçš„å½±å“å°¤ä¸ºé‡è¦ï¼›ä¾‹å¦‚ï¼ŒTCP ä¾èµ–äºåŠæ—¶äº¤ä»˜ç¡®è®¤ä»¥æ­£ç¡®ä¼°è®¡ç½‘ç»œå¾€è¿”æ—¶é—´ã€‚BVT é€šè¿‡ä½¿ç”¨è™šæ‹Ÿæ—¶é—´æ‰­æ›²æœºåˆ¶æä¾›ä½å»¶è¿Ÿè°ƒåº¦ï¼Œè¯¥æœºåˆ¶æš‚æ—¶è¿åâ€œç†æƒ³â€çš„å…¬å¹³å…±äº«ï¼Œä»¥æ”¯æŒæœ€è¿‘å”¤é†’çš„åŸŸã€‚ç„¶è€Œï¼Œå…¶ä»–è°ƒåº¦ç®—æ³•å¯ä»¥ç®€å•åœ°åœ¨æˆ‘ä»¬é€šç”¨çš„è°ƒåº¦å™¨æŠ½è±¡ä¸Šå®ç°ã€‚æ¯ä¸ªåŸŸçš„è°ƒåº¦å‚æ•°å¯ä»¥é€šè¿‡åœ¨ Domain0 ä¸­è¿è¡Œçš„ç®¡ç†è½¯ä»¶è¿›è¡Œè°ƒæ•´ã€‚ Time and timers Xen ä¸ºå®¢æˆ·æ“ä½œç³»ç»Ÿæä¾›äº†çœŸå®æ—¶é—´ã€è™šæ‹Ÿæ—¶é—´å’ŒæŒ‚é’Ÿæ—¶é—´çš„æ¦‚å¿µã€‚ é…åˆ BVT ç®—æ³•ï¼Ÿ Virtual address translation Xen è¯•å›¾ä»¥å°½å¯èƒ½å°çš„å¼€é”€è™šæ‹ŸåŒ–å†…å­˜è®¿é—®ã€‚ ç”±äº x86 æ¶æ„ä½¿ç”¨ç¡¬ä»¶é¡µè¡¨ï¼Œè¿™ä¸€ç›®æ ‡å˜å¾—æ›´åŠ å›°éš¾ã€‚VMware çš„æ–¹æ³•æ˜¯ä¸ºæ¯ä¸ªå®¢æˆ·æ“ä½œç³»ç»Ÿæä¾›ä¸€ä¸ªè™šæ‹Ÿé¡µè¡¨ï¼Œè¯¥é¡µè¡¨å¯¹å†…å­˜ç®¡ç†å•å…ƒï¼ˆMMUï¼‰ä¸å¯è§ ç„¶åï¼Œè™šæ‹Ÿæœºç›‘è§†å™¨è´Ÿè´£æ•è·å¯¹è™šæ‹Ÿé¡µè¡¨çš„è®¿é—®ï¼ŒéªŒè¯æ›´æ–°ï¼Œå¹¶å°†æ›´æ”¹åœ¨è™šæ‹Ÿé¡µè¡¨å’Œ MMU å¯è§çš„â€œå½±å­â€é¡µè¡¨ä¹‹é—´æ¥å›ä¼ æ’­ã€‚è¿™å¤§å¤§å¢åŠ äº†æŸäº›å®¢æˆ·æ“ä½œç³»ç»Ÿæ“ä½œçš„æˆæœ¬ï¼Œä¾‹å¦‚åˆ›å»ºæ–°çš„è™šæ‹Ÿåœ°å€ç©ºé—´ï¼Œå¹¶éœ€è¦æ˜¾å¼ä¼ æ’­ç¡¬ä»¶æ›´æ–°åˆ°â€œè®¿é—®â€å’Œâ€œè„â€ä½ å°½ç®¡å®Œå…¨è™šæ‹ŸåŒ–è¿«ä½¿ä½¿ç”¨å½±å­é¡µè¡¨ï¼Œä»¥æä¾›è¿ç»­ç‰©ç†å†…å­˜çš„å‡è±¡ï¼Œä½† Xen å¹¶ä¸å—æ­¤é™åˆ¶ã€‚äº‹å®ä¸Šï¼ŒXen åªéœ€è¦åœ¨é¡µè¡¨æ›´æ–°æ—¶ä»‹å…¥ï¼Œä»¥é˜²æ­¢å®¢æˆ·æ“ä½œç³»ç»Ÿè¿›è¡Œä¸å¯æ¥å—çš„æ›´æ”¹ã€‚å› æ­¤ï¼Œæˆ‘ä»¬é¿å…äº†ä¸ä½¿ç”¨å½±å­é¡µè¡¨ç›¸å…³çš„å¼€é”€å’Œé¢å¤–å¤æ‚æ€§â€”â€”Xen çš„æ–¹æ³•æ˜¯ç›´æ¥å‘ MMU æ³¨å†Œå®¢æˆ·æ“ä½œç³»ç»Ÿé¡µè¡¨ï¼Œå¹¶é™åˆ¶å®¢æˆ·æ“ä½œç³»ç»Ÿå¯¹é¡µè¡¨çš„åªè¯»è®¿é—®ã€‚é¡µè¡¨æ›´æ–°é€šè¿‡è¶…è°ƒç”¨ä¼ é€’ç»™ Xenï¼›ä¸ºäº†ç¡®ä¿å®‰å…¨ï¼Œè¯·æ±‚åœ¨åº”ç”¨ä¹‹å‰è¿›è¡ŒéªŒè¯ã€‚ Hyper-V åº”è¯¥éƒ½æ˜¯ç”¨çš„ shadow page table æˆ–è€…èƒ½ç®¡ç† TLB KVM åº”è¯¥ç”¨äº†ç¡¬ä»¶ EPTï¼Œè¿™ä¸ªä¹‹å‰è§è¿‡ Xen é€šè¿‡åŠè™šæ‹ŸåŒ–æŠ€æœ¯è¿›è¡Œè™šæ‹Ÿå†…å­˜è½¬æ¢ï¼Œè¦æ±‚å®¢æˆ·æ“ä½œç³»ç»Ÿè¿›è¡Œä¿®æ”¹ä»¥é€‚åº”è™šæ‹ŸåŒ–ç¯å¢ƒã€‚ä»¥ä¸‹æ˜¯ Xen è¿›è¡Œè™šæ‹Ÿå†…å­˜è½¬æ¢çš„ä¸»è¦æ­¥éª¤å’Œæœºåˆ¶ï¼š é¡µè¡¨æ³¨å†Œï¼šXen ç›´æ¥å‘å†…å­˜ç®¡ç†å•å…ƒï¼ˆMMUï¼‰æ³¨å†Œå®¢æˆ·æ“ä½œç³»ç»Ÿçš„é¡µè¡¨ï¼Œå¹¶é™åˆ¶å®¢æˆ·æ“ä½œç³»ç»Ÿå¯¹é¡µè¡¨çš„åªè¯»è®¿é—®ã€‚ é¡µè¡¨æ›´æ–°ï¼šé¡µè¡¨æ›´æ–°é€šè¿‡è¶…è°ƒç”¨ä¼ é€’ç»™ Xenï¼Œå¹¶åœ¨åº”ç”¨ä¹‹å‰è¿›è¡ŒéªŒè¯ã€‚ ç±»å‹ç³»ç»Ÿï¼šXen ä¸ºæ¯ä¸ªæœºå™¨é¡µå¸§å…³è”ä¸€ä¸ªç±»å‹å’Œå¼•ç”¨è®¡æ•°ã€‚ç±»å‹åŒ…æ‹¬é¡µç›®å½•ï¼ˆPDï¼‰ã€é¡µè¡¨ï¼ˆPTï¼‰ã€æœ¬åœ°æè¿°ç¬¦è¡¨ï¼ˆLDTï¼‰ã€å…¨å±€æè¿°ç¬¦è¡¨ï¼ˆGDTï¼‰æˆ–å¯å†™ï¼ˆRWï¼‰ã€‚ å¼•ç”¨è®¡æ•°ï¼šåªæœ‰åœ¨å¼•ç”¨è®¡æ•°ä¸ºé›¶æ—¶ï¼Œå¸§æ‰èƒ½å®‰å…¨åœ°é‡æ–°åˆ†é…ä»»åŠ¡ã€‚è¿™ç¡®ä¿äº†å†…å­˜ç®¡ç†çš„å®‰å…¨æ€§å’Œéš”ç¦»æ€§ã€‚ éªŒè¯æœºåˆ¶ï¼šå®¢æˆ·æ“ä½œç³»ç»ŸæŒ‡ç¤ºä½•æ—¶ä¸ºé¡µè¡¨ä½¿ç”¨åˆ†é…å¸§ï¼ŒXen å¯¹å¸§ä¸­çš„æ¯ä¸ªæ¡ç›®è¿›è¡Œä¸€æ¬¡æ€§éªŒè¯ã€‚éªŒè¯é€šè¿‡åï¼Œå¸§çš„ç±»å‹å›ºå®šä¸º PD æˆ– PTï¼Œç›´åˆ°å®¢æˆ·æ“ä½œç³»ç»Ÿå‘å‡ºå–æ¶ˆå›ºå®šè¯·æ±‚ã€‚ å›ºå®šæœºåˆ¶ï¼šå›ºå®šæœºåˆ¶åœ¨æ›´æ”¹é¡µè¡¨åŸºæŒ‡é’ˆæ—¶ç‰¹åˆ«æœ‰ç”¨ï¼Œå› ä¸ºå®ƒæ¶ˆé™¤äº†åœ¨æ¯ä¸ªä¸Šä¸‹æ–‡åˆ‡æ¢æ—¶éªŒè¯æ–°é¡µè¡¨çš„éœ€è¦ã€‚ æ‰¹é‡æ›´æ–°ï¼šä¸ºäº†æœ€å°åŒ–æ‰€éœ€çš„è¶…è°ƒç”¨æ•°é‡ï¼Œå®¢æˆ·æ“ä½œç³»ç»Ÿå¯ä»¥åœ¨åº”ç”¨æ•´ä¸ªæ‰¹æ¬¡ä¹‹å‰æœ¬åœ°æ’é˜Ÿæ›´æ–°ï¼Œå¹¶é€šè¿‡å•ä¸ªè¶…è°ƒç”¨åº”ç”¨ã€‚è¿™åœ¨åˆ›å»ºæ–°åœ°å€ç©ºé—´æ—¶ç‰¹åˆ«æœ‰ç›Šã€‚ æ›´æ–°æäº¤ï¼šæ›´æ–°å¿…é¡»åœ¨ TLB åˆ·æ–°ä¹‹å‰æäº¤ï¼Œä»¥ä¿è¯æ­£ç¡®æ€§ã€‚å®¢æˆ·æ“ä½œç³»ç»Ÿé€šå¸¸åœ¨é¦–æ¬¡ä½¿ç”¨æ–°æ˜ å°„ä¹‹å‰æ‰§è¡Œ TLB åˆ·æ–°ï¼Œç¡®ä¿ä»»ä½•ç¼“å­˜çš„ç¿»è¯‘æ— æ•ˆã€‚ æ•…éšœå¤„ç†ï¼šå¦‚æœå®¢æˆ·æ“ä½œç³»ç»Ÿåœ¨ç¡®å®š TLB ä¸­ä¸å­˜åœ¨é™ˆæ—§æ¡ç›®æ—¶çœç•¥åˆ·æ–°ï¼Œé¦–æ¬¡å°è¯•ä½¿ç”¨æ–°æ˜ å°„å¯èƒ½ä¼šå¯¼è‡´é¡µé¢ä¸å­˜åœ¨æ•…éšœã€‚å®¢æˆ·æ“ä½œç³»ç»Ÿæ•…éšœå¤„ç†ç¨‹åºå¿…é¡»æ£€æŸ¥æ˜¯å¦æœ‰æœªå®Œæˆçš„æ›´æ–°ã€‚ é‡è¯•æœºåˆ¶ï¼šå¦‚æœæ‰¾åˆ°æœªå®Œæˆçš„æ›´æ–°ï¼Œåˆ™åˆ·æ–°å®ƒä»¬å¹¶é‡è¯•æ•…éšœæŒ‡ä»¤ï¼Œç¡®ä¿å†…å­˜æ˜ å°„çš„æ­£ç¡®æ€§ã€‚ Physical memory æ¯ä¸ªåŸŸçš„åˆå§‹å†…å­˜åˆ†é…æˆ–é¢„ç•™æ˜¯åœ¨å…¶åˆ›å»ºæ—¶æŒ‡å®šçš„ï¼Œå› æ­¤ï¼Œå†…å­˜åœ¨åŸŸä¹‹é—´é™æ€åˆ†åŒºï¼Œæä¾›å¼ºéš”ç¦»ã€‚è¿˜å¯ä»¥æŒ‡å®šæœ€å¤§å…è®¸é¢„ç•™ï¼šå¦‚æœåŸŸå†…çš„å†…å­˜å‹åŠ›å¢åŠ ï¼Œå®ƒå¯èƒ½ä¼šå°è¯•ä» Xen ä¸­è·å–é¢å¤–çš„å†…å­˜é¡µï¼Œç›´åˆ°æ­¤é¢„ç•™é™åˆ¶ã€‚ç›¸åï¼Œå¦‚æœåŸŸå¸Œæœ›èŠ‚çœèµ„æºï¼Œå¯èƒ½ä¸ºäº†é¿å…äº§ç”Ÿä¸å¿…è¦çš„æˆæœ¬ï¼Œå®ƒå¯ä»¥é€šè¿‡å°†å†…å­˜é¡µé‡Šæ”¾å› Xen æ¥å‡å°‘å…¶å†…å­˜é¢„ç•™ã€‚ XenoLinux implements a balloon driver, é€šè¿‡åœ¨ Xen å’Œ XenoLinux çš„é¡µé¢åˆ†é…å™¨ä¹‹é—´æ¥å›ä¼ é€’å†…å­˜é¡µæ¥è°ƒæ•´åŸŸçš„å†…å­˜ä½¿ç”¨ã€‚å°½ç®¡æˆ‘ä»¬å¯ä»¥ç›´æ¥ä¿®æ”¹ Linux çš„å†…å­˜ç®¡ç†ä¾‹ç¨‹ï¼Œä½†æ°”çƒé©±åŠ¨ç¨‹åºé€šè¿‡ä½¿ç”¨ç°æœ‰çš„æ“ä½œç³»ç»ŸåŠŸèƒ½è¿›è¡Œè°ƒæ•´ï¼Œä»è€Œç®€åŒ–äº† Linux ç§»æ¤å·¥ä½œã€‚ç„¶è€Œï¼ŒåŠè™šæ‹ŸåŒ–å¯ä»¥ç”¨æ¥æ‰©å±•æ°”çƒé©±åŠ¨ç¨‹åºçš„åŠŸèƒ½ï¼›ä¾‹å¦‚ï¼Œå®¢æˆ·æ“ä½œç³»ç»Ÿä¸­çš„å†…å­˜ä¸è¶³å¤„ç†æœºåˆ¶å¯ä»¥ä¿®æ”¹ä¸ºé€šè¿‡ä» Xen è¯·æ±‚æ›´å¤šå†…å­˜æ¥è‡ªåŠ¨ç¼“è§£å†…å­˜å‹åŠ›ã€‚ å¤§å¤šæ•°æ“ä½œç³»ç»Ÿå‡è®¾å†…å­˜æœ€å¤šç”±å‡ ä¸ªå¤§çš„è¿ç»­åŒºåŸŸç»„æˆã€‚å› ä¸º Xen ä¸ä¿è¯åˆ†é…è¿ç»­çš„å†…å­˜åŒºåŸŸï¼Œå®¢æˆ·æ“ä½œç³»ç»Ÿé€šå¸¸ä¼šä¸ºè‡ªå·±åˆ›é€ è¿ç»­ç‰©ç†å†…å­˜çš„å‡è±¡ï¼Œ Xen ä¸ä¿è¯åˆ†é…è¿ç»­çš„å†…å­˜åŒºåŸŸ Network Domain0 è´Ÿè´£æ’å…¥å’Œåˆ é™¤è§„åˆ™ã€‚ ä¸ºäº†å‘é€æ•°æ®åŒ…ï¼Œå®¢æˆ·æ“ä½œç³»ç»Ÿåªéœ€å°†ç¼“å†²åŒºæè¿°ç¬¦æ’é˜Ÿåˆ°å‘é€ç¯ä¸Šã€‚Xen å¤åˆ¶æè¿°ç¬¦ï¼Œå¹¶ç¡®ä¿å®‰å…¨ï¼Œç„¶åå¤åˆ¶æ•°æ®åŒ…å¤´å¹¶æ‰§è¡Œä»»ä½•åŒ¹é…çš„è¿‡æ»¤è§„åˆ™ã€‚æ•°æ®åŒ…è´Ÿè½½ä¸ä¼šè¢«å¤åˆ¶ï¼Œå› ä¸ºæˆ‘ä»¬ä½¿ç”¨ scatter-gather DMAï¼›ä½†æ˜¯è¯·æ³¨æ„ï¼Œç›¸å…³çš„é¡µå¸§å¿…é¡»å›ºå®šï¼Œç›´åˆ°ä¼ è¾“å®Œæˆã€‚ä¸ºäº†ç¡®ä¿å…¬å¹³æ€§ï¼ŒXen å®ç°äº†ä¸€ä¸ªç®€å•çš„è½®è¯¢æ•°æ®åŒ…è°ƒåº¦å™¨ã€‚ fairness -\u003e round-robin æœ‰æ²¡æœ‰æ€§èƒ½æ›´å¥½çš„ Disk åªæœ‰ Domain0 å¯ä»¥ç›´æ¥æ— é™åˆ¶åœ°è®¿é—®ç‰©ç†ç£ç›˜ï¼ˆIDE å’Œ SCSIï¼‰ã€‚æ‰€æœ‰å…¶ä»–åŸŸé€šè¿‡è™šæ‹Ÿå—è®¾å¤‡ï¼ˆVBDï¼‰çš„æŠ½è±¡æ¥è®¿é—®æŒä¹…å­˜å‚¨ï¼Œè¿™äº›è™šæ‹Ÿå—è®¾å¤‡ç”±åœ¨ Domain0 å†…è¿è¡Œçš„ç®¡ç†è½¯ä»¶åˆ›å»ºå’Œé…ç½®ã€‚å…è®¸ Domain0 ç®¡ç† VBD ä½¿å¾— Xen çš„æœºåˆ¶éå¸¸ç®€å•ï¼Œé¿å…äº†æ›´å¤æ‚çš„è§£å†³æ–¹æ¡ˆï¼Œä¾‹å¦‚ Exokernel ä½¿ç”¨çš„ UDFs [23]ã€‚ ä¸€ä¸ª VBD åŒ…å«ä¸€ä¸ªèŒƒå›´åˆ—è¡¨ï¼Œä»¥åŠç›¸å…³çš„æ‰€æœ‰æƒå’Œè®¿é—®æ§åˆ¶ä¿¡æ¯ï¼Œå¹¶é€šè¿‡ I/O ç¯æœºåˆ¶è¿›è¡Œè®¿é—®ã€‚ ExoKernel æ”¯æŒ UDFï¼Ÿæ˜¯æ€ä¹ˆåšåˆ°çš„ï¼Œç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰è®¿é—® IO å— VBD æ˜¯è™šæ‹Ÿå—è®¾å¤‡ virtual block devices VBD æ˜¯ä¸€ç§æŠ½è±¡å±‚ï¼Œç”¨äºå°†ç‰©ç†ç£ç›˜èµ„æºè™šæ‹ŸåŒ–ä¸ºå¤šä¸ªè™šæ‹Ÿç£ç›˜è®¾å¤‡ï¼Œä¾›ä¸åŒçš„è™šæ‹Ÿæœºï¼ˆåŸŸï¼‰ä½¿ç”¨ã€‚ Xen ä»¥ç®€å•çš„è½®è¯¢æ–¹å¼å¤„ç†æ¥è‡ªç«äº‰åŸŸçš„æ‰¹é‡è¯·æ±‚ï¼›è¿™äº›è¯·æ±‚éšåè¢«ä¼ é€’ç»™ evator scheduler è°ƒåº¦ç¨‹åºï¼Œç„¶åå†åˆ°è¾¾ç£ç›˜ç¡¬ä»¶ã€‚åŸŸå¯ä»¥æ˜¾å¼ä¼ é€’é‡æ–° reorder barriers, ä»¥é˜²æ­¢åœ¨éœ€è¦ç»´æŠ¤æ›´é«˜çº§åˆ«è¯­ä¹‰æ—¶è¿›è¡Œé‡æ–°æ’åºï¼ˆä¾‹å¦‚ï¼Œåœ¨ä½¿ç”¨é¢„å†™æ—¥å¿—æ—¶ï¼‰ã€‚ä½çº§è°ƒåº¦ä¸ºæˆ‘ä»¬æä¾›äº†è‰¯å¥½çš„ååé‡ï¼Œè€Œè¯·æ±‚çš„æ‰¹å¤„ç†æä¾›äº†ç›¸å½“å…¬å¹³çš„è®¿é—®ã€‚æœªæ¥çš„å·¥ä½œå°†ç ”ç©¶æä¾›æ›´å¯é¢„æµ‹çš„éš”ç¦»å’Œå·®å¼‚åŒ–æœåŠ¡ï¼Œå¯èƒ½ä½¿ç”¨ç°æœ‰çš„æŠ€æœ¯å’Œè°ƒåº¦ç¨‹åº ç£ç›˜è°ƒåº¦åº”è¯¥ä¹Ÿæ˜¯ä¸ªæœ‰æ„æ€çš„æ–¹å‘ ","date":"2024-10-12","objectID":"/posts/paper-xen-vir/:5:3","tags":["Paper Reading"],"title":"Paper Reading: Xen and the Art of Virtualization","uri":"/posts/paper-xen-vir/"},{"categories":null,"content":"Building a New Domain ä¸ºæ–°åŸŸæ„å»ºåˆå§‹å®¢æˆ·æ“ä½œç³»ç»Ÿç»“æ„çš„ä»»åŠ¡ä¸»è¦å§”æ‰˜ç»™ Domain0ï¼ŒDomain0 ä½¿ç”¨å…¶ç‰¹æƒæ§åˆ¶æ¥å£ï¼ˆç¬¬ 2.3 èŠ‚ï¼‰è®¿é—®æ–°åŸŸçš„å†…å­˜å¹¶é€šçŸ¥ Xen åˆå§‹å¯„å­˜å™¨çŠ¶æ€ã€‚ ","date":"2024-10-12","objectID":"/posts/paper-xen-vir/:5:4","tags":["Paper Reading"],"title":"Paper Reading: Xen and the Art of Virtualization","uri":"/posts/paper-xen-vir/"},{"categories":null,"content":"Evaluation æ€§èƒ½è¯„ä¼°åº”è¯¥æ˜¯ Xen çš„é‡å¤´æˆ æˆ‘ä»¬é¦–å…ˆå°† Xen ä¸å¤šç§æ›¿ä»£è™šæ‹ŸåŒ–æŠ€æœ¯è¿›è¡ŒåŸºå‡†æµ‹è¯•ï¼Œç„¶åæ¯”è¾ƒåœ¨å•ä¸ªåŸç”Ÿæ“ä½œç³»ç»Ÿä¸ŠåŒæ—¶æ‰§è¡Œå¤šä¸ªåº”ç”¨ç¨‹åºçš„æ€»ç³»ç»Ÿååé‡ä¸åœ¨æ¯ä¸ªè™šæ‹Ÿæœºä¸­è¿è¡Œæ¯ä¸ªåº”ç”¨ç¨‹åºçš„æ€»ç³»ç»Ÿååé‡ã€‚ è¯„ä¼°äº† Xen åœ¨å®¢æˆ·æ“ä½œç³»ç»Ÿä¹‹é—´æä¾›çš„æ€§èƒ½éš”ç¦» XenoLinux ç§»æ¤ï¼ˆåŸºäº Linux 2.4.21ï¼‰ï¼Œå› ä¸ºè¿™æ˜¯æˆ‘ä»¬æœ€æˆç†Ÿçš„å®¢æˆ·æ“ä½œç³»ç»Ÿã€‚æˆ‘ä»¬é¢„è®¡ Windows XP å’Œ NetBSD ç§»æ¤çš„ç›¸å¯¹å¼€é”€ä¼šç›¸ä¼¼ï¼Œä½†å°šæœªè¿›è¡Œå…¨é¢è¯„ä¼°ã€‚ æœºå™¨ä¸­çš„ Xeon å¤„ç†å™¨æ”¯æŒ SMTï¼ˆâ€œè¶…çº¿ç¨‹â€ï¼‰ï¼Œä½†ç”±äºå½“å‰å†…æ ¸éƒ½æ²¡æœ‰ SMT æ„ŸçŸ¥çš„è°ƒåº¦ç¨‹åºï¼Œå› æ­¤ç¦ç”¨äº†æ­¤åŠŸèƒ½ã€‚æˆ‘ä»¬ç¡®ä¿æ‰€æœ‰å®¢æˆ·æ“ä½œç³»ç»ŸåŠå…¶è™šæ‹Ÿæœºç®¡ç†ç¨‹åºå¯ç”¨çš„æ€»å†…å­˜é‡ç­‰äºåŸç”Ÿ Linux å¯ç”¨çš„æ€»å†…å­˜é‡ã€‚ ","date":"2024-10-12","objectID":"/posts/paper-xen-vir/:6:0","tags":["Paper Reading"],"title":"Paper Reading: Xen and the Art of Virtualization","uri":"/posts/paper-xen-vir/"},{"categories":null,"content":"Relative Performance ä¸‹ä¸€ç»„æ¡å½¢å›¾æ˜¾ç¤ºäº†åœ¨æœ¬åœ° ext3 æ–‡ä»¶ç³»ç»Ÿä¸Šä½¿ç”¨ gcc 2.96 æ„å»º Linux 2.4.21 å†…æ ¸é»˜è®¤é…ç½®æ‰€èŠ±è´¹çš„æ€»æ—¶é—´ã€‚åŸç”Ÿ Linux èŠ±è´¹äº†å¤§çº¦ 7%çš„ CPU æ—¶é—´åœ¨æ“ä½œç³»ç»Ÿä¸­ï¼Œä¸»è¦æ‰§è¡Œæ–‡ä»¶ I/Oã€è°ƒåº¦å’Œå†…å­˜ç®¡ç†ã€‚åœ¨è™šæ‹Ÿæœºç®¡ç†ç¨‹åºçš„æƒ…å†µä¸‹ï¼Œè¿™ç§â€œç³»ç»Ÿæ—¶é—´â€åœ¨ä¸åŒç¨‹åº¦ä¸Šè¢«æ‰©å±•ï¼šXen ä»…å¢åŠ äº† 3%çš„å¼€é”€ï¼Œè€Œå…¶ä»–è™šæ‹Ÿæœºç®¡ç†ç¨‹åºåˆ™ç»å†äº†æ›´æ˜¾è‘—çš„å‡é€Ÿã€‚ æˆ‘ä»¬ä½¿ç”¨ PostgreSQL 7.1.3 æ•°æ®åº“è¿›è¡Œäº†ä¸¤ä¸ªå®éªŒï¼Œé€šè¿‡é»˜è®¤é…ç½®çš„ Open Source Database Benchmark å¥—ä»¶ï¼ˆOSDBï¼‰è¿›è¡Œæµ‹è¯•ã€‚æˆ‘ å¯¹æ¯”äº†å¾ˆå¤š benchmark é€‰äº†å‡ ä¸ªæœ‰æ„æ€çš„ï¼Œå®é™…ä¸Šæ¶‰åŠåˆ° DB æ“ä½œæˆ–è€…ç£ç›˜æ“ä½œï¼Œæ€§èƒ½ä¼šæœ‰ä¸€äº›ä¸‹é™ ä½†å…¶ä»–æƒ…å†µæ€§èƒ½å‡ ä¹æ˜¯åŸç”Ÿä¸€è‡´çš„ æ€§èƒ½è¿™ä¹ˆå¥½çš„åŸå› æ˜¯ä»€ä¹ˆï¼ŒxenoLinux å’Œ åŠè™šæ‹ŸåŒ–å—ï¼Œè¿˜æ˜¯ IO ringã€è¿˜æ˜¯å†…å­˜ç®¡ç† è°ƒåº¦ç®—æ³•æ„Ÿè§‰éƒ½æ˜¯ä¸ºäº†å…¬å¹³ï¼Œä½†ä¸ºä»€ä¹ˆä¼šè¿™ä¹ˆå¥½ å¥‡æ€ªçš„æ˜¯æ¨ªåæ ‡æ˜¯ Relative Score ","date":"2024-10-12","objectID":"/posts/paper-xen-vir/:6:1","tags":["Paper Reading"],"title":"Paper Reading: Xen and the Art of Virtualization","uri":"/posts/paper-xen-vir/"},{"categories":null,"content":"Operating System Benchmarks ä¸ºäº†æ›´ç²¾ç¡®åœ°æµ‹é‡ Xen å’Œå…¶ä»–è™šæ‹Ÿæœºç®¡ç†ç¨‹åºï¼ˆVMMï¼‰ä¸­çš„å¼€é”€åŒºåŸŸï¼Œæˆ‘ä»¬è¿›è¡Œäº†è®¸å¤šé’ˆå¯¹ç‰¹å®šå­ç³»ç»Ÿçš„å°å‹å®éªŒ åœ¨è¿›ç¨‹å¾®åŸºå‡†æµ‹è¯•ï¼ˆè¡¨ 3ï¼‰ä¸­ï¼ŒXen çš„ forkã€exec å’Œ sh æ€§èƒ½æ¯”åŸç”Ÿ Linux æ…¢ã€‚è¿™æ˜¯é¢„æœŸçš„ï¼Œå› ä¸ºè¿™äº›æ“ä½œéœ€è¦å¤§é‡çš„é¡µè¡¨æ›´æ–°ï¼Œè¿™äº›æ›´æ–°å¿…é¡»å…¨éƒ¨ç”± Xen éªŒè¯ã€‚ç„¶è€Œï¼ŒåŠè™šæ‹ŸåŒ–æ–¹æ³•å…è®¸ XenoLinux æ‰¹é‡æ›´æ–°è¯·æ±‚ã€‚åˆ›å»ºæ–°çš„é¡µè¡¨æ˜¯ä¸€ä¸ªç†æƒ³çš„æƒ…å†µï¼šå› ä¸ºæ²¡æœ‰ç†ç”±æ›´æ—©åœ°æäº¤å¾…å¤„ç†çš„æ›´æ–°ï¼ŒXenoLinux å¯ä»¥åœ¨æ¯æ¬¡è¶…è°ƒç”¨ä¸­åˆ†æ‘Š 2048 æ¬¡æ›´æ–°ï¼ˆå…¶æ‰¹å¤„ç†ç¼“å†²åŒºçš„æœ€å¤§å¤§å°ï¼‰ã€‚å› æ­¤ï¼Œæ¯æ¬¡æ›´æ–°è¶…è°ƒç”¨æ„é€  8MB çš„åœ°å€ç©ºé—´ã€‚ è¡¨ 5 ä¸­æ˜¾ç¤ºçš„ mmap å»¶è¿Ÿå’Œé¡µé¢æ•…éšœå»¶è¿Ÿç»“æœå¾ˆæœ‰è¶£ï¼Œå› ä¸ºå®ƒä»¬æ¯é¡µéœ€è¦ä¸¤æ¬¡è¿›å…¥ Xen çš„è½¬æ¢ï¼šä¸€æ¬¡æ˜¯å¤„ç†ç¡¬ä»¶æ•…éšœå¹¶å°†è¯¦ç»†ä¿¡æ¯ä¼ é€’ç»™å®¢æˆ·æ“ä½œç³»ç»Ÿï¼Œå¦ä¸€æ¬¡æ˜¯ä»£è¡¨å®¢æˆ·æ“ä½œç³»ç»Ÿå®‰è£…æ›´æ–°çš„é¡µè¡¨æ¡ç›®ã€‚å°½ç®¡å¦‚æ­¤ï¼Œå¼€é”€ç›¸å¯¹è¾ƒå°ã€‚ å¼€é”€å‡ ä¹å’ŒåŸç”Ÿæ˜¯æ²¡åŒºåˆ«çš„ å°±æ˜¯ fork ä¹‹ç±»çš„è¦æ…¢ä¸€äº›ï¼Œéœ€è¦é€šè¿‡ xen æ¥éªŒè¯é¡µè¡¨åˆ›å»º ä¸Šä¸‹æ–‡åˆ‡æ¢ã€å†…å­˜ç®¡ç†ç­‰ç­‰ã€‚ Network performance ä¸ºäº†è¯„ä¼°è™šæ‹ŸåŒ–ç½‘ç»œçš„å¼€é”€ï¼Œæˆ‘ä»¬æ£€æŸ¥äº†é€šè¿‡åƒå…†ä»¥å¤ªç½‘å±€åŸŸç½‘çš„ TCP æ€§èƒ½ã€‚ ä¸ºä»€ä¹ˆ TCP MTU 500 åè€Œæ€§èƒ½è¦ä½ä¸€äº›ï¼Ÿ ä½¿ç”¨ 500 å­—èŠ‚çš„ MTU æ—¶ï¼Œæ¯åŒ…å¼€é”€å ä¸»å¯¼åœ°ä½ã€‚å‘é€é˜²ç«å¢™å’Œæ¥æ”¶å¤šè·¯å¤ç”¨çš„é¢å¤–å¤æ‚æ€§å¯¹ååé‡äº§ç”Ÿäº†ä¸åˆ©å½±å“ï¼Œä½†ä»…é™ä½äº† 14%ã€‚ ","date":"2024-10-12","objectID":"/posts/paper-xen-vir/:6:2","tags":["Paper Reading"],"title":"Paper Reading: Xen and the Art of Virtualization","uri":"/posts/paper-xen-vir/"},{"categories":null,"content":"Concurrent Virtual Machines åœ¨å›¾ 5 ä¸­ï¼Œæˆ‘ä»¬å±•ç¤ºäº† Xen åœ¨è¿è¡Œ 1ã€2ã€4 å’Œ 8 ä¸ª OSDB-IR å’Œ OSDB-OLTP å®ä¾‹æ—¶å®ç°çš„æ€»ååé‡ã€‚å½“æ·»åŠ ç¬¬äºŒä¸ªåŸŸæ—¶ï¼Œç¬¬äºŒä¸ª CPU çš„å……åˆ†åˆ©ç”¨å‡ ä¹ä½¿æ€»ååé‡ç¿»å€ã€‚è¿›ä¸€æ­¥å¢åŠ åŸŸçš„æ•°é‡ä¼šå¯¼è‡´æ€»ååé‡æœ‰æ‰€ä¸‹é™ï¼Œè¿™å¯ä»¥å½’å› äºå¢åŠ çš„ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œç£ç›˜å¤´ç§»åŠ¨ã€‚åœ¨å•ä¸ª Linux æ“ä½œç³»ç»Ÿä¸Šè¿è¡Œå¤šä¸ª PostgreSQL å®ä¾‹çš„æ€»åˆ†æ•°æ¯”ä½¿ç”¨ Xen çš„ç­‰æ•ˆåˆ†æ•°ä½ 25-35%ã€‚åŸå› å°šæœªå®Œå…¨ç†è§£ï¼Œä½†ä¼¼ä¹ PostgreSQL å­˜åœ¨ SMP å¯æ‰©å±•æ€§é—®é¢˜ï¼Œå¹¶ä¸”æœªèƒ½å……åˆ†åˆ©ç”¨ Linux çš„å—ç¼“å­˜ã€‚ å›¾ 5 è¿˜å±•ç¤ºäº† 8 ä¸ªåŸŸä¹‹é—´çš„æ€§èƒ½å·®å¼‚åŒ–ã€‚Xen çš„è°ƒåº¦å™¨é…ç½®ä¸ºç»™æ¯ä¸ªåŸŸä¸€ä¸ªä»‹äº 1 å’Œ 8 ä¹‹é—´çš„æ•´æ•°æƒé‡ã€‚æ¯ä¸ªåŸŸçš„ååé‡åˆ†æ•°åæ˜ åœ¨æ¡å½¢å›¾çš„ä¸åŒåˆ†æ®µä¸­ã€‚åœ¨ IR åŸºå‡†æµ‹è¯•ä¸­ï¼Œæƒé‡å¯¹ååé‡æœ‰ç²¾ç¡®çš„å½±å“ï¼Œæ¯ä¸ªåˆ†æ®µéƒ½åœ¨å…¶é¢„æœŸå¤§å°çš„ 4%ä»¥å†…ã€‚ç„¶è€Œï¼Œåœ¨ OLTP æƒ…å†µä¸‹ï¼Œåˆ†é…æ›´å¤šèµ„æºçš„åŸŸæœªèƒ½å®ç°æˆæ¯”ä¾‹çš„é«˜åˆ†æ•°ï¼šé«˜æ°´å¹³çš„åŒæ­¥ç£ç›˜æ´»åŠ¨çªæ˜¾äº†æˆ‘ä»¬å½“å‰ç£ç›˜è°ƒåº¦ç®—æ³•çš„å¼±ç‚¹ï¼Œå¯¼è‡´å®ƒä»¬è¡¨ç°ä¸ä½³ ç£ç›˜è°ƒåº¦æ˜¯ä¸ªé—®é¢˜ï¼Œå‰æ–‡ä¹Ÿæåˆ° ","date":"2024-10-12","objectID":"/posts/paper-xen-vir/:6:3","tags":["Paper Reading"],"title":"Paper Reading: Xen and the Art of Virtualization","uri":"/posts/paper-xen-vir/"},{"categories":null,"content":"Performance Isolation ç¬¬å››ä¸ªåŸŸåŒæ—¶è¿è¡Œäº†ä¸€ä¸ªâ€œfork ç‚¸å¼¹â€å’Œä¸€ä¸ªè™šæ‹Ÿå†…å­˜å¯†é›†å‹åº”ç”¨ç¨‹åºï¼Œè¯¥åº”ç”¨ç¨‹åºå°è¯•åˆ†é…å’Œæ¥è§¦ 3GB çš„è™šæ‹Ÿå†…å­˜ï¼Œå¹¶åœ¨å¤±è´¥æ—¶é‡Šæ”¾æ¯ä¸ªé¡µé¢ç„¶åé‡æ–°å¯åŠ¨ã€‚ æˆ‘ä»¬å‘ç°ï¼ŒOSDB-IR å’Œ SPEC WEB99 çš„ç»“æœä»…å—åˆ°è¿è¡Œç ´åæ€§è¿‡ç¨‹çš„ä¸¤ä¸ªåŸŸçš„è¡Œä¸ºçš„è½»å¾®å½±å“â€”â€”åˆ†åˆ«æ¯”ä¹‹å‰æŠ¥å‘Šçš„ç»“æœä½ 4%å’Œ 2%ã€‚æˆ‘ä»¬å°†æ­¤å½’å› äºé¢å¤–çš„ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œç¼“å­˜æ•ˆåº”çš„å¼€é”€ã€‚è€ƒè™‘åˆ°æˆ‘ä»¬å½“å‰ç›¸å¯¹ç®€å•çš„ç£ç›˜è°ƒåº¦ç®—æ³•ï¼Œæˆ‘ä»¬è®¤ä¸ºè¿™æ˜¯æœ‰äº›å¹¸è¿çš„ï¼Œä½†åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒä¼¼ä¹ä¸ºåŸºå‡†æµ‹è¯•æä¾›äº†è¶³å¤Ÿçš„éš”ç¦»ï¼Œä½¿å…¶èƒ½å¤Ÿä»å…¶ä»–åŸŸçš„é¡µé¢äº¤æ¢å’Œç£ç›˜å¯†é›†å‹æ´»åŠ¨ä¸­å–å¾—è‰¯å¥½çš„è¿›å±•ã€‚VMware Workstation å®ç°äº†ç±»ä¼¼çš„éš”ç¦»æ°´å¹³ï¼Œä½†ç»å¯¹æ€§èƒ½æ°´å¹³è¾ƒä½ã€‚ è®ºæ–‡å¸Œæœ›å®ç°çš„æ˜¯ P. Shenoy and H. Vin. Cello: A Disk Scheduling Framework for Next-generation Operating Systems. In Proceedings of ACM SIGMETRICSâ€™98, the International Conference on Measurement and Modeling of Computer Systems, pages 44â€“55, June 1998. è¿™é‡Œçš„æ€§èƒ½éš”ç¦»å¯èƒ½ä¸å¦‚ KVM ","date":"2024-10-12","objectID":"/posts/paper-xen-vir/:6:4","tags":["Paper Reading"],"title":"Paper Reading: Xen and the Art of Virtualization","uri":"/posts/paper-xen-vir/"},{"categories":null,"content":"Scalability åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬è€ƒå¯Ÿäº† Xen æ‰©å±•åˆ° 100 ä¸ªåŸŸçš„èƒ½åŠ›ã€‚æˆ‘ä»¬è®¨è®ºäº†è¿è¡Œè®¸å¤šå®¢æˆ·æ“ä½œç³»ç»Ÿå®ä¾‹åŠå…¶ç›¸å…³åº”ç”¨ç¨‹åºçš„å†…å­˜éœ€æ±‚ï¼Œå¹¶æµ‹é‡äº†å…¶æ‰§è¡Œçš„ CPU æ€§èƒ½å¼€é”€ã€‚ ","date":"2024-10-12","objectID":"/posts/paper-xen-vir/:6:5","tags":["Paper Reading"],"title":"Paper Reading: Xen and the Art of Virtualization","uri":"/posts/paper-xen-vir/"},{"categories":null,"content":"Related Work å¦‚æˆ‘ä»¬çš„è¯„ä¼°æ‰€ç¤ºï¼Œé€‰æ‹©å®Œå…¨è™šæ‹ŸåŒ–è™½ç„¶èƒ½å¤Ÿæ›´å®¹æ˜“åœ°æ”¯æŒç°æˆçš„æ“ä½œç³»ç»Ÿï¼Œä½†å¯¹æ€§èƒ½æœ‰ä¸åˆ©å½±å“ã€‚ ç›®å‰ï¼Œæˆ‘ä»¬çŸ¥é“å¦å¤–ä¸¤ä¸ªé‡‡ç”¨åŠè™šæ‹ŸåŒ–æ–¹æ³•çš„ç³»ç»Ÿï¼šIBM ç›®å‰æ”¯æŒå…¶ zSeries å¤§å‹æœºä¸Šçš„ Linux åŠè™šæ‹ŸåŒ–ç‰ˆæœ¬ï¼Œå…è®¸å¤§é‡ Linux å®ä¾‹åŒæ—¶è¿è¡Œã€‚Denali [44]ï¼Œå‰é¢è®¨è®ºè¿‡ï¼Œæ˜¯ä¸€ä¸ªå½“ä»£çš„éš”ç¦»å†…æ ¸ï¼Œè¯•å›¾æä¾›ä¸€ä¸ªèƒ½å¤Ÿæ‰˜ç®¡å¤§é‡è™šæ‹ŸåŒ–æ“ä½œç³»ç»Ÿå®ä¾‹çš„ç³»ç»Ÿã€‚ æˆ‘ä»¬ä¸æ“ä½œç³»ç»Ÿçš„å¯æ‰©å±•æ€§å’Œä¸»åŠ¨ç½‘ç»œç¤¾åŒºæœ‰ä¸€äº›åŠ¨æœºã€‚ç„¶è€Œï¼Œå½“åœ¨ Xen ä¸Šè¿è¡Œæ—¶ï¼Œä¸éœ€è¦æ£€æŸ¥â€œå®‰å…¨â€ä»£ç æˆ–ä¿è¯ç»ˆæ­¢â€”â€”åœ¨ä»»ä½•ä¸€ç§æƒ…å†µä¸‹ï¼Œå”¯ä¸€å—å½±å“çš„äººæ˜¯ç›¸å…³å®¢æˆ·ã€‚å› æ­¤ï¼ŒXen æä¾›äº†ä¸€ä¸ªæ›´é€šç”¨çš„è§£å†³æ–¹æ¡ˆï¼šæ‰˜ç®¡ä»£ç ä¸éœ€è¦ç”±å—ä¿¡ä»»çš„ç¼–è¯‘å™¨è¿›è¡Œæ•°å­—ç­¾åï¼ˆå¦‚ SPIN [5]ï¼‰ï¼Œä¸éœ€è¦é™„å¸¦å®‰å…¨è¯æ˜ï¼ˆå¦‚ PCC [31]ï¼‰ï¼Œä¸éœ€è¦ç”¨ç‰¹å®šè¯­è¨€ç¼–å†™ï¼ˆå¦‚ SafetyNet [22] æˆ–ä»»ä½•åŸºäº Java çš„ç³»ç»Ÿï¼‰ï¼Œä¹Ÿä¸éœ€è¦ä¾èµ–ç‰¹å®šä¸­é—´ä»¶ï¼ˆå¦‚ç§»åŠ¨ä»£ç†ç³»ç»Ÿï¼‰ã€‚å½“ç„¶ï¼Œè¿™äº›å…¶ä»–æŠ€æœ¯å¯ä»¥åœ¨è¿è¡Œåœ¨ Xen ä¸Šçš„å®¢æˆ·æ“ä½œç³»ç»Ÿå†…ç»§ç»­ä½¿ç”¨ã€‚è¿™å¯¹äºå…·æœ‰æ›´å¤šä¸´æ—¶ä»»åŠ¡çš„å·¥ä½œè´Ÿè½½å¯èƒ½ç‰¹åˆ«æœ‰ç”¨ï¼Œè¿™äº›ä»»åŠ¡ä¸ä¼šæä¾›å¯åŠ¨æ–°åŸŸçš„æœºä¼šæ¥åˆ†æ‘Šæˆæœ¬ã€‚ ","date":"2024-10-12","objectID":"/posts/paper-xen-vir/:7:0","tags":["Paper Reading"],"title":"Paper Reading: Xen and the Art of Virtualization","uri":"/posts/paper-xen-vir/"},{"categories":null,"content":"Conclusion VMWare æˆç«‹äº 1998 Xen å¾ˆå¤šæƒ³æ³•éƒ½æ˜¯åŠè™šæ‹ŸåŒ–ï¼Œparavirtualization è€Œä¸æ˜¯å®Œå…¨è™šæ‹ŸåŒ–ï¼Œä½¿ç”¨ Domain0 æ¥ç®¡ç†å®¢åˆ¶åŒ–çš„ OSï¼Œéœ€è¦å®ç° OS éšç€åé¢ Intel VT-X/ AMD SVM çš„å‡ºç°ï¼ŒKVM çš„æ€§èƒ½ä¹Ÿå¯ä»¥æ¥è¿‘åŸç”Ÿï¼ŒXen ä¹Ÿå¼€å§‹æ”¯æŒ HVMï¼Œä¹ŸåŠ å…¥äº† Linux Foundation Xen é™åˆ¶è¿˜æ˜¯æŒºå¤§çš„ï¼Œè¦å®ç° OSï¼Œå…¼å®¹æ€§æ²¡é‚£ä¹ˆå¥½ï¼ˆç›´åˆ° 2012 æ‰å®ç°äº† ARMï¼‰ï¼Œåº”è¯¥æœ‰ä¸å°‘æ–‡ç« å¯¹æ¯” KVM å’Œ Xen çš„æ€§èƒ½ å¯èƒ½è¿™ä¹Ÿæ˜¯ Xen ç°åœ¨å‘å±•å®Œå…¨ä¸å¦‚ KVM çš„æ ¹æºæ‰€åœ¨å§ï¼Œå°½ç®¡ Xen æ€§èƒ½ç•¥ä¼˜ï¼Œä½†å…¼å®¹æ€§å’Œä½¿ç”¨é—¨æ§›æ‰æ˜¯å•†ä¸šåŒ–çš„æ•²é—¨ç –ï¼Œä¸è¿‡ Xen åé¢è¢« Citrix æ”¶è´­äº†å¯èƒ½å•†ä¸šåŒ–ä¼šå¥½å¾ˆå¤šï¼Œä¹Ÿæ¨å‡ºäº†å…¨è™šæ‹ŸåŒ– HVM ç‰ˆæœ¬ï¼ˆè²Œä¼¼æ˜¯ Windowsï¼‰ https://ieeexplore.ieee.org/abstract/document/6714189 S. G. Soriga and M. Barbulescu, â€œA comparison of the performance and scalability of Xen and KVM hypervisors,â€ 2013 RoEduNet International Conference 12th Edition: Networking in Education and Research, Iasi, Romania, 2013, pp. 1-6, doi: 10.1109/RoEduNet.2013.6714189. ","date":"2024-10-12","objectID":"/posts/paper-xen-vir/:8:0","tags":["Paper Reading"],"title":"Paper Reading: Xen and the Art of Virtualization","uri":"/posts/paper-xen-vir/"},{"categories":null,"content":"Caladan: Mitigating Interference at Microsecond Timescales Shenango åŒä¸€æ‰¹äººåšçš„ï¼Œåœ¨å…¶åŸºç¡€ä¸Šæå‡ºäº†æ€§èƒ½æ›´å¥½ã€ååé‡æ›´å¤§çš„ Caladanï¼Œå°† IOKernel ç§»å‡ºäº† datapathï¼Œä½¿ç”¨çš„æ˜¯ Dirctpath ","date":"2024-10-09","objectID":"/posts/paper-caladan/:1:0","tags":["Paper Reading"],"title":"Paper Reading: Caladan","uri":"/posts/paper-caladan/"},{"categories":null,"content":"Abstract ä¼ ç»Ÿè§‚ç‚¹è®¤ä¸ºï¼ŒCPU èµ„æºå¦‚æ ¸å¿ƒã€ç¼“å­˜å’Œå†…å­˜å¸¦å®½å¿…é¡»è¿›è¡Œåˆ†åŒºï¼Œä»¥å®ç°ä»»åŠ¡ä¹‹é—´çš„æ€§èƒ½éš”ç¦» ä»€ä¹ˆæ˜¯ performance isolation å¤šä»»åŠ¡æˆ–å¤šç”¨æˆ·ç¯å¢ƒä¸­ï¼Œç¡®ä¿ä¸€ä¸ªä»»åŠ¡æˆ–ç”¨æˆ·çš„æ€§èƒ½ä¸å—å…¶ä»–ä»»åŠ¡æˆ–ç”¨æˆ·çš„å½±å“ åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬è¯æ˜èµ„æºåˆ†åŒº resource partitioning æ—¢ä¸æ˜¯å¿…è¦çš„ä¹Ÿä¸æ˜¯å……åˆ†çš„ã€‚ Caladan æ˜¯ä¸€ç§æ–°çš„ CPU è°ƒåº¦å™¨ï¼Œé€šè¿‡ä¸€ç»„ä¾èµ–äºå¿«é€Ÿæ ¸å¿ƒåˆ†é…è€Œéèµ„æºåˆ†åŒºçš„æ§åˆ¶ä¿¡å·å’Œç­–ç•¥ï¼Œå¯ä»¥æ˜¾è‘—æé«˜quality of service (tail latency, throughput, etc.)ã€‚Caladan åŒ…æ‹¬ä¸€ä¸ªé›†ä¸­å¼è°ƒåº¦æ ¸å¿ƒï¼Œä¸»åŠ¨ç®¡ç†å†…å­˜å±‚æ¬¡ç»“æ„å’Œè¶…çº¿ç¨‹ä¹‹é—´çš„èµ„æºäº‰ç”¨ï¼Œä»¥åŠä¸€ä¸ªå†…æ ¸æ¨¡å—ï¼Œè¯¥æ¨¡å—ç»•è¿‡æ ‡å‡† Linux å†…æ ¸è°ƒåº¦å™¨ï¼Œä»¥æ”¯æŒå¾®ç§’çº§çš„ä»»åŠ¡ç›‘æ§å’Œæ”¾ç½®ã€‚å½“å°† memcached ä¸ä¸€ä¸ªå°½åŠ›è€Œä¸ºçš„åƒåœ¾æ”¶é›†å·¥ä½œè´Ÿè½½å…±å­˜æ—¶ï¼ŒCaladan çš„è¡¨ç°ä¼˜äºæœ€å…ˆè¿›çš„èµ„æºåˆ†åŒºç³»ç»Ÿ Partiesï¼Œæ€§èƒ½æå‡äº† 11,000 å€ï¼Œåœ¨èµ„æºä½¿ç”¨å˜åŒ–æœŸé—´å°†å°¾éƒ¨å»¶è¿Ÿä» 580 æ¯«ç§’é™ä½åˆ° 52 å¾®ç§’ï¼ŒåŒæ—¶ä¿æŒé«˜ CPU åˆ©ç”¨ç‡ã€‚ ç»•è¿‡ Linux Kernel schedulerï¼Œå’Œ eBPF å®ç°è°ƒåº¦æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ è¿™æ€§èƒ½æå‡å¤ªå¤¸å¼ äº†ï¼Œåˆ°åº•æ˜¯ baseline é€‰çš„å¥½è¿˜æ˜¯ä»€ä¹ˆ ","date":"2024-10-09","objectID":"/posts/paper-caladan/:2:0","tags":["Paper Reading"],"title":"Paper Reading: Caladan","uri":"/posts/paper-caladan/"},{"categories":null,"content":"Introduction åƒç½‘ç»œæœç´¢ã€ç¤¾äº¤ç½‘ç»œå’Œåœ¨çº¿é›¶å”®è¿™æ ·çš„äº¤äº’å¼ã€æ•°æ®å¯†é›†å‹ç½‘ç»œæœåŠ¡é€šå¸¸ä¼šå°†è¯·æ±‚åˆ†å¸ƒåœ¨æ•°åƒå°æœåŠ¡å™¨ä¸Šã€‚æœ€å°åŒ–å°¾éƒ¨å»¶è¿Ÿå¯¹è¿™äº›æœåŠ¡è‡³å…³é‡è¦ï¼Œ ç„¶è€Œï¼Œå‡å°‘å°¾éƒ¨å»¶è¿Ÿçš„åŠªåŠ›å¿…é¡»ä¸æœ€å¤§åŒ–æ•°æ®ä¸­å¿ƒæ•ˆç‡çš„éœ€æ±‚ä»”ç»†å¹³è¡¡ï¼› å¤§è§„æ¨¡æ•°æ®ä¸­å¿ƒè¿è¥å•†é€šå¸¸ pack several tasks åœ¨åŒä¸€å°æœºå™¨ä¸Šï¼Œä»¥åœ¨å¯å˜è´Ÿè½½çš„æƒ…å†µä¸‹æé«˜ CPU åˆ©ç”¨ç‡[22, 57, 66, 71]ã€‚åœ¨è¿™äº›æ¡ä»¶ä¸‹ï¼Œä»»åŠ¡å¿…é¡»ç«äº‰å…±äº«èµ„æºï¼Œå¦‚æ ¸å¿ƒã€å†…å­˜å¸¦å®½ã€ç¼“å­˜å’Œæ‰§è¡Œå•å…ƒã€‚å½“å…±äº«èµ„æºäº‰ç”¨é«˜æ—¶ï¼Œå»¶è¿Ÿä¼šæ˜¾è‘—å¢åŠ ï¼›è¿™ç§ç”±äºèµ„æºäº‰ç”¨å¯¼è‡´çš„ä»»åŠ¡å‡é€Ÿç§°ä¸ºå¹²æ‰° interferenceã€‚ äº‰ç”¨é«˜ä¼šå¯¼è‡´å»¶è¿Ÿå¥½ç†è§£ï¼Œä¹Ÿå°±æ˜¯ CPU åˆ©ç”¨ç‡é«˜ï¼Œä¸ºä»€ä¹ˆä¼šå¯¼è‡´å°¾éƒ¨å»¶è¿Ÿå‘¢ï¼Œæ„Ÿè§‰ä¸æ˜¯ç›´æ¥åŸå›  æˆ‘ä»¬çš„ç›®æ ‡æ˜¯ä¿æŒé«˜ CPU åˆ©ç”¨ç‡å’Œä¸¥æ ¼çš„æ€§èƒ½éš”ç¦»ï¼ˆå¯¹äºååé‡å’Œå°¾éƒ¨å»¶è¿Ÿï¼‰ï¼Œåœ¨èµ„æºä½¿ç”¨é¢‘ç¹å˜åŒ–çš„çœŸå®æ¡ä»¶ä¸‹ï¼Œä»è€Œå¹²æ‰°ä¹Ÿé¢‘ç¹å˜åŒ–ã€‚ å®ç°å¾®ç§’çº§ååº”æ—¶é—´æœ‰ä¸¤ä¸ªæŒ‘æˆ˜ã€‚é¦–å…ˆï¼Œå…±äº« CPU ä¸­å­˜åœ¨å¤šç§å¹²æ‰°ï¼ˆè¶…çº¿ç¨‹ã€å†…å­˜å¸¦å®½ã€LLC ç­‰ï¼‰ï¼Œåœ¨å¾®ç§’çº§æ—¶é—´å°ºåº¦ä¸Šå‡†ç¡®æ£€æµ‹æ¯ç§å¹²æ‰°çš„æ­£ç¡®æ§åˆ¶ä¿¡å·æ˜¯å›°éš¾çš„ã€‚å…¶æ¬¡ï¼Œç°æœ‰ç³»ç»Ÿåœ¨æ”¶é›†æ§åˆ¶ä¿¡å·æˆ–å¿«é€Ÿè°ƒæ•´èµ„æºåˆ†é…æ–¹é¢é¢ä¸´è¿‡å¤šçš„è½¯ä»¶å¼€é”€ã€‚ èµ„æºç›‘æ§åº”è¯¥å¯ä»¥ç”¨ eBPF åšï¼Ÿ ä¸ºäº†å…‹æœè¿™äº›æŒ‘æˆ˜ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ç§ interferenceaware CPU scheduler, Caladanã€‚Caladan ç”±ä¸€ä¸ªé›†ä¸­å¼çš„ä¸“ç”¨è°ƒåº¦æ ¸å¿ƒç»„æˆï¼Œè¯¥æ ¸å¿ƒæ”¶é›†æ§åˆ¶ä¿¡å·å¹¶åšå‡ºèµ„æºåˆ†é…å†³ç­–ï¼Œä»¥åŠä¸€ä¸ªåä¸º KSCHED çš„ Linux å†…æ ¸æ¨¡å—ï¼Œè¯¥æ¨¡å—é«˜æ•ˆåœ°è°ƒæ•´èµ„æºåˆ†é…ã€‚æˆ‘ä»¬çš„è°ƒåº¦æ ¸å¿ƒåŒºåˆ† high-priority, latency-critical (LC) tasks and low-priority, besteffort (BE) tasksã€‚ä¸ºäº†é¿å…ç¡¬ä»¶åˆ†åŒºå¸¦æ¥çš„ååº”æ—¶é—´é™åˆ¶ï¼ˆÂ§3ï¼‰ï¼ŒCaladan å®Œå…¨ä¾èµ–æ ¸å¿ƒåˆ†é…æ¥ç®¡ç†å¹²æ‰°ã€‚ Caladan ä½¿ç”¨ç²¾å¿ƒæŒ‘é€‰çš„ä¸€ç»„ control signals å’Œç›¸åº”çš„åŠ¨ä½œï¼Œä»¥å¿«é€Ÿå‡†ç¡®åœ°æ£€æµ‹å’Œå“åº”å¾®ç§’çº§æ—¶é—´å°ºåº¦ä¸Šçš„å¹²æ‰°ã€‚æˆ‘ä»¬è§‚å¯Ÿåˆ°å¹²æ‰°æœ‰ä¸¤ä¸ªç›¸äº’å…³è”çš„å½±å“ï¼šé¦–å…ˆï¼Œå¹²æ‰°ä¼šå‡æ…¢æ ¸å¿ƒçš„æ‰§è¡Œé€Ÿåº¦ï¼ˆæ›´å¤šçš„ç¼“å­˜æœªå‘½ä¸­ã€æ›´é«˜çš„å†…å­˜å»¶è¿Ÿç­‰ï¼‰ï¼Œå½±å“è¯·æ±‚çš„æœåŠ¡æ—¶é—´ï¼›å…¶æ¬¡ï¼Œéšç€æ ¸å¿ƒé€Ÿåº¦å‡æ…¢ï¼Œè®¡ç®—èƒ½åŠ›ä¸‹é™ï¼›å½“å®ƒä½äºæä¾›çš„è´Ÿè½½æ—¶ï¼Œæ’é˜Ÿå»¶è¿Ÿä¼šæ€¥å‰§å¢åŠ ã€‚ Caladan çš„è°ƒåº¦å™¨é’ˆå¯¹è¿™äº›å½±å“è¿›è¡Œäº†ä¼˜åŒ–ã€‚å®ƒæ”¶é›†å†…å­˜å¸¦å®½ä½¿ç”¨å’Œè¯·æ±‚å¤„ç†æ—¶é—´çš„ç»†ç²’åº¦æµ‹é‡æ•°æ®ï¼Œåˆ†åˆ«ç”¨äºæ£€æµ‹å†…å­˜å¸¦å®½å’Œè¶…çº¿ç¨‹å¹²æ‰°ã€‚ KSCHED å†…æ ¸æ¨¡å—åŠ é€Ÿäº†è°ƒåº¦æ“ä½œï¼Œå¦‚å”¤é†’ä»»åŠ¡å’Œæ”¶é›†å¹²æ‰°æŒ‡æ ‡ã€‚å®ƒé€šè¿‡åˆ†æ‘Šå‘é€ä¸­æ–­çš„æˆæœ¬ï¼Œå°†è°ƒåº¦å·¥ä½œä»è°ƒåº¦æ ¸å¿ƒ offloading åˆ°ä»»åŠ¡çš„æ ¸å¿ƒï¼Œå¹¶æä¾›ä¸€ä¸ªéé˜»å¡ APIï¼Œ è¯´å®è¯å®Œå…¨çœ‹ä¸æ‡‚äº†ã€‚ã€‚ä¸å¤ªå¥½ç†è§£åœ¨åšä»€ä¹ˆ æ®æˆ‘ä»¬æ‰€çŸ¥ï¼ŒCaladan æ˜¯ç¬¬ä¸€ä¸ªèƒ½å¤Ÿåœ¨é¢‘ç¹å˜åŒ–çš„å¹²æ‰°å’Œè´Ÿè½½ä¸‹åŒæ—¶ä¿æŒä¸¥æ ¼æ€§èƒ½éš”ç¦»å’Œé«˜ CPU åˆ©ç”¨ç‡çš„ç³»ç»Ÿ å‰æ–‡è¯´ resource partitioning is neither necessary nor sufficient è¿™é‡Œåº”è¯¥æ˜¯è¯´åˆ†åŒºæ˜¯ä¸å¿…è¦çš„ï¼Œä½†æ˜¯èƒ½ä¿è¯æ€§èƒ½éš”ç¦» ä¸ºäº†å®ç°è¿™äº›å¥½å¤„ï¼ŒCaladan å¯¹åº”ç”¨ç¨‹åºæå‡ºäº†ä¸¤ä¸ªæ–°çš„è¦æ±‚ï¼šé‡‡ç”¨è‡ªå®šä¹‰çš„è¿è¡Œæ—¶ç³»ç»Ÿè¿›è¡Œè°ƒåº¦å’Œ LC ä»»åŠ¡éœ€è¦æš´éœ²å…¶å†…éƒ¨å¹¶å‘æ€§ï¼ˆÂ§8ï¼‰ã€‚ä½œä¸ºäº¤æ¢ï¼ŒCaladan èƒ½å¤Ÿæ¯”æœ€å…ˆè¿›çš„èµ„æºåˆ†åŒºç³»ç»Ÿ Partiesï¼ˆ[12]ï¼‰æŠ¥å‘Šçš„å…¸å‹é€Ÿåº¦å¿« 500,000 å€åœ°æ”¶æ•›åˆ°æ­£ç¡®çš„èµ„æºé…ç½®ã€‚æˆ‘ä»¬å±•ç¤ºäº†è¿™ç§åŠ é€Ÿåœ¨å°† memcached ä¸ä¾èµ–åƒåœ¾æ”¶é›†çš„ BE ä»»åŠ¡å…±å­˜æ—¶ï¼Œå¸¦æ¥äº† 11,000 å€çš„å°¾éƒ¨å»¶è¿Ÿå‡å°‘ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬å±•ç¤ºäº† Caladan å…·æœ‰é«˜åº¦çš„é€šç”¨æ€§ï¼Œèƒ½å¤Ÿæ‰©å±•åˆ°å¤šä¸ªä»»åŠ¡ï¼Œå¹¶åœ¨å…±å­˜å¤šç§å·¥ä½œè´Ÿè½½ï¼ˆmemcachedã€å†…å­˜æ•°æ®åº“ã€é—ªå­˜å­˜å‚¨æœåŠ¡ã€x264 è§†é¢‘ç¼–ç å™¨ã€åƒåœ¾æ”¶é›†å™¨ç­‰ï¼‰æ—¶ä¿æŒç›¸åŒçš„å¥½å¤„ã€‚ å‡è®¾æ˜¯ï¼šcustom runtime system, LC tasks exposes their internal concurrency ä½å»¶è¿Ÿä»»åŠ¡éœ€è¦æš´éœ²å¹¶è¡Œæ€§ï¼Ÿ ","date":"2024-10-09","objectID":"/posts/paper-caladan/:3:0","tags":["Paper Reading"],"title":"Paper Reading: Caladan","uri":"/posts/paper-caladan/"},{"categories":null,"content":"Motivation å¹²æ‰°æœªè¢«è¿…é€Ÿç¼“è§£æ—¶æ€§èƒ½å¦‚ä½•ä¸‹é™ è®¸å¤šå·¥ä½œè´Ÿè½½è¡¨ç°å‡ºé˜¶æ®µæ€§è¡Œä¸ºï¼Œåœ¨äºšç§’çº§æ—¶é—´å°ºåº¦ä¸Šæ€¥å‰§æ”¹å˜å®ƒä»¬ä½¿ç”¨çš„èµ„æºç±»å‹å’Œæ•°é‡ã€‚ä¾‹å¦‚ï¼Œå‹ç¼©ã€ç¼–è¯‘ã€Spark è®¡ç®—ä½œä¸šå’Œåƒåœ¾æ”¶é›†å™¨ ä¸ºäº†æ›´å¥½åœ°ç†è§£ä¸æ—¶é—´å˜åŒ–å¹²æ‰°ç›¸å…³çš„æŒ‘æˆ˜ï¼Œæˆ‘ä»¬è€ƒè™‘å½“æˆ‘ä»¬å°†ä¸€ä¸ª LC ä»»åŠ¡ memcached[43]ä¸ä¸€ä¸ªç”±äºåƒåœ¾æ”¶é›†è€Œè¡¨ç°å‡ºé˜¶æ®µæ€§è¡Œä¸ºçš„ BE å·¥ä½œè´Ÿè½½å…±å­˜æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆã€‚ åœ¨è¿™ä¸ªå®éªŒä¸­ï¼Œæˆ‘ä»¬å‘ memcached æä¾›ä¸€ä¸ªå›ºå®šçš„è´Ÿè½½ï¼Œå¹¶åœ¨ä¸¤ä¸ªä»»åŠ¡ä¹‹é—´ statically partition cores è¿™ä¸ªä¾‹å­è¯´æ˜äº†å›ºå®šæ ¸å¿ƒåˆ†åŒºæ˜¯ä¸å¤Ÿçš„ï¼Œå¹¶ä¸”è¿˜è¡¨æ˜äº†ä¸ºäº†æœ‰æ•ˆç¼“è§£å¹²æ‰°ï¼Œæ ¸å¿ƒé‡æ–°åˆ†é…çš„é€Ÿåº¦æ˜¯å¿…è¦çš„ã€‚ å°±æ˜¯å…ˆå°† CPU å›ºå®šç»™ç‰¹å®šçš„ä»»åŠ¡ï¼Œå®ç°æ€§èƒ½éš”ç¦»ï¼Œä½†æ˜¯å‘ç”Ÿäº†å¹²æ‰°ï¼Œæ— æ³•åº”å¯¹çªå‘è´Ÿè½½ï¼Œéœ€è¦é‡æ–°åˆ†é… ","date":"2024-10-09","objectID":"/posts/paper-caladan/:4:0","tags":["Paper Reading"],"title":"Paper Reading: Caladan","uri":"/posts/paper-caladan/"},{"categories":null,"content":"Background å…±äº« CPU æ—¶å¯èƒ½å‘ç”Ÿçš„ä¸‰ç§å¹²æ‰°å½¢å¼ï¼šhyperthreading interference, memory bandwidth interference, and LLC interference. è¶…çº¿ç¨‹å¹²æ‰°é€šå¸¸åœ¨ä»»åŠ¡è¿è¡Œåœ¨å…„å¼Ÿæ ¸å¿ƒæ—¶å­˜åœ¨ï¼Œå› ä¸º CPU ä¼šåˆ’åˆ†æŸäº›ç‰©ç†æ ¸å¿ƒèµ„æºï¼ˆä¾‹å¦‚ï¼Œå¾®æ“ä½œé˜Ÿåˆ—ï¼‰ï¼Œä½†å…¶ä¸¥é‡ç¨‹åº¦å–å†³äºå…±äº«èµ„æºï¼ˆL1/L2 ç¼“å­˜ã€é¢„å–å™¨ã€æ‰§è¡Œå•å…ƒã€TLB ç­‰ï¼‰æ˜¯å¦è¢«äº‰ç”¨ã€‚å¦ä¸€æ–¹é¢ï¼Œå†…å­˜å¸¦å®½å’Œ LLC å¹²æ‰°çš„å¼ºåº¦å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒï¼Œä½†ä¼šå½±å“å…±äº«åŒä¸€ç‰©ç† CPU çš„æ‰€æœ‰æ ¸å¿ƒã€‚éšç€å†…å­˜å¸¦å®½ä½¿ç”¨é‡çš„å¢åŠ ï¼Œç”±äºå¹²æ‰°ï¼Œå†…å­˜è®¿é—®å»¶è¿Ÿä¼šé€æ¸å¢åŠ ï¼Œç›´åˆ°å†…å­˜å¸¦å®½é¥±å’Œï¼›è®¿é—®å»¶è¿Ÿéšåä¼šå‘ˆæŒ‡æ•°çº§å¢åŠ [62]ã€‚LLC å¹²æ‰°ç”±æ¯ä¸ªåº”ç”¨ç¨‹åºä½¿ç”¨çš„ç¼“å­˜é‡å†³å®šï¼šå½“éœ€æ±‚è¶…è¿‡å®¹é‡æ—¶ï¼ŒLLC æœªå‘½ä¸­ç‡ä¼šå¢åŠ ã€‚ LLC å¹²æ‰° (Last Level Cache Interference) LLC å¹²æ‰°æ˜¯æŒ‡åœ¨å¤šä»»åŠ¡æˆ–å¤šçº¿ç¨‹ç¯å¢ƒä¸­ï¼Œå¤šä¸ªä»»åŠ¡æˆ–çº¿ç¨‹å…±äº«æœ€åä¸€çº§ç¼“å­˜ï¼ˆLLCï¼‰æ—¶ï¼Œç”±äºç¼“å­˜èµ„æºçš„äº‰ç”¨è€Œå¯¼è‡´çš„æ€§èƒ½ä¸‹é™ã€‚ DDIO data direct IO å¯ä»¥ç›´æ¥å°†ç½‘ç»œæ•°æ®æ¨åˆ° LLC ","date":"2024-10-09","objectID":"/posts/paper-caladan/:5:0","tags":["Paper Reading"],"title":"Paper Reading: Caladan","uri":"/posts/paper-caladan/"},{"categories":null,"content":"Existing Approaches to Interference æœ€å…ˆè¿›çš„ç³»ç»Ÿå¦‚ Heracles[38]å’Œ Parties[12]é€šè¿‡åŠ¨æ€åˆ†åŒºèµ„æºï¼ˆå¦‚æ ¸å¿ƒå’Œ LLC åˆ†åŒºå¤§å°ï¼‰æ¥å¤„ç†å¹²æ‰° é¦–å…ˆï¼Œè¿™ä¸¤ä¸ªç³»ç»Ÿä½¿ç”¨åº”ç”¨ç¨‹åºçº§åˆ«çš„å°¾éƒ¨å»¶è¿Ÿæµ‹é‡æ¥æ£€æµ‹å¹²æ‰°ï¼Œè¿™äº›æµ‹é‡å¿…é¡»åœ¨æ•°ç™¾æ¯«ç§’å†…è¿›è¡Œï¼Œä»¥è·å¾—ç¨³å®šçš„ç»“æœï¼›Parties çš„ä½œè€…å‘ç°ï¼Œè¾ƒçŸ­çš„é—´éš”ä¼šäº§ç”Ÿâ€œå™ªå£°å’Œä¸ç¨³å®šçš„ç»“æœâ€ å› æ­¤ï¼ŒHeracles å’Œ Parties è‡³å°‘éœ€è¦ 50 å€äºæˆ‘ä»¬ä¾‹å­ä¸­ GC å‘¨æœŸçš„æ—¶é—´æ¥é€‚åº”å¹²æ‰°çš„å˜åŒ–ã€‚ é™¤äº†æ”¶æ•›é€Ÿåº¦ï¼Œç°æœ‰ç³»ç»Ÿè¿˜å­˜åœ¨å¯æ‰©å±•æ€§é™åˆ¶ã€‚ä¾‹å¦‚ï¼Œå…¸å‹çš„æ•°æ®ä¸­å¿ƒæœåŠ¡å™¨å¿…é¡»åŒæ—¶å¤„ç†å¤šä¸ª LC å’Œ BE ä»»åŠ¡[66, 71]ï¼Œä½† Heracles ä»…é™äºå•ä¸ª LC ä»»åŠ¡ï¼ˆå’Œè®¸å¤š BE ä»»åŠ¡ï¼‰ è¿™äº›ç³»ç»Ÿæ‰€ä¾èµ–çš„ç¡¬ä»¶æœºåˆ¶ä¹Ÿæ–½åŠ äº†é™åˆ¶ã€‚ä¾‹å¦‚ï¼Œè¶…çº¿ç¨‹ç¼ºä¹å¯¹èµ„æºåˆ†åŒºçš„æ§åˆ¶ï¼Œå› æ­¤ Heracles å’Œ Parties å®Œå…¨å…³é—­äº†å®ƒä»¬ã€‚ æ‰€ä»¥ä¸€æ–¹é¢æ˜¯ç°æœ‰çš„å¤„ç†å¹²æ‰°ç­–ç•¥å¤ªæ…¢ï¼Œæ¯«ç§’çº§åˆ«ï¼Œèµ„æºåˆ†é…æ…¢ï¼Œconvergence speed æ…¢ï¼Œæ‰©å±•æ€§ä¹Ÿä¸è¡Œï¼Œæœ‰äº›ä»…é™äºå•ä¸ª LC ä»»åŠ¡ï¼Œä¹Ÿä¾èµ–äºç¡¬ä»¶ï¼Œæ¯”å¦‚ä¸æ”¯æŒè¶…çº¿ç¨‹ã€‚ ","date":"2024-10-09","objectID":"/posts/paper-caladan/:5:1","tags":["Paper Reading"],"title":"Paper Reading: Caladan","uri":"/posts/paper-caladan/"},{"categories":null,"content":"Limitations of Hardware Extensions è‹±ç‰¹å°”çš„ CATï¼ˆCache Allocation Technologyï¼‰æŠ€æœ¯å¯ä»¥å°† LLC åˆ†åŒºï¼Œä½†åˆ†åŒºé…ç½®çš„å˜åŒ–éœ€è¦ç›¸å½“é•¿çš„æ—¶é—´æ‰èƒ½ç”Ÿæ•ˆã€‚ å†…å­˜å¸¦å®½åˆ†é…ï¼ˆMemory Bandwidth Allocationï¼ŒMBAï¼‰ å¤ªæ¥è¿‘ç¡¬ä»¶è®¾è®¡äº†è¿™ä¸€ç¯‡è®ºæ–‡ï¼Œæˆ‘æ„Ÿè§‰åªè¦äº†è§£ä¸€ä¸‹ interference çš„åŸç†ï¼Œå’Œç°æœ‰è§£å†³æ–¹æ¡ˆçš„ä¸è¶³ï¼Œä»¥åŠ caladan æ€ä¹ˆåšçš„å°±å·®ä¸å¤šäº† ","date":"2024-10-09","objectID":"/posts/paper-caladan/:5:2","tags":["Paper Reading"],"title":"Paper Reading: Caladan","uri":"/posts/paper-caladan/"},{"categories":null,"content":"Challenges and Approach æˆ‘ä»¬çš„æ€»ä½“ç›®æ ‡æ˜¯ä¿æŒæ€§èƒ½éš”ç¦»çš„åŒæ—¶æœ€å¤§åŒ– CPU åˆ©ç”¨ç‡ã€‚ ç®¡ç†å¹²æ‰°å˜åŒ–éœ€è¦å¾®ç§’çº§ååº”æ—¶é—´ã€‚ å› æ­¤ Caladan çš„æ–¹æ³•æ˜¯é€šè¿‡æ§åˆ¶æ ¸å¿ƒå¦‚ä½•åˆ†é…ç»™ä»»åŠ¡æ¥ç®¡ç†å¹²æ‰°ã€‚ ä¹‹å‰çš„ç³»ç»Ÿå·²ç»å°†æ ¸å¿ƒè°ƒæ•´ä½œä¸ºå…¶ç®¡ç†å¹²æ‰°ç­–ç•¥çš„ä¸€éƒ¨åˆ†[12, 28, 38, 70]ï¼Œä½† Caladan æ˜¯ç¬¬ä¸€ä¸ªå®Œå…¨ä¾èµ–æ ¸å¿ƒåˆ†é…æ¥ç®¡ç†å¤šç§å¹²æ‰°å½¢å¼çš„ç³»ç»Ÿã€‚ two key challenges: Sensitivity: ä¸ºäº†å¿«é€Ÿå’Œæœ‰é’ˆå¯¹æ€§çš„ååº”ï¼ŒCaladan éœ€è¦èƒ½å¤Ÿåœ¨å¾®ç§’å†…è¯†åˆ«å¹²æ‰°çš„å­˜åœ¨åŠå…¶æ¥æºï¼ˆä»»åŠ¡å’Œäº‰ç”¨èµ„æºï¼‰çš„æ§åˆ¶ä¿¡å·ã€‚å¸¸ç”¨çš„æ€§èƒ½æŒ‡æ ‡å¦‚ CPI[71]æˆ–å°¾éƒ¨å»¶è¿Ÿ[12, 38]ï¼ˆä»¥åŠç¡¬ä»¶æœºåˆ¶å¦‚ MBM å’Œ CMTï¼‰åœ¨çŸ­æ—¶é—´å†…å¤ªå˜ˆæ‚ï¼Œæ— æ³•æœ‰ç”¨ã€‚åƒæ’é˜Ÿå»¶è¿Ÿ[8, 42, 47, 68]è¿™æ ·çš„æŒ‡æ ‡å¯ä»¥åœ¨å¾®ç§’çº§æ—¶é—´å°ºåº¦ä¸Šæµ‹é‡ï¼Œä½†æ— æ³•è¯†åˆ«å¹²æ‰°çš„æ¥æºï¼Œåªèƒ½è¡¨æ˜ä»»åŠ¡çš„æ€§èƒ½æ­£åœ¨ä¸‹é™ã€‚ Scalability: ç°æœ‰ç³»ç»Ÿä¸¥é‡ä¾èµ– Linux å†…æ ¸æ¥æ”¶é›†æ§åˆ¶ä¿¡å·å’Œè°ƒæ•´èµ„æºåˆ†é…ï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨ sched_setaffinity() æ¥è°ƒæ•´æ ¸å¿ƒåˆ†é…ï¼‰ã€‚ä¸å¹¸çš„æ˜¯ï¼ŒLinux åœ¨è¿™äº›æ“ä½œä¸­å¢åŠ äº†å¼€é”€ï¼Œå¹¶ä¸”åœ¨å­˜åœ¨å¹²æ‰°ä»¥åŠæ ¸å¿ƒå’Œä»»åŠ¡æ•°é‡å¢åŠ æ—¶ï¼Œè¿™äº›å¼€é”€ä¼šå¢åŠ ã€‚ æˆ‘ä»¬é€šè¿‡ä»”ç»†é€‰æ‹©èƒ½å¤Ÿå¿«é€Ÿæ£€æµ‹å¹²æ‰°çš„æ§åˆ¶ä¿¡å·ï¼Œå¹¶ä¸“é—¨åˆ†é…ä¸€ä¸ªæ ¸å¿ƒæ¥ç›‘æ§è¿™äº›ä¿¡å·å¹¶åœ¨å¹²æ‰°å‘ç”Ÿæ—¶é‡‡å–è¡ŒåŠ¨æ¥è§£å†³æ•æ„Ÿæ€§æŒ‘æˆ˜ã€‚æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªåä¸º KSCHED çš„ Linux å†…æ ¸æ¨¡å—æ¥è§£å†³å¯æ‰©å±•æ€§æŒ‘æˆ˜ã€‚æˆ‘ä»¬å°†åœ¨ä¸‹é¢æ›´è¯¦ç»†åœ°æè¿°è¿™äº›å†…å®¹ã€‚ ä»€ä¹ˆä¿¡å·ï¼Ÿ ä¸“ç”¨æ ¸å¿ƒè°ƒåº¦ï¼Œè§£å†³ä¿¡å·é—®é¢˜ å†…æ ¸æ‰©å±•ã€ç»•è¿‡ ","date":"2024-10-09","objectID":"/posts/paper-caladan/:6:0","tags":["Paper Reading"],"title":"Paper Reading: Caladan","uri":"/posts/paper-caladan/"},{"categories":null,"content":"Caladanâ€™s Approach Caladan ä¸“é—¨åˆ†é…ä¸€ä¸ªæ ¸å¿ƒï¼Œç§°ä¸ºè°ƒåº¦å™¨ï¼Œä»¥æŒç»­è½®è¯¢å’Œæ”¶é›†ä¸€ç»„æ§åˆ¶ä¿¡å·ï¼Œæ—¶é—´å°ºåº¦ä¸ºå¾®ç§’çº§ã€‚ åˆ°åº•æ˜¯ä»€ä¹ˆä¿¡å·å•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Š çœ‹ä¸€åŠæ‰è®²ä¹Ÿå¤ªå¤¸å¼ äº†è¿™è®ºæ–‡ å¯¹äºè¶…çº¿ç¨‹ï¼Œæˆ‘ä»¬å‡è®¾å½“ä¸¤ä¸ªå…„å¼Ÿæ ¸å¿ƒéƒ½å¤„äºæ´»åŠ¨çŠ¶æ€æ—¶ï¼Œå¹²æ‰°æ€»æ˜¯å­˜åœ¨ï¼ˆå› ä¸ºæŸäº›ç‰©ç†æ ¸å¿ƒèµ„æºè¢«åˆ†åŒºï¼‰ï¼Œå¹¶ä¸“æ³¨äºå‡å°‘å¯¹å°¾éƒ¨å»¶è¿Ÿæœ‰å½±å“çš„è¯·æ±‚çš„å¹²æ‰°â€”â€”å³è¿è¡Œæ—¶é—´æœ€é•¿çš„è¯·æ±‚ã€‚æˆ‘ä»¬æµ‹é‡è¯·æ±‚å¤„ç†æ—¶é—´ä»¥è¯†åˆ«è¿™äº›è¯·æ±‚ã€‚ äºå†…å­˜å¸¦å®½ï¼Œæˆ‘ä»¬æµ‹é‡å…¨å±€å†…å­˜å¸¦å®½ä½¿ç”¨æƒ…å†µä»¥æ£€æµ‹ DRAM é¥±å’Œï¼Œå¹¶æµ‹é‡æ¯ä¸ªæ ¸å¿ƒçš„ LLC æœªå‘½ä¸­ç‡ä»¥å°†ä½¿ç”¨æƒ…å†µå½’å› äºç‰¹å®šä»»åŠ¡ã€‚å¯¹äºåƒ LLC è¿™æ ·çš„æƒ…å†µï¼Œæˆ‘ä»¬æ— æ³•ç›´æ¥æµ‹é‡æˆ–æ¨æ–­å¹²æ‰°ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥æµ‹é‡å¹²æ‰°çš„ä¸€ä¸ªå…³é”®å‰¯ä½œç”¨ï¼šç”±äºè®¡ç®—èƒ½åŠ›å‡å°‘è€Œå¢åŠ çš„æ’é˜Ÿå»¶è¿Ÿã€‚é€šè¿‡ä¸“æ³¨äºå¹²æ‰°é©±åŠ¨çš„æ§åˆ¶ä¿¡å·ï¼ŒCaladan å¯ä»¥åœ¨æœåŠ¡è´¨é‡ä¸‹é™ä¹‹å‰æ£€æµ‹åˆ°é—®é¢˜ã€‚ the longest running requests, global Memory Bandwidth Usage Per-Core LLC Miss Rates, queueing delay æœ€åï¼ŒCaladan å¼•å…¥äº†ä¸€ä¸ªåä¸º KSCHED çš„ Linux å†…æ ¸æ¨¡å—ã€‚KSCHED åœ¨å¾®ç§’çº§æ—¶é—´å°ºåº¦ä¸Šè·¨å¤šä¸ªæ ¸å¿ƒåŒæ—¶æ‰§è¡Œè°ƒåº¦åŠŸèƒ½ï¼Œå³ä½¿åœ¨å­˜åœ¨å¹²æ‰°çš„æƒ…å†µä¸‹ä¹Ÿæ˜¯å¦‚æ­¤ã€‚KSCHED é€šè¿‡ä¸‰ç§ä¸»è¦æŠ€æœ¯å®ç°è¿™äº›ç›®æ ‡ï¼šï¼ˆ1ï¼‰å®ƒåœ¨ Caladan ç®¡ç†çš„æ‰€æœ‰æ ¸å¿ƒä¸Šè¿è¡Œï¼Œå¹¶å°†è°ƒåº¦å·¥ä½œä»è°ƒåº¦æ ¸å¿ƒè½¬ç§»åˆ°è¿è¡Œä»»åŠ¡çš„æ ¸å¿ƒï¼›ï¼ˆ2ï¼‰å®ƒåˆ©ç”¨ç¡¬ä»¶å¯¹å¤šæ’­å¤„ç†å™¨é—´ä¸­æ–­ï¼ˆIPIsï¼‰çš„æ”¯æŒï¼Œä»¥åˆ†æ‘ŠåŒæ—¶å¯åŠ¨å¤šä¸ªæ ¸å¿ƒæ“ä½œçš„æˆæœ¬ï¼›ï¼ˆ3ï¼‰å®ƒæä¾›äº†ä¸€ä¸ªå®Œå…¨å¼‚æ­¥çš„è°ƒåº¦å™¨æ¥å£ï¼Œä»¥ä¾¿è°ƒåº¦å™¨å¯ä»¥åœ¨ç­‰å¾…è¿œç¨‹æ ¸å¿ƒå®Œæˆæ“ä½œçš„åŒæ—¶å‘èµ·æ“ä½œå¹¶æ‰§è¡Œå…¶ä»–å·¥ä½œã€‚ ","date":"2024-10-09","objectID":"/posts/paper-caladan/:6:1","tags":["Paper Reading"],"title":"Paper Reading: Caladan","uri":"/posts/paper-caladan/"},{"categories":null,"content":"Design ","date":"2024-10-09","objectID":"/posts/paper-caladan/:7:0","tags":["Paper Reading"],"title":"Paper Reading: Caladan","uri":"/posts/paper-caladan/"},{"categories":null,"content":"Overview å›¾ 2 å±•ç¤ºäº† Caladan çš„å…³é”®ç»„ä»¶åŠå…¶ä¹‹é—´çš„å…±äº«å†…å­˜åŒºåŸŸã€‚Caladan ä¸ Shenango[47]å…±äº«ä¸€äº›æ¶æ„å’Œå®ç°æ„å»ºå—ï¼šæ¯ä¸ªåº”ç”¨ç¨‹åºéƒ½ä¸ä¸€ä¸ªè¿è¡Œæ—¶ç³»ç»Ÿé“¾æ¥ï¼Œä¸€ä¸ªä¸“ç”¨çš„è°ƒåº¦æ ¸å¿ƒï¼ˆä»¥ root æƒé™è¿è¡Œï¼‰å¿™ç¢Œè½®è¯¢å…±äº«å†…å­˜åŒºåŸŸä»¥æ”¶é›†æ§åˆ¶ä¿¡å·å¹¶è¿›è¡Œæ ¸å¿ƒåˆ†é…ã€‚è¿™ä¸¤ä¸ªç³»ç»Ÿéƒ½è®¾è®¡ä¸ºåœ¨æ­£å¸¸ Linux ç¯å¢ƒä¸­äº’æ“ä½œï¼Œå¯èƒ½ç®¡ç†å¯ç”¨æ ¸å¿ƒçš„å­é›†ã€‚ Shenango ä½¿ç”¨æ’é˜Ÿå»¶è¿Ÿä½œä¸ºå…¶å”¯ä¸€çš„æ§åˆ¶ä¿¡å·æ¥ç®¡ç†è´Ÿè½½å˜åŒ–ï¼› Caladan ä½¿ç”¨å¤šä¸ªæ§åˆ¶ä¿¡å·æ¥ç®¡ç†å¤šç§ç±» å¤–ï¼ŒShenango çš„è°ƒåº¦æ ¸å¿ƒå°†ç½‘ç»œå¤„ç†ä¸ CPU è°ƒåº¦ç»“åˆåœ¨ä¸€èµ·ï¼›Caladan çš„è°ƒåº¦æ ¸å¿ƒä»…è´Ÿè´£ CPU è°ƒåº¦ï¼Œæ¶ˆé™¤äº†æ•°æ®åŒ…å¤„ç†ç“¶é¢ˆï¼ˆÂ§6ï¼‰å‹çš„å¹²æ‰°ä»¥åŠè´Ÿè½½å˜åŒ–ã€‚ Caladan çš„è¿è¡Œæ—¶ç³»ç»Ÿæä¾›â€œç»¿è‰²â€çº¿ç¨‹å’Œå†…æ ¸æ—è·¯ I/Oï¼Œä½¿ç”¨å·¥ä½œçªƒå–æ¥å¹³è¡¡è´Ÿè½½ï¼Œå¹¶åœ¨æ²¡æœ‰å·¥ä½œå¯çªƒå–æ—¶è®©å‡ºæ ¸å¿ƒã€‚è¿™ä½¿å¾—ç®¡ç†å¹²æ‰°æ›´å®¹æ˜“ï¼Œå¹¶èƒ½å¯¼å‡ºæ­£ç¡®çš„æ¯ä»»åŠ¡æ§åˆ¶ä¿¡å·ã€‚ ç”¨æˆ·ä¸ºæ¯ä¸ªä»»åŠ¡é…ç½®ä¿è¯æ ¸å¿ƒå’Œçªå‘æ ¸å¿ƒï¼Œä»»åŠ¡è¢«æŒ‡å®šä¸º LCï¼ˆå»¶è¿Ÿæ•æ„Ÿå‹ï¼‰æˆ– BEï¼ˆå°½åŠ›è€Œä¸ºå‹ï¼‰ã€‚BE ä»»åŠ¡ä»¥è¾ƒä½çš„ä¼˜å…ˆçº§è¿è¡Œï¼Œä»…åœ¨ LC ä»»åŠ¡ä¸éœ€è¦æ—¶åˆ†é…çªå‘æ ¸å¿ƒï¼Œå¹¶æ ¹æ®éœ€è¦è¿›è¡Œé™åˆ¶ä»¥ç®¡ç†å¹²æ‰°ã€‚ ","date":"2024-10-09","objectID":"/posts/paper-caladan/:7:1","tags":["Paper Reading"],"title":"Paper Reading: Caladan","uri":"/posts/paper-caladan/"},{"categories":null,"content":"The Caladan Scheduler ç‹¬ç«‹çš„æ§åˆ¶å™¨æ¨¡å—æ£€æµ‹å†…å­˜å¸¦å®½å’Œè¶…çº¿ç¨‹å¹²æ‰°ï¼Œåˆ†åˆ«å¯¹æ ¸å¿ƒåˆ†é…æ–½åŠ çº¦æŸå¹¶åœ¨å¿…è¦æ—¶æ’¤é”€æ ¸å¿ƒã€‚ æ’¤é”€ï¼Ÿ è°ƒåº¦å™¨ä»ä¸‰ä¸ªæ¥æºæ”¶é›†æ§åˆ¶ä¿¡å·ã€‚ é¦–å…ˆï¼Œè¿è¡Œæ—¶ç³»ç»Ÿæä¾›è¯·æ±‚å¤„ç†æ—¶é—´å’Œæ’é˜Ÿå»¶è¿Ÿçš„ä¿¡æ¯ã€‚ å…¶æ¬¡ï¼ŒDRAM æ§åˆ¶å™¨æä¾›å…¨å±€å†…å­˜å¸¦å®½ä½¿ç”¨æƒ…å†µçš„ä¿¡æ¯ã€‚ ç¬¬ä¸‰ï¼ŒKSCHED æä¾›æ¯ä¸ªæ ¸å¿ƒçš„ LLC æœªå‘½ä¸­ç‡ä¿¡æ¯ï¼Œå¹¶åœ¨ä»»åŠ¡è‡ªæ„¿è®©å‡ºæ—¶é€šçŸ¥è°ƒåº¦å™¨æ ¸å¿ƒã€‚ æ„Ÿè§‰å°±æ˜¯åŠ äº†è¿™äº›æŒ‡æ ‡ åé¢çš„å°±ä¸çœ‹äº†ï¼Œç†è§£ Caladan æ˜¯ä»€ä¹ˆï¼Œæ€ä¹ˆåšçš„ï¼ˆæ–°æŒ‡æ ‡ã€KSchedï¼‰ ä¸»è¦æ˜¯å°†ä¸€äº› LC å’Œ BE ä»»åŠ¡ï¼Œä¸å†éœ€è¦èµ„æºåˆ†åŒº è€Œæ˜¯é€šè¿‡åˆ†é…å’Œè°ƒåº¦ï¼Œå‡å°‘å¹²æ‰°ï¼Œé™ä½å°¾éƒ¨å»¶è¿Ÿ ","date":"2024-10-09","objectID":"/posts/paper-caladan/:7:2","tags":["Paper Reading"],"title":"Paper Reading: Caladan","uri":"/posts/paper-caladan/"},{"categories":null,"content":"Implementation ","date":"2024-10-09","objectID":"/posts/paper-caladan/:8:0","tags":["Paper Reading"],"title":"Paper Reading: Caladan","uri":"/posts/paper-caladan/"},{"categories":null,"content":"Evaluation ","date":"2024-10-09","objectID":"/posts/paper-caladan/:9:0","tags":["Paper Reading"],"title":"Paper Reading: Caladan","uri":"/posts/paper-caladan/"},{"categories":null,"content":"Comparison to Other Systems ","date":"2024-10-09","objectID":"/posts/paper-caladan/:9:1","tags":["Paper Reading"],"title":"Paper Reading: Caladan","uri":"/posts/paper-caladan/"},{"categories":null,"content":"Diverse Colocations ","date":"2024-10-09","objectID":"/posts/paper-caladan/:9:2","tags":["Paper Reading"],"title":"Paper Reading: Caladan","uri":"/posts/paper-caladan/"},{"categories":null,"content":"Microbenchmarks ","date":"2024-10-09","objectID":"/posts/paper-caladan/:9:3","tags":["Paper Reading"],"title":"Paper Reading: Caladan","uri":"/posts/paper-caladan/"},{"categories":null,"content":"Discussion Caladan è¦æ±‚åº”ç”¨ç¨‹åºä½¿ç”¨å…¶è¿è¡Œæ—¶ç³»ç»Ÿï¼Œå› ä¸ºå®ƒä¾èµ–äºè¿è¡Œæ—¶ç³»ç»Ÿå‘è°ƒåº¦å™¨å¯¼å‡ºæ§åˆ¶ä¿¡å·ï¼Œå¹¶å¿«é€Ÿå°†çº¿ç¨‹å’Œæ•°æ®åŒ…å¤„ç†å·¥ä½œæ˜ å°„åˆ°é¢‘ç¹å˜åŒ–çš„å¯ç”¨æ ¸å¿ƒé›†ä¸Šã€‚æˆ‘ä»¬çš„è¿è¡Œæ—¶ç³»ç»Ÿä¸æ˜¯å®Œå…¨ Linux å…¼å®¹çš„ï¼Œä½†å®ƒæä¾›äº†ä¸€ä¸ªç°å®çš„å¹¶å‘ç¼–ç¨‹æ¨¡å‹ï¼ˆç»§æ‰¿è‡ª Shenangoï¼‰ï¼ŒåŒ…æ‹¬çº¿ç¨‹ã€äº’æ–¥é”ã€æ¡ä»¶å˜é‡å’ŒåŒæ­¥ I/O[47]ã€‚ Caladan è¿˜åŒ…æ‹¬ä¸€ä¸ªéƒ¨åˆ†å…¼å®¹å±‚ï¼Œç”¨äºç³»ç»Ÿåº“ï¼ˆä¾‹å¦‚ï¼Œlibpthreadï¼‰ï¼Œå¯ä»¥åœ¨ä¸ä¿®æ”¹çš„æƒ…å†µä¸‹æ”¯æŒ PARSEC[9]ï¼Œä½¿æˆ‘ä»¬å¯¹è®¾è®¡åœ¨æœªæ¥æ”¯æŒæœªä¿®æ”¹çš„ Linux åº”ç”¨ç¨‹åºå…·æœ‰ä¸€å®šçš„ä¿¡å¿ƒã€‚ä¸ä½¿ç”¨æˆ‘ä»¬è¿è¡Œæ—¶çš„åº”ç”¨ç¨‹åºå¯ä»¥å…±å­˜åœ¨åŒä¸€å°æœºå™¨ä¸Šï¼Œä½†å®ƒä»¬å¿…é¡»è¿è¡Œåœ¨ä¸å— Caladan ç®¡ç†çš„æ ¸å¿ƒä¸Šï¼Œå¹¶ä¸”å¦‚æœå®ƒä»¬å¼•èµ·å¹²æ‰°ï¼Œåˆ™æ— æ³•è¢«é™åˆ¶ã€‚ ä¸ºä»€ä¹ˆä¸å®Œå…¨æ”¯æŒ linuxï¼Œä¸ºä»€ä¹ˆ Caladan æ›´åŸºæœ¬çš„è¦æ±‚æ˜¯éœ€è¦ LC ä»»åŠ¡å‘è¿è¡Œæ—¶ç³»ç»Ÿæš´éœ²å…¶å†…éƒ¨å¹¶å‘æ€§ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡ç”Ÿæˆç»¿è‰²çº¿ç¨‹ï¼‰ï¼Œè¿™å¯èƒ½éœ€è¦å¯¹ç°æœ‰ä»£ç è¿›è¡Œæ›´æ”¹ã€‚å¦‚æœå¹¶å‘æ€§ä¸è¶³ï¼Œä»»åŠ¡å°†æ— æ³•ä»é¢å¤–æ ¸å¿ƒä¸­å—ç›Šï¼Œä»è€Œé˜»ç¢ Caladan ç®¡ç†è´Ÿè½½æˆ–å¹²æ‰°å˜åŒ–çš„èƒ½åŠ›ã€‚é€šå¸¸ï¼Œæˆ‘ä»¬å»ºè®®ä»»åŠ¡é€šè¿‡ä¸ºæ¯ä¸ªè¿æ¥æˆ–æ¯ä¸ªè¯·æ±‚ç”Ÿæˆä¸€ä¸ªçº¿ç¨‹æ¥æš´éœ²å¹¶å‘æ€§ã€‚ä¾‹å¦‚ï¼Œé€šå¸¸ memcached ä¸ºæ¯ä¸ªçº¿ç¨‹å¤ç”¨å¤šä¸ª TCP è¿æ¥ï¼Œä½†æˆ‘ä»¬ä¿®æ”¹å®ƒä»¥ç”Ÿæˆä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹æ¥å¤„ç†æ¯ä¸ª TCP è¿æ¥ã€‚ è¿™ä¸ªå¾ˆé‡è¦ï¼Œå› ä¸ºå¤§éƒ¨åˆ† web åº”ç”¨è¦ä¹ˆç”¨çº¿ç¨‹æ± è¦ä¹ˆç”¨äº‹ä»¶é©±åŠ¨ï¼Œæ¯ä¸ªçº¿ç¨‹å¤ç”¨ TCP ä½†ä¸€ä¸ªçº¿ç¨‹ç”¨ä¸€ä¸ª TCPï¼Œè¿™æ˜¯å¦å°±é™ä½äº† memcached çš„å¹¶å‘é‡å’Œæœ€å¤§ç”¨æˆ·é‡ã€ååé‡ï¼Œæˆ–è€…æ˜¯çº¿ç¨‹æ•°é‡å¢åŠ ï¼Ÿ å…¶å®é™¤å»å°–å³°ï¼Œ p99.9 å°¾éƒ¨å»¶è¿Ÿæ˜¯å¢åŠ äº†çš„ï¼Œ Caladan çš„å½“å‰å®ç°æœ‰ä¸¤ä¸ªé™åˆ¶ã€‚é¦–å…ˆï¼Œå®ƒæ— æ³•ç®¡ç†è·¨ NUMA èŠ‚ç‚¹çš„å¹²æ‰°ã€‚NUMA å¼•å…¥äº†é¢å¤–çš„å…±äº«èµ„æºï¼Œè¿™äº›èµ„æºå®¹æ˜“å—åˆ°å¹²æ‰°ï¼ŒåŒ…æ‹¬è·¨å¥—æ¥å­—äº’è¿å’Œæ¯ä¸ªèŠ‚ç‚¹çš„ç‹¬ç«‹å†…å­˜æ§åˆ¶å™¨ã€‚å¹¸è¿çš„æ˜¯ï¼Œè¿™äº›èµ„æºçš„é«˜ç²¾åº¦æ€§èƒ½è®¡æ•°å™¨æ˜¯å¯ç”¨çš„ï¼Œæˆ‘ä»¬è®¡åˆ’åœ¨æœªæ¥æ¢ç´¢ NUMA æ„ŸçŸ¥çš„å¹²æ‰°ç¼“è§£ç­–ç•¥ï¼Œä¾‹å¦‚åœ¨èŠ‚ç‚¹ä¹‹é—´æ’¤é”€æ ¸å¿ƒæˆ–è¿ç§»ä»»åŠ¡ã€‚å…¶æ¬¡ï¼Œæˆ‘ä»¬çš„è°ƒåº¦ç­–ç•¥ä¸ä¼šæœ€å°åŒ–è·¨è¶…çº¿ç¨‹å…„å¼Ÿçš„ç¬æ€æ‰§è¡Œæ”»å‡»çš„å¨èƒ[3, 11, 65]ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œåªæœ‰ç›¸äº’ä¿¡ä»»çš„ä»»åŠ¡æ‰å…è®¸åœ¨å…„å¼Ÿæ ¸å¿ƒä¸Šè¿è¡Œã€‚åœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼ŒLinux å†…æ ¸æ­£åœ¨å¼€å‘ç±»ä¼¼çš„åŠŸèƒ½[13]ã€‚ ","date":"2024-10-09","objectID":"/posts/paper-caladan/:10:0","tags":["Paper Reading"],"title":"Paper Reading: Caladan","uri":"/posts/paper-caladan/"},{"categories":null,"content":"ghOSt: Fast \u0026 Flexible User-Space Delegation of Linux Scheduling Google çš„ ghOStï¼Œåœ¨è¿™ä¹‹å‰è¿˜æœ‰ Snap MicroKernel Approach to Host Networkingï¼Œæ˜¯ä¸€ä¸ªç”¨æˆ·ç½‘ç»œåè®®æ ˆï¼Œæ”¯æŒ RDMA ç­‰ç­‰ã€‚ ghOSt æ›´è¿›ä¸€æ­¥ï¼Œå¯ä»¥å…¼å®¹ Linuxï¼Œæ›´åŠ å®¹æ˜“ä½¿ç”¨ï¼Œæ›´çµæ´»ï¼Œçµæ„Ÿæ¥è‡ªå¾®å†…æ ¸ï¼ŒOS å§”æ‰˜ delegate ç»™ç”¨æˆ·ç©ºé—´ã€‚ è€Œä¸” Shenango, Caladan, Shinjuku ç­‰æå‡ºäº†å¯ä»¥ä½¿ç”¨ centralized model æ¥å•ç‹¬è°ƒåº¦ï¼Œå¯ä»¥è¾¾åˆ°å¾®ç§’çº§åˆ«çš„ work-conservation ä¹Ÿæœ‰ IX, ZygOS, Shinjuku, Shenango, Caladan, Snap æå‡ºäº† container-like data plane os æ˜¯ LibOS é‚£ä¸€å¥—å—ï¼Œç”¨äº kernel-bypass ghOSt çš„æƒ³æ³•è¿˜æ˜¯æ²¡æœ‰å¤ªå¤©é©¬è¡Œç©ºï¼Œæ˜¯å¾ˆå®é™…çš„ï¼Œæ‰©å±• Linux è€Œä¸æ˜¯ä»å¤´æï¼Œå¯èƒ½è€ƒè™‘åˆ° google å†…éƒ¨éœ€è¦ç”¨äºç”Ÿäº§ç¯å¢ƒï¼Ÿ ","date":"2024-10-07","objectID":"/posts/paper-ghost/:1:0","tags":["Paper Reading"],"title":"Paper Reading: ghOSt: Fast \u0026 Flexible User-Space Delegation of Linux Scheduling","uri":"/posts/paper-ghost/"},{"categories":null,"content":"Abstract æˆ‘ä»¬æ¨å‡ºäº† ghOStï¼Œè¿™æ˜¯æˆ‘ä»¬çš„åŸºç¡€è®¾æ–½ï¼Œç”¨äºå°†å†…æ ¸è°ƒåº¦å†³ç­–å§”æ‰˜ç»™ç”¨æˆ·ç©ºé—´ä»£ç  åœ¨å®šåˆ¶çš„æ•°æ®å¹³é¢æ“ä½œç³»ç»Ÿä¸­é‡‡ç”¨ä¸“é—¨çš„è°ƒåº¦ç­–ç•¥å¯ä»¥åœ¨æ•°æ®ä¸­å¿ƒç¯å¢ƒä¸­æä¾›ä»¤äººä¿¡æœçš„æ€§èƒ½ç»“æœ ghOSt åœ¨ Linux ç¯å¢ƒä¸­æä¾›äº†å°†è°ƒåº¦ç­–ç•¥æ™®éå§”æ‰˜ç»™ç”¨æˆ·ç©ºé—´è¿›ç¨‹çš„åŠŸèƒ½ã€‚ghOSt æä¾›äº† state encapsulation, communication, and action mechanisms å…è®¸åœ¨ç”¨æˆ·ç©ºé—´ä»£ç†å†…éƒ¨å¤æ‚åœ°è¡¨è¾¾è°ƒåº¦ç­–ç•¥ï¼ŒåŒæ—¶ååŠ©åŒæ­¥ã€‚ ç¨‹åºå‘˜å¯ä»¥ä½¿ç”¨ä»»ä½•è¯­è¨€æ¥å¼€å‘å’Œä¼˜åŒ–ç­–ç•¥ï¼Œè¿™äº›ç­–ç•¥å¯ä»¥åœ¨ä¸é‡å¯ä¸»æœºçš„æƒ…å†µä¸‹è¿›è¡Œä¿®æ”¹ã€‚ ghOSt æ”¯æŒå¹¿æ³›çš„è°ƒåº¦æ¨¡å‹ï¼Œfrom per-CPU to centralizedrun-to-completion to preemptive, and incurs low overheads for scheduling actionsã€‚æˆ‘ä»¬åœ¨åŒ…æ‹¬ Google Snap å’Œ Google Search åœ¨å†…çš„å­¦æœ¯å’Œç°å®ä¸–ç•Œå·¥ä½œè´Ÿè½½ä¸Šå±•ç¤ºäº† ghOSt çš„æ€§èƒ½ã€‚æˆ‘ä»¬è¯æ˜ï¼Œé€šè¿‡ä½¿ç”¨ ghOSt è€Œä¸æ˜¯å†…æ ¸è°ƒåº¦å™¨ï¼Œæˆ‘ä»¬å¯ä»¥è¿…é€Ÿè¾¾åˆ°ç›¸å½“çš„ååé‡å’Œå»¶è¿Ÿï¼ŒåŒæ—¶ä½¿ policy optimization, non-disruptive upgrades, and fault isolation æˆä¸ºå¯èƒ½ï¼Œä»è€Œä¸ºæˆ‘ä»¬çš„æ•°æ®ä¸­å¿ƒå·¥ä½œè´Ÿè½½æœåŠ¡ã€‚æˆ‘ä»¬å¼€æºäº†æˆ‘ä»¬çš„å®ç°ï¼Œä»¥ä¿ƒè¿›åŸºäº ghOSt çš„æœªæ¥ç ”ç©¶å’Œå¼€å‘ schedule policyï¼Œä¸éœ€è¦é‡å¯ï¼Œæ€ä¹ˆåšåˆ°çš„ ghost æœ¬èº«ä¸æ˜¯ policyï¼Œè€Œæ˜¯ process æ”¯æŒ bpf ghost ä½¿ç”¨ txn æ¥è¿›è¡Œè°ƒåº¦æäº¤ ","date":"2024-10-07","objectID":"/posts/paper-ghost/:2:0","tags":["Paper Reading"],"title":"Paper Reading: ghOSt: Fast \u0026 Flexible User-Space Delegation of Linux Scheduling","uri":"/posts/paper-ghost/"},{"categories":null,"content":"Introduction CPU scheduling plays an important role in application performance and security. Tailoring policies for specific workload types can substantially improve key metrics such as latency, throughput, hard/soft real-time characteristics, energy efficiency, cache interference, and security. å°½ç®¡ Linux æ”¯æŒå¤šç§è°ƒåº¦å®ç°ï¼Œä½†ä¸ºæ¯ä¸ªåº”ç”¨ç¨‹åºé‡èº«å®šåˆ¶ã€ç»´æŠ¤å’Œéƒ¨ç½²ä¸åŒçš„æœºåˆ¶åœ¨å¤§å‹é›†ç¾¤ä¸­æ˜¯éš¾ä»¥ç®¡ç†çš„ã€‚ åœ¨è¿™ç¯‡è®ºæ–‡ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº† ghOSt çš„è®¾è®¡åŠå…¶åœ¨ç”Ÿäº§ç¯å¢ƒå’Œå­¦æœ¯ç”¨ä¾‹ä¸­çš„è¯„ä¼°ã€‚ghOSt æ˜¯ä¸€ä¸ªç”¨äºåŸç”Ÿ OS çº¿ç¨‹çš„è°ƒåº¦å™¨ï¼Œå®ƒå°†ç­–ç•¥å†³ç­–å§”æ‰˜ç»™ç”¨æˆ·ç©ºé—´ã€‚ghOSt çš„ç›®æ ‡æ˜¯æ ¹æœ¬æ”¹å˜è°ƒåº¦ç­–ç•¥çš„è®¾è®¡ã€å®ç°å’Œéƒ¨ç½²æ–¹å¼ã€‚ghOSt æä¾›äº†ç”¨æˆ·ç©ºé—´å¼€å‘çš„çµæ´»æ€§å’Œæ˜“äºéƒ¨ç½²çš„ä¼˜åŠ¿ï¼ŒåŒæ—¶ä»ç„¶èƒ½å¤Ÿè¿›è¡Œå¾®ç§’çº§è°ƒåº¦ã€‚ghOSt ä¸ºç”¨æˆ·ç©ºé—´è½¯ä»¶å®šä¹‰å¤æ‚çš„è°ƒåº¦ç­–ç•¥æä¾›äº†æŠ½è±¡å’Œæ¥å£ï¼Œä»æ¯ CPU æ¨¡å‹åˆ°ç³»ç»ŸèŒƒå›´å†…çš„ï¼ˆé›†ä¸­å¼ï¼‰æ¨¡å‹ã€‚é‡è¦çš„æ˜¯ï¼ŒghOSt å°†å†…æ ¸è°ƒåº¦æœºåˆ¶ä¸ç­–ç•¥å®šä¹‰è§£è€¦ã€‚æœºåˆ¶ä½äºå†…æ ¸ä¸­ï¼Œå¾ˆå°‘æ”¹å˜ã€‚ç­–ç•¥å®šä¹‰ä½äºç”¨æˆ·ç©ºé—´ï¼Œå¹¶è¿…é€Ÿæ”¹å˜ã€‚ ghOSt ç»™æˆ‘çš„æ„Ÿè§‰æ›´åƒæ˜¯æŠŠ snap ä¹‹ç±»çš„æˆ–è€…å¾®å†…æ ¸è½åœ°äº†ï¼Œå¹¶ä¸”å…¼å®¹ Linux é€šè¿‡è°ƒåº¦åŸç”Ÿçº¿ç¨‹ï¼ŒghOSt æ— éœ€ä»»ä½•æ›´æ”¹å³å¯æ”¯æŒç°æœ‰åº”ç”¨ç¨‹åºã€‚åœ¨ ghOStï¼ˆå›¾ 1ï¼‰ä¸­ï¼Œè°ƒåº¦ç­–ç•¥é€»è¾‘åœ¨æ­£å¸¸ Linux è¿›ç¨‹ä¸­è¿è¡Œï¼Œç§°ä¸ºä»£ç†ï¼Œè¿™äº›ä»£ç†é€šè¿‡ ghOSt API ä¸å†…æ ¸äº¤äº’ã€‚ å†…æ ¸é€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆç¬¬ 3.1 èŠ‚ï¼‰åœ¨å¼‚æ­¥è·¯å¾„ä¸­é€šçŸ¥ä»£ç†æ‰€æœ‰æ‰˜ç®¡çº¿ç¨‹çš„çŠ¶æ€å˜åŒ–â€”â€”ä¾‹å¦‚ï¼Œçº¿ç¨‹åˆ›å»º/é˜»å¡/å”¤é†’ã€‚ ç„¶åä»£ç†ä½¿ç”¨åŸºäºäº‹åŠ¡çš„ API åœ¨åŒæ­¥è·¯å¾„ä¸­æäº¤çº¿ç¨‹çš„è°ƒåº¦å†³ç­–ï¼ˆç¬¬ 3.2 èŠ‚ï¼‰ã€‚ ghOSt æ”¯æŒå¤šä¸ªç­–ç•¥çš„å¹¶å‘æ‰§è¡Œã€æ•…éšœéš”ç¦»ä»¥åŠä¸ºä¸åŒåº”ç”¨ç¨‹åºåˆ†é… CPU èµ„æºã€‚é‡è¦çš„æ˜¯ï¼Œä¸ºäº†ä½¿ç°æœ‰ç³»ç»Ÿå¹³æ»‘è¿‡æ¸¡åˆ°ä½¿ç”¨ ghOStï¼Œå®ƒå¯ä»¥ä¸å…¶ä»–åœ¨å†…æ ¸ä¸­è¿è¡Œçš„è°ƒåº¦å™¨å…±å­˜ï¼Œå¦‚ CFSï¼ˆç¬¬ 3.4 èŠ‚ï¼‰ã€‚ æˆ‘ä»¬è¯æ˜äº† ghOSt ä½¿æˆ‘ä»¬èƒ½å¤Ÿå®šä¹‰å„ç§ç­–ç•¥ï¼Œå…¶æ€§èƒ½ä¸ç°æœ‰è°ƒåº¦å™¨åœ¨å­¦æœ¯å’Œç”Ÿäº§å·¥ä½œè´Ÿè½½ä¸Šçš„è¡¨ç°ç›¸å½“æˆ–æ›´å¥½ï¼ˆç¬¬ 4 èŠ‚ï¼‰ã€‚æˆ‘ä»¬æè¿°äº†å…³é”® ghOSt æ“ä½œçš„å¼€é”€ï¼ˆç¬¬ 4.1 èŠ‚ï¼‰ã€‚æˆ‘ä»¬å±•ç¤ºäº† ghOSt çš„å¼€é”€å¾ˆå°ï¼Œä» 265 çº³ç§’çš„æ¶ˆæ¯ä¼ é€’ï¼Œåˆ°è¿›å…¥ä»£ç†çš„ä¸Šä¸‹æ–‡åˆ‡æ¢éœ€è¦å‡ ç™¾çº³ç§’ï¼Œå†åˆ° 888 çº³ç§’è°ƒåº¦ä¸€ä¸ªçº¿ç¨‹ï¼Œä½¿å¾— ghOSt çš„è°ƒåº¦å¼€é”€ä»…ç•¥é«˜äºç°æœ‰å†…æ ¸è°ƒåº¦å™¨ã€‚é€šè¿‡æ‘Šé”€ï¼Œè¿™äº›å¼€é”€å…è®¸å•ä¸ª ghOSt ä»£ç†æ¯ç§’è°ƒåº¦è¶…è¿‡ 200 ä¸‡æ¡çº¿ç¨‹ï¼ˆå›¾ 5ï¼‰ã€‚æˆ‘ä»¬é€šè¿‡å®ç°é›†ä¸­å¼å’ŒæŠ¢å å¼ç­–ç•¥æ¥è¯„ä¼° ghOStï¼Œè¿™äº›ç­–ç•¥åœ¨å­˜åœ¨é«˜è¯·æ±‚åˆ†æ•£åº¦å’Œå¯¹æŠ—è€…çš„æƒ…å†µä¸‹å®ç°äº†é«˜ååé‡å’Œä½å°¾éƒ¨å»¶è¿Ÿï¼ˆç¬¬ 4.2 èŠ‚ï¼‰ã€‚ æˆ‘ä»¬å°† ghOSt ä¸ Shinjukuï¼Œä¸€ä¸ªä¸“é—¨çš„ç°ä»£æ•°æ®å¹³é¢è¿›è¡Œæ¯”è¾ƒï¼Œä»¥å±•ç¤º ghOSt çš„æœ€å°å¼€é”€å’Œå…·æœ‰ç«äº‰åŠ›çš„å¾®ç§’çº§æ€§èƒ½ï¼ˆä¸ Shinjuku ç›¸å·®ä¸è¶…è¿‡ 5%ï¼‰ï¼ŒåŒæ—¶æ”¯æŒæ›´å¹¿æ³›çš„å·¥ä½œè´Ÿè½½é›†ï¼ŒåŒ…æ‹¬å¤šç§Ÿæˆ·ã€‚æˆ‘ä»¬è¿˜ä¸º Snapï¼Œæˆ‘ä»¬åœ¨æ•°æ®ä¸­å¿ƒä½¿ç”¨çš„ç”Ÿäº§åŒ…äº¤æ¢æ¡†æ¶å®ç°äº†ä¸€ä¸ªç­–ç•¥ï¼Œå¯¼è‡´ä¸ MicroQuantaï¼Œæˆ‘ä»¬ç›®å‰ä½¿ç”¨çš„è½¯å®æ—¶è°ƒåº¦å™¨ç›¸æ¯”ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹å°¾éƒ¨å»¶è¿Ÿé™ä½äº† 5-30%ï¼ˆç¬¬ 4.3 èŠ‚ï¼‰ã€‚ç„¶åï¼Œæˆ‘ä»¬ä¸ºè¿è¡Œ Google Search çš„æœºå™¨å®ç°äº† ghOSt ç­–ç•¥ï¼ˆç¬¬ 4.4 èŠ‚ï¼‰ã€‚é€šè¿‡æ ¹æ®æœºå™¨æ‹“æ‰‘å®šåˆ¶ç­–ç•¥ï¼Œæ€»å…±ä¸åˆ° 1000 è¡Œä»£ç ï¼Œæˆ‘ä»¬è¯æ˜äº† ghOSt åŒ¹é…äº†ç°æœ‰è°ƒåº¦å™¨æä¾›çš„ååé‡ï¼Œè€Œä¸”é€šå¸¸å°†å»¶è¿Ÿæé«˜äº† 40-50%ã€‚æœ€åï¼Œæˆ‘ä»¬ä¸ºè™šæ‹Ÿæœºå®ç°äº†ä¸€ä¸ª ghOSt ç­–ç•¥ï¼Œè¯¥ç­–ç•¥å¯¹æœ€è¿‘å‘ç°çš„å¾®ä½“ç³»ç»“æ„æ¼æ´å…·æœ‰å®‰å…¨æ€§ï¼Œå¹¶æ˜¾ç¤º ghOSt çš„æ€§èƒ½ä¸çº¯å†…æ ¸ç­–ç•¥å®ç°å…·æœ‰ç«äº‰åŠ›ã€‚å€ŸåŠ© ghOStï¼Œä»¥å‰éœ€è¦å¹¿æ³›å†…æ ¸ä¿®æ”¹çš„è°ƒåº¦ç­–ç•¥ç°åœ¨åªéœ€å‡ åæˆ–å‡ ç™¾è¡Œä»£ç å°±èƒ½å®ç°ã€‚ ","date":"2024-10-07","objectID":"/posts/paper-ghost/:3:0","tags":["Paper Reading"],"title":"Paper Reading: ghOSt: Fast \u0026 Flexible User-Space Delegation of Linux Scheduling","uri":"/posts/paper-ghost/"},{"categories":null,"content":"Background \u0026 Design Goals Scheduling in Linux: Linux supports implementing multiple policies via scheduling classes. è¿™äº›ç±»æŒ‰ä¼˜å…ˆçº§æ’åºï¼šä½¿ç”¨è¾ƒé«˜ä¼˜å…ˆçº§ç±»è°ƒåº¦çš„çº¿ç¨‹å°†æŠ¢å ä½¿ç”¨è¾ƒä½ä¼˜å…ˆçº§ç±»è°ƒåº¦çš„çº¿ç¨‹ã€‚ä¸ºäº†ä¼˜åŒ–ç‰¹å®šåº”ç”¨çš„æ€§èƒ½ï¼Œå¼€å‘è€…å¯ä»¥ä¿®æ”¹è°ƒåº¦ç±»ä»¥æ›´å¥½åœ°æ»¡è¶³åº”ç”¨çš„éœ€æ±‚ï¼Œä¾‹å¦‚ï¼Œä¼˜å…ˆå¤„ç†åº”ç”¨çš„çº¿ç¨‹ä»¥å‡å°‘ç½‘ç»œå»¶è¿Ÿ[21]ï¼Œæˆ–ä½¿ç”¨å®æ—¶ç­–ç•¥è°ƒåº¦åº”ç”¨çš„çº¿ç¨‹ä»¥æ»¡è¶³æ•°æ®åº“æŸ¥è¯¢çš„æˆªæ­¢æ—¶é—´[47]ã€‚ ç„¶è€Œï¼Œå®ç°åœ¨å†…æ ¸ä¸­å®ç°å’Œç»´æŠ¤è¿™äº›ç­–ç•¥çš„å¤æ‚æ€§å¯¼è‡´è®¸å¤šå¼€å‘è€…é€‰æ‹©ä½¿ç”¨ç°æœ‰çš„é€šç”¨ç­–ç•¥ï¼Œå¦‚ Linux å®Œå…¨å…¬å¹³è°ƒåº¦å™¨ï¼ˆCFS [7]ï¼‰ã€‚å› æ­¤ï¼ŒLinux ä¸­ç°æœ‰çš„ç±»è®¾è®¡æ—¨åœ¨æ”¯æŒå°½å¯èƒ½å¤šçš„ç”¨ä¾‹ã€‚è¿™å°±ä½¿å¾—ä½¿ç”¨è¿™äº›è¿‡äºé€šç”¨çš„ç±»æ¥ä¼˜åŒ–é«˜æ€§èƒ½åº”ç”¨ä»¥å……åˆ†åˆ©ç”¨ç¡¬ä»¶å˜å¾—å…·æœ‰æŒ‘æˆ˜æ€§ã€‚ CFS å®Œå…¨å…¬å¹³è°ƒåº¦ æ„Ÿè§‰è¿™æ–¹å‘çš„è®ºæ–‡ï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯è®©é€šç”¨å˜å¾—ä¸“ç”¨ï¼Œä¸€å°éƒ¨åˆ†è®©å‡ ä¸ªä¸“ç”¨å˜æˆé€šç”¨ Implementing schedulers is hard: ghOSt ä½¿è°ƒåº¦å™¨çš„æ›´æ–°ã€æµ‹è¯•å’Œè°ƒä¼˜æˆä¸ºå¯èƒ½ï¼Œè€Œæ— éœ€æ›´æ–°å†…æ ¸å’Œ/æˆ–é‡å¯æœºå™¨å’Œåº”ç”¨ç¨‹åºã€‚ Deploying schedulers is even harder: ghOSt æ˜¯ä¸€ä¸ªè¿è¡Œåœ¨ç”¨æˆ·ç©ºé—´çš„å†…æ ¸è°ƒåº¦å™¨ï¼Œè°ƒåº¦åŸç”Ÿ OS çº¿ç¨‹ User-level threading is not enough: ghOSt enables the best of both worlds by guaranteeing control over response time while allowing flexible sharing of CPU resources. ghost å¯ä»¥è°ƒåº¦ç”¨æˆ·çº§çº¿ç¨‹å—ï¼Ÿ Custom scheduler/data plane OS per workload is impractical: Shinjukuã€Shenango å†…æ ¸å®ç°ä¸æ˜“æ›´æ”¹ï¼Œä¸”å¯¹äºå…¶ä»–å·¥ä½œè´Ÿè½½çš„æ€§èƒ½è¾ƒå·®ã€‚ Shenango [1]æœ‰ 8,399 è¡Œä»£ç ï¼Œåªèƒ½ä¸ºç½‘ç»œå·¥ä½œè´Ÿè½½å®ç°å•ä¸€çš„çº¿ç¨‹è°ƒåº¦ç­–ç•¥ã€‚æ·»åŠ é¢å¤–çš„ç­–ç•¥éœ€è¦å¤§é‡çš„ä»£ç ä¿®æ”¹ã€‚æ­¤å¤–ï¼Œè¿™ä¸¤ä¸ªç³»ç»Ÿéƒ½æ— æ³•åœ¨æ²¡æœ‰ç‰¹å®š NICs çš„æœºå™¨ä¸Šè¿è¡Œï¼Œä¸” Shenango æ— æ³•è°ƒåº¦éç½‘ç»œå·¥ä½œè´Ÿè½½ã€‚ Custom scheduling via BPF is insufficient: ä¸€ä¸ªå¸å¼•äººçš„æ–¹å¼æ¥å®šåˆ¶å†…æ ¸è°ƒåº¦æ˜¯å°† BPF [61]ç¨‹åºæ³¨å…¥å†…æ ¸è°ƒåº¦å™¨ï¼Œå°±åƒä¸ºå…¶ä»–å†…æ ¸å­ç³»ç»Ÿæ‰€åšçš„é‚£æ ·[62]ã€‚ç¡®å®å¯ä»¥å®ç°ä¸€ä¸ª Linux è°ƒåº¦å™¨ç±»ï¼Œå…¶å‡½æ•°æŒ‡é’ˆè°ƒç”¨ BPF ç¨‹åºæ¥å†³å®šä¸‹ä¸€ä¸ªè¿è¡Œçš„çº¿ç¨‹ã€‚ä¸å¹¸çš„æ˜¯ï¼ŒBPF åœ¨è¡¨è¾¾èƒ½åŠ›å’Œå¯è®¿é—®çš„å†…æ ¸æ•°æ®ç»“æ„æ–¹é¢æœ‰é™åˆ¶ã€‚ä¾‹å¦‚ï¼ŒBPF éªŒè¯å™¨å¿…é¡»èƒ½å¤Ÿç¡®å®šå¾ªç¯å°†é€€å‡ºï¼ŒBPF ç¨‹åºä¸èƒ½ä½¿ç”¨æµ®ç‚¹æ•°ã€‚ æ›´é‡è¦çš„æ˜¯ï¼ŒBPF ç¨‹åºæ˜¯åŒæ­¥è¿è¡Œçš„ï¼Œè¿™æ„å‘³ç€å®ƒä»¬å¿…é¡»å¿«é€Ÿå“åº”è°ƒåº¦äº‹ä»¶ï¼Œç›´åˆ°å®Œæˆå‰ä¼šé˜»å¡ CPUã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œå¼‚æ­¥è°ƒåº¦å™¨å¯ä»¥åœ¨ç¨åçš„æ—¶é—´æ¥æ”¶è°ƒåº¦äº‹ä»¶å¹¶å¯¹æ­¤åšå‡ºååº”ã€‚å› æ­¤ï¼Œå¦‚ç¬¬ 3.3 èŠ‚æ‰€è¿°çš„å…¨å±€è°ƒåº¦å™¨è¿™æ ·çš„å¼‚æ­¥æ¨¡å‹ï¼Œå¯ä»¥æ ¹æ®ç”±å¤šä¸ªè°ƒåº¦äº‹ä»¶ç»„æˆçš„ç³»ç»Ÿæ›´å¹¿æ³›çš„è§†è§’æ¥åšå‡ºè°ƒåº¦å†³ç­–ã€‚è¯è™½å¦‚æ­¤ï¼ŒBPF åœ¨ ghOSt ä¸­æ‰®æ¼”äº†é‡è¦è§’è‰²ï¼Œç”¨äºåŠ é€Ÿå¿«é€Ÿè·¯å¾„æ“ä½œï¼Œå¹¶åœ¨å†…æ ¸æ€§èƒ½å…³é”®ç‚¹æä¾›å®šåˆ¶åŒ–ï¼Œæ­£å¦‚ç¬¬ 3.2 èŠ‚æ‰€è§£é‡Šçš„ã€‚ BPF è°ƒåº¦åº”è¯¥æ˜¯æœ‰å‰æ™¯çš„ï¼Ÿ ","date":"2024-10-07","objectID":"/posts/paper-ghost/:4:0","tags":["Paper Reading"],"title":"Paper Reading: ghOSt: Fast \u0026 Flexible User-Space Delegation of Linux Scheduling","uri":"/posts/paper-ghost/"},{"categories":null,"content":"Design Goals Policies should be easy to implement and test: implementing systems in userspace rather than kernel space simplifies development and enables faster iteration as popular languages and tools can be used. Scheduling expressiveness and efficiency. Enabling scheduling decisions beyond the per-CPU model: The Linux scheduler ecosystem implements scheduling algorithms that make per-CPU scheduling decisions, æœ€è¿‘çš„å·¥ä½œè¡¨æ˜ï¼Œé€šè¿‡é›†ä¸­å¼ã€ä¸“ç”¨è½®è¯¢è°ƒåº¦çº¿ç¨‹[1, 21, 25]ï¼Œå³é‡‡ç”¨é›†ä¸­å¼æ¨¡å‹ï¼Œå¯ä»¥ä¸ºå¾®ç§’çº§å·¥ä½œè´Ÿè½½å¸¦æ¥æ˜¾è‘—çš„å°¾éƒ¨å»¶è¿Ÿæ”¹è¿›ã€‚ Supporting multiple concurrent policies Non-disruptive updates and fault isolation æ€ä¹ˆåšåˆ°æ— ä¸­æ–­æ›´æ–°å’Œæ•…éšœéš”ç¦»ï¼Ÿè™šæ‹ŸåŒ–ï¼Ÿ ","date":"2024-10-07","objectID":"/posts/paper-ghost/:4:1","tags":["Paper Reading"],"title":"Paper Reading: ghOSt: Fast \u0026 Flexible User-Space Delegation of Linux Scheduling","uri":"/posts/paper-ghost/"},{"categories":null,"content":"Design ghOSt overview: å›¾ 1 æ€»ç»“äº† ghOSt çš„è®¾è®¡ã€‚ç”¨æˆ·ç©ºé—´ä»£ç†åšå‡ºè°ƒåº¦å†³ç­–ï¼Œå¹¶æŒ‡ç¤ºå†…æ ¸å¦‚ä½•åœ¨ CPU ä¸Šè°ƒåº¦åŸç”Ÿçº¿ç¨‹ã€‚ghOSt çš„å†…æ ¸ä¾§ä½œä¸ºä¸€ä¸ªè°ƒåº¦ç±»å®ç°ï¼Œç±»ä¼¼äºå¸¸ç”¨çš„ CFS ç±»ã€‚è¿™ä¸ªè°ƒåº¦ç±»ä¸ºç”¨æˆ·ç©ºé—´ä»£ç æä¾›äº†ä¸€ä¸ªä¸°å¯Œçš„ API æ¥å®šä¹‰ä»»æ„çš„è°ƒåº¦ç­–ç•¥ã€‚ä¸ºäº†å¸®åŠ©ä»£ç†åšå‡ºè°ƒåº¦å†³ç­–ï¼Œå†…æ ¸é€šè¿‡æ¶ˆæ¯å’ŒçŠ¶æ€å­—å‘ä»£ç†æš´éœ²çº¿ç¨‹çŠ¶æ€ï¼ˆç¬¬ 3.1 èŠ‚ï¼‰ã€‚ç„¶åï¼Œä»£ç†é€šè¿‡äº‹åŠ¡å’Œç³»ç»Ÿè°ƒç”¨æ¥æŒ‡å¯¼å†…æ ¸çš„è°ƒåº¦å†³ç­–ï¼ˆç¬¬ 3.2 èŠ‚ï¼‰ã€‚ æœ¬èŠ‚å°†ä½¿ç”¨ä¸¤ä¸ªç¤ºä¾‹ï¼šper-CPU è°ƒåº¦å’Œé›†ä¸­å¼è°ƒåº¦ã€‚ä¼ ç»Ÿçš„å†…æ ¸è°ƒåº¦ç­–ç•¥ï¼Œå¦‚ CFSï¼Œæ˜¯æ¯ CPU è°ƒåº¦å™¨ã€‚å°½ç®¡è¿™äº›ç­–ç•¥é€šå¸¸é‡‡ç”¨è´Ÿè½½å‡è¡¡å’Œå·¥ä½œçªƒå–æ¥å¹³è¡¡ç³»ç»Ÿå†…çš„è´Ÿè½½ï¼Œä½†å®ƒä»¬ä»ç„¶ä»æ¯ CPU çš„è§’åº¦æ“ä½œã€‚é›†ä¸­å¼è°ƒåº¦çš„ä¾‹å­ç±»ä¼¼äº Shinjuku [25]ã€Shenango [1]å’Œ Caladan [21]ä¸­æå‡ºçš„æ¨¡å‹ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæœ‰ä¸€ä¸ªå•ä¸€çš„å…¨å±€å®ä½“ä¸æ–­åœ°è§‚å¯Ÿæ•´ä¸ªç³»ç»Ÿï¼Œå¹¶ä¸ºå…¶ç®¡è¾–ä¸‹çš„æ‰€æœ‰çº¿ç¨‹å’Œ CPU åšå‡ºè°ƒåº¦å†³ç­–ã€‚ Threads and CPUs: ghOSt è°ƒåº¦åŸç”Ÿçº¿ç¨‹åœ¨ CPU ä¸Šã€‚æœ¬èŠ‚æåˆ°çš„æ‰€æœ‰çº¿ç¨‹éƒ½æ˜¯åŸç”Ÿçº¿ç¨‹ï¼Œä¸ç¬¬ 2 èŠ‚æåˆ°çš„ç”¨æˆ·çº§çº¿ç¨‹ç›¸å¯¹ã€‚æˆ‘ä»¬å°†é€»è¾‘æ‰§è¡Œå•å…ƒç§°ä¸º CPUã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬è®¤ä¸ºä¸€å°æ‹¥æœ‰ 56 ä¸ªç‰©ç†æ ¸å¿ƒå’Œ 112 ä¸ªé€»è¾‘æ ¸å¿ƒï¼ˆè¶…çº¿ç¨‹ï¼‰çš„æœºå™¨æœ‰ 112 ä¸ª CPUã€‚ æ‰€ä»¥ä¸èƒ½è°ƒåº¦ç”¨æˆ·çº¿ç¨‹ï¼Ÿ Partitioning the machine. ghOSt supports multiple concurrent policies on a single machine using enclaves ç³»ç»Ÿå¯ä»¥æŒ‰ç…§ CPU ç²’åº¦åˆ’åˆ†ä¸ºå¤šä¸ªç‹¬ç«‹çš„ enclaveï¼Œæ¯ä¸ª enclave è¿è¡Œè‡ªå·±çš„ç­–ç•¥ï¼Œå¦‚å›¾ 2 æ‰€ç¤ºã€‚ä»è°ƒåº¦çš„è§’åº¦æ¥çœ‹ï¼Œè¿™äº› enclave æ˜¯éš”ç¦»çš„ã€‚å½“åœ¨å•å°æœºå™¨ä¸Šè¿è¡Œä¸åŒçš„å·¥ä½œè´Ÿè½½æ—¶ï¼Œåˆ†åŒºå°¤å…¶æœ‰æ„ä¹‰ã€‚é€šå¸¸å¯ä»¥é€šè¿‡æœºå™¨æ‹“æ‰‘è®¾ç½®è¿™äº› enclave çš„ç²’åº¦ï¼Œå¦‚æ¯ä¸ª NUMA æ’æ§½æˆ–æ¯ä¸ª AMD CCX [40]ã€‚enclave ä¹Ÿæœ‰åŠ©äºéš”ç¦»æ•…éšœï¼Œå°†ä»£ç†å´©æºƒçš„æŸå®³é™åˆ¶åœ¨å…¶æ‰€å±çš„ enclave å†… enclaves æ˜¯ä»€ä¹ˆ ghOSt userspace agents. è°ƒåº¦ç­–ç•¥é€»è¾‘æ˜¯åœ¨ç”¨æˆ·ç©ºé—´ä»£ç†ä¸­å®ç°çš„ ä¸ºäº†å®ç°å®¹é”™å’Œéš”ç¦»ï¼Œå¦‚æœä¸€ä¸ªæˆ–å‡ ä¸ªä»£ç†å´©æºƒï¼Œç³»ç»Ÿå°†å›é€€åˆ°é»˜è®¤è°ƒåº¦å™¨ï¼Œå¦‚ CFSã€‚æ­¤æ—¶ï¼Œæœºå™¨ä»å®Œå…¨åŠŸèƒ½æ­£å¸¸ï¼Œç›´åˆ°å¯åŠ¨æ–°çš„ ghOSt ç”¨æˆ·ç©ºé—´ä»£ç†â€”â€”æ— è®ºæ˜¯æœ€åä¸€ä¸ªå·²çŸ¥çš„ç¨³å®šç‰ˆæœ¬è¿˜æ˜¯å¸¦æœ‰ä¿®å¤çš„æ–°ä¿®è®¢ç‰ˆã€‚å¾—ç›Šäºå´©æºƒæ¢å¤çš„ç‰¹æ€§ï¼Œæ›´æ–°è°ƒåº¦ç­–ç•¥ç›¸å½“äºé‡æ–°å¯åŠ¨ç”¨æˆ·ç©ºé—´ä»£ç†ï¼Œè€Œæ— éœ€é‡å¯æœºå™¨ã€‚è¿™ä¸€ç‰¹æ€§ä½¿å¾—å¯ä»¥é’ˆå¯¹å„ç§ç¡¬ä»¶å’Œå·¥ä½œè´Ÿè½½è¿›è¡Œå®éªŒå’Œå¿«é€Ÿç­–ç•¥å®šåˆ¶ã€‚å¼€å‘è€…å¯ä»¥å¯¹ç­–ç•¥è¿›è¡Œå¾®è°ƒå¹¶ç®€å•åœ°é‡æ–°å¯åŠ¨ä»£ç†ã€‚å…³äº ghOSt ç­–ç•¥çš„åŠ¨æ€æ›´æ–°å°†åœ¨ç¬¬ 3.4 èŠ‚ä¸­è®¨è®ºã€‚ å´©æºƒåæ€ä¹ˆå›é€€ï¼Œæ˜¯å…¨éƒ¨å›é€€åˆ° per-CPU è¿˜æ˜¯ä»€ä¹ˆï¼Œå¦‚æœä¹‹å‰çš„æ˜¯ centrialized çš„æ€ä¹ˆåŠ æ— è®ºè°ƒåº¦æ¨¡å‹æ˜¯æ¯ CPU è¿˜æ˜¯é›†ä¸­å¼ï¼Œæ¯ä¸ªç”± ghOSt ç®¡ç†çš„ CPU éƒ½æœ‰ä¸€ä¸ªæœ¬åœ°ä»£ç†ï¼Œå¦‚å›¾ 2 æ‰€ç¤ºã€‚åœ¨æ¯ CPU çš„æƒ…å†µä¸‹ï¼Œæ¯ä¸ªä»£ç†è´Ÿè´£å…¶è‡ªèº« CPU çš„çº¿ç¨‹è°ƒåº¦å†³ç­–ã€‚åœ¨é›†ä¸­å¼çš„æƒ…å†µä¸‹ï¼Œä¸€ä¸ªå•ä¸€çš„å…¨å±€ä»£ç†è´Ÿè´£ enclave ä¸­æ‰€æœ‰ CPU çš„è°ƒåº¦ã€‚æ‰€æœ‰å…¶ä»–æœ¬åœ°ä»£ç†éƒ½æ˜¯ä¸æ´»è·ƒçš„ã€‚æ¯ä¸ªä»£ç†éƒ½åœ¨ä¸€ä¸ª Linux pthread ä¸­å®ç°ï¼Œæ‰€æœ‰ä»£ç†éƒ½å±äºåŒä¸€ä¸ªç”¨æˆ·ç©ºé—´è¿›ç¨‹ã€‚ agent åˆ°åº•ä»£è¡¨ä»€ä¹ˆï¼Œè°ƒåº¦å™¨ï¼Ÿ ","date":"2024-10-07","objectID":"/posts/paper-ghost/:5:0","tags":["Paper Reading"],"title":"Paper Reading: ghOSt: Fast \u0026 Flexible User-Space Delegation of Linux Scheduling","uri":"/posts/paper-ghost/"},{"categories":null,"content":"Kernel-to-Agent Communication Exposing thread state to the agents. ä¸ºäº†è®©ä»£ç†èƒ½å¤Ÿå¯¹å…¶ç®¡è¾–ä¸‹çš„çº¿ç¨‹åšå‡ºè°ƒåº¦å†³ç­–ï¼Œå†…æ ¸å¿…é¡»å‘ä»£ç†æš´éœ²çº¿ç¨‹çŠ¶æ€ã€‚ ä¸€ç§æ–¹æ³•æ˜¯å°†ç°æœ‰çš„å†…æ ¸æ•°æ®ç»“æ„å†…å­˜æ˜ å°„åˆ°ç”¨æˆ·ç©ºé—´ï¼Œä¾‹å¦‚ task_structsï¼Œè¿™æ ·ä»£ç†å¯ä»¥æ£€æŸ¥å®ƒä»¬ä»¥æ¨æ–­çº¿ç¨‹çŠ¶æ€ã€‚ç„¶è€Œï¼Œè¿™äº›æ•°æ®ç»“æ„çš„å¯ç”¨æ€§å’Œæ ¼å¼åœ¨ä¸åŒçš„å†…æ ¸å’Œå†…æ ¸ç‰ˆæœ¬ä¹‹é—´æœ‰æ‰€ä¸åŒï¼Œç´§å¯†åœ°å°†ç”¨æˆ·ç©ºé—´ç­–ç•¥å®ç°ä¸å†…æ ¸ç‰ˆæœ¬è€¦åˆåœ¨ä¸€èµ·ã€‚å¦ä¸€ç§æ–¹æ³•æ˜¯é€šè¿‡ sysfs æ–‡ä»¶æš´éœ²çº¿ç¨‹çŠ¶æ€ï¼Œé‡‡ç”¨/proc/pid/...çš„å½¢å¼ã€‚ç„¶è€Œï¼Œæ–‡ä»¶ç³»ç»Ÿ API å¯¹äºå¿«é€Ÿè·¯å¾„æ“ä½œæ•ˆç‡ä½ä¸‹ï¼Œéš¾ä»¥æ”¯æŒå¾®ç§’çº§çš„ç­–ç•¥ï¼šopen/read/fseek æœ€åˆæ˜¯ä¸ºå—è®¾å¤‡è®¾è®¡çš„ï¼Œé€Ÿåº¦å¤ªæ…¢ä¸”å¤æ‚ï¼ˆä¾‹å¦‚ï¼Œéœ€è¦é”™è¯¯å¤„ç†å’Œæ•°æ®è§£æï¼‰ã€‚ ghOSt messages. åœ¨ ghOSt ä¸­ï¼Œå†…æ ¸ä½¿ç”¨è¡¨ 1 ä¸­åˆ—å‡ºçš„æ¶ˆæ¯é€šçŸ¥ç”¨æˆ·ç©ºé—´ä»£ç†çº¿ç¨‹çŠ¶æ€çš„å˜åŒ–ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªçº¿ç¨‹è¢«é˜»å¡ä½†ç°åœ¨å‡†å¤‡è¿è¡Œï¼Œå†…æ ¸ä¼šå‘å¸ƒä¸€ä¸ª THREAD_WAKEUP æ¶ˆæ¯ã€‚æ­¤å¤–ï¼Œå†…æ ¸è¿˜é€šè¿‡ TIMER_TICK æ¶ˆæ¯é€šçŸ¥ä»£ç†å®šæ—¶å™¨æ»´ç­”ã€‚ä¸ºäº†å¸®åŠ©ä»£ç†éªŒè¯å®ƒä»¬çš„å†³ç­–åŸºäºæœ€æ–°çš„çŠ¶æ€ï¼Œæ¶ˆæ¯è¿˜åŒ…æ‹¬åºåˆ—å·ï¼Œè¿™ä¸€ç‚¹å°†åœ¨åé¢è§£é‡Šã€‚ Message queues: æ¶ˆæ¯é€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—ä¼ é€’ç»™ä»£ç†ã€‚åœ¨é›†ä¸­å¼ä¾‹å­ä¸­ï¼Œæ‰€æœ‰çº¿ç¨‹éƒ½è¢«åˆ†é…åˆ°å…¨å±€é˜Ÿåˆ—ï¼ˆå›¾ 2ï¼Œå³ï¼‰ã€‚å…³äº CPU äº‹ä»¶çš„æ¶ˆæ¯ï¼Œå¦‚ TIMER_TICKï¼Œä¼šè¢«è·¯ç”±åˆ°ä¸ CPU ç›¸å…³è”çš„ä»£ç†çº¿ç¨‹çš„é˜Ÿåˆ—ã€‚ è¿™ä¸ªå¾ˆæœ‰æ„æ€ï¼Œè¿™äº›é˜Ÿåˆ—ä»å“ªé‡Œæ¥çš„ï¼Ÿ è™½ç„¶å®ç°é˜Ÿåˆ—çš„æ–¹æ³•æœ‰å¾ˆå¤šï¼Œä½†æˆ‘ä»¬é€‰æ‹©åœ¨å…±äº«å†…å­˜ä¸­ä½¿ç”¨è‡ªå®šä¹‰é˜Ÿåˆ—ï¼Œä»¥é«˜æ•ˆåœ°å¤„ç†ä»£ç†å”¤é†’ï¼ˆå¦‚ä¸‹æ‰€è¿°ï¼‰ã€‚æˆ‘ä»¬è®¤ä¸ºç°æœ‰çš„é˜Ÿåˆ—æœºåˆ¶å¯¹äº ghOSt æ¥è¯´æ˜¯ä¸è¶³çš„ï¼Œå› ä¸ºå®ƒä»¬ä»…å­˜åœ¨äºç‰¹å®šçš„å†…æ ¸ç‰ˆæœ¬ä¸­ã€‚ä¾‹å¦‚ï¼ŒBPF ç³»ç»Ÿé€šè¿‡ BPF ç¯å½¢ç¼“å†²åŒº[BPF ring buffers][65]å°† BPF äº‹ä»¶ä¼ é€’åˆ°ç”¨æˆ·ç©ºé—´ï¼Œæœ€è¿‘ç‰ˆæœ¬çš„ Linux è¿˜é€šè¿‡ io_uring[66]å°†å¼‚æ­¥ I/O æ¶ˆæ¯ä¼ é€’åˆ°ç”¨æˆ·ç©ºé—´ã€‚è¿™ä¸¤ç§éƒ½æ˜¯å¿«é€Ÿçš„æ— é”ç¯å½¢ç¼“å†²åŒºï¼ŒåŒæ­¥æ¶ˆè´¹è€…/ç”Ÿäº§è€…è®¿é—®ã€‚ç„¶è€Œï¼Œæ—§ç‰ˆæœ¬çš„ Linux å†…æ ¸å’Œå…¶ä»–æ“ä½œç³»ç»Ÿä¸æ”¯æŒå®ƒä»¬ã€‚ BPF ring buffer, io_uring æ‰€ä»¥ ghost æ˜¯è‡ªå·±åšçš„ï¼Œè€Œä¸æ˜¯ç”¨ bpf, io_uring å— Thread-to-queue association. åœ¨ ghOSt çš„ enclave åˆå§‹åŒ–ä¹‹åï¼Œenclaves ä¸­æœ‰ä¸€ä¸ªé»˜è®¤é˜Ÿåˆ—ã€‚ä»£ç†è¿›ç¨‹å¯ä»¥ä½¿ç”¨ CREATE/DESTROY_QUEUE() API åˆ›å»º/é”€æ¯é˜Ÿåˆ—ã€‚æ·»åŠ åˆ° ghOSt çš„çº¿ç¨‹é»˜è®¤è¢«åˆ†é…ä¸ºå‘é»˜è®¤é˜Ÿåˆ—å‘é€æ¶ˆæ¯ã€‚ä»£ç†å¯ä»¥é€šè¿‡ ASSOCIATE_QUEUE()æ”¹å˜è¿™ç§åˆ†é…ã€‚ Queue-to-agent association. é˜Ÿåˆ—å¯ä»¥é…ç½®ä¸ºå½“æ¶ˆæ¯è¢«ç”Ÿäº§åˆ°é˜Ÿåˆ—æ—¶å”¤é†’ä¸€ä¸ªæˆ–å¤šä¸ªä»£ç†ã€‚ä»£ç†å¯ä»¥é€šè¿‡ CONFIG_QUEUE_WAKEUP()é…ç½®å”¤é†’è¡Œä¸ºã€‚åœ¨æ¯ CPU çš„ä¾‹å­ä¸­ï¼Œæ¯ä¸ªé˜Ÿåˆ—ä¸ä¸€ä¸ª CPU å…³è”ï¼Œå¹¶é…ç½®ä¸ºå”¤é†’ç›¸åº”çš„ä»£ç†ã€‚åœ¨é›†ä¸­å¼ä¾‹å­ä¸­ï¼Œ**é˜Ÿåˆ—ç”±å…¨å±€ä»£ç†è¿ç»­è½®è¯¢ï¼Œå› æ­¤å”¤é†’æ˜¯å¤šä½™çš„ï¼Œå› æ­¤æ²¡æœ‰é…ç½®ã€‚**æ¶ˆæ¯è¢«ç”Ÿäº§åˆ°é˜Ÿåˆ—å¹¶åœ¨ä»£ç†ä¸­è§‚å¯Ÿåˆ°çš„å»¶è¿Ÿå°†åœ¨ç¬¬ 4.1 èŠ‚ä¸­è®¨è®ºã€‚ ä»£ç†å”¤é†’ä½¿ç”¨æ ‡å‡†çš„å†…æ ¸æœºåˆ¶æ¥å”¤é†’é˜»å¡çš„çº¿ç¨‹ã€‚è¿™æ¶‰åŠè¯†åˆ«è¦å”¤é†’çš„ä»£ç†çº¿ç¨‹ï¼Œå°†å…¶æ ‡è®°ä¸ºå¯è¿è¡Œï¼Œå¯é€‰åœ°å‘ç›®æ ‡ CPU å‘é€ä¸­æ–­ä»¥è§¦å‘é‡æ–°è°ƒåº¦ï¼Œå¹¶æ‰§è¡Œä¸Šä¸‹æ–‡åˆ‡æ¢åˆ°ä»£ç†çº¿ç¨‹ã€‚ è¿™é‡Œæœ‰ä»€ä¹ˆåŠæ³•ç»•è¿‡ä¸­æ–­å’Œä¸Šä¸‹æ–‡åˆ‡æ¢å— Moving threads between queues/CPUs. åœ¨æˆ‘ä»¬çš„æ¯ CPU ä¾‹å­ä¸­ï¼Œä¸ºäº†å®ç° CPU ä¹‹é—´çš„è´Ÿè½½å‡è¡¡å’Œå·¥ä½œçªƒå–ï¼Œä»£ç†å¯ä»¥é€šè¿‡ ASSOCIATE_QUEUE()æ”¹å˜çº¿ç¨‹æ¶ˆæ¯åˆ°é˜Ÿåˆ—çš„è·¯ç”±ã€‚æ­£ç¡®çš„è·¨é˜Ÿåˆ—åˆ°ä»£ç†çš„æ¶ˆæ¯è·¯ç”±åè°ƒå–å†³äºä»£ç†å®ç°ï¼ˆåœ¨ç”¨æˆ·ç©ºé—´ï¼‰ã€‚å¦‚æœä¸€ä¸ªçº¿ç¨‹åœ¨åŸå§‹é˜Ÿåˆ—ä¸­æœ‰å¾…å¤„ç†æ¶ˆæ¯æ—¶ä»ä¸€ä¸ªé˜Ÿåˆ—å…³è”åˆ°å¦ä¸€ä¸ªé˜Ÿåˆ—ï¼Œå…³è”æ“ä½œå°†ä¼šå¤±è´¥ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä»£ç†å¿…é¡»æ’ç©ºåŸå§‹é˜Ÿåˆ—ï¼Œç„¶åå†é‡æ–°å‘å‡º ASSOCIATE_QUEUE()ã€‚ åç¨‹ã€ç”¨æˆ·çº§çº¿ç¨‹æ˜¯å¦‚ä½•å¤„ç†çš„ï¼Ÿ Synchronizing agents with the kernel ä»£ç†æ ¹æ®é€šè¿‡æ¶ˆæ¯è§‚å¯Ÿåˆ°çš„ç³»ç»ŸçŠ¶æ€åšå‡ºè°ƒåº¦å†³ç­– æ¯ä¸ªä»£ç†éƒ½æœ‰ä¸€ä¸ªåºåˆ—å·ï¼Œè®°ä¸º ğ´ğ‘ ğ‘’ğ‘ï¼Œæ¯å½“æœ‰æ¶ˆæ¯è¢«å‘å¸ƒåˆ°ä¸è¯¥ä»£ç†å…³è”çš„é˜Ÿåˆ—æ—¶ï¼Œè¿™ä¸ªåºåˆ—å·å°±ä¼šé€’å¢ã€‚ Exposing sequence numbers via shared memory ghOSt å…è®¸ä»£ç†é€šè¿‡çŠ¶æ€å­—é«˜æ•ˆåœ°è½®è¯¢æœ‰å…³çº¿ç¨‹å’Œ CPU çŠ¶æ€çš„è¾…åŠ©ä¿¡æ¯ï¼Œè¿™äº›çŠ¶æ€å­—è¢«æ˜ å°„åˆ°ä»£ç†çš„åœ°å€ç©ºé—´ä¸­ã€‚ä¸ºäº†ç®€æ´èµ·è§ï¼Œæˆ‘ä»¬åªè®¨è®ºå¦‚ä½•ä½¿ç”¨çŠ¶æ€å­—å‘ä»£ç†æš´éœ²åºåˆ—å· ğ´ğ‘ ğ‘’ğ‘ å’Œ ğ‘‡ğ‘ ğ‘’ğ‘ã€‚å½“å†…æ ¸æ›´æ–°çº¿ç¨‹æˆ–ä»£ç†çš„åºåˆ—å·æ—¶ï¼Œå®ƒä¹Ÿä¼šæ›´æ–°ç›¸åº”çŠ¶æ€å­—ã€‚ç„¶åï¼Œä»£ç†å¯ä»¥ä»å…±äº«æ˜ å°„ä¸­çš„çŠ¶æ€å­—è¯»å–åºåˆ—å·ã€‚ è½®è¯¢çº¿ç¨‹å’Œ CPU çŠ¶æ€ï¼Œé‚£èƒ½ç”¨å¤æ‚ç»“æ„å®ç° epoll å— ","date":"2024-10-07","objectID":"/posts/paper-ghost/:5:1","tags":["Paper Reading"],"title":"Paper Reading: ghOSt: Fast \u0026 Flexible User-Space Delegation of Linux Scheduling","uri":"/posts/paper-ghost/"},{"categories":null,"content":"Agent-to-Kernel Communication We now describe how the agents instruct the kernel which thread to schedule next. Sending scheduling decisions via transactions: Agents send scheduling decisions to the kernel by committing transactions ä»£ç†é€šè¿‡æäº¤äº‹åŠ¡å‘å†…æ ¸å‘é€è°ƒåº¦å†³ç­–ã€‚ä»£ç†å¿…é¡»èƒ½å¤Ÿè°ƒåº¦å…¶æœ¬åœ° CPUï¼ˆæ¯ CPU çš„æƒ…å†µï¼‰ä»¥åŠå…¶ä»–è¿œç¨‹ CPUï¼ˆé›†ä¸­å¼çš„æƒ…å†µï¼‰ã€‚æäº¤æœºåˆ¶å¿…é¡»è¶³å¤Ÿå¿«ï¼Œä»¥æ”¯æŒå¾®ç§’çº§çš„ç­–ç•¥ï¼Œå¹¶ä¸”èƒ½å¤Ÿæ‰©å±•åˆ°æ•°ç™¾ä¸ªæ ¸å¿ƒã€‚ é¡ºä¾¿æä¸€å¥ï¼Œå°†è°ƒåº¦æ¥å£è®¾è®¡ä¸ºå…±äº«å†…å­˜ä¸­çš„äº‹åŠ¡ï¼Œæœªæ¥å¯ä»¥å°†è°ƒåº¦å†³ç­–å¸è½½åˆ°å¯ä»¥è®¿é—®è¯¥å†…å­˜çš„å¤–éƒ¨è®¾å¤‡ä¸Šã€‚ transactions in shared memory å—åˆ°äº‹åŠ¡å†…å­˜[67]å’Œæ•°æ®åº“ç³»ç»Ÿ[68]çš„å¯å‘ï¼Œæˆ‘ä»¬è®¾è®¡äº†è‡ªå·±çš„äº‹åŠ¡ APIï¼Œé€šè¿‡å…±äº«å†…å­˜å®ç°ã€‚è¿™äº›ç³»ç»Ÿæ”¯æŒå¿«é€Ÿçš„åˆ†å¸ƒå¼æäº¤æ“ä½œï¼Œå…·æœ‰åŸå­æ€§è¯­ä¹‰ï¼Œå¹¶ä¸”å¯ä»¥æœ‰å¤šä¸ªæäº¤åŒæ—¶é’ˆå¯¹åŒä¸€ä¸ªè¿œç¨‹èŠ‚ç‚¹ã€‚ghOSt ä»£ç†ä¹Ÿéœ€è¦ç±»ä¼¼çš„å±æ€§ã€‚ ä»£ç†ä½¿ç”¨ TXN_CREATE()è¾…åŠ©å‡½æ•°åœ¨å…±äº«å†…å­˜ä¸­æ‰“å¼€ä¸€ä¸ªæ–°çš„äº‹åŠ¡ã€‚ä»£ç†å†™å…¥è¦è°ƒåº¦çš„çº¿ç¨‹çš„ TID ä»¥åŠè¦è°ƒåº¦çº¿ç¨‹çš„ CPU çš„ IDã€‚åœ¨æ¯ CPU çš„ä¾‹å­ä¸­ï¼Œæ¯ä¸ªä»£ç†åªè°ƒåº¦è‡ªå·±çš„ CPUã€‚å½“äº‹åŠ¡å¡«å†™å®Œæ¯•åï¼Œä»£ç†é€šè¿‡ TXNS_COMMIT()ç³»ç»Ÿè°ƒç”¨å°†å…¶æäº¤ç»™å†…æ ¸ï¼Œè¿™ä¼šè§¦å‘æäº¤è¿‡ç¨‹å¹¶ä¿ƒä½¿å†…æ ¸å‘èµ·ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚å›¾ 3 å±•ç¤ºäº†ä¸€ä¸ªç®€åŒ–çš„ä¾‹å­ã€‚ Group commits: åœ¨é›†ä¸­å¼è°ƒåº¦çš„ä¾‹å­ä¸­ï¼Œä¸ºäº†è®© ghOSt èƒ½å¤Ÿæ‰©å±•åˆ°æ•°ç™¾ä¸ª CPU å’Œæ¯ç§’æ•°åä¸‡æ¬¡çš„äº‹åŠ¡ï¼Œæˆ‘ä»¬å¿…é¡»å‡è½»ç³»ç»Ÿè°ƒç”¨çš„é«˜æ˜‚æˆæœ¬ã€‚æˆ‘ä»¬é€šè¿‡å¼•å…¥ç»„åˆæäº¤æ¥åˆ†æ‘Šäº‹åŠ¡çš„æˆæœ¬ã€‚ç»„åˆæäº¤è¿˜å‡å°‘äº†å‘é€åˆ°å…¶ä»– CPU çš„ä¸­æ–­æ•°é‡ï¼Œç±»ä¼¼äº Caladan [21]çš„åšæ³•ã€‚ä»£ç†é€šè¿‡å°†æ‰€æœ‰äº‹åŠ¡ä¼ é€’ç»™ TXNS_COMMIT()ç³»ç»Ÿè°ƒç”¨æ¥æäº¤å¤šä¸ªäº‹åŠ¡ã€‚è¿™ä¸ªç³»ç»Ÿè°ƒç”¨å°†é«˜æ˜‚çš„å¼€é”€åˆ†æ‘Šåˆ°å¤šä¸ªäº‹åŠ¡ä¸Šã€‚æœ€é‡è¦çš„æ˜¯ï¼Œå®ƒé€šè¿‡ä½¿ç”¨å¤§å¤šæ•°å¤„ç†å™¨ä¸­å­˜åœ¨çš„æ‰¹é‡ä¸­æ–­åŠŸèƒ½æ¥åˆ†æ‘Šå‘é€ä¸­æ–­çš„å¼€é”€ã€‚å†…æ ¸ä¸ä¼šä¸ºæ¯ä¸ªäº‹åŠ¡å‘é€å¤šä¸ªä¸­æ–­ï¼Œè€Œæ˜¯å‘è¿œç¨‹ CPU å‘é€ä¸€ä¸ªæ‰¹é‡ä¸­æ–­ï¼Œä»è€ŒèŠ‚çœå¤§é‡å¼€é”€ã€‚ è¿™é‡Œçš„äº‹åŠ¡æ˜¯ä¸ºäº†ä»€ä¹ˆï¼Œéš”ç¦»è¿˜æ˜¯å¹¶å‘ï¼Ÿ Sequence numbers and transactions. åœ¨æ¯ CPU çš„ä¾‹å­ä¸­ï¼Œæäº¤äº‹åŠ¡çš„ä»£ç†æ­£åœ¨å°†å…¶ CPU è®©ç»™å®ƒæ­£åœ¨è°ƒåº¦çš„ç›®æ ‡çº¿ç¨‹ã€‚å½“ä»£ç†æ­£åœ¨è¿è¡Œæ—¶ï¼Œé˜Ÿåˆ—ä¸­æ–°å‘å¸ƒçš„æ¶ˆæ¯ä¸ä¼šå¼•èµ·å”¤é†’ï¼Œå› ä¸ºä»£ç†å·²ç»åœ¨è¿è¡Œã€‚ç„¶è€Œï¼Œé˜Ÿåˆ—ä¸­çš„æ–°æ¶ˆæ¯å¯èƒ½æ˜¯æ¥è‡ªä¼˜å…ˆçº§æ›´é«˜çš„çº¿ç¨‹ï¼Œå¹¶ä¸”å¦‚æœä»£ç†çŸ¥é“è¿™ä¸€ç‚¹çš„è¯ï¼Œä¼šå½±å“è°ƒåº¦å†³ç­–ã€‚ä»£ç†åªæœ‰åœ¨ä¸‹æ¬¡å”¤é†’æ—¶æ‰æœ‰æœºä¼šæ£€æŸ¥è¯¥æ¶ˆæ¯ï¼Œè€Œè¿™å·²ç»å¤ªæ™šäº†ã€‚æˆ‘ä»¬ç°åœ¨é€šè¿‡åºåˆ—å·æ¥è§£é‡Šå¦‚ä½•è§£å†³è¿™ä¸€æŒ‘æˆ˜ï¼Œé€‚ç”¨äºæ¯ CPU çš„ä¾‹å­ã€‚é›†ä¸­å¼è°ƒåº¦çš„ç•¥æœ‰ä¸åŒæƒ…å†µå°†åœ¨ç¬¬ 3.3 èŠ‚ä¸­è§£é‡Šã€‚ æˆ‘ä»¬ä½¿ç”¨ä»£ç†åºåˆ—å· ğ´ğ‘ ğ‘’ğ‘ æ¥è§£å†³è¿™ä¸€æŒ‘æˆ˜ã€‚ä»£ç†é€šè¿‡æ£€æŸ¥ä»£ç†çº¿ç¨‹çš„çŠ¶æ€å­—æ¥è½®è¯¢å…¶ ğ´ğ‘ ğ‘’ğ‘ã€‚å›æƒ³ä¸€ä¸‹ï¼Œå½“æ–°çš„æ¶ˆæ¯è¢«å‘å¸ƒåˆ°ä¸ä»£ç†å…³è”çš„é˜Ÿåˆ—æ—¶ï¼Œğ´ğ‘ ğ‘’ğ‘ ä¼šé€’å¢ã€‚æ“ä½œé¡ºåºæ˜¯ï¼š1) è¯»å– ğ´ğ‘ ğ‘’ğ‘ï¼›2) ä»é˜Ÿåˆ—ä¸­è¯»å–æ¶ˆæ¯ï¼›3) åšå‡ºè°ƒåº¦å†³ç­–ï¼›4) å°† ğ´ğ‘ ğ‘’ğ‘ ä¸äº‹åŠ¡ä¸€èµ·å‘é€ç»™ TXNS_COMMIT()ã€‚å¦‚æœä¸äº‹åŠ¡ä¸€èµ·å‘é€çš„ ğ´ğ‘ ğ‘’ğ‘ æ¯”å†…æ ¸è§‚å¯Ÿåˆ°çš„å½“å‰ ğ´ğ‘ ğ‘’ğ‘ æ—§ï¼ˆå³ï¼Œæœ‰æ–°æ¶ˆæ¯è¢«å‘å¸ƒåˆ°ä»£ç†çš„é˜Ÿåˆ—ï¼‰ï¼Œåˆ™äº‹åŠ¡è¢«è®¤ä¸ºæ˜¯â€œè¿‡æœŸâ€çš„ï¼Œå¹¶å°†ä»¥ ESTALE é”™è¯¯å¤±è´¥ã€‚ç„¶åï¼Œä»£ç†å°†æ¸…ç©ºå…¶é˜Ÿåˆ—ä»¥æ£€ç´¢è¾ƒæ–°çš„æ¶ˆæ¯ï¼Œå¹¶é‡å¤è¯¥è¿‡ç¨‹ã€‚ è¿™é‡Œçš„ challenge æ²¡å¤ªç†è§£ï¼Œæ²¡æœ‰å…·ä½“çš„ä¾‹å­ Accelerating scheduling with BPF: ghOSt æä¾›çš„ç”¨æˆ·çº§çµæ´»æ€§å¹¶éæ²¡æœ‰ä»£ä»·ï¼šmessage delivery å’Œ group scheduling æœ€å¤šå¯èƒ½è€—è´¹ 5 å¾®ç§’ï¼ˆå‚è§ç¬¬ 4.1 èŠ‚ä¸­çš„è¡¨ 3ï¼‰ï¼›åœ¨é›†ä¸­å¼è°ƒåº¦æ¨¡å‹ä¸­ï¼Œä¸€ä¸ªçº¿ç¨‹å¯èƒ½è¦ç­‰åˆ°æ•´ä¸ªé›†ä¸­å¼è°ƒåº¦å¾ªç¯ç»“æŸæ‰èƒ½ä¸ºå…¶æäº¤è°ƒåº¦å†³ç­–ï¼ˆåœ¨ç¬¬ 4.4 èŠ‚ä¸­ä¸º 30 å¾®ç§’ï¼‰ã€‚ 5us å’Œ 30us çœ‹ä¸Šå»å¾ˆä½ï¼Œä¸ºä»€ä¹ˆè¯´è¿™æ˜¯ä»£ä»·ï¼Ÿ ","date":"2024-10-07","objectID":"/posts/paper-ghost/:5:2","tags":["Paper Reading"],"title":"Paper Reading: ghOSt: Fast \u0026 Flexible User-Space Delegation of Linux Scheduling","uri":"/posts/paper-ghost/"},{"categories":null,"content":"The Centralized Scheduler One global agent with a single queue: åœ¨é›†ä¸­å¼è°ƒåº¦ä¸­ï¼Œå­˜åœ¨ä¸€ä¸ªå•ä¸€çš„å…¨å±€ä»£ç†è½®è¯¢å•ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¹¶ä¸ºæ‰€æœ‰å— ghOSt ç®¡ç†çš„ CPU åšå‡ºè°ƒåº¦å†³ç­–ã€‚å¦‚æœæŒ‡å®šçš„ CPU ä¸Šå·²ç»è¿è¡Œäº†ä¸€ä¸ª ghOSt çº¿ç¨‹ï¼Œäº‹åŠ¡å°†æŠ¢å ä¹‹å‰çš„çº¿ç¨‹ï¼Œè½¬è€Œè¿è¡Œæ–°çš„çº¿ç¨‹ã€‚ Avoiding preemption of the global agent: ä¸ºäº†æ”¯æŒå¾®ç§’çº§è°ƒåº¦ï¼Œå…¨å±€ä»£ç†å¿…é¡»æŒç»­è¿è¡Œï¼Œå› ä¸ºä»»ä½•æŠ¢å éƒ½ä¼šç›´æ¥å¯¼è‡´è°ƒåº¦å»¶è¿Ÿã€‚ æ€ä¹ˆçŸ¥é“æ˜¯å…¨å±€ä»£ç†ï¼Ÿæœ€é«˜ä¼˜å…ˆçº§ï¼Ÿ Sequence numbers and centralized scheduling: åœ¨æŸäº›æ—¶å€™ï¼Œå…¨å±€ä»£ç†å¯èƒ½å¯¹æŸä¸ªçº¿ç¨‹çš„çŠ¶æ€æœ‰ä¸€ä¸ªä¸ä¸€è‡´çš„è§†å›¾ã€‚ä¾‹å¦‚ï¼Œçº¿ç¨‹ ğ‘‡ å¯èƒ½å‘å¸ƒäº† THREAD_WAKEUP æ¶ˆæ¯ã€‚å…¨å±€ä»£ç†æ¥æ”¶åˆ°è¿™æ¡æ¶ˆæ¯å¹¶å†³å®šåœ¨ ğ¶ğ‘ƒğ‘ˆğ‘“ ä¸Šè°ƒåº¦ ğ‘‡ã€‚ä¸æ­¤åŒæ—¶ï¼Œç³»ç»Ÿä¸­çš„æŸä¸ªå®ä½“è°ƒç”¨äº† sched_setaffinity()ï¼Œå¯¼è‡´å‘å¸ƒäº† THREAD_AFFINITY æ¶ˆæ¯ï¼Œç¦æ­¢ ğ‘‡ åœ¨ ğ¶ğ‘ƒğ‘ˆğ‘“ ä¸Šè¿è¡Œã€‚æˆ‘ä»¬éœ€è¦ä¸€ç§æœºåˆ¶æ¥ç¡®ä¿å°† ğ‘‡ è°ƒåº¦åˆ° ğ¶ğ‘ƒğ‘ˆğ‘“ çš„äº‹åŠ¡ä¼šå¤±è´¥ã€‚ æˆ‘ä»¬é€šè¿‡çº¿ç¨‹åºåˆ—å·æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å›æƒ³ä¸€ä¸‹ï¼Œæ¯ä¸ªæ’é˜Ÿçš„æ¶ˆæ¯ ğ‘€ğ‘‡ éƒ½é™„å¸¦äº†çº¿ç¨‹åºåˆ—å· ğ‘‡ğ‘ ğ‘’ğ‘ï¼Œå½¢å¼ä¸ºï¼ˆğ‘€ğ‘‡, ğ‘‡ğ‘ ğ‘’ğ‘ï¼‰ã€‚å½“ä»£ç†ä¸ºçº¿ç¨‹ ğ‘‡ æäº¤äº‹åŠ¡æ—¶ï¼Œå®ƒä¼šå°†äº‹åŠ¡è¿åŒå®ƒæ‰€çŸ¥çš„æœ€æ–°çº¿ç¨‹åºåˆ—å· ğ‘‡ğ‘ ğ‘’ğ‘ ä¸€èµ·å‘é€ã€‚å½“å†…æ ¸æ¥æ”¶åˆ°äº‹åŠ¡æ—¶ï¼Œå®ƒä¼šéªŒè¯äº‹åŠ¡ä¸­çš„çº¿ç¨‹çš„ ğ‘‡ğ‘ ğ‘’ğ‘ æ˜¯å¦æ˜¯æœ€æ–°çš„ã€‚å¦‚æœä¸æ˜¯ï¼Œäº‹åŠ¡å°†ä»¥ ESTALE é”™è¯¯å¤±è´¥ã€‚ è¿™å°±æ˜¯ç”¨äº‹åŠ¡çš„åŸå› å—ï¼Œé¿å… centralized scheduling å¯¼è‡´ global agent have inconsistent view of a thread state ","date":"2024-10-07","objectID":"/posts/paper-ghost/:5:3","tags":["Paper Reading"],"title":"Paper Reading: ghOSt: Fast \u0026 Flexible User-Space Delegation of Linux Scheduling","uri":"/posts/paper-ghost/"},{"categories":null,"content":"Fault Isolation and Dynamic Upgrades Interaction with other kernel scheduling classes: æˆ‘ä»¬å¸Œæœ›é¿å… ghOSt çº¿ç¨‹å¯¹å…¶ä»–çº¿ç¨‹é€ æˆæ„å¤–åæœï¼Œæ¯”å¦‚é¥¥é¥¿ã€ä¼˜å…ˆçº§åè½¬ã€æ­»é”ç­‰ã€‚ æˆ‘ä»¬é€šè¿‡å°† ghOSt çš„å†…æ ¸è°ƒåº¦ç±»åˆ†é…ä¸€ä¸ªæ¯”é»˜è®¤è°ƒåº¦ç±»ï¼ˆé€šå¸¸æ˜¯ CFSï¼‰æ›´ä½çš„ä¼˜å…ˆçº§æ¥å®ç°è¿™ä¸€ç›®æ ‡ã€‚ç»“æœæ˜¯ï¼Œç³»ç»Ÿä¸­çš„å¤§å¤šæ•°çº¿ç¨‹ä¼šæŠ¢å  ghOSt çº¿ç¨‹ã€‚ghOSt çº¿ç¨‹çš„æŠ¢å ä¼šå¯¼è‡´åˆ›å»ºä¸€ä¸ª THREAD_PREEMPT æ¶ˆæ¯ï¼Œè§¦å‘ç›¸å…³çš„ä»£ç†ï¼ˆè¯¥ä»£ç†è¿è¡Œåœ¨ä¸åŒçš„é«˜ä¼˜å…ˆçº§è°ƒåº¦ç±»ä¸­ï¼‰åšå‡ºè°ƒåº¦å†³ç­–ã€‚ä»£ç†è¿›ä¸€æ­¥å†³å®šå¦‚ä½•å¤„ç†æŠ¢å ã€‚ ghost å¯¼è‡´æ­»é”ã€é¥¥é¥¿ã€ä¼˜å…ˆçº§åè½¬çš„åŸå› æ˜¯ä»€ä¹ˆï¼ŸæŠ¢å ï¼Ÿ Dynamic upgrades and rollbacks. ghOSt é€šè¿‡ä»¥ä¸‹ä¸¤ç§æ–¹å¼ä¹‹ä¸€å®ç°åŠ¨æ€å‡çº§ï¼š (a) æ›¿æ¢ä»£ç†ï¼ŒåŒæ—¶ä¿æŒ enclave åŸºç¡€è®¾æ–½å®Œå¥½ï¼› (b) é”€æ¯ enclave å¹¶é‡æ–°å¼€å§‹ã€‚ æ²¡ç†è§£ï¼Œè¿™è¯´çš„å¤ªç®€å•äº†ï¼Œæ€ä¹ˆæ›¿æ¢ï¼Œæ€ä¹ˆä¿æŒ enclave, enclave ä¹Ÿæ²¡æ„Ÿè§‰å¥½å¥½ä»‹ç»åˆ°åº•æ˜¯ä»€ä¹ˆ ghOSt watchdog. ghOSt æˆ–ä»»ä½•å…¶ä»–å†…æ ¸è°ƒåº¦å™¨ä¸­çš„è°ƒåº¦é”™è¯¯å¯èƒ½æœ‰ç³»ç»ŸèŒƒå›´çš„å½±å“ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ª ghOSt çº¿ç¨‹å¯èƒ½åœ¨æŒæœ‰å†…æ ¸äº’æ–¥é”æ—¶è¢«æŠ¢å ï¼Œå¦‚æœå®ƒé•¿æ—¶é—´æœªè¢«è°ƒåº¦ï¼Œå¯èƒ½ä¼šé—´æ¥åœ°é˜»å¡å…¶ä»–çº¿ç¨‹ï¼ŒåŒ…æ‹¬é‚£äº›åœ¨ CFS æˆ–å…¶ä»– ghOSt é£åœ°ä¸­çš„çº¿ç¨‹ã€‚ç±»ä¼¼åœ°ï¼Œå¦‚æœå…³é”®çº¿ç¨‹ï¼ˆå¦‚åƒåœ¾æ”¶é›†å™¨å’Œ I/O è½®è¯¢å™¨ï¼‰æœªè¢«è°ƒåº¦ï¼Œæœºå™¨å°†é™·å…¥åœæ»ã€‚ä½œä¸ºä¸€ç§å®‰å…¨æœºåˆ¶ï¼ŒghOSt ä¼šè‡ªåŠ¨é”€æ¯è¡Œä¸ºå¼‚å¸¸çš„ä»£ç†é£åœ°ã€‚ä¾‹å¦‚ï¼Œå½“å†…æ ¸æ£€æµ‹åˆ°ä»£ç†åœ¨ç”¨æˆ·å¯é…ç½®çš„æ¯«ç§’æ•°å†…æœªè°ƒåº¦å¯è¿è¡Œçº¿ç¨‹æ—¶ï¼Œä¼šé”€æ¯é£åœ°ã€‚ halt æ‰€ä»¥éœ€è¦ linux æ¥è°ƒåº¦ï¼Ÿè¿˜æ˜¯ ghost æ€ä¹ˆè‡ªåŠ¨é”€æ¯ï¼Œè¿™ä¸ªé…ç½®æ€ä¹ˆè°ƒæ‰åˆé€‚å‘¢ ","date":"2024-10-07","objectID":"/posts/paper-ghost/:5:4","tags":["Paper Reading"],"title":"Paper Reading: ghOSt: Fast \u0026 Flexible User-Space Delegation of Linux Scheduling","uri":"/posts/paper-ghost/"},{"categories":null,"content":"Evaluation æˆ‘ä»¬çš„ ghOSt è¯„ä¼°é›†ä¸­åœ¨ä¸‰ä¸ªé—®é¢˜ä¸Šï¼š (a) ghOSt ç‰¹æœ‰çš„æ“ä½œæœ‰å“ªäº›å¼€é”€ï¼Œè¿™äº›æ“ä½œåœ¨ç»å…¸è°ƒåº¦å™¨ä¸­ä¸å­˜åœ¨ï¼ˆç¬¬ 4.1 èŠ‚ï¼‰ï¼› (b) ä½¿ç”¨ ghOSt å®ç°çš„è°ƒåº¦ç­–ç•¥ä¸å…ˆå‰çš„å·¥ä½œï¼ˆå¦‚ Shinjuku [25]ï¼‰ç›¸æ¯”è¡¨ç°å¦‚ä½•ï¼ˆç¬¬ 4.2 èŠ‚ï¼‰ï¼› (c) ghOSt æ˜¯å¦æ˜¯å¤§è§„æ¨¡å’Œä½å»¶è¿Ÿç”Ÿäº§è´Ÿè½½çš„æœ‰æ•ˆè§£å†³æ–¹æ¡ˆï¼ŒåŒ…æ‹¬ Google Snapï¼ˆç¬¬ 4.3 èŠ‚ï¼‰ã€Google Searchï¼ˆç¬¬ 4.4 èŠ‚ï¼‰å’Œè™šæ‹Ÿæœºï¼ˆç¬¬ 4.5 èŠ‚ï¼‰ï¼Ÿ ç‰¹æœ‰çš„æ“ä½œï¼Œæ¯”å¦‚æ¶ˆæ¯ä¼ é€’ æˆ‘è¿˜æƒ³çœ‹ä¸€ä¸ª evaluation å°±æ˜¯è®ºæ–‡æåˆ°çš„æ­»é”ã€ä¼˜å…ˆçº§åè½¬ï¼Œèƒ½ä¸èƒ½è®¾è®¡ä¸€ä¸ªå®éªŒæ¥å¤ç°ï¼Œè§‚å¯Ÿä¸€ä¸‹å›é€€å¯¼è‡´çš„é—®é¢˜ ","date":"2024-10-07","objectID":"/posts/paper-ghost/:6:0","tags":["Paper Reading"],"title":"Paper Reading: ghOSt: Fast \u0026 Flexible User-Space Delegation of Linux Scheduling","uri":"/posts/paper-ghost/"},{"categories":null,"content":"Analysis of ghOSt Overheads and Scaling LOC: ghOSt å·²å‡†å¤‡å¥½ç”¨äºç”Ÿäº§ï¼Œå¹¶ä¸”æ”¯æŒæˆ‘ä»¬ç”Ÿäº§è´Ÿè½½çš„ä¸€ç³»åˆ—è°ƒåº¦ç­–ç•¥ï¼Œæ¯” CFS å°‘ 40%çš„å†…æ ¸ä»£ç ã€‚ Experimental Setup: å®éªŒåœ¨ Linux 4.15 ä¸Šè¿è¡Œ 4.15 æ˜¯æ¯”è¾ƒè€çš„ï¼Œ19 å¹´ 5.0 å‘å¸ƒï¼Œ21 å¹´åº”è¯¥ 5.15 ä¹Ÿå‘å¸ƒäº†ï¼Œ24 å¹´ç°åœ¨æ˜¯ 6.12ï¼Œåœ¨ 6.6 å¼•å…¥äº†æ–°çš„ EEVDF process scheduler(Earliest eligible virtual deadline first scheduling) æ›¿ä»£ CFSï¼Œæ¯•ç«Ÿ CFS æ˜¯å¾ˆè€äº† https://lwn.net/Articles/925371/ An EEVDF CPU scheduler for Linux CFS è¿½è¸ªäº†æ¯ä¸ªè¿›ç¨‹è·å¾—çš„æ—¶é—´ï¼Œå®ç°å…¬å¹³è°ƒåº¦ EEVDF æå‡ºæ›´å¤šæ¥è§£å†³ä¸€äº›çº¦æŸï¼Œæ¯”å¦‚æœ€å¤§é™åº¦åˆ©ç”¨ç³»ç»Ÿçš„å†…å­˜ç¼“å­˜ï¼Œæœ€å°åŒ–è¿›ç¨‹åœ¨ CPU ä¹‹é—´çš„ç§»åŠ¨ è®©æ‰€æœ‰ CPU ä¿æŒå¿™ç¢Œ ä½†æœ‰ç§æƒ…å†µï¼šæœ‰äº›è¿›ç¨‹ä¸éœ€è¦å¾ˆå¤š CPU time ä½†æ˜¯ç¡®å®éœ€è¦ï¼Œæ˜¯ä¸€ç§ latency requirements æ‰€ä»¥éœ€è¦ä¼˜å…ˆçº§ï¼Œä½†è¿™æ˜¯ç‰¹æƒæ“ä½œï¼Ÿ å¯¹äºæ¯ä¸ªè¿›ç¨‹ï¼ŒEEVDF è®¡ç®—è¯¥è¿›ç¨‹åº”è¯¥è·å¾—çš„æ—¶é—´ä¸å®é™…è·å¾—çš„æ—¶é—´ä¹‹é—´çš„å·®å¼‚; è¿™ç§å·®å¼‚ç§°ä¸ºâ€œæ»åâ€ã€‚ æ˜¯ä¸ºäº†è§£å†³ CFS çš„ä¸€äº›å¯å‘å¼è¡¥ä¸å—ï¼Ÿ Message delivery overhead: åœ¨æ¯ CPU çš„ä¾‹å­ä¸­ï¼Œå‘æœ¬åœ°ä»£ç†ä¼ é€’æ¶ˆæ¯åŒ…æ‹¬å°†æ¶ˆæ¯æ·»åŠ åˆ°é˜Ÿåˆ—ã€ä¸Šä¸‹æ–‡åˆ‡æ¢åˆ°æœ¬åœ°ä»£ç†ä»¥åŠä»é˜Ÿåˆ—ä¸­ç§»é™¤æ¶ˆæ¯ã€‚å¼€é”€ï¼ˆ725 çº³ç§’ï¼‰ä¸»è¦ç”±ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼ˆ410 çº³ç§’ï¼‰ä¸»å¯¼ã€‚åœ¨é›†ä¸­å¼ä¾‹å­ä¸­ï¼Œå‘å…¨å±€ä»£ç†ä¼ é€’æ¶ˆæ¯ï¼ˆ265 çº³ç§’ï¼‰åŒ…æ‹¬å°†æ¶ˆæ¯æ·»åŠ åˆ°é˜Ÿåˆ—å¹¶åœ¨å…¨å±€ä»£ç†ä¸­ç§»é™¤æ¶ˆæ¯ï¼Œå…¨å±€ä»£ç†å§‹ç»ˆå¤„äºè‡ªæ—‹çŠ¶æ€ã€‚ Local scheduling: åœ¨æ¯ CPU æ¨¡å‹ä¸­ï¼Œè¿™æ˜¯æäº¤äº‹åŠ¡å¹¶åœ¨æœ¬åœ° CPU ä¸Šæ‰§è¡Œä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œç›´åˆ°ç›®æ ‡çº¿ç¨‹è¿è¡Œçš„å¼€é”€ã€‚å¼€é”€ï¼ˆ888 çº³ç§’ï¼‰ç•¥é«˜äº CFS ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€ï¼ˆ599 çº³ç§’ï¼‰ï¼Œä¸»è¦æ˜¯ç”±äºäº‹åŠ¡æäº¤ï¼Œä½†ä»å…·æœ‰ç«äº‰åŠ›ã€‚ äº‹åŠ¡å¸¦æ¥äº†ä¸€äº›é—®é¢˜ Remote scheduling: åœ¨é›†ä¸­å¼è°ƒåº¦æ¨¡å‹ä¸­ï¼Œä»£ç†ç«¯æäº¤äº‹åŠ¡å¹¶å‘é€è·¨å¤„ç†å™¨ä¸­æ–­ï¼ˆIPIï¼‰ã€‚ç›®æ ‡ CPU å¤„ç† IPI å¹¶æ‰§è¡Œä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚ä»£ç†çš„å¼€é”€ï¼ˆ668 çº³ç§’ï¼‰è®¾å®šäº†æ¯ä¸ªä»£ç†æ¯ç§’ 1.5M å¯è°ƒåº¦çº¿ç¨‹çš„ç†è®ºæœ€å¤§ååé‡ã€‚å°† 10 ä¸ªä¸åŒ CPU çš„äº‹åŠ¡ç»„åˆèµ·æ¥ï¼Œé€šè¿‡åˆ†æ‘Š IPI å¼€é”€ï¼Œç†è®ºæœ€å¤§å€¼æé«˜åˆ° 10 * 10^9 / 3964 = 2.52M æ¯ç§’å¯è°ƒåº¦çº¿ç¨‹ã€‚æ ¹æ®è¿™äº›æ•°å­—ï¼Œå•ä¸ªä»£ç†ç†è®ºä¸Šå¯ä»¥åœ¨ 100 ä¸ª CPU çš„æœåŠ¡å™¨ä¸Šæ¯ç§’è°ƒåº¦å¤§çº¦ 25,200 ä¸ªçº¿ç¨‹ã€‚å¦‚æœçº¿ç¨‹é•¿åº¦ä¸º 40 å¾®ç§’ï¼Œä»£ç†å¯ä»¥ä¿æŒ 100 ä¸ª CPU å¿™ç¢Œã€‚policy å¼€å‘è€…åœ¨è®¾è®¡ ghOSt ç­–ç•¥æ—¶åº”è€ƒè™‘æ¯ä¸ªä»£ç†çš„å¯æ‰©å±•æ€§é™åˆ¶ã€‚éšç€æ›´å¤šä»£ç†çš„åŠ å…¥ï¼Œè¿™ä¸€é™åˆ¶ç›¸å¯¹çº¿æ€§åœ°æ”¹å–„ã€‚ è¿™ä¸ª inter-processor interrupt (IPI) ä¼šäº§ç”Ÿä»€ä¹ˆé—®é¢˜å— Global agent scalability (Fig. 5). To show how a global agent scales, we analyze a simple round-robin policy. ","date":"2024-10-07","objectID":"/posts/paper-ghost/:6:1","tags":["Paper Reading"],"title":"Paper Reading: ghOSt: Fast \u0026 Flexible User-Space Delegation of Linux Scheduling","uri":"/posts/paper-ghost/"},{"categories":null,"content":"Comparison to Custom Centralized Schedulers Systems under comparison. We compared three implementations of the scheduling approach in Shinjuku [25], all serving a RocksDB workload [70]. We use one physical core for load generation with all systems. The Shinjuku system runs on Linux 4.4 as its Dune [35] driver fails to compile for newer versions. The other systems under comparison (ghOSt-Shinjuku and CFS-Shinjuku) run on Linux 4.15 with our ghOSt patches applied. RocksDB workloadï¼Œè¿™ä¸ªæœ‰æ„æ€ Single Workload Comparison: 99.5% of requests - 4 ğœ‡s, 0.5% of requests - 10 ms. åæ˜ äº† ghOSt åœ¨è°ƒåº¦æ¯ä¸ªè¯·æ±‚çš„çº¿ç¨‹æ—¶çš„é¢å¤–å¼€é”€ï¼Œè€Œ Shinjuku åˆ™åœ¨è‡ªæ—‹çº¿ç¨‹ä¹‹é—´ä¼ é€’è¯·æ±‚æè¿°ç¬¦ã€‚ç”±äºç¼ºä¹æŠ¢å ï¼ŒCFS-Shinjuku æ¯”å…¶ä»–ä¸¤ä¸ªç³»ç»Ÿæ—©çº¦ 30%è¾¾åˆ°é¥±å’Œã€‚ æ²¡çœ‹æ‡‚è¿™ä¸ªæ•°æ®é›†ã€‚å®éªŒç»“æœè¿˜æ˜¯çº¯ shinjuku æ¯”è¾ƒå¥½ï¼Ÿæ˜¯å› ä¸ºè°ƒåº¦å’Œæ¶ˆæ¯ä¼ é€’çš„å¼€é”€å—ã€‚ Multiple Workloads Comparison: å›¾ 6c æ˜¾ç¤ºï¼Œå½“æˆ‘ä»¬æŠŠä¸€ä¸ªæ‰¹å¤„ç†åº”ç”¨ç¨‹åºä¸ç”± Shinjuku ç®¡ç†çš„ RocksDB å·¥ä½œè´Ÿè½½å…±ç½®æ—¶ï¼Œå³ä½¿ RocksDB è´Ÿè½½è¾ƒä½ï¼Œæ‰¹å¤„ç†åº”ç”¨ç¨‹åºä¹Ÿæ— æ³•è·å¾—ä»»ä½• CPU èµ„æºã€‚ ä¸ºäº†å®ç°ä½å»¶è¿Ÿå’Œæ‰¹å¤„ç†å·¥ä½œè´Ÿè½½çš„å®‰å…¨å…±ç½®ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨é¢å‘çº¿ç¨‹çš„é›†ä¸­å¼è°ƒåº¦ç³»ç»Ÿï¼Œå¦‚ Shenango [1]ã€‚Shenango çš„é›†ä¸­å¼è°ƒåº¦å™¨ç›‘æ§ç½‘ç»œåº”ç”¨ç¨‹åºçš„è´Ÿè½½ï¼Œå½“åº”ç”¨ç¨‹åºè´Ÿè½½è¾ƒè½»æ—¶ï¼Œè°ƒåº¦å™¨å°†å¤šä½™çš„ CPU å‘¨æœŸåˆ†é…ç»™æ‰¹å¤„ç†åº”ç”¨ç¨‹åºã€‚ç„¶è€Œï¼ŒShenango ä¸é€‚åˆå¤„ç†æ‰§è¡Œæ—¶é—´å˜åŒ–è¾ƒå¤§çš„è¯·æ±‚ï¼Œå› æ­¤ RocksDB å·¥ä½œè´Ÿè½½çš„å°¾éƒ¨å»¶è¿Ÿä¼šè¿œé«˜äº Shinjukuã€‚ å°†å¤šä½™çš„ CPU å‘¨æœŸåˆ†é…ç»™æ‰¹å¤„ç†åº”ç”¨ç¨‹åº shinjuku çš„ç¼ºç‚¹ä½¿ç”¨ ghost å¯ä»¥è§£å†³ ","date":"2024-10-07","objectID":"/posts/paper-ghost/:6:2","tags":["Paper Reading"],"title":"Paper Reading: ghOSt: Fast \u0026 Flexible User-Space Delegation of Linux Scheduling","uri":"/posts/paper-ghost/"},{"categories":null,"content":"Google Snap ç±»ä¼¼äº DPDK [72]ï¼ŒSnap ç»´æŠ¤äº†è½®è¯¢ï¼ˆå·¥ä½œï¼‰çº¿ç¨‹ï¼Œè´Ÿè´£ä¸ NIC ç¡¬ä»¶çš„äº¤äº’ï¼Œå¹¶ä»£è¡¨é‡è¦æœåŠ¡è¿è¡Œè‡ªå®šä¹‰çš„ç½‘ç»œå’Œå®‰å…¨åè®®ã€‚Snap å¯èƒ½ä¼šæ ¹æ®ç½‘ç»œè´Ÿè½½çš„å˜åŒ–å†³å®šç”Ÿæˆæˆ–åˆå¹¶å·¥ä½œçº¿ç¨‹ã€‚ How are worker threads scheduled today? å’Œ Snap çš„å¯¹æ¯”ï¼Œæ„Ÿè§‰ ghost å°±æ˜¯ç”¨æ¥å¢å¼º snap çš„ åœ¨ 64B æƒ…å†µä¸‹ å› æ­¤ï¼Œå½“æµé‡çªå‘ä¸”åŒ…å«å¤§é‡ 64B æ¶ˆæ¯æ—¶ï¼ŒghOSt çš„è°ƒåº¦äº‹ä»¶å¼€é”€å˜å¾—æ˜æ˜¾ã€‚å¯¹äº 64KB æ¶ˆæ¯ï¼ŒghOSt åœ¨ 99 ç™¾åˆ†ä½å»¶è¿Ÿä»¥å†…è¡¨ç°ä¸åŸºçº¿ç›¸ä¼¼ï¼ˆåœ¨ 15%èŒƒå›´å†…ï¼‰ã€‚å¯¹äº 99.9 ç™¾åˆ†ä½åŠä»¥ä¸Šï¼ŒghOSt çš„å°¾å»¶è¿Ÿæ¯”åŸºçº¿ä½ 5%åˆ° 30%ã€‚64KB æ¶ˆæ¯éœ€è¦æ›´å¤šçš„å¤„ç†ï¼ˆç”¨äºå¤åˆ¶æ•°æ®ï¼‰ï¼Œå› æ­¤å¯¼è‡´è¾ƒå°‘çš„è°ƒåº¦äº‹ä»¶ã€‚ghOSt åœ¨æŸäº›æƒ…å†µä¸‹è¡¨ç°ä¼˜äº MicroQuanta çš„åŸå› æ˜¯å®ƒå¯ä»¥åœ¨çº¿ç¨‹å¯ç”¨æ—¶é‡æ–°å®šä½å·¥ä½œçº¿ç¨‹ã€‚ å…¶å®çœ‹ä¸å¤ªæ‡‚è¿™ä¸ªå¯¹æ¯”ï¼Œæ˜¯è¯´ p99999 çš„è¡¨ç°æ›´å¥½å— ä½†æ˜¯è¿™ä¹Ÿå¤ªä¸¥æ ¼äº†ï¼Œåªæœ‰ 0.001% çš„è¯·æ±‚è¶…è¿‡äº†å»¶è¿Ÿï¼Ÿp99 å…¶å®éƒ½å·®ä¸å¤šï¼Œä½†æ˜¯ p999 å¥½ä¸€ç‚¹ ","date":"2024-10-07","objectID":"/posts/paper-ghost/:6:3","tags":["Paper Reading"],"title":"Paper Reading: ghOSt: Fast \u0026 Flexible User-Space Delegation of Linux Scheduling","uri":"/posts/paper-ghost/"},{"categories":null,"content":"Google Search ä¸»è¦æ˜¯å°¾å»¶è¿Ÿï¼Œtail latency è¡¨ç°å¾ˆä¸é”™å°±ä¸çœ‹äº† QPSã€ååé‡å’Œ CFS æ²¡å¤ªå·® ","date":"2024-10-07","objectID":"/posts/paper-ghost/:6:4","tags":["Paper Reading"],"title":"Paper Reading: ghOSt: Fast \u0026 Flexible User-Space Delegation of Linux Scheduling","uri":"/posts/paper-ghost/"},{"categories":null,"content":"Protecting VMs from L1TF/MDS Attacks è¿™ä¸€ç« æ²¡ç†è§£ï¼Œæ€ä¹ˆçªç„¶å¤šä¸€ä¸ªå®‰å…¨æµ‹è¯• ä½¿ç”¨ä¸‰ç§è°ƒåº¦ç­–ç•¥ï¼š1) CFSï¼Œä¸æä¾›å¯¹æ¨æµ‹æ‰§è¡Œæ”»å‡»çš„ä¿æŠ¤ï¼›2) å†…æ ¸ä¸­çš„å®‰å…¨è™šæ‹Ÿæœºæ ¸å¿ƒè°ƒåº¦ï¼›3) ghOSt ä¸­çš„å®‰å…¨è™šæ‹Ÿæœºæ ¸å¿ƒè°ƒåº¦ã€‚ç»“æœå¦‚è¡¨ 4 æ‰€ç¤ºã€‚CFS æä¾›äº†æ›´å¥½çš„æ•´ä½“æ€§èƒ½ï¼Œä½†æ²¡æœ‰ä»»ä½•å®‰å…¨æ€§ã€‚ghOSt ç­–ç•¥ç¼“è§£äº†è·¨è¶…çº¿ç¨‹æ”»å‡»ï¼Œå¹¶ä¸”åœ¨è€ƒè™‘ ghOSt ä¸­çš„é¢å¤–ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€çš„æƒ…å†µä¸‹ï¼Œæ€§èƒ½ä¸å†…æ ¸ä¸­çš„æ ¸å¿ƒè°ƒåº¦ç‰ˆæœ¬ç›¸å½“ã€‚ ä¸»è¦æ˜¯å‰æ–‡åªæ˜¯ç¨å¾®æäº†ä¸€ä¸‹å®‰å…¨ã€éš”ç¦»ï¼Œä½†æ˜¯å®ç°è®²çš„æ¯”è¾ƒæ¨¡ç³Š ","date":"2024-10-07","objectID":"/posts/paper-ghost/:6:5","tags":["Paper Reading"],"title":"Paper Reading: ghOSt: Fast \u0026 Flexible User-Space Delegation of Linux Scheduling","uri":"/posts/paper-ghost/"},{"categories":null,"content":"Future Work Accelerating scheduling with BPFï¼šé€šè¿‡å°†ä¸€äº›ä»£ç†èŒè´£å§”æ‰˜ç»™åŒæ­¥ BPF å›è°ƒæ¥åŠ é€Ÿ ghOSt æ˜¯ä¸€ä¸ªå¼€æ”¾çš„ç ”ç©¶é¢†åŸŸã€‚åœ¨Â§4.4 ä¸­ï¼Œå…¨å±€ä»£ç†çš„è°ƒåº¦å¾ªç¯è€—æ—¶ 30 å¾®ç§’ï¼Œè¿™å¯èƒ½å¯¼è‡´è°ƒåº¦é—´éš™ã€‚å®é™…ä¸Šï¼Œç³»ç»Ÿä¸­çš„ä¸€äº›çº¿ç¨‹åœ¨é˜»å¡ä¹‹å‰åªè¿è¡Œ 5-30 å¾®ç§’ï¼Œå¯¼è‡´è¿™äº›é—´éš™æœŸé—´ CPU ç©ºé—²ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Â§3.2 ä¸­æè¿°çš„é›†æˆ BPF ç¨‹åºæ¥ç¼“è§£è¿™äº›è°ƒåº¦é—´éš™ã€‚ BPF ç¨‹åºé€šè¿‡å…±äº«å†…å­˜ä¸ç”¨æˆ·ç©ºé—´é€šä¿¡ï¼Œä½¿ç”¨å¤šä¸ªå¤šç”Ÿäº§è€…ã€å¤šæ¶ˆè´¹è€…ç¯å½¢ç¼“å†²åŒºã€‚ä»£ç†å°†å¯è¿è¡Œçš„çº¿ç¨‹æ’å…¥è¿™äº›ç¼“å†²åŒºï¼ŒBPF å°è¯•è¿è¡Œå®ƒä»¬ã€‚ä»£ç†å¯ä»¥åœ¨ BPF è°ƒåº¦çº¿ç¨‹ä¹‹å‰æ’¤é”€çº¿ç¨‹ã€‚ä¾‹å¦‚ï¼Œå…¨å±€ä»£ç†å¯ä»¥ä¸ºæ¯ä¸ª NUMA èŠ‚ç‚¹ä½¿ç”¨ä¸€ä¸ªç¯å½¢ç¼“å†²åŒºï¼›å…¨å±€ä»£ç†å¯ä»¥è·Ÿè¸ªæ¯ä¸ªçº¿ç¨‹çš„é¦–é€‰ NUMA èŠ‚ç‚¹ï¼Œå¹¶åœ¨ä¸¤ä¸ªç¯ä¹‹é—´è¿›è¡Œè´Ÿè½½å‡è¡¡ã€‚ èƒ½ç”¨ bpf æ¥ bypass ä¸€äº›ä¸Šä¸‹æ–‡åˆ‡æ¢å—ï¼Ÿ Tick-less scheduling å½“ ghOSt å¤„äºé›†ä¸­æ¨¡å¼æ—¶ï¼Œå¯ä»¥ç¦ç”¨æ‰€æœ‰ CPU ä¸Šçš„å®šæ—¶å™¨æ»´ç­”ï¼Œä»¥é¿å…åœ¨è™šæ‹Ÿæœºå·¥ä½œè´Ÿè½½ä¸­å‡ºç°æ˜‚è´µçš„ VM é€€å‡ºã€‚åœ¨ç»å…¸çš„æ¯ä¸ª CPU è°ƒåº¦å™¨ä¸­ï¼Œæ»´ç­”æ¯æ¯«ç§’è§¦å‘ä¸€æ¬¡è°ƒåº¦å™¨ï¼Œä»¥ç¡®ä¿æ‰€æœ‰è™šæ‹Ÿæœºä¹‹é—´çš„è½®è½¬æŠ¢å ã€‚ä¸å¹¸çš„æ˜¯ï¼Œè¿™äº›æ»´ç­”ä¼šå¯¼è‡´è™šæ‹Ÿæœºé€€å‡ºåˆ°ä¸»æœºå†…æ ¸ä¸Šä¸‹æ–‡ã€‚ è¿™ä¸ªå®Œå…¨çœ‹ä¸æ‡‚ ","date":"2024-10-07","objectID":"/posts/paper-ghost/:7:0","tags":["Paper Reading"],"title":"Paper Reading: ghOSt: Fast \u0026 Flexible User-Space Delegation of Linux Scheduling","uri":"/posts/paper-ghost/"},{"categories":null,"content":"Related Work ","date":"2024-10-07","objectID":"/posts/paper-ghost/:8:0","tags":["Paper Reading"],"title":"Paper Reading: ghOSt: Fast \u0026 Flexible User-Space Delegation of Linux Scheduling","uri":"/posts/paper-ghost/"},{"categories":null,"content":"Conclusion ","date":"2024-10-07","objectID":"/posts/paper-ghost/:9:0","tags":["Paper Reading"],"title":"Paper Reading: ghOSt: Fast \u0026 Flexible User-Space Delegation of Linux Scheduling","uri":"/posts/paper-ghost/"},{"categories":null,"content":"Ens Ì„o: A Streaming Interface for NIC-Application Communication NIC interface ç›¸å…³çš„è®ºæ–‡ï¼Œhardware offloads, steaming interface 2023 OSDI best paperï¼Œæˆ‘è¯»èµ·æ¥è§‰å¾—å¾ˆå›°éš¾ï¼Œå°¤å…¶æ˜¯ä¸ç†è§£å…¶ä¸­çš„ä¸€äº›è®¾è®¡ï¼Œè¿™ç¯‡è®ºæ–‡å·¥ä½œé‡åº”è¯¥æ˜¯éå¸¸é«˜çš„ï¼Œå€¼å¾—å¥½å¥½è¯» ä¹‹å‰çœ‹å¾—éƒ½æ˜¯ kernel bypass (XDP, DPDK) åˆæˆ–è€…æ˜¯ NIC offloadï¼Œä½† NIC åˆ° è½¯ä»¶ çš„ç¼“å†²åŒºå’ŒåŒ…ä¼ é€’å…¶å®ä¹Ÿå­˜åœ¨ç“¶é¢ˆ æ ¸å¿ƒæ€æƒ³æ˜¯å›ºå®šå¤§å°çš„åŒ…ç¼“å†²åŒºå˜æˆäº†æµç¼“å†²åŒºï¼Œçœå»äº† metadata ä¼ è¾“ç­‰ç­‰ï¼Œå¯¹äºå°åŒ…ä¼ è¾“å¸¦å®½æå‡æ˜æ˜¾ï¼Œenso ç”¨å•æ ¸å°±èƒ½è·‘åˆ°å¾ˆé«˜çš„å¸¦å®½ 2023 å¹´æ“ä½œç³»ç»Ÿè®¾è®¡ä¸å®ç°ç ”è®¨ä¼šï¼ˆOSDIï¼‰æœ‰å“ªäº›å€¼å¾—å…³æ³¨çš„æ–‡ç« ï¼Ÿ - ChenKuGai çš„å›ç­” - çŸ¥ä¹ https://www.zhihu.com/question/591516372/answer/3506857114 çŸ¥ä¹çš„è§£ç­”å¾ˆä¸é”™ ","date":"2024-09-30","objectID":"/posts/paper-enso/:1:0","tags":["Paper Reading"],"title":"Paper Reading: Enso: A Streaming Interface for NIC-Application Communication (OSDI2023)","uri":"/posts/paper-enso/"},{"categories":null,"content":"Abstract ä»Šå¤©ï¼Œç½‘å¡å’Œè½¯ä»¶ä¹‹é—´çš„å¤§å¤šæ•°é€šä¿¡éƒ½æ¶‰åŠåˆ°äº¤æ¢å›ºå®šå¤§å°çš„æ•°æ®åŒ…ç¼“å†²åŒºã€‚è¿™ç§åˆ†ç»„æ¥å£æ˜¯ä¸ºä¸€ä¸ªæ—¶ä»£è€Œè®¾è®¡çš„ï¼Œå½“æ—¶ NIC å®ç°äº†å¾ˆå°‘çš„å¸è½½ï¼Œè½¯ä»¶å®ç°äº†åœ¨åº”ç”¨ç¨‹åºæ•°æ®å’Œæ•°æ®åŒ…ä¹‹é—´è¿›è¡Œè½¬æ¢çš„é€»è¾‘ã€‚ç„¶è€Œï¼ŒNIC å’Œç½‘ç»œè½¯ä»¶éƒ½å·²ç»å‘å±•: ç°ä»£ NIC å®ç°äº†ç¡¬ä»¶å¸è½½ï¼Œä¾‹å¦‚ TSOã€ LRO å’Œåºåˆ—åŒ–å¸è½½ï¼Œå¯ä»¥æ›´æœ‰æ•ˆåœ°åœ¨åº”ç”¨ç¨‹åºæ•°æ®å’Œæ•°æ®åŒ…ä¹‹é—´è¿›è¡Œè½¬æ¢ã€‚æ­¤å¤–ï¼Œç°ä»£è½¯ä»¶è¶Šæ¥è¶Šå¤šåœ°æ‰¹å¤„ç†ç½‘ç»œ I/Oï¼Œä»¥å‡å°‘å¼€é”€ã€‚è¿™äº›å˜åŒ–å¯¼è‡´äº†åˆ†ç»„æ¥å£(å‡è®¾ç½‘å¡å’Œè½¯ä»¶äº¤æ¢å›ºå®šå¤§å°çš„ç¼“å†²åŒº)ä¸ç°ä»£ç½‘å¡æä¾›å¹¶ç”±ç°ä»£è½¯ä»¶ä½¿ç”¨çš„ç‰¹æ€§ä¹‹é—´çš„ä¸åŒ¹é…ã€‚æ¥å£å’Œæ•°æ®ä¹‹é—´çš„è¿™ç§ä¸ä¸€è‡´æ€§å¢åŠ äº†è½¯ä»¶å¤æ‚æ€§å’Œ I/O å¼€é”€ï¼Œä»è€Œé™åˆ¶äº†é€šä¿¡æ€§èƒ½ã€‚æœ¬æ–‡æå‡ºäº†ä¸€ç§æ–°çš„æµå¼ NIC-to-software æ¥å£ Ens oï¼Œæ—¨åœ¨æ›´å¥½åœ°æ”¯æŒå½“ä»Š NIC å’Œè½¯ä»¶çš„äº¤äº’æ–¹å¼ã€‚åœ¨å…¶æ ¸å¿ƒï¼ŒEns o é¿å…å›ºå®šå¤§å°çš„ç¼“å†²åŒºï¼Œè€Œæ˜¯å°†é€šä¿¡ç»“æ„è®¾è®¡ä¸ºä¸€ä¸ªæµï¼Œå¯ç”¨äºå‘é€ä»»æ„å¤§å°çš„æ•°æ®ã€‚æˆ‘ä»¬å±•ç¤ºäº†è¿™ä¸ªæ›´æ”¹å‡å°‘äº†è½¯ä»¶å¼€é”€ï¼Œé™ä½äº† PCIe å¸¦å®½éœ€æ±‚ï¼Œå¹¶å¯¼è‡´æ›´å°‘çš„ç¼“å­˜ä¸¢å¤±ã€‚è¿™äº›æ”¹è¿›ä½¿å¾—åŸºäº Ens o çš„ç½‘å¡èƒ½å¤Ÿåœ¨ 100Gbps çš„é“¾è·¯ä¸Šä½¿ç”¨å•ä¸ªæ ¸å¿ƒçš„æœ€å°æ•°æ®åŒ…(è½¬å‘é€Ÿåº¦ä¸º 148.8 Mpps) ï¼Œæé«˜é«˜æ€§èƒ½ç½‘ç»œåº”ç”¨çš„ååé‡ 1.5-6 å€ï¼Œé™ä½å»¶è¿Ÿé«˜è¾¾ 43% hardware offloads, serialization offloads é¿å…å›ºå®šå¤§å°çš„ç¼“å†²åŒº ","date":"2024-09-30","objectID":"/posts/paper-enso/:2:0","tags":["Paper Reading"],"title":"Paper Reading: Enso: A Streaming Interface for NIC-Application Communication (OSDI2023)","uri":"/posts/paper-enso/"},{"categories":null,"content":"Introduction NIC offloads allow the NIC to perform common tasks (e.g., segmentation) previously implemented in software; æ›´é«˜æ•ˆçš„ç½‘ç»œ I/O åº“å’Œæ¥å£ï¼ŒåŒ…æ‹¬ DPDK å’Œ XDPï¼Œå…è®¸åº”ç”¨ç¨‹åºå‡å°‘ç½‘ç»œæ ˆçš„å¤„ç† å¤§å¤šæ•° NIC ç›®å‰æä¾›äº†ä¸€ä¸ªæ¥å£ï¼Œå…¶ä¸­æ‰€æœ‰è½¯ä»¶å’Œ NIC ä¹‹é—´çš„é€šä¿¡éƒ½éœ€è¦å‘é€ï¼ˆå’Œæ¥æ”¶ï¼‰ä¸€ç³»åˆ—å›ºå®šå¤§å°çš„ç¼“å†²åŒºï¼Œæˆ‘ä»¬åœ¨æœ¬æ–‡ä¸­ç§°ä¹‹ä¸ºæ•°æ®åŒ…ç¼“å†²åŒºã€‚ é¦–å…ˆï¼Œè®¸å¤š NIC å¸è½½ï¼Œå¦‚ TCP åˆ†æ®µå¸è½½ï¼ˆTSOï¼‰[20, 39]ã€å¤§æ¥æ”¶å¸è½½ï¼ˆLROï¼‰[14]ã€åºåˆ—åŒ–å¸è½½[44, 71, 86]å’Œä¼ è¾“å¸è½½[3, 14, 27, 77]ï¼Œå®ƒä»¬çš„è¾“å…¥ï¼ˆå’Œè¾“å‡ºï¼‰å¯ä»¥è·¨è¶Šå¤šä¸ªæ•°æ®åŒ…å¹¶ä¸”å¤§å°ä¸ä¸€ã€‚åœ¨ä½¿ç”¨è¿™äº›å¸è½½ä¸æ•°æ®åŒ…åŒ–æ¥å£æ—¶ï¼Œè½¯ä»¶åœ¨ä¸ NIC é€šä¿¡æ—¶å¿…é¡»ä¸å¿…è¦åœ°å°†æ•°æ®åˆ†å‰²ï¼ˆå’Œé‡æ–°ç»„åˆï¼‰åˆ°å¤šä¸ªæ•°æ®åŒ…ç¼“å†²åŒºä¸­ã€‚ Packetized abstraction: å°½ç®¡åœ¨è½¯ä»¶å§‹ç»ˆéœ€è¦äº¤æ¢ MTU å¤§å°çš„æ•°æ®åŒ…æ—¶ï¼Œé‡‡ç”¨å›ºå®šå¤§å°çš„ç¼“å†²åŒºæ•ˆæœåˆç†ï¼Œä½†åœ¨ä½¿ç”¨æ›´é«˜çº§åˆ«çš„æŠ½è±¡ï¼ˆå¦‚åº”ç”¨ç¨‹åºçº§æ¶ˆæ¯ï¼ˆä¾‹å¦‚ï¼ŒRPCï¼‰ã€å­—èŠ‚æµï¼‰æˆ–æ›´ç®€å•çš„å¸è½½ï¼ˆå¦‚ LROï¼‰æ—¶ï¼Œå®ƒå˜å¾—ç¬¨æ‹™ã€‚ Poor cache interaction: ç”±äºæ•°æ®åŒ…åŒ–æ¥å£å°†ä¼ å…¥å’Œä¼ å‡ºçš„æ•°æ®åˆ†æ•£åœ¨å†…å­˜ä¸­ï¼Œå®ƒé™åˆ¶äº†é¢„å–å™¨å’Œå…¶ä»–éœ€è¦é¢„æµ‹è½¯ä»¶å°†è®¿é—®çš„ä¸‹ä¸€ä¸ªå†…å­˜åœ°å€çš„ CPU ä¼˜åŒ–çš„æœ‰æ•ˆæ€§â€”â€”æˆ‘ä»¬ç§°ä¹‹ä¸ºæ··ä¹±çš„å†…å­˜è®¿é—®ã€‚ å¦‚å¯¹è±¡ç¼“å­˜[9, 57]å’Œé”®å€¼å­˜å‚¨[4, 52]ã€‚ Metadata overhead: ç”±äºæ•°æ®åŒ…åŒ–æ¥å£ä¾èµ–äºæ¯ä¸ªæ•°æ®åŒ…çš„å…ƒæ•°æ®ï¼Œå®ƒå°†ç›¸å½“ä¸€éƒ¨åˆ† PCIe å¸¦å®½ç”¨äºä¼ è¾“å…ƒæ•°æ®â€”â€”åœ¨ä½¿ç”¨å°æ¶ˆæ¯æ—¶é«˜è¾¾ 39%çš„å¯ç”¨å¸¦å®½ã€‚è¿™å¯¼è‡´å¤„ç†å°è¯·æ±‚çš„åº”ç”¨ç¨‹åºå—åˆ° PCIe çš„ç“¶é¢ˆé™åˆ¶ï¼Œæˆ‘ä»¬åœ¨å®ç° Google çš„ Maglev è´Ÿè½½å‡è¡¡å™¨[23]æ—¶è§‚å¯Ÿåˆ°äº†ç”±äº PCIe ç“¶é¢ˆå¯¼è‡´çš„å¯æ‰©å±•æ€§é—®é¢˜ã€‚ è´Ÿè½½å‡è¡¡å™¨ä¼šå—åˆ°å½±å“ï¼Ÿ åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬æå‡ºäº† EnsÅï¼Œä¸€ç§æ–°çš„ NIC-åº”ç”¨ç¨‹åºé€šä¿¡æ¥å£ï¼Œå®ƒæ‘’å¼ƒäº†è¾ƒä½çº§åˆ«çš„æ•°æ®åŒ…æ¦‚å¿µã€‚ç›¸åï¼ŒEnsÅ æä¾›äº†ä¸€ç§æµå¼æŠ½è±¡ï¼ŒNIC å’Œåº”ç”¨ç¨‹åºå¯ä»¥ä½¿ç”¨å®ƒæ¥é€šä¿¡ä»»æ„å¤§å°çš„æ•°æ®å—ã€‚è¿™æ ·åšä¸ä»…ä½¿ NIC å’Œåº”ç”¨ç¨‹åºèƒ½å¤Ÿä½¿ç”¨æ›´é€‚åˆå„è‡ªå®ç°çš„åŠŸèƒ½çš„ä»»æ„æ•°æ®æ ¼å¼ï¼Œè€Œä¸”è¿˜æ‘†è„±äº†æ•°æ®åŒ…åŒ–æ¥å£ä¸­å­˜åœ¨çš„æ€§èƒ½é—®é¢˜ã€‚å› ä¸º EnsÅ å¯¹æ•°æ®æ ¼å¼æœ¬èº«æ²¡æœ‰ä»»ä½•å‡è®¾ï¼Œæ‰€ä»¥å¯ä»¥æ ¹æ®åº”ç”¨ç¨‹åºå’Œ NIC ä¸Šå¯ç”¨çš„å¸è½½è¿›è¡Œé‡æ–°åˆ©ç”¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ NIC åªè´Ÿè´£å¤ç”¨/è§£å¤ç”¨ï¼Œå®ƒå¯ä»¥ä½¿ç”¨ EnsÅ æ¥ä¼ è¾“åŸå§‹æ•°æ®åŒ…ï¼›å¦‚æœ NIC ä¹Ÿäº†è§£åº”ç”¨ç¨‹åºçº§æ¶ˆæ¯ï¼Œå®ƒå¯ä»¥ä½¿ç”¨ EnsÅ å°†æ•´ä¸ªæ¶ˆæ¯å’Œ RPC ä¼ é€’ç»™åº”ç”¨ç¨‹åºï¼›å¦‚æœ NIC å®ç°äº†ä¼ è¾“åè®®ï¼Œå¦‚ TCPï¼Œå®ƒå¯ä»¥ä½¿ç”¨ EnsÅ ä½¿ç”¨å­—èŠ‚æµä¸åº”ç”¨ç¨‹åºé€šä¿¡ã€‚ æµå¼ã€å­—èŠ‚æµ ä¸ºäº†æä¾›æµå¼æŠ½è±¡ï¼ŒEnsÅ ç”¨åŒ…å«æ•°æ®çš„ç¯å½¢ç¼“å†²åŒºæ›¿æ¢äº†å½“å‰ NIC æ¥å£ä½¿ç”¨çš„åŒ…å«æè¿°ç¬¦çš„ç¯å½¢ç¼“å†²åŒºã€‚NIC å’Œè½¯ä»¶é€šè¿‡å°†æ•°æ®é™„åŠ åˆ°è¿™äº›ç¯å½¢ç¼“å†²åŒºè¿›è¡Œé€šä¿¡ã€‚EnsÅ å°†ç¼“å†²åŒºè§†ä¸ºä¸é€æ˜çš„æ•°æ®ï¼Œå¹¶ä¸”ä¸å¯¹å®ƒä»¬çš„å†…å®¹ã€ç»“æ„æˆ–å¤§å°æ–½åŠ ä»»ä½•è¦æ±‚ï¼Œä»è€Œå…è®¸å®ƒä»¬è¢«ç”¨æ¥ä¼ è¾“ä»»æ„å¤§å°çš„æ•°æ®ï¼Œå…¶å¤§å°å¯ä»¥å’Œç¯å½¢ç¼“å†²åŒºæœ¬èº«ä¸€æ ·å¤§ã€‚EnsÅ è¿˜æ˜¾è‘—å‡å°‘äº†ç”±äºå…ƒæ•°æ®å¯¼è‡´çš„ PCIe å¸¦å®½å¼€é”€ï¼Œå› ä¸ºå®ƒèƒ½å¤Ÿå¯¹å†™å…¥åŒä¸€ç¼“å†²åŒºçš„å¤šä¸ªæ•°æ®å—è¿›è¡Œèšåˆé€šçŸ¥ã€‚æœ€åï¼Œå®ƒ enables better use of CPU prefetcher ä»¥æ©ç›–å†…å­˜å»¶è¿Ÿï¼Œä»è€Œè¿›ä¸€æ­¥æé«˜åº”ç”¨ç¨‹åºæ€§èƒ½ã€‚ ring buffer ä¸ºäº†ç†è§£å…¶æ€§èƒ½ï¼Œæˆ‘ä»¬ä½¿ç”¨åŸºäº FPGA çš„ SmartNIC å®Œå…¨å®ç°äº† EnsÅã€‚æˆ‘ä»¬åœ¨ç¬¬ 5 èŠ‚ä¸­æè¿°äº†æˆ‘ä»¬çš„ç¡¬ä»¶å’Œè½¯ä»¶å®ç°ï¼Œä»¥åŠæ ¹æ® NIC æä¾›çš„åŠŸèƒ½ EnsÅ çš„ä½¿ç”¨æ–¹å¼åœ¨ç¬¬ 6 èŠ‚ä¸­ã€‚åœ¨ç¬¬ 7 èŠ‚ä¸­ï¼Œæˆ‘ä»¬å±•ç¤ºäº† EnsÅ çš„è¯„ä¼°ï¼ŒåŒ…æ‹¬å®ƒåœ¨å››ä¸ªåº”ç”¨ç¨‹åºä¸­çš„ä½¿ç”¨ï¼šMaglev è´Ÿè½½å‡è¡¡å™¨[23]ã€åŸºäº NitroSketch çš„ç½‘ç»œé¥æµ‹åº”ç”¨ç¨‹åº[54]ã€MICA é”®å€¼å­˜å‚¨[52]ï¼Œä»¥åŠå— AWS CloudWatch Logs[6]å¯å‘çš„æ—¥å¿—ç›‘æ§å™¨ã€‚æˆ‘ä»¬è¿˜å®ç°äº†ä¸€ä¸ªè½¯ä»¶æ•°æ®åŒ…ç”Ÿæˆå™¨ï¼Œæˆ‘ä»¬åœ¨å¤§å¤šæ•°å®éªŒä¸­ä½¿ç”¨å®ƒã€‚æˆ‘ä»¬è§‚å¯Ÿåˆ°ä¸ DPDK æ²¡æœ‰ç¡¬ä»¶å¸è½½çš„å®ç°ç›¸æ¯”ï¼ŒMaglev çš„é€Ÿåº¦æé«˜äº† 6 å€ï¼ŒMICA çš„é€Ÿåº¦æé«˜äº† 1.47 å€ï¼Œè€Œã€‚ å®ç°äº†ä¸€ä¸ªç¡¬ä»¶ï¼Ÿè¿˜æ˜¯ç¡¬ä»¶ä¸Šçš„è½¯ä»¶ï¼Ÿä¸ºä»€ä¹ˆå’Œ dpdk éç¡¬ä»¶å¸è½½æ¯”ï¼Œæ˜¯ä¸æ˜¯ä¸å¤ªå¯¹ç…§ ","date":"2024-09-30","objectID":"/posts/paper-enso/:3:0","tags":["Paper Reading"],"title":"Paper Reading: Enso: A Streaming Interface for NIC-Application Communication (OSDI2023)","uri":"/posts/paper-enso/"},{"categories":null,"content":"Background and Motivation æ•°æ®åŒ…åŒ– NIC æ¥å£å†³å®šäº†å‡ ä¹æ‰€æœ‰é«˜æ€§èƒ½ç½‘ç»œåº“æä¾›çš„ APIï¼ŒåŒ…æ‹¬ io_uring[15]ã€DPDK[19]å’Œ netmap[73] ","date":"2024-09-30","objectID":"/posts/paper-enso/:4:0","tags":["Paper Reading"],"title":"Paper Reading: Enso: A Streaming Interface for NIC-Application Communication (OSDI2023)","uri":"/posts/paper-enso/"},{"categories":null,"content":"Packetized NIC Interface NIC å¸è½½å…è®¸ NIC æ‰§è¡Œä»¥å‰åœ¨è½¯ä»¶ä¸­å®ç°çš„å¸¸è§ä»»åŠ¡ï¼ˆä¾‹å¦‚ï¼Œåˆ†æ®µï¼‰ï¼›æ›´é«˜æ•ˆçš„ç½‘ç»œ I/O åº“å’Œæ¥å£ï¼ŒåŒ…æ‹¬ DPDK å’Œ XDPï¼Œå…è®¸åº”ç”¨ç¨‹åºå‡å°‘ç½‘ç»œæ ˆçš„å¤„ç†ã€‚ ä½† NIC åˆ°è½¯ä»¶çš„æ¥å£å‡ åå¹´æ¥ä¸€ç›´æ²¡æœ‰å˜åŒ–ã€‚ æ•°æ®åŒ…åŒ– NIC æ¥å£çš„ä¸€ä¸ªæ ¸å¿ƒè®¾è®¡é€‰æ‹©æ˜¯ä¸ºæ¯ä¸ªæ•°æ®åŒ…æ”¾ç½®ä¸€ä¸ªä¸“ç”¨çš„æ•°æ®åŒ…ç¼“å†²åŒºã€‚ ç¼“å†²åŒºé€šå¸¸è¢«è®¾ç½®ä¸ºå¯ä»¥å®¹çº³ MTU å¤§å°çš„æ•°æ®åŒ… å›¾ 1 æ˜¾ç¤ºäº†ä¸€ä¸ªæ•°æ®åŒ…åŒ– NIC æ¥å£è¢«ç”¨æ¥ä» NIC ä¸Šçš„ç‰¹å®šç¡¬ä»¶é˜Ÿåˆ—æ¥æ”¶å››ä¸ªæ•°æ®åŒ…çš„ç¤ºä¾‹ã€‚NIC é˜Ÿåˆ—ä¸ä¸€ç»„ NIC å¯„å­˜å™¨ç›¸å…³è”ï¼Œè¿™äº›å¯„å­˜å™¨å¯ä»¥ç”¨æ¥æ§åˆ¶æ¥æ”¶ï¼ˆRXï¼‰æè¿°ç¬¦ç¯å½¢ç¼“å†²åŒºå’Œä¼ è¾“ï¼ˆTXï¼‰æè¿°ç¬¦ç¯å½¢ç¼“å†²åŒºã€‚åœ¨èƒ½å¤Ÿæ¥æ”¶æ•°æ®åŒ…ä¹‹å‰ï¼Œè½¯ä»¶é€šè¿‡åœ¨ RX æè¿°ç¬¦ç¯å½¢ç¼“å†²åŒºä¸­æ’é˜ŸæŒ‡å‘æ¯ä¸ªç¼“å†²åŒºçš„æè¿°ç¬¦ï¼Œé€šçŸ¥ NIC å…¶ç¼“å†²åŒºæ± ä¸­å¤šä¸ªå¯ç”¨ç¼“å†²åŒºçš„åœ°å€ã€‚ç„¶åï¼ŒNIC å¯ä»¥ä½¿ç”¨ DMA å°†ä¼ å…¥çš„æ•°æ®åŒ…æ•°æ®å†™å…¥ä¸‹ä¸€ä¸ªå¯ç”¨çš„æ•°æ®åŒ…ç¼“å†²åŒºï¼Œå¹¶æ’é˜Ÿæ›´æ–°çš„æè¿°ç¬¦ï¼ŒåŒ…å«æ•°æ®åŒ…å¤§å°ç­‰å…ƒæ•°æ®ã€‚é‡è¦çš„æ˜¯ï¼ŒNIC è¿˜åœ¨æè¿°ç¬¦ä¸­è®¾ç½®äº†ä¸€ä¸ªâ€œæ ‡å¿— flagâ€ä½ï¼Œå‘è½¯ä»¶å‘å‡ºä¿¡å·ï¼Œè¡¨æ˜è¯¥ç¼“å†²åŒºå·²åˆ°è¾¾æ•°æ®åŒ…ã€‚è§‚å¯Ÿåˆ°æè¿°ç¬¦ä¸‹çš„å¤´éƒ¨æŒ‡é’ˆçš„é€šçŸ¥ä½ï¼Œè½¯ä»¶ç„¶åå¯ä»¥å¢åŠ å¤´éƒ¨æŒ‡é’ˆã€‚ ä¼ è¾“è¿‡ç¨‹ä¹Ÿç±»ä¼¼ï¼šå‘é€è½¯ä»¶ä¸ºå‡†å¤‡ä¼ è¾“çš„æ•°æ®åŒ…ç¼“å†²åŒºç»„è£…ä¸€ç»„æè¿°ç¬¦ï¼Œå¹¶å°†æè¿°ç¬¦ï¼ˆè€Œä¸æ˜¯æ•°æ®åŒ…æœ¬èº«ï¼‰å¤åˆ¶åˆ° TX ç¯å½¢ç¼“å†²åŒºï¼›æè¿°ç¬¦ä¸­çš„æ ‡å¿—ä½ç°åœ¨ç”¨äºå‘ NIC å‘å‡ºä¿¡å·ï¼Œè¡¨æ˜å·²ç»ä¼ è¾“ï¼ˆè€Œä¸æ˜¯æ¥æ”¶ï¼‰äº†ä¸€ä¸ªæ•°æ®åŒ…ã€‚ ä¸ºæ¯ä¸ªæ•°æ®åŒ…åˆ†é…ç¼“å†²åŒºçš„ä¸€ä¸ªä¸»è¦å¥½å¤„æ˜¯ï¼Œå¯ä»¥åœ¨è½¯ä»¶ä¸­é«˜æ•ˆåœ°è¿›è¡Œå¤ç”¨/è§£å¤ç”¨ã€‚ ç„¶è€Œï¼Œç°ä»£é«˜æ€§èƒ½è½¯ä»¶æ ˆçš„ä½¿ç”¨æ¨¡å¼çœ‹èµ·æ¥éå¸¸ä¸åŒã€‚ä¸æ˜¯æœ‰ä¸€ä¸ªè½¯ä»¶å®ä½“ï¼ˆä¾‹å¦‚ï¼Œå†…æ ¸ï¼Œè½¯ä»¶äº¤æ¢æœºï¼‰è°ƒè§£å¯¹ NIC çš„è®¿é—®ï¼Œå¯èƒ½æœ‰å¤šä¸ªçº¿ç¨‹æˆ–è¿›ç¨‹ç›´æ¥è®¿é—® NICï¼ˆå³ï¼Œå†…æ ¸ç»•è¿‡ï¼‰ã€‚ç„¶å NIC æ‰¿æ‹…äº†è§£å¤ç”¨çš„æ‰€æœ‰è´£ä»»ï¼Œä½¿ç”¨ä¾‹å¦‚ RSS[82]ã€Intel çš„ Flow Director[39]ï¼Œæˆ–è€…ï¼ˆå¯¹äºéå¸¸ä¸°å¯Œçš„äº¤æ¢æ¨¡å‹ï¼‰Microsoft çš„ AccelNet[28]ã€‚åœ¨è¿™ç§è®¾ç½®ä¸­ï¼Œæ•°æ®åŒ…åŒ– NIC æ¥å£çš„å¤ç”¨/è§£å¤ç”¨èƒ½åŠ›æ²¡æœ‰æä¾›ä»»ä½•é¢å¤–çš„ä»·å€¼ã€‚ ","date":"2024-09-30","objectID":"/posts/paper-enso/:4:1","tags":["Paper Reading"],"title":"Paper Reading: Enso: A Streaming Interface for NIC-Application Communication (OSDI2023)","uri":"/posts/paper-enso/"},{"categories":null,"content":"Issues with a Packetized Interface å°½ç®¡è®¸å¤šé«˜æ€§èƒ½åº”ç”¨ç¨‹åºä»Šå¤©ä»æ•°æ®åŒ…åŒ–æ¥å£ä¸­è·å¾—çš„å¥½å¤„å¾ˆå°‘ï¼Œä½†å®ƒä»¬ä»ç„¶éœ€è¦ä¸ºä¼´éšè€Œæ¥çš„å¼€é”€ä»˜å‡ºä»£ä»·ã€‚å°† NIC å’Œåº”ç”¨ç¨‹åºä¹‹é—´çš„æ•°æ®é€šä¿¡ç¡¬å¡è¿›å›ºå®šå¤§å°çš„å—ä¸­ï¼Œä¼šå¯¼è‡´ CPU ç¼“å­˜å’Œ PCIe å¸¦å®½åœ¨å°è¯·æ±‚ä¸Šçš„ä½¿ç”¨æ•ˆç‡ä½ä¸‹ï¼Œä»¥åŠç”±äºåº”ç”¨ç¨‹åºä¾èµ–äºå¤§æ¶ˆæ¯æˆ–å­—èŠ‚æµè€Œå¯¼è‡´çš„é¢å¤–æ•°æ®å¤åˆ¶ã€‚ ä¸»è¦æ˜¯é¢å¯¹å°è¯·æ±‚å—ï¼Œä¸çŸ¥é“åç»­çš„ evaluation æ˜¯ä¸æ˜¯ä¹Ÿéƒ½æ˜¯å°è¯·æ±‚ Chaotic Memory Access: åŸºäº DPDK çš„ç®€å• ping/pong ç¨‹åºï¼Œä¸»è¦æ˜¯ç”±äº L1 å’Œ L2 ç¼“å­˜æœªå‘½ä¸­ã€‚åƒé”®å€¼å­˜å‚¨[4, 52]æˆ–æ•°æ®åŒ…å¤„ç†å™¨[18]è¿™æ ·çš„åº”ç”¨ç¨‹åºåœ¨æ•°æ®è®¿é—®ä¸Šè¡¨ç°å‡ºéå¸¸é«˜çš„ç©ºé—´-æ—¶é—´å±€éƒ¨æ€§ã€‚å®é™…ä¸Šï¼Œå…ˆå‰çš„å·¥ä½œ[55, 81]å·²ç»åå¤è¯æ˜ï¼Œæ•°æ®åŒ…å¤„ç†åº”ç”¨ç¨‹åºçš„å·¥ä½œé›†å¤§å°ç»å¸¸è¶…å‡ºä¸“ç”¨äº DDIO[35]çš„ç¼“å­˜ç©ºé—´ï¼ŒæŠµæ¶ˆäº†è¿™ç§ç¡¬ä»¶ä¼˜åŒ–çš„å¥½å¤„ï¼Œå°† I/O æ•°æ®ç›´æ¥å¸¦å…¥ç¼“å­˜ã€‚æ­£å¦‚æˆ‘ä»¬åœ¨ç¬¬ 7.2.3 èŠ‚ä¸­è¯¦ç»†è®¨è®ºçš„ï¼Œä½¿ç”¨ä¸€ç§ä¿ƒè¿›é¡ºåºå†…å­˜è®¿é—®çš„ä¸åŒ NIC æ¥å£å¯ä»¥å°† L1d ç¼“å­˜çš„æœªå‘½ä¸­ç‡ä» 6%é™ä½åˆ° 0.2%ï¼Œå°† L2 ç¼“å­˜çš„æœªå‘½ä¸­ç‡ä» 55%é™ä½åˆ° 9%ã€‚ è¿™é‡Œçš„ç¼“å­˜æ˜¯ cpu çš„å— Metadata Bandwidth Overhead: é«˜è¾¾ 39%çš„ CPU åˆ° NIC äº’è¿å¸¦å®½ç”¨äºä¼ è¾“æè¿°ç¬¦ æ€»ç»“ï¼šé€šè¿‡ä¸ºæ¯ä¸ªæ•°æ®åŒ…é…å¯¹ä¸€ä¸ªå•ç‹¬çš„æè¿°ç¬¦ï¼Œæ•°æ®åŒ…åŒ– NIC æ¥å£éå¸¸é€‚åˆä»¥å‰ä¸€ä»£éœ€è¦åœ¨è½¯ä»¶ä¸­å®ç°å¤ç”¨çš„é«˜ååé‡ç½‘ç»œåº”ç”¨ç¨‹åºã€‚ç„¶è€Œï¼Œå¯¹äºä»Šå¤©çš„é«˜æ€§èƒ½åº”ç”¨ç¨‹åºï¼Œå®ƒå¼•å…¥äº†ä¸å¿…è¦çš„æ€§èƒ½å¼€é”€ã€‚ ","date":"2024-09-30","objectID":"/posts/paper-enso/:4:2","tags":["Paper Reading"],"title":"Paper Reading: Enso: A Streaming Interface for NIC-Application Communication (OSDI2023)","uri":"/posts/paper-enso/"},{"categories":null,"content":"Enso Overview ç½‘ç»œæ¥å£å¡ï¼ˆNICï¼‰ä¸åº”ç”¨ç¨‹åºé€šä¿¡çš„æµå¼æ¥å£ çµæ´»æ€§ï¼Œå…è®¸å®ƒç”¨äºä¸åŒç±»åˆ«çš„å¸è½½æ“ä½œï¼Œè¿™äº›æ“ä½œåœ¨ä¸åŒçš„ç½‘ç»œå±‚çº§ä¸Šè¿è¡Œï¼Œå¹¶ä¸”å…·æœ‰ä¸åŒçš„æ•°æ®å¤§å°ï¼› ä½è½¯ä»¶å¼€é”€ï¼Œå‡å°‘åº”ç”¨ç¨‹åºåœ¨é€šä¿¡ä¸Šéœ€è¦èŠ±è´¹çš„å‘¨æœŸæ•°ï¼›ä»¥åŠ ç¡¬ä»¶ç®€å•æ€§ï¼Œä½¿å¾—åœ¨å•†å“ NIC ä¸Šçš„å®é™…å®ç°æˆä¸ºå¯èƒ½ã€‚ è¿™æ˜¯ä¸€ç§æ–°çš„ç¼“å†²åŒºæŠ½è±¡ï¼Œå…è®¸åº”ç”¨ç¨‹åºå’Œ NIC äº¤æ¢ä»»æ„å¤§å°çš„æ•°æ®å—ï¼Œå°±åƒè¯»å†™ä¸€ä¸ªæ— ç•Œå†…å­˜ç¼“å†²åŒºä¸€æ ·ã€‚ä¸æ•°æ®åŒ…åŒ–æ¥å£ä½¿ç”¨çš„ç¯å½¢ç¼“å†²åŒºä¸åŒï¼ˆè¿™äº›ç¼“å†²åŒºåŒ…å«åˆ†æ•£çš„æ•°æ®åŒ…ç¼“å†²åŒºçš„æè¿°ç¬¦ï¼‰ï¼ŒEns Ì„o Pipe æ˜¯å®ç°ä¸ºæ•°æ®ç¯å½¢ç¼“å†²åŒºï¼ŒåŒ…å«å®é™…çš„æ•°æ®åŒ…æ•°æ® éƒ½æ˜¯ç¯ï¼ŒåŒºåˆ«åœ¨å“ªå‘¢ High-level operation: æœ€åˆï¼ŒPipes æ˜¯ç©ºçš„ï¼ŒHeadSW å’Œ TailNIC æŒ‡å‘ç¼“å†²åŒº 1 ä¸­çš„åŒä¸€ä½ç½®ã€‚å½“ NIC æ¥æ”¶åˆ°æ¶ˆæ¯æ—¶ï¼Œå®ƒä½¿ç”¨ DMA å°†å®ƒä»¬æ’é˜Ÿåˆ° Pipes æ‹¥æœ‰çš„è¿ç»­å†…å­˜ä¸­ã€‚åœ¨å›¾ä¸­ï¼ŒNIC åœ¨ Pipe A çš„å†…å­˜ä¸­æ’é˜Ÿäº†ä¸¤ä¸ªæ¶ˆæ¯ï¼Œåœ¨ Pipe B çš„å†…å­˜ä¸­æ’é˜Ÿäº†ä¸‰ä¸ªã€‚NIC é€šè¿‡åœ¨é€šçŸ¥ç¼“å†²åŒºä¸­æ’é˜Ÿä¸¤ä¸ªé€šçŸ¥ï¼ˆæ¯ä¸ª Enso Pipe ä¸€ä¸ªï¼‰æ¥é€šçŸ¥è½¯ä»¶ã€‚è½¯ä»¶ä½¿ç”¨è¿™äº›é€šçŸ¥æ¥æ¨è¿› TailNIC å¹¶å¤„ç†æ¶ˆæ¯ã€‚ä¸€æ—¦æ¶ˆæ¯è¢«å¤„ç†ï¼Œè½¯ä»¶å°±å†™å…¥ä¸€ä¸ªå†…å­˜æ˜ å°„ I/Oï¼ˆMMIOï¼‰å¯„å­˜å™¨ï¼ˆæ¨è¿› HeadSWï¼‰æ¥é€šçŸ¥ NICâ€”â€”å…è®¸å†…å­˜è¢«åç»­æ¶ˆæ¯é‡ç”¨ 3ã€‚å‘é€æ¶ˆæ¯æ˜¯å¯¹ç§°çš„ï¼Œé™¤äº†æœ€åä¸€æ­¥ï¼šNIC é€šè¿‡è¦†ç›– CPU ç”¨æ¥é€šçŸ¥ NIC æœ‰æ¶ˆæ¯å¯ä¾›ä¼ è¾“çš„é€šçŸ¥æ¥é€šçŸ¥è½¯ä»¶æ¶ˆæ¯å·²è¢«ä¼ è¾“ã€‚ æ„Ÿè§‰è¿‡ç¨‹å’Œ ring buffer æ²¡å•¥åŒºåˆ«ï¼Ÿ Ens Ì„o Pipeâ€™s flexibilityï¼šå°½ç®¡å›¾ 3 æ˜¾ç¤ºäº†å‘é€æ¶ˆæ¯çš„æ­¥éª¤ï¼Œä½†ç”±äº Ens Ì„o Pipes æ˜¯ä¸é€æ˜çš„ï¼Œå®ƒä»¬å¯ä»¥ç”¨æ¥ä¼ è¾“ä»»æ„å¤§å°çš„æ•°æ®å—ã€‚è¿™äº›å¯ä»¥æ˜¯åŸå§‹æ•°æ®åŒ…ï¼Œç”±å¤šä¸ª MTU å¤§å°çš„æ•°æ®åŒ…ç»„æˆçš„æ¶ˆæ¯ï¼Œç”šè‡³æ˜¯æ— ç•Œå­—èŠ‚æµã€‚æ•°æ®çš„æ ¼å¼ç”±åº”ç”¨ç¨‹åºå’Œåœ¨ NIC ä¸Šè¿è¡Œçš„å¸è½½å†³å®šã€‚æ­¤å¤–ï¼ŒEns Ì„o Pipes çš„ä¸é€æ˜æ€§æ„å‘³ç€å®ƒä»¬å¯ä»¥æ˜ å°„åˆ°åº”ç”¨ç¨‹åºå†…å­˜ç©ºé—´å†…çš„ä»»ä½•å›ºå®šå†…å­˜ã€‚å› æ­¤ï¼Œé€šè¿‡å°† RX å’Œ TX Ens Ì„o Pipes æ˜ å°„åˆ°åŒä¸€åŒºåŸŸï¼Œç½‘ç»œåŠŸèƒ½å’Œå…¶ä»–è½¬å‘åº”ç”¨ç¨‹åºå¯ä»¥é¿å…å¤åˆ¶æ•°æ®åŒ…ã€‚åœ¨æˆ‘ä»¬çš„è¯„ä¼°ï¼ˆÂ§7ï¼‰ä¸­ï¼Œæˆ‘ä»¬åœ¨å®ç° Maglev å’Œç½‘ç»œé¥æµ‹åº”ç”¨ç¨‹åºæ—¶ä½¿ç”¨äº†è¿™ç§æ–¹æ³•ã€‚ Performance advantages of an Ens Ì„o Pipe: pipes å…è®¸åº”ç”¨ç¨‹åºé¡ºåºè¯»å†™ I/O æ•°æ®ï¼Œä»è€Œé¿å…äº†æ··ä¹±çš„å†…å­˜è®¿é—® Challenges: å°½ç®¡å®ç°æ•°æ®ä¼ è¾“çš„ç¯å½¢ç¼“å†²åŒºæœ¬èº«æ˜¯ä¸€ä¸ªç®€å•çš„æƒ³æ³•ï¼Œä½†åè°ƒ CPU å’Œ NIC ä¹‹é—´çš„é€šçŸ¥ä»¥æ›´æ–°å¤´éƒ¨å’Œå°¾éƒ¨æŒ‡é’ˆå´æ˜¯ä¸€ä¸ªæŒ‘æˆ˜ã€‚ Efficient coordination: åœ¨Â§4.1 ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†é€šçŸ¥çš„ç®€å•æ–¹æ³•å¦‚ä½•ä¼šä½¿ MMIO å’Œ DMA çš„æœ€åæƒ…å†µæ€§èƒ½å—åˆ°å‹åŠ›ã€‚ç‰¹åˆ«æ˜¯ï¼Œå¯¹åŒä¸€å†…å­˜åœ°å€çš„å¹¶å‘è®¿é—®å¯èƒ½ä¼šåœ¨ CPU å’Œ NIC ä¹‹é—´äº§ç”Ÿç¼“å­˜äº‰ç”¨ã€‚Ens Ì„o ä½¿ç”¨ä¸“ç”¨çš„é€šçŸ¥ç¼“å†²åŒºæ¥åŒæ­¥å¤´éƒ¨å’Œå°¾éƒ¨æŒ‡é’ˆçš„æ›´æ–°ï¼›å½“ä¸æ‰¹å¤„ç†å’Œå¤šé˜Ÿåˆ—å¤„ç†ç»“åˆä½¿ç”¨æ—¶ï¼Œé€šçŸ¥ç¼“å†²åŒºæ–¹æ³•å‡å°‘äº†ç¼“å­˜äº‰ç”¨çš„å¨èƒã€‚ Notification pacing: Pipes è¢«è®¾è®¡æˆå¯ä»¥åˆå¹¶å¤šä¸ªæ•°æ®åŒ…çš„é€šçŸ¥ï¼Œå‡å°‘äº† CPU å’Œ NIC ä¹‹é—´ä¼ è¾“çš„å…ƒæ•°æ®é‡ã€‚ç„¶è€Œï¼Œå†³å®šä½•æ—¶å‘é€é€šçŸ¥ä»ç„¶å¾ˆé‡è¦ï¼šå¦‚æœå‘é€å¾—å¤ªé¢‘ç¹ï¼Œå®ƒä»¬ä¼šæµªè´¹ PCIe å¸¦å®½å¹¶å¢åŠ è½¯ä»¶å¼€é”€ï¼Œä½†å¦‚æœå‘é€å¾—å¤ªä¸é¢‘ç¹ï¼Œæ ¸å¿ƒå¯èƒ½ä¼šé—²ç½®ç­‰å¾…é€šçŸ¥ï¼Œä»è€Œé™ä½ååé‡ã€‚Ens Ì„o åŒ…æ‹¬ä¸¤ç§æœºåˆ¶ï¼Œååº”æ€§é€šçŸ¥å’Œé€šçŸ¥é¢„å–ï¼ˆÂ§4.2ï¼‰ï¼Œå®ƒä»¬æ§åˆ¶ä½•æ—¶å‘é€é€šçŸ¥ã€‚è¿™äº›æœºåˆ¶æ˜¯è‡ªç„¶è‡ªé€‚åº”çš„ï¼Œå³å®ƒä»¬åœ¨ä¸é™åˆ¶ååé‡çš„æƒ…å†µä¸‹æœ€å°åŒ–å‘é€çš„é€šçŸ¥æ•°é‡ï¼Œå¹¶ä¸”å¯ä»¥åœ¨ä¸å¢åŠ ç¡¬ä»¶å¤æ‚æ€§çš„æƒ…å†µä¸‹å®ç°ã€‚ åŒä¸€åœ°å€è®¿é—®ï¼Œç¼“å­˜äº‰ç”¨ï¼Œæ˜¯ä»€ä¹ˆæƒ…å†µ enso ä½¿ç”¨äº†å¤šé˜Ÿåˆ— æµè®¡ç®—ï¼šåˆå¹¶å¤šä¸ªåŒ…ï¼Ÿ Low hardware complexity and state: Ens Ì„o çš„è®¾è®¡æ¶‰åŠç¡¬ä»¶å’Œè½¯ä»¶ï¼Œæˆ‘ä»¬å¿…é¡»å°å¿ƒï¼Œä¸è¦ç”¨è½¯ä»¶çš„ç®€å•æ€§æ¥æ¢å–ç¡¬ä»¶çš„å¤æ‚æ€§ã€‚Ens Ì„o å€¾å‘äºéœ€è¦å¾ˆå°‘ NIC çŠ¶æ€çš„åè°ƒæœºåˆ¶ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯è®¾è®¡ä¸€ä¸ªç®€å•ä¸”æ˜“äºå¹¶è¡ŒåŒ–çš„ç³»ç»Ÿ Target applications: æµå¼æ¥å£ï¼Œé’ˆå¯¹æŒ‰é¡ºåºå¤„ç†æ¥æ”¶æ•°æ®çš„æƒ…å†µè¿›è¡Œä¼˜åŒ–ã€‚æˆ‘ä»¬çš„è¯„ä¼°ï¼ˆÂ§7ï¼‰è¡¨æ˜ï¼Œè¿™æ¶µç›–äº†å¹¿æ³›çš„ç½‘ç»œå¯†é›†å‹åº”ç”¨ç¨‹åº ç”±æ­¤äº§ç”Ÿçš„è®¾è®¡ä¸é€‚åˆéœ€è¦å¤ç”¨å’Œè§£å¤ç”¨æ•°æ®åŒ…çš„åº”ç”¨ç¨‹åºï¼ˆä¾‹å¦‚ï¼Œåƒ Open vSwitch [67]å’Œ BESS [32]è¿™æ ·çš„è™šæ‹Ÿäº¤æ¢æœºï¼‰ï¼Œå› ä¸ºè¿™äº›åº”ç”¨ç¨‹åºéœ€è¦é¢å¤–çš„å¤åˆ¶ã€‚ç„¶è€Œï¼Œä»¤äººæƒŠè®¶çš„æ˜¯ï¼Œå³ä½¿éœ€è¦è¿™æ ·çš„é¢å¤–å¤åˆ¶ï¼ŒEns Ì„o çš„æ€§èƒ½ä¹Ÿè¶…è¿‡äº†æ•°æ®åŒ…åŒ–æ¥å£ ä¸ºä»€ä¹ˆä¸é€‚åˆ multiplex and demultiplex ä½†æ˜¯ä¸ºä»€ä¹ˆæ€§èƒ½åˆå¥½å¾ˆå¤šï¼Ÿç¡¬ä»¶ Offload å¸¦æ¥çš„æ˜¾è‘—æå‡å— ","date":"2024-09-30","objectID":"/posts/paper-enso/:5:0","tags":["Paper Reading"],"title":"Paper Reading: Enso: A Streaming Interface for NIC-Application Communication (OSDI2023)","uri":"/posts/paper-enso/"},{"categories":null,"content":"Efficient Notifications efficiently coordinating Enso Pipes between the CPU and the NIC ","date":"2024-09-30","objectID":"/posts/paper-enso/:6:0","tags":["Paper Reading"],"title":"Paper Reading: Enso: A Streaming Interface for NIC-Application Communication (OSDI2023)","uri":"/posts/paper-enso/"},{"categories":null,"content":"Efficient Ens Ì„o Pipe Coordination How should software and the NIC communicate pointer updates? åœ¨æ•°æ®åŒ…åŒ– NIC æ¥å£ä½¿ç”¨çš„æè¿°ç¬¦ç¯å½¢ç¼“å†²åŒºä¸­ï¼Œè½¯ä»¶ä½¿ç”¨ MMIO å†™å…¥æ¥å‘ NIC é€šä¿¡æŒ‡é’ˆæ›´æ–°ï¼Œè€Œ NIC é€šè¿‡æè¿°ç¬¦ç¼“å†²åŒºæœ¬èº«çš„å†…è”ä¿¡å·æ¥é€šä¿¡æŒ‡é’ˆæ›´æ–°[25, 39]ï¼Œé¿å…äº† MMIO è¯»å–çš„å¼€é”€ã€‚å› ä¸ºæè¿°ç¬¦çš„æ ¼å¼ç”± NIC å®šä¹‰ï¼ŒNIC å¯ä»¥åœ¨æ¯ä¸ªæè¿°ç¬¦ä¸­ä¸“é—¨è®¾ç½®ä¸€ä¸ªâ€œæ ‡å¿—ä¿¡å·â€æ¥ä¿¡å·æè¿°ç¬¦æ˜¯æœ‰æ•ˆçš„ã€‚ç„¶åï¼Œè½¯ä»¶å¯ä»¥è½®è¯¢ä¸‹ä¸€ä¸ªæè¿°ç¬¦ï¼Œç›´åˆ°å…¶æ ‡å¿—å˜ä¸ºæœ‰æ•ˆã€‚è¿™æ ·ï¼ŒNIC å°±ä¸éœ€è¦æ˜ç¡®åœ°å‘Šè¯‰è½¯ä»¶æŒ‡é’ˆæ›´æ–°ã€‚ ä¸å¹¸çš„æ˜¯ï¼Œæˆ‘ä»¬ä¸èƒ½å¯¹ Ens Ì„o ä½¿ç”¨è¿™ç§æ–¹æ³•ã€‚è™½ç„¶ Ens Ì„o Pipes ä»ç„¶å¯ä»¥ä½¿ç”¨ MMIO å†™å…¥æ¥æ›´æ–°è½¯ä»¶çš„æŒ‡é’ˆï¼Œä½†æˆ‘ä»¬ä¸èƒ½åœ¨ Ens Ì„o Pipe æœ¬èº«ä¸­åµŒå…¥å†…è”ä¿¡å·ï¼Œå› ä¸ºæˆ‘ä»¬ä¸å¯¹æ•°æ®æ–½åŠ ä»»ä½•ç»“æ„ã€‚ æˆ‘ä»¬è€ƒè™‘äº†å‡ ç§è®¾è®¡é€‰é¡¹æ¥é€šä¿¡æŒ‡é’ˆæ›´æ–°ã€‚æˆ‘ä»¬åœ¨è¿™é‡Œå…³æ³¨ illuminating rejected design hereï¼šåœ¨ä¸»å†…å­˜ä¸­ NIC å’Œè½¯ä»¶ä¹‹é—´å…±äº«ä¸€ä¸ªåœ°å€ã€‚å¯¹äºæ¯ä¸ª Pipeï¼Œæˆ‘ä»¬å¯èƒ½æœ‰ä¸€ä¸ªä¸“ç”¨çš„å†…å­˜åœ°å€ï¼ŒNIC åœ¨å…¶ä¸­å†™å…¥æœ€æ–°çš„ TailNICã€‚ç„¶åï¼Œè½¯ä»¶å¯ä»¥è½®è¯¢è¿™ä¸ªåœ°å€æ¥ç¡®å®šæœ€æ–°çš„å€¼ã€‚ä¸å¹¸çš„æ˜¯ï¼Œè¿™ç§æ–¹æ³•ä¼šå¯¼è‡´äº‰ç”¨ï¼Œå› ä¸ºæ¯æ¬¡ NIC å†™å…¥å†…å­˜æ—¶ï¼ŒCPU ä¸Šçš„ç¼“å­˜æ¡ç›®å°±ä¼šè¢«ä½¿æ— æ•ˆã€‚å¦‚æœè½¯ä»¶ç»§ç»­è½®è¯¢åŒä¸€ç¼“å­˜è¡Œï¼Œç”±æ­¤äº§ç”Ÿçš„äº‰ç”¨ä¼šå°†ååé‡é™ä½å‡ ä¸ªæ•°é‡çº§ï¼šæˆ‘ä»¬åœ¨ä½¿ç”¨å°ä¼ è¾“æ—¶ä½¿ç”¨è¿™ç§æ–¹æ³•æµ‹é‡åˆ°çš„ååé‡ä½äº 5 Gbpsã€‚æˆ‘ä»¬åœ¨é™„å½•ä¸­è®¨è®ºäº†å…¶ä»–è¢«æ‹’ç»çš„æ–¹æ³•ã€‚ ä¸å¯¹æ•°æ®æ–½åŠ ä»»ä½•ç»“æ„ï¼Ÿä¸ºä»€ä¹ˆï¼Œå› ä¸ºæ˜¯æµå¼ï¼Ÿ å…±äº«ä¸€ä¸ªåœ°å€ï¼Œå¯¼è‡´äº‰ç”¨ï¼Œä¸ºä»€ä¹ˆ NIC å†™å†…å­˜ CPU ç¼“å­˜ä¼šå¤±æ•ˆï¼Ÿç¼“å­˜ä¸€è‡´æ€§ï¼Ÿç¼“å­˜è¡Œæ— æ•ˆï¼Ÿä¸ºä»€ä¹ˆä¸ç›´æ¥å†™å…¥å†…å­˜ï¼ŒDMA å‘¢ï¼Ÿ Pipe coordinate è¿˜æ˜¯æŒ‡é’ˆçš„ä½ç½®é—®é¢˜ã€‚ ","date":"2024-09-30","objectID":"/posts/paper-enso/:6:1","tags":["Paper Reading"],"title":"Paper Reading: Enso: A Streaming Interface for NIC-Application Communication (OSDI2023)","uri":"/posts/paper-enso/"},{"categories":null,"content":"Notification Buffer Ens Ì„o ä½¿ç”¨é€šçŸ¥ç¼“å†²åŒºæ¥é€šä¿¡æŒ‡é’ˆæ›´æ–°ã€‚è™½ç„¶é€šçŸ¥ç¼“å†²åŒºæœ¬èº«çš„ç»“æ„å¹¶ä¸èƒ½è§£å†³ç¼“å­˜äº‰ç”¨æŒ‘æˆ˜ï¼Œä½†å½“å®ƒä¸æ‰¹é‡é€šçŸ¥ç»“åˆä½¿ç”¨ï¼Œå¹¶ä¸”ç”¨äºèšåˆå¤šä¸ª Ens Ì„o Pipes çš„é€šçŸ¥æ›´æ–°æ—¶ï¼Œè¿™ç§æ–¹æ³•å¯ä»¥é˜²æ­¢ CPU å¿™ç­‰å¾…å…±äº«ç¼“å­˜è¡Œï¼Œä»è€Œé¿å…äº‰ç”¨å¼•èµ·çš„å‡é€Ÿã€‚ ä¸€ä¸ªé€šçŸ¥ï¼ŒæŒ‡ç¤ºå¤šä¸ªè¿ç»­æ•°æ®åº“ æ‰¹é‡/åˆå¹¶é€šçŸ¥ï¼Œæ¶ˆè´¹é€šçŸ¥å MMIO å†™å…¥æŒ‡é’ˆï¼Œä½¿ç”¨é€šçŸ¥ç¼“å†²åŒºæ¥æ›´æ–°æŒ‡é’ˆã€‚ è¿˜æ˜¯ä¸æ‡‚ä¸ºä»€ä¹ˆä¸ç›´æ¥ç”¨ DMA ","date":"2024-09-30","objectID":"/posts/paper-enso/:6:2","tags":["Paper Reading"],"title":"Paper Reading: Enso: A Streaming Interface for NIC-Application Communication (OSDI2023)","uri":"/posts/paper-enso/"},{"categories":null,"content":"Multiplexing and Scaling åœ¨å•ä¸ªçº¿ç¨‹å†…ï¼šä¸ºäº†è®©å•ä¸ªçº¿ç¨‹æœ‰æ•ˆåœ°è®¿é—®å¤šä¸ª Ens Ì„o Pipesï¼Œæˆ‘ä»¬å°†å¤šä¸ª Ens Ì„o Pipes ä¸åŒä¸€ä¸ªé€šçŸ¥ç¼“å†²åŒºå…³è”ã€‚å› æ­¤ï¼Œè½¯ä»¶å¯ä»¥æ¢æµ‹å•ä¸ªé€šçŸ¥ç¼“å†²åŒºæ¥æ£€ç´¢å¤šä¸ª Ens Ì„o Pipes çš„æ›´æ–°ã€‚è¿™é¿å…äº†éœ€è¦è½®è¯¢å¤šä¸ªé˜Ÿåˆ—çš„å·²çŸ¥å¯æ‰©å±•æ€§é—®é¢˜ åœ¨å¤šä¸ªçº¿ç¨‹ä¹‹é—´ï¼šä¸ºäº†è®©å¤šä¸ªçº¿ç¨‹ç‹¬ç«‹åœ°å‘é€å’Œæ¥æ”¶æ•°æ®ï¼ŒEns Ì„o æ”¯æŒå¤šä¸ªé€šçŸ¥ç¼“å†²åŒºã€‚æ¯ä¸ªçº¿ç¨‹å¯ä»¥ä½¿ç”¨ä¸“ç”¨çš„é€šçŸ¥ç¼“å†²åŒºï¼Œé¿å…äº†æ˜‚è´µçš„åŒæ­¥åŸè¯­ã€‚åœ¨è®¾ç½®æ–°çš„ Ens Ì„o Pipe æ—¶ï¼Œè½¯ä»¶å‘Šè¯‰ NIC å®ƒä¸å“ªä¸ªé€šçŸ¥ç¼“å†²åŒºå…³è”ã€‚å› æ­¤ï¼ŒNIC çŸ¥é“è¦å‘å“ªä¸ªé€šçŸ¥ç¼“å†²åŒºå‘é€é€šçŸ¥ã€‚ åœ¨å¤šä¸ªåº”ç”¨ç¨‹åºä¹‹é—´ï¼šé™¤äº†ä½¿ç”¨ç‹¬ç«‹çš„çš„é€šçŸ¥ç¼“å†²åŒºï¼ŒEns Ì„o ç¡®ä¿åº”ç”¨ç¨‹åºåªè®¿é—®å®ƒä»¬è‡ªå·±çš„ Ens Ì„o Pipes å’Œé€šçŸ¥ç¼“å†²åŒºçš„å­é›†ã€‚æ¯ä¸ªé˜Ÿåˆ—çš„ MMIO æŒ‡é’ˆå¯„å­˜å™¨å¯¹ä¿æŒåœ¨å…¶è‡ªå·±çš„ä¸“ç”¨é¡µé¢å¯¹é½çš„å†…å­˜å—ä¸­[22]ã€‚è¿™è®©å†…æ ¸å¯ä»¥å°†æŒ‡é’ˆå¯„å­˜å™¨ä»¥æ¯ä¸ªé˜Ÿåˆ—çš„ç²’åº¦æ˜ å°„åˆ°è¯·æ±‚å®ƒçš„åº”ç”¨ç¨‹åºçš„åœ°å€ç©ºé—´ã€‚ é‚£ pipe æ˜¯æ€ä¹ˆåˆ†çš„ï¼Œè¿˜éœ€è¦å…ƒæ•°æ®å—ï¼Œåˆ°åº•å¤šå°‘ä¸ª pipes å‘¢ï¼Œæ˜¯å¤šä¸ªåº”ç”¨å°±å¤šä¸ª pipe å—ï¼Œ ","date":"2024-09-30","objectID":"/posts/paper-enso/:6:3","tags":["Paper Reading"],"title":"Paper Reading: Enso: A Streaming Interface for NIC-Application Communication (OSDI2023)","uri":"/posts/paper-enso/"},{"categories":null,"content":"Notifications: Contention and Overhead å…è®¸å¤šä¸ª Ens Ì„o Pipes å…±äº«åŒä¸€ä¸ªé€šçŸ¥é˜Ÿåˆ—ï¼ˆÂ§4.1.2ï¼‰ï¼Œå¹¶ä¸”åªæœ‰å¯¹äºæ›´å¤§çš„æ•°æ®æ‰¹æ¬¡æ‰æœ‰é€šçŸ¥åˆ°è¾¾ï¼ˆÂ§4.2ï¼‰è‡ªç„¶åœ°é€šè¿‡ä¿æŒ NIC åœ¨æ›´æ–°é€šçŸ¥ç¼“å†²åŒºæ—¶â€œé¢†å…ˆâ€äº CPU æ¥é˜²æ­¢äº‰ç”¨ï¼Œå¹¶ä¸”ä¹Ÿå‡å°‘äº†é€šä¿¡è¿™äº›é€šçŸ¥çš„ PCIe å¼€é”€ã€‚å½“ CPU è¯»å–ä¸€ä¸ª Ens Ì„o Pipe çš„æ•°æ®æ—¶ï¼ŒNIC æ­£åœ¨ä¸ºåç»­çš„ Ens Ì„o Pipes å†™å…¥æ–°çš„æ¡ç›®ã€‚å› ä¸º CPU æ­£åœ¨å¤„ç†æ›´å¤§çš„æ•°æ®æ‰¹æ¬¡ï¼Œæ‰€ä»¥åœ¨éœ€è¦æ£€æŸ¥é€šçŸ¥ç¼“å†²åŒºä¹‹å‰ï¼Œå®ƒä¼šæ›´å¿™æ›´é•¿æ—¶é—´ã€‚å› æ­¤ï¼Œéšç€çº¿é€Ÿçš„æé«˜ï¼Œä¸¤è€…ä¸å¤ªå¯èƒ½åŒæ—¶è®¿é—®åŒä¸€ä¸ªç¼“å­˜è¡Œã€‚ è¿™é‡Œ FIFO é˜Ÿåˆ—çš„ tail latency åº”è¯¥æ˜¯æ¯”è¾ƒä½çš„ è€Œä¸”å¿…é¡»æ³¨å†Œè¿ç»­çš„åœ°å€ç©ºé—´ï¼Œç±»ä¼¼ RDMAï¼Ÿ åç»­çš„æ²¡æ¥å¾—åŠçœ‹äº† ","date":"2024-09-30","objectID":"/posts/paper-enso/:6:4","tags":["Paper Reading"],"title":"Paper Reading: Enso: A Streaming Interface for NIC-Application Communication (OSDI2023)","uri":"/posts/paper-enso/"},{"categories":null,"content":"Shenango: Achieving High CPU Efficiency for Latency-sensitive Datacenter Workloads è›®çŸ¥åçš„ä¸€ç¯‡æ–‡ç« ï¼Œå¼•ç”¨å¾ˆé«˜ï¼Œåç»­è®ºæ–‡ä¹Ÿæœ‰ ghOStï¼Œå’Œ Efficient Scheduling Policies for Microsecond-scale Tasks presentation ä¹Ÿå¾ˆä¸é”™ï¼Œçœ‹è®ºæ–‡çœ‹åˆ°ç°åœ¨åè€Œæ›´å–œæ¬¢çœ‹ä½œè€…çš„ preï¼Œæœ‰å›¾å°±å¥½ç†è§£ï¼Œå°¤å…¶æ˜¯åŠ¨å›¾ https://cloud.tencent.com/developer/article/2322227 è¿™ç¯‡æ–‡ç« æ€»ç»“çš„ä¸é”™ ç®—æ³•å¾ˆå¥½ç†è§£ï¼Œä½†å®ç°èµ·æ¥åº”è¯¥å¾ˆéš¾ï¼Œä¸å¾—ä¸è¯´ system æ–¹å‘æˆ–è€… network æ–¹å‘çš„è®ºæ–‡éƒ½éå¸¸æ‰å®ï¼Œå¾—å¥½å¥½è¡¥è¡¥åŸºç¡€ã€‚ ","date":"2024-09-30","objectID":"/posts/paper-shenango/:1:0","tags":["Paper Reading"],"title":"Paper Reading: Shenango","uri":"/posts/paper-shenango/"},{"categories":null,"content":"Abstract æ•°æ®ä¸­å¿ƒåº”ç”¨è¦æ±‚æ“ä½œç³»ç»Ÿæä¾›å¾®ç§’çº§å°¾å»¶è¿Ÿå’Œé«˜è¯·æ±‚ç‡ï¼Œ å®ç°å¾®ç§’çº§å»¶è¿Ÿçš„æœ€ä½³å¯ç”¨è§£å†³æ–¹æ¡ˆæ˜¯å†…æ ¸æ—è·¯ç½‘ç»œï¼Œå®ƒå°† CPU æ ¸å¿ƒä¸“é—¨ç”¨äºåº”ç”¨ç¨‹åºè¿›è¡Œç½‘ç»œå¡çš„è‡ªæ—‹è½®è¯¢ã€‚ä½†è¿™ç§æ–¹æ³•æµªè´¹ CPUï¼šå³ä½¿åœ¨é€‚åº¦çš„å¹³å‡è´Ÿè½½ä¸‹ï¼Œä¹Ÿå¿…é¡»ä¸ºé¢„æœŸçš„å³°å€¼è´Ÿè½½åˆ†é…è¶³å¤Ÿçš„æ ¸å¿ƒã€‚ Shenango achieves comparable latencies but at far greater CPU efficiency å®ƒåœ¨éå¸¸ç»†çš„ç²’åº¦ä¸Šâ€”â€”æ¯ 5 å¾®ç§’â€”â€”é‡æ–°åˆ†é…æ ¸å¿ƒç»™åº”ç”¨ç¨‹åºï¼Œä½¿å¾—å»¶è¿Ÿæ•æ„Ÿå‹åº”ç”¨ç¨‹åºæœªä½¿ç”¨çš„å‘¨æœŸå¯ä»¥è¢«æ‰¹å¤„ç†åº”ç”¨ç¨‹åºæœ‰æ•ˆåœ°åˆ©ç”¨ã€‚å®ƒé€šè¿‡(1)ä¸€ç§é«˜æ•ˆçš„ç®—æ³•æ¥æ£€æµ‹åº”ç”¨ç¨‹åºä½•æ—¶ä¼šä»æ›´å¤šæ ¸å¿ƒä¸­å—ç›Šï¼Œä»¥åŠ(2)ä¸€ä¸ªåä¸º IOKernel çš„ç‰¹æƒç»„ä»¶æ¥å®ç°å¦‚æ­¤å¿«é€Ÿçš„é‡æ–°åˆ†é…ç‡ï¼Œè¯¥ç»„ä»¶åœ¨ä¸€ä¸ªä¸“ç”¨æ ¸å¿ƒä¸Šè¿è¡Œï¼Œä» NIC å¼•å¯¼æ•°æ®åŒ…å¹¶åè°ƒæ ¸å¿ƒé‡æ–°åˆ†é…ã€‚åœ¨å¤„ç†å»¶è¿Ÿæ•æ„Ÿå‹åº”ç”¨ç¨‹åºï¼ˆå¦‚ memcachedï¼‰æ—¶ï¼Œæˆ‘ä»¬å‘ç° Shenango å®ç°äº†ä¸ ZygOSï¼ˆä¸€ç§æœ€å…ˆè¿›çš„å†…æ ¸æ—è·¯ç½‘ç»œæ ˆï¼‰ç›¸å½“çš„å°¾å»¶è¿Ÿå’Œååé‡ï¼Œä½†å¯ä»¥çº¿æ€§åœ°å°†å»¶è¿Ÿæ•æ„Ÿå‹åº”ç”¨ç¨‹åºååé‡äº¤æ¢ä¸ºæ‰¹å¤„ç†åº”ç”¨ç¨‹åºååé‡ï¼Œå¤§å¹…æé«˜ CPU æ•ˆç‡ã€‚ efficiency æŒ‡çš„æ˜¯ï¼Ÿ zygOS https://dl.acm.org/doi/10.1145/3132747.3132780 ZygOS åœ¨ IX åŸºç¡€ä¸Šæ„å»ºï¼ˆè®©ç½‘å¡æŠŠä»»åŠ¡åˆ†é…åˆ°å¤šä¸ª CPU æ ¸å¯¹åº”çš„ä¸åŒé˜Ÿåˆ—ï¼‰ï¼Œä¸ºäº†è´Ÿè½½å‡è¡¡ï¼Œç©ºé—²çš„ CPU æ ¸ä»å…¶ä»–æ ¸çš„é˜Ÿåˆ—é‡Œâ€œçªƒå–â€ä»»åŠ¡ï¼ˆwork stealingï¼‰ï¼Œå¹¶åˆ©ç”¨æ ¸é—´ä¸­æ–­ï¼ˆIPIï¼‰é™ä½å“åº”åŒ…çš„å¤„ç†å»¶è¿Ÿã€‚ ","date":"2024-09-30","objectID":"/posts/paper-shenango/:2:0","tags":["Paper Reading"],"title":"Paper Reading: Shenango","uri":"/posts/paper-shenango/"},{"categories":null,"content":"Introduction CPU æ•ˆç‡å˜å¾—è‡³å…³é‡è¦ åƒ ZygOS è¿™æ ·çš„å†…æ ¸æ—è·¯ç½‘ç»œæ ˆèƒ½å¤Ÿé€šè¿‡ç»•è¿‡å†…æ ¸è°ƒåº¦å™¨æ”¯æŒæ›´é«˜ååé‡çš„å¾®ç§’çº§å»¶è¿Ÿ ç„¶è€Œï¼Œè¿™äº›ç³»ç»Ÿä»ç„¶æµªè´¹äº†å¤§é‡çš„ CPU å‘¨æœŸï¼›å®ƒä»¬ä¾èµ–äºè‡ªæ—‹è½®è¯¢ç½‘ç»œæ¥å£å¡ï¼ˆNICï¼‰æ¥æ£€æµ‹æ•°æ®åŒ…åˆ°è¾¾ï¼Œå› æ­¤å³ä½¿æ²¡æœ‰æ•°æ®åŒ…è¦å¤„ç†ï¼ŒCPU ä¹Ÿæ€»æ˜¯åœ¨ä½¿ç”¨ä¸­ ä½å°¾å»¶è¿Ÿå’Œé«˜ CPU æ•ˆç‡ä¹‹é—´çš„ç´§å¼ å…³ç³» ä¸ºä»€ä¹ˆä»Šå¤©çš„ç³»ç»Ÿè¿«ä½¿æˆ‘ä»¬æµªè´¹æ ¸å¿ƒæ¥ç»´æŒå¾®ç§’çº§å»¶è¿Ÿï¼Ÿè°·æ­Œæœ€è¿‘çš„ä¸€ç¯‡è®ºæ–‡è®¤ä¸ºï¼Œç³Ÿç³•çš„å°¾å»¶è¿Ÿå’Œæ•ˆç‡æ˜¯ç”±äºç³»ç»Ÿè½¯ä»¶å·²ç»é’ˆå¯¹æ¯«ç§’çº§ I/Oï¼ˆä¾‹å¦‚ï¼Œç£ç›˜ï¼‰è¿›è¡Œäº†è°ƒæ•´ [15]ã€‚äº‹å®ä¸Šï¼Œä»Šå¤©çš„è°ƒåº¦å™¨åªåœ¨ç²—ç²’åº¦ä¸Šåšå‡ºçº¿ç¨‹å¹³è¡¡å’Œæ ¸å¿ƒåˆ†é…å†³ç­–ï¼ˆLinux æ¯å››æ¯«ç§’ä¸€æ¬¡ï¼ŒArachne [63]å’Œ IX [62]æ¯ 50-100 æ¯«ç§’ä¸€æ¬¡ï¼‰ï¼Œé˜»æ­¢äº†å¯¹è´Ÿè½½ä¸å¹³è¡¡çš„å¿«é€Ÿååº”ã€‚ æœ¬æ–‡ä»‹ç»äº† Shenangoï¼Œä¸€ä¸ªä¸“æ³¨äºå®ç°ä¸‰ä¸ªç›®æ ‡çš„ç³»ç»Ÿï¼šï¼ˆ1ï¼‰ä¸ºæ•°æ®ä¸­å¿ƒåº”ç”¨ç¨‹åºæä¾›å¾®ç§’çº§ç«¯åˆ°ç«¯å°¾å»¶è¿Ÿå’Œé«˜ååé‡ï¼›ï¼ˆ2ï¼‰CPU-efficient packing of applications on multi-core machinesï¼›ï¼ˆ3ï¼‰ç”±äºåŒæ­¥ I/O å’Œæ ‡å‡†çš„ç¼–ç¨‹æŠ½è±¡ï¼ˆå¦‚è½»é‡çº§çº¿ç¨‹å’Œé˜»å¡ TCP ç½‘ç»œå¥—æ¥å­—ï¼‰ï¼Œæé«˜äº†åº”ç”¨ç¨‹åºå¼€å‘è€…çš„ç”Ÿäº§åŠ›ã€‚ åŒæ­¥ IO ä¸ºä»€ä¹ˆå¯ä»¥æé«˜å¼€å‘è€…ç”Ÿäº§åŠ›ï¼Ÿå®¹æ˜“ç†è§£ï¼Ÿé‚£æ”¯æŒå¼‚æ­¥ IO å— ä¸ºäº†å®ç°å…¶ç›®æ ‡ï¼ŒShenango è§£å†³äº†åœ¨éå¸¸ç»†çš„æ—¶é—´å°ºåº¦ä¸Šé‡æ–°åˆ†é…æ ¸å¿ƒåˆ°åº”ç”¨ç¨‹åºçš„éš¾é¢˜ï¼›å®ƒæ¯ 5 å¾®ç§’é‡æ–°åˆ†é…ä¸€æ¬¡æ ¸å¿ƒï¼Œæ¯”æˆ‘ä»¬æ‰€çŸ¥çš„ä»»ä½•ç³»ç»Ÿéƒ½å¿«å‡ ä¸ªæ•°é‡çº§ã€‚Shenango æå‡ºäº†ä¸¤ä¸ªå…³é”®æ€æƒ³ã€‚é¦–å…ˆï¼ŒShenango å¼•å…¥äº†ä¸€ä¸ªé«˜æ•ˆç®—æ³•ï¼Œæ ¹æ®å¯è¿è¡Œçš„çº¿ç¨‹å’Œä¼ å…¥çš„æ•°æ®åŒ…å‡†ç¡®åœ°ç¡®å®šåº”ç”¨ç¨‹åºä½•æ—¶ä¼šä»é¢å¤–çš„æ ¸å¿ƒä¸­å—ç›Šã€‚å…¶æ¬¡ï¼ŒShenango æ¯å°æœºå™¨åˆ†é…ä¸€ä¸ªå¿™ç¢Œçš„ busy-spinning è‡ªæ—‹æ ¸å¿ƒç»™ä¸€ä¸ªåä¸º IOKernel çš„é›†ä¸­å¼è½¯ä»¶å®ä½“ï¼Œè¯¥å®ä½“å°†æ•°æ®åŒ… steers å¼•å¯¼åˆ°åº”ç”¨ç¨‹åºå¹¶è·¨å®ƒä»¬åˆ†é…æ ¸å¿ƒã€‚åº”ç”¨ç¨‹åºåœ¨ç”¨æˆ·çº§è¿è¡Œæ—¶ä¸­è¿è¡Œï¼Œè¿™äº›è¿è¡Œæ—¶æä¾›äº†é«˜æ•ˆçš„é«˜çº§ç¼–ç¨‹æŠ½è±¡ï¼Œå¹¶ä¸ IOKernel é€šä¿¡ä»¥ä¿ƒè¿›æ ¸å¿ƒåˆ†é…ã€‚ Shenango å®ç°äº†ä¸ ZygOS [61]ç›¸ä¼¼çš„ååé‡å’Œå»¶è¿Ÿï¼ŒZygOS æ˜¯ä¸€ç§æœ€å…ˆè¿›çš„å†…æ ¸æ—è·¯ç½‘ç»œæ ˆï¼Œä½† CPU æ•ˆç‡æ›´é«˜ã€‚ä¾‹å¦‚ Shenango å¯ä»¥å®ç°æ¯ç§’è¶…è¿‡äº”ç™¾ä¸‡æ¬¡çš„ memcached ååé‡ï¼ŒåŒæ—¶ä¿æŒ 99.9 ç™¾åˆ†ä½å»¶è¿Ÿä½äº 100 å¾®ç§’ï¼ˆæ¯” ZygOS å¤šä¸€ç™¾ä¸‡ï¼‰ã€‚ ","date":"2024-09-30","objectID":"/posts/paper-shenango/:3:0","tags":["Paper Reading"],"title":"Paper Reading: Shenango","uri":"/posts/paper-shenango/"},{"categories":null,"content":"The Case Against Slow Core Allocators ä¸ºä»€ä¹ˆ millisecond-scale æ¯«ç§’çº§æ ¸å¿ƒåˆ†é…å™¨åœ¨å¤„ç†å¾®ç§’çº§è¯·æ±‚æ—¶æ— æ³•ä¿æŒé«˜ CPU æ•ˆç‡ã€‚æˆ‘ä»¬å°† CPU efficiency å®šä¹‰ä¸ºç”¨äºæ‰§è¡Œåº”ç”¨ç¨‹åºçº§å·¥ä½œï¼ˆè€Œä¸æ˜¯å¿™ç­‰å¾…ã€ä¸Šä¸‹æ–‡åˆ‡æ¢ã€æ•°æ®åŒ…å¤„ç†æˆ–å…¶ä»–ç³»ç»Ÿè½¯ä»¶å¼€é”€ï¼‰çš„å‘¨æœŸæ¯”ä¾‹ã€‚ è¿™ä¸ªå®šä¹‰æ˜¯é€šç”¨çš„å—ï¼Ÿå¦‚æœæ”¹æˆæ¯ 5us åˆ†é…ä¸€æ¬¡ï¼Œå¤„äºç”¨æˆ·çš„æ—¶é—´è‚¯å®šæ›´å¤šï¼Œé‚£ä¹ˆè¿™æ ·çš„ cpu æ•ˆç‡è‚¯å®šæ›´é«˜ï¼Œåå¤„æ˜¯ä»€ä¹ˆå‘¢ åƒ IX[62]å’Œ Arachne[63]è¿™æ ·çš„å·¥ä½œå¼•å…¥äº†ç”¨æˆ·çº§æ ¸å¿ƒåˆ†é…å™¨ï¼Œå®ƒä»¬åœ¨ 50-100 æ¯«ç§’çš„é—´éš”å†…è°ƒæ•´æ ¸å¿ƒåˆ†é…ã€‚åŒæ ·ï¼ŒLinux ä¸»è¦åœ¨æ¯«ç§’çº§å®šæ—¶å™¨æ»´ç­”å“åº”ä¸‹é‡æ–°å¹³è¡¡æ ¸å¿ƒä¸Šçš„ä»»åŠ¡ã€‚ä¸å¹¸çš„æ˜¯ï¼Œæ‰€æœ‰è¿™äº›ç³»ç»Ÿè°ƒæ•´æ ¸å¿ƒçš„é€Ÿåº¦éƒ½å¤ªæ…¢ï¼Œæ— æ³•æœ‰æ•ˆåœ°å¤„ç†å¾®ç§’çº§è¯·æ±‚ã€‚ å›¾ 1 æ˜¾ç¤ºäº†æˆ‘ä»¬æ¨¡æ‹Ÿä¸­æä¾›çš„è´Ÿè½½ä¸ CPU æ•ˆç‡ï¼ˆä½¿ç”¨å‘¨æœŸé™¤ä»¥åˆ†é…å‘¨æœŸï¼‰ä¹‹é—´çš„å…³ç³»ã€‚å®ƒè¿˜æ˜¾ç¤ºäº† Shenango è¿è¡Œæ—¶åœ¨åŒä¸€å·¥ä½œè´Ÿè½½ä¸‹æœ¬åœ°è¿è¡Œçš„æ•ˆç‡ï¼Œé€šè¿‡ç”Ÿæˆä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œæ¯ä¸ªè¯·æ±‚æŒç»­æ—¶é—´çš„åˆæˆå·¥ä½œã€‚å¯¹äºæ¨¡æ‹Ÿç»“æœï¼Œæˆ‘ä»¬ç”¨æ¨¡æ‹Ÿå™¨åˆ†é…çš„æ ¸å¿ƒæ•°æ ‡è®°äº†æ¯ä¸€æ®µçº¿æ®µï¼›é”¯é½¿å½¢æ¨¡å¼ä¹‹æ‰€ä»¥å‡ºç°ï¼Œæ˜¯å› ä¸ºåªèƒ½åˆ†é…æ•´æ•°æ•°é‡çš„æ ¸å¿ƒã€‚å³ä½¿æ²¡æœ‰ç½‘ç»œæˆ–ç³»ç»Ÿè½¯ä»¶å¼€é”€ï¼Œä¹Ÿå¿…é¡»ä¿ç•™å¤§éƒ¨åˆ†ç©ºé—²æ ¸å¿ƒä»¥å¸æ”¶è´Ÿè½½çš„çªå‘ï¼Œå¯¼è‡´ CPU æ•ˆç‡çš„æŸå¤±ã€‚è¿™ç§æŸå¤±åœ¨ä¸€è‡³å››ä¸ªæ ¸å¿ƒä¹‹é—´å°¤ä¸ºä¸¥é‡ï¼Œéšç€è´Ÿè½½çš„å˜åŒ–ï¼Œåº”ç”¨ç¨‹åºå¯èƒ½ä¼šåœ¨è¿™ç§ä½æ•ˆç‡åŒºåŸŸèŠ±è´¹å¤§é‡æ—¶é—´ã€‚ç†æƒ³çš„ç³»ç»Ÿå°†ä¸ºæ¯ä¸ªè¯·æ±‚çš„æŒç»­æ—¶é—´ç²¾ç¡®åœ°å¯åŠ¨ä¸€ä¸ªæ ¸å¿ƒï¼Œå¹¶å®ç°å®Œç¾çš„æ•ˆç‡ï¼Œå› ä¸ºåº”ç”¨ç¨‹åºçº§å·¥ä½œå°†ä¸ CPU å‘¨æœŸä¸€ä¸€å¯¹åº”ã€‚ On the other hand, a slow core allocator is likely to perform worse than its theoretical upper bound in practice. First, CPU efficiency would be even lower if there were more service time variability or tighter tail-latency requirements. service time variability æ‰€ä»¥æ”¯æŒåŠ¨æ€è´Ÿè½½å—ï¼Œshenango æå‡ºçš„ fast core allocation å’Œ TCP æ‹¥å¡æ§åˆ¶å¾ˆåƒï¼Œä½†ä¸ºä»€ä¹ˆæ˜¯ fastï¼Œæ˜æ˜æ˜¯å…ˆåˆ†é…å¾ˆå°‘çš„æ ¸å¿ƒ ","date":"2024-09-30","objectID":"/posts/paper-shenango/:4:0","tags":["Paper Reading"],"title":"Paper Reading: Shenango","uri":"/posts/paper-shenango/"},{"categories":null,"content":"Challenges and Approach Shenango çš„ç›®æ ‡æ˜¯é€šè¿‡å°½å¯èƒ½å°‘åœ°åˆ†é…æ ¸å¿ƒç»™æ¯ä¸ªåº”ç”¨ç¨‹åºæ¥ä¼˜åŒ– CPU æ•ˆç‡ avoiding a condition we call compute congestion, åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœä¸ç»™åº”ç”¨ç¨‹åºåˆ†é…é¢å¤–çš„æ ¸å¿ƒï¼Œå°†å¯¼è‡´å·¥ä½œå»¶è¿Ÿè¶…è¿‡å‡ å¾®ç§’ã€‚è¿™ä¸ªç›®æ ‡é‡Šæ”¾äº†è¢«ä½ä¼°çš„æ ¸å¿ƒä¾›å…¶ä»–åº”ç”¨ç¨‹åºä½¿ç”¨ï¼ŒåŒæ—¶ä»ç„¶ä¿æŒå°¾å»¶è¿Ÿåœ¨æ§åˆ¶ä¹‹ä¸­ã€‚ æ‰€ä»¥å°±æ˜¯é™ä½åˆ†é…æ—¶é—´ï¼Œæ‰€ä»¥èƒ½å¤Ÿé™ä½å°¾éƒ¨å»¶è¿Ÿï¼Œä¸éœ€è¦ç­‰å¤ªä¹…ï¼Œé‚£ä¹ˆå¹³å‡å»¶è¿Ÿä¼šé™ä½å¤šå°‘å‘¢ 5us æ˜¯ç²¾å¿ƒæŒ‘é€‰çš„å€¼å— å°½å¯èƒ½å°‘åœ°åˆ†é…ç»™æ¯ä¸ªåº”ç”¨ç¨‹åºæ ¸å¿ƒæ¥ä¼˜åŒ– CPU æ•ˆç‡ï¼Œè¿™æå‡äº†ä»€ä¹ˆï¼Ÿä¸ä¼šæ›´åŠ æ…¢å—ï¼Œæ‰€ä»¥è¦æ§åˆ¶ç®—æ³•åœ¨å¾®å¦™å†…ï¼Ÿ ç°ä»£æœåŠ¡ç»å¸¸ç»å†éå¸¸é«˜çš„è¯·æ±‚ç‡ï¼ˆå•ä¸ªæœåŠ¡å™¨æ¯ç§’æ•°ç™¾ä¸‡æ•°æ®åŒ…ï¼‰ï¼Œæ ¸å¿ƒåˆ†é…å¼€é”€ä½¿å¾—æŒ‰è¯·æ±‚é‡æ–°åˆ†é…æ ¸å¿ƒå˜å¾—ä¸å¯è¡Œã€‚ç›¸åï¼ŒShenango ç´§å¯†æ¥è¿‘è¿™ä¸ªç†æƒ³ï¼Œæ¯äº”å¾®ç§’æ£€æµ‹ä¸€æ¬¡è´Ÿè½½å˜åŒ–ï¼Œå¹¶æ¯ç§’è°ƒæ•´æ ¸å¿ƒåˆ†é…è¶…è¿‡ 60,000 æ¬¡ã€‚å¦‚æ­¤çŸ­çš„è°ƒæ•´é—´éš”éœ€è¦æ–°çš„æ–¹æ³•æ¥ä¼°è®¡è´Ÿè½½ã€‚æˆ‘ä»¬ç°åœ¨æ›´è¯¦ç»†åœ°è®¨è®ºè¿™äº›æŒ‘æˆ˜ã€‚ estimating load æ€ä¹ˆåš Core allocations impose overhead, åˆ†é…å¸¦æ¥å¼€é”€ï¼šArachne é‡æ–°åˆ†é…ä¸€ä¸ªæ ¸å¿ƒéœ€è¦ 29 å¾®ç§’çš„å»¶è¿Ÿ[63]ï¼Œè€Œ IX éœ€è¦æ•°ç™¾å¾®ç§’ï¼Œå› ä¸ºå®ƒå¿…é¡»æ›´æ–° NIC è§„åˆ™ä»¥å¼•å¯¼æ•°æ®åŒ…åˆ°æ ¸å¿ƒ Estimating required cores is difficult: ä»¥å‰çš„ç³»ç»Ÿä½¿ç”¨åº”ç”¨ç¨‹åºçº§æŒ‡æ ‡ï¼Œå¦‚å»¶è¿Ÿã€ååé‡æˆ–æ ¸å¿ƒåˆ©ç”¨ç‡ï¼Œæ¥ä¼°è®¡é•¿æ—¶é—´å°ºåº¦ä¸Šçš„æ ¸å¿ƒéœ€æ±‚ã€‚Shenango æ—¨åœ¨ä¼°è®¡ç¬æ—¶è´Ÿè½½ï¼Œ è´Ÿè½½ä¼°è®¡çš„åŒºåˆ«åœ¨å“ªï¼Ÿæ€ä¹ˆé¢„ä¼°æ ¸å¿ƒæ•°ï¼Ÿæ‰€ä»¥ shenango å°±å¹²è„†ä¸é¢„ä¼°ï¼Œç›´æ¥ç”¨ congestion æ¥å†·å¯åŠ¨ï¼Ÿ ","date":"2024-09-30","objectID":"/posts/paper-shenango/:5:0","tags":["Paper Reading"],"title":"Paper Reading: Shenango","uri":"/posts/paper-shenango/"},{"categories":null,"content":"Shenangoâ€™s Approach é¦–å…ˆï¼ŒShenango å°†çº¿ç¨‹å’Œæ•°æ®åŒ…æ’é˜Ÿå»¶è¿Ÿéƒ½è§†ä¸ºè®¡ç®—æ‹¥å µçš„ä¿¡å·ï¼Œå®ƒå¼•å…¥äº†ä¸€ä¸ªé«˜æ•ˆçš„æ‹¥å µæ£€æµ‹ç®—æ³•ï¼Œåˆ©ç”¨è¿™äº›ä¿¡å·æ¥å†³å®šå¦‚æœç»™åº”ç”¨ç¨‹åºæ›´å¤šçš„æ ¸å¿ƒæ˜¯å¦ä¼šå—ç›Šã€‚ congestion detection algorithm ç±»ä¼¼ TCP å— æ€ä¹ˆçŸ¥é“æ˜¯ä¸æ˜¯å—ç›Šçš„ å› æ­¤ï¼ŒShenango çš„ç¬¬äºŒä¸ªå…³é”®ç†å¿µæ˜¯ä¸“é—¨åˆ†é…ä¸€ä¸ªæŒç»­è¿è¡Œçš„æ ¸å¿ƒç»™ä¸€ä¸ªç§°ä¸º IOKernelï¼ˆç¬¬ 4 èŠ‚ï¼‰çš„é›†ä¸­å¼è½¯ä»¶å®ä½“ IOKernel è¿›ç¨‹ä»¥ root æƒé™è¿è¡Œï¼Œä½œä¸ºåº”ç”¨ç¨‹åºä¸ç½‘ç»œæ¥å£å¡ç¡¬ä»¶é˜Ÿåˆ—ä¹‹é—´çš„ä¸­ä»‹ã€‚é€šè¿‡æŒç»­è¿è¡Œï¼ŒIOKernel å¯ä»¥åœ¨å¾®ç§’çº§æ£€æŸ¥çº¿ç¨‹å’Œæ•°æ®åŒ…é˜Ÿåˆ—ï¼Œä»¥åè°ƒæ ¸å¿ƒåˆ†é…ã€‚æ­¤å¤–ï¼Œå®ƒå¯ä»¥æä¾›ä½å»¶è¿Ÿçš„ç½‘ç»œè®¿é—®ï¼Œå¹¶å…è®¸åœ¨è½¯ä»¶ä¸­å°†æ•°æ®åŒ…å¯¼å‘æ ¸å¿ƒï¼Œå½“æ ¸å¿ƒè¢«é‡æ–°åˆ†é…æ—¶èƒ½å¤Ÿå¿«é€Ÿé‡æ–°é…ç½®æ•°æ®åŒ…å¯¼å‘è§„åˆ™ã€‚ç»“æœæ˜¯ï¼Œæ ¸å¿ƒé‡æ–°åˆ†é…ä»…éœ€ 5.9 å¾®ç§’å³å¯å®Œæˆï¼Œå¹¶ä¸”éœ€è¦ä¸åˆ°ä¸¤å¾®ç§’çš„ IOKernel è®¡ç®—æ—¶é—´æ¥è¿›è¡Œåè°ƒã€‚è¿™äº›å¼€é”€æ”¯æŒè¶³å¤Ÿå¿«çš„æ ¸å¿ƒåˆ†é…é€Ÿç‡ï¼Œæ—¢èƒ½å¤Ÿé€‚åº”è´Ÿè½½çš„å˜åŒ–ï¼Œä¹Ÿèƒ½è¿…é€Ÿçº æ­£æˆ‘ä»¬çš„æ‹¥å¡æ£€æµ‹ç®—æ³•ä¸­çš„ä»»ä½•è¯¯é¢„æµ‹ã€‚ åº”ç”¨ç¨‹åºé€»è¾‘åœ¨æ¯ä¸ªåº”ç”¨ç¨‹åºçš„è¿è¡Œæ—¶ï¼ˆç¬¬ 5 èŠ‚ï¼‰ä¸­è¿è¡Œï¼Œé€šè¿‡å…±äº«å†…å­˜ä¸ IOKernel é€šä¿¡ï¼ˆå›¾ 2ï¼‰ã€‚æ¯ä¸ªè¿è¡Œæ—¶éƒ½æ˜¯ä¸å¯ä¿¡çš„ï¼Œå¹¶è´Ÿè´£æä¾›æœ‰ç”¨çš„ç¼–ç¨‹æŠ½è±¡ï¼ŒåŒ…æ‹¬çº¿ç¨‹ã€äº’æ–¥é”ã€æ¡ä»¶å˜é‡å’Œç½‘ç»œå¥—æ¥å­—ã€‚åº”ç”¨ç¨‹åºä»¥åº“çš„å½¢å¼é“¾æ¥åˆ° Shenango è¿è¡Œæ—¶ï¼Œå…è®¸ç±»ä¼¼å†…æ ¸çš„åŠŸèƒ½åœ¨å…¶åœ°å€ç©ºé—´å†…è¿è¡Œã€‚ 5.9us æ˜¯å¹³å‡è¿˜æ˜¯æœ€ä½ï¼Ÿ app shared memory å’Œ IOkernel é€šä¿¡ï¼ŒåŒæ­¥é—®é¢˜æ€ä¹ˆè§£å†³ï¼Ÿå°¤å…¶æ˜¯å¤šåˆ†é…æ ¸å¿ƒçš„æ—¶å€™ åœ¨å¯åŠ¨æ—¶ï¼Œè¿è¡Œæ—¶åˆ›å»ºå¤šä¸ªå†…æ ¸çº¿ç¨‹ï¼ˆå³ pthreadsï¼‰ï¼Œæ¯ä¸ªéƒ½æœ‰ä¸€ä¸ªæœ¬åœ°è¿è¡Œé˜Ÿåˆ—ï¼Œæœ€å¤šè¾¾åˆ°è¿è¡Œæ—¶å¯èƒ½ä½¿ç”¨çš„æœ€å¤§æ ¸å¿ƒæ•°ã€‚åº”ç”¨ç¨‹åºé€»è¾‘åœ¨è½»é‡çº§ç”¨æˆ·çº§çº¿ç¨‹ä¸­è¿è¡Œï¼Œè¿™äº›çº¿ç¨‹è¢«æ”¾å…¥è¿™äº›é˜Ÿåˆ—ä¸­ï¼›é€šè¿‡å·¥ä½œçªƒå–å®ç°è·¨æ ¸å¿ƒçš„å·¥ä½œå¹³è¡¡ã€‚æˆ‘ä»¬å°†è¿è¡Œæ—¶åˆ›å»ºçš„æ¯ä¸ªæ¯æ ¸å¿ƒå†…æ ¸çº¿ç¨‹ç§°ä¸º kthreadï¼Œå°†ç”¨æˆ·çº§çº¿ç¨‹ç§°ä¸º uthreadã€‚Shenango è¢«è®¾è®¡ä¸ºèƒ½å¤Ÿåœ¨æœªç»ä¿®æ”¹çš„ Linux ç¯å¢ƒä¸­å…±å­˜ï¼›IOKernel å¯ä»¥é…ç½®ä¸ºç®¡ç†ä¸€éƒ¨åˆ†æ ¸å¿ƒï¼Œè€Œ Linux è°ƒåº¦å™¨ç®¡ç†å…¶ä»–éƒ¨åˆ†ã€‚ steal ","date":"2024-09-30","objectID":"/posts/paper-shenango/:5:1","tags":["Paper Reading"],"title":"Paper Reading: Shenango","uri":"/posts/paper-shenango/"},{"categories":null,"content":"IO Kernel The IOKernel runs on a dedicated core åœ¨ä»»ä½•æ—¶å€™ï¼Œå®ƒå†³å®šä¸ºæ¯ä¸ªåº”ç”¨ç¨‹åºåˆ†é…å¤šå°‘æ ¸å¿ƒï¼ˆ4.1.1 èŠ‚ï¼‰ä»¥åŠåˆ†é…å“ªäº›æ ¸å¿ƒç»™æ¯ä¸ªåº”ç”¨ç¨‹åº å®ƒå¤„ç†æ‰€æœ‰çš„ç½‘ç»œ I/Oï¼Œç»•è¿‡äº†æ“ä½œç³»ç»Ÿå†…æ ¸ã€‚åœ¨æ¥æ”¶è·¯å¾„ä¸Šï¼Œå®ƒç›´æ¥è½®è¯¢ NIC æ¥æ”¶é˜Ÿåˆ—ï¼Œå¹¶å°†æ¯ä¸ªä¼ å…¥çš„æ•°æ®åŒ…æ”¾åˆ°åº”ç”¨ç¨‹åºæ ¸å¿ƒä¹‹ä¸€çš„å…±äº«å†…å­˜é˜Ÿåˆ—ä¸­ã€‚åœ¨ä¼ è¾“è·¯å¾„ä¸Šï¼Œå®ƒè½®è¯¢æ¯ä¸ªè¿è¡Œæ—¶çš„æ•°æ®åŒ…å‡ºå£é˜Ÿåˆ—ï¼Œå¹¶å°†æ•°æ®åŒ…è½¬å‘åˆ° NIC ","date":"2024-09-30","objectID":"/posts/paper-shenango/:6:0","tags":["Paper Reading"],"title":"Paper Reading: Shenango","uri":"/posts/paper-shenango/"},{"categories":null,"content":"Core Allocation IOKernel å¿…é¡»å¿«é€Ÿåšå‡ºæ ¸å¿ƒåˆ†é…å†³ç­–ï¼Œå› ä¸ºå…¶èŠ±è´¹åœ¨æ ¸å¿ƒåˆ†é…ä¸Šçš„ä»»ä½•æ—¶é—´éƒ½ä¸èƒ½ç”¨äºè½¬å‘æ•°æ®åŒ…ï¼Œä»è€Œé™ä½ååé‡ã€‚ä¸ºäº†ç®€åŒ–ï¼ŒIOKernel åˆ†ç¦»äº†å®ƒçš„ä¸¤ä¸ªå†³ç­–ï¼›in most cases, it first decides if an application should be granted an additional core, and then decides which core to grant. Number of cores per application æ¯ä¸ªåº”ç”¨ç¨‹åºçš„è¿è¡Œæ—¶éƒ½ä¼šè¢«åˆ†é…ä¸€å®šæ•°é‡çš„ guaranteed cores å’Œä¸€å®šæ•°é‡çš„ burstable coresã€‚è¿è¡Œæ—¶æ€»æ˜¯æœ‰æƒä½¿ç”¨å…¶ä¿è¯çš„æ ¸å¿ƒï¼Œè€Œä¸ä¼šé¢ä¸´è¢«æŠ¢å çš„é£é™©ï¼ˆä¸å…è®¸è¿‡é‡è®¢é˜…ï¼‰ï¼Œä½†å¦‚æœå®ƒæ²¡æœ‰è¶³å¤Ÿçš„å·¥ä½œæ¥å ç”¨å®ƒä»¬ï¼Œå®ƒå¯ä»¥ä½¿ç”¨æ›´å°‘ï¼ˆç”šè‡³æ˜¯é›¶ï¼‰çš„æ ¸å¿ƒã€‚å½“æœ‰é¢å¤–çš„æ ¸å¿ƒå¯ç”¨æ—¶ï¼ŒIOKernel å¯ä»¥å°†å®ƒä»¬ä½œä¸ºå¯çªå‘æ ¸å¿ƒåˆ†é…ï¼Œä½¿ç¹å¿™çš„è¿è¡Œæ—¶èƒ½å¤Ÿæš‚æ—¶è¶…è¿‡å…¶ä¿è¯çš„æ ¸å¿ƒé™åˆ¶ã€‚ åœ¨å†³å®šä¸ºè¿è¡Œæ—¶åˆ†é…å¤šå°‘æ ¸å¿ƒæ—¶ï¼ŒIOKernel çš„ç›®æ ‡æ˜¯åœ¨é¿å…è®¡ç®—æ‹¥å¡ï¼ˆç¬¬ 3 èŠ‚ï¼‰çš„åŒæ—¶æœ€å°åŒ–åˆ†é…ç»™æ¯ä¸ªè¿è¡Œæ—¶çš„æ ¸å¿ƒæ•°é‡ã€‚ä¸ºäº†ç¡®å®šè¿è¡Œæ—¶æ˜¯å¦æœ‰å¤šä½™çš„æ ¸å¿ƒï¼ŒIOKernel ä¾èµ–äºè¿è¡Œæ—¶çš„ kthread åœ¨ä¸éœ€è¦æ—¶è‡ªæ„¿æ”¾å¼ƒæ ¸å¿ƒã€‚å½“ä¸€ä¸ª kthread æ‰¾ä¸åˆ°ä»»ä½•å·¥ä½œè¦åšï¼Œæ„å‘³ç€å®ƒçš„æœ¬åœ°è¿è¡Œé˜Ÿåˆ—ä¸ºç©ºï¼Œå¹¶ä¸”æ²¡æœ‰ä»å…¶ä»–æ´»è·ƒçš„ kthread ä¸­æ‰¾åˆ°å¯çªƒå–çš„å·¥ä½œæ—¶ï¼Œå®ƒä¼šæ”¾å¼ƒå…¶æ ¸å¿ƒå¹¶é€šçŸ¥ IOKernelï¼ˆæˆ‘ä»¬ç§°ä¹‹ä¸ºåœæ”¾ï¼‰ã€‚IOKernel ä¹Ÿå¯ä»¥éšæ—¶æŠ¢å å¯çªå‘æ ¸å¿ƒï¼Œè¿«ä½¿å®ƒä»¬ç«‹å³åœæ”¾ã€‚ IOKernel åˆ©ç”¨å…¶ç‹¬ç‰¹çš„è§†è§’é€šè¿‡ç›‘æ§æ´»è·ƒ kthread çš„é˜Ÿåˆ—å ç”¨æƒ…å†µæ¥æ£€æµ‹å³å°†å‘ç”Ÿçš„è®¡ç®—æ‹¥å¡ã€‚å½“ä¸€ä¸ªæ•°æ®åŒ…åˆ°è¾¾ä¸€ä¸ªæ²¡æœ‰åˆ†é…æ ¸å¿ƒçš„è¿è¡Œæ—¶ï¼ŒIOKernel ç«‹å³ä¸ºå…¶åˆ†é…ä¸€ä¸ªæ ¸å¿ƒã€‚ä¸ºäº†ç›‘æµ‹æ´»è·ƒè¿è¡Œæ—¶çš„æ‹¥å¡æƒ…å†µï¼ŒIOKernel æ¯ 5 å¾®ç§’è°ƒç”¨ä¸€æ¬¡æ‹¥å¡æ£€æµ‹ç®—æ³•ï¼ˆç®—æ³• 1ï¼‰ã€‚ æ‹¥å¡æ£€æµ‹ç®—æ³•æ ¹æ®ä¸¤ç§è´Ÿè½½æºåˆ¤æ–­ä¸€ä¸ªè¿è¡Œæ—¶æ˜¯å¦è¶…è½½ï¼šæ’é˜Ÿçš„çº¿ç¨‹å’Œæ’é˜Ÿçš„å…¥ç«™æ•°æ®åŒ…ã€‚å¦‚æœåœ¨æ‹¥å¡æ£€æµ‹ç®—æ³•è¿ç»­ä¸¤æ¬¡è¿è¡Œä¸­å‘ç°ä»»ä½•é¡¹ç›®å­˜åœ¨äºé˜Ÿåˆ—ä¸­ï¼Œåˆ™è¡¨æ˜ä¸€ä¸ªæ•°æ®åŒ…æˆ–çº¿ç¨‹è‡³å°‘æ’é˜Ÿäº† 5 å¾®ç§’ã€‚å› ä¸ºæ’é˜Ÿçš„æ•°æ®åŒ…æˆ–çº¿ç¨‹ä»£è¡¨äº†å¯ä»¥åœ¨å¦ä¸€ä¸ªæ ¸å¿ƒä¸Šå¹¶è¡Œå¤„ç†çš„å·¥ä½œï¼Œè¿è¡Œæ—¶è¢«è®¤ä¸ºâ€œæ‹¥å¡â€ï¼ŒIOKernel ä¼šä¸ºå…¶åˆ†é…ä¸€ä¸ªé¢å¤–çš„æ ¸å¿ƒã€‚æˆ‘ä»¬å‘ç°ï¼Œæ’é˜Ÿçš„æŒç»­æ—¶é—´æ¯”é˜Ÿåˆ—é•¿åº¦æ˜¯ä¸€ä¸ªæ›´ç¨³å¥çš„ä¿¡å·ï¼Œå› ä¸ºä½¿ç”¨é˜Ÿåˆ—é•¿åº¦éœ€è¦ä»”ç»†è°ƒæ•´ä¸åŒè¯·æ±‚æŒç»­æ—¶é—´çš„é˜ˆå€¼å‚æ•°[63, 74]ã€‚ å°†é˜Ÿåˆ—å®ç°ä¸ºç¯å½¢ç¼“å†²åŒºå¯ä»¥å®ç°ç®€å•ä¸”é«˜æ•ˆçš„æ£€æµ‹æœºåˆ¶ã€‚æ£€æµ‹ä¸€ä¸ªé¡¹ç›®æ˜¯å¦åœ¨é˜Ÿåˆ—ä¸­å­˜åœ¨ä¸¤ä¸ªè¿ç»­çš„æ—¶é—´é—´éš”åªæ˜¯ä¸€ä¸ªæ¯”è¾ƒå½“å‰å¤´éƒ¨æŒ‡é’ˆä¸å‰ä¸€æ¬¡è¿­ä»£çš„å°¾éƒ¨æŒ‡é’ˆçš„é—®é¢˜ã€‚è¿è¡Œæ—¶é€šè¿‡æ¯ä¸ª kthread çš„å•ä¸ªç¼“å­˜è¡Œçš„å…±äº«å†…å­˜å‘ IOKernel æš´éœ²è¿™ç§çŠ¶æ€ã€‚ ç›´è§‚ä¸Šï¼Œæ ¸å¿ƒåˆ†é…å¯èƒ½ä¼šè¡¨ç°å‡ºæŒ¯è¡è¡Œä¸ºï¼Œå¯èƒ½æ¯æ¬¡è¿­ä»£éƒ½ä¼šæ·»åŠ å’Œåœæ”¾ä¸€ä¸ªæ ¸å¿ƒã€‚è¿™æ˜¯è®¾è®¡çš„ä¸€éƒ¨åˆ†ï¼Œå› ä¸ºè¾ƒæ…¢çš„è°ƒæ•´è¦ä¹ˆç‰ºç‰²å°¾éƒ¨å»¶è¿Ÿï¼Œè¦ä¹ˆé˜»æ­¢æˆ‘ä»¬åœ¨çŸ­æ—¶é—´å†…å¤ç”¨æ ¸å¿ƒã€‚äº‹å®ä¸Šï¼Œç°ä»£ CPU èƒ½å¤Ÿè¿›è¡Œè¶³å¤Ÿé«˜æ•ˆçš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼›è¿›ç¨‹ä¸Šä¸‹æ–‡æ ‡è¯†ç¬¦ï¼ˆPCIDsï¼‰å…è®¸åœ¨ä¸åˆ·æ–° TLB çš„æƒ…å†µä¸‹äº¤æ¢é¡µè¡¨ã€‚Linux åˆ‡æ¢è¿›ç¨‹å¤§çº¦éœ€è¦ 600 çº³ç§’ï¼Œå› æ­¤è¶³ä»¥å¤„ç†ç”± IOKernel äº§ç”Ÿçš„æ ¸å¿ƒé‡æ–°åˆ†é…é€Ÿç‡ã€‚åœ¨ç¬¬ 7.3 èŠ‚ä¸­ï¼Œæˆ‘ä»¬è¯„ä¼°äº†ä¸åŒçš„æ ¸å¿ƒåˆ†é…é—´éš”å¯¹å°¾éƒ¨å»¶è¿Ÿå’Œ CPU æ•ˆç‡çš„å½±å“ã€‚ æ‹¥å¡ç®—æ³•ï¼Œå…ˆæ”¾å‡ ä¸ªçº¿ç¨‹/æ ¸å¿ƒï¼Œç„¶åæ€ä¹ˆåˆ¤æ–­å†ç»™åç»­çš„ï¼Ÿ Which cores for each application When deciding which core to grant to an application, the IOKernel considers three factors: Hyper-threading efficiency, Intel çš„è¶…çº¿ç¨‹æŠ€æœ¯å…è®¸ä¸¤ä¸ªç¡¬ä»¶çº¿ç¨‹åœ¨åŒä¸€ç‰©ç†æ ¸å¿ƒä¸Šè¿è¡Œã€‚è¿™äº›çº¿ç¨‹å…±äº«å¤„ç†å™¨èµ„æºï¼Œå¦‚ L1 å’Œ L2 ç¼“å­˜åŠæ‰§è¡Œå•å…ƒï¼Œä½†è¢«æš´éœ²ä¸ºä¸¤ä¸ªç‹¬ç«‹çš„é€»è¾‘æ ¸å¿ƒï¼Œå› æ­¤ï¼ŒIOKernel å€¾å‘äºå°†åŒä¸€ç‰©ç†æ ¸å¿ƒä¸Šçš„è¶…çº¿ç¨‹åˆ†é…ç»™åŒä¸€åº”ç”¨ç¨‹åºã€‚ Cache locality, å¦‚æœä¸€ä¸ªåº”ç”¨ç¨‹åºçš„çŠ¶æ€å·²ç»å­˜åœ¨äºæ–°åˆ†é…ç»™å®ƒçš„æ ¸å¿ƒçš„ L1/L2 ç¼“å­˜ä¸­ï¼Œå®ƒå¯ä»¥é¿å…è®¸å¤šè€—æ—¶çš„ç¼“å­˜æœªå‘½ä¸­ã€‚å› æ­¤ï¼ŒIOKernel è·Ÿè¸ªè¿è¡Œæ—¶çš„å½“å‰å’Œè¿‡å»çš„æ ¸å¿ƒåˆ†é…æƒ…å†µã€‚ Latency, å› æ­¤ï¼Œå¦‚æœå­˜åœ¨ç©ºé—²æ ¸å¿ƒï¼ŒIOKernel æ€»æ˜¯é€‰æ‹©ä¸€ä¸ªç©ºé—²æ ¸å¿ƒè€Œä¸æ˜¯æŠ¢å ä¸€ä¸ªå¿™ç¢Œçš„æ ¸å¿ƒã€‚ å¦‚ä½•è·Ÿè¸ªï¼Ÿå“ˆå¸Œè¡¨ï¼Ÿ ä¸€æ—¦ IOKernel é€‰æ‹©äº†è¦åˆ†é…ç»™åº”ç”¨ç¨‹åºçš„æ ¸å¿ƒï¼Œå®ƒè¿˜å¿…é¡»é€‰æ‹©ä¸€ä¸ªå·²åœæ”¾çš„ kthread æ¥å”¤é†’å¹¶åœ¨è¯¥æ ¸å¿ƒä¸Šè¿è¡Œã€‚ä¸ºäº†ç¼“å­˜å±€éƒ¨æ€§ï¼Œå®ƒé¦–å…ˆå°è¯•æŒ‘é€‰æœ€è¿‘åœ¨è¿™ä¸ªæ ¸å¿ƒä¸Šè¿è¡Œè¿‡çš„ kthreadã€‚å¦‚æœæ²¡æœ‰è¿™æ ·çš„ kthread å¯ç”¨ï¼ŒIOKernel ä¼šé€‰æ‹©åœæ”¾æ—¶é—´æœ€é•¿çš„ kthreadï¼Œè¿™æ ·å¯ä»¥ç•™å‡ºå…¶ä»–åœæ”¾çš„ kthreadï¼Œä»¥é˜²å®ƒä»¬æœ€è¿‘è¿è¡Œè¿‡çš„æŸä¸ªæ ¸å¿ƒå˜å¾—å¯ç”¨ã€‚ è°ƒç”¨æ£€æµ‹ç®—æ³•çš„æ€»æˆæœ¬ä¸æ€»æ ¸å¿ƒæ•°é‡æˆçº¿æ€§å…³ç³»ã€‚ shenango é•¿æœŸè¿è¡Œä¼šæ€ä¹ˆæ ·ï¼Œä¼šä¸ä¼šå­˜åœ¨è¿½è¸ªå¾ˆä¹…çš„è®°å½• ","date":"2024-09-30","objectID":"/posts/paper-shenango/:6:1","tags":["Paper Reading"],"title":"Paper Reading: Shenango","uri":"/posts/paper-shenango/"},{"categories":null,"content":"Dataplane The IOKernel busy loops, continuously polling the incoming NIC packet queue and the outgoing application packet queues. Packet steering. ç”±äº IOKernel è·Ÿè¸ªå±äºæ¯ä¸ªè¿è¡Œæ—¶çš„æ ¸å¿ƒï¼Œå› æ­¤å®ƒå¯ä»¥å°†ä¼ å…¥çš„æ•°æ®åŒ…ç›´æ¥äº¤ä»˜ç»™è¿è¡Œé€‚å½“è¿è¡Œæ—¶çš„æ ¸å¿ƒã€‚åœ¨ Shenango ä¸­ï¼Œæ¯ä¸ªè¿è¡Œæ—¶éƒ½é…ç½®äº†è‡ªå·±çš„ IP å’Œ MAC åœ°å€ã€‚å½“ä¸€ä¸ªæ–°çš„æ•°æ®åŒ…åˆ°è¾¾æ—¶ï¼ŒIOKernel é€šè¿‡åœ¨å“ˆå¸Œè¡¨ä¸­æŸ¥æ‰¾ MAC åœ°å€æ¥è¯†åˆ«å…¶è¿è¡Œæ—¶ã€‚ç„¶åï¼ŒIOKernel ä½¿ç”¨ RSS å“ˆå¸Œé€‰æ‹©è¯¥è¿è¡Œæ—¶å†…çš„ä¸€ä¸ªæ ¸å¿ƒï¼Œå¹¶å°†æ•°æ®åŒ…æ”¾å…¥è¯¥æ ¸å¿ƒçš„å…¥ç«™æ•°æ®åŒ…é˜Ÿåˆ—ä¸­ã€‚è™½ç„¶ Shenango å¶å°”ä¼šé‡æ–°æ’åºæ•°æ®åŒ…ï¼ˆä¾‹å¦‚ï¼Œå½“åˆ†é…ç»™è¿è¡Œæ—¶çš„æ ¸å¿ƒæ•°é‡å‘ç”Ÿå˜åŒ–æ—¶ï¼‰ï¼Œä½†æˆ‘ä»¬å‘ç°ï¼Œåœ¨çŸ­æ—¶é—´é—´éš”å†…ï¼ŒåŒä¸€æµä¸­çš„æ•°æ®åŒ…é€šå¸¸ä¼šåˆ°è¾¾åŒä¸€ä¸ªè¿è¡Œæ—¶çš„å…¥ç«™æ•°æ®åŒ…é˜Ÿåˆ—ï¼ˆç¬¬ 7.3 èŠ‚ï¼‰ã€‚æˆ‘ä»¬çš„ç³»ç»Ÿå¯ä»¥é€šè¿‡é‡‡ç”¨ç±»ä¼¼ Intel çš„ Flow Director [8] æˆ– FlexNIC [42] ç­‰æŠ€æœ¯è¿›ä¸€æ­¥ä¼˜åŒ–æ•°æ®åŒ…è½¬å‘ã€‚ RSS hash, Receive side scaling ç½‘å¡ä¸Šçš„è·¨æ ¸æ”¶å‘ é€šè¿‡å“ˆå¸Œåˆ†å‘ Polling transmission queues. ä¸ºäº†æ‰¾åˆ°è¦ä¼ è¾“çš„æ•°æ®åŒ…è€Œè½®è¯¢å¤šä¸ªå‡ºç«™é˜Ÿåˆ—å¯èƒ½ä¼šå¸¦æ¥è¾ƒé«˜çš„ CPU å¼€é”€ï¼Œå°¤å…¶æ˜¯åœ¨å…·æœ‰è®¸å¤šé˜Ÿåˆ—çš„ç³»ç»Ÿä¸­ [68]ã€‚ç”±äº IOKernel è·Ÿè¸ªå“ªäº› kthread æ˜¯æ´»è·ƒçš„ï¼Œå®ƒåªè½®è¯¢å¯¹åº”äºæ´»è·ƒ kthread çš„å‡ºç«™è¿è¡Œæ—¶æ•°æ®åŒ…é˜Ÿåˆ—ã€‚è¿™ä½¿å¾—è½®è¯¢å‡ºç«™é˜Ÿåˆ—çš„ CPU å¼€é”€å¯ä»¥æ ¹æ®ç³»ç»Ÿä¸­çš„æ ¸å¿ƒæ•°é‡è¿›è¡Œæ‰©å±•ã€‚ IOKernel çš„æ ¸å¿ƒä¼šå¤„ç†åˆ«çš„äº‹æƒ…å—ï¼Œä¼šå¸¦æ¥å…¶ä»–çš„ç¼“å­˜ä¸€è‡´æ€§é—®é¢˜å— ","date":"2024-09-30","objectID":"/posts/paper-shenango/:6:2","tags":["Paper Reading"],"title":"Paper Reading: Shenango","uri":"/posts/paper-shenango/"},{"categories":null,"content":"Runtime Shenango çš„è¿è¡Œæ—¶ç»è¿‡ä¼˜åŒ–ä»¥æé«˜ç¼–ç¨‹æ€§ï¼Œæä¾›äº†é«˜çº§æŠ½è±¡ï¼Œå¦‚é˜»å¡çš„ TCP ç½‘ç»œå¥—æ¥å­—å’Œè½»é‡çº§çº¿ç¨‹ã€‚ ","date":"2024-09-30","objectID":"/posts/paper-shenango/:7:0","tags":["Paper Reading"],"title":"Paper Reading: Shenango","uri":"/posts/paper-shenango/"},{"categories":null,"content":"Scheduling è¿è¡Œæ—¶åœ¨ç”± IOKernel åŠ¨æ€åˆ†é…ç»™å®ƒçš„æ ¸å¿ƒä¹‹é—´è¿›è¡Œåº”ç”¨å†…éƒ¨çš„è°ƒåº¦ã€‚ æˆ‘ä»¬çš„è¿è¡Œæ—¶å›´ç»•æ¯ä¸ª kthread çš„è¿è¡Œé˜Ÿåˆ—å’Œå·¥ä½œçªƒå–æ„å»ºï¼Œç±»ä¼¼äº Go [6]ï¼Œä¸ Arachne çš„å·¥ä½œå…±äº«æ¨¡å‹ [63] ç›¸å åº”è¯¥è¯´ç±»ä¼¼ GMPï¼Ÿ å—åˆ° ZygOS çš„å¯å‘ï¼Œæˆ‘ä»¬å¯¹ uthread è¿›è¡Œç»†ç²’åº¦çš„å·¥ä½œçªƒå–ä»¥å‡å°‘å°¾éƒ¨å»¶è¿Ÿï¼Œè¿™å¯¹å…·æœ‰æœåŠ¡æ—¶é—´å˜åŒ–çš„å·¥ä½œè´Ÿè½½ç‰¹åˆ«æœ‰ç›Š stealing å¯ä»¥å‡å°‘ tail latency çš„åŸå› æ˜¯ä»€ä¹ˆ ","date":"2024-09-30","objectID":"/posts/paper-shenango/:7:1","tags":["Paper Reading"],"title":"Paper Reading: Shenango","uri":"/posts/paper-shenango/"},{"categories":null,"content":"Networking æˆ‘ä»¬çš„è¿è¡Œæ—¶è´Ÿè´£ä¸ºåº”ç”¨ç¨‹åºæä¾›æ‰€æœ‰ç½‘ç»œåŠŸèƒ½ï¼ŒåŒ…æ‹¬ UDP å’Œ TCP åè®®å¤„ç†ã€‚ On the other hand, we found that there were significant advantages to relaxing ordering requirements and violating flow consistent hashing è¿™æ˜¯ä¸ºä»€ä¹ˆï¼Œä¸éœ€è¦æ’åºï¼Ÿ Berkeley Sockets æ˜¯ BSD å—ï¼Œå’Œ posix çš„å…³ç³»æ˜¯ä»€ä¹ˆ http://www.openss7.org/papers/strsock/sockimp.pdf æœ¬è´¨ä¸Šçœ‹æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œä¸ºä»€ä¹ˆè®ºæ–‡ä¸åŸºäº POSIXï¼Ÿ An earlier version of the runtime attempted to support zero-copy networking ç„¶è€Œï¼Œæˆ‘ä»¬å‘ç°è¿™ç§æ–¹æ³•å­˜åœ¨ä¸¥é‡çš„é—®é¢˜ã€‚é¦–å…ˆï¼Œå®ƒéœ€è¦ API æ›´æ”¹ï¼Œç ´åäº†ä¸ Berkeley Sockets çš„å…¼å®¹æ€§ã€‚å…¶æ¬¡ï¼Œæˆ‘ä»¬æƒŠè®¶åœ°å‘ç°å®ƒå¯¹æ€§èƒ½æœ‰è´Ÿé¢å½±å“ã€‚è¿›ä¸€æ­¥è°ƒæŸ¥åï¼Œæˆ‘ä»¬å‘ç° IOKernel çš„ååé‡å¯¹é©»ç•™ç¼“å†²åŒºçš„æ•°é‡æ•æ„Ÿï¼Œå› ä¸º DDIOï¼ˆä¸€ç§å°†æ•°æ®åŒ…æœ‰æ•ˆè½½è·ç›´æ¥æ¨é€åˆ° LLC çš„ Intel æŠ€æœ¯ï¼‰å¯¹æ•°æ®åŒ…æ•°æ®å¯ä»¥å ç”¨çš„æœ€å¤§ç¼“å­˜è¡Œæ•°æœ‰é™åˆ¶ã€‚å½“è¶…è¿‡è¿™ä¸ªé™åˆ¶æ—¶ï¼Œæ•°æ®åŒ…æ•°æ®è¢«æ¨é€åˆ° RAMï¼Œå¤§å¤§å¢åŠ äº†è®¿é—®å»¶è¿Ÿã€‚é€šè¿‡å¤åˆ¶æœ‰æ•ˆè½½è·ï¼Œæˆ‘ä»¬å¯ä»¥é¼“åŠ± DDIO é‡ç”¨ç›¸åŒçš„ç¼“å†²åŒºï¼Œä»è€Œä¿æŒåœ¨å…¶ç¼“å­˜å ç”¨é˜ˆå€¼å†…ã€‚è¿™ä¸â€œæ³„æ¼çš„ DMAâ€é—®é¢˜ [70] ç±»ä¼¼ã€‚ æ²¡çœ‹æ‡‚ï¼Œæœ‰ç‚¹éš¾ç†è§£ã€‚ ","date":"2024-09-30","objectID":"/posts/paper-shenango/:7:2","tags":["Paper Reading"],"title":"Paper Reading: Shenango","uri":"/posts/paper-shenango/"},{"categories":null,"content":"Implementation IOKernel \u0026\u0026 runtime Shenango ç”¨ C è¯­è¨€å®ç°ï¼Œå¹¶åŒ…æ‹¬ C++ å’Œ Rust çš„ç»‘å®š IOKernel ç”± 2,244 è¡Œä»£ç ï¼ˆLOCï¼‰å®ç°ï¼Œè¿è¡Œæ—¶ç”± 6,155 è¡Œä»£ç å®ç°ã€‚ IOKernel ä½¿ç”¨ Intel æ•°æ®å¹³é¢å¼€å‘å¥—ä»¶ï¼ˆDPDKï¼‰[2] ç‰ˆæœ¬ 18.11ï¼Œä»¥å¿«é€Ÿä»ç”¨æˆ·ç©ºé—´è®¿é—® NIC é˜Ÿåˆ—ã€‚æ•´ä¸ªç³»ç»Ÿåœ¨æœªç»ä¿®æ”¹çš„ Linux ç¯å¢ƒä¸­è¿è¡Œã€‚ åŒæ ·ç”¨äº† DPDK ","date":"2024-09-30","objectID":"/posts/paper-shenango/:8:0","tags":["Paper Reading"],"title":"Paper Reading: Shenango","uri":"/posts/paper-shenango/"},{"categories":null,"content":"IOKernel Implementation Shenango ä¾èµ–äºå‡ ä¸ª Linux å†…æ ¸æœºåˆ¶æ¥å°†çº¿ç¨‹å›ºå®šåˆ°æ ¸å¿ƒï¼Œå¹¶åœ¨ IOKernel å’Œè¿è¡Œæ—¶ä¹‹é—´è¿›è¡Œé€šä¿¡ è¿è¡Œæ—¶è®¾ç½®äº†ä¸€ç³»åˆ—æè¿°ç¬¦ç¯é˜Ÿåˆ—ï¼ˆçµæ„Ÿæ¥è‡ª Barrelfish çš„è½»é‡çº§ RPC å®ç° [17]ï¼‰ ä¸ºäº†å°†è¿è¡Œæ—¶çš„ kthread åˆ†é…åˆ°ç‰¹å®šçš„æ ¸å¿ƒï¼ŒIOKernel ä½¿ç”¨ sched_setaffinityã€‚ IOKernel åˆ°åº•æ€ä¹ˆè¿½è¸ªåº”ç”¨ä½¿ç”¨è¿‡å“ªäº› thread? ","date":"2024-09-30","objectID":"/posts/paper-shenango/:8:1","tags":["Paper Reading"],"title":"Paper Reading: Shenango","uri":"/posts/paper-shenango/"},{"categories":null,"content":"Runtime Implementation æˆ‘ä»¬çš„è¿è¡Œæ—¶åŒ…æ‹¬å¯¹è½»é‡çº§çº¿ç¨‹ã€äº’æ–¥é”ã€æ¡ä»¶å˜é‡ã€è¯»-å¤åˆ¶-æ›´æ–°ï¼ˆRCUï¼‰ã€é«˜åˆ†è¾¨ç‡å®šæ—¶å™¨ä»¥åŠåŒæ­¥çš„ TCP å’Œ UDP å¥—æ¥å­—çš„æ”¯æŒã€‚ä¸ IOKernel ä¸€æ ·ï¼Œè¿è¡Œæ—¶ä½¿ç”¨æœ‰é™çš„ä¸€ç»„ç°æœ‰çš„ Linux åŸè¯­ï¼›å®ƒé€šè¿‡ mmap åˆ†é…å†…å­˜ï¼Œé€šè¿‡è°ƒç”¨ pthread_create() åˆ›å»º kthreadï¼Œå¹¶é€šè¿‡å…±äº«å†…å­˜ã€eventfd æ–‡ä»¶æè¿°ç¬¦å’Œä¿¡å·ä¸ IOKernel äº¤äº’ã€‚æˆ‘ä»¬æ ¹æ® RFC [36] ä»å¤´å®ç° TCPï¼Œæˆ‘ä»¬çš„ TCP å †æ ˆä¸ Linux å’Œ ZygOS çš„ TCP å †æ ˆå…¼å®¹ï¼ŒåŒ…æ‹¬æµé‡æ§åˆ¶å’Œå¿«é€Ÿé‡ä¼ ï¼Œä½†ä¸åŒ…æ‹¬æ‹¥å¡æ§åˆ¶ã€‚ RCU è¿™ä¸ªå‘¨æœ«ä¸€å®šçœ‹ å…¶ä»–æŠ€æœ¯éƒ½æ˜¯å¾ˆåº•å±‚çš„ï¼Œæ“ä½œç³»ç»Ÿåº”è¯¥è¦äº†è§£çš„ shenango è¿˜å®ç°äº† TCPï¼Œæ˜¯åŸºäº dpdk åšçš„å—ï¼Œä¸ºä»€ä¹ˆä¸åšæ›´å¿«çš„åè®®å‘¢ ä¸ºäº†æé«˜å†…å­˜åˆ†é…æ€§èƒ½ï¼Œè¿è¡Œæ—¶ä½¿ç”¨äº†æ¯ä¸ª kthread çš„ç¼“å­˜ [21]ï¼Œç‰¹åˆ«æ˜¯åœ¨åˆ†é…çº¿ç¨‹æ ˆå’Œç½‘ç»œæ•°æ®åŒ…ç¼“å†²åŒºæ—¶ã€‚è¿è¡Œæ—¶æä¾›äº†ä¸€ä¸ª RCU å­ç³»ç»Ÿï¼Œä»¥æ”¯æŒå¯¹ä¸»è¦è¯»å–çš„æ•°æ®ç»“æ„çš„é«˜æ•ˆè®¿é—® [52]ã€‚è¿è¡Œæ—¶åœ¨æ¯ä¸ª kthread é‡æ–°è°ƒåº¦åæ£€æµ‹ä¸€ä¸ªç©ºé—²æœŸï¼Œä»¥ä¾¿é‡Šæ”¾ä»»ä½•è¿‡æœŸçš„ RCU å¯¹è±¡ã€‚å†…éƒ¨ï¼ŒRCU ç”¨äº ARP è¡¨ä»¥åŠ TCP å’Œ UDP å¥—æ¥å­—è¡¨ã€‚ Shenango æä¾›äº† C++ å’Œ Rust çš„ç»‘å®šï¼Œå…·æœ‰æƒ¯ç”¨çš„æ¥å£ï¼ˆä¾‹å¦‚ï¼Œåƒ std::threadï¼‰å’Œåˆ†åˆ«æ”¯æŒ lambda å’Œé—­åŒ…çš„åŠŸèƒ½ã€‚å¤§å¤šæ•°ç»‘å®šéƒ½æ˜¯å›´ç»•åº•å±‚ C åº“çš„è–„åŒ…è£…ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬çš„ uthread æ”¯æŒåˆ©ç”¨äº†ä¸€ä¸ªç‹¬ç‰¹çš„ä¼˜åŒ–ã€‚æˆ‘ä»¬æ‰©å±•äº† Shenango çš„ spawn å‡½æ•°ï¼Œåœ¨æ¯ä¸ª uthread æ ˆçš„åº•éƒ¨é¢„ç•™ç©ºé—´ç”¨äºè·³æ¿æ•°æ®ï¼ˆæ•è·ã€è¿”å›å€¼ç©ºé—´ç­‰ï¼‰ï¼Œé¿å…äº†é¢å¤–çš„åˆ†é…ã€‚ Preemption. å½“ IOKernel å‘é€ SIGUSR1 ä¿¡å·æ—¶ï¼ŒLinux å†…æ ¸ä¼šå°† CPU çŠ¶æ€ä¿å­˜åˆ°çº¿ç¨‹æ ˆä¸Šçš„ trapframe ä¸­ï¼Œå¹¶è°ƒç”¨è¿è¡Œæ—¶å®‰è£…çš„ä¿¡å·å¤„ç†ç¨‹åºã€‚ä¿¡å·å¤„ç†ç¨‹åºç«‹å³å°†æ§åˆ¶æƒè½¬ç§»åˆ°è°ƒåº¦å™¨ä¸Šä¸‹æ–‡å¹¶åœè½¦ï¼Œå°†è¢«æŠ¢å çš„ uthread é‡æ–°æ”¾å›è¿è¡Œé˜Ÿåˆ—ã€‚è¿è¡Œä¸­çš„ uthread æœ€ç»ˆå¯èƒ½è¢«å¦ä¸€ä¸ª kthread çªƒå–ï¼Œæˆ–è€…å¦‚æœé‡æ–°åˆ†é…åˆ°æ ¸å¿ƒåˆ™åœ¨åŒä¸€ kthread ä¸Šæ¢å¤è¿è¡Œã€‚ GMP? cooperative åœ¨è¿è¡Œæ—¶æ‰§è¡Œçš„æŸäº›å…³é”®éƒ¨åˆ†ï¼Œé€šè¿‡å¢åŠ çº¿ç¨‹æœ¬åœ°è®¡æ•°å™¨æ¥å»¶è¿ŸæŠ¢å ä¿¡å·ã€‚è¿™äº›éƒ¨åˆ†åŒ…æ‹¬æ•´ä¸ªè°ƒåº¦å™¨ä¸Šä¸‹æ–‡ã€RCU å’Œè‡ªæ—‹é”çš„å…³é”®éƒ¨åˆ†ï¼Œä»¥åŠè®¿é—®æ¯ä¸ª kthread çŠ¶æ€çš„ä»£ç åŒºåŸŸã€‚æ”¯æŒæ´»åŠ¨ uthread çš„æŠ¢å å¸¦æ¥äº†ä¸€äº›æŒ‘æˆ˜ã€‚å¦‚æœçº¿ç¨‹ä¸Šä¸‹æ–‡å¼€å§‹åœ¨ä¸åŒçš„ kthread ä¸Šæ‰§è¡Œï¼ŒæŒ‡å‘ thread-local storageï¼ˆTLSï¼‰çš„æŒ‡é’ˆå¯èƒ½ä¼šå˜å¾—é™ˆæ—§ã€‚ä¸å¹¸çš„æ˜¯ï¼Œgcc æ²¡æœ‰æä¾›ç¦ç”¨è¿™äº›åœ°å€ç¼“å­˜çš„æ–¹æ³•ã€‚æ®æˆ‘ä»¬æ‰€çŸ¥ï¼ŒMicrosoft çš„ C++ ç¼–è¯‘å™¨æ˜¯å”¯ä¸€æ”¯æŒè¿™ä¸€ç‚¹çš„ç¼–è¯‘å™¨ã€‚ä½œä¸ºå˜é€šæ–¹æ¡ˆï¼Œæˆ‘ä»¬ä½¿ç”¨è‡ªå·±çš„ TLS æœºåˆ¶æ¥å¤„ç†åœ¨è°ƒåº¦å™¨ä¸Šä¸‹æ–‡ä¹‹å¤–è®¿é—®çš„æ¯ä¸ª kthread æ•°æ®ç»“æ„ï¼Œå¹¶ä¸”ç›®å‰è¦æ±‚åº”ç”¨ç¨‹åºåœ¨è®¿é—®çº¿ç¨‹æœ¬åœ°å˜é‡ï¼ˆåŒ…æ‹¬ glibc çš„ malloc å’Œ freeï¼‰æ—¶ç¦ç”¨æŠ¢å ã€‚æˆ‘ä»¬æ­£åœ¨è€ƒè™‘æ‰©å±•è¿è¡Œæ—¶ä»¥æ”¯æŒæ¯ä¸ª uthread çš„ TLSï¼Œä»è€Œå‡è½»å¼€å‘è€…çš„è´Ÿæ‹…ã€‚ç„¶è€Œï¼ŒTLS æ•°æ®éƒ¨åˆ†å¿…é¡»ä¿æŒè¾ƒå°ï¼Œä»¥é˜²æ­¢åœ¨åˆ›å»º uthread æ—¶å‡ºç°è¾ƒé«˜çš„åˆå§‹åŒ–å¼€é”€ã€‚ å»¶è¿ŸæŠ¢å ï¼Œè‡ªå·±å®ç° TLS ä½¿å¾— uthread ä¸èƒ½è®¿é—®å·²ç»å¤±æ•ˆçš„ç¼“å­˜ï¼Ÿ ","date":"2024-09-30","objectID":"/posts/paper-shenango/:8:2","tags":["Paper Reading"],"title":"Paper Reading: Shenango","uri":"/posts/paper-shenango/"},{"categories":null,"content":"Evaluation latency and CPU efficiency sudden bursts in load What is the contribution of the individual mechanisms in Shenango to its observed performance? hyper-threads æˆ‘ä»¬æ¯”è¾ƒäº† Shenango ä¸ Arachneã€ZygOS å’Œ Linuxã€‚ æˆ‘ä»¬è¯„ä¼°äº† memcached æˆ‘ä»¬è¿˜ç”¨ Rust ç¼–å†™äº†å‡ ä¸ªæ–°çš„ Shenango åº”ç”¨ç¨‹åºæ¥æµ‹é‡ä¸åŒçš„è´Ÿè½½æ¨¡å¼ï¼Œåˆ©ç”¨äº†è¯­è¨€ç‰¹æ€§å¦‚é—­åŒ…å’Œç§»åŠ¨è¯­ä¹‰ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å®ç°äº†ä¸€ä¸ª spin-serverï¼Œé€šè¿‡ä½¿ç”¨ CPU ä¸€æ®µæ—¶é—´æ¥æ¨¡æ‹Ÿè®¡ç®—å¯†é›†å‹åº”ç”¨ç¨‹åºï¼Œç„¶åå†å“åº”æ¯ä¸ªè¯·æ±‚ã€‚ æ­¤å¤–ï¼Œæˆ‘ä»¬å®ç°äº† loadgenï¼Œä¸€ä¸ªç°å®çš„è´Ÿè½½ç”Ÿæˆå™¨ï¼Œå¯ä»¥ä¸ºæˆ‘ä»¬çš„ spin-server ä»¥åŠ memcached ç”Ÿæˆç²¾ç¡®å®šæ—¶çš„è¯·æ±‚æ¨¡å¼ã€‚è¿™ä¸¤æ¬¾åº”ç”¨ç¨‹åºå…±éœ€è¦ 1,366 è¡Œä»£ç ã€‚ä¸ºäº†ä¸å…¶å®ƒç³»ç»Ÿè¿›è¡Œæ¯”è¾ƒï¼Œæˆ‘ä»¬ä½¿ç”¨äº† ZygOS ä»“åº“ [7] ä¸­çš„ ZygOS å’Œ Linux spin-server å˜ä½“ï¼Œå¹¶ä¸º Arachne å®ç°äº†è‡ªå·±çš„ spin-serverã€‚ ","date":"2024-09-30","objectID":"/posts/paper-shenango/:9:0","tags":["Paper Reading"],"title":"Paper Reading: Shenango","uri":"/posts/paper-shenango/"},{"categories":null,"content":"CPU Efficiency and Latency memcached, spin-server, gdnsd Shenango å¿…é¡»å°†ä¸€ä¸ªæ ¸å¿ƒï¼ˆ2 ä¸ªè¶…çº¿ç¨‹ï¼‰ä¸“ç”¨äºè¿è¡Œ IOKernelï¼Œå› æ­¤åº”ç”¨ç¨‹åºå¯ç”¨çš„è¶…çº¿ç¨‹å‡å°‘äº†ä¸¤ä¸ª IOKernel å ç”¨çš„æ ¸å¿ƒä¸èƒ½å¤„ç†å…¶ä»–äº‹æƒ…ï¼Œé‚£è¿™ä¸ªæ ¸å¿ƒä¼šå¯¼è‡´ç¼“å­˜è¡Œå¤±æ•ˆï¼ŒL1 miss ç‡é«˜çš„é—®é¢˜å— Shenango åœ¨å‡ ä¹æ‰€æœ‰è´Ÿè½½ä¸‹çš„æ‰¹å¤„ç†åº”ç”¨ååé‡éƒ½ä¼˜äºå…¶ä»–ç³»ç»Ÿã€‚åœ¨æä½è´Ÿè½½ä¸‹ï¼ŒLinux å› ä¸ºæ²¡æœ‰ä¸º IOKernel æˆ–æ ¸å¿ƒä»²è£å™¨é¢„ç•™è¶…çº¿ç¨‹ï¼Œæ‰€ä»¥æ‰¹å¤„ç†ååé‡æœ€é«˜ã€‚ Shenango åŸºäº DPDKï¼Œä¸ºä»€ä¹ˆä¸å’Œ DPDK æ¯”ä¸€ä¸‹å‘¢ è€Œä¸” memcached å‡ ä¹éƒ½æ˜¯ 99.8% GET è¯·æ±‚ï¼Œå†™ä¼šå¯¼è‡´ä»€ä¹ˆå‘¢ ä¸ºäº†è¯„ä¼° Shenango åœ¨å­˜åœ¨æ‰¹å¤„ç†åº”ç”¨çš„æƒ…å†µä¸‹å¤„ç†æœåŠ¡æ—¶é—´å˜åŒ–çš„èƒ½åŠ›ï¼Œæˆ‘ä»¬è¿è¡Œäº† spin-serverï¼ŒShenango æ¯ç§’å¯é‡æ–°åˆ†é…æ ¸å¿ƒå¤šè¾¾ 60,000 æ¬¡ï¼Œèƒ½å¤Ÿå¿«é€Ÿé€‚åº”è´Ÿè½½çªå¢å¹¶ä¿æŒè¾ƒä½çš„å°¾éƒ¨å»¶è¿Ÿï¼ŒåŒæ—¶å°†æœªä½¿ç”¨çš„å‘¨æœŸæˆäºˆæ‰¹å¤„ç†åº”ç”¨ã€‚ æˆ‘ä»¬é€šè¿‡åŒæ—¶è¿è¡Œ gdnsd å’Œ swaptions æ¥è¯„ä¼° UDP æ€§èƒ½ï¼Œ ","date":"2024-09-30","objectID":"/posts/paper-shenango/:9:1","tags":["Paper Reading"],"title":"Paper Reading: Shenango","uri":"/posts/paper-shenango/"},{"categories":null,"content":"Resilience to Bursts in Load In this experiment, we generate TCP requests with 1 Âµs of fake work è™½ç„¶æ’é™¤äº† Linux å’Œ ZygOS ä½†æˆ‘è®¤ä¸ºè¿™ä¸ªæŒ‡æ ‡å¾ˆé‡è¦ï¼Œé¢å¯¹é«˜è´Ÿè½½å¯ä»¥ååº”è¿…é€Ÿï¼Œå°¾éƒ¨å»¶è¿Ÿè¿˜æ˜¯å¾ˆä½ï¼Œå‡ ä¹æ˜¯ä¸€æ¡ç›´çº¿ï¼Œæ€ä¹ˆåšåˆ°çš„ ","date":"2024-09-30","objectID":"/posts/paper-shenango/:9:2","tags":["Paper Reading"],"title":"Paper Reading: Shenango","uri":"/posts/paper-shenango/"},{"categories":null,"content":"Microbenchmarks è¿˜ç»™æ¯ä¸ªç»„ä»¶è¿›è¡Œäº† benchmark Thread library Network stack and core allocation overheads Packet load balancing. Core allocation interval. ","date":"2024-09-30","objectID":"/posts/paper-shenango/:9:3","tags":["Paper Reading"],"title":"Paper Reading: Shenango","uri":"/posts/paper-shenango/"},{"categories":null,"content":"Conclusion ZygOS ä¸ Shenango æœ€ä¸ºç›¸ä¼¼ï¼›å®ƒåœ¨ IX çš„åŸºç¡€ä¸Šå¢åŠ äº†å·¥ä½œçªƒå–ï¼Œä»¥æ”¹è¿›åº”ç”¨ç¨‹åºå†…çš„è´Ÿè½½å‡è¡¡ã€‚ç„¶è€Œï¼Œè¿™äº›ç³»ç»Ÿéƒ½æ— æ³•åœ¨ç»†ç²’åº¦ä¸ŠåŠ¨æ€åœ°åœ¨åº”ç”¨ç¨‹åºä¹‹é—´é‡æ–°åˆ†é…æ ¸å¿ƒã€‚ç›¸åï¼Œå®ƒä»¬é™æ€åœ°å°†æ ¸å¿ƒåˆ†åŒºåˆ°åº”ç”¨ç¨‹åºï¼Œæˆ–è€…ä½¿ç”¨å¤–éƒ¨æ§åˆ¶å¹³é¢åœ¨å¤§æ—¶é—´å°ºåº¦ä¸Šé‡æ–°é…ç½®æ ¸å¿ƒåˆ†é…ã€‚ ","date":"2024-09-30","objectID":"/posts/paper-shenango/:9:4","tags":["Paper Reading"],"title":"Paper Reading: Shenango","uri":"/posts/paper-shenango/"},{"categories":null,"content":"The Demikernel Datapath OS Architecture for Microsecond-scale Datacenter Systems Datacenter system æŒ‡çš„æ˜¯ MPP å—ï¼Ÿ Github DemiKernel å¥½åƒæœ€è¿‘è¿˜åœ¨æ›´æ–° ","date":"2024-09-24","objectID":"/posts/paper-demikernel/:1:0","tags":["Paper Reading"],"title":"Paper Reading: The Demikernel Datapath OS Architecture for Microsecond-scale Datacenter Systems","uri":"/posts/paper-demikernel/"},{"categories":null,"content":"Abstract æ•°æ®ä¸­å¿ƒç³»ç»Ÿå’Œ I/O è®¾å¤‡ç°åœ¨ä»¥å•ä½å¾®ç§’çš„å»¶è¿Ÿè¿è¡Œï¼Œéœ€è¦ ns çº§åˆ«çš„æ“ä½œç³»ç»Ÿã€‚ä¼ ç»Ÿçš„åŸºäºå†…æ ¸çš„æ“ä½œç³»ç»Ÿå¸¦æ¥äº†éš¾ä»¥æ‰¿å—çš„å¼€é”€ï¼Œå› æ­¤æœ€è¿‘çš„å†…æ ¸ç»•è¿‡æ“ä½œç³»ç»Ÿ[73]å’Œåº“[23]ä» I/O æ•°æ®è·¯å¾„ä¸­æ¶ˆé™¤äº†æ“ä½œç³»ç»Ÿå†…æ ¸ã€‚ç„¶è€Œï¼Œè¿™äº›ç³»ç»Ÿéƒ½æ²¡æœ‰æä¾›ä¸€ä¸ªé€šç”¨çš„æ•°æ®è·¯å¾„æ“ä½œç³»ç»Ÿçš„æ›¿ä»£å“ï¼Œä»¥æ»¡è¶³ Î¼s è§„æ¨¡ç³»ç»Ÿçš„éœ€è¦ã€‚æå‡ºäº†ä¸€ç§é€‚ç”¨äºå¼‚æ„å†…æ ¸æ—è·¯è®¾å¤‡å’Œ Î¼s è§„æ¨¡æ•°æ®ä¸­å¿ƒç³»ç»Ÿçš„æŸ”æ€§æ•°æ®é€šè·¯æ“ä½œç³»ç»Ÿ Demikernelã€‚æˆ‘ä»¬æ„å»ºäº†ä¸¤ä¸ªåŸå‹ Demikernel æ“ä½œç³»ç»Ÿï¼Œå¹¶å±•ç¤ºäº†ç§»æ¤ç°æœ‰ Î¼s è§„æ¨¡ç³»ç»Ÿæ‰€éœ€çš„æœ€å°åŠªåŠ›ã€‚ä¸€æ—¦ç§»æ¤ï¼ŒDemikernel å…è®¸åº”ç”¨ç¨‹åºåœ¨å…·æœ‰ ns çº§åˆ«å¼€é”€ä¸”æ²¡æœ‰ä»£ç æ›´æ”¹çš„å¼‚æ„å†…æ ¸æ—è·¯è®¾å¤‡ä¸Šè¿è¡Œ nanoseconds æ¯” microseconds è¿˜è¦å°å§ï¼Œä»€ä¹ˆæ ·çš„ os æ˜¯ ns çº§åˆ«çš„ï¼Ÿ è¿™ç¯‡æ–‡ç« å’Œ XDP çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ ","date":"2024-09-24","objectID":"/posts/paper-demikernel/:2:0","tags":["Paper Reading"],"title":"Paper Reading: The Demikernel Datapath OS Architecture for Microsecond-scale Datacenter Systems","uri":"/posts/paper-demikernel/"},{"categories":null,"content":"Overview ç½‘ç»œå¾€è¿”æ—¶é—´ã€ç£ç›˜è®¿é—®ä»¥åŠåƒ Redis è¿™æ ·çš„å†…å­˜ç³»ç»Ÿ[80]ï¼Œå¯ä»¥å®ç°ä¸ªä½æ•°çš„å¾®ç§’çº§å»¶è¿Ÿã€‚ ä¸ºäº†é¿å…æˆä¸ºç“¶é¢ˆï¼Œdatapath systems software å¿…é¡»åœ¨äºšå¾®ç§’çº§â€”â€”æˆ–çº³ç§’çº§â€”â€”å»¶è¿Ÿä¸‹è¿è¡Œã€‚ ä¸ºäº†æœ€å°åŒ–å»¶è¿Ÿï¼Œå¹¿æ³›éƒ¨ç½²çš„å†…æ ¸æ—è·¯è®¾å¤‡[78, 16]å°†ä¼ ç»Ÿæ“ä½œç³»ç»Ÿå†…æ ¸ç§»åŠ¨åˆ° control pathï¼Œå¹¶è®©å¾®ç§’çº§åº”ç”¨ç¨‹åºç›´æ¥æ‰§è¡Œ datapath I/O.ã€‚ å†…æ ¸æ—è·¯è®¾å¤‡å°†æ“ä½œç³»ç»Ÿçš„ä¿æŠ¤åŠŸèƒ½ï¼ˆä¾‹å¦‚ï¼Œéš”ç¦»ã€åœ°å€è½¬æ¢ï¼‰offload åˆ°ç”¨æˆ·ç©ºé—´ï¼Œä»¥å®‰å…¨åœ°æä¾›ç”¨æˆ·çº§ I/Oï¼Œå¹¶ä¸”æ›´å¼ºå¤§çš„è®¾å¤‡å®ç°ä¸€äº›æ“ä½œç³»ç»Ÿç®¡ç†ï¼ˆä¾‹å¦‚ï¼Œç½‘ç»œï¼‰ä»¥è¿›ä¸€æ­¥å‡å°‘ CPU ä½¿ç”¨ã€‚ç°æœ‰çš„å†…æ ¸æ—è·¯åº“[57, 23, 44]æä¾›äº†ä¸€äº›ç¼ºå¤±çš„æ“ä½œç³»ç»Ÿç»„ä»¶ï¼›ç„¶è€Œï¼Œæ²¡æœ‰ä¸€ä¸ªåº“æ˜¯é€šç”¨çš„ã€å¯ç§»æ¤çš„æ•°æ®è·¯å¾„æ“ä½œç³»ç»Ÿã€‚ ç¼ºå°‘äº†ä»€ä¹ˆï¼Ÿæˆ‘æ„Ÿè§‰å…¨æ˜¯ä¸é€šç”¨ã€éš¾ä»¥ç§»æ¤çš„å§ï¼Œé™¤éçœŸçš„åˆå…¥ Linux Kernel æ¯”å¦‚ XDP æ²¡æœ‰æ ‡å‡†çš„æ•°æ®è·¯å¾„æ¶æ„å’Œé€šç”¨çš„æ•°æ®è·¯å¾„æ“ä½œç³»ç»Ÿï¼Œå†…æ ¸æ—è·¯å¯¹äºå¾®ç§’çº§åº”ç”¨ç¨‹åºæ¥è¯´å¾ˆéš¾åˆ©ç”¨ã€‚ç¨‹åºå‘˜ä¸å¸Œæœ›ä¸ºä¸åŒçš„è®¾å¤‡é‡æ–°æ¶æ„åº”ç”¨ç¨‹åºï¼Œå› ä¸ºä»–ä»¬å¯èƒ½æ— æ³•æå‰çŸ¥é“å“ªäº›è®¾å¤‡å¯ç”¨ã€‚æ–°è®¾å¤‡åŠŸèƒ½ä¼¼ä¹æ¯å¹´éƒ½åœ¨å‘å±•ï¼Œ å› æ­¤ï¼Œå¾®ç§’çº§åº”ç”¨ç¨‹åºéœ€è¦ä¸€ä¸ªå…·æœ‰å¯ç§»æ¤æ“ä½œç³»ç»Ÿçš„æ•°æ®è·¯å¾„æ¶æ„ï¼Œè¯¥æ“ä½œç³»ç»Ÿå®ç°äº†å¸¸è§çš„æ“ä½œç³»ç»Ÿç®¡ç†ï¼šå­˜å‚¨å’Œç½‘ç»œå †æ ˆã€å†…å­˜ç®¡ç†å’Œ CPU è°ƒåº¦ã€‚é™¤äº†æ”¯æŒå…·æœ‰çº³ç§’çº§å»¶è¿Ÿçš„å¼‚æ„è®¾å¤‡å¤–ï¼Œæ•°æ®è·¯å¾„æ“ä½œç³»ç»Ÿè¿˜å¿…é¡»æ»¡è¶³å¾®ç§’çº§åº”ç”¨ç¨‹åºçš„æ–°éœ€æ±‚ã€‚ä¾‹å¦‚ï¼Œé›¶æ‹·è´ I/O å¯¹äºå‡å°‘å»¶è¿Ÿéå¸¸é‡è¦ï¼Œå› æ­¤å¾®ç§’çº§ç³»ç»Ÿéœ€è¦ä¸€ä¸ªå…·æœ‰æ¸…æ™°é›¶æ‹·è´ I/O è¯­ä¹‰å’Œå†…å­˜ç®¡ç†çš„ APIï¼Œä»¥åè°ƒåº”ç”¨ç¨‹åºå’Œæ“ä½œç³»ç»Ÿä¹‹é—´çš„å…±äº«å†…å­˜è®¿é—®ã€‚åŒæ ·ï¼Œå¾®ç§’çº§åº”ç”¨ç¨‹åºæ¯å‡ å¾®ç§’æ‰§è¡Œä¸€æ¬¡ I/Oï¼Œå› æ­¤åº”ç”¨ç¨‹åºå·¥ä½œå’Œæ“ä½œç³»ç»Ÿä»»åŠ¡ä¹‹é—´çš„ç»†ç²’åº¦ CPU å¤šè·¯å¤ç”¨ä¹Ÿæ˜¯è‡³å…³é‡è¦çš„ã€‚ æ‰€ä»¥æœ¬æ–‡çš„æœ€é‡è¦çš„ç‚¹æ˜¯å¯ç§»æ¤æ€§ï¼Ÿ é›¶æ‹·è´ã€æ›´å¥½çš„å†…å­˜ç®¡ç†ã€CPU è°ƒåº¦ï¼Œåº”è¯¥å¤§å®¶éƒ½æ˜¯ç›¸åŒçš„ æœ¬æ–‡ä»‹ç»äº† Demikernelï¼Œä¸€ä¸ªä¸ºå¼‚æ„å†…æ ¸æ—è·¯è®¾å¤‡å’Œå¾®ç§’çº§å†…æ ¸æ—è·¯æ•°æ®ä¸­å¿ƒç³»ç»Ÿè®¾è®¡çš„çµæ´»æ•°æ®è·¯å¾„æ“ä½œç³»ç»Ÿå’Œæ¶æ„ã€‚Demikernel å®šä¹‰äº†ï¼š (1) æ–°çš„æ•°æ®è·¯å¾„æ“ä½œç³»ç»Ÿç®¡ç†åŠŸèƒ½ï¼Œé€‚ç”¨äºå¾®ç§’çº§åº”ç”¨ç¨‹åºï¼Œ (2) ä¸€ä¸ªæ–°çš„å¯ç§»æ¤æ•°æ®è·¯å¾„ APIï¼ˆPDPIXï¼‰ï¼Œä»¥åŠ (3) ä¸€ä¸ªçµæ´»çš„æ•°æ®è·¯å¾„æ¶æ„ï¼Œç”¨äºæœ€å°åŒ–å¼‚æ„è®¾å¤‡ä¹‹é—´çš„å»¶è¿Ÿã€‚Demikernel æ•°æ®è·¯å¾„æ“ä½œç³»ç»Ÿä¸ä¼ ç»Ÿçš„æ§åˆ¶å¹³é¢å†…æ ¸ï¼ˆä¾‹å¦‚ï¼ŒLinux æˆ– Windowsï¼‰ä¸€èµ·è¿è¡Œï¼Œå¹¶ç”±å…·æœ‰ç›¸åŒ APIã€æ“ä½œç³»ç»Ÿç®¡ç†åŠŸèƒ½å’Œæ¶æ„çš„å¯äº’æ¢åº“æ“ä½œç³»ç»Ÿç»„æˆã€‚ æ¯ä¸ªåº“æ“ä½œç³»ç»Ÿéƒ½æ˜¯è®¾å¤‡ç‰¹å®šçš„ï¼šå®ƒåœ¨å¯èƒ½çš„æƒ…å†µä¸‹å¸è½½åˆ°å†…æ ¸æ—è·¯è®¾å¤‡ï¼Œå¹¶åœ¨ç”¨æˆ·ç©ºé—´åº“ä¸­å®ç°å‰©ä½™çš„æ“ä½œç³»ç»Ÿç®¡ç†ã€‚è¿™äº›åº“æ“ä½œç³»ç»Ÿæ—¨åœ¨ç®€åŒ–è·¨å¼‚æ„å†…æ ¸æ—è·¯è®¾å¤‡çš„å¾®ç§’çº§æ•°æ®ä¸­å¿ƒç³»ç»Ÿçš„å¼€å‘ï¼ŒåŒæ—¶æœ€å°åŒ–æ“ä½œç³»ç»Ÿå¼€é”€ã€‚ éœ€è¦è®¾å¤‡æ”¯æŒå— Demikernel éµå¾ªä»å†…æ ¸å¯¼å‘çš„æ“ä½œç³»ç»Ÿå‘åº“å¯¼å‘çš„æ•°æ®è·¯å¾„æ“ä½œç³»ç»Ÿçš„è¶‹åŠ¿ï¼Œè¿™ä¸€è¶‹åŠ¿æ˜¯ç”±è¶Šæ¥è¶Šé«˜æ•ˆçš„ I/O è®¾å¤‡å¯¼è‡´çš„ CPU ç“¶é¢ˆæ‰€é©±åŠ¨çš„ã€‚å®ƒä¸æ˜¯ä¸ºé‚£äº›ç›´æ¥è®¿é—®å†…æ ¸æ—è·¯ç¡¬ä»¶ï¼ˆä¾‹å¦‚ï¼ŒHPC [45]ï¼Œè½¯ä»¶ä¸­é—´ä»¶[90, 72]ï¼ŒRDMA å­˜å‚¨ç³»ç»Ÿ[17, 98, 7, 101]ï¼‰è€Œè®¾è®¡çš„ç³»ç»Ÿï¼Œå› ä¸ºå®ƒæ–½åŠ äº†ä¸€ä¸ªéšè—æ›´å¤æ‚è®¾å¤‡åŠŸèƒ½ï¼ˆä¾‹å¦‚ï¼Œå•è¾¹ RDMAï¼‰çš„é€šç”¨ APIã€‚ æœ¬æ–‡æè¿°äº†ä¸¤ä¸ªç”¨äº Linux å’Œ Windows çš„åŸå‹ Demikernel æ•°æ®è·¯å¾„æ“ä½œç³»ç»Ÿã€‚æˆ‘ä»¬çš„å®ç°ä¸»è¦ä½¿ç”¨ Rustï¼Œåˆ©ç”¨å…¶åœ¨æ•°æ®è·¯å¾„æ“ä½œç³»ç»Ÿå †æ ˆä¸­çš„å†…å­˜å®‰å…¨ä¼˜åŠ¿ã€‚æˆ‘ä»¬è¿˜æè¿°äº†æ–°çš„é›¶æ‹·è´ã€çº³ç§’çº§ TCP å †æ ˆå’Œå†…æ ¸æ—è·¯æ„ŸçŸ¥å†…å­˜åˆ†é…å™¨çš„è®¾è®¡ã€‚æˆ‘ä»¬çš„è¯„ä¼°å‘ç°ï¼Œä½¿ç”¨ Demikernel æ„å»ºå’Œç§»æ¤åº”ç”¨ç¨‹åºå¾ˆå®¹æ˜“ï¼ŒI/O å¤„ç†å»¶è¿Ÿçº¦ä¸º 50 çº³ç§’æ¯ I/Oï¼Œä¸ç›´æ¥ä½¿ç”¨å†…æ ¸æ—è·¯ API ç›¸æ¯”ï¼Œå³°å€¼ååé‡å¼€é”€ä¸º 17-26% æ–°çš„é›¶æ‹·è´ã€çº³ç§’çº§ TCP å †æ ˆå’Œå†…æ ¸æ—è·¯æ„ŸçŸ¥å†…å­˜åˆ†é…å™¨ 50ns æœ‰æ¯”è¾ƒå—ï¼Œååé‡ 10-20% æ˜¯ä»€ä¹ˆå¸¦æ¥çš„ tradeoff å‘¢ ","date":"2024-09-24","objectID":"/posts/paper-demikernel/:3:0","tags":["Paper Reading"],"title":"Paper Reading: The Demikernel Datapath OS Architecture for Microsecond-scale Datacenter Systems","uri":"/posts/paper-demikernel/"},{"categories":null,"content":"Demikernel Datapath OS Requirements ç°ä»£å†…æ ¸æ—è·¯è®¾å¤‡ã€æ“ä½œç³»ç»Ÿå’Œåº“æ¶ˆé™¤äº†æ“ä½œç³»ç»Ÿå†…æ ¸åœ¨ I/O æ•°æ®è·¯å¾„ä¸­çš„ä½œç”¨ï¼Œä½†æ²¡æœ‰å®Œå…¨æ›¿ä»£å…¶æ‰€æœ‰åŠŸèƒ½ï¼Œä»è€Œåœ¨å†…æ ¸æ—è·¯æ“ä½œç³»ç»Ÿæ¶æ„ä¸­ç•™ä¸‹äº†ä¸€ä¸ªç©ºç™½ã€‚è¿™ä¸ªç©ºç™½æš´éœ²äº†ä¸€ä¸ªå…³é”®é—®é¢˜ï¼šå¾®ç§’çº§ç³»ç»Ÿçš„æ­£ç¡®æ•°æ®è·¯å¾„æ“ä½œç³»ç»Ÿæ›¿ä»£æ–¹æ¡ˆæ˜¯ä»€ä¹ˆï¼Ÿæœ¬èŠ‚è¯¦ç»†ä»‹ç»äº†å¾®ç§’çº§ç³»ç»Ÿå’Œå¼‚æ„å†…æ ¸æ—è·¯è®¾å¤‡çš„éœ€æ±‚ï¼Œè¿™äº›éœ€æ±‚æ¨åŠ¨äº† Demikernel çš„è®¾è®¡ã€‚ heterogenous è¿™ä¸ªè¯å…¶å®ä¹‹å‰çœ‹è®ºæ–‡å¾ˆå°‘æ³¨æ„ï¼Œæœ‰æ²¡æœ‰å…·ä½“åœºæ™¯ï¼Ÿ ","date":"2024-09-24","objectID":"/posts/paper-demikernel/:4:0","tags":["Paper Reading"],"title":"Paper Reading: The Demikernel Datapath OS Architecture for Microsecond-scale Datacenter Systems","uri":"/posts/paper-demikernel/"},{"categories":null,"content":"Support Heterogenous OS Offloads å¯¹æ¯”äº† arrakisï¼šapp ç»•è¿‡ kernelï¼Œé€šè¿‡ libOS æ¥åš user I/Oï¼Œå…¶ä»– caladan/eRPC ä¹Ÿå¾ˆç±»ä¼¼ DemiKernel åº”è¯¥å’Œ arrakis ä¹Ÿå·®ä¸å¤šå§ï¼Œ å½“ä»Šçš„æ•°æ®è·¯å¾„æ¶æ„æ˜¯ ad-hoc çš„ï¼šç°æœ‰çš„å†…æ ¸æ—è·¯åº“[34, 73]åœ¨ç‰¹å®šçš„å†…æ ¸æ—è·¯è®¾å¤‡ä¹‹ä¸Šæä¾›äº†ä¸åŒçš„æ“ä½œç³»ç»ŸåŠŸèƒ½ã€‚ç”±äºä¸åŒçš„è®¾å¤‡å¸è½½äº†ä¸åŒçš„æ“ä½œç³»ç»ŸåŠŸèƒ½ï¼Œå› æ­¤å¯ç§»æ¤æ€§å…·æœ‰æŒ‘æˆ˜æ€§ã€‚ä¾‹å¦‚ï¼ŒDPDK æä¾›äº†ä¸€ä¸ªä½çº§åˆ«çš„åŸå§‹ NIC æ¥å£ï¼Œè€Œ RDMA å®ç°äº†ä¸€ä¸ªå…·æœ‰æ‹¥å¡æ§åˆ¶å’Œæœ‰åºã€å¯é ä¼ è¾“çš„ç½‘ç»œåè®®ã€‚å› æ­¤ï¼Œä½¿ç”¨ DPDK çš„ç³»ç»Ÿå®ç°äº†ä¸€ä¸ªå®Œæ•´çš„ç½‘ç»œå †æ ˆï¼Œè¿™å¯¹äºä½¿ç”¨ RDMA çš„ç³»ç»Ÿæ¥è¯´æ˜¯ä¸å¿…è¦çš„ã€‚ ad-hoc å®ä¹ çš„æ—¶å€™ç»å¸¸è§åˆ°çš„è¯æ±‡ï¼Œä»æ¥æ²¡ç†è§£ï¼Œåˆ°åº•æ˜¯è‡ªå·±å®šåˆ¶è¿˜æ˜¯è¯´ä¸´æ—¶æ–¹æ¡ˆï¼Œæˆ–è€…æ˜¯ç‰¹æ®Šçš„æ–¹æ¡ˆï¼Œéé€šç”¨ï¼Ÿ è¿™ç§å¼‚æ„æ€§æºäºç¡¬ä»¶è®¾è®¡è€…é•¿æœŸä»¥æ¥ä¸€ç›´é¢ä¸´çš„æ ¹æœ¬æƒè¡¡[50, 66, 10]â€”â€”å¸è½½æ›´å¤šåŠŸèƒ½å¯ä»¥æé«˜æ€§èƒ½ï¼Œä½†ä¼šå¢åŠ è®¾å¤‡å¤æ‚æ€§â€”â€”éšç€æœ€è¿‘çš„ç ”ç©¶æå‡ºè¶Šæ¥è¶Šå¤æ‚çš„å¸è½½åŠŸèƒ½[52, 41, 86]ï¼Œè¿™ç§æƒ…å†µåªä¼šå˜å¾—æ›´ç³Ÿã€‚ä¾‹å¦‚ï¼ŒDPDK æ›´é€šç”¨ä¸”å¹¿æ³›å¯ç”¨ï¼Œä½† RDMA åœ¨æ•°æ®ä¸­å¿ƒå†…çš„å¾®ç§’çº§ç³»ç»Ÿä¸­å®ç°äº†æœ€ä½çš„ CPU å’Œå»¶è¿Ÿå¼€é”€ï¼Œå› æ­¤ä»»ä½•æ•°æ®è·¯å¾„æ“ä½œç³»ç»Ÿéƒ½å¿…é¡»å¯ç§»æ¤åœ°æ”¯æŒä¸¤è€…ã€‚æœªæ¥çš„ NIC å¯èƒ½ä¼šå¼•å…¥å…¶ä»–æƒè¡¡ï¼ŒGiven this complexity, Demikernelâ€™s design must portably manage complex zero-copy I/O coordi- nation between applications and OS components. æ‰€ä»¥åˆ°åº•æ˜¯åšä¸€ä¸ªæ›´å¥½çš„ï¼Œè¿˜æ˜¯æ›´é€šç”¨çš„ï¼Ÿè¿™æ‰æ˜¯ tradeoff å—ï¼Ÿ complexity æ˜¯çœŸçš„éœ€è¦è€ƒè™‘çš„å— ï¼ŒRDMA å’Œ DPDK ä½¿ç”¨èµ·æ¥å¥½åƒå¹¶ä¸å¤ªå¤æ‚ï¼Œå¤§éƒ¨åˆ† NIC åº”è¯¥ä¹Ÿæ”¯æŒ RDMA ","date":"2024-09-24","objectID":"/posts/paper-demikernel/:4:1","tags":["Paper Reading"],"title":"Paper Reading: The Demikernel Datapath OS Architecture for Microsecond-scale Datacenter Systems","uri":"/posts/paper-demikernel/"},{"categories":null,"content":"Multiplex and Schedule the CPU at Î¼s-scale å¾®ç§’çº§æ•°æ®ä¸­å¿ƒç³»ç»Ÿé€šå¸¸æ¯å‡ å¾®ç§’ us æ‰§è¡Œä¸€æ¬¡ I/Oï¼›å› æ­¤ï¼Œæ•°æ®è·¯å¾„æ“ä½œç³»ç»Ÿå¿…é¡»èƒ½å¤Ÿåœ¨ç±»ä¼¼çš„é€Ÿåº¦ä¸‹å¤šè·¯å¤ç”¨å’Œè°ƒåº¦ I/O å¤„ç†å’Œåº”ç”¨ç¨‹åºå·¥ä½œã€‚ç°æœ‰çš„å†…æ ¸çº§æŠ½è±¡ï¼Œå¦‚è¿›ç¨‹å’Œçº¿ç¨‹ï¼Œå¯¹äºå¾®ç§’çº§è°ƒåº¦æ¥è¯´è¿‡äºç²—ç²’åº¦ coarse-grainedï¼Œå› ä¸ºå®ƒä»¬ä¼šå ç”¨æ•´ä¸ªæ ¸å¿ƒæ•°ç™¾å¾®ç§’ã€‚å› æ­¤ï¼Œå†…æ ¸æ—è·¯ç³»ç»Ÿç¼ºä¹é€šç”¨çš„è°ƒåº¦æŠ½è±¡ã€‚ datapath OS åº”è¯¥å°±æ˜¯ä¸“æŒ‡ kernel bypass æ–¹æ³• æœ€è¿‘çš„ç”¨æˆ·çº§è°ƒåº¦å™¨[9, 75]åœ¨æ¯ä¸ª I/O çš„åŸºç¡€ä¸Šä»¥å¾®ç§’çº§åˆ†é…åº”ç”¨ç¨‹åºå·¥ä½œè€…ï¼›ç„¶è€Œï¼Œå®ƒä»¬ä»ç„¶ä½¿ç”¨ç²—ç²’åº¦çš„æŠ½è±¡æ¥å¤„ç†æ“ä½œç³»ç»Ÿå·¥ä½œï¼ˆä¾‹å¦‚ï¼Œæ•´ä¸ªçº¿ç¨‹[23]æˆ–æ ¸å¿ƒ[30]ï¼‰ã€‚æœ‰äº›è°ƒåº¦å™¨æ›´è¿›ä¸€æ­¥ï¼Œé‡‡ç”¨äº†å¾®å†…æ ¸æ–¹æ³•ï¼Œå°†æ“ä½œç³»ç»ŸæœåŠ¡åˆ†ç¦»åˆ°å¦ä¸€ä¸ªè¿›ç¨‹[57]æˆ–ç¯[3]ä¸­ä»¥æé«˜å®‰å…¨æ€§ã€‚ æ²¡æ‡‚ï¼Œä½†è¿™ä¸ªå¾®å†…æ ¸å°±æ˜¯ IXï¼Œä½¿ç”¨äº† Dune è™šæ‹ŸåŒ–è¿›ç¨‹ å¾®ç§’çº§çš„ RDMA ç³»ç»Ÿé€šå¸¸äº¤é”™ I/O å’Œåº”ç”¨ç¨‹åºè¯·æ±‚å¤„ç†ã€‚è¿™ç§è®¾è®¡ä½¿å¾—è°ƒåº¦å˜å¾—éšå¼è€Œä¸æ˜¯æ˜¾å¼ï¼šæ•°æ®è·¯å¾„æ“ä½œç³»ç»Ÿæ— æ³•æ§åˆ¶åˆ†é…ç»™åº”ç”¨ç¨‹åºä¸æ•°æ®è·¯å¾„ I/O å¤„ç†çš„ CPU å‘¨æœŸçš„å¹³è¡¡ã€‚ä¾‹å¦‚ï¼ŒFaRM [17]å’Œ Pilaf [64]åœ¨æ¶ˆæ¯åˆ°è¾¾æ—¶æ€»æ˜¯ç«‹å³æ‰§è¡Œ I/O å¤„ç†ï¼Œå³ä½¿æœ‰æ›´é«˜ä¼˜å…ˆçº§çš„ä»»åŠ¡ï¼ˆä¾‹å¦‚ï¼Œä¸ºå¯èƒ½è¢«ä¸¢å¼ƒçš„ä¼ å…¥æ•°æ®åŒ…åˆ†é…æ–°çš„ç¼“å†²ç©ºé—´ï¼‰ã€‚ è€ƒè™‘è°ƒåº¦æ˜¯ä¸æ˜¯è¿™ç¯‡è®ºæ–‡æ¯”è¾ƒæœ‰æ„æ€çš„åœ°æ–¹ è¿™äº›ç³»ç»Ÿéƒ½ä¸æ˜¯ç†æƒ³çš„ï¼Œå› ä¸ºå®ƒä»¬çš„è°ƒåº¦å†³ç­–ä»ç„¶æ˜¯åˆ†å¸ƒå¼çš„ï¼Œè¦ä¹ˆåœ¨å†…æ ¸å’Œç”¨æˆ·çº§è°ƒåº¦å™¨ä¹‹é—´ï¼ˆå¯¹äº DPDK ç³»ç»Ÿï¼‰ï¼Œè¦ä¹ˆåœ¨ä»£ç ä¹‹é—´ï¼ˆå¯¹äº RDMA ç³»ç»Ÿï¼‰ã€‚æœ€è¿‘çš„å·¥ä½œï¼Œå¦‚ eRPC [34]ï¼Œå·²ç»è¡¨æ˜ï¼Œåœ¨å•ä¸ªçº¿ç¨‹ä¸Šå¤šè·¯å¤ç”¨åº”ç”¨ç¨‹åºå·¥ä½œå’Œæ•°æ®è·¯å¾„æ“ä½œç³»ç»Ÿä»»åŠ¡æ˜¯å®ç°çº³ç§’çº§å¼€é”€æ‰€å¿…éœ€çš„ã€‚å› æ­¤ï¼ŒDemikernel çš„è®¾è®¡éœ€è¦ä¸€ä¸ªå¾®ç§’çº§è°ƒåº¦æŠ½è±¡å’Œè°ƒåº¦å™¨ã€‚ åº”è¯¥æ˜¯åŸºäº arrakis æˆ–è€…ç±»ä¼¼çš„æ¶æ„ï¼Œè®°å¾—ä¹‹å‰æ˜¯æ²¡å¤ªçœ‹æ‡‚ arrakis æ˜¯æ€ä¹ˆå®ç°çš„ï¼Œåº”è¯¥ä¹Ÿæ˜¯è™šæ‹ŸåŒ–æŠ€æœ¯å§ IOMMU SR-IOV ","date":"2024-09-24","objectID":"/posts/paper-demikernel/:4:2","tags":["Paper Reading"],"title":"Paper Reading: The Demikernel Datapath OS Architecture for Microsecond-scale Datacenter Systems","uri":"/posts/paper-demikernel/"},{"categories":null,"content":"Demikernel Overview and Approach Demikernel æ˜¯é¦–ä¸ªæ»¡è¶³å¾®ç§’çº§åº”ç”¨ç¨‹åºå’Œå†… kernel-bypass devices éœ€æ±‚çš„â€œæ•°æ®è·¯å¾„æ“ä½œç³»ç»Ÿâ€ã€‚å®ƒå¼•å…¥äº†æ–°çš„æ“ä½œç³»ç»Ÿç‰¹æ€§å’Œæ–°çš„å¯ç§»æ¤æ•°æ®è·¯å¾„ APIï¼Œè¿™äº›å¯¹ç¨‹åºå‘˜æ˜¯å¯è§çš„ï¼ŒåŒæ—¶è¿˜æœ‰æ–°çš„æ“ä½œç³»ç»Ÿæ¶æ„å’Œè®¾è®¡ï¼Œè¿™äº›å¯¹ç¨‹åºå‘˜æ˜¯ä¸å¯è§çš„ã€‚æœ¬èŠ‚æ¦‚è¿°äº† Demikernel çš„æ–¹æ³•ï¼Œä¸‹ä¸€èŠ‚å°†æè¿°å¯¹ç¨‹åºå‘˜å¯è§çš„ç‰¹æ€§å’Œ APIï¼Œè€Œç¬¬ 5 èŠ‚å°†è¯¦ç»†ä»‹ç» Demikernelï¼ˆåº“ï¼‰æ“ä½œç³»ç»Ÿçš„æ¶æ„å’Œè®¾è®¡ã€‚ ä»€ä¹ˆå«æ»¡è¶³å†…æ ¸æ—è·¯è®¾å¤‡ï¼Ÿ ","date":"2024-09-24","objectID":"/posts/paper-demikernel/:5:0","tags":["Paper Reading"],"title":"Paper Reading: The Demikernel Datapath OS Architecture for Microsecond-scale Datacenter Systems","uri":"/posts/paper-demikernel/"},{"categories":null,"content":"Design Goals Simplify Î¼s-scale kernel-bypass system development Offer portability across heterogenous devices Demikernel åº”è¯¥è®©åº”ç”¨ç¨‹åºæ— éœ€ä»£ç æ›´æ”¹å°±èƒ½åœ¨å¤šç§ç±»å‹çš„å†…æ ¸æ—è·¯è®¾å¤‡ï¼ˆä¾‹å¦‚ï¼ŒRDMA å’Œ DPDKï¼‰å’Œè™šæ‹ŸåŒ–ç¯å¢ƒä¸­è¿è¡Œã€‚ Achieve nanosecond-scale latency overheads ä¸å¤ªæ‡‚è¿™ä¸‰ä¸ªç›®æ ‡å’Œä»¥å‰çš„æœ‰ä»€ä¹ˆå¤ªå¤§åŒºåˆ«ï¼ŒåŒæ ·æ˜¯å†…æ ¸æ—è·¯å’Œæ–°çš„ APIï¼Œä¸ºä»€ä¹ˆè¯´å°±æ›´åŠ å¯ç§»æ¤å‘¢ ","date":"2024-09-24","objectID":"/posts/paper-demikernel/:5:1","tags":["Paper Reading"],"title":"Paper Reading: The Demikernel Datapath OS Architecture for Microsecond-scale Datacenter Systems","uri":"/posts/paper-demikernel/"},{"categories":null,"content":"System Model and Assumptions Demikernel ä¾èµ–äºæµè¡Œçš„å†…æ ¸æ—è·¯è®¾å¤‡ï¼ŒåŒ…æ‹¬ RDMA [61] å’Œ DPDK [16] NIC ä»¥åŠ SPDK ç£ç›˜ [88]ï¼ŒåŒæ—¶ä¹Ÿé€‚åº”æœªæ¥çš„å¯ç¼–ç¨‹è®¾å¤‡ [60, 58, 69]ã€‚æˆ‘ä»¬å‡è®¾ Demikernel æ•°æ®è·¯å¾„æ“ä½œç³»ç»Ÿä¸åº”ç”¨ç¨‹åºè¿è¡Œåœ¨åŒä¸€ä¸ªè¿›ç¨‹å’Œçº¿ç¨‹ä¸­ï¼Œå› æ­¤å®ƒä»¬ç›¸äº’ä¿¡ä»»ï¼Œä»»ä½•éš”ç¦»å’Œä¿æŠ¤éƒ½ç”±æ§åˆ¶è·¯å¾„å†…æ ¸æˆ–å†…æ ¸æ—è·¯è®¾å¤‡æä¾›ã€‚è¿™äº›å‡è®¾åœ¨æ•°æ®ä¸­å¿ƒä¸­æ˜¯å®‰å…¨çš„ï¼Œå› ä¸ºåœ¨æ•°æ®ä¸­å¿ƒä¸­ï¼Œåº”ç”¨ç¨‹åºé€šå¸¸è‡ªå¸¦åº“å’Œæ“ä½œç³»ç»Ÿï¼Œæ•°æ®ä¸­å¿ƒè¿è¥å•†ä½¿ç”¨ç¡¬ä»¶å¼ºåˆ¶æ‰§è¡Œéš”ç¦»ã€‚ Demikernel ä½¿å¾—åº”ç”¨ç¨‹åºå†…å­˜å¯ä»¥ç›´æ¥é€šè¿‡ç½‘ç»œå‘é€ï¼Œå› æ­¤åº”ç”¨ç¨‹åºå¿…é¡»ä»”ç»†è€ƒè™‘æ•æ„Ÿæ•°æ®çš„ä½ç½®ã€‚å¦‚æœå¿…è¦ï¼Œè¿™ä¸€åŠŸèƒ½å¯ä»¥è¢«å…³é—­ã€‚å…¶ä»–æŠ€æœ¯ï¼Œå¦‚ä¿¡æ¯æµæ§åˆ¶æˆ–éªŒè¯ï¼Œä¹Ÿå¯ä»¥è¢«åˆ©ç”¨æ¥ç¡®ä¿åº”ç”¨ç¨‹åºå†…å­˜çš„å®‰å…¨æ€§ã€‚ å…¶å®å°±æ˜¯ LibOSï¼Ÿç”¨æˆ·æ€çš„ä¸€ä¸ªåº“æä¾›è¿è¡Œè¿è¡Œæ—¶å— å‘é€å†…å­˜ï¼Œæ˜¯ DPDK è¿˜æ˜¯ RDMA æ²¡çœ‹æ‡‚è¿™ä¸ªå®‰å…¨çš„å‡è®¾ To minimize datapath latency, Demikernel uses cooperative scheduling å› æ­¤åº”ç”¨ç¨‹åºå¿…é¡»åœ¨ç´§å¯†çš„ I/O å¤„ç†å¾ªç¯ä¸­è¿è¡Œï¼ˆ å¼•å…¥äº†è°ƒåº¦çš„æ¦‚å¿µï¼Œåä½œè°ƒåº¦åº”è¯¥æ˜¯é€‚åˆ IO å¯†é›†å‹çš„ä»»åŠ¡ æˆ‘ä»¬çš„åŸå‹ç›®å‰ä¸“æ³¨äºç‹¬ç«‹è°ƒåº¦å•ä¸ª CPU æ ¸å¿ƒï¼Œä¾èµ–ç¡¬ä»¶æ”¯æŒè¿›è¡Œå¤šæ ¸è°ƒåº¦ ","date":"2024-09-24","objectID":"/posts/paper-demikernel/:5:2","tags":["Paper Reading"],"title":"Paper Reading: The Demikernel Datapath OS Architecture for Microsecond-scale Datacenter Systems","uri":"/posts/paper-demikernel/"},{"categories":null,"content":"Demikernel Approach A portable datapath API and flexible OS architecture. æ–°çš„ API ç§°ä¹‹ä¸º PDPIX Portable datapath? PDPIX æ‰©å±•äº†æ ‡å‡†çš„ POSIX APIï¼Œä»¥æ›´å¥½åœ°é€‚åº”å¾®ç§’çº§å†…æ ¸æ—è·¯ I/Oã€‚å¾®ç§’çº§å†…æ ¸æ—è·¯ç³»ç»Ÿæ˜¯é¢å‘ I/O çš„ï¼šå®ƒä»¬èŠ±è´¹å¤§éƒ¨åˆ†æ—¶é—´å’Œå†…å­˜æ¥å¤„ç† I/Oã€‚å› æ­¤ï¼ŒPDPIX å›´ç»• I/O é˜Ÿåˆ—æŠ½è±¡å±•å¼€ï¼Œä½¿ I/O æ˜¾å¼åŒ–ï¼šå®ƒå…è®¸å¾®ç§’çº§åº”ç”¨ç¨‹åºæäº¤æ•´ä¸ª I/O è¯·æ±‚ï¼Œæ¶ˆé™¤äº† POSIX åŸºäºç®¡é“çš„ I/O æŠ½è±¡çš„å»¶è¿Ÿé—®é¢˜ã€‚ ä¸ºäº†æœ€å°åŒ–å»¶è¿Ÿï¼ŒDemikernel åº“æ“ä½œç³»ç»Ÿå°½å¯èƒ½åœ°å°†æ“ä½œç³»ç»ŸåŠŸèƒ½å¸è½½åˆ°è®¾å¤‡ä¸Šï¼Œå¹¶åœ¨è½¯ä»¶ä¸­å®ç°å‰©ä½™çš„åŠŸèƒ½ å•¥æ„æ€ï¼Ÿ A DMA-capable heap, use-after-free protection Demikernel æä¾›äº†ä¸‰ä¸ªæ–°çš„å¤–éƒ¨æ“ä½œç³»ç»Ÿç‰¹æ€§ï¼Œä»¥ç®€åŒ–é›¶æ‹·è´å†…å­˜åè°ƒ ï¼ˆ1ï¼‰å…·æœ‰æ¸…æ™°è¯­ä¹‰çš„ I/O å†…å­˜ç¼“å†²åŒºæ‰€æœ‰æƒçš„å¯ç§»æ¤ APIï¼Œï¼ˆ2ï¼‰é›¶æ‹·è´ã€DMA èƒ½åŠ›çš„å †ï¼Œä»¥åŠï¼ˆ3ï¼‰é›¶æ‹·è´ I/O ç¼“å†²åŒºçš„ä½¿ç”¨åé‡Šæ”¾ï¼ˆUAFï¼‰ä¿æŠ¤ã€‚ä¸ POSIX ä¸åŒï¼ŒPDPIX å®šä¹‰äº†æ¸…æ™°çš„é›¶æ‹·è´ I/O è¯­ä¹‰ï¼šåº”ç”¨ç¨‹åºåœ¨è°ƒç”¨ I/O æ—¶å°†æ‰€æœ‰æƒä¼ é€’ç»™ Demikernel æ•°æ®è·¯å¾„æ“ä½œç³»ç»Ÿï¼Œå¹¶ä¸”åœ¨ I/O å®Œæˆä¹‹å‰ä¸ä¼šæ”¶å›æ‰€æœ‰æƒã€‚ ä»€ä¹ˆå« clear semantics for I/O memory buffer ownership åªæ˜¯è¯­ä¹‰ä¸Šçš„åŠ å¼ºï¼Ÿ UAF ä¿æŠ¤ (User after free) æ‚¬å‚æŒ‡é’ˆçš„é—®é¢˜å§ï¼Œæ„Ÿè§‰å…¶å®å°±æ˜¯ Rust å¸¦æ¥çš„å¥½å¤„ Coroutines and Î¼s-scale CPU scheduling å†…æ ¸æ—è·¯è°ƒåº¦é€šå¸¸ä»¥æ¯ä¸ª I/O ä¸ºåŸºç¡€è¿›è¡Œï¼›ç„¶è€Œï¼ŒPOSIX API å¹¶ä¸é€‚åˆè¿™ç§ç”¨é€”ã€‚epoll å’Œ select æœ‰ä¸€ä¸ªä¼—æ‰€å‘¨çŸ¥çš„â€œæƒŠç¾¤â€é—®é¢˜ [56]ï¼šå½“å¥—æ¥å­—å…±äº«æ—¶ï¼Œä¸å¯èƒ½å°†äº‹ä»¶ç²¾ç¡®åœ°ä¼ é€’ç»™ä¸€ä¸ªå·¥ä½œè€…ã€‚å› æ­¤ï¼ŒPDPIX å¼•å…¥äº†ä¸€ä¸ªæ–°çš„å¼‚æ­¥ I/O APIï¼Œç§°ä¸º waitï¼Œå®ƒå…è®¸åº”ç”¨ç¨‹åºå·¥ä½œè€…ç­‰å¾…ç‰¹å®šçš„ I/O è¯·æ±‚ï¼Œå¹¶ä¸”æ•°æ®è·¯å¾„æ“ä½œç³»ç»Ÿå¯ä»¥æ˜¾å¼åœ°å°† I/O è¯·æ±‚åˆ†é…ç»™å·¥ä½œè€…ã€‚ thundering herd å¤šä¸ªè¿›ç¨‹ç­‰å¾…ä¸€ä¸ªèµ„æºæ—¶å€™ï¼Œå¯èƒ½ä¼šå¯¼è‡´æƒŠç¾¤ï¼Œä½†æ˜¯å…¶å®æœ‰åˆ«çš„å¤„ç†æ–¹æ³•æ¯”å¦‚ epoll_exclusive è¿™ä¸ª wait æ˜¯ rust Tokio? è¿˜æ˜¯ asyncio æä¾›çš„ï¼Ÿ Demikernel ä½¿ç”¨åç¨‹ Coroutines æ¥å°è£…æ“ä½œç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºçš„è®¡ç®—ã€‚åç¨‹æ˜¯è½»é‡çº§çš„ï¼Œå…·æœ‰ä½æˆæœ¬çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œå¹¶ä¸”éå¸¸é€‚åˆ I/O å †æ ˆé€šå¸¸éœ€è¦çš„åŸºäºçŠ¶æ€æœºçš„å¼‚æ­¥äº‹ä»¶å¤„ç†ã€‚æˆ‘ä»¬é€‰æ‹©åç¨‹è€Œä¸æ˜¯ç”¨æˆ·çº§çº¿ç¨‹ï¼ˆä¾‹å¦‚ï¼ŒCaladan çš„ç»¿è‰²çº¿ç¨‹ [23]ï¼‰ï¼Œåè€…å¯ä»¥åŒæ ·å‡ºè‰²åœ°æ‰§è¡Œï¼Œå› ä¸ºåç¨‹å°è£…äº†æ¯ä¸ªä»»åŠ¡çš„çŠ¶æ€ï¼Œæ¶ˆé™¤äº†å…¨å±€çŠ¶æ€ç®¡ç†çš„éœ€è¦ã€‚ä¾‹å¦‚ï¼ŒDemikernel çš„ TCP å †æ ˆä¸ºæ¯ä¸ª TCP è¿æ¥ä½¿ç”¨ä¸€ä¸ªåç¨‹è¿›è¡Œé‡ä¼ ï¼Œè¿™ä¿æŒäº†ç›¸å…³çš„ TCP çŠ¶æ€ã€‚ åç¨‹ä¸å°±æ˜¯ç”¨æˆ·çº§çº¿ç¨‹å— æ¯ä¸ªåº“æ“ä½œç³»ç»Ÿéƒ½æœ‰ä¸€ä¸ªé›†ä¸­åŒ–çš„åç¨‹è°ƒåº¦å™¨ï¼Œé’ˆå¯¹å†…æ ¸æ—è·¯è®¾å¤‡è¿›è¡Œäº†ä¼˜åŒ–ã€‚ç”±äºåœ¨çº³ç§’çº§ [33, 15] ä¸­æ–­æ˜¯ä¸å¯æ‰¿å—çš„ï¼ŒDemikernel åç¨‹æ˜¯åä½œå¼çš„ï¼Œå®ƒä»¬é€šå¸¸åœ¨å‡ å¾®ç§’æˆ–æ›´çŸ­çš„æ—¶é—´å†…è®©å‡ºã€‚ä¼ ç»Ÿçš„åç¨‹é€šå¸¸é€šè¿‡è½®è¯¢å·¥ä½œï¼šè°ƒåº¦å™¨è¿è¡Œæ¯ä¸ªåç¨‹ä»¥æ£€æŸ¥è¿›åº¦ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬å‘ç°è½®è¯¢åœ¨çº³ç§’çº§æ˜¯ä¸å¯æ‰¿å—çš„ï¼Œå› ä¸ºå¤§é‡åç¨‹è¢«é˜»å¡åœ¨å¶å‘çš„ I/O äº‹ä»¶ä¸Šï¼ˆä¾‹å¦‚ï¼ŒTCP è¿æ¥çš„åŒ…åˆ°è¾¾ï¼‰ã€‚å› æ­¤ï¼ŒDemikernel åç¨‹ä¹Ÿæ˜¯å¯é˜»å¡çš„ã€‚è°ƒåº¦å™¨å°†å¯è¿è¡Œå’Œé˜»å¡çš„åç¨‹åˆ†å¼€ï¼Œå¹¶åœ¨äº‹ä»¶å‘ç”Ÿæ—¶ä»…å°†é˜»å¡çš„åç¨‹ç§»åŠ¨åˆ°å¯è¿è¡Œé˜Ÿåˆ—ä¸­ã€‚ ","date":"2024-09-24","objectID":"/posts/paper-demikernel/:5:3","tags":["Paper Reading"],"title":"Paper Reading: The Demikernel Datapath OS Architecture for Microsecond-scale Datacenter Systems","uri":"/posts/paper-demikernel/"},{"categories":null,"content":"PDPIX: A Portable Datapath API PDPIX æ˜¯é¢å‘é˜Ÿåˆ—çš„ï¼Œè€Œä¸æ˜¯é¢å‘æ–‡ä»¶çš„ ä¸é¢å‘æ–‡ä»¶æ˜¯ä»€ä¹ˆæ„æ€ã€‚ã€‚fd å˜æˆ é˜Ÿåˆ—æè¿°ç¬¦ I/O Queues: queue() åˆ›å»ºä¸€ä¸ªè½»é‡çº§çš„å†…å­˜ä¸­é˜Ÿåˆ—ï¼Œç±»ä¼¼äº Go é€šé“ ä¸ºä»€ä¹ˆè¦æŠŠæ–‡ä»¶å˜æˆé˜Ÿåˆ—ï¼Ÿ Network and Storage I/O: Memory: åº”ç”¨ç¨‹åºä¸ä¸ºä¼ å…¥çš„æ•°æ®åˆ†é…ç¼“å†²åŒºï¼›UAF protection Scheduling: PDPIX ç”¨å¼‚æ­¥çš„ wait_* è°ƒç”¨æ›¿æ¢äº† epoll äº‹ä»¶é©±åŠ¨ã€å¼‚æ­¥ï¼Ÿ ","date":"2024-09-24","objectID":"/posts/paper-demikernel/:5:4","tags":["Paper Reading"],"title":"Paper Reading: The Demikernel Datapath OS Architecture for Microsecond-scale Datacenter Systems","uri":"/posts/paper-demikernel/"},{"categories":null,"content":"Demikernel Datapath Library OS Design ","date":"2024-09-24","objectID":"/posts/paper-demikernel/:6:0","tags":["Paper Reading"],"title":"Paper Reading: The Demikernel Datapath OS Architecture for Microsecond-scale Datacenter Systems","uri":"/posts/paper-demikernel/"},{"categories":null,"content":"Design Overview æ¯ä¸ª Demikernel åº“æ“ä½œç³»ç»Ÿæ”¯æŒå•ä¸€ç±»å‹çš„å†…æ ¸æ—è·¯ I/O è®¾å¤‡ï¼ˆä¾‹å¦‚ï¼ŒDPDKã€RDMAã€SPDKï¼‰ï¼Œå¹¶ç”±ä¸€ä¸ªç”¨äº I/O è®¾å¤‡çš„ I/O å¤„ç†å †æ ˆã€ä¸€ä¸ªç‰¹å®šäºåº“æ“ä½œç³»ç»Ÿçš„å†…å­˜åˆ†é…å™¨å’Œä¸€ä¸ªé›†ä¸­åŒ–çš„åç¨‹è°ƒåº¦å™¨ç»„æˆã€‚ä¸ºäº†åŒæ—¶æ”¯æŒç½‘ç»œå’Œå­˜å‚¨ï¼Œæˆ‘ä»¬å°†åº“æ“ä½œç³»ç»Ÿé›†æˆåˆ°ä¸€ä¸ªå•ä¸€çš„åº“ä¸­ï¼Œç”¨äºä¸¤ç§è®¾å¤‡ï¼ˆä¾‹å¦‚ï¼ŒRDMAxSPDKï¼‰ã€‚ Rust é€šè¿‡è¯­è¨€ç‰¹æ€§å’Œç¼–è¯‘å™¨å¼ºåˆ¶æ‰§è¡Œå†…å­˜å®‰å…¨ è·¨å¹³å°çš„å¯ç§»æ¤æ€§ Rust å¯¹åç¨‹æœ‰å‡ºè‰²çš„æ”¯æŒ demikernel github è¿˜åœ¨æ›´æ–° ä½¿ç”¨ Rust çš„ä¸»è¦ç¼ºç‚¹æ˜¯éœ€è¦è®¸å¤šè·¨è¯­è¨€ç»‘å®šï¼Œå› ä¸ºå†…æ ¸æ—è·¯æ¥å£å’Œå¾®ç§’çº§åº”ç”¨ç¨‹åºä»ç„¶ä¸»è¦ç”¨ C/C++ ç¼–å†™ Demikernel åº“æ“ä½œç³»ç»Ÿä½¿ç”¨ Rust çš„ async/await è¯­è¨€ç‰¹æ€§ [85] åœ¨åç¨‹ä¸­å®ç°å¼‚æ­¥ I/O å¤„ç†ã€‚Rust åˆ©ç”¨å¯¹ç”Ÿæˆå™¨çš„æ”¯æŒå°†å‘½ä»¤å¼ä»£ç ç¼–è¯‘æˆå¸¦æœ‰è½¬æ¢å‡½æ•°çš„çŠ¶æ€æœºã€‚Rust ç¼–è¯‘å™¨ä¸ç›´æ¥ä¿å­˜å¯„å­˜å™¨å’Œäº¤æ¢æ ˆï¼›å®ƒå°†åç¨‹ç¼–è¯‘æˆå¸¦æœ‰â€œåœ¨æ ˆä¸Šâ€å€¼ç›´æ¥å­˜å‚¨åœ¨çŠ¶æ€æœºä¸­çš„å¸¸è§„å‡½æ•°è°ƒç”¨ [55]ã€‚ä½¿ç”¨ Rust çš„è¿™ä¸ªå…³é”®å¥½å¤„ä½¿å¾—åç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢è½»é‡ä¸”å¿«é€Ÿï¼ˆåœ¨æˆ‘ä»¬çš„ Rust åŸå‹ä¸­çº¦ä¸º 12 ä¸ªå‘¨æœŸï¼‰ï¼Œå¹¶å¸®åŠ©æˆ‘ä»¬çš„ I/O å †æ ˆåœ¨å…³é”®è·¯å¾„ä¸Šé¿å…çœŸæ­£çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚è™½ç„¶ Rust çš„è¯­è¨€æ¥å£å’Œç¼–å†™åç¨‹çš„ç¼–è¯‘å™¨æ”¯æŒæ˜¯å®šä¹‰è‰¯å¥½çš„ï¼Œä½† Rust ç›®å‰æ²¡æœ‰åç¨‹è¿è¡Œæ—¶ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨æ¯ä¸ªåº“æ“ä½œç³»ç»Ÿä¸­å®ç°äº†ä¸€ä¸ªç®€å•çš„åç¨‹è¿è¡Œæ—¶å’Œè°ƒåº¦å™¨ï¼Œè¯¥è°ƒåº¦å™¨é’ˆå¯¹æ¯ä¸ªå†…æ ¸æ—è·¯è®¾å¤‡æ‰€éœ€çš„ I/O å¤„ç†é‡è¿›è¡Œäº†ä¼˜åŒ–ã€‚ async? DPDK/RDMA å…¶å®æ˜¯ c å†™çš„å§ï¼Œåº”è¯¥ä¹Ÿæœ‰ rust-implementation è¿™é‡Œæåˆ°çš„åç¨‹è¿è¡Œæ—¶å¾ˆæœ‰æ„æ€ï¼ŒGo çš„åº”è¯¥å°±æ˜¯æ˜¯ GMP M:N ä¹‹ç±»çš„ï¼Ÿåœ¨ runtime package å›¾ä¾‹çœ‹ä¸Šå»æ˜¯ä¸€ä¸ªæ›´åŠ å¤§ä¸€ç»Ÿçš„æ¶æ„ï¼Œè€Œä¸æ˜¯å¾ˆæœ‰åˆ›æ–°è‡ªå·±çš„æ–¹æ³•ï¼Œèƒ½ä¸èƒ½ç†è§£ä¸ºï¼Œæ ¹æ®ä¸åŒçš„ API é€‰æ‹©ä¸åŒçš„ LibOS ","date":"2024-09-24","objectID":"/posts/paper-demikernel/:6:1","tags":["Paper Reading"],"title":"Paper Reading: The Demikernel Datapath OS Architecture for Microsecond-scale Datacenter Systems","uri":"/posts/paper-demikernel/"},{"categories":null,"content":"I/O Processing Demikernel I/O å †æ ˆå…±äº«åº”ç”¨ç¨‹åºçº¿ç¨‹ï¼Œå¹¶æ—¨åœ¨å®ç°è¿è¡Œåˆ°å®Œæˆï¼šå¿«é€Ÿè·¯å¾„åç¨‹å¤„ç†ä¼ å…¥æ•°æ®ï¼Œæ‰¾åˆ°é˜»å¡çš„ qtokenï¼Œè°ƒåº¦åº”ç”¨ç¨‹åºåç¨‹å¹¶å¤„ç†ä»»ä½•ä¼ å‡ºæ¶ˆæ¯ï¼Œç„¶åå†ç»§ç»­ä¸‹ä¸€ä¸ª I/Oã€‚åŒæ ·ï¼ŒDemikernel I/O å †æ ˆåœ¨ push ä¸­å†…è”ä¼ å‡º I/O å¤„ç†ï¼ˆåœ¨åº”ç”¨ç¨‹åºåç¨‹ä¸­ï¼‰ï¼Œå¹¶åœ¨æ— é”™è¯¯æƒ…å†µä¸‹æäº¤ I/Oï¼ˆåˆ°å¼‚æ­¥ç¡¬ä»¶ I/O APIï¼‰ã€‚å°½ç®¡åœ¨å¿«é€Ÿè·¯å¾„å’Œåº”ç”¨ç¨‹åºåç¨‹ä¹‹é—´ä¼šå‘ç”Ÿåç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œä½†å®ƒä¸ä¼šä¸­æ–­è¿è¡Œåˆ°å®Œæˆï¼Œå› ä¸º Rust å°†åç¨‹åˆ‡æ¢ç¼–è¯‘ä¸ºå‡½æ•°è°ƒç”¨ã€‚ ","date":"2024-09-24","objectID":"/posts/paper-demikernel/:6:2","tags":["Paper Reading"],"title":"Paper Reading: The Demikernel Datapath OS Architecture for Microsecond-scale Datacenter Systems","uri":"/posts/paper-demikernel/"},{"categories":null,"content":"Memory Management æ¯ä¸ª Demikernel åº“æ“ä½œç³»ç»Ÿä½¿ç”¨ç‰¹å®šäºè®¾å¤‡çš„ã€ç»è¿‡ä¿®æ”¹çš„ Hoard è¿›è¡Œå†…å­˜ç®¡ç† Hoard èµ„æºåˆ†é…å™¨ æ›¿ä»£ mallocï¼Ÿæ‰€ä»¥è¿™ç¯‡æ–‡ç« åŸºæœ¬å°±æ˜¯ç¼åˆå— å¯¹äºä½¿ç”¨åé‡Šæ”¾ä¿æŠ¤ï¼Œæ‰€æœ‰ Demikernel åˆ†é…å™¨æä¾›äº†ä¸€ä¸ªç®€å•çš„å¼•ç”¨è®¡æ•°æ¥å£ï¼šinc_ref(void _) å’Œ dec_ref(void _)ã€‚è¯·æ³¨æ„ï¼Œè¿™äº›æ¥å£ä¸æ˜¯ PDPIX çš„ä¸€éƒ¨åˆ†ï¼Œè€Œæ˜¯ Demikernel åº“æ“ä½œç³»ç»Ÿçš„å†…éƒ¨æ¥å£ã€‚åº“æ“ä½œç³»ç»Ÿ I/O å †æ ˆåœ¨å‘å‡º I/O æ—¶è°ƒç”¨ inc_refï¼Œå¹¶åœ¨å®Œæˆç¼“å†²åŒºæ—¶è°ƒç”¨ dec_refã€‚å¦‚å‰æ‰€è¿°ï¼ŒDemikernel åº“æ“ä½œç³»ç»Ÿå¯èƒ½éœ€è¦é•¿æ—¶é—´æŒæœ‰å¼•ç”¨ï¼›ä¾‹å¦‚ï¼ŒTCP å †æ ˆåªæœ‰åœ¨æ¥æ”¶æ–¹ç¡®è®¤æ•°æ®åŒ…åæ‰èƒ½å®‰å…¨åœ°è°ƒç”¨ dec_ref åº”è¯¥è‡ªå·±å®ç°äº†ä¸€ä¸ªå¼•ç”¨è®¡æ•°æ¥åš UAF ä½†å¼•ç”¨è®¡æ•°ä¼šä¸ä¼šä¸å¤Ÿå‘¢ï¼Œå†…æ ¸æ€ä¼šä¸ä¼šå­˜åœ¨å¾ªç¯å¼•ç”¨ï¼Ÿ ","date":"2024-09-24","objectID":"/posts/paper-demikernel/:6:3","tags":["Paper Reading"],"title":"Paper Reading: The Demikernel Datapath OS Architecture for Microsecond-scale Datacenter Systems","uri":"/posts/paper-demikernel/"},{"categories":null,"content":"Coroutine Scheduler A Demikernel libOS has three coroutine types, reflecting com- mon CPU consumers: (1) a fast-path I/O processing coroutine for each I/O stack that polls for I/O and performs fast-path I/O processing, (2) several background coroutines for other I/O stack work (e.g., managing TCP send windows), and (3) one application coroutine per blocked qtoken, which runs an application worker to process a single reques æ¯ä¸ªåº“æ“ä½œç³»ç»Ÿè°ƒåº¦å™¨ä¼˜å…ˆè¿è¡Œå¯è¿è¡Œçš„åº”ç”¨ç¨‹åºåç¨‹ï¼Œç„¶åæ˜¯åå°åç¨‹å’Œå§‹ç»ˆå¯è¿è¡Œçš„å¿«é€Ÿè·¯å¾„åç¨‹ï¼ŒæŒ‰ FIFO æ–¹å¼è¿›è¡Œ å› æ­¤ï¼Œæ¯ä¸ªè°ƒåº¦å™¨ä¸€æ¬¡è¿è¡Œä¸€ä¸ªåç¨‹ã€‚æˆ‘ä»¬æœŸæœ›åç¨‹è®¾è®¡å°†æ‰©å±•åˆ°æ›´å¤šæ ¸å¿ƒã€‚ç„¶è€Œï¼ŒDemikernel åº“æ“ä½œç³»ç»Ÿéœ€è¦ä»”ç»†è®¾è®¡ä»¥é¿å…è·¨æ ¸å¿ƒçš„å…±äº«çŠ¶æ€ï¼Œå› æ­¤æˆ‘ä»¬å°šä¸æ¸…æ¥šè¿™æ˜¯å¦ä¼šæˆä¸ºä¸€ä¸ªä¸»è¦é™åˆ¶ã€‚ è·¨æ ¸å¿ƒçš„å…±äº«çŠ¶æ€ï¼Œdpdk åˆæ€ä¹ˆåšå‘¢ï¼Œé”ï¼Ÿæ„Ÿè§‰éƒ½æ˜¯ç”¨å¤šé˜Ÿåˆ—ç¼“å†² ","date":"2024-09-24","objectID":"/posts/paper-demikernel/:6:4","tags":["Paper Reading"],"title":"Paper Reading: The Demikernel Datapath OS Architecture for Microsecond-scale Datacenter Systems","uri":"/posts/paper-demikernel/"},{"categories":null,"content":"Network and Storage LibOS Integration Demikernel å†…å­˜åˆ†é…å™¨ä¸º DPDK ç½‘ç»œæˆ– SPDK å­˜å‚¨ I/O æä¾› DMA èƒ½åŠ›çš„å†…å­˜ã€‚æˆ‘ä»¬ä¿®æ”¹ Hoardï¼Œä» DPDK å†…å­˜æ± ä¸º SPDK åˆ†é…å†…å­˜å¯¹è±¡ï¼Œå¹¶å°†ç›¸åŒçš„å†…å­˜æ³¨å†Œåˆ° RDMAã€‚æˆ‘ä»¬åœ¨è½®è¯¢ DPDK è®¾å¤‡å’Œ SPDK å®Œæˆé˜Ÿåˆ—ä¹‹é—´æ‹†åˆ†å¿«é€Ÿè·¯å¾„åç¨‹ï¼Œä»¥è½®è¯¢æ–¹å¼åˆ†é… CPU å‘¨æœŸçš„å…¬å¹³ä»½é¢ï¼Œåœ¨æ— å¾…å¤„ç† I/O çš„æƒ…å†µä¸‹ã€‚æœªæ¥å¯ä»¥å®ç°æ›´å¤æ‚çš„ CPU å‘¨æœŸåœ¨ç½‘ç»œå’Œå­˜å‚¨ I/O å¤„ç†ä¹‹é—´çš„è°ƒåº¦ã€‚æ€»çš„æ¥è¯´ï¼Œç½‘ç»œå’Œå­˜å‚¨æ•°æ®è·¯å¾„åº“æ“ä½œç³»ç»Ÿä¹‹é—´çš„å¯ç§»æ¤é›†æˆæ˜¾è‘—ç®€åŒ–äº†åœ¨ç½‘ç»œå’Œå­˜å‚¨å†…æ ¸æ—è·¯è®¾å¤‡ä¸Šè¿è¡Œçš„å¾®ç§’çº§åº”ç”¨ç¨‹åºã€‚ ","date":"2024-09-24","objectID":"/posts/paper-demikernel/:6:5","tags":["Paper Reading"],"title":"Paper Reading: The Demikernel Datapath OS Architecture for Microsecond-scale Datacenter Systems","uri":"/posts/paper-demikernel/"},{"categories":null,"content":"Demikernel Library OS Implementations We prototype two Demikernel datapath OSes: DEMILIN for Linux and DEMIWIN for Windows å…¶å®åš Linux åº”è¯¥ä¸éš¾ï¼Œå¤§å®¶éƒ½åœ¨åšã€‚ä½†æ˜¯åš Windows çš„æœ‰ç‚¹å‰å®³å§ DEMIWIN ç›®å‰ä»…æ”¯æŒé€šè¿‡ WSL çš„ Catpaw å’Œ Catnap POSIX åº“æ“ä½œç³»ç»Ÿå®ç°çš„ RDMA å†…æ ¸æ—è·¯è®¾å¤‡ DEMIWIN å®ç° DEMIWIN æ˜¯ Demikernel åœ¨ Windows ä¸Šçš„å®ç°ï¼Œç›®å‰ä»…æ”¯æŒ RDMA å†…æ ¸æ—è·¯è®¾å¤‡ã€‚å®ƒé€šè¿‡ WSLï¼ˆWindows Subsystem for Linuxï¼‰ä½¿ç”¨ Catpaw å’Œ Catnap POSIX åº“æ“ä½œç³»ç»Ÿã€‚Catpaw åŸºäº NDSPI v2 æ„å»º ä¸å¤ªæ¸…æ¥šè¿™é‡Œè¯´çš„æ”¯æŒ windows åˆ°åº•æ˜¯ wsl è¿˜æ˜¯ raw windows ","date":"2024-09-24","objectID":"/posts/paper-demikernel/:7:0","tags":["Paper Reading"],"title":"Paper Reading: The Demikernel Datapath OS Architecture for Microsecond-scale Datacenter Systems","uri":"/posts/paper-demikernel/"},{"categories":null,"content":"Catnap POSIX Library OS ","date":"2024-09-24","objectID":"/posts/paper-demikernel/:7:1","tags":["Paper Reading"],"title":"Paper Reading: The Demikernel Datapath OS Architecture for Microsecond-scale Datacenter Systems","uri":"/posts/paper-demikernel/"},{"categories":null,"content":"Catmint and Catpaw RDMA Library OSes Catmint åœ¨ rdma_cm [79] æ¥å£ä¹‹ä¸Šæ„å»º PDPIX é˜Ÿåˆ—æ¥ç®¡ç†è¿æ¥ï¼Œå¹¶ä½¿ç”¨ ib_verbs æ¥å£é«˜æ•ˆåœ°å‘é€å’Œæ¥æ”¶æ¶ˆæ¯ã€‚å®ƒä½¿ç”¨åŒè¾¹ RDMA æ“ä½œæ¥å‘é€å’Œæ¥æ”¶æ¶ˆæ¯ï¼Œè¿™ç®€åŒ–äº†å¯¹ wait_* æ¥å£çš„æ”¯æŒã€‚æˆ‘ä»¬åœ¨ NSDPI ä¹‹ä¸Šçš„ Catpaw ä½¿ç”¨äº†ç±»ä¼¼çš„è®¾è®¡ã€‚ ","date":"2024-09-24","objectID":"/posts/paper-demikernel/:7:2","tags":["Paper Reading"],"title":"Paper Reading: The Demikernel Datapath OS Architecture for Microsecond-scale Datacenter Systems","uri":"/posts/paper-demikernel/"},{"categories":null,"content":"Catnip DPDK Library OS ","date":"2024-09-24","objectID":"/posts/paper-demikernel/:7:3","tags":["Paper Reading"],"title":"Paper Reading: The Demikernel Datapath OS Architecture for Microsecond-scale Datacenter Systems","uri":"/posts/paper-demikernel/"},{"categories":null,"content":"Cattree SPDK Library OS å‘½åæ„Ÿè§‰æ€ªæ€ªçš„ï¼Œè¿™é‡Œåˆ Cat ä»€ä¹ˆä»€ä¹ˆ ","date":"2024-09-24","objectID":"/posts/paper-demikernel/:7:4","tags":["Paper Reading"],"title":"Paper Reading: The Demikernel Datapath OS Architecture for Microsecond-scale Datacenter Systems","uri":"/posts/paper-demikernel/"},{"categories":null,"content":"Evaluation ","date":"2024-09-24","objectID":"/posts/paper-demikernel/:8:0","tags":["Paper Reading"],"title":"Paper Reading: The Demikernel Datapath OS Architecture for Microsecond-scale Datacenter Systems","uri":"/posts/paper-demikernel/"},{"categories":null,"content":"Experimental Setup ","date":"2024-09-24","objectID":"/posts/paper-demikernel/:8:1","tags":["Paper Reading"],"title":"Paper Reading: The Demikernel Datapath OS Architecture for Microsecond-scale Datacenter Systems","uri":"/posts/paper-demikernel/"},{"categories":null,"content":"Programmability for Î¼s-scale Datacenter Systems TURN UDP Relay: Teams / Skype ä»–å°† TURN æœåŠ¡å™¨ç§»æ¤åˆ° Demikernel èŠ±è´¹äº† 1 å¤© [38]ï¼Œè€Œç§»æ¤åˆ° io_uring [12] å’Œ Seastar [42] å„èŠ±è´¹äº† 2 å¤©ã€‚æœ€ç»ˆï¼Œä»–æ— æ³•ä½¿ Seastar å·¥ä½œï¼Œå¹¶ä¸”é‡åˆ°äº† io_uring çš„é—®é¢˜ã€‚ Redis: TxnStore: å¤ªé•¿äº†è¿™ç¯‡è®ºæ–‡ï¼Œç›´æ¥æ ¹æ® evaluation åšç‚¹åˆ†æ ä¸¤ä¸ªå†…æ ¸æ—è·¯åº”ç”¨ç¨‹åºï¼ˆtestpmd [93] å’Œ perftest [84]ï¼‰å°±æ˜¯ DPDK å’Œ RDMA ä¸‰ä¸ªæœ€æ–°çš„å†…æ ¸æ—è·¯åº“ï¼ˆeRPC [34]ã€Shenango [71] å’Œ Caladan [23]ï¼‰ é¦–å…ˆæ¯”è¾ƒçš„æ˜¯å¯ç¼–ç¨‹æ€§ï¼Œç”¨çš„æ˜¯ LoCã€‚ã€‚ç¬¬ä¸€æ¬¡è§ï¼Œåˆä¸æ˜¯è¯´å·®å‡ ä¸ªæ•°é‡çº§ï¼ŒåŒæ•°é‡çº§ä¸‹å°± 10% ä¸åˆ°çš„ä»£ç é‡å‡å°‘ï¼Œæ ¹æœ¬å°±æ˜¯è¯­è¨€è®¾è®¡é£æ ¼å’Œè¯¯å·®å§ï¼Œè®©ä¸ä¼šç”¨ Rust çš„å†™ DemiKernel æ¯” C å¸¦æ¥çš„è´Ÿæ‹…åº”è¯¥æ›´å¤§ï¼Ÿä¸è¿‡ C åº”è¯¥èƒ½è°ƒç”¨ DemiKernel ä½†æ˜¯è®©ä¸“å®¶æ¥ç§»æ¤ä¸€äº›ç»å…¸åº”ç”¨æ¥è¯´è¿˜æ˜¯æœ‰ä¿¡æœåŠ›çš„ åªä¸è¿‡ redis ç”¨äº† epollï¼Œè®ºæ–‡æ¢æˆäº†é˜Ÿåˆ—ï¼Œè§£å†³äº†ä¸€äº› epoll å¸¦æ¥çš„é—®é¢˜ï¼Œmetrics åœ¨ 7.5 figure 11 å¯ä»¥çœ‹å¹çš„é‚£ä¹ˆå¥½ï¼Œè¿˜åŠ ä¸ªäº† persistent Log æŒ‡æ ‡ï¼Œä¸ºä»€ä¹ˆåˆè¦æ¯”è¾ƒ disk æ€§èƒ½äº†ã€‚ å¤„äº POSIX çš„æ€§èƒ½ä¸‹é™äº†å‡ ä¹ 30%+ï¼ŒRDMA åˆæ²¡æœ‰å‚è€ƒå¯¹æ¯”ï¼ŒDPDK æœ‰æå‡ï¼Œä½†ä¹Ÿæ²¡æœ‰å‚è€ƒã€‚ ","date":"2024-09-24","objectID":"/posts/paper-demikernel/:8:2","tags":["Paper Reading"],"title":"Paper Reading: The Demikernel Datapath OS Architecture for Microsecond-scale Datacenter Systems","uri":"/posts/paper-demikernel/"},{"categories":null,"content":"Echo Application å°±ç»“æœæ¥çœ‹ï¼Œå¹¶æ²¡æœ‰å¤ªå¥½ï¼Œå…ˆä¸è¯´å›¾æœ‰ç‚¹è¯¯å¯¼äººï¼ŒåŠ ä¸Šä¸ª everything else åˆä¸è¯´æ˜¯ä»€ä¹ˆï¼Œ åŒæ · DPDK / Catnip å¸¦æ¥äº† 2-3 us çš„å»¶è¿Ÿï¼Œè¿™åˆå’Œ motivation çŸ›ç›¾ï¼Œè€Œè¿™åªæ˜¯ç®€å•çš„ echoï¼Œæ›´å¤æ‚çš„å‘¢ï¼Ÿ è®ºæ–‡è¿˜æåˆ°äº†è·¨å¤šæ ¸å¿ƒçš„é—®é¢˜ ","date":"2024-09-24","objectID":"/posts/paper-demikernel/:8:3","tags":["Paper Reading"],"title":"Paper Reading: The Demikernel Datapath OS Architecture for Microsecond-scale Datacenter Systems","uri":"/posts/paper-demikernel/"},{"categories":null,"content":"Conclusion é›†å¤§æˆçš„è®ºæ–‡ï¼Œæ€»çš„æ¥è¯´æ˜¯ä¸é”™çš„è®ºæ–‡ï¼Œæ¶è¡¥ MIT OS çš„è®¡åˆ’è¦æä¸Šæ—¥ç¨‹äº† ä½† motivatin æœ‰ç‚¹å¼±ï¼Œé€šç”¨æ€§å’Œæ€§èƒ½æ˜¯å¾ˆç»å…¸çš„ tradeoffï¼Œä½†æˆ‘ä¸è®¤ä¸ºæœ‰å¾ˆå¥½çš„é€šç”¨æ€§ï¼Œç”¨æˆ·è¦ç”¨ dpdk å°±ç›´æ¥ç”¨ dpdk å®˜æ–¹äº†ï¼Œä¹Ÿä¸ä¼šçªç„¶è½¬å¤´è¯´è¦æ¥ä¸€ä¸ª rdmaï¼ŒåŒæ—¶ä½¿ç”¨ä¸¤ç§çš„åœºæ™¯ä¼šå—ç¡¬ä»¶é™åˆ¶å§ æ€§èƒ½è¯´æ˜¯æ²¡æœ‰å‰Šå¼±å¤ªå¤šï¼Œä½†ç»™çš„ evaluation éƒ½æ²¡ä»€ä¹ˆè¯´æœåŠ›ï¼Œecho å¤ªç®€å•ï¼Œredis æ€§èƒ½åªæœ‰ dpdk ä¸é”™ä½†æ²¡æœ‰å‚ç…§äº†ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯æˆ‘çœ‹æ¼äº†ä»€ä¹ˆ å…¶ä»–ä¸€äº›å¸¦æ¥çš„ä¼˜åŠ¿æ›´åƒæ˜¯è¯­è¨€ç‰¹æ€§ï¼ŒUAF ä¹‹ç±»çš„ã€‚å”¯ä¸€æœ‰æ„æ€çš„è¿˜æ˜¯ç”¨é˜Ÿåˆ—æ›¿æ¢ epoll ä»€ä¹ˆçš„ï¼ŒåŠ å…¥å¼‚æ­¥ï¼Œä½†æ„Ÿè§‰ä¹Ÿæ˜¯è¯­è¨€ç‰¹æ€§ã€‚ é›¶æ‹·è´åº”è¯¥æ˜¯å¾ˆæœ‰æ„æ€çš„åœ°æ–¹ï¼Œè®ºæ–‡è¯´æ˜¯å®ç°äº†å¾ˆä¸é”™çš„é›¶æ‹·è´ï¼Œä½†æ„Ÿè§‰åªæ˜¯è¯­ä¹‰ä¸Šçš„ï¼Œèƒ½ä¸èƒ½æŠŠ kafka ä»€ä¹ˆçš„æ‹‰å‡ºæ¥åšä¸ªæ¯”è¾ƒå‘¢ ","date":"2024-09-24","objectID":"/posts/paper-demikernel/:9:0","tags":["Paper Reading"],"title":"Paper Reading: The Demikernel Datapath OS Architecture for Microsecond-scale Datacenter Systems","uri":"/posts/paper-demikernel/"},{"categories":null,"content":"Rethinking the RDMA Interface for Distributed Systems å¯¹ RDMA æ²¡ä»€ä¹ˆäº†è§£ Linux é«˜æ€§èƒ½ç½‘ç»œè¯¦è§£ï¼šä» DPDKã€RDMA åˆ° XDPï¼Œè¿™æœ¬ä¹¦çœ‹è¯„ä»·å¾ˆä¸é”™ï¼Œæœ‰æœºä¼šå¯ä»¥çœ‹çœ‹ DMA: IO è®¾å¤‡æ¯”å¦‚ç½‘å¡ï¼Œéœ€è¦ä»å†…å­˜æ‹¿å‘é€çš„æ•°æ®ï¼Œéœ€è¦å‘Šè¯‰ CPU ä»å†…å­˜ç¼“å†²åŒºå¤åˆ¶ï¼Œè®¸å¤šå¤åˆ¶ä¼šè®© CPU é˜»å¡ã€‚DMA æ§åˆ¶å™¨ï¼Œå¯ä»¥ä¸“é—¨è¯»å†™å†…å­˜ï¼Œç»•å¼€äº† CPUï¼Œä½† DMA æ§åˆ¶å™¨ä¸€èˆ¬å’Œ IO è®¾å¤‡ä¸€èµ·ï¼Ÿ RDMAï¼šç»•å¼€ TCP/IP åè®®æ ˆæ¥è¯»å–è¿œç«¯çš„å†…å­˜ã€‚ä¼ ç»Ÿç½‘ç»œ A å‘é€æ¶ˆæ¯ç»™ Bï¼ŒA å†…å­˜æ•°æ®å¤åˆ¶åˆ° B çš„å†…å­˜ï¼Œéœ€è¦ CPU ä¸­æ–­ã€åè®®æ ˆå¤„ç†ç­‰ç­‰ï¼ŒRDMA åˆ™å¯ä»¥ç›´æ¥ä»å†…å­˜å¤åˆ¶æ•°æ®ï¼Œç”¨ç¡¬ä»¶ç»„è£…åå‘é€åˆ°å¯¹æ–¹ç½‘å¡ã€‚ RDMA åè®®ï¼šInfiniBand ","date":"2024-09-22","objectID":"/posts/paper-prism/:1:0","tags":["Paper Reading"],"title":"Paper Reading: Rethinking the RDMA Interface for Distributed Systems","uri":"/posts/paper-prism/"},{"categories":null,"content":"Abstract RDMA + distributed systems However, most of the distributed protocols used in these systems cannot easily be expressed in terms of the simple memory READs and WRITEs provided by RDMA å¼•å…¥é¢å¤–çš„åè®®æ”¯æŒ RDMA è¿˜æ˜¯æ”¾å¼ƒ RDMAï¼Œadditional round trip æ˜¯ä»€ä¹ˆæ„æ€ æœ¬æ–‡è®¤ä¸ºï¼ŒRDMA interface çš„æ‰©å±•å¯ä»¥è§£å†³è¿™ä¸€éš¾é¢˜ã€‚æˆ‘ä»¬ä»‹ç»äº† PRISM æ¥å£ï¼Œå®ƒæ·»åŠ äº†å››ä¸ªæ–°çš„åŸè¯­: indirection, allocation, enhanced compare-and-swap, and operation chainingã€‚è¿™äº›æé«˜äº† RDMA æ¥å£çš„è¡¨è¾¾èƒ½åŠ›ï¼ŒåŒæ—¶ä»ç„¶å¯ä»¥ä½¿ç”¨ç›¸åŒçš„åº•å±‚ç¡¬ä»¶ç‰¹æ€§æ¥å®ç°ã€‚æˆ‘ä»¬é€šè¿‡ä½¿ç”¨ PRISM åŸè¯­è®¾è®¡ä¸‰ä¸ªå‡ ä¹ä¸éœ€è¦æœåŠ¡å™¨ç«¯ CPU å‚ä¸çš„æ–°åº”ç”¨ç¨‹åºæ¥å±•ç¤ºå®ƒä»¬çš„å®ç”¨æ€§: (1) PRISM-KVï¼Œä¸€ä¸ªé”®å€¼å­˜å‚¨; (2) PRISM-RSï¼Œä¸€ä¸ª replicated block store; (3) PRISM-TXï¼Œä¸€ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡åè®®ã€‚ä½¿ç”¨åŸºäºè½¯ä»¶çš„ PRISM åŸè¯­å®ç°ï¼Œæˆ‘ä»¬è¡¨æ˜è¿™äº›ç³»ç»Ÿä¼˜äºå…ˆå‰åŸºäº RDMA çš„ç­‰æ•ˆç³»ç»Ÿ æ‰©å±• RDMA æ¥å£ RDMA åº”è¯¥æ˜¯åˆ†å¸ƒå¼å­˜å‚¨é‡Œçš„çƒ­é—¨æ–¹å‘ ","date":"2024-09-22","objectID":"/posts/paper-prism/:2:0","tags":["Paper Reading"],"title":"Paper Reading: Rethinking the RDMA Interface for Distributed Systems","uri":"/posts/paper-prism/"},{"categories":null,"content":"Introduction reduce the CPU cost of packet processing This makes RDMA, which provides a standard, accelerated interface for one host to directly access anotherâ€™s memory, appealing: hardware RDMA implementations bypass the host CPU entirely [28], and even software implementations offer significant performance improvements by simplifying the network stack and reducing context-switching overhead è½¯ä»¶ç»•è¿‡åè®®æ ˆå‡å°‘ä¸Šä¸‹æ–‡åˆ‡æ¢ + ç¡¬ä»¶ç»•è¿‡ CPU A common theme is that adapting applications to run on RDMA requires complexâ€”and costlyâ€”contortions. Consequently, many RDMA applications are forced to add extra operations, i.e., extra network round trips, to their protocols, sacrificing some of the latency benefits network round trips æœ‰ä¾‹å­å—ï¼Œå¼•ç”¨äº†ä¸€ç¯‡ RDMA KV store Christopher Mitchell, Yifeng Geng, and Jinyang Li. 2013. Using One-sided RDMA Reads to Build a Fast, CPU-efficient Key-value Store. In Proceedings of the 2013 USENIX Annual Technical Conference USENIX, San Jose, CA, USA é¢å¤–çš„ RTT æ˜¯è¯´éœ€è¦è®¡ç®—å—ï¼ŒA-\u003eB è¯·æ±‚ç”Ÿæˆæ•°æ®ï¼ŒB ç”Ÿæˆæ•°æ®å­˜åœ¨å†…å­˜ï¼ŒA RDMA READ å…¶ä»–ä¸€äº›åˆ™é‡‡ç”¨æ··åˆè®¾è®¡ï¼Œéœ€è¦åœ¨æŸäº›æ“ä½œä¸­æ¶‰åŠåº”ç”¨ç¨‹åº CPU[10, 31, 43]ï¼Œæˆ–è€…åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä»…ä»…ä½¿ç”¨ RDMA æ¥å®ç°æ›´å¿«çš„æ¶ˆæ¯ä¼ é€’åè®®[15, 34]ï¼Œä»è€ŒæŠµæ¶ˆäº† CPU æ—è·¯çš„ç›Šå¤„ã€‚ å¦‚æœç”¨ RDMA åšæ¶ˆæ¯ä¼ é€’æ˜¯ä¸å¤Ÿé«˜æ•ˆçš„ï¼Ÿå¤šæ¬¡ RTTã€‚ä¸ºä»€ä¹ˆè¯´ negating the benefits of CPU bypass æœ¬æ–‡è®¤ä¸ºï¼Œè¶…è¶ŠåŸºæœ¬çš„ RDMA æ¥å£å¯¹äºå®ç°æ„å»ºä½å»¶è¿Ÿç³»ç»Ÿçš„å…¨éƒ¨ç½‘ç»œåŠ é€Ÿæ½œåŠ›æ˜¯å¿…è¦çš„ã€‚RDMA æ¥å£æœ€åˆæ˜¯ä¸ºäº†æ”¯æŒå¹¶è¡Œè¶…çº§è®¡ç®—åº”ç”¨è€Œè®¾è®¡çš„ï¼Œä½†å®ƒä¸èƒ½æ»¡è¶³å½“ä»Šåˆ†å¸ƒå¼ç³»ç»Ÿçš„éœ€æ±‚ã€‚æˆ‘ä»¬å±•ç¤ºäº†é€šè¿‡ä½¿ç”¨ä¸€äº›é¢å¤–çš„åŸè¯­æ¥æ‰©å±•æ¥å£ï¼Œå®Œå…¨ä½¿ç”¨è¿œç¨‹æ“ä½œæ¥å®ç°å¤æ‚çš„åˆ†å¸ƒå¼åº”ç”¨ç¨‹åº(å¦‚å¤åˆ¶å­˜å‚¨ replicated storage)æˆä¸ºå¯èƒ½ã€‚ å­˜å‚¨å‰¯æœ¬ï¼Œå†—ä½™ï¼Ÿ æˆ‘ä»¬åœ¨æœ¬æ–‡ä¸­çš„ç›®æ ‡æ˜¯ç¡®å®š RDMA æ¥å£çš„ä¸€ç»„é€šç”¨(å³éç‰¹å®šäºåº”ç”¨ç¨‹åºçš„)æ‰©å±•ï¼Œå…è®¸åˆ†å¸ƒå¼ç³»ç»Ÿæ›´å¥½åœ°åˆ©ç”¨ RDMA ç¡¬ä»¶çš„ä½å»¶è¿Ÿå’Œ CPU å¸è½½èƒ½åŠ› better utilize the low latency and CPU offload capabilitiesã€‚æˆ‘ä»¬çš„æè®®æ˜¯ PRISM æ¥å£ã€‚PRISM æ‰©å±•äº† RDMA è¯»/å†™æ¥å£ï¼Œå¢åŠ äº†å››ä¸ªåŸºæœ¬å…ƒç´ : indirection, allocation, enhanced compare-and-swap, and operation chaining. ç»“åˆèµ·æ¥ï¼Œå®ƒä»¬æ”¯æŒå¸¸è§çš„è¿œç¨‹è®¿é—®æ¨¡å¼ï¼Œæ¯”å¦‚æ•°æ®ç»“æ„å¯¼èˆªã€å¼‚åœ°æ›´æ–°å’Œå¹¶å‘æ§åˆ¶ã€‚æˆ‘ä»¬è®¤ä¸º PRISM API éå¸¸ç®€å•ï¼Œå¯ä»¥åœ¨ RDMA ç½‘å¡ä¸­å®ç°ï¼Œå› ä¸ºå®ƒé‡ç”¨äº†ç°æœ‰çš„å¾®æ¶æ„æœºåˆ¶ã€‚æˆ‘ä»¬è¿˜åœ¨ä¸€ä¸ªåŸºäºè½¯ä»¶çš„ç½‘ç»œå †æ ˆåŸå‹ä¸­å®ç°äº† PRISM æ¥å£ï¼Œè¯¥åŸå‹ä½¿ç”¨ä¸“ç”¨çš„ CPU æ ¸å¿ƒæ¥å®ç°è¿œç¨‹æ“ä½œï¼Œçµæ„Ÿæ¥è‡ªäº Google çš„ SNAP ç½‘ç»œå †æ ˆæ‰€é‡‡ç”¨çš„æ–¹æ³• Google SNAP, Scalable Network Appliance Platform åº”è¯¥ä¹Ÿæ˜¯ç”¨æˆ·ç½‘ç»œæ ˆ existing RDMA interface leads to extra protocol complexity for distributed systems. PRISM interface, which extends RDMA with additional primitives to support common patterns in distributed applications three sophisticated applicationsâ€”key-value stores, replicated block storage, and distributed transactions can be implemented entirely using the PRISM interface. software-based prototype of the PRISM interface å°½ç®¡ç›¸å¯¹äº NIC å­˜åœ¨é¢å¤–çš„æ€§èƒ½å¼€é”€ï¼Œä½†åœ¨ PRISM ä¹‹ä¸Šæ„å»ºçš„åº”ç”¨ç¨‹åºä»èƒ½å®ç°å»¶è¿Ÿå’Œååé‡çš„ä¼˜åŠ¿ ä»€ä¹ˆæ ·çš„ tradeoff? ","date":"2024-09-22","objectID":"/posts/paper-prism/:3:0","tags":["Paper Reading"],"title":"Paper Reading: Rethinking the RDMA Interface for Distributed Systems","uri":"/posts/paper-prism/"},{"categories":null,"content":"Background and Motivation RDMA æ˜¯ä¸€ä¸ªå¹¿æ³›éƒ¨ç½²çš„[13,26]ç½‘ç»œæ¥å£ï¼Œå…è®¸è¿œç¨‹å®¢æˆ·ç«¯ç›´æ¥åœ¨è¿œç¨‹ä¸»æœºä¸Šè¯»å†™å†…å­˜ï¼Œå®Œå…¨ç»•è¿‡è¿œç¨‹ CPU ","date":"2024-09-22","objectID":"/posts/paper-prism/:4:0","tags":["Paper Reading"],"title":"Paper Reading: Rethinking the RDMA Interface for Distributed Systems","uri":"/posts/paper-prism/"},{"categories":null,"content":"RPCs vs Memory Accesses: The RDMA Dilemma RDMA æä¾›äº†ä¸¤ç§ç±»å‹çš„æ“ä½œã€‚Two-sided åŒè¾¹æ“ä½œå…·æœ‰ä¼ ç»Ÿçš„æ¶ˆæ¯ä¼ é€’ message-passing è¯­ä¹‰ã€‚SEND æ“ä½œå°†æ¶ˆæ¯ä¼ è¾“åˆ°è¿œç¨‹åº”ç”¨ç¨‹åºï¼Œè¯¥åº”ç”¨ç¨‹åºè°ƒç”¨ RECEIVEã€‚One-sided å•è¾¹æ“ä½œå…è®¸ä¸»æœºåœ¨è¿œç¨‹ä¸»æœºï¼ˆåœ¨é¢„æ³¨å†Œçš„åŒºåŸŸä¸­ï¼‰ä¸Šè¿›è¡Œå†…å­˜çš„è¯»å–æˆ–å†™å…¥ã€‚ç³»ç»Ÿç¤¾åŒºä¸­å…³äºæ˜¯å¦ä½¿ç”¨å•è¾¹æˆ–åŒè¾¹æ“ä½œçš„äº‰è®ºä¸€ç›´å­˜åœ¨ [16, 19, 43]ã€‚One-sided å•è¾¹æ“ä½œæ›´å¿«ä¸”æ›´èŠ‚çœ CPU èµ„æºï¼Œä½†ä»…é™äºç®€å•çš„è¯»å†™æ“ä½œã€‚åŒè¾¹æ¶ˆæ¯ä¼ é€’ç”±äºå…è®¸åœ¨ä¸¤ç«¯è¿›è¡Œå¤„ç†ï¼Œå°½ç®¡é€šä¿¡æ“ä½œæœ¬èº«è¾ƒæ…¢ï¼Œä½†æ€»ä½“ä¸Šå¯èƒ½ä¼šäº§ç”Ÿæ›´å¿«çš„ç³»ç»Ÿã€‚ tradeoff: ä»¥ Pilaf [31]ä¸ºä¾‹ï¼Œè¿™æ˜¯ä¸€ä¸ªæ—©æœŸçš„åŸºäº RDMA çš„é”®å€¼å­˜å‚¨ç³»ç»Ÿã€‚Pilaf åœ¨å“ˆå¸Œè¡¨ä¸­å­˜å‚¨é”®å€¼å¯¹è±¡çš„æŒ‡é’ˆï¼Œå®é™…æ•°æ®å­˜å‚¨åœ¨å•ç‹¬çš„ extents ç»“æ„ä¸­ã€‚è¿™ä¸¤ä¸ªç»“æ„éƒ½é€šè¿‡ RDMA æš´éœ²å‡ºæ¥ï¼Œå› æ­¤å®¢æˆ·ç«¯å¯ä»¥é€šè¿‡è¿œç¨‹è¯»å–å“ˆå¸Œè¡¨ï¼Œç„¶åä½¿ç”¨æŒ‡é’ˆè¿›è¡Œè¿œç¨‹è¯»å–åˆ° extents å­˜å‚¨ä¸­æ¥æ‰§è¡Œé”®å€¼æŸ¥æ‰¾ã€‚è¿™ä¸éœ€è¦æœåŠ¡å™¨ç«¯çš„ CPU å‚ä¸ï¼Œä½†éœ€è¦ä¸¤æ¬¡å¾€è¿”ã€‚ä½¿ç”¨åŒè¾¹æ“ä½œæ„å»ºçš„ä¼ ç»Ÿé”®å€¼å­˜å‚¨å®ç°åªéœ€è¦ä¸€æ¬¡å¾€è¿”ï¼Œä½†æ¯æ¬¡æ“ä½œéƒ½éœ€è¦ CPU å‚ä¸ã€‚ ä¸ºä»€ä¹ˆä¼ ç»Ÿ kv åªéœ€è¦ä¸€æ¬¡ rt ä½†éœ€è¦ cpu pilaf åº”è¯¥æ˜¯ä¸€æ¬¡è¯»å“ˆå¸Œå¾—åˆ°æŒ‡é’ˆï¼Œä¸€æ¬¡è¯» extents å¾—åˆ°æ•°æ® åŒè¾¹ï¼šä¸€æ¬¡è¯·æ±‚ï¼Œè¿”å›æ•°æ®ï¼Œä½†æ˜¯ cpu å¤„ç†ï¼Ÿ ç³»ç»Ÿè®¾è®¡è€…çš„å›°å¢ƒåœ¨äºï¼Œæ˜¯æ„å»ºä¸€ä¸ªåŸºäºè¯»å†™æ“ä½œçš„æ›´å¤æ‚åè®®ï¼Œè¿˜æ˜¯æ„å»ºä¸€ä¸ªä½¿ç”¨æ¶ˆæ¯ä¼ é€’çš„æ›´ç®€å•åè®®ï¼Ÿæ¢å¥è¯è¯´ï¼Œæ˜¯æ‰§è¡Œä¸¤æ¬¡ï¼ˆæˆ–æ›´å¤šæ¬¡ï¼‰å•è¾¹ RDMA æ“ä½œæ›´å¿«ï¼Œè¿˜æ˜¯æ‰§è¡Œä¸€æ¬¡ RPC æ›´å¿«ï¼Ÿåœ¨ RDMA çš„æ—©æœŸï¼Œé€‰æ‹©æ˜¯æ˜ç¡®çš„ï¼šRDMA æ“ä½œæ¯” RPC å¿«å¤§çº¦ 20 å€ [31]ã€‚ æœ¬æ–‡çš„ tradeoff åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ pilaf æ˜¯å•è¾¹ one-sided: å¤šæ¬¡ rtï¼ŒåŸºäºè¯»å†™æ“ä½œçš„æ›´å¤æ‚åè®® two (or more) one-sided RDMA operations: æ¶ˆæ¯ä¼ é€’æ›´ç®€å•åè®®ï¼Œä¼ ç»Ÿ kvï¼Œä¸€æ¬¡ rtï¼Œéœ€è¦ cpuï¼Œ single RPCï¼šRDMA æ¯” rpc å¿« 20 å€ éšç€åç»­å·¥ä½œæ˜¾è‘—é™ä½äº†åŒè¾¹ RPC çš„æˆæœ¬ [16, 19]ï¼Œå¹¶ä¸” RDMA åœ¨æ›´å¤§è§„æ¨¡ã€æ›´é«˜å»¶è¿Ÿçš„ç¯å¢ƒä¸­éƒ¨ç½² [12, 13]ï¼Œé€‰æ‹©ä½¿ç”¨å“ªç§æ“ä½œå˜å¾—æ›´åŠ å¤æ‚ã€‚ æˆ‘ä»¬åœ¨ä¸¤å°é€šè¿‡ 40 Gb ä»¥å¤ªç½‘è¿æ¥çš„æœåŠ¡å™¨ä¸Šæµ‹é‡äº†å•è¾¹ RDMA æ“ä½œä¸ä½¿ç”¨ eRPC [16]å®ç°çš„åŒè¾¹ RPC çš„æ€§èƒ½ è¿™è®ºæ–‡æ„Ÿè§‰å¾ˆå¤šæ¦‚å¿µå†™å¾—ä¸å¤ªæ¸…æ¥šï¼Œå¤šæ¬¡ rt è‚¯å®šç®€å•å§ï¼Œæ—©æœŸçš„åšæ³•ä¹Ÿæ˜¯å¤šæ¬¡ rtï¼Ÿ ","date":"2024-09-22","objectID":"/posts/paper-prism/:4:1","tags":["Paper Reading"],"title":"Paper Reading: Rethinking the RDMA Interface for Distributed Systems","uri":"/posts/paper-prism/"},{"categories":null,"content":"Principles for Post-RDMA Systems å¤§å¤šæ•°å…³äº RDMA ç³»ç»Ÿçš„å·¥ä½œå‡è®¾æˆ‘ä»¬ä»…é™äºå½“å‰çš„ RDMA è¯»/å†™æ¥å£ã€‚å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿæ‰©å±• RDMA æ¥å£å‘¢ï¼Ÿç¡¬ä»¶ä¾›åº”å•† [29] å’Œè½¯ä»¶å®ç° [26] å·²ç»ä»¥ä¸´æ—¶æ–¹å¼æ·»åŠ äº†å„ç§æ–°æ“ä½œ Navigating data structures: RDMA æ”¯æŒåœ¨å·²çŸ¥å¤§å°å’Œä½ç½®çš„æƒ…å†µä¸‹è¿›è¡Œè¿œç¨‹è¯»å–ã€‚å¤§å¤šæ•°åº”ç”¨ç¨‹åºï¼Œå¦‚ Pilafï¼Œä½¿ç”¨æ›´å¤æ‚çš„æ•°æ®ç»“æ„æ¥æ„å»ºç´¢å¼•ã€å­˜å‚¨å¯å˜é•¿åº¦çš„å¯¹è±¡ï¼Œå¹¶å¸®åŠ©å¤„ç†å¹¶å‘æ›´æ–°ã€‚éå†è¿™äº›ç»“æ„éœ€è¦å¤šæ¬¡ RDMA è¯»å–ã€‚èƒ½å¤Ÿå¯¹æŒ‡é’ˆæ‰§è¡Œé—´æ¥æ“ä½œå¯ä»¥æ¶ˆé™¤å…¶ä¸­ä¸€äº›å¾€è¿”ã€‚ å¦‚æœä¸çŸ¥é“ä½ç½®å’Œå¤§å°å‘¢ Supporting out-of-place writes: ä¿®æ”¹è¿œç¨‹æ•°æ®ç»“æ„å°¤å…¶å…·æœ‰æŒ‘æˆ˜æ€§ï¼Œå› ä¸ºè¯»å–å¯èƒ½åŒæ—¶å‘ç”Ÿã€‚ä¸ºäº†é¿å…éšä¹‹è€Œæ¥çš„ä¸€è‡´æ€§é—®é¢˜ï¼Œè®¸å¤šç³»ç»Ÿ [10, 31, 32] ä»…ä»æœåŠ¡å™¨ CPU æ‰§è¡Œå†™å…¥ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ„å»ºèƒ½å¤Ÿä½¿ç”¨ RDMA æ“ä½œå¤„ç†è¯»å–å’Œå†™å…¥çš„ç³»ç»Ÿã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬æå€¡ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œå…¶ä¸­æ–°æ•°æ®è¢«å¼‚åœ°å†™å…¥å•ç‹¬çš„ç¼“å†²åŒºï¼Œç„¶åæŒ‡é’ˆè¢«åŸå­æ›´æ–°ä»¥ä»æ—§å€¼åˆ‡æ¢åˆ°æ–°å€¼â€”â€”ä¸€ç§ç±»ä¼¼äºå¹¶å‘ç¼–ç¨‹ä¸­çš„è¯»-å¤åˆ¶-æ›´æ–° [27] çš„æ–¹æ³•ã€‚å®ç°è¿™ä¸€ç‚¹éœ€è¦æ–°çš„ RDMA æ”¯æŒï¼Œä»¥å°†æ•°æ®å†™å…¥æ–°ç¼“å†²åŒºï¼Œå¹¶åŸå­æ›´æ–°æŒ‡å‘å…¶ä½ç½®çš„æŒ‡é’ˆã€‚ RDMA KV æ˜¯å¦‚ä½•å¤„ç†çš„ï¼Ÿæœ¬æ–‡çœ‹ä¸Šå»ç”¨äº† RCU(Read-copy update) åº”è¯¥å¾ˆç±»ä¼¼ Copy On Write COWï¼Ÿ COW å­˜åœ¨çš„é—®é¢˜æ˜¯ä»€ä¹ˆæ—¶å€™å›æ”¶ï¼ŒRCU ä½¿ç”¨ RCU-sync + CoW æ¥è§£å†³ã€‚ https://aandds.com/blog/linux-rcu.html RCU çš„è¯»æ€§èƒ½æ¯”â€œè¯»å†™é”â€è¦å¥½ï¼Œå®ƒé€‚åº”æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ï¼Œè¯»å¤šå†™å°‘ï¼Œæ²¡æœ‰å¼ºä¸€è‡´è¦æ±‚ ã€‚ ä½† KV ä¸€èˆ¬ä¼šå­˜åœ¨å†™å¤šè¯»å°‘çš„æƒ…å†µï¼Ÿ Optimistic concurrency control: å¤æ‚æ•°æ®ç»“æ„çš„æ›´æ–°éœ€è¦åŒæ­¥ã€‚è™½ç„¶ä»Šå¤©å¯ä»¥ä½¿ç”¨ RDMA å®ç°é” [44, 45]ï¼Œä½†æ€§èƒ½æŸå¤±å¯èƒ½å¾ˆå¤§ã€‚æ‰©å±• RDMA çš„æ¯”è¾ƒ-äº¤æ¢åŠŸèƒ½å°†ä½¿æˆ‘ä»¬èƒ½å¤Ÿå®ç°å¤æ‚çš„ã€åŸºäºç‰ˆæœ¬çš„ä¹è§‚å¹¶å‘æ§åˆ¶ [21]ï¼Œè¿™ç§æ–¹æ³•ä¸æˆ‘ä»¬çš„å¼‚åœ°æ›´æ–°æ–¹æ³•éå¸¸å¥‘åˆã€‚ å¥½å¥‡ RDMA + é”çš„æ€§èƒ½ä¼šå·®å¤šå°‘ RCU è¿˜æœ‰ä¸ªå…³é”®ç‚¹åº”è¯¥æ˜¯é“¾è¡¨ + å†…å­˜å±éšœï¼Ÿ Linux å†…æ ¸ä¹Ÿæœ‰ RCUï¼Œè¿™èƒ½å¤ç”¨å— https://wangxu.me/translation/2008/06/01/what-is-rcu/index.html https://www.kernel.org/doc/html/next/RCU/whatisRCU.html è¿‡ä¸¤å¤©å­¦ä¸€ä¸‹é¡ºä¾¿å†™ä¸€ä¸‹ Chaining operations: ä¸€ä¸ªå¸¸è§çš„ä¸»é¢˜æ˜¯åº”ç”¨ç¨‹åºéœ€è¦æ‰§è¡Œå¤åˆæ“ä½œï¼Œå…¶ä¸­ä¸€ä¸ªæ“ä½œçš„å‚æ•°ä¾èµ–äºå‰ä¸€ä¸ªæ“ä½œçš„ç»“æœâ€”â€”è¯»å–ä¸€ä¸ªæŒ‡é’ˆï¼Œç„¶åè¯»å–å®ƒæŒ‡å‘çš„å€¼ï¼Œæˆ–è€…å†™å…¥ä¸€ä¸ªå¯¹è±¡ï¼Œç„¶åäº¤æ¢æŒ‡é’ˆã€‚ä»Šå¤©ï¼Œè¿™éœ€è¦å°†ä¸­é—´ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯å¹¶æ‰§è¡Œæ–°æ“ä½œâ€”â€”ä»¥åŠå¦ä¸€ä¸ªç½‘ç»œå¾€è¿”ã€‚å¦‚æœæˆ‘ä»¬æœ‰ä¸€ç§æ–¹æ³•å¯ä»¥å°†æ“ä½œé“¾æ¥èµ·æ¥ï¼Œä½¿ä¸€ä¸ªæ“ä½œä¾èµ–äºå¦ä¸€ä¸ªæ“ä½œï¼Œä½†ä»ç„¶åœ¨ä¸€æ¬¡å¾€è¿”ä¸­æ‰§è¡Œå®ƒä»¬ï¼Œæˆ‘ä»¬å¯ä»¥é¿å…è¿™ç§å¼€é”€ã€‚ æ˜¯æ²¡å¤ªæ‡‚è¿™ç§ä½¿ç”¨åœºæ™¯ï¼Œæœ‰å…·ä½“ä¾‹å­å— ","date":"2024-09-22","objectID":"/posts/paper-prism/:4:2","tags":["Paper Reading"],"title":"Paper Reading: Rethinking the RDMA Interface for Distributed Systems","uri":"/posts/paper-prism/"},{"categories":null,"content":"The Case for an Extended Interface æ‰©å±• RDMA æ¥å£ å¦ä¸€ç§æ–¹æ³•æ˜¯ allow applications to provide their own code that runs on the remote hostï¼Œå³å°†è‡ªå®šä¹‰åº”ç”¨ç¨‹åºé€»è¾‘éƒ¨ç½²åˆ°æ™ºèƒ½ç½‘å¡ï¼ˆSmart NICsï¼‰ æˆ‘ä»¬ä¸»å¼ é‡‡ç”¨ä¸€ç»„ç®€å•ã€é€šç”¨çš„åŸè¯­ã€‚è¿™ç§ç®€å•çš„æ‰©å±•å¯èƒ½å¯¹æ›´å¤šçš„åº”ç”¨ç¨‹åºæœ‰ç”¨ï¼Œæ— è®ºæ˜¯å½“å‰çš„è¿˜æ˜¯æœªæ¥çš„ã€‚ç®€å•æ€§åœ¨è¿™é‡Œä¹Ÿæœ‰åŠ©äºå®ç°ï¼šæˆ‘ä»¬è®¤ä¸ºæˆ‘ä»¬æå‡ºçš„åŸè¯­å¯ä»¥æ·»åŠ åˆ°åŸºäºè½¯ä»¶çš„ç½‘ç»œå †æ ˆã€å¯é‡é…ç½®çš„æ™ºèƒ½ç½‘å¡ï¼Œç”šè‡³æ˜¯æœªæ¥çš„å›ºå®šåŠŸèƒ½ç½‘å¡ä¸­ã€‚æœ¬æ–‡çš„å…¶ä½™éƒ¨åˆ†æå‡ºäº†è¿™äº›é€šç”¨æ‰©å±•ï¼Œå¹¶å±•ç¤ºäº†å®ƒä»¬å¯¹äºå¸¸è§åº”ç”¨ç¨‹åºçš„å®ç”¨æ€§ã€‚ è¿˜æ˜¯æœ‰æ„æ€çš„ï¼Œå¯ä»¥ç”¨åœ¨è‡ªå®šä¹‰ç½‘ç»œæ ˆæˆ–è€… NIC ","date":"2024-09-22","objectID":"/posts/paper-prism/:4:3","tags":["Paper Reading"],"title":"Paper Reading: Rethinking the RDMA Interface for Distributed Systems","uri":"/posts/paper-prism/"},{"categories":null,"content":"PRISM Interface ä¸ºäº†è§£å†³ä½¿ç”¨ RDMA æ„å»ºåˆ†å¸ƒå¼ç³»ç»Ÿæ‰€å›ºæœ‰çš„æŒ‘æˆ˜ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ç§æ‰©å±•çš„ç½‘ç»œæ¥å£ï¼Œç§°ä¸º PRISMï¼ˆç”¨äºç³»ç»Ÿå†…å­˜è¿œç¨‹äº¤äº’çš„åŸè¯­ï¼‰ã€‚PRISM åœ¨ç°æœ‰çš„ RDMA æ¥å£ä¸­å¢åŠ äº†å››ä¸ªé¢å¤–çš„åŠŸèƒ½ã€‚è¿™äº›åŠŸèƒ½æ—¨åœ¨æ”¯æŒæˆ‘ä»¬åœ¨å®ç°åˆ†å¸ƒå¼åè®®æ—¶è§‚å¯Ÿåˆ°çš„å¸¸è§æ¨¡å¼ã€‚PRISM çš„æ¥å£è®¾è®¡åŸºäºä¸‰ä¸ªåŸåˆ™ï¼šï¼ˆ1ï¼‰é€šç”¨æ€§â€”â€”å®ƒä»¬ä¸åº”ç¼–ç ç‰¹å®šäºåº”ç”¨ç¨‹åºçš„åŠŸèƒ½ï¼›ï¼ˆ2ï¼‰æœ€å°æ¥å£å¤æ‚æ€§ï¼›ï¼ˆ3ï¼‰æœ€å°å®ç°å¤æ‚æ€§ï¼Œè¿™ä½¿å¾—æ€§èƒ½å¿«é€Ÿä¸”å¯é¢„æµ‹ï¼Œå¹¶ä¾¿äºåœ¨å„ç§å¹³å°ä¸Šå®ç°ï¼ŒåŒ…æ‹¬æœªæ¥çš„ NIC ASICã€‚ ","date":"2024-09-22","objectID":"/posts/paper-prism/:5:0","tags":["Paper Reading"],"title":"Paper Reading: Rethinking the RDMA Interface for Distributed Systems","uri":"/posts/paper-prism/"},{"categories":null,"content":"Indirect Operations è®¸å¤š RDMA åº”ç”¨ç¨‹åºéœ€è¦éå†è¿œç¨‹æ•°æ®ç»“æ„ã€‚è¿™äº›ç»“æ„ä½¿ç”¨é—´æ¥å¯»å€æ¥å®ç°è®¸å¤šç›®çš„ï¼šæä¾›ç´¢å¼•ã€æ”¯æŒå¯å˜é•¿åº¦æ•°æ®ç­‰ã€‚ç›®å‰ï¼Œè·ŸéšæŒ‡é’ˆéœ€è¦é¢å¤–çš„å¾€è¿”ã€‚ PRISM å…è®¸ READã€WRITE å’Œæ¯”è¾ƒ-äº¤æ¢ï¼ˆCASï¼‰æ“ä½œæ¥å—é—´æ¥å‚æ•°ã€‚è¿™äº›æ“ä½œçš„ç›®æ ‡åœ°å€å¯ä»¥è§£é‡Šä¸ºæŒ‡å‘å®é™…ç›®æ ‡çš„æŒ‡é’ˆåœ°å€ã€‚æ­¤å¤–ï¼ŒWRITE æˆ– CAS æ“ä½œçš„æ•°æ®å¯ä»¥ä»æœåŠ¡å™¨ç«¯å†…å­˜ä½ç½®è¯»å–ï¼Œè€Œä¸æ˜¯ä» RDMA è¯·æ±‚æœ¬èº«è¯»å–ã€‚ å¯¹äº READ å’Œ WRITE æ“ä½œï¼Œç›®æ ‡åœ°å€å¯ä»¥é€‰æ‹©æ€§åœ°è§£é‡Šä¸ºâŸ¨ptr, boundâŸ©ç»“æ„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ“ä½œé•¿åº¦é™åˆ¶ä¸º bound æˆ–å®¢æˆ·ç«¯è¯·æ±‚é•¿åº¦ä¸­è¾ƒå°çš„ä¸€ä¸ªã€‚è¿™æ”¯æŒå¯å˜é•¿åº¦å¯¹è±¡ï¼šå®¢æˆ·ç«¯å¯ä»¥æ‰§è¡Œå…·æœ‰è¾ƒå¤§é•¿åº¦çš„è¯»å–ï¼Œä½†åªæ¥æ”¶å®é™…å­˜å‚¨çš„æ•°æ®é‡ã€‚ PRISM ä¸­çš„é—´æ¥æ“ä½œé‡ç”¨äº†ç°æœ‰çš„ RDMA å®‰å…¨æœºåˆ¶ï¼Œç¡®ä¿è¿œç¨‹å®¢æˆ·ç«¯åªèƒ½æ“ä½œä¸»æœºå†…å­˜ä¸­å·²è¢«æˆäºˆè®¿é—®æƒé™çš„åŒºåŸŸã€‚è¦ä½¿ç”¨é—´æ¥æ“ä½œè®¿é—®å†…å­˜åŒºåŸŸï¼Œå®¢æˆ·ç«¯å¿…é¡»åŒ…å«ä¸»æœºåœ¨é¦–æ¬¡å‘ NIC æ³¨å†ŒåŒºåŸŸæ—¶ç”Ÿæˆçš„ rkeyã€‚å¦‚æœç›®æ ‡åœ°å€æˆ–ç›®æ ‡åœ°å€æŒ‡å‘çš„ä½ç½®ä½äºå…·æœ‰ä¸åŒ rkeyï¼ˆæˆ–æœªæ³¨å†Œï¼‰çš„å†…å­˜åŒºåŸŸä¸­ï¼Œåˆ™ä¸»æœºå°†æ‹’ç»è¯¥æ“ä½œã€‚ åº”è¯¥å’Œ RDMA å‡ ä¹ä¸€æ ·ï¼Œå¤šäº†é—´æ¥å‚æ•°ï¼Œæ¯”è¾ƒ-äº¤æ¢ï¼ˆCASï¼‰å¯èƒ½æ˜¯æ–°çš„ï¼Ÿä¸ºä»€ä¹ˆå¯ä»¥ä»æœåŠ¡å™¨ç«¯å†…å­˜è¯»å–æ˜¯ä»€ä¹ˆã€‚ ","date":"2024-09-22","objectID":"/posts/paper-prism/:5:1","tags":["Paper Reading"],"title":"Paper Reading: Rethinking the RDMA Interface for Distributed Systems","uri":"/posts/paper-prism/"},{"categories":null,"content":"Memory Allocation ä½¿ç”¨ç°æœ‰çš„ RDMA æ¥å£ä¿®æ”¹æ•°æ®ç»“æ„å°¤å…¶å…·æœ‰æŒ‘æˆ˜æ€§ï¼šå¯¹è±¡å¿…é¡»å†™å…¥å›ºå®šçš„é¢„åˆ†é…å†…å­˜åŒºåŸŸï¼Œè¿™ä½¿å¾—å¤„ç†å¯å˜å¤§å°çš„å¯¹è±¡æˆ–å¼‚åœ°æ›´æ–°å˜å¾—å›°éš¾ã€‚éœ€è¦çš„æ˜¯ä¸€ç§å†…å­˜åˆ†é…åŸè¯­ã€‚PRISM æä¾›äº†ä¸€ç§å†…å­˜åˆ†é…åŸè¯­ï¼Œå®ƒåˆ†é…ä¸€ä¸ªç¼“å†²åŒºå¹¶è¿”å›æŒ‡å‘å…¶ä½ç½®çš„æŒ‡é’ˆã€‚ RDMA éƒ½è¦æ³¨å†Œå†…å­˜åŒºåŸŸå§ï¼Œibv_reg_mr è·å¾— rkeyï¼ŒPRISM åˆ°åº•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œå®¢æˆ·ç«¯å¯ä»¥é€šè¿‡ä¸€æ¬¡é—´æ¥è¯»å–æ“ä½œè·å–é“¾è¡¨ä¸­çš„å¤šä¸ªèŠ‚ç‚¹ï¼Œè€Œä¸éœ€è¦å¤šæ¬¡å¾€è¿”ï¼Ÿ RDMA è¯»å–é“¾è¡¨ï¼Œä¼ ç»Ÿéœ€è¦å¤šæ¬¡å¾€è¿”ï¼ŒREAD è¯»å–å’Œä¸‹ä¸€ä¸ªæŒ‡é’ˆï¼Œç„¶åé‡å¤ï¼Ÿ PRISM å¯ä»¥è¯»å¤šä¸ªï¼Ÿä¸ºä»€ä¹ˆå•Š è¦ä½¿ç”¨ PRISM çš„åˆ†é…åŸè¯­ï¼ŒæœåŠ¡å™¨ç«¯è¿›ç¨‹å°†ç¼“å†²åŒºé˜Ÿåˆ—ï¼ˆåœ¨ RDMA æœ¯è¯­ä¸­ç§°ä¸ºâ€œå‘å¸ƒâ€ï¼‰æ³¨å†Œåˆ° NICã€‚å½“ NIC ä»è¿œç¨‹ä¸»æœºæ¥æ”¶åˆ° ALLOCATE è¯·æ±‚æ—¶ï¼Œå®ƒä»ç©ºé—²åˆ—è¡¨ä¸­å¼¹å‡ºä¸€ä¸ªç¼“å†²åŒºï¼Œå°†æä¾›çš„æ•°æ®å†™å…¥ç¼“å†²åŒºï¼Œå¹¶è¿”å›åœ°å€ã€‚è¿™ç§æ“ä½œåœ¨ä¸ PRISM çš„è¯·æ±‚é“¾æ¥æœºåˆ¶ç»“åˆä½¿ç”¨æ—¶ç‰¹åˆ«å¼ºå¤§ï¼Œå¦‚ä¸‹æ‰€è¿°ï¼šPRISM å®¢æˆ·ç«¯å¯ä»¥åˆ†é…ä¸€ä¸ªç¼“å†²åŒºï¼Œå†™å…¥å…¶ä¸­ï¼Œç„¶åé€šè¿‡ CAS å°†å…¶æŒ‡é’ˆå®‰è£…åˆ°å¦ä¸€ä¸ªæ•°æ®ç»“æ„ä¸­ã€‚ PRISM åœ¨ NICï¼ˆæˆ–è½¯ä»¶ç½‘ç»œå †æ ˆï¼‰æ•°æ®å¹³é¢æ‰§è¡Œå†…å­˜åˆ†é…ã€‚ç„¶è€Œï¼Œå†…å­˜æ³¨å†Œç”±æœåŠ¡å™¨ CPU å®Œæˆã€‚è¿™æ˜¯å¿…è¦çš„ï¼Œå› ä¸ºæ³¨å†Œå†…å­˜éœ€è¦ä¸å†…æ ¸äº¤äº’ä»¥è¯†åˆ«ç›¸åº”çš„ç‰©ç†åœ°å€å¹¶å›ºå®šç¼“å†²åŒºã€‚ç”±äºæœåŠ¡å™¨ CPU å‚ä¸å…¶ä¸­ï¼Œå› æ­¤å¯¹äºåº”ç”¨ç¨‹åºé‡ç”¨è¿™äº›ç¼“å†²åŒºçš„æ­£ç¡®æ€§è‡³å…³é‡è¦ï¼Œåªæœ‰åœ¨å¹¶å‘ NIC æ“ä½œå®Œæˆåï¼Œå›æ”¶çš„ç¼“å†²åŒºæ‰èƒ½æ·»åŠ å›ç©ºé—²åˆ—è¡¨ã€‚è™½ç„¶è¿™ç®€å•åœ°å°† NIC å’ŒæœåŠ¡å™¨ CPU åŒæ­¥çš„è´Ÿæ‹…è½¬ç§»åˆ°åŸè¯­çš„å®ç°ä¸Šï¼Œä½†å®ƒé‡è¦çš„æ˜¯å°†è¿™ç§åŒæ­¥ä»åº”ç”¨ç¨‹åºçš„å¸¸è§„è·¯å¾„ä¸­ç§»é™¤ã€‚ ç®¡ç†å®¢æˆ·ç«¯åˆ†é…çš„å†…å­˜å¯èƒ½å…·æœ‰æŒ‘æˆ˜æ€§ï¼›è¿™æ˜¯é€šè¿‡è¿œç¨‹è®¿é—®ä¿®æ”¹çŠ¶æ€çš„åº”ç”¨ç¨‹åºæ‰€é¢ä¸´çš„æ ¹æœ¬æŒ‘æˆ˜ã€‚å…·ä½“çš„å†…å­˜ç®¡ç†ç­–ç•¥ç”±åº”ç”¨ç¨‹åºè‡ªè¡Œå†³å®šã€‚æœ¬æ–‡ä¸­çš„åº”ç”¨ç¨‹åºä½¿ç”¨å®¢æˆ·ç«¯æ£€æµ‹å¯¹è±¡ä½•æ—¶ä¸å†ä½¿ç”¨ï¼Œä¾‹å¦‚ï¼Œå½“å…ˆå‰ç‰ˆæœ¬å·²è¢«æ›¿æ¢æ—¶ã€‚å®ƒä»¬å°†æœªä½¿ç”¨çš„ç¼“å†²åŒºæŠ¥å‘Šç»™åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œçš„å®ˆæŠ¤è¿›ç¨‹ï¼ˆé€šè¿‡ä¼ ç»Ÿçš„ RPCï¼‰ï¼Œè¯¥å®ˆæŠ¤è¿›ç¨‹å°†å…¶é‡æ–°æ³¨å†Œåˆ° NIC çš„ç©ºé—²åˆ—è¡¨ä¸­ï¼›å¯ä»¥åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ä½¿ç”¨æ‰¹å¤„ç†æ¥æœ€å°åŒ–å¼€é”€ã€‚å¦ä¸€ç§å—åƒåœ¾æ”¶é›†å¯å‘çš„æ–¹æ³•æ˜¯æœåŠ¡å™¨ç«¯åº”ç”¨ç¨‹åºä»£ç å®šæœŸæ‰«ææ•°æ®ç»“æ„ä»¥è¯†åˆ«å¯ä»¥å›æ”¶çš„ç¼“å†²åŒºã€‚ æˆ‘ä»¬çš„åˆ†é…å™¨è®¾è®¡æœ‰æ„ä¿æŒç®€å•ï¼Œä»…ä»ç‰¹å®šé˜Ÿåˆ—ä¸­åˆ†é…ç¬¬ä¸€ä¸ªå¯ç”¨çš„ç¼“å†²åŒºã€‚æˆ‘ä»¬é€‰æ‹©è¿™ç§è®¾è®¡è€Œä¸æ˜¯æ›´å¤æ‚çš„åˆ†é…å™¨ï¼Œå› ä¸ºï¼ˆå¦‚Â§4.2 æ‰€è¿°ï¼‰ç°æœ‰çš„ RDMA NIC å·²ç»å…·æœ‰å®ç°å®ƒæ‰€éœ€çš„ç¡¬ä»¶æ”¯æŒã€‚ä¸€ä¸ªç»“æœæ˜¯ï¼Œä½¿ç”¨æ•´ä¸ªé¢„åˆ†é…ç¼“å†²åŒºåˆ†é…å†…å­˜ä¼šå¼•å…¥ç©ºé—´å¼€é”€ã€‚åº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡æ³¨å†ŒåŒ…å«ä¸åŒå¤§å°ç¼“å†²åŒºçš„å¤šä¸ªé˜Ÿåˆ—å¹¶é€‰æ‹©é€‚å½“çš„é˜Ÿåˆ—æ¥æœ€å°åŒ–è¿™ç§å½±å“ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨å¤§å°ä¸º 2 çš„å¹‚çš„ç¼“å†²åŒºå¯ä»¥ä¿è¯æœ€å¤§ç©ºé—´å¼€é”€ä¸º 2 å€ã€‚çº¯è½¯ä»¶å®ç°å¯èƒ½ä¼šé€‰æ‹©ä½¿ç”¨æ›´å¤æ‚çš„åˆ†é…å™¨ã€‚ æ”¯æŒ variable-sized objects or out-of-place updates. pre register a queue of buffers ","date":"2024-09-22","objectID":"/posts/paper-prism/:5:2","tags":["Paper Reading"],"title":"Paper Reading: Rethinking the RDMA Interface for Distributed Systems","uri":"/posts/paper-prism/"},{"categories":null,"content":"Enhanced Compare-And-Swap åŸå­æ¯”è¾ƒ-äº¤æ¢ï¼ˆCASï¼‰æ˜¯å¹¶è¡Œç³»ç»Ÿä¸­æ›´æ–°æ•°æ®çš„ä¸€ä¸ªç»å…¸åŸè¯­ã€‚RDMA æ ‡å‡†å·²ç»æä¾›äº†ä¸€ä¸ªåŸå­ CAS æ“ä½œ [30]ï¼Œä½†å®ƒå—åˆ°é«˜åº¦é™åˆ¶ï¼šå®ƒè¿›è¡Œå•ä¸€çš„ç›¸ç­‰æ€§æ¯”è¾ƒï¼Œç„¶åäº¤æ¢ä¸€ä¸ª 64 ä½çš„å€¼ã€‚æ ¹æ®æˆ‘ä»¬çš„ç»éªŒï¼Œè¿™å¯¹äºå®ç°é«˜æ€§èƒ½åº”ç”¨ç¨‹åºï¼ˆåŒ…æ‹¬Â§6â€“8 ä¸­çš„é‚£äº›ï¼‰æ˜¯ä¸å¤Ÿçš„ã€‚äº‹å®ä¸Šï¼Œé™¤äº†å®ç°é” [33, 45] ä¹‹å¤–ï¼Œå¾ˆå°‘æœ‰åº”ç”¨ç¨‹åºä»Šå¤©ä½¿ç”¨ RDMA åŸå­æ“ä½œã€‚è™½ç„¶å¯ä»¥ä½¿ç”¨é”æ¥å®ç°ä»»æ„å¤æ‚çš„åŸå­æ“ä½œï¼Œä½†è¿™éœ€è¦å¤šæ¬¡æ˜‚è´µçš„å¾€è¿”å¹¶å¢åŠ äº‰ç”¨ã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬é€šè¿‡ä¸‰ç§æ–¹å¼æ‰©å±•äº† CAS åŸè¯­ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬é‡‡ç”¨äº† Mellanox RDMA è®¾å¤‡å½“å‰æä¾›çš„æ‰©å±•åŸå­æ¥å£ [30]ï¼Œè¯¥æ¥å£å…è®¸ CAS æ“ä½œæœ€å¤š 32 å­—èŠ‚ï¼Œå¹¶ä½¿ç”¨å•ç‹¬çš„ä½æ©ç æ¥æ¯”è¾ƒå’Œäº¤æ¢å‚æ•°ï¼Œä½¿å¾—å¯ä»¥æ¯”è¾ƒç»“æ„ä¸­çš„ä¸€ä¸ªå­—æ®µå¹¶äº¤æ¢å¦ä¸€ä¸ªå­—æ®µã€‚å…¶æ¬¡ï¼Œæˆ‘ä»¬ä¸ºç›®æ ‡åœ°å€æˆ–æ¯”è¾ƒå’Œäº¤æ¢å€¼å¼•å…¥äº†é—´æ¥å¯»å€ï¼ˆÂ§3.1ï¼‰ã€‚æˆ‘ä»¬ä¸ä¿è¯é—´æ¥å‚æ•°æŒ‡é’ˆçš„è§£å¼•ç”¨æ˜¯åŸå­çš„â€”â€”åªæœ‰ CAS æœ¬èº«æ˜¯åŸå­çš„â€”â€”ä½†è¿™å…è®¸æˆ‘ä»¬ä»å†…å­˜ä¸­åŠ è½½å‚æ•°å€¼ã€‚æœ€åï¼Œæˆ‘ä»¬åœ¨æ¯”è¾ƒé˜¶æ®µæä¾›äº†å¯¹ç®—æœ¯æ¯”è¾ƒæ“ä½œç¬¦ï¼ˆå¤§äº/å°äºï¼‰çš„æ”¯æŒï¼Œé™¤äº†æŒ‰ä½ç›¸ç­‰æ€§ä¹‹å¤–ã€‚è¿™æ”¯æŒäº†æ›´æ–°ç‰ˆæœ¬åŒ–å¯¹è±¡çš„å¸¸è§æ¨¡å¼ï¼šæ£€æŸ¥æ–°ç‰ˆæœ¬æ˜¯å¦å¤§äºç°æœ‰ç‰ˆæœ¬ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™æ›´æ–°ç‰ˆæœ¬å·å’Œå¯¹è±¡ã€‚ PRISM çš„ CAS æ“ä½œç›¸å¯¹äºå…¶ä»– PRISM æ“ä½œæ˜¯åŸå­çš„ã€‚ä¸ç°æœ‰çš„ RDMA åŸå­æ“ä½œä¸€æ ·ï¼Œå®ƒä»¬ä¸ä¿è¯ä¸å¹¶å‘ CPU æ“ä½œçš„åŸå­æ€§ã€‚ ","date":"2024-09-22","objectID":"/posts/paper-prism/:5:3","tags":["Paper Reading"],"title":"Paper Reading: Rethinking the RDMA Interface for Distributed Systems","uri":"/posts/paper-prism/"},{"categories":null,"content":"Operation Chaining åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºé€šå¸¸éœ€è¦æ‰§è¡Œä¸€ç³»åˆ—æ•°æ®ä¾èµ–çš„æ“ä½œæ¥è¯»å–æˆ–æ›´æ–°è¿œç¨‹æ•°æ®ç»“æ„ã€‚ä¾‹å¦‚ï¼Œå®ƒä»¬å¯èƒ½å¸Œæœ›åˆ†é…ä¸€ä¸ªç¼“å†²åŒºï¼Œå†™å…¥å…¶ä¸­ï¼Œç„¶åæ›´æ–°ä¸€ä¸ªæŒ‡é’ˆä»¥æŒ‡å‘å®ƒã€‚ç›®å‰ï¼Œæ¯ä¸ªæ“ä½œå¿…é¡»è¿”å›åˆ°å®¢æˆ·ç«¯ï¼Œç„¶åæ‰èƒ½å‘å‡ºä¸‹ä¸€ä¸ªæ“ä½œã€‚PRISM æä¾›äº†ä¸€ç§é“¾æ¥æœºåˆ¶ï¼Œå…è®¸åƒè¿™æ ·çš„å¤åˆæ“ä½œåœ¨ä¸€æ¬¡å¾€è¿”ä¸­æ‰§è¡Œã€‚ Conditional operations: RDMA é€šå¸¸ä¸ä¿è¯æ“ä½œæŒ‰é¡ºåºæ‰§è¡Œã€‚æˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ªæ¡ä»¶æ ‡å¿—ï¼Œå»¶è¿Ÿæ‰§è¡Œæ“ä½œï¼Œç›´åˆ°æ¥è‡ªåŒä¸€å®¢æˆ·ç«¯çš„å‰ä¸€ä¸ªæ“ä½œå®Œæˆï¼Œå¹¶ä¸”ä»…åœ¨å‰ä¸€ä¸ªæ“ä½œæˆåŠŸæ—¶æ‰æ‰§è¡Œã€‚æ¯”è¾ƒå¤±è´¥çš„ CAS æ“ä½œåœ¨è¿™é‡Œè¢«è§†ä¸ºä¸æˆåŠŸã€‚ Output redirection: æˆ‘ä»¬å¼•å…¥äº†å¦ä¸€ä¸ªæ ‡å¿—ï¼ŒæŒ‡å®šæ“ä½œçš„è¾“å‡ºï¼ˆREAD æˆ– ALLOCATEï¼‰åº”å†™å…¥æŒ‡å®šçš„å†…å­˜ä½ç½®ï¼Œè€Œä¸æ˜¯å‘é€ç»™å®¢æˆ·ç«¯ã€‚è¯¥å†…å­˜ä½ç½®é€šå¸¸æ˜¯æ¯ä¸ªè¿æ¥çš„ä¸´æ—¶ç¼“å†²åŒºã€‚ä¾‹å¦‚ï¼Œå¯ä»¥æ‰§è¡Œ ALLOCATEï¼Œå°†å…¶è¾“å‡ºé‡å®šå‘åˆ°ä¸´æ—¶ä½ç½®ï¼Œç„¶åä½¿ç”¨æ¡ä»¶ WRITE å°†æŒ‡å‘æ–°åˆ†é…ç¼“å†²åŒºçš„æŒ‡é’ˆå­˜å‚¨åœ¨å…¶ä»–åœ°æ–¹ã€‚ kv ç¡®å®å­˜åœ¨å…ˆè¯»åå†™çš„æ“ä½œï¼Œè¿™ä¸ªæ¡ä»¶æ ‡å¿—æ˜¯ä»€ä¹ˆï¼Œper-connection temporary buffer ","date":"2024-09-22","objectID":"/posts/paper-prism/:5:4","tags":["Paper Reading"],"title":"Paper Reading: Rethinking the RDMA Interface for Distributed Systems","uri":"/posts/paper-prism/"},{"categories":null,"content":"Discussions PRISM åŸè¯­å…±åŒå®ç°äº†Â§2.2 å’ŒÂ§2.3 ä¸­çš„ç›®æ ‡ã€‚é—´æ¥æ“ä½œå‡å°‘äº†å¯¼èˆªæ•°æ®ç»“æ„æ‰€éœ€çš„å¾€è¿”æ¬¡æ•°ã€‚ALLOCATE å’Œå¢å¼ºçš„ CAS åŸè¯­ï¼Œç»“åˆé“¾æ¥ï¼Œæ”¯æŒå¼‚åœ°æ›´æ–°ï¼šåº”ç”¨ç¨‹åºå¯ä»¥åœ¨ä¸€æ¬¡å¾€è¿”ä¸­ ALLOCATE ä¸€ä¸ªæ–°ç¼“å†²åŒºï¼Œå°†æ•°æ®å†™å…¥å…¶ä¸­ï¼Œå¹¶ä½¿ç”¨ CAS å°†æŒ‡å‘å®ƒçš„æŒ‡é’ˆå®‰è£…åˆ°å¦ä¸€ä¸ªç»“æ„ä¸­ã€‚æœ€åï¼ŒCAS æ“ä½œçš„çµæ´»æ€§ä½¿å¾—å®ç°åŸºäºç‰ˆæœ¬çš„å¹¶å‘æ§åˆ¶æœºåˆ¶æˆä¸ºå¯èƒ½ã€‚ ","date":"2024-09-22","objectID":"/posts/paper-prism/:5:5","tags":["Paper Reading"],"title":"Paper Reading: Rethinking the RDMA Interface for Distributed Systems","uri":"/posts/paper-prism/"},{"categories":null,"content":"PRISM Implementation PRISM çš„ API ç”±ç®€å•çš„åŸè¯­ç»„æˆï¼Œä»¥ä¾¿å®ƒä»¬å¯ä»¥è½»æ¾åœ°æ·»åŠ åˆ°å„ç§ RDMA å®ç°ä¸­ã€‚ä¸ºäº†è¯„ä¼°å®ƒä»¬åœ¨æ„å»ºåˆ†å¸ƒå¼åº”ç”¨ç¨‹åºä¸­çš„æœ‰æ•ˆæ€§ï¼Œæˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªåŸºäºè½¯ä»¶çš„å®ç°ï¼ˆÂ§4.1ï¼‰ã€‚æˆ‘ä»¬è¿˜åˆ†æäº†åœ¨ NIC ä¸­å®ç° PRISM çš„å¯è¡Œæ€§ï¼ˆÂ§4.2ï¼‰ã€‚æˆ‘ä»¬è¯„ä¼°äº†è½¯ä»¶å®ç°çš„æ€§èƒ½å’Œç¡¬ä»¶å®ç°çš„é¢„æœŸæ”¶ç›Šï¼Œä»¥åŠæ™ºèƒ½ NIC æ–¹æ³•ï¼ˆÂ§4.3ï¼‰ã€‚ ","date":"2024-09-22","objectID":"/posts/paper-prism/:6:0","tags":["Paper Reading"],"title":"Paper Reading: Rethinking the RDMA Interface for Distributed Systems","uri":"/posts/paper-prism/"},{"categories":null,"content":"Software PRISM Implementation å— Google çš„ Snap [26]å¯å‘çš„è½¯ä»¶å®ç° å°½ç®¡è½¯ä»¶å®ç°ä½¿ç”¨æœåŠ¡å™¨ç«¯ CPUï¼Œä½†åœ¨ç½‘ç»œå †æ ˆä¸­æ‰§è¡Œçš„å•è¾¹æ“ä½œé€šè¿‡é¿å…ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œåº”ç”¨ç¨‹åºçº§çº¿ç¨‹è°ƒåº¦çš„æˆæœ¬æä¾›äº†æ€§èƒ½ä¼˜åŠ¿ã€‚ Snap å·²ç»æ”¯æŒï¼ˆå¹¶ä¸”å…¶åº”ç”¨ç¨‹åºä½¿ç”¨ï¼‰é—´æ¥è¯»å–ã€‚ è¿™ç¯‡è®ºæ–‡çœ‹å¾—æœ‰ç‚¹éš¾å—ï¼Œè®²è§£ä¸æ¸…æ¥šï¼Œå‰åä¹Ÿä¸ä¸€è‡´ï¼Œç¨å¾®çœ‹äº†ä¸‹æ€§èƒ½ä¹Ÿä¸æ˜¯æé«˜å¾ˆå¤šï¼Œä½†æ˜¯å¯¹ RDMA åšåˆ†å¸ƒå¼äº‹åŠ¡æˆ–å­˜å‚¨åº”è¯¥æ˜¯æœ‰è›®å¤šè´¡çŒ®çš„ åŸåˆ™ä¸Šï¼Œè½¯ä»¶å®ç°ä¹Ÿå¯ä»¥ç”¨äºæ™ºèƒ½ NICï¼›æˆ‘ä»¬å·²ç»åœ¨ Mellanox BlueField ä¸Šè¿›è¡Œäº†å®éªŒã€‚ç„¶è€Œï¼Œå¦‚ä¸‹æ‰€è¿°ï¼ˆÂ§4.3ï¼‰ï¼Œè¿™ç§æ–¹æ³•çš„æ€§èƒ½ä½äºè½¯ä»¶å®ç°ï¼Œå› æ­¤æˆ‘ä»¬ä¸ä¸»å¼ é™¤éå‡å°‘ CPU åˆ©ç”¨ç‡æ˜¯ä¸»è¦ç›®æ ‡ï¼Œå¦åˆ™ä¸ä½¿ç”¨å®ƒã€‚ ä¸ºä»€ä¹ˆå‘¢ï¼Œä¸€èˆ¬æ¥è¯´ offload åˆ° NIC ä¸Šåº”è¯¥æ€§èƒ½æå‡ä¼šæ›´é«˜å§ ","date":"2024-09-22","objectID":"/posts/paper-prism/:6:1","tags":["Paper Reading"],"title":"Paper Reading: Rethinking the RDMA Interface for Distributed Systems","uri":"/posts/paper-prism/"},{"categories":null,"content":"Hardware NIC Feasibility PRISM çš„è®¾è®¡æ—¨åœ¨å¯å®ç°äºæœªæ¥çš„ RDMA NIC ä¸­ã€‚è¿™éƒ¨åˆ†åˆ†æå¿…ç„¶æ˜¯æ¨æµ‹æ€§çš„ï¼Œå› ä¸ºæ”¯æŒ RDMA çš„ NIC ASIC æ˜¯ä¸“æœ‰è®¾è®¡ï¼Œæˆ‘ä»¬æ²¡æœ‰èƒ½åŠ›è¿›è¡Œæ‰©å±•ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬è®¤ä¸ºå®ç° PRISM åŸè¯­æ˜¯å¯è¡Œçš„ï¼Œå› ä¸ºå®ƒä»¬é‡ç”¨äº†å½“ä»Š NIC ä¸Šå·²ç»å­˜åœ¨çš„åº•å±‚æœºåˆ¶ã€‚ è®¨è®ºäº† NIC æ€ä¹ˆåšï¼Œä½†æ˜¯çœ‹æ ·å­æ²¡å®ç°ï¼Œè€Œä¸”åŸºæœ¬éƒ½æ˜¯çŒœæµ‹å¯è¡Œæ€§ ","date":"2024-09-22","objectID":"/posts/paper-prism/:6:2","tags":["Paper Reading"],"title":"Paper Reading: Rethinking the RDMA Interface for Distributed Systems","uri":"/posts/paper-prism/"},{"categories":null,"content":"Performance Analysis PRISM çš„æ€§èƒ½ä¸ä»…å–å†³äºæ‰§è¡Œæˆæœ¬ï¼Œè¿˜å–å†³äºç½‘ç»œå»¶è¿Ÿï¼Œå› ä¸ºå…¶æ€§èƒ½ä¼˜åŠ¿æ¥è‡ªäºæ¶ˆé™¤ä¸ RDMA ç›¸æ¯”çš„ç½‘ç»œå¾€è¿”ã€‚å›¾ 1 é€šè¿‡ä½¿ç”¨ç›´æ¥ç½‘ç»œé“¾æ¥ï¼Œè€ƒè™‘äº† PRISM çš„æœ€åæƒ…å†µã€‚å›¾ 2 é€šè¿‡æ¯”è¾ƒ PRISM çš„é—´æ¥è¯»å–ä¸æ‰§è¡Œä¸¤æ¬¡ RDMA è¯»å–çš„æˆæœ¬ï¼Œè¯„ä¼°äº†ç½‘ç»œå»¶è¿Ÿçš„å½±å“ã€‚æˆ‘ä»¬è€ƒè™‘äº†å•æœºæ¶éƒ¨ç½²ï¼ˆä¸€ä¸ªäº¤æ¢æœºï¼‰ã€å…·æœ‰ä¸‰çº§äº¤æ¢æœºå±‚æ¬¡ç»“æ„çš„é›†ç¾¤ï¼Œä»¥åŠæ¥è‡ªå®é™…æ•°æ®ä¸­å¿ƒ [12] çš„å»¶è¿Ÿæ•°æ®ï¼Œè¿™äº›æ•°æ®ä¹Ÿåæ˜ äº†ç½‘ç»œæ‹¥å¡ã€‚åœ¨æ¯ç§æƒ…å†µä¸‹ï¼Œå°½ç®¡ä½¿ç”¨ CPU å¢åŠ äº†é¢å¤–æˆæœ¬ï¼ŒPRISM çš„è½¯ä»¶å®ç°ä»ç„¶ä¼˜äº RDMA åŸºå‡†ã€‚ å‡å°‘ round trip åº”è¯¥èƒ½å¤§å¹…å¢åŠ ååå§ï¼Œåº”è¯¥æµ‹ååè¦æ¯”å»¶è¿Ÿæ¥çš„æ›´æ˜æ˜¾ï¼Ÿ ä½†æ˜¯è®ºæ–‡çš„æµ‹è¯•åŸºæœ¬éƒ½æ˜¯å»¶è¿Ÿï¼Œè€Œä¸” RDMA ä¸çŸ¥é“ä¸ºä»€ä¹ˆæ˜æ˜¾é«˜å¾ˆå¤š åŸºæœ¬éƒ½æ˜¯ 10+us è€Œ ","date":"2024-09-22","objectID":"/posts/paper-prism/:6:3","tags":["Paper Reading"],"title":"Paper Reading: Rethinking the RDMA Interface for Distributed Systems","uri":"/posts/paper-prism/"},{"categories":null,"content":"Applications Overview ä¸ºäº†å±•ç¤º PRISM çš„æ½œåœ¨ä¼˜åŠ¿ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸‰ä¸ªä»£è¡¨æ€§åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºçš„æ¡ˆä¾‹ç ”ç©¶ï¼š PRISM-KVï¼šä¸€ä¸ªå®ç° RDMA è¯»å†™æ“ä½œçš„é”®å€¼å­˜å‚¨ç³»ç»Ÿã€‚ï¼ˆÂ§6ï¼‰ PRISM-RSï¼šä¸€ä¸ªå®ç° ABD [4] ä»²è£å¤åˆ¶åè®®çš„å¤åˆ¶å­˜å‚¨ç³»ç»Ÿã€‚ï¼ˆÂ§7ï¼‰ PRISM-TXï¼šä¸€ä¸ªä½¿ç”¨ PRISM åŸè¯­å®ç°åŸºäºæ—¶é—´æˆ³çš„ä¹è§‚å¹¶å‘æ§åˆ¶åè®®çš„äº‹åŠ¡å­˜å‚¨ç³»ç»Ÿã€‚ï¼ˆÂ§8ï¼‰ æ¯”è¾ƒæ—©çš„å…¶å®å°±æ˜¯ FaRM, Pilaf è¿™å‡ ä¸ª RDMA kv åˆ†å¸ƒå¼äº‹åŠ¡ä¹Ÿæ¯”è¾ƒæœ‰æ„æ€ ","date":"2024-09-22","objectID":"/posts/paper-prism/:7:0","tags":["Paper Reading"],"title":"Paper Reading: Rethinking the RDMA Interface for Distributed Systems","uri":"/posts/paper-prism/"},{"categories":null,"content":"PRISM-KV: Key-Value Storage é”®å€¼å­˜å‚¨æ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„åŸºç¡€è®¾æ–½ï¼Œæ˜¯åˆ©ç”¨ RDMA åŠ é€Ÿçš„è‡ªç„¶æœºä¼šã€‚æˆ‘ä»¬é¦–å…ˆè€ƒè™‘ä¸€ä¸ªç®€å•çš„è¿œç¨‹ã€æœªå¤åˆ¶çš„é”®å€¼å­˜å‚¨ï¼Œç±»ä¼¼äº memcachedã€‚å®ƒæä¾›äº†ä¸€ä¸ª GET/PUT æ¥å£ï¼Œå…¶ä¸­é”®å’Œå€¼å¯ä»¥æ˜¯ä»»æ„é•¿åº¦çš„å­—ç¬¦ä¸²ã€‚ ä½œä¸ºä¸€ä¸ªä½¿ç”¨ RDMA å®ç°é”®å€¼å­˜å‚¨çš„æŒ‘æˆ˜ç¤ºä¾‹ï¼Œå†æ¬¡è€ƒè™‘ Pilaf [31]ã€‚Pilaf ä»…ä½¿ç”¨å•è¾¹æ“ä½œæ¥å®ç° GET æ“ä½œï¼›PUT æ“ä½œé€šè¿‡åŒè¾¹ RPC æœºåˆ¶å‘é€å¹¶ç”±æœåŠ¡å™¨ CPU æ‰§è¡Œã€‚å®ƒå­˜å‚¨ä¸€ä¸ªå›ºå®šå¤§å°çš„å“ˆå¸Œè¡¨ï¼Œè¯¥è¡¨ä»…åŒ…å«ä¸€ä¸ªæœ‰æ•ˆä½å’Œä¸€ä¸ªæŒ‡å‘é”®å€¼å­˜å‚¨çš„æŒ‡é’ˆï¼Œè¯¥å­˜å‚¨åœ¨å•ç‹¬çš„ extents åŒºåŸŸä¸­ã€‚è¦æ‰§è¡Œ GET æ“ä½œï¼ŒPilaf å®¢æˆ·ç«¯è®¡ç®—é”®çš„å“ˆå¸Œå€¼ï¼Œå¹¶æ‰§è¡Œå•è¾¹ READ åˆ°å“ˆå¸Œè¡¨ï¼Œç„¶åæ‰§è¡Œç¬¬äºŒä¸ª READ åˆ°å®ƒæŒ‡å‘çš„æ•°æ®ã€‚å“ˆå¸Œå†²çªä½¿ç”¨çº¿æ€§æ¢æµ‹æˆ–å¸ƒè°·é¸Ÿå“ˆå¸Œè§£å†³ï¼Œè¿™å¯èƒ½éœ€è¦è¯»å–é¢å¤–çš„æŒ‡é’ˆã€‚ ","date":"2024-09-22","objectID":"/posts/paper-prism/:8:0","tags":["Paper Reading"],"title":"Paper Reading: Rethinking the RDMA Interface for Distributed Systems","uri":"/posts/paper-prism/"},{"categories":null,"content":"PRISM-KV Design å•è¾¹æ“ä½œå®ç°äº† GET å’Œ PUT æ“ä½œ å®ƒç»´æŠ¤ä¸€ä¸ªåŒ…å«æŒ‡å‘æ•°æ®é¡¹æŒ‡é’ˆçš„å“ˆå¸Œè¡¨ç´¢å¼•ï¼›è¿™äº›æ•°æ®é¡¹ç°åœ¨ä½¿ç”¨ PRISM çš„ ALLOCATE åŸè¯­åˆ†é…çš„ç¼“å†²åŒºä¸­ã€‚ æ„Ÿè§‰å°±æ˜¯åŠ å…¥äº†æ›´å¤šç¼“å†²åŒºï¼Œç„¶åæ¥æ”¯æŒä¸€äº›åŒæ­¥åŸè¯­ è¦æ‰§è¡Œ PUT æ“ä½œï¼Œå®¢æˆ·ç«¯é¦–å…ˆå¦‚ä¸Šæ‰€è¿°ç¡®å®šæ­£ç¡®çš„å“ˆå¸Œè¡¨æ§½ã€‚ç„¶åï¼Œå®¢æˆ·ç«¯ä½¿ç”¨ PRISM åŸè¯­é“¾å†™å…¥æ–°å€¼å¹¶æ›´æ–°å“ˆå¸Œè¡¨æ§½ã€‚é¦–å…ˆï¼Œå®¢æˆ·ç«¯ä½¿ç”¨ ALLOCATE å°†å€¼å†™å…¥æ–°ç¼“å†²åŒºï¼Œå¹¶å°†åœ°å€é‡å®šå‘åˆ°ä¸´æ—¶ä½ç½®ã€‚ç„¶åï¼Œå®¢æˆ·ç«¯åœ¨å“ˆå¸Œè¡¨æ§½æ‰§è¡Œ CASï¼Œå¦‚æœè‡ªå®¢æˆ·ç«¯ç¡®å®šæ­£ç¡®æ§½ä»¥æ¥æœªæ›´æ”¹ï¼Œåˆ™å°†æ—§åœ°å€æ›¿æ¢ä¸ºå­˜å‚¨åœ¨ä¸´æ—¶ä½ç½®çš„åœ°å€ã€‚2 ä¸ºæ­¤æœ€åæ“ä½œè®¾ç½®äº†é€‚å½“çš„é—´æ¥ä½å’Œæ¡ä»¶æ ‡å¿—ã€‚å¦‚æœ CAS å¤±è´¥ï¼Œè¿™è¡¨æ˜å¹¶å‘å®¢æˆ·ç«¯éšåç”¨è¾ƒæ–°çš„å€¼è¦†ç›–äº†ç›¸åŒçš„é”®ã€‚å¦‚æœæˆåŠŸï¼Œå®¢æˆ·ç«¯å¼‚æ­¥é€šçŸ¥æœåŠ¡å™¨å°†æ—§ç‰ˆæœ¬çš„ç¼“å†²åŒºè¿”å›åˆ°ç©ºé—²åˆ—è¡¨ã€‚ PRISM-KV ç¡®ä¿åœ¨å¹¶å‘æ›´æ–°æœŸé—´çš„æ­£ç¡®æ€§ï¼Œå› ä¸ºå¯¹è±¡è¢«å†™å…¥å•ç‹¬çš„ç¼“å†²åŒºï¼Œå¹¶ä¸”è¿™äº›ç¼“å†²åŒºçš„æŒ‡é’ˆè¢«åŸå­åœ°å®‰è£…åˆ°é€‚å½“çš„å“ˆå¸Œè¡¨æ§½ä¸­ã€‚ä¸æ›´æ–°åŒæ—¶è¿›è¡Œçš„è¯»å–ä¹Ÿä¸ä¼šè¿åå®‰å…¨æ€§ï¼Œå› ä¸ºå“ˆå¸Œè¡¨æ§½çš„é—´æ¥è¯»å–ä¿è¯è¯»å–æ ¼å¼è‰¯å¥½çš„åœ°å€ï¼Œå¹¶ä¸”åœ°å€é€‚åˆç¼“å­˜è¡Œã€‚è¯·æ³¨æ„ï¼Œåˆšåˆšå®Œæˆæ›´æ–°çš„å®¢æˆ·ç«¯å¯èƒ½ä¼šå°è¯•é‡Šæ”¾ç¼“å†²åŒºï¼Œè€Œé—´æ¥è¯»å–å°è¯•è¯»å–å®ƒã€‚è¿™å¯¹æ­£ç¡®æ€§ä¸æ˜¯é—®é¢˜ï¼Œå› ä¸º PRISM åœ¨å°†ç¼“å†²åŒºæ·»åŠ å›ç©ºé—²åˆ—è¡¨ä¹‹å‰ç­‰å¾…å¹¶å‘ NIC æ“ä½œå®Œæˆã€‚ ","date":"2024-09-22","objectID":"/posts/paper-prism/:8:1","tags":["Paper Reading"],"title":"Paper Reading: Rethinking the RDMA Interface for Distributed Systems","uri":"/posts/paper-prism/"},{"categories":null,"content":"Evaluation è¿™ä¸ªç»“æœå°±çœ‹ä¸Šå»å¥½å¾ˆå¤šï¼Œååé‡åœ¨å†™å¤šçš„æƒ…å†µä¸‹è¿˜æ˜¯å¾ˆä¸é”™çš„ï¼Œä½†æ˜¯å†™åªè¦ç¨å¾®å¤šä¸€äº›å°±ä¸è¡Œäº†å’Œ pilaf æ²¡å¤ªå¤§å·®åˆ«ï¼Œä¸»è¦è¿˜æ˜¯ cow + rcu çš„ç»„åˆä¸å¤ªèƒ½é€‚åº”å†™å¤šçš„åœºæ™¯ï¼Ÿ åˆæäº†ç¡¬ä»¶å®ç°ï¼Œåˆæ˜¯é¢„æµ‹ã€‚ã€‚ ","date":"2024-09-22","objectID":"/posts/paper-prism/:8:2","tags":["Paper Reading"],"title":"Paper Reading: Rethinking the RDMA Interface for Distributed Systems","uri":"/posts/paper-prism/"},{"categories":null,"content":"PRISM-RS: Replicated Block Storage å—å­˜å‚¨ + replica PRISM-RS æ˜¯æˆ‘ä»¬çš„å—å­˜å‚¨è®¾è®¡ï¼Œå®ƒä¿è¯äº†çº¿æ€§åŒ–ï¼Œåªè¦ä¸è¶…è¿‡ ğ‘“ ä¸ªå‰¯æœ¬å¤±è´¥ï¼Œå°±å¯ä»¥ä¿æŒå¯ç”¨æ€§ï¼Œå¹¶ä¸”éœ€è¦æœ€å°‘çš„å‰¯æœ¬ CPU å‚ä¸ã€‚å®ƒé€šè¿‡ä½¿ç”¨ PRISM æ“ä½œå®ç° ABD [4] åŸå­å¯„å­˜å™¨åè®®çš„å˜ä½“æ¥å®ç°è¿™ä¸€ç‚¹ã€‚ ABD åè®® Amotz Bar-Noy éå¸¸æ—©æå‡ºçš„ä¸€ä¸ªåˆ†å¸ƒå¼åŒæ­¥åè®®ï¼Ÿ ä¸ºä»€ä¹ˆè¦ç”¨è¿™ä¹ˆæ—©çš„ï¼Œä¸èƒ½æ”¯æŒæ›´ç°ä»£çš„å— ","date":"2024-09-22","objectID":"/posts/paper-prism/:9:0","tags":["Paper Reading"],"title":"Paper Reading: Rethinking the RDMA Interface for Distributed Systems","uri":"/posts/paper-prism/"},{"categories":null,"content":"PRISM-TX: Distributed Transactions æˆ‘ä»¬èƒ½å¦æ„å»ºä¸€ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡åè®®ï¼Œä½¿ç”¨è¿œç¨‹æ“ä½œå®ç°å…¶æ‰§è¡Œå’Œæäº¤é˜¶æ®µï¼Ÿä½¿ç”¨ PRISM çš„æ–°åŸè¯­ï¼Œç‰¹åˆ«æ˜¯å¢å¼ºçš„ CAS æ“ä½œï¼Œæˆ‘ä»¬åœ¨ä¸€ä¸ªç§°ä¸º PRISM-TX çš„åè®®ä¸­å®ç°äº†ä¹è§‚å¹¶å‘æ§åˆ¶æ£€æŸ¥ã€‚ ä¹è§‚å¹¶å‘åè®®ï¼Œèƒ½è¯æ˜å¯åºåˆ—åŒ–ï¼ˆä½†æ˜¯æ²¡å†™ï¼‰ ä½¿ç”¨äº†ä¸€äº›ç®€å•çš„æµ‹è¯•ï¼ŒYCSB-T low contention ","date":"2024-09-22","objectID":"/posts/paper-prism/:10:0","tags":["Paper Reading"],"title":"Paper Reading: Rethinking the RDMA Interface for Distributed Systems","uri":"/posts/paper-prism/"},{"categories":null,"content":"Conclusion çœ‹å®Œä¹Ÿä¸çŸ¥é“çœ‹äº†ä»€ä¹ˆ å‡å°‘ç½‘ç»œå¾€è¿”ï¼šPRISM é€šè¿‡åœ¨å•è¾¹æ“ä½œä¸­å¼•å…¥æ›´å¤æ‚çš„æ“ä½œï¼Œå‡å°‘äº†é¢å¤–çš„ç½‘ç»œå¾€è¿”æ¬¡æ•°ï¼Œä»è€Œæé«˜äº†æ€§èƒ½ã€‚ ","date":"2024-09-22","objectID":"/posts/paper-prism/:11:0","tags":["Paper Reading"],"title":"Paper Reading: Rethinking the RDMA Interface for Distributed Systems","uri":"/posts/paper-prism/"},{"categories":null,"content":"The eXpress Data Path: Fast Programmable Packet Processing in the Operating System Kernel ACM coNEXT 2018ï¼Œåœ¨å†…æ ¸å±‚é¢å¿«é€Ÿå¤„ç† packetï¼Œå¼€æºå¾ˆå®Œå–„ï¼Œä¸ dpdk ä¹‹ç±»çš„åŒºåˆ«åœ¨äºä¸æ˜¯çº¯åœ¨ç”¨æˆ·æ€å¤„ç†ï¼Œä¹Ÿä¸æ˜¯ç”¨æˆ·æ€åè®®æ ˆã€‚ è€Œæ˜¯åˆ©ç”¨ eBPF åœ¨å†…æ ¸æ€æ‰§è¡Œã€‚ æ˜æ˜ä¸ç®—å¾ˆé«˜å¼ºåº¦çœ‹äº†ä¸¤å‘¨è®ºæ–‡ï¼Œå·²ç»ä¸é€‚äº†ã€‚å¯èƒ½æ˜¯ä¸å¤ªæ‡‚ OS + Network ç›¸å…³çš„å§ï¼Œå®åœ¨æ˜¯å¤ªéš¾äº†ï¼Œå¾ˆå¤šæ¦‚å¿µéƒ½æ²¡æ¥è§¦è¿‡ï¼Œåªæ˜¯å…¥ä¸ªé—¨ï¼Œæ¯”å¦‚è¿™ç¯‡çš„ BPF å°±æ²¡æ¥è§¦è¿‡ã€‚æ²¡å†™è¿‡æ²¡è®¤çœŸç ”ç©¶è¿‡çš„ä¸œè¥¿éœ€è¦åœ¨å‡ ä¸ªå°æ—¶å¼„æ˜ç™½å¤ªå›°éš¾äº†ã€‚ XDP æ˜¯å¯ä»¥åœ¨ Linux å¼€å¯çš„ï¼Œåº”è¯¥æ˜¯åº”ç”¨æ¯”è¾ƒå¹¿æ³›çš„ï¼Œhttps://www.datadoghq.com/blog/xdp-intro/ï¼Œåˆ†ä¸‰ç§ï¼Œä¸€ä¸ªæ˜¯åŠ è½½åˆ°ç½‘å¡é©±åŠ¨ï¼Œä¸€ä¸ªæ˜¯åŠ è½½åˆ°ç½‘å¡ï¼Œä¸€ä¸ªæ˜¯ Linux åè®®æ ˆå…¥å£ï¼ˆæ€§èƒ½-é€šç”¨ tradeoffï¼‰ AF_XDP æ˜¯ XDP æŠ€æœ¯çš„ä¸€ç§åº”ç”¨åœºæ™¯ï¼ŒAF_XDP æ˜¯ä¸€ç§é«˜æ€§èƒ½ Linux socketã€‚ ä¸»è¦å‡ ä¸ªç¼ºç‚¹æ˜¯ï¼Œæ²¡æœ‰ç¼“å­˜é˜Ÿåˆ—ï¼Œå¯èƒ½ä¸å¤ªé€‚åˆé«˜å»¶è¿Ÿçš„è®¾å¤‡ï¼Œè€Œä¸”æ²¡æœ‰ç½‘ç»œæ ˆé€šç”¨å§ https://github.com/facebookincubator/katran Meta åŸºäº BPF + XDP å®ç°çš„é«˜æ€§èƒ½ load balancerï¼Œå°¤å…¶æ˜¯åœ¨ XDP é©±åŠ¨æ¨¡å¼ä¸‹è¡¨ç°éå¸¸å¿«ã€‚ ","date":"2024-09-18","objectID":"/posts/paper-xdp/:1:0","tags":["Paper Reading"],"title":"Paper Reading: The eXpress Data Path","uri":"/posts/paper-xdp/"},{"categories":null,"content":"ABSTRACT Programmable packet processing is increasingly implemented using kernel bypass techniques, where a userspace application takes complete control of the networking hardware to avoid expensive context switches between kernel and userspace application isolation and security mechanisms and well-tested configuration, deployment and management tools cease to function ç»•è¿‡æ“ä½œç³»ç»Ÿä¼šå¸¦æ¥ä»€ä¹ˆï¼Œéš”ç¦»ã€å®‰å…¨ã€é…ç½®ï¼Ÿæœ‰å…·ä½“ä¾‹å­å—ï¼Œæ¯”å¦‚é˜²ç«å¢™ã€ACLã€è¿˜æ˜¯æƒé™ã€è¿›ç¨‹éš”ç¦»ï¼Ÿ we present the design of a novel approach to programmable packet processing, called the eXpress Data Path (XDP) XDP is part of the mainline Linux kernel and provides a fully integrated solution working in concert with the kernelâ€™s networking stack. Applications are written in higher level languages such as C and compiled into custom byte code which the kernel statically analyses for safety, and translates into native instructions ","date":"2024-09-18","objectID":"/posts/paper-xdp/:2:0","tags":["Paper Reading"],"title":"Paper Reading: The eXpress Data Path","uri":"/posts/paper-xdp/"},{"categories":null,"content":"INTRODUCTION DPDK bypass the operating sys- tem completely, instead passing control of the network hardware directly to the network application and dedicating one, or several, CPU cores exclusively to packet processing. å†…æ ¸æ—è·¯æ–¹æ³•å¯ä»¥æ˜¾è‘—æé«˜æ€§èƒ½ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªç¼ºç‚¹ï¼Œé‚£å°±æ˜¯æ›´éš¾ä¸ç°æœ‰ç³»ç»Ÿé›†æˆï¼Œåº”ç”¨ç¨‹åºå¿…é¡»é‡æ–°å®ç°æ“ä½œç³»ç»Ÿç½‘ç»œæ ˆæä¾›çš„åŠŸèƒ½ï¼Œæ¯”å¦‚è·¯ç”±è¡¨å’Œæ›´é«˜çº§åˆ«çš„åè®®ã€‚ åœ¨æœ€åçš„æƒ…å†µä¸‹ï¼Œè¿™å°†å¯¼è‡´ä¸€ç§åœºæ™¯ï¼Œå³æ•°æ®åŒ…å¤„ç†åº”ç”¨ç¨‹åºåœ¨ä¸€ä¸ªå®Œå…¨ç‹¬ç«‹çš„ç¯å¢ƒä¸­è¿è¡Œï¼Œç”±äºéœ€è¦ç›´æ¥çš„ç¡¬ä»¶è®¿é—®ï¼Œæ“ä½œç³»ç»Ÿæä¾›çš„ç†Ÿæ‚‰çš„å·¥å…·å’Œéƒ¨ç½²æœºåˆ¶æ— æ³•ä½¿ç”¨ã€‚è¿™ä¼šå¢åŠ ç³»ç»Ÿçš„å¤æ‚æ€§ï¼Œæ¨¡ç³Šæ“ä½œç³»ç»Ÿå†…æ ¸å¼ºåˆ¶æ‰§è¡Œçš„å®‰å…¨è¾¹ç•Œã€‚ åŸºç¡€è®¾æ–½æ­£åœ¨è½¬å‘åŸºäºå®¹å™¨çš„å·¥ä½œè´Ÿè½½å’Œç¼–æ’ç³»ç»Ÿ(å¦‚ Docker æˆ– Kubernetes) ï¼Œåœ¨è¿™äº›ç³»ç»Ÿä¸­ï¼Œå†…æ ¸åœ¨èµ„æºæŠ½è±¡å’Œéš”ç¦»æ–¹é¢å‘æŒ¥ç€ä¸»å¯¼ä½œç”¨ å®¹å™¨åŒ–å’Œè™šæ‹ŸåŒ–çš„åŒºåˆ«æ˜¯ä»€ä¹ˆã€‚ XDP ä»¥è¿è¡Œ eBPF ä»£ç çš„è™šæ‹Ÿæœºçš„å½¢å¼å®šä¹‰ä¸€ä¸ªæœ‰é™çš„æ‰§è¡Œç¯å¢ƒï¼ŒeBPF æ˜¯åŸå§‹ BSD åŒ…è¿‡æ»¤å™¨ (BPF) å­—èŠ‚ç æ ¼å¼çš„æ‰©å±•ç‰ˆæœ¬ã€‚è¿™ä¸ªç¯å¢ƒåœ¨å†…æ ¸æœ¬èº«æ¥è§¦æ•°æ®åŒ…æ•°æ®ä¹‹å‰ç›´æ¥åœ¨å†…æ ¸ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œå®šåˆ¶ç¨‹åºï¼Œè¿™ä½¿å¾—åœ¨ä»ç¡¬ä»¶æ¥æ”¶æ•°æ®åŒ…ä¹‹åå°½å¯èƒ½æ—©åœ°è¿›è¡Œè‡ªå®šä¹‰å¤„ç†(åŒ…æ‹¬é‡å®šå‘)ã€‚å†…æ ¸é€šè¿‡åœ¨åŠ è½½æ—¶é™æ€éªŒè¯è‡ªå®šä¹‰ç¨‹åºæ¥ç¡®ä¿å®ƒä»¬çš„å®‰å…¨æ€§; å¹¶ä¸”ç¨‹åºè¢«åŠ¨æ€åœ°ç¼–è¯‘æˆæœ¬åœ°æœºå™¨æŒ‡ä»¤ä»¥ç¡®ä¿é«˜æ€§èƒ½ è™½ç„¶è¿™å¹¶ä¸å®Œå…¨ç¬¦åˆåœ¨ç›¸åŒç¡¬ä»¶ä¸ŠåŸºäº DPDK çš„åº”ç”¨ç¨‹åºçš„æœ€é«˜å¯å®ç°æ€§èƒ½ï¼Œä½†æˆ‘ä»¬è®¤ä¸º XDP ç³»ç»Ÿé€šè¿‡æä¾›å‡ ä¸ªæ¯” DPDK å’Œå…¶ä»–å†…æ ¸æ—è·¯è§£å†³æ–¹æ¡ˆæ›´å¼•äººæ³¨ç›®çš„ä¼˜åŠ¿æ¥å¼¥è¡¥è¿™ä¸€ç‚¹ æ€§èƒ½è¿˜æ˜¯ä¸å¦‚ DPDK ä¸å¸¸è§„ç½‘ç»œå †æ ˆååŒé›†æˆï¼Œåœ¨å†…æ ¸ä¸­ä¿ç•™å¯¹ç¡¬ä»¶çš„å®Œå…¨æ§åˆ¶ã€‚è¿™ä¿ç•™äº†å†…æ ¸çš„å®‰å…¨è¾¹ç•Œï¼Œå¹¶ä¸”ä¸éœ€è¦å¯¹ç½‘ç»œé…ç½®å’Œç®¡ç†å·¥å…·è¿›è¡Œä»»ä½•æ›´æ”¹ã€‚æ­¤å¤–ï¼Œä»»ä½•å…·æœ‰ Linux é©±åŠ¨ç¨‹åºçš„ç½‘ç»œé€‚é…å™¨éƒ½å¯ä»¥è¢« XDP æ”¯æŒï¼›ä¸éœ€è¦ç‰¹æ®Šçš„ç¡¬ä»¶åŠŸèƒ½ï¼Œç°æœ‰çš„é©±åŠ¨ç¨‹åºåªéœ€è¦è¿›è¡Œä¿®æ”¹ä»¥æ·»åŠ  XDP æ‰§è¡Œé’©å­ã€‚ ä½¿å¾—å¯ä»¥é€‰æ‹©æ€§åœ°åˆ©ç”¨å†…æ ¸ç½‘ç»œå †æ ˆåŠŸèƒ½ï¼Œå¦‚è·¯ç”±è¡¨å’Œ TCP å †æ ˆï¼Œä¿æŒç›¸åŒçš„é…ç½®æ¥å£ï¼ŒåŒæ—¶åŠ é€Ÿå…³é”®æ€§èƒ½è·¯å¾„ã€‚ ä¿è¯ eBPF æŒ‡ä»¤é›†å’Œä¸å…¶ä¸€èµ·å…¬å¼€çš„ç¼–ç¨‹æ¥å£ï¼ˆAPIï¼‰çš„ç¨³å®šæ€§ã€‚ åœ¨ä¸åŸºäºæ­£å¸¸å¥—æ¥å±‚çš„å·¥ä½œè´Ÿè½½äº¤äº’æ—¶ï¼Œä¸éœ€è¦å°†æ•°æ®åŒ…ä»ç”¨æˆ·ç©ºé—´é‡æ–°æ³¨å…¥å†…æ ¸ç©ºé—´ï¼Œä»è€Œé¿å…äº†æ˜‚è´µçš„æ“ä½œã€‚ å¯¹ä¸»æœºä¸Šè¿è¡Œçš„åº”ç”¨ç¨‹åºæ˜¯é€æ˜çš„ï¼Œä½¿å¾—æ–°çš„éƒ¨ç½²åœºæ™¯æˆä¸ºå¯èƒ½ï¼Œä¾‹å¦‚åœ¨æœåŠ¡å™¨ä¸Šè¿›è¡Œå†…è”ä¿æŠ¤ä»¥æŠµå¾¡æ‹’ç»æœåŠ¡æ”»å‡»ã€‚ å¯ä»¥åŠ¨æ€é‡æ–°ç¼–ç¨‹è€Œä¸ä¼šä¸­æ–­ä»»ä½•æœåŠ¡ï¼Œè¿™æ„å‘³ç€å¯ä»¥åœ¨ä¸ä¸­æ–­ç½‘ç»œæµé‡çš„æƒ…å†µä¸‹åŠ¨æ€æ·»åŠ æˆ–å®Œå…¨ç§»é™¤åŠŸèƒ½ï¼Œå¹¶ä¸”å¤„ç†å¯ä»¥æ ¹æ®ç³»ç»Ÿå…¶ä»–éƒ¨åˆ†çš„çŠ¶å†µåŠ¨æ€ååº”ã€‚ ä¸éœ€è¦å°†å®Œæ•´çš„ CPU æ ¸å¿ƒä¸“ç”¨äºæ•°æ®åŒ…å¤„ç†ï¼Œè¿™æ„å‘³ç€è¾ƒä½çš„æµé‡æ°´å¹³ç›´æ¥è½¬åŒ–ä¸ºè¾ƒä½çš„ CPU ä½¿ç”¨ç‡ã€‚è¿™å¯¹æ•ˆç‡å’ŒèŠ‚èƒ½æœ‰é‡è¦å½±å“ã€‚ ä¸éœ€è¦ç‰¹æ®Š network adapter å’Œ driver æ˜¯å¾ˆä¸é”™çš„ä¸€ä¸ªç‚¹ re-injection from user space into kernel space when interacting with workloads based on the normal socket layer è¿™æ˜¯åœ¨å“ªå‘ç”Ÿçš„ï¼Ÿæ˜¯ dpdk å— dedicating full CPU cores ä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆå¥‡æ€ªçš„ç‚¹ï¼Œlow traffic ä¼šå ç”¨ dpdk ä¸€ä¸ªæ ¸ 100% å—ï¼Ÿ ","date":"2024-09-18","objectID":"/posts/paper-xdp/:3:0","tags":["Paper Reading"],"title":"Paper Reading: The eXpress Data Path","uri":"/posts/paper-xdp/"},{"categories":null,"content":"RELATED WORK Examples of such applica- tions include those performing single functions, such as switch- ing [47], routing [19], named-based forwarding [28], classifica- tion [48], caching [33] or traffic generation ä¸ºäº†åœ¨ Common Off The Shelf é€šç”¨ç°è´§(COTS)ç¡¬ä»¶ä¸Šå®ç°é«˜æ€§èƒ½çš„æ•°æ®åŒ…å¤„ç†ï¼Œæœ‰å¿…è¦æ¶ˆé™¤ç½‘ç»œæ¥å£å¡ (NIC) å’Œæ‰§è¡Œæ•°æ®åŒ…å¤„ç†çš„ç¨‹åºä¹‹é—´çš„ä»»ä½•ç“¶é¢ˆã€‚ç”±äºæ€§èƒ½ç“¶é¢ˆçš„ä¸»è¦æ¥æºä¹‹ä¸€æ˜¯æ“ä½œç³»ç»Ÿå†…æ ¸å’Œè¿è¡Œåœ¨å…¶ä¸Šçš„ç”¨æˆ·ç©ºé—´åº”ç”¨ç¨‹åºä¹‹é—´çš„ interface (å› ä¸ºç³»ç»Ÿè°ƒç”¨çš„é«˜å¼€é”€å’Œåº•å±‚åŠŸèƒ½ä¸°å¯Œçš„é€šç”¨å †æ ˆçš„å¤æ‚æ€§) ï¼Œä½çº§æ•°æ®åŒ…å¤„ç†æ¡†æ¶å¿…é¡»ä»¥è¿™æ ·æˆ–é‚£æ ·çš„æ–¹å¼ç®¡ç†è¿™ç§å¼€é”€ã€‚æ”¯æŒä¸Šé¢æåˆ°çš„åº”ç”¨ç¨‹åºçš„ç°æœ‰æ¡†æ¶é‡‡ç”¨å¤šç§æ–¹æ³•æ¥ç¡®ä¿é«˜æ€§èƒ½; XDP åŸºäºå…¶ä¸­å‡ ç§æ–¹æ³•çš„æŠ€æœ¯ã€‚åœ¨æ¥ä¸‹æ¥çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†ç®€è¦æ¦‚è¿° XDP ä¸ç°æœ‰æœ€å¸¸ç”¨æ¡†æ¶ä¹‹é—´çš„å¼‚åŒã€‚ DataPlanDevelopmentKit (DPDK)[16]å¯èƒ½æ˜¯ç”¨äºé«˜é€Ÿæ•°æ®åŒ…å¤„ç†çš„æœ€å¹¿æ³›ä½¿ç”¨çš„æ¡†æ¶ã€‚å®ƒæœ€åˆæ˜¯ä¸€ä¸ª Intel ä¸“ç”¨çš„ç¡¬ä»¶æ”¯æŒåŒ…ï¼Œä½†æ˜¯åœ¨ Linux åŸºé‡‘ä¼šçš„ç®¡ç†ä¸‹å·²ç»å¾—åˆ°äº†å¹¿æ³›çš„åº”ç”¨ã€‚DPDK æ˜¯ä¸€ç§æ‰€è°“çš„å†…æ ¸æ—è·¯æ¡†æ¶ï¼Œå®ƒå°†ç½‘ç»œç¡¬ä»¶çš„æ§åˆ¶ä»å†…æ ¸ç§»åˆ°ç½‘ç»œåº”ç”¨ç¨‹åºä¸­ï¼Œå®Œå…¨æ¶ˆé™¤äº†å†…æ ¸-ç”¨æˆ·ç©ºé—´è¾¹ç•Œçš„å¼€é”€ã€‚ however, as mentioned in the introduction, it has significant management, maintenance and security drawbacks. è¿˜æ˜¯ä¸æ‡‚æœ‰ä»€ä¹ˆå®‰å…¨å’Œç®¡ç†é—®é¢˜ï¼Œèƒ½å¤Ÿå…·ä½“ä¸€ç‚¹å—ï¼Œintro ä¹Ÿåªæ˜¯è¯´éœ€è¦é‡æ–°å®ç°ç½‘ç»œæ ˆã€éš¾ä»¥é›†æˆï¼Ÿ XDP é‡‡ç”¨äº†ä¸€ç§ä¸ç»•è¿‡å†…æ ¸ç›¸åçš„æ–¹æ³•: ä¸æ˜¯å°†ç½‘ç»œç¡¬ä»¶çš„æ§åˆ¶ç§»å‡ºå†…æ ¸ï¼Œè€Œæ˜¯å°†å¯¹æ€§èƒ½æ•æ„Ÿçš„æ•°æ®åŒ…å¤„ç†æ“ä½œç§»å…¥å†…æ ¸ï¼Œå¹¶åœ¨æ“ä½œç³»ç»Ÿç½‘ç»œå †æ ˆå¼€å§‹å¤„ç†ä¹‹å‰æ‰§è¡Œã€‚è¿™ä¿ç•™äº†å»é™¤ç½‘ç»œç¡¬ä»¶å’ŒåŒ…å¤„ç†ä»£ç ä¹‹é—´çš„å†…æ ¸-ç”¨æˆ·ç©ºé—´è¾¹ç•Œçš„ä¼˜ç‚¹ï¼ŒåŒæ—¶ä¿æŒäº†å†…æ ¸å¯¹ç¡¬ä»¶çš„æ§åˆ¶ï¼Œä»è€Œä¿ç•™äº†ç®¡ç†æ¥å£å’Œæ“ä½œç³»ç»Ÿæä¾›çš„å®‰å…¨ä¿è¯ã€‚å®ç°è¿™ä¸€ç‚¹çš„å…³é”®åˆ›æ–°æ˜¯ä½¿ç”¨ä¸€ä¸ªè™šæ‹Ÿæ‰§è¡Œç¯å¢ƒæ¥éªŒè¯åŠ è½½çš„ç¨‹åºä¸ä¼šæŸå®³æˆ–ä½¿å†…æ ¸å´©æºƒ æå‰å¤„ç†ï¼Ÿè¿˜æ˜¯ä½¿ç”¨äº†è™šæ‹Ÿç¯å¢ƒ virtual execution environment åœ¨å¼•å…¥ XDP ä¹‹å‰ï¼Œå°†æ•°æ®åŒ…å¤„ç†åŠŸèƒ½ä½œä¸ºå†…æ ¸æ¨¡å—å®ç°æ˜¯ä¸€ç§é«˜æˆæœ¬çš„æ–¹æ³•ï¼Œå› ä¸ºé”™è¯¯å¯èƒ½ä½¿æ•´ä¸ªç³»ç»Ÿå´©æºƒï¼Œè€Œä¸”å†…éƒ¨å†…æ ¸ API ç»å¸¸å‘ç”Ÿå˜åŒ– åŒ…å¤„ç†æ€ä¹ˆå¼•èµ·ç³»ç»Ÿå´©æºƒï¼Ÿ XDP é€šè¿‡æä¾›ä¸€ä¸ªå®‰å…¨çš„æ‰§è¡Œç¯å¢ƒï¼Œå¹¶å¾—åˆ°å†…æ ¸ç¤¾åŒºçš„æ”¯æŒï¼Œæå¤§åœ°é™ä½äº†å°†å¤„ç†è¿ç§»åˆ°å†…æ ¸ä¸­çš„åº”ç”¨ç¨‹åºçš„æˆæœ¬ï¼Œä»è€Œæä¾›äº†ä¸å†…æ ¸å‘ç”¨æˆ·ç©ºé—´å…¬å¼€çš„å…¶ä»–æ¥å£ç›¸åŒçš„ API ç¨³å®šæ€§ä¿è¯ã€‚æ­¤å¤–ï¼ŒXDP ç¨‹åºå¯ä»¥å®Œå…¨ç»•è¿‡ç½‘ç»œå †æ ˆï¼Œè¿™æ¯”éœ€è¦æŒ‚æ¥åˆ°ç°æœ‰å †æ ˆçš„ä¼ ç»Ÿå†…æ ¸æ¨¡å—æä¾›äº†æ›´é«˜çš„æ€§èƒ½ã€‚ bypass the networking stack æ˜¯æ€ä¹ˆåšï¼Œæœ‰ç±»ä¼¼çš„å—ï¼Œæ˜¯é›¶æ‹·è´å—ï¼ŸAF_XDPï¼Ÿä¸ä½¿ç”¨å†…æ ¸çš„ç½‘ç»œæ ˆå¤„ç†æ•°æ®åŒ…ï¼Œè‡ªå·±å¤„ç†ï¼Ÿ è™½ç„¶ XDP å…è®¸æ•°æ®åŒ…å¤„ç†è¿›å…¥æ“ä½œç³»ç»Ÿä»¥è·å¾—æœ€å¤§çš„æ€§èƒ½ï¼Œä½†å®ƒä¹Ÿå…è®¸åŠ è½½åˆ°å†…æ ¸çš„ç¨‹åºæœ‰é€‰æ‹©åœ°å°†æ•°æ®åŒ…é‡å®šå‘åˆ°ä¸€ç§ç‰¹æ®Šçš„ç”¨æˆ·ç©ºé—´å¥—æ¥å­—ç±»å‹ï¼Œè¿™ç§å¥—æ¥å­—ç±»å‹ç»•è¿‡äº†æ­£å¸¸çš„ç½‘ç»œå †æ ˆï¼Œç”šè‡³å¯ä»¥ä»¥é›¶æ‹·è´æ¨¡å¼è¿›è¡Œæ“ä½œä»¥è¿›ä¸€æ­¥é™ä½å¼€é”€ã€‚ æ™®é€š linux NIC æ¥æ”¶åˆ°æ•°æ®åŒ…ï¼Œä¸­æ–­ï¼Œç¼“å†²åŒº-å†…æ ¸ç©ºé—´ï¼Œå†…æ ¸ç©ºé—´èµ°ç½‘ç»œæ ˆï¼ˆé“¾è·¯å±‚ã€ç½‘ç»œå±‚ã€åè®®å±‚ï¼‰å¤„ç†ï¼ˆæ ¡éªŒã€è·¯ç”±ç­‰ç­‰ï¼‰ã€å†…æ ¸ç¼“å†²-ç”¨æˆ·ç©ºé—´ç¼“å†²ã€socket æ¥å£ã€‚ XDP NIC æ¥æ”¶åˆ°æ•°æ®åŒ…ï¼Œä¸­æ–­ï¼Œç¼“å†²åŒº-å†…æ ¸ç©ºé—´å¤åˆ¶ï¼ŒXDP hook å¤„ç†åŒ…ï¼Œ programmable hardware achieve high-performance packet processing, NetFPGA, In a sense, XDP can be thought of as a â€œsoftware offloadâ€, where performance-sensitive processing is offloaded to increase performance, while applications otherwise interact with the regular networking stack XDP æ€ä¹ˆçŸ¥é“æ˜¯ performance-sensitiveï¼Œè¿˜æ˜¯è¯´å…¨éƒ¨è¿™ä¹ˆå¤„ç†ï¼Ÿé¢å¤–å¤„ç†ä¸éœ€è¦æ—¶é—´å— ","date":"2024-09-18","objectID":"/posts/paper-xdp/:4:0","tags":["Paper Reading"],"title":"Paper Reading: The eXpress Data Path","uri":"/posts/paper-xdp/"},{"categories":null,"content":"THE DESIGN OF XDP This deep integration with the kernel obviously imposes some design constraints ä»€ä¹ˆé™åˆ¶ï¼Ÿ åœ¨æ•°æ®åŒ…åˆ°è¾¾æ—¶ï¼Œåœ¨æ¥è§¦æ•°æ®åŒ…æ•°æ®ä¹‹å‰ï¼Œè®¾å¤‡é©±åŠ¨ç¨‹åºåœ¨ä¸» XDP æŒ‚é’©ä¸­æ‰§è¡Œ eBPF ç¨‹åºã€‚è¿™ä¸ªç¨‹åºå¯ä»¥é€‰æ‹©ä¸¢å¼ƒæ•°æ®åŒ…; å°†å®ƒä»¬å‘é€å›åŸæ¥æ¥æ”¶åˆ°çš„æ¥å£; å°†å®ƒä»¬é‡å®šå‘åˆ°å¦ä¸€ä¸ªæ¥å£(åŒ…æ‹¬è™šæ‹Ÿæœºçš„ vNIC) ï¼Œæˆ–è€…é€šè¿‡ç‰¹æ®Šçš„ AF _ XDP å¥—æ¥å­—å‘é€åˆ°ç”¨æˆ·ç©ºé—´; æˆ–è€…å…è®¸å®ƒä»¬è¿›å…¥å¸¸è§„çš„ç½‘ç»œå †æ ˆï¼Œ é—®é¢˜æ˜¯ï¼Œhook çš„è€—æ—¶ä¼šä¸ä¼šå½±å“æ­£å¸¸çš„åŒ…ï¼Ÿ The XDP driver hook is the main entry point for an XDP program, and is executed when a packet is received from the hardware. The eBPF virtual machine executes the byte code of the XDP program, and just-in-time-compiles it for increased performance. BPF maps are key/value stores that serve as the primary communication channel to the rest of the system. The eBPF verifier statically verifies programs before they are loaded to make sure they do not crash or corrupt the running kernel. å½“æ•°æ®åŒ…åˆ°è¾¾æ—¶ï¼Œç¨‹åºé¦–å…ˆè§£ææ•°æ®åŒ…å¤´ä»¥æå–å®ƒå°†å¯¹ä¹‹ä½œå‡ºååº”çš„ä¿¡æ¯ã€‚ç„¶åï¼Œå®ƒä»å¤šä¸ªæºä¹‹ä¸€è¯»å–æˆ–æ›´æ–°å…ƒæ•°æ®ã€‚æœ€åï¼Œå¯ä»¥é‡å†™ä¸€ä¸ªæ•°æ®åŒ…ï¼Œå¹¶ç¡®å®šå¯¹è¯¥æ•°æ®åŒ…çš„æœ€ç»ˆåˆ¤å†³ã€‚è¯¥ç¨‹åºå¯ä»¥åœ¨æ•°æ®åŒ…è§£æã€å…ƒæ•°æ®æŸ¥æ‰¾å’Œé‡å†™ä¹‹é—´è¿›è¡Œäº¤æ›¿ï¼Œæ‰€æœ‰è¿™äº›éƒ½æ˜¯å¯é€‰çš„ã€‚ map æ˜¯å¹²å˜›çš„ ","date":"2024-09-18","objectID":"/posts/paper-xdp/:5:0","tags":["Paper Reading"],"title":"Paper Reading: The eXpress Data Path","uri":"/posts/paper-xdp/"},{"categories":null,"content":"The XDP Driver Hook XDP programs run in the Extended BPF (eBPF) virtual machine. eBPF is an evolution of the original BSD packet filter (BPF) [37] which has seen extensive use in various packet filtering applications over the last decades. BPF uses a register-based virtual machine to describe filtering actions register-based virtual machine ä¼šä¸ä¼šå‡ºç°é—®é¢˜ï¼Œæ¯”å¦‚ å®¹é‡ä¸å¤Ÿä»€ä¹ˆçš„ ç¨‹åºé€šå¸¸é¦–å…ˆè§£ææ•°æ®åŒ…æ•°æ®ï¼Œå¹¶é€šè¿‡å°¾è°ƒç”¨å°†æ§åˆ¶æƒä¼ é€’ç»™ä¸åŒçš„ XDP ç¨‹åºï¼Œä»è€Œå°†å¤„ç†åˆ†æˆé€»è¾‘å­å•å…ƒï¼ˆä¾‹å¦‚ï¼ŒåŸºäº IP å¤´ç‰ˆæœ¬ï¼‰ã€‚ ","date":"2024-09-18","objectID":"/posts/paper-xdp/:5:1","tags":["Paper Reading"],"title":"Paper Reading: The eXpress Data Path","uri":"/posts/paper-xdp/"},{"categories":null,"content":"PERFORMANCE EVALUATION ç°æœ‰ç³»ç»Ÿä¸­æœ‰è®¸å¤šç”¨äºé«˜æ€§èƒ½æ•°æ®åŒ…å¤„ç†çš„è§£å†³æ–¹æ¡ˆï¼Œå¹¶ä¸”åœ¨æœ¬æ–‡èŒƒå›´å†…å¯¹æ‰€æœ‰è¿™äº›ç³»ç»Ÿè¿›è¡ŒåŸºå‡†æµ‹è¯•æ˜¯ä¸ç°å®çš„ã€‚ç›¸åï¼Œæˆ‘ä»¬æ³¨æ„åˆ° DPDK æ˜¯ç°æœ‰è§£å†³æ–¹æ¡ˆä¸­æ€§èƒ½æœ€é«˜çš„[18]ï¼Œå¹¶å°†å…¶ä½œä¸ºé«˜é€Ÿè½¯ä»¶æ•°æ®åŒ…å¤„ç†å½“å‰æŠ€æœ¯æ°´å¹³çš„åŸºå‡†è¿›è¡Œæ¯”è¾ƒï¼ˆä½¿ç”¨ DPDK 18.05 ç‰ˆæœ¬é™„å¸¦çš„ testpmd ç¤ºä¾‹åº”ç”¨ç¨‹åºï¼‰ã€‚æˆ‘ä»¬ä¸“æ³¨äºåŸå§‹æ•°æ®åŒ…å¤„ç†æ€§èƒ½ï¼Œä½¿ç”¨åˆæˆåŸºå‡†æµ‹è¯•ï¼Œå¹¶å°†å…¶ä¸ Linux å†…æ ¸ç½‘ç»œå †æ ˆçš„æ€§èƒ½è¿›è¡Œæ¯”è¾ƒï¼Œä»¥å±•ç¤º XDP åœ¨åŒä¸€ç³»ç»Ÿä¸­æä¾›çš„æ€§èƒ½æ”¹è¿›ã€‚åœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†é€šè¿‡ä¸€äº›åœ¨ XDP ä¹‹ä¸Šå®ç°çš„å®é™…åº”ç”¨ç¤ºä¾‹æ¥è¡¥å……è¿™äº›åŸå§‹æ€§èƒ½åŸºå‡†æµ‹è¯•ï¼Œä»¥å±•ç¤ºå…¶åœ¨ç¼–ç¨‹æ¨¡å‹ä¸­çš„å¯è¡Œæ€§ã€‚ Packet drop performance æ•°æ®åŒ…ä¸¢å¼ƒæ€§èƒ½ã€‚ä¸ºäº†å±•ç¤ºæœ€å¤§æ•°æ®åŒ…å¤„ç†æ€§èƒ½ï¼Œæˆ‘ä»¬æµ‹é‡ä¸¢å¼ƒä¼ å…¥æ•°æ®åŒ…çš„æœ€ç®€å•æ“ä½œçš„æ€§èƒ½ã€‚è¿™å®é™…ä¸Šæµ‹é‡äº†æ•´ä¸ªç³»ç»Ÿçš„å¼€é”€ï¼Œå¹¶ä½œä¸ºå®é™…æ•°æ®åŒ…å¤„ç†åº”ç”¨ç¨‹åºé¢„æœŸæ€§èƒ½çš„ä¸Šé™ã€‚ CPU usage CPU ä½¿ç”¨ç‡ã€‚å¦‚å¼•è¨€ä¸­æ‰€è¿°ï¼ŒXDP çš„ä¼˜ç‚¹ä¹‹ä¸€æ˜¯å®ƒæ ¹æ®æ•°æ®åŒ…è´Ÿè½½æ‰©å±• CPU ä½¿ç”¨ç‡ï¼Œè€Œä¸æ˜¯ä¸“é—¨ä¸ºæ•°æ®åŒ…å¤„ç†åˆ†é… CPU æ ¸å¿ƒã€‚æˆ‘ä»¬é€šè¿‡æµ‹é‡ CPU ä½¿ç”¨ç‡å¦‚ä½•éšæä¾›çš„ç½‘ç»œè´Ÿè½½æ‰©å±•æ¥é‡åŒ–è¿™ä¸€ç‚¹ã€‚ Packet forwarding performance æ•°æ®åŒ…è½¬å‘æ€§èƒ½ã€‚ä¸€ä¸ªä¸èƒ½è½¬å‘æ•°æ®åŒ…çš„æ•°æ®åŒ…å¤„ç†ç³»ç»Ÿå®ç”¨æ€§æœ‰é™ã€‚ç”±äºè½¬å‘å¼•å…¥äº†ä¸ç®€å•å¤„ç†æƒ…å†µç›¸æ¯”çš„é¢å¤–å¤æ‚æ€§ï¼ˆä¾‹å¦‚ï¼Œä¸å¤šä¸ªç½‘ç»œé€‚é…å™¨äº¤äº’ï¼Œé‡å†™é“¾è·¯å±‚å¤´ç­‰ï¼‰ï¼Œå› æ­¤å•ç‹¬è¯„ä¼°è½¬å‘æ€§èƒ½æ˜¯æœ‰ç”¨çš„ã€‚æˆ‘ä»¬åœ¨è½¬å‘è¯„ä¼°ä¸­åŒ…æ‹¬ååé‡å’Œå»¶è¿Ÿã€‚ å¥‡æ€ªçš„æŒ‡æ ‡ï¼Œ æˆ‘ä»¬å·²ç»éªŒè¯ï¼Œåœ¨å…¨å°ºå¯¸ï¼ˆ1500 å­—èŠ‚ï¼‰æ•°æ®åŒ…çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„ç³»ç»Ÿå¯ä»¥åœ¨åŠç©ºé—²çš„å•ä¸ªæ ¸å¿ƒä¸Šä»¥çº¿é€Ÿï¼ˆ100 Gbpsï¼‰å¤„ç†æ•°æ®åŒ…ã€‚è¿™æ¸…æ¥šåœ°è¡¨æ˜ï¼ŒæŒ‘æˆ˜åœ¨äºæ¯ç§’å¤„ç†å¤§é‡æ•°æ®åŒ…ï¼Œæ­£å¦‚å…¶ä»–äººä¹ŸæŒ‡å‡ºçš„é‚£æ ·[46]ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨æœ€å°å°ºå¯¸ï¼ˆ64 å­—èŠ‚ï¼‰æ•°æ®åŒ…è¿›è¡Œæ‰€æœ‰æµ‹è¯•ï¼Œå¹¶æµ‹é‡ç³»ç»Ÿå¯ä»¥å¤„ç†çš„æœ€å¤§æ•°æ®åŒ…æ•°æ¯ç§’ã€‚ä¸ºäº†æµ‹é‡æ€§èƒ½å¦‚ä½•éš CPU æ ¸å¿ƒæ•°é‡æ‰©å±•ï¼Œæˆ‘ä»¬ä½¿ç”¨è¶Šæ¥è¶Šå¤šçš„ä¸“é—¨ç”¨äºæ•°æ®åŒ…å¤„ç†çš„æ ¸å¿ƒé‡å¤æµ‹è¯•ã€‚å¯¹äº XDP å’Œ Linux ç½‘ç»œå †æ ˆï¼ˆå®ƒä»¬æ²¡æœ‰æä¾›æ˜ç¡®çš„æ–¹å¼æ¥ä¸“é—¨ä¸ºæ•°æ®åŒ…å¤„ç†åˆ†é…æ ¸å¿ƒï¼‰ï¼Œæˆ‘ä»¬é€šè¿‡é…ç½®ç¡¬ä»¶æ¥æ”¶ç«¯æ‰©å±•ï¼ˆRSSï¼‰åŠŸèƒ½ï¼Œå°†æµé‡å¼•å¯¼åˆ°æ¯ä¸ªæµ‹è¯•æ‰€éœ€çš„å¤šä¸ªæ ¸å¿ƒæ¥å®ç°è¿™ä¸€ç‚¹ã€‚ ","date":"2024-09-18","objectID":"/posts/paper-xdp/:6:0","tags":["Paper Reading"],"title":"Paper Reading: The eXpress Data Path","uri":"/posts/paper-xdp/"},{"categories":null,"content":"Packet Drop Performance ","date":"2024-09-18","objectID":"/posts/paper-xdp/:6:1","tags":["Paper Reading"],"title":"Paper Reading: The eXpress Data Path","uri":"/posts/paper-xdp/"},{"categories":null,"content":"CPU Usage ","date":"2024-09-18","objectID":"/posts/paper-xdp/:6:2","tags":["Paper Reading"],"title":"Paper Reading: The eXpress Data Path","uri":"/posts/paper-xdp/"},{"categories":null,"content":"Packet Forwarding Performance é€‚ç”¨æ¡ˆä¾‹ï¼š è½¯ä»¶è·¯ç”±ï¼ˆXDP routingï¼‰ Linux å†…æ ¸å®ç°äº†ä¸€ä¸ªåŠŸèƒ½å®Œå…¨çš„è·¯ç”±è¡¨ï¼Œç”Ÿæ€ç³»ç»ŸåŠŸèƒ½ä¸°å¯Œï¼Œç»“åˆ XDP åŒ…å¤„ç†æ¡†æ¶å®ç°äº†ä¸€ä¸ªå®Œç¾çš„è·¯ç”±åŠŸèƒ½ã€‚å…¶æ€§èƒ½ä¸å¸¸è§„çš„ Linux å†…æ ¸ç½‘ç»œæ ˆç›¸æ¯”æå‡äº† 2.5 - 3 å€å·¦å³ã€‚ ACL/DDoS é˜²å¾¡ XDP å¯ä»¥ç›´æ¥åœ¨åº”ç”¨æœåŠ¡å™¨ä¸Šéƒ¨ç½²åŒ…è¿‡æ»¤ç¨‹åºæ¥é˜²å¾¡æ­¤ç±»æ”»å‡»ï¼Œæ— é¡»ä¿®æ”¹åº”ç”¨ä»£ç ã€‚å¦‚æœåº”ç”¨éƒ¨ç½²åœ¨è™šæ‹Ÿæœºé‡Œï¼ŒXDP ç¨‹åºè¿˜å¯ä»¥éƒ¨ç½²åœ¨å®¿ä¸»æœºä¸Šï¼Œä¿æŠ¤æœºå™¨ä¸Šæ‰€æœ‰çš„è™šæ‹Ÿæœºã€‚å…¶æ€§èƒ½å•æ ¸å¯ä»¥è½»æ¾å¤„ç† 10Gbps çš„æœ€å°åŒ… Dos æµé‡ã€‚è¿™ç§ DDOS é˜²å¾¡çš„éƒ¨ç½²æ›´åŠ çµæ´»ã€‚ ç›¸æ¯” iptables ç›¸å¯¹è¾ƒæ™šçš„ hook ç‚¹ï¼ŒXDP çš„ä¸¢åŒ…é€Ÿç‡è¦æ¯” iptables é«˜ 4 å€å·¦å³ã€‚ è´Ÿè½½å‡è¡¡ï¼ˆload balancingï¼‰ å…¶åŸç†æ˜¯é€šè¿‡å¯¹åŒ…å¤´è¿›è¡Œå“ˆå¸Œï¼Œä»¥æ­¤é€‰æ‹©ç›®æ ‡åº”ç”¨æœåŠ¡å™¨ï¼Œç„¶åå°†æ•°æ®åŒ…è¿›è¡Œå°è£…ï¼Œå‘é€ç»™åº”ç”¨æœåŠ¡å™¨ï¼Œåº”ç”¨è§£å°ï¼Œå¤„ç†è¯·æ±‚ï¼Œä¼šåŒ…ç»™å®¢æˆ·ç«¯ã€‚åœ¨æ¬¡è¿‡ç¨‹ä¸­ï¼ŒXDP æœåŠ¡å“ˆå¸Œï¼Œå°åŒ…å‘é€ã€‚é€šè¿‡ bpf map è¿›è¡Œé…ç½®ï¼Œå…¶æ€§èƒ½æ¯” Linux å†…æ ¸ IPVS é«˜ 4 å€å·¦å³ã€‚ XDP å…è®¸ä½¿ç”¨ BPFï¼ˆBerkeley Packet Filterï¼‰ç¨‹åºè¿›è¡Œæ•°æ®åŒ…å¤„ç†ï¼Œè¿™äº›ç¨‹åºå¯ä»¥åŠ¨æ€åŠ è½½å’Œæ›´æ–°ï¼Œæä¾›äº†æå¤§çš„çµæ´»æ€§ã€‚ é€‚ç”¨æ€§å¼ºã€‚é«˜äº 4.8 ç‰ˆæœ¬çš„å†…æ ¸å’Œç»å¤§å¤šæ•°é«˜é€Ÿç½‘å¡éƒ½æ˜¯æ”¯æŒ XDP çš„ï¼Œæ— éœ€ä¸“æœ‰ç¡¬ä»¶çš„æ”¯æŒã€‚ 2021 å¹´ï¼ŒYoann Ghigoff ç­‰äººæ›´æ˜¯åŸºäº eBPF å’Œ XDPã€TC åœ¨å†…æ ¸ä¸­å®ç°äº†ä¸€å±‚ Memcached çš„ç¼“å­˜ï¼Œè¾¾åˆ°äº†æ¯” DPDK å†…æ ¸æ—è·¯æ–¹æ¡ˆè¿˜è¦é«˜çš„æ€§èƒ½ã€‚æ™ºèƒ½ç½‘å¡ä¹Ÿå¼€å§‹å¯¹ eBPF å¸è½½è¿›è¡Œäº†æ”¯æŒï¼Œå°†åŒ…å¤„ç†è¿›ä¸€æ­¥ä»ç½‘å¡é©±åŠ¨å±‚å¸è½½åˆ°äº†ç½‘å¡ï¼Œé‡Šæ”¾äº†æ›´å¤šçš„ä¸»æœº CPU èµ„æºï¼Œå®ç°æ›´é«˜çš„æ€§èƒ½ã€‚æˆ‘ä»¬å¸¸ç”¨çš„è™šæ‹Ÿäº¤æ¢æœº OVS çš„å›¢é˜Ÿä¹Ÿåœ¨ 2.12.0 ç‰ˆæœ¬å°±å¼€å§‹å¯¹ AF_XDP è¿›è¡Œæ¢ç´¢ï¼Œåœ¨ 2021 å¹´ SIGCOMM ä¼šè®®ä¸Šï¼Œå‘è¡¨äº†è¿™äº›å¹´ä»–ä»¬å¯¹äºæ•°æ®é¢çš„æ¢ç´¢ï¼Œå°† AF_XDP é€‰å‹ç”¨äºå…¶æ•°æ®é¢ï¼Œè§£å†³äº†å¾ˆå¤š DPDK è§£å†³ä¸äº†çš„é—®é¢˜ã€‚å…¶ä»–çš„åº”ç”¨åœºæ™¯å¦‚è´Ÿè½½å‡è¡¡ã€æµé‡‡æ ·å’Œç›‘æ§â€¦â€¦æ›´å¤šçš„å¯èƒ½æ­£åœ¨è¢«å­¦æœ¯å’Œå·¥ä¸šç•Œæ¢ç´¢ã€‚ https://cloud.tencent.com/developer/article/1909298 ","date":"2024-09-18","objectID":"/posts/paper-xdp/:6:3","tags":["Paper Reading"],"title":"Paper Reading: The eXpress Data Path","uri":"/posts/paper-xdp/"},{"categories":null,"content":"Conclusion XDP è®ºæ–‡çœ‹èµ·æ¥åªæ˜¯ CPU æ¶ˆè€—å¥½å¾ˆå¤šï¼Œä½†ä»–çš„æ„ä¹‰åœ¨äºï¼ŒçœŸçš„åˆå…¥äº†å†…æ ¸ï¼Œå¼€æºï¼Œè€Œä¸”å±äºæ˜¯é‡Œç¨‹ç¢‘çœŸçš„å¼•èµ·äº†åç»­çš„å¤šç§æŠ€æœ¯å‘å±•ï¼ŒAF_XDP ç­‰ç­‰ ","date":"2024-09-18","objectID":"/posts/paper-xdp/:7:0","tags":["Paper Reading"],"title":"Paper Reading: The eXpress Data Path","uri":"/posts/paper-xdp/"},{"categories":null,"content":"Arrakis: The Operating System is the Control Plane å’Œ IX åŒæ ·æ˜¯ OSDI 14 çš„æ–‡ç« ï¼ŒArrakis åº”è¯¥ä¹Ÿæ˜¯ Dune æ²™ä¸˜é‡Œçš„åå­—å§ï¼Œä½†å¥½åƒä¸æ˜¯åŒä¸€æ‰¹äºº Adam Belay Standford çš„äººåšçš„ï¼Œåº”è¯¥å¾ˆç±»ä¼¼ã€‚ åŒæ ·æ˜¯ç”¨è™šæ‹ŸåŒ–æŠ€æœ¯ï¼Œ ","date":"2024-09-16","objectID":"/posts/paper-arrakis/:1:0","tags":["Paper Reading"],"title":"Paper Reading: Arrakis","uri":"/posts/paper-arrakis/"},{"categories":null,"content":"Abstract åº”ç”¨ç¨‹åºå¯ä»¥ç›´æ¥è®¿é—®è™šæ‹ŸåŒ–çš„ I/O è®¾å¤‡ï¼Œå…è®¸å¤§å¤šæ•° I/O æ“ä½œå®Œå…¨è·³è¿‡å†…æ ¸ï¼Œè€Œå†…æ ¸è¢«é‡æ–°è®¾è®¡ä»¥æä¾›ç½‘ç»œå’Œç£ç›˜ä¿æŠ¤ï¼Œ ","date":"2024-09-16","objectID":"/posts/paper-arrakis/:2:0","tags":["Paper Reading"],"title":"Paper Reading: Arrakis","uri":"/posts/paper-arrakis/"},{"categories":null,"content":"Introduction é«˜é€Ÿä»¥å¤ªç½‘å’Œä½å»¶è¿ŸæŒä¹…å†…å­˜çš„ç»“åˆæ˜¾è‘—æé«˜äº† I/O å¯†é›†å‹è½¯ä»¶çš„æ•ˆç‡æ ‡å‡† è®¸å¤šæœåŠ¡å™¨çš„å¤§éƒ¨åˆ†æ—¶é—´éƒ½ç”¨äºæ‰§è¡Œæ“ä½œç³»ç»Ÿä»£ç ï¼šä¼ é€’ä¸­æ–­ã€demultiplexing å¤šè·¯åˆ†è§£ã€å’Œå¤åˆ¶ç½‘ç»œæ•°æ®åŒ…ï¼Œä»¥åŠç»´æŠ¤æ–‡ä»¶ç³»ç»Ÿå…ƒæ•°æ®ã€‚æœåŠ¡å™¨åº”ç”¨ç¨‹åºé€šå¸¸æ‰§è¡Œéå¸¸ç®€å•çš„åŠŸèƒ½ï¼Œå¦‚é”®å€¼è¡¨çš„æŸ¥æ‰¾å’Œå­˜å‚¨ï¼Œä½†åœ¨æ¯æ¬¡å®¢æˆ·ç«¯è¯·æ±‚æ—¶éƒ½ä¼šå¤šæ¬¡ç©¿è¶Šæ“ä½œç³»ç»Ÿå†…æ ¸ã€‚ è¿™äº›è¶‹åŠ¿å¯¼è‡´äº†ä¸€ç³»åˆ—é’ˆå¯¹å„ç§ç”¨ä¾‹ä¼˜åŒ–å†…æ ¸ä»£ç è·¯å¾„çš„ç ”ç©¶ï¼šæ¶ˆé™¤å†…æ ¸ä¸­çš„å†—ä½™å‰¯æœ¬[45]ï¼Œå‡å°‘å¤§é‡è¿æ¥çš„å¼€é”€[27]ï¼Œåè®®ä¸“ä¸šåŒ–[44]ï¼Œèµ„æºå®¹å™¨[8, 39]ï¼Œç£ç›˜å’Œç½‘ç»œç¼“å†²åŒºä¹‹é—´çš„ç›´æ¥ä¼ è¾“[45]ï¼Œä¸­æ–­è½¬å‘[46]ï¼Œç³»ç»Ÿè°ƒç”¨æ‰¹å¤„ç†[49]ï¼Œç¡¬ä»¶ TCP åŠ é€Ÿç­‰ã€‚å…¶ä¸­è®¸å¤šæŠ€æœ¯å·²è¢«ä¸»æµå•†ä¸šæ“ä½œç³»ç»Ÿé‡‡ç”¨ï¼Œä½†è¿™æ˜¯ä¸€åœºå¤±è´¥çš„æˆ˜æ–—ï¼šæˆ‘ä»¬å±•ç¤ºäº† Linux ç½‘ç»œå’Œæ–‡ä»¶ç³»ç»Ÿå †æ ˆçš„å»¶è¿Ÿå’Œååé‡è¿œä¸å¦‚ç¡¬ä»¶åŸå§‹æ€§èƒ½ã€‚ I/O å¯†é›†å‹ï¼Œæ¯”å¦‚ç½‘ç»œæœåŠ¡å™¨ï¼Ÿ äºŒåå¹´å‰ï¼Œç ”ç©¶äººå‘˜æå‡ºé€šè¿‡å°†ç½‘ç»œç¡¬ä»¶ç›´æ¥æ˜ å°„åˆ°ç”¨æˆ·ç©ºé—´æ¥ç®€åŒ–å¹¶è¡Œè®¡ç®—ä¸­çš„æ•°æ®åŒ…å¤„ç†ï¼Œä»¥å®ç°å·¥ä½œç«™ç½‘ç»œçš„å¹¶è¡Œè®¡ç®—[19, 22, 54]ã€‚å°½ç®¡åœ¨å½“æ—¶å•†ä¸šä¸Šå¹¶ä¸æˆåŠŸï¼Œä½†è™šæ‹ŸåŒ–å¸‚åœºçš„å…´èµ·ä¿ƒä½¿ç¡¬ä»¶ä¾›åº”å•†é‡æ–°è€ƒè™‘è¿™ä¸€æƒ³æ³•[6, 38, 48]ï¼Œå¹¶å°†å…¶æ‰©å±•åˆ°ç£ç›˜[52, 53]ã€‚ ç£ç›˜æ˜¯ä»€ä¹ˆåšæ³•ï¼Ÿ æœ¬æ–‡æ¢è®¨äº†åœ¨å‡ ä¹æ‰€æœ‰ I/O æ“ä½œä¸­å°†å†…æ ¸ä»æ•°æ®è·¯å¾„ä¸­ç§»é™¤çš„æ“ä½œç³»ç»Ÿå«ä¹‰ã€‚æˆ‘ä»¬è®¤ä¸ºï¼Œè¿™æ ·åšå¿…é¡»ä¸ºåº”ç”¨ç¨‹åºæä¾›ä¸ä¼ ç»Ÿè®¾è®¡ç›¸åŒçš„å®‰å…¨æ¨¡å‹ï¼›é€šè¿‡æ‰©å±•å¯ä¿¡è®¡ç®—åŸºç¡€ä»¥åŒ…æ‹¬åº”ç”¨ç¨‹åºä»£ç ï¼Œä¾‹å¦‚å…è®¸åº”ç”¨ç¨‹åºæœªç»æ»¤ç›´æ¥è®¿é—®ç½‘ç»œ/ç£ç›˜ï¼Œå¾ˆå®¹æ˜“è·å¾—è‰¯å¥½çš„æ€§èƒ½ã€‚æˆ‘ä»¬è¯æ˜äº†æ“ä½œç³»ç»Ÿçš„ä¿æŠ¤ä¸é«˜æ€§èƒ½å¹¶ä¸çŸ›ç›¾ã€‚åœ¨æˆ‘ä»¬çš„åŸå‹å®ç°ä¸­ï¼Œå¯¹ Redis æŒä¹…åŒ– NoSQL å­˜å‚¨çš„å®¢æˆ·ç«¯è¯·æ±‚åœ¨è¯»å–å»¶è¿Ÿæ–¹é¢æé«˜äº† 2 å€ï¼Œå†™å…¥å»¶è¿Ÿæé«˜äº† 5 å€ï¼Œå†™å…¥ååé‡æé«˜äº† 9 å€ï¼Œç›¸æ¯” Linuxã€‚ å’Œ IX æˆ–è€…è¯´å†…æ ¸æ€ç½‘ç»œæ ˆä¸€æ ·çš„æ€è·¯ï¼Ÿä½†æ˜¯ä¼˜åŒ–äº† Redis çœ‹ç€å¾ˆæœ‰æ„æ€ï¼Œä¸€ä¸ªå†…å­˜ NoSQL æˆ‘ä»¬åšå‡ºäº†ä¸‰ä¸ªå…·ä½“çš„è´¡çŒ®ï¼š â€¢ æˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªæ¶æ„ï¼Œç”¨äºåˆ’åˆ†è®¾å¤‡ç¡¬ä»¶ã€å†…æ ¸å’Œè¿è¡Œæ—¶åœ¨éç‰¹æƒè¿›ç¨‹ç›´æ¥è¿›è¡Œç½‘ç»œå’Œç£ç›˜ I/O æ—¶çš„åˆ†å·¥ï¼Œå¹¶å±•ç¤ºäº†å¦‚ä½•é«˜æ•ˆåœ°æ¨¡æ‹Ÿæˆ‘ä»¬çš„æ¨¡å‹ï¼Œä»¥é€‚åº”ä¸å®Œå…¨æ”¯æŒè™šæ‹ŸåŒ–çš„ I/O è®¾å¤‡ï¼ˆÂ§3ï¼‰ã€‚ â€¢ æˆ‘ä»¬å°†æˆ‘ä»¬çš„æ¨¡å‹å®ç°ä¸ºä¸€ä¸ªå¼€æº Barrelfish æ“ä½œç³»ç»Ÿçš„ä¿®æ”¹é›†ï¼Œè¿è¡Œåœ¨å•†ä¸šå¯ç”¨çš„å¤šæ ¸è®¡ç®—æœºå’Œ I/O è®¾å¤‡ç¡¬ä»¶ä¸Šï¼ˆÂ§3.8ï¼‰ã€‚ â€¢ æˆ‘ä»¬ä½¿ç”¨æˆ‘ä»¬çš„åŸå‹æ¥é‡åŒ–ç”¨æˆ·çº§ I/O å¯¹å‡ ç§å¹¿æ³›ä½¿ç”¨çš„ç½‘ç»œæœåŠ¡çš„æ½œåœ¨å¥½å¤„ï¼ŒåŒ…æ‹¬åˆ†å¸ƒå¼å¯¹è±¡ç¼“å­˜ã€Redisã€IP å±‚ä¸­é—´ç›’å’Œ HTTP è´Ÿè½½å‡è¡¡å™¨ï¼ˆÂ§4ï¼‰ã€‚æˆ‘ä»¬å±•ç¤ºäº†åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œç›¸å¯¹äº Linuxï¼Œåœ¨å»¶è¿Ÿå’Œå¯æ‰©å±•æ€§æ–¹é¢å¯ä»¥è·å¾—æ˜¾è‘—çš„æå‡ï¼Œè€Œæ— éœ€ä¿®æ”¹åº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£ï¼›é€šè¿‡æ”¹å˜ POSIX API å¯ä»¥è·å¾—é¢å¤–çš„æ”¶ç›Šï¼ˆÂ§4.3ï¼‰ã€‚ åŸºäº Barrelfish åšçš„ï¼Œä¹Ÿå°±æ˜¯ exokernelï¼Œæ˜¯ Multikernelï¼Œåˆ©ç”¨ä¿¡æ¯ä¼ é€’ï¼Œä¹Ÿæ˜¯åŒºåˆ†äº† user space å’Œ kernel spaceï¼Œæ¯ä¸ªæ ¸å¿ƒæœ‰è‡ªå·±çš„ kernel å’Œ IX åŒºåˆ«æ˜¯ä¸æ˜¯åŸºäº Duneï¼Œä¸è¿‡åŒæ ·çš„éƒ½æ˜¯åšäº†åˆ†å¸ƒå¼å¯¹è±¡ç¼“å­˜ã€Redisã€IP å±‚ä¸­é—´ç›’å’Œ HTTP è´Ÿè½½å‡è¡¡å™¨ï¼Œå»¶è¿Ÿä¼˜åŒ–çš„åŒæ—¶ä¸éœ€è¦ä¿®æ”¹ç¨‹åºæ¥å£ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ ","date":"2024-09-16","objectID":"/posts/paper-arrakis/:3:0","tags":["Paper Reading"],"title":"Paper Reading: Arrakis","uri":"/posts/paper-arrakis/"},{"categories":null,"content":"Background æˆ‘ä»¬é¦–å…ˆè¯¦ç»†åˆ†æäº†å½“å‰ç½‘ç»œå’Œå­˜å‚¨æ“ä½œä¸­çš„æ“ä½œç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºå¼€é”€ï¼Œéšåè®¨è®ºäº†æ”¯æŒç”¨æˆ·çº§ç½‘ç»œå’Œ I/O è™šæ‹ŸåŒ–çš„å½“å‰ç¡¬ä»¶æŠ€æœ¯ã€‚ ","date":"2024-09-16","objectID":"/posts/paper-arrakis/:4:0","tags":["Paper Reading"],"title":"Paper Reading: Arrakis","uri":"/posts/paper-arrakis/"},{"categories":null,"content":"Networking Stack Overheads Linux è¿›ç¨‹å®ç°çš„ UDP å›æ˜¾æœåŠ¡å™¨ â€¢ ç½‘ç»œæ ˆæˆæœ¬ï¼šç¡¬ä»¶ã€IP å’Œ UDP å±‚çš„æ•°æ®åŒ…å¤„ç†ã€‚ â€¢ è°ƒåº¦å™¨å¼€é”€ï¼šå”¤é†’è¿›ç¨‹ï¼ˆå¦‚æœéœ€è¦ï¼‰ï¼Œé€‰æ‹©å®ƒè¿è¡Œï¼Œå¹¶åˆ‡æ¢åˆ°å®ƒã€‚ â€¢ å†…æ ¸ç©¿è¶Šï¼šä»å†…æ ¸åˆ°ç”¨æˆ·ç©ºé—´ï¼Œå†è¿”å›ã€‚ â€¢ æ•°æ®åŒ…æ•°æ®çš„å¤åˆ¶ï¼šåœ¨æ¥æ”¶æ—¶ä»å†…æ ¸å¤åˆ¶åˆ°ç”¨æˆ·ç¼“å†²åŒºï¼Œåœ¨å‘é€æ—¶è¿”å›ã€‚ åœ¨ Linux ä¸­ï¼Œå¤„ç†æ¯ä¸ªæ•°æ®åŒ…æ€»å…±èŠ±è´¹ 3.36 å¾®ç§’ï¼ˆè§è¡¨ 1ï¼‰ï¼Œå…¶ä¸­è¿‘ 70%çš„æ—¶é—´èŠ±åœ¨ç½‘ç»œæ ˆä¸­ã€‚è¿™é¡¹å·¥ä½œä¸»è¦æ˜¯è½¯ä»¶å¤šè·¯åˆ†è§£ã€å®‰å…¨æ£€æŸ¥ä»¥åŠç”±äºå„å±‚é—´æ¥å¯¼è‡´çš„å¼€é”€ã€‚å†…æ ¸å¿…é¡»éªŒè¯ä¼ å…¥æ•°æ®åŒ…çš„å¤´éƒ¨ï¼Œå¹¶åœ¨åº”ç”¨ç¨‹åºå‘é€æ•°æ®åŒ…æ—¶å¯¹æä¾›çš„å‚æ•°è¿›è¡Œå®‰å…¨æ£€æŸ¥ã€‚æ ˆè¿˜åœ¨å±‚è¾¹ç•Œæ‰§è¡Œæ£€æŸ¥ã€‚ è°ƒåº¦å™¨å¼€é”€åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºæ¥æ”¶è¿›ç¨‹å½“å‰æ˜¯å¦æ­£åœ¨è¿è¡Œã€‚å¦‚æœæ˜¯ï¼Œåªæœ‰ 5%çš„å¤„ç†æ—¶é—´èŠ±åœ¨è°ƒåº¦å™¨ä¸Šï¼›å¦‚æœä¸æ˜¯ï¼Œä»ç©ºé—²è¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢åˆ°æœåŠ¡å™¨è¿›ç¨‹ä¼šå¢åŠ é¢å¤–çš„ 2.2 å¾®ç§’ï¼Œç½‘ç»œæ ˆçš„å…¶ä»–éƒ¨åˆ†è¿˜ä¼šè¿›ä¸€æ­¥å‡æ…¢ 0.6 å¾®ç§’ã€‚ å¤šæ ¸ç³»ç»Ÿä¸Šçš„ç¼“å­˜å’Œé”äº‰ç”¨é—®é¢˜å¢åŠ äº†è¿›ä¸€æ­¥çš„å¼€é”€ï¼Œå¹¶ä¸”ç”±äºç½‘ç»œå¡å¯ä»¥å°†ä¼ å…¥æ¶ˆæ¯ä¼ é€’åˆ°ä¸åŒçš„é˜Ÿåˆ—ï¼Œå¯¼è‡´å®ƒä»¬ç”±ä¸åŒçš„ CPU æ ¸å¿ƒå¤„ç†ï¼Œè¿™åŠ å‰§äº†é—®é¢˜â€”â€”è¿™äº›æ ¸å¿ƒå¯èƒ½ä¸ç”¨æˆ·çº§è¿›ç¨‹è°ƒåº¦çš„æ ¸å¿ƒä¸åŒï¼Œå¦‚å›¾ 1 æ‰€ç¤ºã€‚é«˜çº§ç¡¬ä»¶æ”¯æŒï¼Œå¦‚åŠ é€Ÿæ¥æ”¶æµè½¬å‘[4]ï¼Œæ—¨åœ¨å‡è½»è¿™ç§æˆæœ¬ï¼Œä½†è¿™äº›è§£å†³æ–¹æ¡ˆæœ¬èº«ä¼šå¸¦æ¥éåŒå°å¯çš„è®¾ç½®æˆæœ¬[46]ã€‚ å¤šæ ¸å¿ƒæ˜¯æ€ä¹ˆåšçš„ï¼Œè¿™ä¸ªæ˜¯ç¬¬ä¸€æ¬¡æ¥è§¦çš„åœºæ™¯ï¼Œå¦‚ä½•ä¿æŒä¸€è‡´æ€§ï¼Ÿ é€šè¿‡åˆ©ç”¨ç¡¬ä»¶æ”¯æŒå°†å†…æ ¸ä»æ•°æ®å¹³é¢ä¸­ç§»é™¤ï¼ŒArrakis å¯ä»¥å®Œå…¨æ¶ˆé™¤æŸäº›ç±»åˆ«çš„å¼€é”€ï¼Œå¹¶æœ€å°åŒ–å…¶ä»–å¼€é”€çš„å½±å“ã€‚è¡¨ 1 è¿˜æ˜¾ç¤ºäº† Arrakis ä¸¤ç§å˜ä½“çš„ç›¸åº”å¼€é”€ã€‚Arrakis å®Œå…¨æ¶ˆé™¤äº†è°ƒåº¦å’Œå†…æ ¸ç©¿è¶Šå¼€é”€ï¼Œå› ä¸ºæ•°æ®åŒ…ç›´æ¥ä¼ é€’åˆ°ç”¨æˆ·ç©ºé—´ã€‚å½“ç„¶ï¼Œç½‘ç»œæ ˆå¤„ç†ä»ç„¶æ˜¯å¿…éœ€çš„ï¼Œä½†å®ƒå¤§å¤§ç®€åŒ–äº†ï¼šä¸å†éœ€è¦ä¸ºä¸åŒåº”ç”¨ç¨‹åºå¤šè·¯åˆ†è§£æ•°æ®åŒ…ï¼Œç”¨æˆ·çº§ç½‘ç»œæ ˆä¹Ÿä¸éœ€è¦åƒå†…æ ¸å®ç°é‚£æ ·å¹¿æ³›åœ°éªŒè¯ç”¨æˆ·æä¾›çš„å‚æ•°ã€‚å› ä¸ºæ¯ä¸ªåº”ç”¨ç¨‹åºéƒ½æœ‰å•ç‹¬çš„ç½‘ç»œæ ˆï¼Œå¹¶ä¸”æ•°æ®åŒ…ä¼ é€’åˆ°åº”ç”¨ç¨‹åºè¿è¡Œçš„æ ¸å¿ƒï¼Œé”äº‰ç”¨å’Œç¼“å­˜æ•ˆåº”å‡å°‘äº†ã€‚ å·®ä¸å¤šçš„æ€è·¯ åœ¨ Arrakis ç½‘ç»œæ ˆä¸­ï¼Œå°†æ•°æ®åŒ…æ•°æ®å¤åˆ¶åˆ°ç”¨æˆ·æä¾›çš„ç¼“å†²åŒºå¹¶ä»ä¸­å¤åˆ¶çš„æ—¶é—´ä¸»å¯¼äº†å¤„ç†æˆæœ¬ï¼Œè¿™æ˜¯ POSIX æ¥å£ï¼ˆArrakis/Pï¼‰ä¸ NIC æ•°æ®åŒ…é˜Ÿåˆ—ä¹‹é—´ä¸åŒ¹é…çš„ç»“æœã€‚åˆ°è¾¾çš„æ•°æ®é¦–å…ˆç”±ç½‘ç»œç¡¬ä»¶æ”¾å…¥ç½‘ç»œç¼“å†²åŒºï¼Œç„¶åå¤åˆ¶åˆ° POSIX è¯»å–è°ƒç”¨æŒ‡å®šçš„ä½ç½®ã€‚è¦ä¼ è¾“çš„æ•°æ®è¢«ç§»åŠ¨åˆ°å¯ä»¥æ”¾å…¥ç½‘ç»œç¡¬ä»¶é˜Ÿåˆ—çš„ç¼“å†²åŒºä¸­ï¼›ç„¶å POSIX å†™å…¥å¯ä»¥è¿”å›ï¼Œå…è®¸åœ¨æ•°æ®å‘é€ä¹‹å‰é‡ç”¨ç”¨æˆ·å†…å­˜ã€‚å°½ç®¡ç ”ç©¶äººå‘˜å·²ç»ç ”ç©¶äº†ä»å†…æ ¸ç½‘ç»œæ ˆä¸­æ¶ˆé™¤è¿™ç§å¤åˆ¶çš„æ–¹æ³•[45]ï¼Œå¦‚è¡¨ 1 æ‰€ç¤ºï¼Œå†…æ ¸é©»ç•™ç½‘ç»œæ ˆçš„å¤§éƒ¨åˆ†å¼€é”€åœ¨å…¶ä»–åœ°æ–¹ã€‚ä¸€æ—¦æ¶ˆé™¤äº†ç©¿è¶Šå†…æ ¸çš„å¼€é”€ï¼Œå°±æœ‰æœºä¼šé‡æ–°æ€è€ƒ POSIX API ä»¥å®ç°æ›´é«˜æ•ˆçš„ç½‘ç»œã€‚é™¤äº† POSIX å…¼å®¹æ¥å£å¤–ï¼ŒArrakis è¿˜æä¾›äº†ä¸€ä¸ªæœ¬åœ°æ¥å£ï¼ˆArrakis/Nï¼‰ï¼Œæ”¯æŒçœŸæ­£çš„é›¶æ‹·è´ I/Oã€‚ åŒæ ·ä½¿ç”¨äº†é›¶æ‹·è´æŠ€æœ¯ï¼Œarrakis è‡ªå·±æä¾›äº†ä¸€ä¸ªé›¶æ‹·è´ï¼Œæ˜¯æ€ä¹ˆåšçš„ï¼Ÿ ","date":"2024-09-16","objectID":"/posts/paper-arrakis/:4:1","tags":["Paper Reading"],"title":"Paper Reading: Arrakis","uri":"/posts/paper-arrakis/"},{"categories":null,"content":"Storage Stack Overheads fsync æµ‹è¯•ï¼Œå®é™…ä¸Šå°±æ˜¯æµ‹ IO å»¶è¿Ÿå†™ ä¼ ç»Ÿçš„ UNIX å®ç°çš„å†…æ ¸ä¸­éƒ½è®¾ç½®æœ‰ç¼“å†²åŒºæˆ–è€…é¡µé¢é«˜é€Ÿç¼“å­˜ï¼Œå¤§å¤šæ•°ç£ç›˜ IO éƒ½æ˜¯é€šè¿‡ç¼“å†²å†™çš„ã€‚ å½“ä½ æƒ³å°†æ•°æ® write è¿›æ–‡ä»¶æ—¶ï¼Œå†…æ ¸é€šå¸¸ä¼šå°†è¯¥æ•°æ®å¤åˆ¶åˆ°å…¶ä¸­ä¸€ä¸ªç¼“å†²åŒºä¸­ï¼Œå¦‚æœè¯¥ç¼“å†²æ²¡è¢«å†™æ»¡çš„è¯ï¼Œå†…æ ¸å°±ä¸ä¼šæŠŠå®ƒæ”¾å…¥åˆ°è¾“å‡ºé˜Ÿåˆ—ä¸­ã€‚ å½“è¿™ä¸ªç¼“å†²åŒºè¢«å†™æ»¡æˆ–è€…å†…æ ¸æƒ³é‡ç”¨è¿™ä¸ªç¼“å†²åŒºæ—¶ï¼Œæ‰ä¼šå°†å…¶æ’åˆ°è¾“å‡ºé˜Ÿåˆ—ä¸­ã€‚ç­‰å®ƒåˆ°è¾¾ç­‰å¾…é˜Ÿåˆ—é¦–éƒ¨æ—¶æ‰ä¼šè¿›è¡Œå®é™…çš„ IO æ“ä½œã€‚ ","date":"2024-09-16","objectID":"/posts/paper-arrakis/:4:2","tags":["Paper Reading"],"title":"Paper Reading: Arrakis","uri":"/posts/paper-arrakis/"},{"categories":null,"content":"Application Overheads NoSQL æµ‹è¯• ","date":"2024-09-16","objectID":"/posts/paper-arrakis/:4:3","tags":["Paper Reading"],"title":"Paper Reading: Arrakis","uri":"/posts/paper-arrakis/"},{"categories":null,"content":"Hardware I/O Virtualization Single-Root I/O Virtualization (SR-IOV) å¹¶é€šè¿‡ IOMMUï¼ˆä¾‹å¦‚ Intel çš„ VT-d [34]ï¼‰è¿›è¡Œè®¿é—®ä¿æŠ¤ åœ¨ Arrakis ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ SR-IOVã€IOMMU å’Œæ”¯æŒé€‚é…å™¨æ¥æä¾›å¯¹ I/O è®¾å¤‡çš„ç›´æ¥åº”ç”¨ç¨‹åºçº§è®¿é—®ã€‚è¿™æ˜¯ 20 å¹´å‰ä½¿ç”¨ U-Net [54]å®ç°çš„ä¸€ä¸ªæƒ³æ³•çš„ç°ä»£å®ç°ï¼Œä½†å·²æ¨å¹¿åˆ°é—ªå­˜å­˜å‚¨å’Œä»¥å¤ªç½‘ç½‘ç»œé€‚é…å™¨ã€‚ åŒæ ·ä½¿ç”¨è™šæ‹ŸåŒ–æŠ€æœ¯ï¼Œè®©åº”ç”¨å¯ä»¥ç›´æ¥è®¿é—® IO è®¾å¤‡ è™½ç„¶ RDMA ä¸ºå¹¶è¡Œåº”ç”¨ç¨‹åºæä¾›äº†ç”¨æˆ·çº§ç½‘ç»œçš„æ€§èƒ½ä¼˜åŠ¿ï¼Œä½†å°†å…¶æ¨¡å‹åº”ç”¨äºæ›´å¹¿æ³›çš„å®¢æˆ·ç«¯-æœåŠ¡å™¨åº”ç”¨ç¨‹åº[21]å…·æœ‰æŒ‘æˆ˜æ€§ã€‚æœ€é‡è¦çš„æ˜¯ï¼ŒRDMA æ˜¯ç‚¹å¯¹ç‚¹çš„ã€‚æ¯ä¸ªå‚ä¸è€…æ¥æ”¶ä¸€ä¸ªè®¤è¯å™¨ï¼Œæˆäºˆå…¶è¿œç¨‹è¯»/å†™ç‰¹å®šå†…å­˜åŒºåŸŸçš„æƒé™ã€‚ç”±äºå®¢æˆ·ç«¯-æœåŠ¡å™¨è®¡ç®—ä¸­çš„å®¢æˆ·ç«¯ä¸æ˜¯ç›¸äº’ä¿¡ä»»çš„ï¼Œç¡¬ä»¶éœ€è¦ä¸ºæ¯ä¸ªæ´»åŠ¨è¿æ¥ä¿ç•™å•ç‹¬çš„å†…å­˜åŒºåŸŸã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œä¸è€ƒè™‘ RDMA æ“ä½œã€‚ ä¸è€ƒè™‘ RDMA ä¸ºä»€ä¹ˆï¼Œç‚¹å¯¹ç‚¹ï¼Œä¸ä¿¡ä»»ï¼Ÿ ","date":"2024-09-16","objectID":"/posts/paper-arrakis/:4:4","tags":["Paper Reading"],"title":"Paper Reading: Arrakis","uri":"/posts/paper-arrakis/"},{"categories":null,"content":"Design and Implementation Minimize kernel involvement for data-plane operations: Arrakis æ—¨åœ¨é™åˆ¶æˆ–æ¶ˆé™¤å†…æ ¸å¯¹å¤§å¤šæ•° I/O æ“ä½œçš„å¹²é¢„ã€‚I/O è¯·æ±‚åœ¨åº”ç”¨ç¨‹åºçš„åœ°å€ç©ºé—´ä¹‹é—´è·¯ç”±ï¼Œæ— éœ€å†…æ ¸å‚ä¸ï¼ŒåŒæ—¶ä¸ç‰ºç‰²å®‰å…¨æ€§å’Œéš”ç¦»æ€§ã€‚ åŸºæœ¬éƒ½æ˜¯æ¶ˆé™¤å†…æ ¸æ€çš„ IO å¹²é¢„ Transparency to the application programmer: Appropriate OS/hardware abstractions: å…¶ä»–æ„Ÿè§‰çœ‹çœ‹å°±è¡Œï¼Œéƒ½æ˜¯è™šæ‹ŸåŒ–å¸¦æ¥çš„å¥½å¤„ ","date":"2024-09-16","objectID":"/posts/paper-arrakis/:5:0","tags":["Paper Reading"],"title":"Paper Reading: Arrakis","uri":"/posts/paper-arrakis/"},{"categories":null,"content":"Architecture Overview ","date":"2024-09-16","objectID":"/posts/paper-arrakis/:5:1","tags":["Paper Reading"],"title":"Paper Reading: Arrakis","uri":"/posts/paper-arrakis/"},{"categories":null,"content":"Hardware Model æˆ‘ä»¬å·¥ä½œçš„å…³é”®è¦ç´ æ˜¯å¼€å‘ä¸€ä¸ªä¸ç¡¬ä»¶æ— å…³çš„è™šæ‹ŸåŒ– I/O å±‚â€”â€”å³æä¾›â€œç†æƒ³â€ç¡¬ä»¶ç‰¹æ€§é›†çš„è®¾å¤‡æ¨¡å‹ã€‚è¿™ä¸ªè®¾å¤‡æ¨¡å‹æ•æ‰äº†åœ¨ç¡¬ä»¶ä¸­å®ç°ä¼ ç»Ÿå†…æ ¸æ•°æ®å¹³é¢æ“ä½œæ‰€éœ€çš„åŠŸèƒ½ã€‚æˆ‘ä»¬çš„æ¨¡å‹ç±»ä¼¼äºä¸€äº›ç¡¬ä»¶ I/O é€‚é…å™¨å·²ç»æä¾›çš„å†…å®¹ï¼›æˆ‘ä»¬å¸Œæœ›å®ƒèƒ½ä¸ºæ”¯æŒå®‰å…¨çš„ç”¨æˆ·çº§ç½‘ç»œå’Œå­˜å‚¨æä¾›æŒ‡å¯¼ virtual network interface cards VIC æ˜¯æ€ä¹ˆæ¥çš„ Queues: Transmit and receive filters: Virtual storage areas: Bandwidth allocators: ","date":"2024-09-16","objectID":"/posts/paper-arrakis/:5:2","tags":["Paper Reading"],"title":"Paper Reading: Arrakis","uri":"/posts/paper-arrakis/"},{"categories":null,"content":"VSIC Emulation çœ‹ä¸æ‡‚ ä½†æ˜¯æ¯” IX ç­‰æ›´åŠ ç»†èŠ‚ï¼Œåº”è¯¥æ˜¯èƒ½å¤ç°çš„ ","date":"2024-09-16","objectID":"/posts/paper-arrakis/:5:3","tags":["Paper Reading"],"title":"Paper Reading: Arrakis","uri":"/posts/paper-arrakis/"},{"categories":null,"content":"Control Plane Interface åº”ç”¨ç¨‹åºä¸ Arrakis æ§åˆ¶å¹³é¢ä¹‹é—´çš„æ¥å£ç”¨äºä»ç³»ç»Ÿè¯·æ±‚èµ„æºï¼Œå¹¶å°† I/O æµå¼•å¯¼åˆ°ç”¨æˆ·ç¨‹åºã€‚è¯¥æ¥å£æä¾›çš„å…³é”®æŠ½è±¡æ˜¯ VICsã€é—¨é“ƒã€è¿‡æ»¤å™¨ã€VSAs å’Œé€Ÿç‡è¯´æ˜ç¬¦ã€‚ è¿™é‡Œçš„å®ç°å¾ˆæœ‰æ„æ€ï¼Œå¯ä»¥å¯¹æ¯” IX çœ‹çœ‹ï¼ŒIX ç”¨äº† flow consistent å“ˆå¸Œï¼Œ æœ€å¤§åŒºåˆ«åº”è¯¥æ˜¯ arrakis æ”¯æŒ iommuï¼Œix æ²¡æœ‰ï¼Ÿ ","date":"2024-09-16","objectID":"/posts/paper-arrakis/:5:4","tags":["Paper Reading"],"title":"Paper Reading: Arrakis","uri":"/posts/paper-arrakis/"},{"categories":null,"content":"File Name Lookup VFS + POSIX arrakis æ”¯æŒæ–‡ä»¶å­˜å‚¨åº”è¯¥å¾ˆæœ‰æ„æ€ï¼ŒIX æ”¯æŒå—ï¼Ÿè¿˜æ˜¯çº¯å†…å­˜çš„ï¼Œåº”è¯¥ä¹Ÿæ˜¯æ”¯æŒçš„å§ï¼Œè®ºæ–‡æåˆ°äº† SDD å’Œ flashã€‚ ","date":"2024-09-16","objectID":"/posts/paper-arrakis/:5:5","tags":["Paper Reading"],"title":"Paper Reading: Arrakis","uri":"/posts/paper-arrakis/"},{"categories":null,"content":"Network Data Plane Interface åœ¨ Arrakis ä¸­ï¼Œåº”ç”¨ç¨‹åºé€šè¿‡ç›´æ¥ä¸ç¡¬ä»¶é€šä¿¡æ¥å‘é€å’Œæ¥æ”¶ç½‘ç»œæ•°æ®åŒ…ã€‚å› æ­¤ï¼Œæ•°æ®å¹³é¢æ¥å£åœ¨åº”ç”¨ç¨‹åºåº“ä¸­å®ç°ï¼Œå…è®¸å®ƒä¸åº”ç”¨ç¨‹åºå…±åŒè®¾è®¡[43]ã€‚Arrakis åº“ä¸ºåº”ç”¨ç¨‹åºæä¾›äº†ä¸¤ä¸ªæ¥å£ã€‚æˆ‘ä»¬æè¿°äº†æœ¬åœ°çš„ Arrakis æ¥å£ï¼Œå®ƒç¨å¾®åç¦»äº† POSIX æ ‡å‡†ä»¥æ”¯æŒçœŸæ­£çš„é›¶æ‹·è´ I/Oï¼›Arrakis è¿˜æä¾›äº†ä¸€ä¸ªæ”¯æŒæœªä¿®æ”¹åº”ç”¨ç¨‹åºçš„ POSIX å…¼å®¹å±‚ã€‚ æ€ä¹ˆåšåˆ°çœŸæ­£çš„é›¶æ‹·è´ï¼Ÿ åº”ç”¨ç¨‹åºåœ¨é˜Ÿåˆ—ä¸Šå‘é€å’Œæ¥æ”¶æ•°æ®åŒ…ï¼Œè¿™äº›é˜Ÿåˆ—ä¹‹å‰å·²ç»åˆ†é…äº†è¿‡æ»¤å™¨ï¼Œå¦‚ä¸Šæ‰€è¿°ã€‚è™½ç„¶è¿‡æ»¤å™¨å¯ä»¥åŒ…æ‹¬ IPã€TCP å’Œ UDP å­—æ®µè°“è¯ï¼Œä½† Arrakis å¹¶ä¸è¦æ±‚ç¡¬ä»¶æ‰§è¡Œåè®®å¤„ç†ï¼Œåªè¿›è¡Œå¤šè·¯å¤ç”¨ã€‚åœ¨æˆ‘ä»¬çš„å®ç°ä¸­ï¼ŒArrakis åœ¨æ•°æ®å¹³é¢æ¥å£ä¹‹ä¸Šæä¾›äº†ä¸€ä¸ªç”¨æˆ·ç©ºé—´ç½‘ç»œæ ˆã€‚è¯¥æ ˆæ—¨åœ¨æœ€å¤§åŒ–å»¶è¿Ÿå’Œååé‡ã€‚æˆ‘ä»¬ä¿æŒäº†æ•°æ®åŒ…ä¼ è¾“å’Œæ¥æ”¶çš„ä¸‰ä¸ªæ–¹é¢çš„æ¸…æ™°åˆ†ç¦»ã€‚ é¦–å…ˆï¼Œæ•°æ®åŒ…ä½¿ç”¨ä¼ ç»Ÿçš„ DMA æŠ€æœ¯é€šè¿‡æ•°æ®åŒ…ç¼“å†²åŒºæè¿°ç¬¦ç¯åœ¨ç½‘ç»œå’Œä¸»å†…å­˜ä¹‹é—´å¼‚æ­¥ä¼ è¾“ã€‚å…¶æ¬¡ï¼Œåº”ç”¨ç¨‹åºé€šè¿‡å°†ç¼“å†²åŒºé“¾å…¥ç¡¬ä»¶æè¿°ç¬¦ç¯æ¥å°†ä¼ è¾“æ•°æ®åŒ…çš„æ‰€æœ‰æƒè½¬ç§»ç»™ç½‘ç»œç¡¬ä»¶ï¼Œå¹¶é€šè¿‡åå‘è¿‡ç¨‹è·å–æ¥æ”¶åˆ°çš„æ•°æ®åŒ…ã€‚è¿™æ˜¯é€šè¿‡ä¸¤ä¸ª VNIC é©±åŠ¨ç¨‹åºå‡½æ•°å®Œæˆçš„ã€‚send_packet(queue, packet_array) åœ¨é˜Ÿåˆ—ä¸Šå‘é€æ•°æ®åŒ…ï¼›æ•°æ®åŒ…ç”±æ•£å¸ƒ/èšé›†æ•°ç»„ packet_array æŒ‡å®šï¼Œå¹¶ä¸”å¿…é¡»ç¬¦åˆå·²ä¸é˜Ÿåˆ—å…³è”çš„è¿‡æ»¤å™¨ã€‚receive_packet(queue) = packet ä»é˜Ÿåˆ—æ¥æ”¶æ•°æ®åŒ…å¹¶è¿”å›æŒ‡å‘å®ƒçš„æŒ‡é’ˆã€‚è¿™ä¸¤ä¸ªæ“ä½œéƒ½æ˜¯å¼‚æ­¥çš„ã€‚packet_done(packet) å°†æ¥æ”¶åˆ°çš„æ•°æ®åŒ…çš„æ‰€æœ‰æƒè¿”å›ç»™ VNICã€‚ ä¸ºäº†è·å¾—æœ€ä½³æ€§èƒ½ï¼ŒArrakis æ ˆå°†é€šè¿‡ç¼–è¯‘å™¨ç”Ÿæˆçš„ã€é’ˆå¯¹ NIC æè¿°ç¬¦æ ¼å¼ä¼˜åŒ–çš„ä»£ç ç›´æ¥ä¸ç¡¬ä»¶é˜Ÿåˆ—äº¤äº’ï¼Œè€Œä¸æ˜¯é€šè¿‡è¿™äº›è°ƒç”¨ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬åœ¨æœ¬æ–‡ä¸­æŠ¥å‘Šçš„å®ç°ä½¿ç”¨å‡½æ•°è°ƒç”¨é©±åŠ¨ç¨‹åºã€‚ç¬¬ä¸‰ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸é˜Ÿåˆ—å…³è”çš„é—¨é“ƒå¤„ç†å¼‚æ­¥äº‹ä»¶é€šçŸ¥ã€‚å½“åº”ç”¨ç¨‹åºè¿è¡Œæ—¶ï¼Œé—¨é“ƒé€šè¿‡ç¡¬ä»¶è™šæ‹ŸåŒ–ä¸­æ–­ç›´æ¥ä»ç¡¬ä»¶ä¼ é€’ç»™ç”¨æˆ·ç¨‹åºï¼Œå½“åº”ç”¨ç¨‹åºä¸è¿è¡Œæ—¶ï¼Œé€šè¿‡æ§åˆ¶å¹³é¢è°ƒç”¨è°ƒåº¦å™¨ã€‚åœ¨åä¸€ç§æƒ…å†µä¸‹ï¼Œè¾ƒé«˜çš„å»¶è¿Ÿæ˜¯å¯ä»¥å®¹å¿çš„ã€‚é—¨é“ƒé€šè¿‡å¸¸è§„äº‹ä»¶ä¼ é€’æœºåˆ¶ï¼ˆä¾‹å¦‚æ–‡ä»¶æè¿°ç¬¦äº‹ä»¶ï¼‰æš´éœ²ç»™ Arrakis ç¨‹åºï¼Œå¹¶å®Œå…¨é›†æˆåˆ°ç°æœ‰çš„ I/O å¤šè·¯å¤ç”¨æ¥å£ï¼ˆä¾‹å¦‚ selectï¼‰ä¸­ã€‚å®ƒä»¬å¯¹äºé€šçŸ¥åº”ç”¨ç¨‹åºæ¥æ”¶é˜Ÿåˆ—ä¸­æ•°æ®åŒ…çš„é€šç”¨å¯ç”¨æ€§ä»¥åŠä½œä¸ºé«˜ä¼˜å…ˆçº§é˜Ÿåˆ—ä¸­æ•°æ®åŒ…æ¥æ”¶å’Œ I/O å®Œæˆçš„è½»é‡çº§é€šçŸ¥æœºåˆ¶éƒ½å¾ˆæœ‰ç”¨ã€‚ è¿™ç§è®¾è®¡äº§ç”Ÿäº†ä¸€ä¸ªåè®®æ ˆï¼Œé€šè¿‡ä½¿ç”¨æè¿°ç¬¦ç¯ä½œä¸ºç¼“å†²åŒºï¼Œå°½å¯èƒ½åœ°å°†ç¡¬ä»¶ä¸è½¯ä»¶è§£è€¦ï¼Œåœ¨é«˜é€Ÿæ•°æ®åŒ…ç‡ä¸‹æœ€å¤§åŒ–ååé‡å¹¶æœ€å°åŒ–å¼€é”€ï¼Œä»è€Œå®ç°ä½å»¶è¿Ÿã€‚åœ¨è¿™ä¸ªæœ¬åœ°æ¥å£ä¹‹ä¸Šï¼ŒArrakis æä¾›äº† POSIX å…¼å®¹çš„å¥—æ¥å­—ã€‚è¿™ä¸ªå…¼å®¹å±‚å…è®¸ Arrakis æ”¯æŒæœªä¿®æ”¹çš„ Linux åº”ç”¨ç¨‹åºã€‚ç„¶è€Œï¼Œæˆ‘ä»¬è¡¨æ˜ï¼Œé€šè¿‡ä½¿ç”¨å¼‚æ­¥æœ¬åœ°æ¥å£å¯ä»¥å®ç°æ€§èƒ½æå‡ è¿™é‡Œçš„åè®®æ ˆ å’Œ IX, mTCP ç­‰æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚ è€Œä¸” arrakis è¿˜æœ‰ç¼“å†²åŒºï¼Ÿä¸ºä»€ä¹ˆä¸åƒ IX ä¸€æ ·ç›´æ¥å»æ‰ç”¨å…±äº«å†…å­˜åšé›¶æ‹·è´å‘¢ã€‚ ","date":"2024-09-16","objectID":"/posts/paper-arrakis/:5:6","tags":["Paper Reading"],"title":"Paper Reading: Arrakis","uri":"/posts/paper-arrakis/"},{"categories":null,"content":"IX: A Protected Dataplane Operating System for High Throughput and Low Latency OSDI 2014, Dune çš„è¡ç”Ÿï¼ŒåŒæ ·åˆ©ç”¨ç¡¬ä»¶è™šæ‹ŸåŒ– VT-x æŠ€æœ¯ã€‚IX æœ€é‡è¦çš„æ˜¯ Data Plane å’Œ Control Plane åˆ†ç¦»äº†ã€‚ ä¸å¾—ä¸è¯´è¿™ç±»å‹çš„è®ºæ–‡é˜…è¯»èµ·æ¥å¤ªè´¹åŠ²äº†ã€‚ ","date":"2024-09-15","objectID":"/posts/ix-paper/:1:0","tags":["Paper Reading"],"title":"Paper Reading: IX: A Protected Dataplane Operating System","uri":"/posts/ix-paper/"},{"categories":null,"content":"Abstract ä¼ ç»Ÿè§‚ç‚¹è®¤ä¸ºï¼Œæ¿€è¿›çš„ç½‘ç»œéœ€æ±‚ï¼Œæ¯”å¦‚å°æ¶ˆæ¯çš„é«˜åŒ…é€Ÿç‡å’Œå¾®ç§’çº§çš„å°¾éƒ¨å»¶è¿Ÿï¼Œæœ€å¥½åœ¨å†…æ ¸ä¹‹å¤–çš„ç”¨æˆ·çº§ç½‘ç»œå †æ ˆä¸­è¿›è¡Œå¤„ç†ã€‚æˆ‘ä»¬ä»‹ç»äº† IXï¼Œä¸€ä¸ªæ•°æ®å¹³é¢æ“ä½œç³»ç»Ÿï¼Œå®ƒæä¾›äº†é«˜ I/O æ€§èƒ½ï¼ŒåŒæ—¶ä¿æŒäº†ç°æœ‰æ ¸å¿ƒæä¾›çš„å¼ºä¿æŠ¤çš„å…³é”®ä¼˜åŠ¿ã€‚IX ä½¿ç”¨ç¡¬ä»¶è™šæ‹ŸåŒ–å°†å†…æ ¸(æ§åˆ¶å¹³é¢)çš„ç®¡ç†å’Œè°ƒåº¦åŠŸèƒ½ä¸ç½‘ç»œå¤„ç†(æ•°æ®å¹³é¢)åˆ†ç¦»å¼€æ¥ã€‚æ•°æ®å¹³é¢ä½“ç³»ç»“æ„å»ºç«‹åœ¨åŸç”Ÿçš„é›¶æ‹·è´ API ä¹‹ä¸Šï¼Œé€šè¿‡å°†ç¡¬ä»¶çº¿ç¨‹å’Œç½‘ç»œé˜Ÿåˆ—ä¸“ç”¨äºæ•°æ®å¹³é¢å®ä¾‹ï¼Œå¤„ç†æœ‰ç•Œæ‰¹é‡çš„æ•°æ®åŒ…ä»¥å®Œæˆï¼Œå¹¶é€šè¿‡æ¶ˆé™¤ä¸€è‡´æ€§æµé‡å’Œå¤šæ ¸åŒæ­¥æ¥ä¼˜åŒ–å¸¦å®½å’Œå»¶è¿Ÿã€‚æˆ‘ä»¬å±•ç¤ºäº† IX åœ¨ååé‡å’Œç«¯åˆ°ç«¯å»¶è¿Ÿæ–¹é¢éƒ½æ˜æ˜¾ä¼˜äº Linux å’Œæœ€å…ˆè¿›çš„ç”¨æˆ·ç©ºé—´ç½‘ç»œå †æ ˆã€‚æ­¤å¤–ï¼ŒIX æé«˜äº†ä¸€ä¸ªå¹¿æ³›éƒ¨ç½²çš„é”®å€¼å­˜å‚¨å™¨çš„ååé‡è¾¾åˆ° 3.6 å€ï¼Œå¹¶å‡å°‘äº†è¶…è¿‡ 2 å€çš„å°¾å»¶è¿Ÿã€‚ IXï¼Œåˆ©ç”¨ VTX å°†æ§åˆ¶å¹³é¢ï¼ˆå†…æ ¸ï¼‰å’Œæ•°æ®å¹³é¢ï¼ˆç½‘ç»œå¤„ç†ï¼‰åŒºåˆ†å¼€ï¼Œåè€…åˆ©ç”¨é›¶æ‹·è´å¤„ç†ï¼Ÿ å»¶è¿Ÿå’Œååéƒ½æœ‰æå‡ ","date":"2024-09-15","objectID":"/posts/ix-paper/:2:0","tags":["Paper Reading"],"title":"Paper Reading: IX: A Protected Dataplane Operating System","uri":"/posts/ix-paper/"},{"categories":null,"content":"Introduction need for networking stacks that provide more than high streaming performance. The new requirements include high packet rates for short messages, microsecond-level responses to remote requests with tight tail latency guarantees, and support for high connection counts and churn ç›®å‰å¯¹é«˜æ€§èƒ½ç½‘ç»œçš„éœ€æ±‚ some systems bypass the kernel and implement the networking stack in user-space . While kernel bypass eliminates context switch overheads, on its own it does not eliminate the difficult tradeoffs between high packet rates and low latency (see Â§5.2). Moreover, user-level networking suffers from lack of protection. Application bugs and crashes can corrupt the networking stack and impact other workloads. Other systems go a step further by also replacing TCP/IP with RDMA in order to offload network processing to specialized adapters [17, 31, 44, 47]. However, such adapters must be present at both ends of the connection and can only be used within the datacenter. bypass æ¯”å¦‚ dpdk, åœ¨ç”¨æˆ·æ€å¤„ç†äº†ï¼Œæ¶ˆé™¤äº†ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€ å¹¶æ²¡æœ‰æ¶ˆé™¤åœ¨ é«˜æ•°æ®åŒ…é€Ÿç‡ å’Œ ä½å»¶è¿Ÿä¹‹é—´ çš„è‰°éš¾æƒè¡¡ï¼Œè¿™ç§ tradeoff æ€ä¹ˆå¤„ç†ï¼Ÿé«˜é€Ÿç‡å’Œä½å»¶è¿Ÿçœ‹ç€å¹¶ä¸æ˜¯çŸ›ç›¾çš„ å¦ä¸€ç§è§£å†³å°±æ˜¯ RDMA è®¾å¤‡ We propose IX, an operating system designed to break the 4-way tradeoff between high throughput, low latency, strong protection, and resource efficiency. Its architecture builds upon the lessons from high performance middleboxes, such as firewalls, load-balancers, and software routers [16, 34]. IX separates the control plane, which is responsible for system configuration and coarse-grain resource provisioning between applications, from the dataplanes, which run the networking stack and application logic. IX leverages Dune and virtualization hardware to run the dataplane kernel and the application at distinct protection levels and to isolate the control plane from the dataplane [7]. In our implementation, the control plane is the full Linux kernel and the dataplanes run as protected, library-based operating systems on dedicated hardware threads IX æ˜¯ OSï¼Œä½¿ç”¨äº† Dune å’Œ VT-x è™šæ‹ŸåŒ–æŠ€æœ¯ æ‰“ç ´ 4way tradeoff å¬ä¸Šå»ä¹Ÿå¤ªé¡¶çº§äº†ã€‚ æ§åˆ¶å¹³é¢ç”¨äºç³»ç»Ÿé…ç½®å’Œèµ„æºä¾›åº” æ•°æ®å¹³é¢ç”¨äºç½‘ç»œåè®®æ ˆ IX å®ç°çš„æ§åˆ¶å¹³é¢æ˜¯å®Œæ•´çš„ Linux å†…æ ¸ï¼Œæ•°æ®å¹³é¢ä½œä¸ºå—ä¿æŠ¤çš„ã€åŸºäºåº“çš„æ“ä½œç³»ç»Ÿåœ¨ä¸“ç”¨çš„ç¡¬ä»¶çº¿ç¨‹ä¸Šè¿è¡Œ The IX dataplane allows for networking stacks that optimize for both bandwidth and latency. It is designed around a native, zero-copy API that supports processing of bounded batches of packets to completion ä¸€äº›ç»†èŠ‚ï¼Œæ•°æ®å¹³é¢ optimizes for multi-coreï¼Œåº”è¯¥æ˜¯è§£å†³äº† Dune å­˜åœ¨çš„ä¸€äº›é—®é¢˜ï¼Œæ¯”å¦‚æŠ›å¼ƒäº† POSIXï¼Œä½¿ç”¨åˆ«çš„æ¯”å¦‚äº‹ä»¶é©±åŠ¨ã€‚ IX å¯¹æ¯” Linux å’Œ mTCPï¼ˆç”¨æˆ·çº§ TCP/IPï¼‰ï¼ŒIX çš„ååé‡åˆ†åˆ«æ¯” Linux å’Œ mTCP é«˜å‡º 10 å€å’Œ 1.9 å€ å¬ä¸Šå»å’Œç”¨æˆ·çº§ tcp/ip å¯èƒ½å·®è·å¹¶ä¸å¤§ï¼Œä¸çŸ¥é“æœ‰æ²¡æœ‰ç”¨æˆ·çº§çš„ kcp/quic èƒ½å¦æ¯”è¾ƒä¸€ä¸‹ ä¸¤ä¸ª IX æœåŠ¡å™¨ä¹‹é—´çš„ç©ºè½½å•å‘å»¶è¿Ÿä¸º 5.7 å¾®ç§’ï¼Œæ¯”æ ‡å‡† Linux å†…æ ¸ä¹‹é—´çš„å»¶è¿Ÿå¥½ 4 å€ï¼Œ ","date":"2024-09-15","objectID":"/posts/ix-paper/:3:0","tags":["Paper Reading"],"title":"Paper Reading: IX: A Protected Dataplane Operating System","uri":"/posts/ix-paper/"},{"categories":null,"content":"Background and Motivation ","date":"2024-09-15","objectID":"/posts/ix-paper/:4:0","tags":["Paper Reading"],"title":"Paper Reading: IX: A Protected Dataplane Operating System","uri":"/posts/ix-paper/"},{"categories":null,"content":"Challenges for Datacenter Applications Microsecond tail latency: å°†ä¸€äº›æœåŠ¡è¯·æ±‚çš„å»¶è¿Ÿé™ä½åˆ°å‡ å Î¼s æ˜¯è‡³å…³é‡è¦çš„ï¼Œæˆ‘ä»¬è¿˜å¿…é¡»è€ƒè™‘è·¨æ•°æ®ä¸­å¿ƒçš„ RPC è¯·æ±‚çš„å»¶è¿Ÿåˆ†å¸ƒçš„é•¿å°¾ã€‚è™½ç„¶å°¾éƒ¨å…¬å·®å®é™…ä¸Šæ˜¯ä¸€ä¸ªç«¯åˆ°ç«¯çš„æŒ‘æˆ˜ï¼Œä½†ç³»ç»Ÿè½¯ä»¶æ ˆåœ¨åŠ å‰§é—®é¢˜æ–¹é¢èµ·ç€é‡è¦ä½œç”¨[36]ã€‚æ€»çš„æ¥è¯´ï¼Œç†æƒ³æƒ…å†µä¸‹ï¼Œæ¯ä¸ªæœåŠ¡èŠ‚ç‚¹éƒ½å¿…é¡»ä¸¥æ ¼é™åˆ¶ç¬¬ 99 ç™¾åˆ†ä½çš„è¯·æ±‚å»¶è¿Ÿ tail-tolerance is actually an end-to-end challenge åº”è¯¥åœ¨åˆ†å¸ƒå¼å¾ˆé‡è¦ High packet rates: å¦‚æœç³»ç»Ÿè½¯ä»¶ä¸èƒ½å¤„ç†å¤§é‡çš„è¿æ¥è®¡æ•°ï¼Œå¯¹åº”ç”¨ç¨‹åºå¯èƒ½ä¼šäº§ç”Ÿé‡å¤§å½±å“ TCP ä¸ºä»€ä¹ˆæ— æ³•å¤„ç†å¤§é‡è¿æ¥ï¼Ÿæ˜¯å› ä¸ºæ¡æ‰‹ä¹‹ç±»çš„ï¼Ÿ Protection: isolation between applications Resource efficiency: æ¯ä¸ªæœåŠ¡èŠ‚ç‚¹å°†ä½¿ç”¨æœ€å°‘çš„èµ„æº(æ ¸å¿ƒã€å†…å­˜æˆ– IOPS)æ¥æ»¡è¶³ä»»ä½•æ—¶å€™çš„æ•°æ®åŒ…é€Ÿç‡å’Œå°¾å»¶è¿Ÿéœ€æ±‚ ","date":"2024-09-15","objectID":"/posts/ix-paper/:4:1","tags":["Paper Reading"],"title":"Paper Reading: IX: A Protected Dataplane Operating System","uri":"/posts/ix-paper/"},{"categories":null,"content":"The Hardware â€“ OS Mismatch ç¡¬ä»¶å‘å±• å•†ç”¨æ“ä½œç³»ç»Ÿ è¿™äº›æ–‡ç« å¤§éƒ¨åˆ†çš„ motivation éƒ½æ¥è‡ªäºç¡¬ä»¶å‘å±•å¿«é€Ÿï¼Œæ¯”å¦‚ 100Gbe ç½‘å¡ï¼Œå•†ç”¨ç³»ç»Ÿä¸å¤Ÿä¸“ç”¨ç­‰ç­‰ ","date":"2024-09-15","objectID":"/posts/ix-paper/:4:2","tags":["Paper Reading"],"title":"Paper Reading: IX: A Protected Dataplane Operating System","uri":"/posts/ix-paper/"},{"categories":null,"content":"Alternative Approaches User-space networking stacks: OpenOnload [59] ï¼ŒmTCP [29]å’Œ Sandstorm [40]ç­‰ç³»ç»Ÿåœ¨ç”¨æˆ·ç©ºé—´ä¸­è¿è¡Œæ•´ä¸ªç½‘ç»œæ ˆï¼Œä»¥æ¶ˆé™¤å†…æ ¸äº¤å‰å¼€é”€å¹¶ä¼˜åŒ–æ•°æ®åŒ…å¤„ç†ï¼Œè€Œä¸ä¼šå¼•èµ·å†…æ ¸ä¿®æ”¹çš„å¤æ‚æ€§ æ›´é‡è¦çš„æ˜¯ï¼Œå½“ç½‘ç»œè¢«æå‡åˆ°ç”¨æˆ·ç©ºé—´ï¼Œè€Œåº”ç”¨ç¨‹åºé”™è¯¯å¯èƒ½ç ´åç½‘ç»œå †æ ˆæ—¶ï¼Œå®‰å…¨æ€§æƒè¡¡å°±ä¼šå‡ºç° Alternatives to TCP: RDMA å¯ä»¥å‡å°‘å»¶è¿Ÿï¼Œä½†æ˜¯éœ€è¦åœ¨è¿æ¥çš„ä¸¤ç«¯éƒ½æœ‰ä¸“é—¨çš„é€‚é…å™¨ã€‚ä½¿ç”¨æ™®é€šçš„ä»¥å¤ªç½‘ï¼ŒFacebook çš„ memcached éƒ¨ç½²ä½¿ç”¨ UDP æ¥é¿å…è¿æ¥å¯ä¼¸ç¼©æ€§é™åˆ¶[46]ã€‚å³ä½¿ UDP åœ¨å†…æ ¸ä¸­è¿è¡Œï¼Œå¯é çš„é€šä¿¡å’Œæ‹¥å¡ç®¡ç†ä»ç„¶å§”æ‰˜ç»™åº”ç”¨ç¨‹åº æ¯”å¦‚ KCP/QUIC å‘¢ Alternatives to POSIX API: MegaPipe replaces the POSIX API with lightweight sockets implemented with in-memory command rings [24]. This reduces some software overheads and increases packet rates, but retains all other challenges of using an existing, kernel-based networking stack. éƒ½æ˜¯è‡ªå®šä¹‰äº† OS enhancements: Tuning kernel-based stacks provides incremental benefits with superior ease of deployment. Linux SOREUSEPORT allows multi-threaded applications to accept incoming connections in parallel. Affinityaccept reduces overheads by ensuring all processing for a network flow is affinitized to the same core [49]. Recent Linux Kernels support a busy polling driver mode that trades increased CPU utilization for reduced latency [27], but it is not yet compatible with epoll. When microsecond latencies are irrelevant, properly tuned stacks can maintain millions of open connections ä¸å…¼å®¹ epoll æ˜¯ä»€ä¹ˆæ„æ€ï¼Œbusy polling æ˜¯å¢åŠ  CPU åˆ©ç”¨ç‡ä¸€ç›´è½®è¯¢ï¼Œå‡å°‘å»¶è¿Ÿã€‚è½®è¯¢å’Œ epoll äº‹ä»¶é€šçŸ¥æœ‰åŒºåˆ«å§ã€‚ ","date":"2024-09-15","objectID":"/posts/ix-paper/:4:3","tags":["Paper Reading"],"title":"Paper Reading: IX: A Protected Dataplane Operating System","uri":"/posts/ix-paper/"},{"categories":null,"content":"IX Design Approach microsecond latency \u0026\u0026 high packet rates These requirements have been addressed in the design of middleboxes such as firewalls, load-balancers by integrating the networking stack and the application into a single dataplane middleboxes é›†æˆäº†ç½‘ç»œæ ˆå’Œåº”ç”¨ç¨‹åºåˆ°ä¸€ä¸ªå•ä¸€çš„æ•°æ®å¹³é¢ï¼Œ Separation and protection of control and data plane: ç›¸æ¯”ä¹‹ä¸‹ï¼Œå•†ç”¨æ“ä½œç³»ç»Ÿå°†åè®®å¤„ç†ä¸åº”ç”¨ç¨‹åºæœ¬èº«è§£è€¦ï¼Œä»¥æä¾›è°ƒåº¦å’Œæµé‡æ§åˆ¶çš„çµæ´»æ€§ã€‚ä¾‹å¦‚ï¼Œå†…æ ¸ä¾èµ–è®¾å¤‡å’Œè½¯ä¸­æ–­æ¥ä»åº”ç”¨ç¨‹åºåˆ‡æ¢åˆ°åè®®å¤„ç†ã€‚ç±»ä¼¼åœ°ï¼Œå†…æ ¸çš„ç½‘ç»œæ ˆä¼šåœ¨åº”ç”¨ç¨‹åºä¸æ¶ˆè€—æ•°æ®çš„æƒ…å†µä¸‹ç”Ÿæˆ TCP ACK å¹¶æ»‘åŠ¨å…¶æ¥æ”¶çª—å£ï¼Œç›´åˆ°ä¸€å®šç¨‹åº¦ã€‚ IX æ‰©å±•äº†æ•°æ®å¹³é¢æ¶æ„ï¼Œä»¥æ”¯æŒä¸å—ä¿¡ä»»çš„é€šç”¨åº”ç”¨ç¨‹åº æ§åˆ¶å’Œæ•°æ®å¹³é¢çš„åˆ†ç¦»ä¹Ÿä½¿æˆ‘ä»¬èƒ½å¤Ÿè€ƒè™‘å®Œå…¨ä¸åŒçš„ I/O APIï¼ŒåŒæ—¶å…è®¸å…¶ä»–æ“ä½œç³»ç»ŸåŠŸèƒ½ï¼ˆå¦‚æ–‡ä»¶ç³»ç»Ÿæ”¯æŒï¼‰ä¼ é€’åˆ°æ§åˆ¶å¹³é¢ä»¥å®ç°å…¼å®¹æ€§ã€‚ç±»ä¼¼äº Exokernelï¼Œæ¯ä¸ªæ•°æ®å¹³é¢åœ¨ä¸€ä¸ªå•ä¸€åœ°å€ç©ºé—´ä¸­è¿è¡Œä¸€ä¸ªå•ä¸€åº”ç”¨ç¨‹åºã€‚ç„¶è€Œï¼Œæˆ‘ä»¬ä½¿ç”¨ç°ä»£è™šæ‹ŸåŒ–ç¡¬ä»¶åœ¨æ§åˆ¶å¹³é¢ã€æ•°æ®å¹³é¢å’Œä¸å—ä¿¡ä»»çš„ç”¨æˆ·ä»£ç ä¹‹é—´æä¾›ä¸‰å‘éš”ç¦»ã€‚æ•°æ®å¹³é¢åœ¨è™šæ‹ŸåŒ–ç³»ç»Ÿä¸­å…·æœ‰ç±»ä¼¼å®¢æˆ·æ“ä½œç³»ç»Ÿçš„åŠŸèƒ½ã€‚å®ƒä»¬ç®¡ç†è‡ªå·±çš„åœ°å€è½¬æ¢ï¼ŒåŸºäºæ§åˆ¶å¹³é¢æä¾›çš„åœ°å€ç©ºé—´ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ä½¿ç”¨ç‰¹æƒç¯æ¥ä¿æŠ¤ç½‘ç»œæ ˆå…å—ä¸å—ä¿¡ä»»çš„åº”ç”¨ç¨‹åºé€»è¾‘çš„å½±å“ã€‚æ­¤å¤–ï¼Œæ•°æ®å¹³é¢é€šè¿‡å†…å­˜æ˜ å°„ I/O ç›´æ¥è®¿é—® NIC é˜Ÿåˆ— è¿™ä¸ª compability æ˜¯æ€ä¹ˆåšçš„ï¼Œä¸åŒ IO API æ€ä¹ˆå…¼å®¹ã€‚ Run to completion with adaptive batching: The IX dataplane also makes extensive use of batching æœ‰ç•Œè‡ªé€‚åº”æ‰¹å¤„ç†å’Œè¿è¡Œåˆ°å®Œæˆçš„ç»“åˆæ„å‘³ç€ä¼ å…¥æ•°æ®åŒ…çš„é˜Ÿåˆ—åªèƒ½åœ¨ NIC è¾¹ç¼˜å»ºç«‹ï¼Œåœ¨æ•°æ®å¹³é¢å¼€å§‹å¤„ç†æ•°æ®åŒ…ä¹‹å‰ã€‚ç½‘ç»œæ ˆä»…ä»¥åº”ç”¨ç¨‹åºå¤„ç†çš„é€Ÿåº¦å‘å¯¹ç­‰æ–¹å‘é€ç¡®è®¤ã€‚åº”ç”¨ç¨‹åºå¤„ç†é€Ÿç‡çš„ä»»ä½•å‡æ…¢éƒ½ä¼šè¿…é€Ÿå¯¼è‡´å¯¹ç­‰æ–¹çš„çª—å£ç¼©å°ã€‚æ•°æ®å¹³é¢è¿˜å¯ä»¥ç›‘æ§ NIC è¾¹ç¼˜çš„é˜Ÿåˆ—æ·±åº¦ï¼Œå¹¶å‘æ§åˆ¶å¹³é¢å‘å‡ºä¿¡å·ä»¥åˆ†é…é¢å¤–çš„èµ„æºï¼ˆæ›´å¤šç¡¬ä»¶çº¿ç¨‹ã€å¢åŠ æ—¶é’Ÿé¢‘ç‡ï¼‰ï¼Œæ˜¾å¼é€šçŸ¥å¯¹ç­‰æ–¹å…³äºæ‹¥å¡ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡ ECNï¼‰ï¼Œå¹¶åšå‡ºæ‹¥å¡ç®¡ç†ç­–ç•¥å†³ç­–ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡ REDï¼‰ã€‚ Native, zero-copy API with explicit flow control: æˆ‘ä»¬ä¸æš´éœ²æˆ–æ¨¡æ‹Ÿ POSIX ç½‘ç»œ APIã€‚ç›¸åï¼Œæ•°æ®å¹³é¢å†…æ ¸å’Œåº”ç”¨ç¨‹åºé€šè¿‡å­˜å‚¨åœ¨å†…å­˜ä¸­çš„æ¶ˆæ¯åœ¨åè°ƒçš„è¿‡æ¸¡ç‚¹è¿›è¡Œé€šä¿¡ã€‚æˆ‘ä»¬çš„ API è®¾è®¡ä¸ºåœ¨ä¸¤ä¸ªæ–¹å‘ä¸Šå®ç°çœŸæ­£çš„é›¶æ‹·è´æ“ä½œï¼Œä»è€Œæé«˜å»¶è¿Ÿå’Œæ•°æ®åŒ…é€Ÿç‡ã€‚æ•°æ®å¹³é¢å’Œåº”ç”¨ç¨‹åºåä½œç®¡ç†æ¶ˆæ¯ç¼“å†²æ± ã€‚ä¼ å…¥çš„æ•°æ®åŒ…ä»¥åªè¯»æ–¹å¼æ˜ å°„åˆ°åº”ç”¨ç¨‹åºï¼Œåº”ç”¨ç¨‹åºå¯ä»¥åœ¨ç¨åç‚¹ä¿ç•™æ¶ˆæ¯ç¼“å†²å¹¶å°†å…¶è¿”å›ç»™æ•°æ®å¹³é¢ã€‚åº”ç”¨ç¨‹åºå‘æ•°æ®å¹³é¢çš„å‘é€ä¼ è¾“å†…å­˜ä½ç½®çš„åˆ†æ•£/èšé›†åˆ—è¡¨ï¼Œä½†ç”±äºå†…å®¹æœªè¢«å¤åˆ¶ï¼Œåº”ç”¨ç¨‹åºå¿…é¡»ä¿æŒå†…å®¹ä¸å˜ï¼Œç›´åˆ°å¯¹ç­‰æ–¹ç¡®è®¤æ¥æ”¶ã€‚æ•°æ®å¹³é¢å¼ºåˆ¶æ‰§è¡Œæµé‡æ§åˆ¶æ­£ç¡®æ€§ï¼Œå¹¶å¯èƒ½ä¿®å‰ªè¶…è¿‡æ»‘åŠ¨çª—å£å¯ç”¨å¤§å°çš„ä¼ è¾“è¯·æ±‚ï¼Œä½†åº”ç”¨ç¨‹åºæ§åˆ¶ä¼ è¾“ç¼“å†²ã€‚ å¾ˆå¥½å¥‡è¿™ä¸ªé›¶æ‹·è´æ€ä¹ˆåšçš„ Flow consistent, synchronization-free processing: multi-queue NICs provide flow-consistent hashing of incoming traffic to distinct hardware queues ","date":"2024-09-15","objectID":"/posts/ix-paper/:5:0","tags":["Paper Reading"],"title":"Paper Reading: IX: A Protected Dataplane Operating System","uri":"/posts/ix-paper/"},{"categories":null,"content":"IX Implementation ","date":"2024-09-15","objectID":"/posts/ix-paper/:6:0","tags":["Paper Reading"],"title":"Paper Reading: IX: A Protected Dataplane Operating System","uri":"/posts/ix-paper/"},{"categories":null,"content":"Overview IX æ¶æ„ï¼Œé‡ç‚¹ä»‹ç»äº†æ§åˆ¶å¹³é¢å’Œå¤šä¸ªæ•°æ®å¹³é¢ä¹‹é—´çš„åˆ†ç¦» IX æ§åˆ¶å¹³é¢ç”±å®Œæ•´çš„ Linux å†…æ ¸å’Œ IXCPï¼ˆä¸€ä¸ªç”¨æˆ·çº§ç¨‹åºï¼‰ç»„æˆã€‚ Linux å†…æ ¸åˆå§‹åŒ– PCIe è®¾å¤‡ï¼ˆå¦‚ç½‘å¡ï¼‰ï¼Œå¹¶ä¸ºæ•°æ®å¹³é¢æä¾›èµ„æºåˆ†é…çš„åŸºæœ¬æœºåˆ¶ï¼ŒåŒ…æ‹¬æ ¸å¿ƒã€å†…å­˜å’Œç½‘ç»œé˜Ÿåˆ—ã€‚åŒæ ·é‡è¦çš„æ˜¯ï¼ŒLinux æä¾›äº†ç³»ç»Ÿè°ƒç”¨å’ŒæœåŠ¡ï¼Œè¿™äº›æ˜¯ä¸å¹¿æ³›åº”ç”¨ç¨‹åºå…¼å®¹æ‰€å¿…éœ€çš„ï¼Œå¦‚æ–‡ä»¶ç³»ç»Ÿå’Œä¿¡å·æ”¯æŒã€‚ VMX ring 0 ä¸­è¿è¡Œ Linux å†…æ ¸ï¼Œè¿™ç§æ¨¡å¼é€šå¸¸ç”¨äºè™šæ‹ŸåŒ–ç³»ç»Ÿä¸­çš„è™šæ‹Ÿæœºç®¡ç†ç¨‹åºã€‚æˆ‘ä»¬ä½¿ç”¨ Linux ä¸­çš„ Dune æ¨¡å—ï¼Œä½¿æ•°æ®å¹³é¢èƒ½å¤Ÿåœ¨ VMX non root ring 0 ä¸­ä½œä¸ºç‰¹å®šäºåº”ç”¨ç¨‹åºçš„æ“ä½œç³»ç»Ÿè¿è¡Œï¼Œè¿™ç§æ¨¡å¼é€šå¸¸ç”¨äºè™šæ‹ŸåŒ–ç³»ç»Ÿä¸­çš„å®¢æˆ·å†…æ ¸ã€‚åº”ç”¨ç¨‹åºåƒå¾€å¸¸ä¸€æ ·åœ¨ VMX éæ ¹ç¯ 3 ä¸­è¿è¡Œã€‚è¿™ç§æ–¹æ³•ä¸ºæ•°æ®å¹³é¢æä¾›äº†ç›´æ¥è®¿é—®ç¡¬ä»¶åŠŸèƒ½ï¼ˆå¦‚é¡µè¡¨å’Œå¼‚å¸¸ï¼‰å’Œç½‘å¡çš„ç›´é€šè®¿é—®ã€‚æ­¤å¤–ï¼Œå®ƒæä¾›äº†æ§åˆ¶å¹³é¢ã€æ•°æ®å¹³é¢å’Œä¸å—ä¿¡ä»»çš„åº”ç”¨ç¨‹åºä»£ç ä¹‹é—´çš„å®Œå…¨ä¸‰å‘ä¿æŠ¤ã€‚ æ¯ä¸ª IX æ•°æ®å¹³é¢æ”¯æŒä¸€ä¸ªå¤šçº¿ç¨‹åº”ç”¨ç¨‹åºã€‚ memcached æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„åˆ†å¸ƒå¼å†…å­˜å¯¹è±¡ç¼“å­˜ç³»ç»Ÿï¼Œç”¨äºåŠ é€ŸåŠ¨æ€ Web åº”ç”¨ç¨‹åºï¼Œé€šè¿‡å‡è½»æ•°æ®åº“è´Ÿè½½æ¥æé«˜æ€§èƒ½ã€‚ httpd æ˜¯ Apache HTTP Server çš„å®ˆæŠ¤è¿›ç¨‹ï¼Œé€šå¸¸ç®€ç§°ä¸º Apacheã€‚å®ƒæ˜¯ä¸€ä¸ªå¼€æºçš„ã€è·¨å¹³å°çš„ Web æœåŠ¡å™¨è½¯ä»¶ï¼Œç”¨äºæä¾› HTTP æœåŠ¡ã€‚httpd å¯ä»¥é…ç½®ä¸ºè´Ÿè½½å‡è¡¡å™¨ï¼Œå°†è¯·æ±‚åˆ†å‘åˆ°å¤šä¸ªåç«¯æœåŠ¡å™¨ï¼Œä»¥æé«˜ç³»ç»Ÿçš„æ€§èƒ½å’Œå¯é æ€§ã€‚ ä¾‹å¦‚ï¼Œå›¾ 1a å±•ç¤ºäº†ä¸€ä¸ªç”¨äºå¤šçº¿ç¨‹ memcached æœåŠ¡å™¨çš„æ•°æ®å¹³é¢å’Œå¦ä¸€ä¸ªç”¨äºå¤šçº¿ç¨‹ httpd æœåŠ¡å™¨çš„æ•°æ®å¹³é¢ã€‚æ§åˆ¶å¹³é¢ä»¥ç²—ç²’åº¦æ–¹å¼ä¸ºæ¯ä¸ªæ•°æ®å¹³é¢åˆ†é…èµ„æºã€‚æ ¸å¿ƒåˆ†é…é€šè¿‡å®æ—¶ä¼˜å…ˆçº§å’Œ cpusets æ§åˆ¶ï¼›å†…å­˜ä»¥å¤§é¡µé¢åˆ†é…ï¼›æ¯ä¸ª NIC ç¡¬ä»¶é˜Ÿåˆ—åˆ†é…ç»™å•ä¸ªæ•°æ®å¹³é¢ã€‚è¿™ç§æ–¹æ³•é¿å…äº†åœ¨éœ€æ±‚åº”ç”¨ç¨‹åºä¹‹é—´è¿›è¡Œç»†ç²’åº¦æ—¶é—´å¤ç”¨èµ„æºçš„é¢å¤–å¼€é”€å’Œä¸ç¨³å®šæ€§ã€‚ app éƒ½è·‘åœ¨ ring3ï¼Œ IX åœ¨ ring 0 non-root, Dune å’Œå†…æ ¸ ä¹Ÿå°±æ˜¯æ§åˆ¶å¹³é¢æ˜¯åœ¨ ring0 vmx-root ä¸ºä»€ä¹ˆéœ€è¦å¤§é¡µå†…å­˜ï¼Œå‡å°‘ TLBï¼Ÿä¸€èˆ¬ç½‘ç»œæ•°æ®åŒ…å¤„ç†éƒ½éœ€è¦å¤§é¡µå†…å­˜ï¼Œå‡å°‘é¡µè¡¨éå†æ¬¡æ•°ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½¿ç”¨ 4KB çš„é¡µé¢ï¼Œä¸€ä¸ª 2MB çš„å†…å­˜åŒºåŸŸéœ€è¦ 512 ä¸ª TLB æ¡ç›®ï¼›è€Œå¦‚æœä½¿ç”¨ 2MB çš„å¤§é¡µï¼Œåªéœ€è¦ä¸€ä¸ª TLB æ¡ç›®ã€‚ æ¯ä¸ª IX æ•°æ®å¹³é¢ä½œä¸ºä¸€ä¸ªå•ä¸€åœ°å€ç©ºé—´æ“ä½œç³»ç»Ÿ single address-space OS è¿è¡Œï¼Œå¹¶åœ¨å…±äº«çš„ç”¨æˆ·çº§åœ°å€ç©ºé—´ä¸­æ”¯æŒä¸¤ç§çº¿ç¨‹ç±»å‹ï¼š (i) å¼¹æ€§çº¿ç¨‹ elastic threadsï¼Œä¸ IX æ•°æ®å¹³é¢äº¤äº’ä»¥å¯åŠ¨å’Œæ¶ˆè´¹ç½‘ç»œ I/Oï¼› (ii) åå°çº¿ç¨‹ background threadsã€‚ å¼¹æ€§çº¿ç¨‹å’Œåå°çº¿ç¨‹éƒ½å¯ä»¥å‘å‡ºä»»æ„ POSIX ç³»ç»Ÿè°ƒç”¨ï¼Œè¿™äº›è°ƒç”¨åœ¨è½¬å‘åˆ° Linux å†…æ ¸ä¹‹å‰ç”±æ•°æ®å¹³é¢è¿›è¡Œä¸­ä»‹å’Œå®‰å…¨éªŒè¯ã€‚å¼¹æ€§çº¿ç¨‹é¢„è®¡ä¸ä¼šå‘å‡ºé˜»å¡è°ƒç”¨ï¼Œå› ä¸ºå»¶è¿Ÿçš„æ•°æ®åŒ…å¤„ç†ä¼šå¯¹ç½‘ç»œè¡Œä¸ºäº§ç”Ÿä¸åˆ©å½±å“ã€‚æ¯ä¸ªå¼¹æ€§çº¿ç¨‹ç‹¬å ä½¿ç”¨åˆ†é…ç»™æ•°æ®å¹³é¢çš„æ ¸å¿ƒæˆ–ç¡¬ä»¶çº¿ç¨‹ï¼Œä»¥å®ç°é«˜é¢„æµ‹å»¶è¿Ÿçš„é«˜æ€§èƒ½ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œå¤šä¸ªåå°çº¿ç¨‹å¯ä»¥åˆ†æ—¶å…±äº«åˆ†é…çš„ç¡¬ä»¶çº¿ç¨‹ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªåº”ç”¨ç¨‹åºåˆ†é…äº†å››ä¸ªç¡¬ä»¶çº¿ç¨‹ï¼Œå®ƒå¯ä»¥å°†æ‰€æœ‰çº¿ç¨‹ç”¨ä½œå¼¹æ€§çº¿ç¨‹æ¥æœåŠ¡å¤–éƒ¨è¯·æ±‚ï¼Œæˆ–è€…å®ƒå¯ä»¥æš‚æ—¶è¿‡æ¸¡åˆ°ä¸‰ä¸ªå¼¹æ€§çº¿ç¨‹ï¼Œå¹¶ä½¿ç”¨ä¸€ä¸ªåå°çº¿ç¨‹æ‰§è¡Œä»»åŠ¡ï¼Œå¦‚åƒåœ¾æ”¶é›†ã€‚å½“æ§åˆ¶å¹³é¢ä½¿ç”¨ç±»ä¼¼äº Exokernel ä¸­çš„åè®®æ’¤é”€æˆ–åˆ†é…é¢å¤–çš„ç¡¬ä»¶çº¿ç¨‹æ—¶ï¼Œæ•°æ®å¹³é¢è°ƒæ•´å…¶å¼¹æ€§çº¿ç¨‹çš„æ•°é‡ã€‚ POSIX æ—¨åœ¨ç¡®ä¿ä¸åŒæ“ä½œç³»ç»Ÿä¹‹é—´çš„å…¼å®¹æ€§ï¼ŒPortableï¼Œæ¯”å¦‚ I/O ä¹‹ç±»çš„ã€‚POSIX å®šä¹‰äº†ç½‘ç»œç¼–ç¨‹çš„æ¥å£ï¼Œå¦‚ socket ç¼–ç¨‹ã€‚ å¼¹æ€§çº¿ç¨‹ï¼Œç½‘ç»œ IOã€‚åå°çº¿ç¨‹ï¼Œåƒåœ¾å›æ”¶ï¼Ÿ ","date":"2024-09-15","objectID":"/posts/ix-paper/:6:1","tags":["Paper Reading"],"title":"Paper Reading: IX: A Protected Dataplane Operating System","uri":"/posts/ix-paper/"},{"categories":null,"content":"The IX Dataplane IX æ•°æ®å¹³é¢ï¼Œå®ƒä¸å…¸å‹çš„å†…æ ¸ä¸åŒï¼Œå› ä¸ºå®ƒä¸“é—¨ç”¨äºé«˜æ€§èƒ½ç½‘ç»œ I/Oï¼Œå¹¶ä¸”åªè¿è¡Œä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œç±»ä¼¼äºåº“æ“ä½œç³»ç»Ÿï¼Œä½†å…·æœ‰å†…å­˜éš”ç¦»ã€‚æˆ‘ä»¬çš„æ•°æ®å¹³é¢ä»ç„¶æä¾›äº†è®¸å¤šç†Ÿæ‚‰çš„å†…æ ¸çº§æœåŠ¡ã€‚ library OS, æ•°æ®å¹³é¢è¿˜ç®¡ç†è‡ªå·±çš„è™šæ‹Ÿåœ°å€è½¬æ¢ï¼Œé€šè¿‡åµŒå¥—åˆ†é¡µæ”¯æŒã€‚ä¸å½“ä»£æ“ä½œç³»ç»Ÿç›¸æ¯”ï¼Œå®ƒä»…ä½¿ç”¨å¤§é¡µé¢ï¼ˆ2MBï¼‰ã€‚æˆ‘ä»¬å€¾å‘äºä½¿ç”¨å¤§é¡µé¢ large pagesï¼Œå› ä¸ºå®ƒä»¬çš„åœ°å€è½¬æ¢å¼€é”€è¾ƒå° [5, 7]ï¼Œå¹¶ä¸”ç°ä»£æœåŠ¡å™¨ä¸­ç‰©ç†å†…å­˜èµ„æºç›¸å¯¹ä¸°å¯Œã€‚æ•°æ®å¹³é¢ä»…ç»´æŠ¤ä¸€ä¸ªåœ°å€ç©ºé—´ï¼›å†…æ ¸é¡µé¢é€šè¿‡è¶…çº§ç”¨æˆ·ä½è¿›è¡Œä¿æŠ¤ã€‚æˆ‘ä»¬æ•…æ„é€‰æ‹©ä¸æ”¯æŒå¯äº¤æ¢å†…å­˜ï¼Œä»¥é¿å…å¢åŠ æ€§èƒ½å˜å¼‚æ€§ã€‚ è¿™ä¸ªå¤§é¡µé¢ï¼Œåœ¨ dpdk ä¹Ÿèƒ½çœ‹åˆ°ï¼Œä½†æ˜¯ not to support swappable memory æ˜¯ä»€ä¹ˆæ„æ€ï¼Œä¹Ÿå°±æ˜¯çº¯å†…å­˜çš„ï¼Ÿåº”è¯¥å¾ˆå¤šéƒ½æ˜¯çº¯å†…å­˜çš„æŠŠ We provide a hierarchical timing wheel implementation for managing network timeouts, æˆ‘ä»¬å½“å‰çš„ IX æ•°æ®å¹³é¢å®ç°åŸºäº Duneï¼Œå¹¶éœ€è¦ Intel x86-64 ç³»ç»Ÿä¸Šå¯ç”¨çš„ VT-x è™šæ‹ŸåŒ–åŠŸèƒ½ [62]ã€‚ç„¶è€Œï¼Œå®ƒå¯ä»¥ç§»æ¤åˆ°ä»»ä½•å…·æœ‰è™šæ‹ŸåŒ–æ”¯æŒçš„æ¶æ„ï¼Œä¾‹å¦‚ ARMã€SPARC å’Œ Powerã€‚ IX æ•°æ®å¹³é¢ç›®å‰ç”± 39K SLOC [67] ç»„æˆï¼Œå¹¶åˆ©ç”¨äº†ä¸€äº›ç°æœ‰ä»£ç åº“ï¼š41% æ¥è‡ª Intel NIC è®¾å¤‡é©±åŠ¨ç¨‹åºçš„ DPDK å˜ä½“ [28]ï¼Œ26% æ¥è‡ª lwIP TCP/IP å †æ ˆ [18]ï¼Œ15% æ¥è‡ª Dune åº“ã€‚ ç¡¬ä»¶é™åˆ¶è¿˜æ˜¯å¾ˆä¸¥é‡çš„ï¼Œçœ‹ç€åƒç¼åˆæ€ªï¼ŸlwIP æ˜¯ lightweight IP å¼€æº TCP/IP åè®®æ ˆï¼Œä¸ºä»€ä¹ˆä¸åŸºäº UDP å‘¢ï¼Œä¼šä¸ä¼šååå’Œå»¶è¿Ÿæ›´å¥½çœ‹ï¼Ÿè¿˜æ˜¯è¯´å—é™äº TCPï¼Œå› ä¸ºå¤§éƒ¨åˆ† NIC æˆ–è€… middleboxes éƒ½ä¼˜åŒ–äº† TCP è¿˜æœ‰å°±æ˜¯ batch èƒ½ä¸èƒ½å˜æˆ streamingï¼Ÿæ¯•ç«Ÿ TCP åº•å±‚åº”è¯¥æ˜¯æµçš„ï¼Œå­—èŠ‚æµ ","date":"2024-09-15","objectID":"/posts/ix-paper/:6:2","tags":["Paper Reading"],"title":"Paper Reading: IX: A Protected Dataplane Operating System","uri":"/posts/ix-paper/"},{"categories":null,"content":"Dataplane API and Operation åº”ç”¨ç¨‹åºçš„ elastic threads å¼¹æ€§çº¿ç¨‹é€šè¿‡ä¸‰ç§å¼‚æ­¥ã€éé˜»å¡æœºåˆ¶ä¸ IX æ•°æ®å¹³é¢è¿›è¡Œäº¤äº’ å¼¹æ€§çº¿ç¨‹ å¤„ç† IO è¿™äº›æœºåˆ¶æ€»ç»“åœ¨è¡¨ 1 ä¸­ï¼šå®ƒä»¬å‘æ•°æ®å¹³é¢å‘å‡ºæ‰¹é‡ç³»ç»Ÿè°ƒç”¨ï¼›å®ƒä»¬æ¶ˆè€—æ•°æ®å¹³é¢ç”Ÿæˆçš„äº‹ä»¶æ¡ä»¶ï¼›å®ƒä»¬å¯ä»¥ç›´æ¥ã€å®‰å…¨åœ°è®¿é—®åŒ…å«ä¼ å…¥æœ‰æ•ˆè½½è·çš„ï¼ˆmbufï¼‰ã€‚åè€…å…è®¸å¯¹ä¼ å…¥çš„ç½‘ç»œæµé‡è¿›è¡Œé›¶æ‹·è´è®¿é—®ã€‚åº”ç”¨ç¨‹åºå¯ä»¥ä¿ç•™ mbufï¼Œç›´åˆ°å®ƒé€šè¿‡ recv done æ‰¹é‡ç³»ç»Ÿè°ƒç”¨è¯·æ±‚æ•°æ®å¹³é¢é‡Šæ”¾å®ƒä»¬ã€‚ Both batched system calls and event conditions are passed through arrays of shared memory æˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªç”¨æˆ·çº§åº“ï¼Œç§°ä¸º libixï¼Œå®ƒæŠ½è±¡äº†æˆ‘ä»¬åº•å±‚ API çš„å¤æ‚æ€§ã€‚å®ƒä¸ºé—ç•™åº”ç”¨ç¨‹åºæä¾›äº†ä¸€ä¸ªå…¼å®¹çš„ç¼–ç¨‹æ¨¡å‹ï¼Œå¹¶æ˜¾è‘—ç®€åŒ–äº†æ–°åº”ç”¨ç¨‹åºçš„å¼€å‘ã€‚libix ç›®å‰åŒ…æ‹¬ä¸€ä¸ªä¸ libevent å’Œéé˜»å¡ POSIX å¥—æ¥å­—æ“ä½œéå¸¸ç›¸ä¼¼çš„æ¥å£ã€‚å®ƒè¿˜åŒ…æ‹¬æ–°çš„é›¶æ‹·è´è¯»å†™æ“ä½œæ¥å£ï¼Œè¿™äº›æ¥å£æ›´é«˜æ•ˆï¼Œä½†éœ€è¦å¯¹ç°æœ‰åº”ç”¨ç¨‹åºè¿›è¡Œæ›´æ”¹ã€‚libix è‡ªåŠ¨å°†å¤šä¸ªå†™è¯·æ±‚åˆå¹¶åˆ°æ¯ä¸ªæ‰¹å¤„ç†è½®æ¬¡ä¸­çš„å•ä¸ª sendv ç³»ç»Ÿè°ƒç”¨ä¸­ã€‚è¿™æé«˜äº†å±€éƒ¨æ€§ï¼Œç®€åŒ–äº†é”™è¯¯å¤„ç†ï¼Œå¹¶ç¡®ä¿äº†æ­£ç¡®çš„è¡Œä¸ºï¼Œå› ä¸ºå®ƒå³ä½¿åœ¨ä¼ è¾“å¤±è´¥æ—¶ä¹Ÿä¿ç•™äº†æ•°æ®æµé¡ºåºã€‚åˆå¹¶è¿˜ä¿ƒè¿›äº†ä¼ è¾“æµæ§åˆ¶ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¼ è¾“å‘é‡ï¼ˆsendv çš„å‚æ•°ï¼‰æ¥è·Ÿè¸ªä¼ å‡ºæ•°æ®ç¼“å†²åŒºï¼Œå¹¶åœ¨å¿…è¦æ—¶åœ¨ä¼ è¾“çª—å£æœ‰æ›´å¤šå¯ç”¨ç©ºé—´æ—¶é‡æ–°å‘å‡ºå†™æ“ä½œï¼Œå¦‚å‘é€äº‹ä»¶æ¡ä»¶æ‰€é€šçŸ¥çš„é‚£æ ·ã€‚æˆ‘ä»¬ç›®å‰çš„ç¼“å†²åŒºå¤§å°ç­–ç•¥éå¸¸åŸºæœ¬ï¼›æˆ‘ä»¬å¼ºåˆ¶æ‰§è¡Œæœ€å¤§æŒ‚èµ·å‘é€å­—èŠ‚é™åˆ¶ï¼Œä½†æˆ‘ä»¬è®¡åˆ’åœ¨æœªæ¥ä½¿è¿™æ›´åŠ åŠ¨æ€[21]ã€‚ è¿™é‡Œçš„é›¶æ‹·è´æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿç”¨æˆ·æ€ç½‘ç»œåè®®åº”è¯¥éƒ½è·Ÿé›¶æ‹·è´æœ‰å…³æŠŠï¼Œéƒ½éœ€è¦å…±äº«å†…å­˜ï¼Œé€šè¿‡é›¶æ‹·è´ç›´æ¥è®¿é—®å†…å­˜ç¼“å†²ï¼Œè¿™æ ·æ•°æ®ä¼ è¾“å¼€é”€å‡å°‘ã€‚ å›¾ 1b è¯´æ˜äº† IX æ•°æ®å¹³é¢ä¸­å¼¹æ€§çº¿ç¨‹çš„è¿è¡Œåˆ°å®Œæˆæ“ä½œã€‚NIC æ¥æ”¶ç¼“å†²åŒºæ˜ å°„åœ¨æœåŠ¡å™¨çš„å†…å­˜ä¸­ï¼ŒNIC çš„æ¥æ”¶æè¿°ç¬¦ç¯å¡«å……äº†ä¸€ç»„ç¼“å†²åŒºæè¿°ç¬¦ï¼Œå…è®¸å®ƒä½¿ç”¨ DMA ä¼ è¾“ä¼ å…¥çš„æ•°æ®åŒ…ã€‚å¼¹æ€§çº¿ç¨‹ï¼ˆ1ï¼‰è½®è¯¢æ¥æ”¶æè¿°ç¬¦ç¯ï¼Œå¹¶å¯èƒ½å‘ NIC å‘å¸ƒæ–°çš„ç¼“å†²åŒºæè¿°ç¬¦ï¼Œä»¥ä¾¿ç”¨äºæœªæ¥çš„ä¼ å…¥æ•°æ®åŒ…ã€‚ç„¶åï¼Œå¼¹æ€§çº¿ç¨‹ï¼ˆ2ï¼‰é€šè¿‡ TCP/IP ç½‘ç»œå †æ ˆå¤„ç†æœ‰é™æ•°é‡çš„æ•°æ®åŒ…ï¼Œä»è€Œç”Ÿæˆäº‹ä»¶æ¡ä»¶ã€‚æ¥ä¸‹æ¥ï¼Œçº¿ç¨‹ï¼ˆ3ï¼‰åˆ‡æ¢åˆ°ç”¨æˆ·ç©ºé—´åº”ç”¨ç¨‹åºï¼Œè¯¥åº”ç”¨ç¨‹åºæ¶ˆè€—æ‰€æœ‰äº‹ä»¶æ¡ä»¶ã€‚å‡è®¾ä¼ å…¥çš„æ•°æ®åŒ…åŒ…æ‹¬è¿œç¨‹è¯·æ±‚ï¼Œåº”ç”¨ç¨‹åºå¤„ç†è¿™äº›è¯·æ±‚å¹¶ä»¥ä¸€æ‰¹ç³»ç»Ÿè°ƒç”¨è¿›è¡Œå“åº”ã€‚åœ¨ä»ç”¨æˆ·ç©ºé—´è¿”å›æ§åˆ¶æƒåï¼Œçº¿ç¨‹ï¼ˆ4ï¼‰å¤„ç†æ‰€æœ‰æ‰¹é‡ç³»ç»Ÿè°ƒç”¨ï¼Œç‰¹åˆ«æ˜¯é‚£äº›æŒ‡å¯¼ä¼ å‡º TCP/IP æµé‡çš„è°ƒç”¨ã€‚çº¿ç¨‹è¿˜ï¼ˆ5ï¼‰è¿è¡Œæ‰€æœ‰å†…æ ¸å®šæ—¶å™¨ï¼Œä»¥ç¡®ä¿ç¬¦åˆ TCP è¡Œä¸ºã€‚æœ€åï¼ˆ6ï¼‰ï¼Œå®ƒå°†ä¼ å‡ºçš„ä»¥å¤ªç½‘å¸§æ”¾å…¥ NIC çš„ä¼ è¾“æè¿°ç¬¦ç¯ä¸­è¿›è¡Œä¼ è¾“ï¼Œå¹¶é€šè¿‡æ›´æ–°ä¼ è¾“ç¯çš„å°¾éƒ¨å¯„å­˜å™¨é€šçŸ¥ NIC å¯åŠ¨è¿™äº›å¸§çš„ DMA ä¼ è¾“ã€‚åœ¨å•ç‹¬çš„ä¼ é€’ä¸­ï¼Œå®ƒè¿˜æ ¹æ®ä¼ è¾“ç¯çš„å¤´éƒ¨ä½ç½®é‡Šæ”¾ä»»ä½•å·²å®Œæˆä¼ è¾“çš„ç¼“å†²åŒºï¼Œå¯èƒ½ä¼šç”Ÿæˆå‘é€äº‹ä»¶æ¡ä»¶ã€‚è¯¥è¿‡ç¨‹åœ¨ä¸€ä¸ªå¾ªç¯ä¸­é‡å¤ï¼Œç›´åˆ°æ²¡æœ‰ç½‘ç»œæ´»åŠ¨ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œçº¿ç¨‹è¿›å…¥ä¸€ä¸ªé™é»˜çŠ¶æ€ï¼Œè¯¥çŠ¶æ€æ¶‰åŠè¶…çº¿ç¨‹å‹å¥½çš„è½®è¯¢æˆ–å¯é€‰åœ°è¿›å…¥ä¸€ä¸ªèŠ‚èƒ½çš„ C çŠ¶æ€ï¼Œä»£ä»·æ˜¯ä¸€äº›é¢å¤–çš„å»¶è¿Ÿã€‚ å®Œæ•´çš„æµç¨‹ï¼Œä½¿ç”¨çš„æ˜¯è½®è¯¢ï¼ŒIX èƒ½å®ç°æ›´é«˜æ•ˆçš„ epoll æˆ–è€…å…¶ä»–äº‹ä»¶é©±åŠ¨æœºåˆ¶å—ï¼ŸIX åº”è¯¥æ˜¯æœ‰ Multi-queue çš„, IX æ¡†æ¶ä¸­çš„å¼¹æ€§çº¿ç¨‹è´Ÿè´£å¤„ç†ç½‘ç»œæ•°æ®åŒ…ã€‚æ¯ä¸ªå¼¹æ€§çº¿ç¨‹å¯ä»¥ç»‘å®šåˆ°ä¸€ä¸ªç‰¹å®šçš„ CPU æ ¸å¿ƒï¼Œ æé«˜å¹¶è¡Œå¤„ç†èƒ½åŠ› ","date":"2024-09-15","objectID":"/posts/ix-paper/:6:3","tags":["Paper Reading"],"title":"Paper Reading: IX: A Protected Dataplane Operating System","uri":"/posts/ix-paper/"},{"categories":null,"content":"Multi-core Scalability IX æ•°æ®å¹³é¢é’ˆå¯¹å¤šæ ¸å¯æ‰©å±•æ€§è¿›è¡Œäº†ä¼˜åŒ–ï¼Œå› ä¸ºå¼¹æ€§çº¿ç¨‹åœ¨å¸¸è§æƒ…å†µä¸‹ä»¥æ— åŒæ­¥å’Œæ— ä¸€è‡´æ€§çš„æ–¹å¼è¿è¡Œã€‚è¿™æ¯”æ— é”åŒæ­¥çš„è¦æ±‚æ›´å¼ºï¼Œæ— é”åŒæ­¥å³ä½¿åœ¨å•ä¸ªçº¿ç¨‹æ˜¯ç‰¹å®šæ•°æ®ç»“æ„çš„ä¸»è¦æ¶ˆè´¹è€…æ—¶ï¼Œä¹Ÿéœ€è¦æ˜‚è´µçš„åŸå­æŒ‡ä»¤[13]ã€‚è¿™æ˜¯é€šè¿‡ä¸€ç³»åˆ—æœ‰æ„è¯†çš„è®¾è®¡å’Œå®ç°æƒè¡¡å®ç°çš„ã€‚ ä¸çŸ¥é“å¼¹æ€§çº¿ç¨‹æ˜¯æ€ä¹ˆå®ç°çš„ï¼Œåº”è¯¥æ˜¯ä¿®å¤äº† Dune ä¸å¥½æ”¯æŒå¤šçº¿ç¨‹çš„é—®é¢˜ API çš„å®ç°ç»è¿‡äº†ç²¾å¿ƒä¼˜åŒ–ã€‚æ¯ä¸ªå¼¹æ€§çº¿ç¨‹ç®¡ç†è‡ªå·±çš„å†…å­˜æ± ã€ç¡¬ä»¶é˜Ÿåˆ—ã€äº‹ä»¶æ¡ä»¶æ•°ç»„å’Œæ‰¹é‡ç³»ç»Ÿè°ƒç”¨æ•°ç»„ã€‚äº‹ä»¶æ¡ä»¶å’Œæ‰¹é‡ç³»ç»Ÿè°ƒç”¨çš„å®ç°ç›´æ¥å—ç›Šäº IX å’Œåº”ç”¨ç¨‹åºä¹‹é—´çš„æ˜¾å¼åä½œæ§åˆ¶è½¬ç§»ã€‚ç”±äºç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä¹‹é—´æ²¡æœ‰å¹¶å‘æ‰§è¡Œï¼Œäº‹ä»¶æ¡ä»¶å’Œæ‰¹é‡ç³»ç»Ÿè°ƒç”¨æ˜¯åŸºäºåŸå­æ“ä½œçš„æ— åŒæ­¥å®ç°ã€‚ å¼¹æ€§çº¿ç¨‹åº”è¯¥å°±æ˜¯ç”¨æ¥è½®è¯¢çš„ï¼Œåº”è¯¥æœ‰é˜Ÿåˆ—ï¼Ÿ ç¬¬ä¸‰ï¼Œåœ¨ç½‘å¡ä¸Šä½¿ç”¨æµä¸€è‡´æ€§å“ˆå¸Œç¡®ä¿æ¯ä¸ªå¼¹æ€§çº¿ç¨‹æ“ä½œä¸€ä¸ªä¸ç›¸äº¤çš„ TCP æµå­é›†ã€‚å› æ­¤ï¼Œåœ¨å¤„ç†æœåŠ¡å™¨åº”ç”¨ç¨‹åºçš„ä¼ å…¥è¯·æ±‚æ—¶ï¼Œä¸ä¼šå‘ç”ŸåŒæ­¥æˆ–ä¸€è‡´æ€§ã€‚å¯¹äºå…·æœ‰å‡ºç«™è¿æ¥çš„å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿å›å¤è¢«åˆ†é…åˆ°å‘å‡ºè¯·æ±‚çš„åŒä¸€å¼¹æ€§çº¿ç¨‹ã€‚ç”±äºæˆ‘ä»¬æ— æ³•åè½¬ RSS ä½¿ç”¨çš„ Toeplitz å“ˆå¸Œ[43]ï¼Œæˆ‘ä»¬åªéœ€æ¢æµ‹ä¸´æ—¶ç«¯å£èŒƒå›´ä»¥æ‰¾åˆ°ä¸€ä¸ªä¼šå¯¼è‡´æ‰€éœ€è¡Œä¸ºçš„ç«¯å£å·ã€‚è¯·æ³¨æ„ï¼Œè¿™æ„å‘³ç€å®¢æˆ·ç«¯ä¸­çš„ä¸¤ä¸ªå¼¹æ€§çº¿ç¨‹ä¸èƒ½å…±äº«åˆ°æœåŠ¡å™¨çš„æµã€‚ flow-consistent hashing æ˜¯ä»€ä¹ˆï¼Œè¿™ä¸ªä¼šå¯¼è‡´å†²çªå—ï¼Œæµä¸€è‡´æ€§å“ˆå¸Œæ˜¯ä¸€ç§ç”¨äºç½‘ç»œæ•°æ®åŒ…å¤„ç†çš„å“ˆå¸Œç®—æ³•ï¼Œå…¶ä¸»è¦ç›®çš„æ˜¯ç¡®ä¿åŒä¸€ç½‘ç»œæµï¼ˆå¦‚ TCP è¿æ¥ï¼‰çš„æ•°æ®åŒ…å§‹ç»ˆè¢«åˆ†é…åˆ°åŒä¸€ä¸ªå¤„ç†å•å…ƒ IX ç¡®å®æœ‰ä¸€äº›éœ€è¦åŒæ­¥æ›´æ–°çš„å…±äº«ç»“æ„ã€‚ä¾‹å¦‚ï¼ŒARP è¡¨ç”±æ‰€æœ‰å¼¹æ€§çº¿ç¨‹å…±äº«ï¼Œå¹¶å— RCU é”ä¿æŠ¤[41]ã€‚å› æ­¤ï¼Œå¸¸è§æƒ…å†µä¸‹çš„è¯»å–æ˜¯æ— ä¸€è‡´æ€§çš„ï¼Œä½†ç½•è§çš„æ›´æ–°ä¸æ˜¯ã€‚RCU å¯¹è±¡åœ¨æ¯ä¸ªå¼¹æ€§çº¿ç¨‹å®Œæˆä¸€ä¸ªè¿è¡Œåˆ°å®Œæˆå‘¨æœŸçš„æ—¶é—´æ®µåè¿›è¡Œåƒåœ¾æ”¶é›†ã€‚ è¿˜æ˜¯éœ€è¦ä¸€è‡´æ€§ï¼Œæ›´æ–°å¾ˆç½•è§ï¼Ÿ ","date":"2024-09-15","objectID":"/posts/ix-paper/:6:4","tags":["Paper Reading"],"title":"Paper Reading: IX: A Protected Dataplane Operating System","uri":"/posts/ix-paper/"},{"categories":null,"content":"Security Model IX API åŠå…¶å®ç°é‡‡ç”¨äº†ä¸€ç§åº”ç”¨ç¨‹åºä»£ç ä¸ç½‘ç»œå¤„ç†æ ˆä¹‹é—´çš„åä½œæµæ§æ¨¡å‹ã€‚ä¸ç”¨æˆ·çº§æ ˆä¸åŒï¼Œåœ¨ç”¨æˆ·çº§æ ˆä¸­ï¼Œåº”ç”¨ç¨‹åºè¢«ä¿¡ä»»ä»¥æ­£ç¡®æ‰§è¡Œç½‘ç»œè¡Œä¸ºï¼Œè€Œ IX çš„ä¿æŠ¤æ¨¡å‹å¯¹åº”ç”¨ç¨‹åºçš„å‡è®¾å¾ˆå°‘ã€‚æ¶æ„æˆ–è¡Œä¸ºä¸ç«¯çš„åº”ç”¨ç¨‹åºåªèƒ½ä¼¤å®³è‡ªèº«ï¼Œè€Œä¸èƒ½ç ´åç½‘ç»œæ ˆæˆ–å½±å“å…¶ä»–åº”ç”¨ç¨‹åºã€‚IX ä¸­çš„æ‰€æœ‰åº”ç”¨ç¨‹åºä»£ç éƒ½åœ¨ç”¨æˆ·æ¨¡å¼ä¸‹è¿è¡Œï¼Œè€Œæ•°æ®å¹³é¢ä»£ç åˆ™åœ¨å—ä¿æŠ¤çš„ Ring 0 ä¸­è¿è¡Œã€‚åº”ç”¨ç¨‹åºæ— æ³•è®¿é—®æ•°æ®å¹³é¢å†…å­˜ï¼Œé™¤éæ˜¯åªè¯»çš„æ¶ˆæ¯ç¼“å†²åŒºã€‚æ— æ³•é€šè¿‡æ‰¹é‡ç³»ç»Ÿè°ƒç”¨æˆ–å…¶ä»–ç”¨æˆ·çº§æ“ä½œæ¥è¿åå¯¹ TCP å’Œå…¶ä»–ç½‘ç»œè§„èŒƒçš„æ­£ç¡®éµå¾ªã€‚æ­¤å¤–ï¼Œæ•°æ®å¹³é¢å¯ç”¨äºå¼ºåˆ¶æ‰§è¡Œç½‘ç»œå®‰å…¨ç­–ç•¥ï¼Œå¦‚é˜²ç«å¢™å’Œè®¿é—®æ§åˆ¶åˆ—è¡¨ã€‚IX çš„å®‰å…¨æ¨¡å‹ä¸ä¼ ç»Ÿçš„åŸºäºå†…æ ¸çš„ç½‘ç»œæ ˆä¸€æ ·å¼ºå¤§ï¼Œè¿™æ˜¯æ‰€æœ‰æœ€è¿‘æå‡ºçš„ç”¨æˆ·çº§æ ˆæ‰€ä¸å…·å¤‡çš„ç‰¹æ€§ã€‚ IX åˆ©ç”¨äº† vt-x ring3 å’Œ ring0 å§ï¼Œåº”è¯¥æ˜¯æ¯” dune æ›´å®‰å…¨ï¼Ÿåˆ†ç¦»ä¹Ÿä½¿å¾—æ›´å®‰å…¨ IO MMU æ²¡æœ‰ç”¨åˆ°ï¼Ÿ ","date":"2024-09-15","objectID":"/posts/ix-paper/:6:5","tags":["Paper Reading"],"title":"Paper Reading: IX: A Protected Dataplane Operating System","uri":"/posts/ix-paper/"},{"categories":null,"content":"Evaluation evaluation è¡¨ç°éƒ½éå¸¸å¥½ï¼Œå¯¹æ¯”äº† Linux å’Œç”¨æˆ·æ€çš„ mTCPï¼Œ éƒ½ä½¿ç”¨äº† TCP ","date":"2024-09-15","objectID":"/posts/ix-paper/:7:0","tags":["Paper Reading"],"title":"Paper Reading: IX: A Protected Dataplane Operating System","uri":"/posts/ix-paper/"},{"categories":null,"content":"Experimental Methodology æˆ‘ä»¬å¯ç”¨äº†è¶…çº¿ç¨‹ï¼Œå› ä¸ºå®ƒå¯ä»¥æé«˜æ€§èƒ½ æˆ‘ä»¬çš„åŸºå‡†æµ‹è¯•çš„ Linux å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å®ç°ä½¿ç”¨äº† libevent æ¡†æ¶å’Œ epoll ç³»ç»Ÿè°ƒç”¨ã€‚æˆ‘ä»¬ä»å…¬å…±é¢†åŸŸå‘å¸ƒä¸­ä¸‹è½½å¹¶å®‰è£…äº† mTCP [30]ï¼Œä½†å¿…é¡»ä½¿ç”¨ mTCP API è‡ªå·±ç¼–å†™åŸºå‡†æµ‹è¯•ã€‚æˆ‘ä»¬ä½¿ç”¨ 2.6.36 Linux å†…æ ¸è¿è¡Œ mTCPï¼Œå› ä¸ºè¿™æ˜¯æœ€æ–°æ”¯æŒçš„å†…æ ¸ç‰ˆæœ¬ã€‚æˆ‘ä»¬åªæŠ¥å‘Šäº† mTCP çš„ 10GbE ç»“æœï¼Œå› ä¸ºå®ƒä¸æ”¯æŒ NIC ç»‘å®šã€‚å¯¹äº IXï¼Œæˆ‘ä»¬å°†æœ€å¤§æ‰¹å¤„ç†å¤§å°ç»‘å®šåˆ°æ¯æ¬¡è¿­ä»£ B=64 ä¸ªæ•°æ®åŒ…ï¼Œè¿™åœ¨å¾®åŸºå‡†æµ‹è¯•ä¸­æœ€å¤§åŒ–ååé‡ ","date":"2024-09-15","objectID":"/posts/ix-paper/:7:1","tags":["Paper Reading"],"title":"Paper Reading: IX: A Protected Dataplane Operating System","uri":"/posts/ix-paper/"},{"categories":null,"content":"Latency and Single-flow Bandwidth NetPIPE ping-pong benchmark IX æœåŠ¡å™¨çš„å•å‘å»¶è¿Ÿä¸º 5.7Î¼s, å¹¶å®ç°äº† 5Gbps çš„ååé‡ï¼Œè¿™æ˜¯æœ€å¤§å€¼çš„ä¸€åŠï¼Œæ¶ˆæ¯å¤§å°ä»…ä¸º 20KB ä¸¤ä¸ª Linux æœåŠ¡å™¨çš„å•å‘å»¶è¿Ÿä¸º 24Î¼s, 385KB messages to achieve 5Gbps Linux æ˜¯å› ä¸ºä¸­æ–­ï¼Œå¸¦æ¥å»¶è¿Ÿ mTCP ä½¿ç”¨ç§¯æçš„æ‰¹å¤„ç†æ¥æŠµæ¶ˆä¸Šä¸‹æ–‡åˆ‡æ¢çš„æˆæœ¬ï¼Œè¿™åœ¨ç‰¹å®šæµ‹è¯•ä¸­ä»¥æ›´é«˜çš„å»¶è¿Ÿä¸ºä»£ä»·ï¼Œé«˜äº IX å’Œ Linuxã€‚ IX æ¶ˆæ¯å°ï¼Œå¤„ç†å¾ˆå¿«ï¼Œèƒ½è¾¾åˆ°é«˜åå 5Gbpsï¼Œå•é¡¹å»¶è¿Ÿå¾ˆä½ ","date":"2024-09-15","objectID":"/posts/ix-paper/:7:2","tags":["Paper Reading"],"title":"Paper Reading: IX: A Protected Dataplane Operating System","uri":"/posts/ix-paper/"},{"categories":null,"content":"Throughput and Scalability å¯¹äºæ‰€æœ‰ä¸‰ä¸ªæµ‹è¯•ï¼ˆæ ¸å¿ƒæ‰©å±•ã€æ¶ˆæ¯è®¡æ•°æ‰©å±•ã€æ¶ˆæ¯å¤§å°æ‰©å±•ï¼‰ï¼ŒIX çš„æ‰©å±•æ€§éƒ½æ¯” mTCP å’Œ Linux æ›´æ¿€è¿›ã€‚å›¾ 3a æ˜¾ç¤ºï¼ŒIX ä»…éœ€è¦ 3 ä¸ªæ ¸å¿ƒå³å¯é¥±å’Œ 10GbE é“¾è·¯ï¼Œè€Œ mTCP éœ€è¦æ‰€æœ‰ 8 ä¸ªæ ¸å¿ƒã€‚åœ¨å›¾ 3b ä¸­ï¼Œå¯¹äºæ¯ä¸ªè¿æ¥ 1024 æ¬¡å¾€è¿”ï¼ŒIX æ¯ç§’äº¤ä»˜ 880 ä¸‡æ¡æ¶ˆæ¯ï¼Œè¿™æ˜¯ mTCP ååé‡çš„ 1.9 å€ï¼Œæ˜¯ Linux çš„ 8.8 å€ã€‚åœ¨è¿™ä¸ªæ•°æ®åŒ…é€Ÿç‡ä¸‹ï¼ŒIX è¾¾åˆ°äº†çº¿è·¯é€Ÿç‡ï¼Œä»…å—é™äº 10GbE å¸¦å®½ã€‚ IX å‡ ä¹æ˜¯çº¿æ€§æ‰©å±•ï¼Œæ ¸å¿ƒè¶Šå¤šååé‡è¶Šå¤§ï¼Œä¼°è®¡åˆ†ç¦»å’Œå¼¹æ€§çº¿ç¨‹ç»‘å®š CPU + æ‰¹å¤„ç†ï¼ˆå‡å°‘ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Ÿï¼‰å¸¦æ¥äº†å¾ˆå¤šå¥½å¤„ ","date":"2024-09-15","objectID":"/posts/ix-paper/:7:3","tags":["Paper Reading"],"title":"Paper Reading: IX: A Protected Dataplane Operating System","uri":"/posts/ix-paper/"},{"categories":null,"content":"Connection Scalability èƒ½å¤„ç†å¤§é‡è¿æ¥ a large number of concurrent connections æœ€å¤š 250,000 ä¸ªè¿æ¥ï¼Œè¿™æ˜¯æˆ‘ä»¬å¯ç”¨å®¢æˆ·ç«¯æœºå™¨çš„ä¸Šé™ã€‚æ­£å¦‚é¢„æœŸçš„é‚£æ ·ï¼Œååé‡éšç€è¿æ¥å¹¶å‘åº¦çš„å¢åŠ è€Œå¢åŠ ï¼Œä½†å¯¹äºéå¸¸å¤§çš„è¿æ¥æ•°ï¼Œç”±äºåœ¨æ‰“å¼€çš„è¿æ¥ä¹‹é—´è¿›è¡Œå¤šè·¯å¤ç”¨çš„æˆæœ¬è¶Šæ¥è¶Šé«˜ï¼Œååé‡ä¼šä¸‹é™ã€‚åœ¨å³°å€¼æ—¶ï¼ŒIX çš„æ€§èƒ½æ¯” Linux å¥½ 10 å€ï¼Œä¸å›¾ 3b çš„ç»“æœä¸€è‡´ã€‚åœ¨ 250,000 ä¸ªè¿æ¥å’Œ 4x10GbE çš„æƒ…å†µä¸‹ï¼ŒIX èƒ½å¤Ÿè¾¾åˆ°å…¶å³°å€¼ååé‡çš„ 47%ã€‚ Linux åº”è¯¥å¾ˆéš¾åšåˆ°ï¼Œä½† IX ä¹Ÿæœ‰å¤§é‡çš„ L3 ç¼“å­˜æœªå‘½ä¸­ï¼Ÿå¯ä»¥é€šè¿‡è¿›ä¸€æ­¥ä¼˜åŒ– lwIP å’Œ TCP/IP åè®®æ§åˆ¶å—ç»“æ„å¤§å°å’Œè®¿é—®æ¨¡å¼ï¼ˆè¿™é‡Œæ²¡çœ‹æ‡‚ï¼‰ ","date":"2024-09-15","objectID":"/posts/ix-paper/:7:4","tags":["Paper Reading"],"title":"Paper Reading: IX: A Protected Dataplane Operating System","uri":"/posts/ix-paper/"},{"categories":null,"content":"Memcached Performance å¹³å‡å’Œç¬¬ 99 ç™¾åˆ†ä½å»¶è¿Ÿä½œä¸ºå®ç°ååé‡ ç¬¬ 99 ç™¾åˆ†ä½å»¶è¿Ÿæ•æ‰å°¾éƒ¨å»¶è¿Ÿé—®é¢˜ï¼Œæ˜¯æ•°æ®ä¸­å¿ƒåº”ç”¨ç¨‹åºæœ€ç›¸å…³çš„æŒ‡æ ‡ [14]ã€‚å¤§å¤šæ•°å•†ä¸š memcached éƒ¨ç½²éƒ½ä¸ºæ¯ä¸ªæœåŠ¡å™¨é…ç½®ï¼Œä»¥ä½¿ç¬¬ 99 ç™¾åˆ†ä½å»¶è¿Ÿä¸è¶…è¿‡ 200Î¼s åˆ° 500Î¼sã€‚ æˆ‘ä»¬å°šæœªå°è¯•è°ƒæ•´ memcached çš„å†…éƒ¨å¯æ‰©å±•æ€§ [20] æˆ–æ”¯æŒé›¶æ‹·è´ I/O æ“ä½œ IX æ˜¾è‘—å‡å°‘äº†æœªåŠ è½½çš„å»¶è¿Ÿï¼Œå¤§çº¦å‡å°‘äº†ä¸€åŠ è¿™é‡Œå¾ˆå¥‡æ€ªï¼Œä¸ºä»€ä¹ˆæ²¡æ”¯æŒé›¶æ‹·è´ï¼Ÿä½†è¡¨ç°ä»å¥½äº Linux è€Œä¸”å¥½å¤ªå¤šäº† ","date":"2024-09-15","objectID":"/posts/ix-paper/:7:5","tags":["Paper Reading"],"title":"Paper Reading: IX: A Protected Dataplane Operating System","uri":"/posts/ix-paper/"},{"categories":null,"content":"Discussion What makes IX fast: a networking stack can be implemented in a protected OS kernel and still deliver wire-rate performance for most benchmark IX çš„å¥½å¤„ä¸ä»…ä»…æ˜¯æœ€å°åŒ–å†…æ ¸å¼€é”€ï¼Œé›¶æ‹·è´æ–¹æ³•ä¹Ÿæœ‰æ‰€å¸®åŠ© æ²¡æœ‰ä¸­é—´ç¼“å†²åŒºå…è®¸é«˜æ•ˆã€ç‰¹å®šäºåº”ç”¨ç¨‹åºçš„ I/O æŠ½è±¡å®ç°ï¼Œä¾‹å¦‚ libix äº‹ä»¶åº“ æ²¡æœ‰ä¸­é—´ç¼“å†²åŒºæ˜¯ä»€ä¹ˆæ„æ€ï¼Œä¼ ç»Ÿç½‘ç»œæ ˆåº”è¯¥æ˜¯æœ‰çš„ï¼Œè€Œä¸”éœ€è¦åœ¨ä¸­é—´ç¼“å†²åŒºåšæ‹·è´ IX å»æ‰ä¸­é—´ç¼“å†²åŒºï¼Œç”¨é›¶æ‹·è´ã€å…±äº«å†…å­˜æ¥æé«˜æ€§èƒ½ï¼Œåˆç”¨ Dune/VT-X æ¥ä¿æŠ¤è™šæ‹Ÿå†…å­˜ï¼Ÿ æœ€åï¼Œæˆ‘ä»¬ä»”ç»†è°ƒæ•´äº† IX ä»¥å®ç°å¤šæ ¸å¯æ‰©å±•æ€§ï¼Œæ¶ˆé™¤äº†å¼•å…¥åŒæ­¥æˆ–ä¸€è‡´æ€§æµé‡çš„æ„é€ ã€‚ Dune å¯¹å¤šæ ¸çš„æ”¯æŒä¸å¤ªå¥½å§ï¼Œä¸çŸ¥é“ IX æ˜¯å¦‚ä½•è§£å†³çš„ï¼Ÿæ˜¯å¼¹æ€§çº¿ç¨‹å— IX æ•°æ®å¹³é¢ä¼˜åŒ–â€”â€”å®Œæˆè¿è¡Œã€è‡ªé€‚åº”æ‰¹å¤„ç†å’Œé›¶æ‹·è´ APIâ€”â€”ä¹Ÿå¯ä»¥åœ¨ç”¨æˆ·çº§ç½‘ç»œæ ˆä¸­å®ç°ï¼Œä»¥è·å¾—ç±»ä¼¼çš„ååé‡å’Œå»¶è¿Ÿæ–¹é¢çš„ä¼˜åŠ¿ã€‚è™½ç„¶ç”¨æˆ·çº§å®ç°ä¼šæ¶ˆé™¤ä¿æŠ¤åŸŸäº¤å‰ï¼Œä½†è¿™ä¸ä¼šå¯¼è‡´æ¯” IX æ˜¾è‘—çš„æ€§èƒ½æå‡ã€‚VMX éæ ¹æ¨¡å¼å†…çš„ä¿æŠ¤åŸŸäº¤å‰åªä¼šå¢åŠ å°‘é‡çš„é¢å¤–å¼€é”€ï¼Œå¤§çº¦ç›¸å½“äºä¸€æ¬¡ L3 ç¼“å­˜æœªå‘½ä¸­ [7]ã€‚æ­¤å¤–ï¼Œè¿™äº›å¼€é”€åœ¨æ›´é«˜çš„æ•°æ®åŒ…é€Ÿç‡ä¸‹å¾ˆå¿«è¢«åˆ†æ‘Šã€‚ è¿™ä¸€æ®µå¾ˆé‡è¦ï¼Œ IX æ¯”ç”¨æˆ·çº§ç½‘ç»œæ ˆå¿«çš„åŸå› åˆ°åº•æ˜¯ä»€ä¹ˆã€‚ç”¨æˆ·çº§æ¶ˆé™¤äº†ä»€ä¹ˆï¼Œæ˜¯è¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢å—ï¼ŒVMX non-root åˆ‡æ¢åº”è¯¥ä¹Ÿæœ‰é¢å¤–å¼€é”€å§ æ‰¹å¤„ç†é€šå¸¸è¢«ç†è§£ä¸ºåœ¨ä½è´Ÿè½½æ—¶ä»¥æ›´é«˜çš„å»¶è¿Ÿæ¢å–é«˜è´Ÿè½½æ—¶æ›´å¥½çš„ååé‡ã€‚IX ä½¿ç”¨è‡ªé€‚åº”ã€æœ‰ç•Œçš„æ‰¹å¤„ç†æ¥å®é™…æ”¹å–„è¿™ä¸¤ä¸ªæŒ‡æ ‡ã€‚å›¾ 6 æ¯”è¾ƒäº†ä¸åŒæ‰¹å¤„ç†å¤§å°ä¸Šé™ B å¯¹ USR memcached å·¥ä½œè´Ÿè½½ï¼ˆå›¾ 5ï¼‰çš„å»¶è¿Ÿä¸ååé‡çš„å½±å“ã€‚åœ¨ä½è´Ÿè½½ä¸‹ï¼ŒB ä¸ä¼šå½±å“å°¾éƒ¨å»¶è¿Ÿï¼Œå› ä¸ºè‡ªé€‚åº”æ‰¹å¤„ç†ä¸ä¼šå»¶è¿ŸæŒ‚èµ·æ•°æ®åŒ…çš„å¤„ç†ã€‚åœ¨è¾ƒé«˜è´Ÿè½½ä¸‹ï¼Œè¾ƒå¤§çš„ B å€¼æé«˜äº†ååé‡ï¼Œä» B=1 åˆ° B=16 æé«˜äº† 29%ã€‚å¯¹äºè¿™ä¸ªå·¥ä½œè´Ÿè½½ï¼ŒBâ‰¥16 æœ€å¤§åŒ–ååé‡ã€‚ åœ¨è°ƒæ•´ IX æ€§èƒ½æ—¶ï¼Œæˆ‘ä»¬é‡åˆ°äº†ä¸€ä¸ªæ„å¤–çš„ç¡¬ä»¶é™åˆ¶ï¼Œè¯¥é™åˆ¶åœ¨é«˜æ•°æ®åŒ…é€Ÿç‡å’Œå°å¹³å‡æ‰¹å¤„ç†å¤§å°ï¼ˆå³åœ¨æ•°æ®å¹³é¢é¥±å’Œä¹‹å‰ï¼‰æ—¶è¢«è§¦å‘ï¼šæ¯æ¬¡è¿­ä»£å‘å¸ƒæ–°æè¿°ç¬¦æ‰€éœ€çš„ PCIe å†™å…¥ç‡é«˜å¯¼è‡´æ€§èƒ½ä¸‹é™ï¼Œå› ä¸ºæˆ‘ä»¬æ‰©å±•äº†æ ¸å¿ƒæ•°é‡ã€‚ä¸ºäº†é¿å…è¿™ä¸ªç“¶é¢ˆï¼Œæˆ‘ä»¬ç®€å•åœ°åœ¨æ¥æ”¶è·¯å¾„ä¸Šåˆå¹¶ PCIe å†™å…¥ï¼Œä»¥ä¾¿æˆ‘ä»¬æ¯æ¬¡è‡³å°‘è¡¥å…… 32 ä¸ªæè¿°ç¬¦æ¡ç›®ã€‚å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬ä¸å¿…åœ¨å‘é€è·¯å¾„ä¸Šåˆå¹¶ PCIe å†™å…¥ï¼Œå› ä¸ºè¿™ä¼šå½±å“å»¶è¿Ÿã€‚ ä¸Šç•Œ B åœ¨å“ªé‡Œè°ƒæ•´çš„ï¼Œæ„Ÿè§‰è®ºæ–‡æ²¡æœ‰ä»”ç»†è®¨è®ºè¿™ä¸€å—ï¼Œé›¶æ‹·è´å¥½åƒä¹Ÿæ²¡æ€ä¹ˆè®¨è®º åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬åªæµ‹è¯•äº†é™æ€é…ç½®ã€‚åœ¨æœªæ¥çš„å·¥ä½œä¸­ï¼Œæˆ‘ä»¬å°†æ¢ç´¢æ§åˆ¶å¹³é¢é—®é¢˜ï¼ŒåŒ…æ‹¬åŠ¨æ€è¿è¡Œæ—¶ï¼Œä»¥åœ¨ä¿æŒååé‡å’Œå»¶è¿Ÿçº¦æŸçš„åŒæ—¶ï¼Œåœ¨å¯ç”¨å¼¹æ€§çº¿ç¨‹ä¹‹é—´é‡æ–°å¹³è¡¡ç½‘ç»œæµã€‚ é™¤äº† TCP åº”è¯¥è¿˜å¯ä»¥åš UDPï¼Ÿ ","date":"2024-09-15","objectID":"/posts/ix-paper/:8:0","tags":["Paper Reading"],"title":"Paper Reading: IX: A Protected Dataplane Operating System","uri":"/posts/ix-paper/"},{"categories":null,"content":"Related Work ä¸ IX ç±»ä¼¼ï¼ŒArrakis ä½¿ç”¨ç¡¬ä»¶è™šæ‹ŸåŒ–å°† I/O æ•°æ®å¹³é¢ä¸æ§åˆ¶å¹³é¢åˆ†ç¦» [50]ã€‚IX çš„ä¸åŒä¹‹å¤„åœ¨äºå®ƒä½¿ç”¨å®Œæ•´çš„ Linux å†…æ ¸ä½œä¸ºæ§åˆ¶å¹³é¢ï¼›åœ¨æ§åˆ¶å¹³é¢ã€ç½‘ç»œæ ˆå’Œåº”ç”¨ç¨‹åºä¹‹é—´æä¾›ä¸‰å‘éš”ç¦»ï¼›å¹¶æå‡ºäº†ä¸€ç§æ•°æ®å¹³é¢æ¶æ„ï¼Œè¯¥æ¶æ„é’ˆå¯¹é«˜ååé‡å’Œä½å»¶è¿Ÿè¿›è¡Œäº†ä¼˜åŒ–ã€‚å¦ä¸€æ–¹é¢ï¼ŒArrakis ä½¿ç”¨ Barrelfish ä½œä¸ºæ§åˆ¶å¹³é¢ [6]ï¼Œå¹¶åŒ…æ‹¬å¯¹ IOMMU å’Œ SR-IOV çš„æ”¯æŒã€‚ ","date":"2024-09-15","objectID":"/posts/ix-paper/:9:0","tags":["Paper Reading"],"title":"Paper Reading: IX: A Protected Dataplane Operating System","uri":"/posts/ix-paper/"},{"categories":null,"content":"Conclusion memcached ç§»æ¤åˆ° IX å¯ä»¥æ¶ˆé™¤å†…æ ¸ç“¶é¢ˆï¼Œå¹¶å°†ååé‡æé«˜å¤šè¾¾ 3.6 å€ï¼ŒåŒæ—¶å°†å°¾éƒ¨å»¶è¿Ÿå‡å°‘è¶…è¿‡ 2 å€ã€‚ ","date":"2024-09-15","objectID":"/posts/ix-paper/:10:0","tags":["Paper Reading"],"title":"Paper Reading: IX: A Protected Dataplane Operating System","uri":"/posts/ix-paper/"},{"categories":null,"content":"Dune: Safe User-level Access to Privileged CPU Features æ˜¯ MIT OS è¯¾ä¸Šçš„è®²åº§ï¼Œä¹Ÿæ˜¯ä¸€ç¯‡å¾ˆæœ‰æ„æ€çš„è®ºæ–‡ï¼Œå¾ˆç±»ä¼¼ exokernelï¼Œä¸è¿‡æ›´åƒæ˜¯å†…æ ¸ä¸Šçš„åŠŸèƒ½ï¼Œåˆ©ç”¨è™šæ‹ŸåŒ–ä½¿å¾—è¿›ç¨‹å¯ä»¥è®¿é—®ä¸€äº›å†…æ ¸æ€çš„åŠŸèƒ½ï¼Œæ¯”å¦‚æš´éœ² page tableï¼Œä½¿å¾— jvm å¯ä»¥è¿›è¡Œæ›´é«˜çº§çš„ GCã€‚åç»­ä¹Ÿæœ‰ IXï¼ŒZygOS ç­‰ç›¸å…³è®ºæ–‡ã€‚ ","date":"2024-09-11","objectID":"/posts/dune-paper/:1:0","tags":["Paper Reading"],"title":"Paper Reading: Dune","uri":"/posts/dune-paper/"},{"categories":null,"content":"Abstract Dune æ˜¯ä¸€ä¸ªç³»ç»Ÿï¼Œå®ƒä¸ºåº”ç”¨ç¨‹åºæä¾›äº†ç›´æ¥ä½†å®‰å…¨çš„ç¡¬ä»¶ç‰¹æ€§è®¿é—®ï¼Œä¾‹å¦‚ç¯ä¿æŠ¤ã€é¡µè¡¨å’Œæ ‡è®° TLBï¼ŒåŒæ—¶ä¿ç•™äº†ç°æœ‰æ“ä½œç³»ç»Ÿå¯¹è¿›ç¨‹çš„æ¥å£ã€‚Dune åˆ©ç”¨ç°ä»£å¤„ç†å™¨ä¸­çš„è™šæ‹ŸåŒ–ç¡¬ä»¶ä¸ºè¿›ç¨‹æä¾›æŠ½è±¡ï¼Œè€Œä¸æ˜¯æœºå™¨æŠ½è±¡ã€‚å®ƒç”±ä¸€ä¸ªå°çš„å†…æ ¸æ¨¡å—ç»„æˆï¼Œè¯¥æ¨¡å—åˆå§‹åŒ–è™šæ‹ŸåŒ–ç¡¬ä»¶å¹¶ä¸å†…æ ¸äº¤äº’ï¼Œä»¥åŠä¸€ä¸ªç”¨æˆ·çº§åº“ï¼Œå¸®åŠ©åº”ç”¨ç¨‹åºç®¡ç†ç‰¹æƒç¡¬ä»¶åŠŸèƒ½ã€‚æˆ‘ä»¬ä»‹ç»äº† Dune åœ¨ 64 ä½ x86 Linux ä¸Šçš„å®ç°ã€‚æˆ‘ä»¬ä½¿ç”¨ Dune å®ç°äº†ä¸‰ä¸ªå¯ä»¥ä»è®¿é—®ç‰¹æƒç¡¬ä»¶ä¸­å—ç›Šçš„ç”¨æˆ·çº§åº”ç”¨ç¨‹åºï¼šä¸€ä¸ªç”¨äºä¸å—ä¿¡ä»»ä»£ç çš„æ²™ç®±ã€ä¸€ä¸ªç‰¹æƒåˆ†ç¦»è®¾æ–½å’Œä¸€ä¸ªåƒåœ¾æ”¶é›†å™¨ã€‚ä½¿ç”¨ Dune æå¤§åœ°ç®€åŒ–äº†è¿™äº›åº”ç”¨ç¨‹åºçš„å®ç°ï¼Œå¹¶æä¾›äº†æ˜¾è‘—çš„æ€§èƒ½ä¼˜åŠ¿ã€‚ å’Œ exokernel å¾ˆç±»ä¼¼ ","date":"2024-09-11","objectID":"/posts/dune-paper/:2:0","tags":["Paper Reading"],"title":"Paper Reading: Dune","uri":"/posts/dune-paper/"},{"categories":null,"content":"Introduction è®¸å¤šåº”ç”¨ç¨‹åºå¯ä»¥ä»è®¿é—®â€œä»…å†…æ ¸å¯ç”¨â€çš„ç¡¬ä»¶ç‰¹æ€§ä¸­å—ç›Šã€‚ä¾‹å¦‚ï¼ŒAzul Systems é€šè¿‡ä½¿ç”¨åˆ†é¡µç¡¬ä»¶æ˜¾è‘—åŠ é€Ÿäº†åƒåœ¾å›æ”¶ [15, 36]ã€‚å¦ä¸€ä¸ªä¾‹å­æ˜¯è¿›ç¨‹è¿ç§»ï¼Œå°½ç®¡å¯ä»¥åœ¨ç”¨æˆ·ç¨‹åºä¸­å®ç°ï¼Œä½†å¦‚æœèƒ½è®¿é—®é¡µé”™è¯¯ [40] å’Œç³»ç»Ÿè°ƒç”¨ [32]ï¼Œå°†ä¼šå—ç›ŠåŒªæµ…ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç”šè‡³å¯èƒ½éœ€è¦å®Œå…¨æ›¿æ¢å†…æ ¸ä»¥æ»¡è¶³ç‰¹å®šåº”ç”¨ç¨‹åºçš„éœ€æ±‚ã€‚ä¾‹å¦‚ï¼ŒIBOS é€šè¿‡å°†æµè§ˆå™¨æŠ½è±¡ç§»åˆ°æœ€ä½çš„æ“ä½œç³»ç»Ÿå±‚æ¥æé«˜æµè§ˆå™¨å®‰å…¨æ€§ [35]ã€‚ æ„Ÿè§‰æœ€ä¸»è¦çš„å¥½å¤„å°±æ˜¯å¸®åŠ© GC åšå¾—æ›´å¥½ï¼Œèƒ½çŸ¥é“é¡µé”™è¯¯å‡ºäº†ä»€ä¹ˆé—®é¢˜ è¿™ç±»ç³»ç»Ÿéœ€è¦å¯¹å†…æ ¸è¿›è¡Œä¿®æ”¹ï¼Œå› ä¸ºå‡ºäºå®‰å…¨å’Œéš”ç¦»çš„åŸå› ï¼Œç”¨æˆ·ç©ºé—´çš„ç¡¬ä»¶è®¿é—®æ˜¯å—é™çš„ã€‚ä¸å¹¸çš„æ˜¯ï¼Œåœ¨å®è·µä¸­ä¿®æ”¹å†…æ ¸å¹¶ä¸ç†æƒ³ï¼Œå› ä¸ºå†…æ ¸çš„ä¿®æ”¹å¯èƒ½ä¼šç›¸å½“ä¾µå…¥æ€§ï¼Œå¦‚æœæ“ä½œä¸å½“ï¼Œä¼šå½±å“æ•´ä¸ªç³»ç»Ÿçš„ç¨³å®šæ€§ã€‚æ­¤å¤–ï¼Œå¦‚æœå¤šä¸ªåº”ç”¨ç¨‹åºéœ€è¦å†…æ ¸ä¿®æ”¹ï¼Œæ— æ³•ä¿è¯è¿™äº›ä¿®æ”¹èƒ½å¤Ÿå…¼å®¹ã€‚å¦ä¸€ç§ç­–ç•¥æ˜¯å°†åº”ç”¨ç¨‹åºæ‰“åŒ…åˆ°å¸¦æœ‰ä¸“ç”¨å†…æ ¸çš„è™šæ‹Ÿæœºé•œåƒä¸­ [4, 14]ã€‚è®¸å¤šç°ä»£ CPU åŒ…å«è™šæ‹ŸåŒ–ç¡¬ä»¶ï¼Œä½¿å®¢æˆ·æ“ä½œç³»ç»Ÿèƒ½å¤Ÿå®‰å…¨é«˜æ•ˆåœ°è®¿é—®å†…æ ¸ç¡¬ä»¶ç‰¹æ€§ã€‚æ­¤å¤–ï¼Œè™šæ‹Ÿæœºæä¾›äº†ç±»ä¼¼äºè¿›ç¨‹çš„æ•…éšœéš”ç¦»â€”â€”å³ï¼Œé”™è¯¯æˆ–æ¶æ„è¡Œä¸ºä¸åº”å¯¼è‡´æ•´ä¸ªç‰©ç†æœºå™¨å´©æºƒã€‚ ç”Ÿäº§å†…æ ¸å¦‚ Linux å¤æ‚ä¸”éš¾ä»¥ä¿®æ”¹ã€‚ç„¶è€Œï¼Œå®ç°ä¸€ä¸ªå¸¦æœ‰ç®€å•è™šæ‹Ÿå†…å­˜å±‚çš„ä¸“ç”¨å†…æ ¸ä¹ŸåŒæ ·å…·æœ‰æŒ‘æˆ˜æ€§ã€‚é™¤äº†è™šæ‹Ÿå†…å­˜ï¼Œè¿˜å¿…é¡»æ”¯æŒæ–‡ä»¶ç³»ç»Ÿã€ç½‘ç»œæ ˆã€è®¾å¤‡é©±åŠ¨ç¨‹åºå’Œå¼•å¯¼è¿‡ç¨‹ã€‚ æœ¬æ–‡ä»‹ç»äº†ä¸€ç§æ–°çš„åº”ç”¨ç¨‹åºä½¿ç”¨å†…æ ¸ç¡¬ä»¶ç‰¹æ€§çš„æ–¹æ³•ï¼šä½¿ç”¨using virtualization hardware to provide a processï¼Œè€Œä¸æ˜¯machine abstractionã€‚æˆ‘ä»¬åœ¨ 64 ä½ Intel CPU ä¸Šçš„ Linux ç³»ç»Ÿä¸­å®ç°äº†è¿™ç§æ–¹æ³•ï¼Œç§°ä¸º Duneã€‚Dune æä¾›äº†ä¸€ä¸ªå¯åŠ è½½çš„å†…æ ¸æ¨¡å—ï¼Œè¯¥æ¨¡å—ä¸æœªä¿®æ”¹çš„ Linux å†…æ ¸é…åˆå·¥ä½œã€‚è¯¥æ¨¡å—å…è®¸è¿›ç¨‹è¿›å…¥â€œDune æ¨¡å¼â€ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸å¯é€†çš„è½¬æ¢ï¼Œé€šè¿‡è™šæ‹ŸåŒ–ç¡¬ä»¶ï¼Œå®‰å…¨å¿«é€Ÿåœ°è®¿é—®ç‰¹æƒç¡¬ä»¶ç‰¹æ€§ï¼ŒåŒ…æ‹¬ç‰¹æƒæ¨¡å¼ã€è™šæ‹Ÿå†…å­˜å¯„å­˜å™¨ã€é¡µè¡¨å’Œä¸­æ–­ã€å¼‚å¸¸åŠç³»ç»Ÿè°ƒç”¨å‘é‡ã€‚æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªç”¨æˆ·çº§åº“ libDuneï¼Œä»¥ä¿ƒè¿›è¿™äº›ç‰¹æ€§çš„ä½¿ç”¨ã€‚ åŸºäº Linux å®ç°çš„ å¯¹äºç¬¦åˆå…¶èŒƒå¼çš„åº”ç”¨ç¨‹åºï¼ŒDune æ¯”è™šæ‹Ÿæœºæä¾›äº†å‡ ä¸ªä¼˜åŠ¿ã€‚é¦–å…ˆï¼ŒDune è¿›ç¨‹æ˜¯ä¸€ä¸ªæ­£å¸¸çš„ Linux è¿›ç¨‹ï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯å®ƒä½¿ç”¨ VMCALL æŒ‡ä»¤æ¥è°ƒç”¨ç³»ç»Ÿè°ƒç”¨ã€‚è¿™æ„å‘³ç€ Dune è¿›ç¨‹å¯ä»¥å®Œå…¨è®¿é—®ç³»ç»Ÿçš„å…¶ä½™éƒ¨åˆ†ï¼Œå¹¶ä¸”æ˜¯ç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ï¼ŒDune åº”ç”¨ç¨‹åºæ˜“äºå¼€å‘ï¼ˆåƒåº”ç”¨ç¨‹åºç¼–ç¨‹ï¼Œè€Œä¸æ˜¯å†…æ ¸ç¼–ç¨‹ï¼‰ã€‚å…¶æ¬¡ï¼Œç”±äº Dune å†…æ ¸æ¨¡å—ä¸è¯•å›¾æä¾›æœºå™¨æŠ½è±¡ï¼Œæ¨¡å—å¯ä»¥æ›´ç®€å•ä¸”æ›´å¿«ã€‚ç‰¹åˆ«æ˜¯ï¼Œè™šæ‹ŸåŒ–ç¡¬ä»¶å¯ä»¥é…ç½®ä¸ºé¿å…ä¿å­˜å’Œæ¢å¤è™šæ‹Ÿæœºæ‰€éœ€çš„å‡ ç§ç¡¬ä»¶çŠ¶æ€ã€‚ VMCALL æ˜¯ä»€ä¹ˆï¼Œç±»ä¼¼ hyper-v ä¹‹ç±»çš„å—ï¼Ÿçœ‹ä¸Šå»åªæœ‰ x86 æ”¯æŒçš„æ¯”è¾ƒå¥½ï¼Ÿæ˜¯ä¸æ˜¯ä¸€ä¸ªé—®é¢˜å‘¢ã€‚VMCALL é€‚ç”¨äºæ‰€æœ‰æ”¯æŒ Intel VT-x æŠ€æœ¯çš„è™šæ‹ŸåŒ–ç¯å¢ƒï¼ŒåŒ…æ‹¬ KVMã€Xen ç­‰ã€‚é‚£ä¹ˆ Dune å’Œ KVM çš„åŒºåˆ«åˆæ˜¯ä»€ä¹ˆï¼Ÿåè€…å…¨è™šæ‹ŸåŒ–ï¼Œæä¾›æŠ½è±¡ç¡¬ä»¶ï¼Œè™šæ‹Ÿæœºèƒ½è¿è¡Œåœ¨ç‰©ç†ç¡¬ä»¶ä¸Šï¼Œæ˜¯ä¸€ä¸ªå†…æ ¸ï¼Ÿç»“åˆäº† QEMUï¼Œç±»ä¼¼è™šæ‹Ÿæœºè€Œä¸æ˜¯ç‰¹æƒè®¿é—®ã€‚ é€šè¿‡ Duneï¼Œæˆ‘ä»¬åšå‡ºäº†ä»¥ä¸‹è´¡çŒ®ï¼š æˆ‘ä»¬æå‡ºäº†ä¸€ç§è®¾è®¡ï¼Œåˆ©ç”¨ç¡¬ä»¶è¾…åŠ©è™šæ‹ŸåŒ–å®‰å…¨é«˜æ•ˆåœ°å‘ç”¨æˆ·ç¨‹åºæš´éœ²ç‰¹æƒç¡¬ä»¶ç‰¹æ€§ï¼ŒåŒæ—¶ä¿ç•™æ ‡å‡†æ“ä½œç³»ç»ŸæŠ½è±¡ã€‚ æˆ‘ä»¬è¯¦ç»†è¯„ä¼°äº†ä¸‰ç§ç¡¬ä»¶ç‰¹æ€§ï¼Œå¹¶å±•ç¤ºäº†å®ƒä»¬å¦‚ä½•ä½¿å—ç›Šäºç”¨æˆ·ç¨‹åºï¼šå¼‚å¸¸ã€åˆ†é¡µå’Œç‰¹æƒæ¨¡å¼ã€‚ æˆ‘ä»¬é€šè¿‡å®ç°å’Œè¯„ä¼°ä¸‰ä¸ªç”¨ä¾‹ï¼ˆæ²™ç®±ã€ç‰¹æƒåˆ†ç¦»å’Œåƒåœ¾å›æ”¶ï¼‰å±•ç¤ºäº† Dune çš„ç«¯åˆ°ç«¯å®ç”¨æ€§ã€‚ è™šæ‹ŸåŒ–æŠ€æœ¯æ„Ÿè§‰æ²¡ä»€ä¹ˆç¼ºç‚¹ï¼Œåˆå®‰å…¨ï¼Œæ€§èƒ½ä¹Ÿä¸å·®ï¼Œå¯èƒ½ä¹Ÿå°±å¼€é”€æ¯”è¾ƒå¤§å§ï¼Œå†å°±æ˜¯æŠŠè´Ÿæ‹…ç»™åˆ°å¼€å‘è€…ï¼Œéœ€è¦ç†Ÿæ‚‰è™šæ‹ŸåŒ–æŠ€æœ¯ã€ç‰¹æƒè®¿é—®ç­‰ç­‰ï¼Œ ","date":"2024-09-11","objectID":"/posts/dune-paper/:3:0","tags":["Paper Reading"],"title":"Paper Reading: Dune","uri":"/posts/dune-paper/"},{"categories":null,"content":"Virtualization and Hardware Dune èƒ½å¤Ÿæš´éœ²å“ªäº›ç‰¹æƒç¡¬ä»¶ç‰¹æ€§ æˆ‘ä»¬ä»¥ x86 CPU å’Œ Intel VT-x ä¸ºä¾‹æè¿° Duneã€‚ç„¶è€Œï¼Œè¿™å¹¶ä¸æ˜¯æˆ‘ä»¬è®¾è®¡çš„åŸºç¡€ï¼Œåœ¨ç¬¬ 7 èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†æ‰©å±•è®¨è®ºï¼ŒåŒ…æ‹¬æœªæ¥å¯èƒ½æ”¯æŒçš„å…¶ä»–æ¶æ„ã€‚ é—®é¢˜ä¹‹ä¸€æŠŠï¼Œä¸æ˜¯å¾ˆå¥½è·¨å¹³å° ","date":"2024-09-11","objectID":"/posts/dune-paper/:4:0","tags":["Paper Reading"],"title":"Paper Reading: Dune","uri":"/posts/dune-paper/"},{"categories":null,"content":"The Intel VT-x Extension Intel x86 (ISA) çš„è™šæ‹ŸåŒ–ï¼Œä½†æ˜¯ AMD çš„ä¸åŒ è™šæ‹Ÿå†…å­˜å¯èƒ½æ˜¯ VMM æœ€éš¾å®‰å…¨æš´éœ²çš„ç¡¬ä»¶ç‰¹æ€§ã€‚ å¯èƒ½æš´éœ²æ˜¯æ¯”è¾ƒå›°éš¾çš„ï¼Œéš¾åº¦æ¯”è¾ƒå¤§ï¼Œè¦ä¿è¯å®‰å…¨å¯ç”¨ ","date":"2024-09-11","objectID":"/posts/dune-paper/:4:1","tags":["Paper Reading"],"title":"Paper Reading: Dune","uri":"/posts/dune-paper/"},{"categories":null,"content":"Supported Hardware Features Dune ä½¿ç”¨ VT-x ä¸º x86 ä¿æŠ¤ç¡¬ä»¶æä¾›ç”¨æˆ·ç¨‹åºçš„å®Œå…¨è®¿é—®æƒé™ã€‚è¿™åŒ…æ‹¬ä¸‰ä¸ªç‰¹æƒç¡¬ä»¶ç‰¹æ€§ï¼š å¼‚å¸¸ã€è™šæ‹Ÿå†…å­˜å’Œç‰¹æƒæ¨¡å¼ã€‚ è¡¨ 1 æ˜¾ç¤ºäº†ä¸ºæ¯ä¸ªç‰¹æ€§æä¾›çš„ç›¸åº”ç‰¹æƒæŒ‡ä»¤ã€‚Dune è¿˜æš´éœ²äº†åˆ†æ®µï¼Œä½†æˆ‘ä»¬ä¸å†è¿›ä¸€æ­¥è®¨è®ºï¼Œå› ä¸ºå®ƒæ˜¯ç°ä»£ x86 CPU ä¸Šçš„ä¸»è¦é—ç•™æœºåˆ¶ã€‚ ç”¨æˆ·ç¨‹åºè¿˜å¯ä»¥ä»å¿«é€Ÿçµæ´»çš„è™šæ‹Ÿå†…å­˜è®¿é—®ä¸­å—ç›Š User programs can also benefit from fast and flexible access to virtual memory Dune è¿˜èµ‹äºˆç”¨æˆ·ç¨‹åºæ‰‹åŠ¨æ§åˆ¶ TLB å¤±æ•ˆçš„èƒ½åŠ› Dune also gives user programs the ability to manually control TLB invalidationsï¼Œ è¿™å…è®¸å•ä¸ªç”¨æˆ·ç¨‹åºé«˜æ•ˆåœ°åœ¨å¤šä¸ªé¡µè¡¨ä¹‹é—´åˆ‡æ¢ã€‚æ€»çš„æ¥è¯´ï¼Œæˆ‘ä»¬å±•ç¤ºäº†ä½¿ç”¨ Dune åœ¨ Appel å’Œ Li çš„ç”¨æˆ·çº§è™šæ‹Ÿå†…å­˜åŸºå‡†æµ‹è¯• [5] ä¸­æ¯” Linux å¿« 7 å€ æœ€åï¼ŒDune æš´éœ²äº†å¯¹ç‰¹æƒæ¨¡å¼çš„è®¿é—® Dune exposes access to privilege modes å°½ç®¡ Dune æš´éœ²çš„ç¡¬ä»¶ç‰¹æ€§è¶³ä»¥æ”¯æŒæˆ‘ä»¬çš„åŠ¨æœºç”¨ä¾‹ï¼Œä½†å…¶ä»–å‡ ä¸ªç¡¬ä»¶ç‰¹æ€§ï¼Œå¦‚ç¼“å­˜æ§åˆ¶ã€è°ƒè¯•å¯„å­˜å™¨å’Œè®¿é—® DMA è®¾å¤‡çš„èƒ½åŠ›ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è™šæ‹ŸåŒ–ç¡¬ä»¶å®‰å…¨åœ°æš´éœ²ã€‚æˆ‘ä»¬å°†è¿™äº›ç•™ç»™æœªæ¥çš„å·¥ä½œï¼Œå¹¶åœ¨ç¬¬ 7 èŠ‚ä¸­è®¨è®ºå®ƒä»¬çš„æ½œåŠ›ã€‚ æƒ³çŸ¥é“è¿™ä¸ªç¼“å­˜æ§åˆ¶ã€è®¿é—® DMA æ˜¯æ€ä¹ˆåšçš„ï¼Œå¦‚æœå¯ä»¥è™šæ‹ŸåŒ– DMA ä¼šæ€ä¹ˆæ · TLB ç¡¬ä»¶å­˜å‚¨æœ€è¿‘çš„è™šæ‹Ÿåœ°å€å’Œç‰©ç†åœ°å€æ˜ å°„ï¼Œä¸€èˆ¬ç”¨å†…æ ¸ç®¡ç† TLB å¤±æ•ˆï¼Œå¦‚æœè®©ç¨‹åºæ¥ç®¡ç†ï¼Œæ‰‹åŠ¨å¤±æ•ˆå¯ä»¥æ›´å¿«æ›´æ–°ï¼Ÿæ¯”å¦‚è¿›ç¨‹åˆ‡æ¢ï¼Ÿä½†æ˜¯ä¼šä¸ä¼šæ¯”è¾ƒå±é™©å‘¢ï¼ŒæŠŠåˆ«äººçš„ TLB å¼„ä¸¢äº†ï¼Œä¸€è‡´æ€§ä¹Ÿå¯èƒ½ä¼šå­˜åœ¨é—®é¢˜ï¼Œå¯¼è‡´å†…å­˜è®¿é—®é”™è¯¯ã€‚è€Œ TLB å¤±æ•ˆä¹Ÿæ˜¯èƒ½å¤Ÿä¼˜åŒ– GC çš„ä¸€ç‚¹å§ã€‚ ç‰¹æƒæ¨¡å¼æ¯”å¦‚ syscallï¼Œåˆ›å»ºå†…å­˜åˆ†é…ï¼ŒDMA ç­‰ç­‰ï¼Œè¿˜æœ‰å°±æ˜¯é¡µä¸­æ–­ã€å¼‚å¸¸å¤„ç†ã€ç³»ç»Ÿè°ƒç”¨ç­‰ç­‰ ","date":"2024-09-11","objectID":"/posts/dune-paper/:4:2","tags":["Paper Reading"],"title":"Paper Reading: Dune","uri":"/posts/dune-paper/"},{"categories":null,"content":"Kernel Support for Dune ","date":"2024-09-11","objectID":"/posts/dune-paper/:5:0","tags":["Paper Reading"],"title":"Paper Reading: Dune","uri":"/posts/dune-paper/"},{"categories":null,"content":"System Overview å›¾ 1 å±•ç¤ºäº† Dune æ¶æ„çš„é«˜å±‚æ¬¡è§†å›¾ã€‚Dune é€šè¿‡ä¸€ä¸ªæ¨¡å—æ‰©å±•å†…æ ¸ï¼Œè¯¥æ¨¡å—å¯ç”¨ VT-xï¼Œå°†å†…æ ¸ç½®äº VMX root æ¨¡å¼ã€‚ä½¿ç”¨ Dune çš„è¿›ç¨‹é€šè¿‡åœ¨ VMX non-root æ¨¡å¼ä¸‹è¿è¡Œï¼Œè·å¾—å¯¹ç‰¹æƒç¡¬ä»¶çš„ç›´æ¥ä½†å®‰å…¨çš„è®¿é—®æƒé™ã€‚Dune æ¨¡å—æ‹¦æˆª VM é€€å‡ºï¼Œè¿™æ˜¯ Dune è¿›ç¨‹è®¿é—®å†…æ ¸çš„å”¯ä¸€æ–¹å¼ï¼Œå¹¶æ‰§è¡Œä»»ä½•å¿…è¦çš„æ“ä½œï¼Œå¦‚æœåŠ¡é¡µé¢æ•…éšœã€è°ƒç”¨ç³»ç»Ÿè°ƒç”¨æˆ–åœ¨ HLT æŒ‡ä»¤åè®©å‡º CPUã€‚Dune è¿˜åŒ…æ‹¬ä¸€ä¸ªåº“ï¼Œç§°ä¸º libDuneï¼Œç”¨äºååŠ©åœ¨ç”¨æˆ·ç©ºé—´ä¸­ç®¡ç†ç‰¹æƒç¡¬ä»¶ç‰¹æ€§ï¼Œè¿™åœ¨ç¬¬ 4 èŠ‚ä¸­è¿›ä¸€æ­¥è®¨è®ºã€‚ ","date":"2024-09-11","objectID":"/posts/dune-paper/:5:1","tags":["Paper Reading"],"title":"Paper Reading: Dune","uri":"/posts/dune-paper/"},{"categories":null,"content":"Threat Model æˆ‘ä»¬å‡è®¾ CPU æ²¡æœ‰ç¼ºé™·ï¼Œå°½ç®¡æˆ‘ä»¬æ‰¿è®¤åœ¨æå°‘æ•°æƒ…å†µä¸‹å·²ç»å‘ç°äº†å¯åˆ©ç”¨çš„ç¡¬ä»¶ç¼ºé™· ä¸å¤ªæ‡‚è¿™ä¸ªå‡è®¾ ","date":"2024-09-11","objectID":"/posts/dune-paper/:5:2","tags":["Paper Reading"],"title":"Paper Reading: Dune","uri":"/posts/dune-paper/"},{"categories":null,"content":"Comparing to a VMM å…·ä½“æ¥è¯´ï¼ŒDune æš´éœ²äº†ä¸€ä¸ªè¿›ç¨‹ç¯å¢ƒï¼Œè€Œä¸æ˜¯æœºå™¨ç¯å¢ƒã€‚å› æ­¤ï¼ŒDune æ— æ³•æ”¯æŒæ­£å¸¸çš„å®¢æˆ·æ“ä½œç³»ç»Ÿï¼Œä½†è¿™ä½¿å¾— Dune æ›´è½»é‡çº§å’Œæ›´çµæ´»ã€‚ä¸€äº›æœ€æ˜¾è‘—çš„åŒºåˆ«å¦‚ä¸‹ æ‰€ä»¥å’Œ KVM ç­‰çš„æœ€å¤§åŒºåˆ«å°±æ˜¯ dune æ˜¯ä¸ªè¿›ç¨‹ï¼Œæ›´åŠ è½»é‡çº§ ","date":"2024-09-11","objectID":"/posts/dune-paper/:5:3","tags":["Paper Reading"],"title":"Paper Reading: Dune","uri":"/posts/dune-paper/"},{"categories":null,"content":"Memory Management æ¯æ¬¡å†…å­˜ç®¡ç†çš„å®ç°ç»†èŠ‚å°±ä¸€è„¸æ‡µï¼Œdune è‡ªå·±åšäº†ä¸ªé¡µè¡¨è½¬æ¢ï¼Ÿ EPTï¼ˆExtended Page Tableï¼Œæ‰©å±•é¡µè¡¨ï¼‰æ˜¯ Intel VT-x è™šæ‹ŸåŒ–æŠ€æœ¯ä¸­çš„ä¸€ç§ç¡¬ä»¶æœºåˆ¶ï¼Œç”¨äºåœ¨è™šæ‹Ÿæœºï¼ˆGuest OSï¼‰å’Œè™šæ‹Ÿæœºç›‘æ§ç¨‹åºï¼ˆHypervisorï¼‰ä¹‹é—´æä¾›å®‰å…¨çš„å†…å­˜ç®¡ç†ã€‚EPT çš„ä¸»è¦ä½œç”¨æ˜¯å¢å¼ºè™šæ‹Ÿæœºçš„å†…å­˜éš”ç¦»å’Œå®‰å…¨æ€§ï¼ŒåŒæ—¶æé«˜å†…å­˜è®¿é—®çš„æ•ˆç‡ã€‚ å†…å­˜ç®¡ç†æ˜¯ Dune æ¨¡å—çš„æœ€å¤§è´£ä»»ä¹‹ä¸€ã€‚æŒ‘æˆ˜åœ¨äºå‘ç”¨æˆ·ç¨‹åºæš´éœ²ç›´æ¥çš„é¡µè¡¨è®¿é—®ï¼ŒåŒæ—¶é˜²æ­¢å¯¹ç‰©ç†å†…å­˜çš„ä»»æ„è®¿é—®ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯é»˜è®¤æä¾›ä¸€ä¸ªæ­£å¸¸çš„è¿›ç¨‹å†…å­˜åœ°å€ç©ºé—´ï¼Œå…è®¸ç”¨æˆ·ç¨‹åºä»…æ·»åŠ ä»–ä»¬éœ€è¦çš„åŠŸèƒ½ï¼Œè€Œä¸æ˜¯å®Œå…¨æ›¿æ¢å†…æ ¸çº§çš„å†…å­˜ç®¡ç†ã€‚ EPT format incompatibility å¥½å¤„ï¼Œç›´æ¥é¡µè¡¨è®¿é—® + å†…å­˜éš”ç¦» + çµæ´»+ æ€§èƒ½ ä½†é—®é¢˜æ˜¯ intel vt-x EPT éœ€è¦å’Œ x86 é¡µè¡¨åšå…¼å®¹ï¼Œå¯èƒ½ä¼šå‡ºç°ä¸€äº›ç¨‹åºä¸å…¼å®¹ï¼Ÿå†…å­˜ç®¡ç†ä¹Ÿæ¯”è¾ƒå¤æ‚å§ï¼Œå¼€å‘äººå‘˜ä¹Ÿéœ€è¦çŸ¥é“ ept æ˜¯ä»€ä¹ˆæ„æ€ ","date":"2024-09-11","objectID":"/posts/dune-paper/:5:4","tags":["Paper Reading"],"title":"Paper Reading: Dune","uri":"/posts/dune-paper/"},{"categories":null,"content":"Exposing Access to Hardware x86 åŒ…æ‹¬å„ç§æ§åˆ¶å¯„å­˜å™¨ï¼Œ Dune å‡ºäºæ€§èƒ½åŸå› é™åˆ¶äº†å¯¹ç¡¬ä»¶å¯„å­˜å™¨çš„è®¿é—®ã€‚ä¾‹å¦‚ï¼ŒDune ä¸å…è®¸ä¿®æ”¹ MSRï¼Œ VT-xï¼ˆVirtualization Technology for x86ï¼‰ æ˜¯ Intel å¼€å‘çš„ä¸€ç§ç¡¬ä»¶è™šæ‹ŸåŒ–æŠ€æœ¯ï¼Œç”¨äºåœ¨ x86 æ¶æ„ä¸Šå®ç°è™šæ‹ŸåŒ–ã€‚ VMX root æ¨¡å¼ï¼š ç”¨äºè¿è¡Œè™šæ‹Ÿæœºç›‘æ§ç¨‹åºï¼ˆVMMï¼‰ï¼Œä¸æ”¹å˜ CPU è¡Œä¸ºï¼Œé™¤äº†å¯ç”¨å¯¹ VT-x ç®¡ç†çš„æ–°æŒ‡ä»¤çš„è®¿é—®ã€‚ VMX non-root æ¨¡å¼ï¼š ç”¨äºè¿è¡Œè™šæ‹ŸåŒ–çš„å®¢æˆ·æ“ä½œç³»ç»Ÿï¼ˆGuest OSï¼‰ï¼Œé™åˆ¶äº† CPU è¡Œä¸ºï¼Œæ—¨åœ¨è¿è¡Œè™šæ‹ŸåŒ–çš„å®¢æˆ·æ“ä½œç³»ç»Ÿã€‚ ","date":"2024-09-11","objectID":"/posts/dune-paper/:5:5","tags":["Paper Reading"],"title":"Paper Reading: Dune","uri":"/posts/dune-paper/"},{"categories":null,"content":"Preserving OS Interfaces Dune è¿˜ä¿ç•™äº†å¯¹æ“ä½œç³»ç»Ÿç³»ç»Ÿè°ƒç”¨çš„è®¿é—® ","date":"2024-09-11","objectID":"/posts/dune-paper/:5:6","tags":["Paper Reading"],"title":"Paper Reading: Dune","uri":"/posts/dune-paper/"},{"categories":null,"content":"Implementation Dune ç›®å‰æ”¯æŒåœ¨ Intel x86 å¤„ç†å™¨ä¸Šä»¥ 64 ä½é•¿æ¨¡å¼è¿è¡Œçš„ Linuxã€‚å¯¹ AMD CPU å’Œ 32 ä½æ¨¡å¼çš„æ”¯æŒæ˜¯æœªæ¥çš„å¯èƒ½æ‰©å±• å…¼å®¹æ€§å¾ˆå¤§é—®é¢˜ï¼Œå› ä¸ºæ˜¯åŸºäº VT-x æ¥åšçš„ï¼Œç„¶è€Œï¼Œé«˜çº§ä»£ç ä¸ä¸ KVM å…±äº«ï¼Œå› ä¸º Dune çš„æ“ä½œæ–¹å¼ä¸ VMM ä¸åŒã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬çš„ Dune æ¨¡å—æ¯” KVM æ›´ç®€å•ï¼Œä»…ç”± 2,509 è¡Œä»£ç ç»„æˆ ","date":"2024-09-11","objectID":"/posts/dune-paper/:5:7","tags":["Paper Reading"],"title":"Paper Reading: Dune","uri":"/posts/dune-paper/"},{"categories":null,"content":"User-mode Environment ä½¿ç”¨ Dune çš„è¿›ç¨‹çš„æ‰§è¡Œç¯å¢ƒä¸æ­£å¸¸è¿›ç¨‹æœ‰ä¸€äº›å·®å¼‚ã€‚ç”±äºç‰¹æƒç¯æ˜¯æš´éœ²çš„ç¡¬ä»¶ç‰¹æ€§ï¼Œä¸€ä¸ªå·®å¼‚æ˜¯ç”¨æˆ·ä»£ç åœ¨ç¯ 0 ä¸­è¿è¡Œã€‚å°½ç®¡æ”¹å˜äº†æŸäº›æŒ‡ä»¤çš„è¡Œä¸ºï¼Œä½†è¿™é€šå¸¸ä¸ä¼šå¯¼è‡´ç°æœ‰ä»£ç çš„ä¸å…¼å®¹æ€§ã€‚ç¯ 3 ä¹Ÿå¯ç”¨ï¼Œå¹¶ä¸”å¯ä»¥é€‰æ‹©ç”¨äºé™åˆ¶ä¸å—ä¿¡ä»»çš„ä»£ç ã€‚å¦ä¸€ä¸ªå·®å¼‚æ˜¯ç³»ç»Ÿè°ƒç”¨å¿…é¡»ä½œä¸ºè¶…è°ƒç”¨æ‰§è¡Œã€‚ä¸ºäº†ç®€åŒ–æ”¯æŒè¿™ç§æ›´æ”¹ï¼Œæˆ‘ä»¬æä¾›äº†ä¸€ç§æœºåˆ¶ï¼Œå¯ä»¥æ£€æµ‹ä½•æ—¶ä»ç¯ 0 æ‰§è¡Œç³»ç»Ÿè°ƒç”¨ï¼Œå¹¶è‡ªåŠ¨å°†å…¶é‡å®šå‘åˆ°å†…æ ¸ä½œä¸ºè¶…è°ƒç”¨ã€‚è¿™æ˜¯ libDune ä¸­åŒ…å«çš„è®¸å¤šåŠŸèƒ½ä¹‹ä¸€ã€‚ è¿˜æ˜¯å…¼å®¹é—®é¢˜å§ï¼Œring0 æ˜¯æœ€é«˜ç‰¹æƒçº§åˆ«ï¼Œå‡ ä¹å°±æ˜¯å†…æ ¸å’Œè®¾å¤‡æ“ä½œï¼Œring3 æ˜¯ç”¨æˆ·æ€äº† è€Œç”¨æˆ·ä»£ç åœ¨ç¯ 0 ä¸­è¿è¡Œï¼š åœ¨ Dune ä¸­ï¼Œç”¨æˆ·ä»£ç åœ¨ç¯ 0ï¼ˆRing 0ï¼‰ä¸­è¿è¡Œï¼Œè€Œä¸æ˜¯åœ¨ä¼ ç»Ÿçš„ç¯ 3ï¼ˆRing 3ï¼‰ä¸­è¿è¡Œã€‚è¿™æ„å‘³ç€ç”¨æˆ·ä»£ç å…·æœ‰æ›´é«˜çš„ç‰¹æƒçº§åˆ«ï¼Œå¯ä»¥ç›´æ¥è®¿é—®ç‰¹æƒç¡¬ä»¶ç‰¹æ€§ é‚£éœ€ä¸éœ€è¦åˆ‡æ¢åˆ° ring3 å‘¢ï¼Ÿè€Œä¸” syscall å˜æˆäº† hypercall ","date":"2024-09-11","objectID":"/posts/dune-paper/:6:0","tags":["Paper Reading"],"title":"Paper Reading: Dune","uri":"/posts/dune-paper/"},{"categories":null,"content":"Bootstrapping åœ¨è®¸å¤šæ–¹é¢ï¼Œå°†è¿›ç¨‹è½¬æ¢åˆ° Dune æ¨¡å¼ç±»ä¼¼äºå¯åŠ¨æ“ä½œç³»ç»Ÿã€‚ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œåœ¨å¯ç”¨ Dune ä¹‹å‰ï¼Œå¿…é¡»æä¾›æœ‰æ•ˆçš„é¡µè¡¨ã€‚å› ä¸ºå°½ç®¡ç›®æ ‡æ˜¯ä½¿è¿›ç¨‹åœ°å€åœ¨è½¬æ¢å‰åä¿æŒä¸€è‡´ï¼Œä½†å¿…é¡»è€ƒè™‘ EPT çš„å‹ç¼©å¸ƒå±€ã€‚ ","date":"2024-09-11","objectID":"/posts/dune-paper/:6:1","tags":["Paper Reading"],"title":"Paper Reading: Dune","uri":"/posts/dune-paper/"},{"categories":null,"content":"Limitations ä½† libDune ä»ç„¶ç¼ºå°‘ä¸€äº›åŠŸèƒ½ ä½†æˆ‘ä»¬å°šæœªå®Œå…¨é›†æˆå¯¹ä¿¡å·çš„æ”¯æŒï¼Œå…¶æ¬¡ï¼Œå°½ç®¡æˆ‘ä»¬æ”¯æŒ pthreadsï¼Œä½† libDune ä¸­çš„ä¸€äº›å®ç”¨ç¨‹åºï¼Œå¦‚é¡µè¡¨ç®¡ç†ï¼Œå°šæœªçº¿ç¨‹å®‰å…¨ã€‚è¿™ä¸¤ä¸ªé—®é¢˜éƒ½å¯ä»¥é€šè¿‡è¿›ä¸€æ­¥çš„å®ç°æ¥è§£å†³ã€‚ æœ€å¤§çš„é—®é¢˜è¿˜æ˜¯çº¿ç¨‹ä¸å®‰å…¨ï¼Œå¯ä»¥æ‰§è¡Œè¾ƒä½ï¼Œä¸æ”¯æŒé x86 å§ï¼Œè€Œä¸”è¦å…ˆæä¾›é¡µè¡¨ï¼Œä¿è¯åœ°å€æœ‰æ•ˆ ","date":"2024-09-11","objectID":"/posts/dune-paper/:6:2","tags":["Paper Reading"],"title":"Paper Reading: Dune","uri":"/posts/dune-paper/"},{"categories":null,"content":"Applications ","date":"2024-09-11","objectID":"/posts/dune-paper/:7:0","tags":["Paper Reading"],"title":"Paper Reading: Dune","uri":"/posts/dune-paper/"},{"categories":null,"content":"Sandboxing æ²™ç›’ æˆ‘ä»¬å°šæœªæ”¯æŒæ‰€æœ‰ç³»ç»Ÿè°ƒç”¨ï¼Œä½†æˆ‘ä»¬æ”¯æŒè¶³å¤Ÿå¤šçš„ç³»ç»Ÿè°ƒç”¨ä»¥è¿è¡Œå¤§å¤šæ•°å•çº¿ç¨‹ Linux åº”ç”¨ç¨‹åºã€‚ç„¶è€Œï¼Œæœªæ¥æ”¯æŒå¤šçº¿ç¨‹ç¨‹åºæ²¡æœ‰ä»»ä½•éšœç¢ã€‚ ä¸æ”¯æŒå¤šçº¿ç¨‹ ","date":"2024-09-11","objectID":"/posts/dune-paper/:7:1","tags":["Paper Reading"],"title":"Paper Reading: Dune","uri":"/posts/dune-paper/"},{"categories":null,"content":"Wedge ä¸æ‡‚ ","date":"2024-09-11","objectID":"/posts/dune-paper/:7:2","tags":["Paper Reading"],"title":"Paper Reading: Dune","uri":"/posts/dune-paper/"},{"categories":null,"content":"Garbage Collection GC åº”è¯¥æ˜¯æœ€æœ‰ç”¨çš„ Fast faults Dirty bits Page table TLB control æˆ‘ä»¬ä¿®æ”¹äº† Boehm GC [12] ä»¥ä½¿ç”¨ Dune æ¥æé«˜æ€§èƒ½ã€‚Boehm GC æ˜¯ä¸€ä¸ªå¥å£®çš„æ ‡è®°-æ¸…é™¤æ”¶é›†å™¨ï¼Œæ”¯æŒå¹¶è¡Œå’Œå¢é‡æ”¶é›†ã€‚å®ƒè¢«è®¾è®¡ä¸ºè¦ä¹ˆä¸ C/C++ ç¨‹åºä¸€èµ·ä½¿ç”¨ä½œä¸ºä¿å®ˆæ”¶é›†å™¨ï¼Œè¦ä¹ˆç”±ç¼–è¯‘å™¨å’Œè¿è¡Œæ—¶åç«¯ä½¿ç”¨ï¼Œå…¶ä¸­ä¿å®ˆæ€§å¯ä»¥æ§åˆ¶ã€‚å®ƒè¢«å¹¿æ³›ä½¿ç”¨ï¼ŒåŒ…æ‹¬ Mono é¡¹ç›®å’Œ GNU Objective Cã€‚ https://zhuanlan.zhihu.com/p/365571886 ","date":"2024-09-11","objectID":"/posts/dune-paper/:7:3","tags":["Paper Reading"],"title":"Paper Reading: Dune","uri":"/posts/dune-paper/"},{"categories":null,"content":"Evaluation ","date":"2024-09-11","objectID":"/posts/dune-paper/:8:0","tags":["Paper Reading"],"title":"Paper Reading: Dune","uri":"/posts/dune-paper/"},{"categories":null,"content":"Overhead from Running in Dune Dune çš„æ€§èƒ½å—åˆ°ä¸¤ä¸ªä¸»è¦å¼€é”€æ¥æºçš„å½±å“ã€‚é¦–å…ˆï¼ŒVT-x å¢åŠ äº†è¿›å…¥å’Œé€€å‡ºå†…æ ¸çš„æˆæœ¬â€”â€”VM å…¥å£å’Œ VM é€€å‡ºæ¯”å¿«é€Ÿç³»ç»Ÿè°ƒç”¨æŒ‡ä»¤æˆ–å¼‚å¸¸æ›´æ˜‚è´µã€‚å› æ­¤ï¼Œç³»ç»Ÿè°ƒç”¨å’Œå…¶ä»–ç±»å‹çš„æ•…éšœï¼ˆä¾‹å¦‚ï¼Œé¡µé¢æ•…éšœï¼‰åœ¨ Dune ä¸­å¿…é¡»æ”¯ä»˜å›ºå®šæˆæœ¬ã€‚å…¶æ¬¡ï¼Œä½¿ç”¨ EPT ä½¿ TLB æœªå‘½ä¸­çš„æˆæœ¬æ›´é«˜ï¼Œå› ä¸ºåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç¡¬ä»¶é¡µé¢éå†å™¨å¿…é¡»éå†ä¸¤ä¸ªé¡µè¡¨è€Œä¸æ˜¯ä¸€ä¸ªã€‚ getpid, page fault, page walk å¼€é”€ä¹ŸæŒºå¤§çš„ï¼Œçœ‹ä¸Šå»ä¸ä»…æ˜¯ä¸¤ä¸‰å€äº† å…¶ä»–æ¯”å¦‚ trap, ptrace å°±å¿«å¾—å¤šäº† ","date":"2024-09-11","objectID":"/posts/dune-paper/:8:1","tags":["Paper Reading"],"title":"Paper Reading: Dune","uri":"/posts/dune-paper/"},{"categories":null,"content":"Optimizations Made Possible by Dune ptrace æ˜¯ç³»ç»Ÿè°ƒç”¨æ‹¦æˆªæ€§èƒ½çš„åº¦é‡ã€‚è¿™æ˜¯ Linux è¿›ç¨‹ä½¿ç”¨ ptrace æ‹¦æˆªç³»ç»Ÿè°ƒç”¨ï¼ˆgetpidï¼‰ã€å°†ç³»ç»Ÿè°ƒç”¨è½¬å‘åˆ°å†…æ ¸å¹¶è¿”å›ç»“æœçš„æˆæœ¬ã€‚åœ¨ Dune ä¸­ï¼Œè¿™æ˜¯åœ¨ VMX non-root æ¨¡å¼ä¸‹ä½¿ç”¨ç¯ä¿æŠ¤ç›´æ¥æ‹¦æˆªç³»ç»Ÿè°ƒç”¨ã€é€šè¿‡ VMCALL è½¬å‘ç³»ç»Ÿè°ƒç”¨å¹¶è¿”å›ç»“æœçš„æˆæœ¬ã€‚ PTRACE SYSEMU æ˜¯åº”ç”¨ç¨‹åºå¸Œæœ›æ‹¦æˆªç³»ç»Ÿè°ƒç”¨ä½†ä¸å°†å…¶è½¬å‘åˆ°å†…æ ¸è€Œæ˜¯ä»…åœ¨å†…éƒ¨å®ç°å®ƒä»¬æ—¶çš„æœ€æœ‰æ•ˆæœºåˆ¶ã€‚ç”±äº ptrace éœ€è¦å°†è°ƒç”¨è½¬å‘åˆ°å†…æ ¸ï¼Œå› æ­¤ PTRACE SYSEMU æ˜¯æœ€æœ‰æ•ˆçš„æœºåˆ¶ã€‚ä½¿ç”¨ PTRACE SYSEMU æ‹¦æˆªç³»ç»Ÿè°ƒç”¨çš„å»¶è¿Ÿä¸º 13,592 ä¸ªå‘¨æœŸã€‚åœ¨ Dune ä¸­ï¼Œè¿™å¯ä»¥é€šè¿‡ç›´æ¥å¤„ç†ç¡¬ä»¶ç³»ç»Ÿè°ƒç”¨é™·é˜±æ¥å®ç°ï¼Œå»¶è¿Ÿä»…ä¸º 180 ä¸ªå‘¨æœŸã€‚è¿™è¡¨æ˜ Dune ptrace åŸºå‡†æµ‹è¯•çš„å¤§éƒ¨åˆ†å¼€é”€å®é™…ä¸Šæ˜¯é€šè¿‡ VMCALL è½¬å‘ getpid ç³»ç»Ÿè°ƒç”¨ï¼Œè€Œä¸æ˜¯æ‹¦æˆªç³»ç»Ÿè°ƒç”¨ã€‚ trap è¡¨ç¤ºè¿›ç¨‹è·å–é¡µé¢æ•…éšœå¼‚å¸¸æ‰€éœ€çš„æ—¶é—´ã€‚æˆ‘ä»¬å°† Linux ä¸­ SIGSEGV ä¿¡å·çš„å»¶è¿Ÿä¸ Dune ä¸­ç¡¬ä»¶ç”Ÿæˆçš„é¡µé¢æ•…éšœè¿›è¡Œæ¯”è¾ƒã€‚ appel1 æ˜¯ç”¨æˆ·çº§è™šæ‹Ÿå†…å­˜ç®¡ç†æ€§èƒ½çš„åº¦é‡ã€‚å®ƒå¯¹åº”äº [5] ä¸­æè¿°çš„ TRAPã€PROT1 å’Œ UNPROT æµ‹è¯•ï¼Œå…¶ä¸­è®¿é—®äº† 100 ä¸ªå—ä¿æŠ¤çš„é¡µé¢ï¼Œå¯¼è‡´æ•…éšœã€‚ç„¶åï¼Œåœ¨æ•…éšœå¤„ç†ç¨‹åºä¸­ï¼Œæ•…éšœé¡µé¢è¢«è§£é™¤ä¿æŠ¤ï¼Œå¹¶ä¿æŠ¤äº†ä¸€ä¸ªæ–°é¡µé¢ã€‚ appel2 æ˜¯ç”¨æˆ·çº§è™šæ‹Ÿå†…å­˜ç®¡ç†çš„å¦ä¸€ä¸ªåº¦é‡ã€‚å®ƒå¯¹åº”äº [5] ä¸­æè¿°çš„ PROTNã€TRAP å’Œ UNPROT æµ‹è¯•ï¼Œå…¶ä¸­ä¿æŠ¤äº† 100 ä¸ªé¡µé¢ã€‚ç„¶åè®¿é—®æ¯ä¸ªé¡µé¢ï¼Œæ•…éšœå¤„ç†ç¨‹åºè§£é™¤æ•…éšœé¡µé¢çš„ä¿æŠ¤ã€‚ ","date":"2024-09-11","objectID":"/posts/dune-paper/:8:2","tags":["Paper Reading"],"title":"Paper Reading: Dune","uri":"/posts/dune-paper/"},{"categories":null,"content":"Application Performance â€¦ å¯ä»¥çœ‹åˆ° EPT å¸¦æ¥çš„é—®é¢˜è¿˜æ˜¯å¾ˆå¤§çš„ å¿½ç•¥ï¼Œç›´æ¥çœ‹ GC Garbage Collector è¿™äº›åŸºå‡†æµ‹è¯•çš„ç»“æœå¦‚è¡¨ 6 æ‰€ç¤ºã€‚ç›´æ¥ç§»æ¤æ˜¾ç¤ºäº†æ··åˆç»“æœï¼Œç”±äºå†…å­˜ä¿æŠ¤å’Œæ•…éšœå¤„ç†ç¨‹åºçš„æ”¹è¿›ï¼Œä½†ä¹Ÿå—åˆ° EPT å¼€é”€çš„å‡é€Ÿã€‚ä¸€æ—¦æˆ‘ä»¬å¼€å§‹ä½¿ç”¨æ›´å¤šç¡¬ä»¶ç‰¹æ€§ï¼Œæˆ‘ä»¬å°±ä¼šçœ‹åˆ°æ˜æ˜¾çš„æ€§èƒ½æ”¹è¿›ã€‚é™¤äº† XML Parser ä¹‹å¤–ï¼ŒTLB ç‰ˆæœ¬åœ¨ 10.9% åˆ° 23.8% ä¹‹é—´æé«˜äº†æ€§èƒ½ï¼Œè„ä½ç‰ˆæœ¬åœ¨ 26.4% åˆ° 40.7% ä¹‹é—´æé«˜äº†æ€§èƒ½ã€‚ XML åŸºå‡†æµ‹è¯•å¾ˆæœ‰è¶£ï¼Œå› ä¸ºå®ƒæ˜¾ç¤ºäº†æ‰€æœ‰ä¸‰ä¸ªç‰ˆæœ¬åœ¨ Dune ä¸‹çš„å‡é€Ÿï¼šç›´æ¥ç‰ˆæœ¬æ…¢ 19.0%ï¼ŒTLB ç‰ˆæœ¬æ…¢ 12.2%ï¼Œè„ä½ç‰ˆæœ¬æ…¢ 0.2%ã€‚è¿™ä¼¼ä¹æ˜¯ç”± EPT å¼€é”€å¼•èµ·çš„ï¼Œå› ä¸ºåŸºå‡†æµ‹è¯•æ²¡æœ‰äº§ç”Ÿè¶³å¤Ÿçš„åƒåœ¾æ¥å—ç›Šäºæˆ‘ä»¬å¯¹ Boehm GC æ‰€åšçš„ä¿®æ”¹ã€‚è¿™åœ¨è¡¨ 6 ä¸­æœ‰æ‰€ä½“ç°ï¼›æ€»åˆ†é…é‡å‡ ä¹ç­‰äºæœ€å¤§å †å¤§å°ã€‚æˆ‘ä»¬é€šè¿‡ä¿®æ”¹åŸºå‡†æµ‹è¯•æ¥éªŒè¯è¿™ä¸€ç‚¹ï¼Œæ”¹ä¸ºå¤„ç†ä¸€ç³»åˆ— XML æ–‡ä»¶ï¼Œä¾æ¬¡å¤„ç†æ¯ä¸ªæ–‡ä»¶ï¼Œä»¥ä¾¿å›æ”¶å†…å­˜ã€‚ç„¶åï¼Œæˆ‘ä»¬çœ‹åˆ°éšç€æ–‡ä»¶æ•°é‡çš„å¢åŠ ï¼ŒDune ç‰ˆæœ¬ç›¸å¯¹äºåŸºçº¿çš„çº¿æ€§æ”¹è¿›ã€‚ä½¿ç”¨åä¸ª 150MB XML æ–‡ä»¶ä½œä¸ºè¾“å…¥ï¼ŒBoehm GC çš„è„ä½ç‰ˆæœ¬æ˜¾ç¤ºæ‰§è¡Œæ—¶é—´æ¯”åŸºçº¿æé«˜äº† 12.8%ã€‚ ","date":"2024-09-11","objectID":"/posts/dune-paper/:8:3","tags":["Paper Reading"],"title":"Paper Reading: Dune","uri":"/posts/dune-paper/"},{"categories":null,"content":"Reflections on Hardware ","date":"2024-09-11","objectID":"/posts/dune-paper/:9:0","tags":["Paper Reading"],"title":"Paper Reading: Dune","uri":"/posts/dune-paper/"},{"categories":null,"content":"Related Work ","date":"2024-09-11","objectID":"/posts/dune-paper/:10:0","tags":["Paper Reading"],"title":"Paper Reading: Dune","uri":"/posts/dune-paper/"},{"categories":null,"content":"Conclusion ","date":"2024-09-11","objectID":"/posts/dune-paper/:11:0","tags":["Paper Reading"],"title":"Paper Reading: Dune","uri":"/posts/dune-paper/"},{"categories":null,"content":"Exokernel: An Operating System Architecture for Application-Level Resource Management å¾®å†…æ ¸ï¼Ÿæœäº†ä¸€ä¸‹å‘ç°ä¸Šäº¤çš„æ“ä½œç³»ç»Ÿè¯¾ç”šè‡³ä¼šè®²è¿™ç¯‡è®ºæ–‡ï¼Œä½†è¿™ç¯‡è®ºæ–‡ä¹Ÿå¤ªæ—©äº† 1995 å¹´çš„ï¼ŒMIT 6828 (ç° 6.1810) åº”è¯¥ä¹Ÿä¼šè®² ","date":"2024-09-11","objectID":"/posts/exokernel-paper/:1:0","tags":["Paper Reading"],"title":"Paper Reading: Exokernel","uri":"/posts/exokernel-paper/"},{"categories":null,"content":"Abstract operating system abstractions such as interprocess com- munication and virtual memory ä¼ ç»Ÿ OS ä¼šé€šè¿‡å›ºå®šè¿™äº›æ¥å£æ¥é™åˆ¶ç¨‹åºçš„æ€§èƒ½ã€çµæ´»æ€§ã€åŠŸèƒ½ã€‚Exokernel æ“ä½œç³»ç»Ÿæ¶æ„é€šè¿‡æä¾›åº”ç”¨ç¨‹åºçº§åˆ«çš„ç‰©ç†èµ„æºç®¡ç†æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚åœ¨ Exokernel æ¶æ„ä¸­ï¼Œä¸€ä¸ªå°çš„å†…æ ¸é€šè¿‡ä½çº§æ¥å£å°†æ‰€æœ‰ç¡¬ä»¶èµ„æºå®‰å…¨åœ°å¯¼å‡ºç»™ä¸å—ä¿¡ä»»çš„åº“æ“ä½œç³»ç»Ÿã€‚åº“æ“ä½œç³»ç»Ÿä½¿ç”¨è¿™ä¸ªæ¥å£æ¥å®ç°ç³»ç»Ÿå¯¹è±¡å’Œç­–ç•¥ã€‚è¿™ç§èµ„æºä¿æŠ¤ä¸ç®¡ç†çš„åˆ†ç¦»å…è®¸å¯¹ä¼ ç»Ÿæ“ä½œç³»ç»ŸæŠ½è±¡è¿›è¡Œåº”ç”¨ç¨‹åºç‰¹å®šçš„å®šåˆ¶ï¼Œé€šè¿‡æ‰©å±•ã€ä¸“é—¨åŒ–ç”šè‡³æ›¿æ¢åº“æ¥å®ç°ã€‚ The exokernel operating system architecture addresses this problem by providing application-level management of physical resources. ä¾‹å¦‚ï¼Œè™šæ‹Ÿå†…å­˜å’Œè¿›ç¨‹é—´é€šä¿¡æŠ½è±¡å®Œå…¨åœ¨åº”ç”¨ç¨‹åºçº§åˆ«çš„åº“ä¸­å®ç° ","date":"2024-09-11","objectID":"/posts/exokernel-paper/:2:0","tags":["Paper Reading"],"title":"Paper Reading: Exokernel","uri":"/posts/exokernel-paper/"},{"categories":null,"content":"Introduction Operating systems define the interface between applications and physical resources æ¯”å¦‚å†…å­˜ç®¡ç†ï¼Œæ–‡ä»¶ç³»ç»Ÿï¼Ÿè¿›ç¨‹/çº¿ç¨‹ç®¡ç†ï¼Ÿ Traditionally, operating systems hide information about machine resources behind high-level abstractions such as processes, files, address spaces and interprocess communication We believe these problems can be solved through application- level (i.e., untrusted) resource management. To this end, we have designed a new operating system architecture, exokernel, in which traditional operating system abstractions, such as virtual memory (VM) and interprocess communication (IPC), are implemented en- tirely at application level by untrusted software èµ„æºç®¡ç†äº¤ç»™ç¨‹åºæ¥è§£å†³ï¼Ÿå†…æ ¸ï¼Œexokernel çš„ vm å’Œ ipc ä¹Ÿç”± app å®ç°ï¼Ÿ Application writers select libraries or implement their own. New implementations of library operating systems are incorporated by simply relinking application executables åº”ç”¨ç¨‹åºçº§åˆ«çš„æ–‡ä»¶ç¼“å­˜æ§åˆ¶å¯ä»¥å°†åº”ç”¨ç¨‹åºè¿è¡Œæ—¶é—´å‡å°‘ 45%ï¼Œåº”ç”¨ç¨‹åºç‰¹å®šçš„è™šæ‹Ÿå†…å­˜ç­–ç•¥æé«˜åº”ç”¨ç¨‹åºæ€§èƒ½ï¼Œä¸é€‚å½“çš„æ–‡ä»¶ç³»ç»Ÿå®ç°å†³ç­–ä¼šå¯¹æ•°æ®åº“çš„æ€§èƒ½äº§ç”Ÿå·¨å¤§å½±å“ï¼Œé€šè¿‡å°†ä¿¡å·å¤„ç†æ¨è¿Ÿåˆ°åº”ç”¨ç¨‹åºï¼Œå¼‚å¸¸å¤„ç†å¯ä»¥å¿«ä¸€ä¸ªæ•°é‡çº§ã€‚ è¿™é‡Œçš„è®ºæ–‡ä¹Ÿéƒ½å¾ˆè€ï¼Œæ–‡ä»¶ç³»ç»Ÿå†³ç­–ä¼šå½±å“æ•°æ®åº“æ€§èƒ½æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Œç¼“å­˜æ›¿æ¢ç­–ç•¥ï¼Ÿéš¾é“è¿™äº›ä¸æ˜¯æ•°æ®åº“æ¥å®ç°å—ï¼Œæ•°æ®åº“å¯ä»¥æœ‰è‡ªå·±çš„ç¼“å­˜æŒ‚å“ªé‡Œï¼Œè¿˜æ˜¯éœ€è¦å®šåˆ¶æ–‡ä»¶ç³»ç»Ÿå‘¢ï¼Œæ¯”å¦‚ç›´æ¥ IOï¼ŒInnoDB ä¹Ÿæœ‰è‡ªå·±çš„ç¼“å­˜ç®¡ç†ç³»ç»Ÿï¼Œæ–‡ä»¶ç³»ç»Ÿçš„ IO æ¥å£åº”è¯¥ä¹Ÿæ˜¯ä¼˜åŒ–è¿‡çš„ The exokernel architecture is founded on and motivated by a single, simple, and old observation: the lower the level of a primitive, the more efficiently it can be implemented, and the more latitude it grants to implementors of higher-level abstractions. è¿˜æ˜¯å¾ˆæœ‰é“ç†çš„ï¼Œåº”ç”¨ç¨‹åºè‡ªå·±åšä¼˜åŒ–å°±å¥½äº† Therefore, an exokernel uses a different approach: it exports hardware resources rather than emulating them, which allows an efficient and simple implementation. secure bindings, visible re-source revocation, abort protocol (exokernel can break secure bindings ) (1) exokernels can be made efficient due to the limited number of simple primitives they must provide; (2) low-level secure multiplexing of hardware resources can be provided with low overhead; (3) traditional abstractions, such as VM and IPC, can be implemented efficiently at application level, where they can be easily extended, specialized, or replaced; (4) applications can create special-purpose implementations of abstractions, tailored to their functionality and performance needs. Aegis also gives ExOS (and other application-level software) flexibility that is not available in microkernel-based systems ä¾‹å¦‚ï¼Œè™šæ‹Ÿå†…å­˜åœ¨åº”ç”¨ç¨‹åºçº§åˆ«å®ç°ï¼Œå¯ä»¥ä¸åˆ†å¸ƒå¼å…±äº«å†…å­˜ç³»ç»Ÿå’Œåƒåœ¾æ”¶é›†å™¨ç´§å¯†é›†æˆã€‚Aegis çš„é«˜æ•ˆä¿æŠ¤æ§åˆ¶è½¬ç§»å…è®¸åº”ç”¨ç¨‹åºé€šè¿‡ç‰ºç‰²æ€§èƒ½æ¥æ¢å–é¢å¤–åŠŸèƒ½ï¼Œæ„å»ºä¸€ç³»åˆ—é«˜æ•ˆçš„ IPC åŸè¯­ å¾®å†…æ ¸åˆæ˜¯ä»€ä¹ˆï¼Œåˆ†å¸ƒå¼å…±äº«å†…å­˜åˆæ˜¯ä»€ä¹ˆ ","date":"2024-09-11","objectID":"/posts/exokernel-paper/:3:0","tags":["Paper Reading"],"title":"Paper Reading: Exokernel","uri":"/posts/exokernel-paper/"},{"categories":null,"content":"Motivation for Exokernels Typically, the abstractions include processes, files, address spaces, and interprocess communication. ","date":"2024-09-11","objectID":"/posts/exokernel-paper/:4:0","tags":["Paper Reading"],"title":"Paper Reading: Exokernel","uri":"/posts/exokernel-paper/"},{"categories":null,"content":"The cost of Fixed High-Level Abstractions abstractions in traditional operating systems -\u003e general å›ºå®šçš„é«˜çº§æŠ½è±¡ä¼šæŸå®³åº”ç”¨ç¨‹åºçš„æ€§èƒ½ï¼Œå› ä¸ºæ²¡æœ‰ä¸€ç§å•ä¸€çš„æ–¹å¼æ¥æŠ½è±¡ç‰©ç†èµ„æºæˆ–å®ç°å¯¹æ‰€æœ‰åº”ç”¨ç¨‹åºéƒ½æœ€ä½³çš„æŠ½è±¡ã€‚åœ¨å®ç°æŠ½è±¡æ—¶ï¼Œæ“ä½œç³»ç»Ÿè¢«è¿«åœ¨ç¨€ç–æˆ–å¯†é›†åœ°å€ç©ºé—´ã€è¯»å¯†é›†æˆ–å†™å¯†é›†å·¥ä½œè´Ÿè½½ç­‰ä¹‹é—´è¿›è¡Œæƒè¡¡ã€‚ä»»ä½•è¿™æ ·çš„æƒè¡¡éƒ½ä¼šæƒ©ç½šæŸäº›ç±»åˆ«çš„åº”ç”¨ç¨‹åºã€‚ä¾‹å¦‚ï¼Œå…³ç³»æ•°æ®åº“å’Œåƒåœ¾æ”¶é›†å™¨æœ‰æ—¶å…·æœ‰éå¸¸å¯é¢„æµ‹çš„æ•°æ®è®¿é—®æ¨¡å¼ï¼Œå½“æ“ä½œç³»ç»Ÿå¼ºåŠ å¦‚ LRU è¿™æ ·çš„é€šç”¨é¡µé¢æ›¿æ¢ç­–ç•¥æ—¶ï¼Œå®ƒä»¬çš„æ€§èƒ½ä¼šå—åˆ°å½±å“ã€‚è¿™ç§åº”ç”¨ç¨‹åºç‰¹å®šç­–ç•¥çš„æ€§èƒ½æ”¹è¿›å¯èƒ½æ˜¯æ˜¾è‘—çš„ï¼›Cao ç­‰äºº [10] æµ‹é‡åˆ°ï¼Œåº”ç”¨ç¨‹åºæ§åˆ¶çš„æ–‡ä»¶ç¼“å­˜å¯ä»¥å°†åº”ç”¨ç¨‹åºè¿è¡Œæ—¶é—´å‡å°‘å¤šè¾¾ 45%ã€‚ å›ºå®šçš„é«˜çº§æŠ½è±¡ä¼šéšè—åº”ç”¨ç¨‹åºçš„ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œå¤§å¤šæ•°å½“å‰ç³»ç»Ÿä¸ä¼šå°†ä½çº§å¼‚å¸¸ã€å®šæ—¶å™¨ä¸­æ–­æˆ–åŸå§‹è®¾å¤‡ I/O ç›´æ¥æä¾›ç»™åº”ç”¨ç¨‹åºçº§è½¯ä»¶ã€‚ä¸å¹¸çš„æ˜¯ï¼Œéšè—è¿™äº›ä¿¡æ¯ä½¿å¾—åº”ç”¨ç¨‹åºéš¾ä»¥æˆ–ä¸å¯èƒ½å®ç°è‡ªå·±çš„èµ„æºç®¡ç†æŠ½è±¡ã€‚ä¾‹å¦‚ï¼Œæ•°æ®åº“å®ç°è€…å¿…é¡»åœ¨æ–‡ä»¶ç³»ç»Ÿä¹‹ä¸ŠåŠªåŠ›æ¨¡æ‹Ÿéšæœºè®¿é—®è®°å½•å­˜å‚¨ï¼Œå› ä¸ºæ“ä½œç³»ç»Ÿéšè—äº†é¡µé¢é”™è¯¯å’Œå®šæ—¶å™¨ä¸­æ–­ è¿˜æ˜¯ trade off å§ï¼Œè®¤ä¸ºæŠ½è±¡ä¸åˆ©äºæ€§èƒ½ï¼Œéšè—äº†ä¿¡æ¯ï¼Œé™åˆ¶äº†åº”ç”¨ç¨‹åºçš„åŠŸèƒ½ã€‚æ•°æ®åº“éœ€è¦éšæœºè®¿é—®å­˜å‚¨ï¼Œæ˜¯æ€ä¹ˆæ¨¡æ‹Ÿçš„ï¼Ÿæ–‡ä»¶ç³»ç»Ÿä¸€å¼€å§‹ä¸æ˜¯ä¸ºäº† æ•°æ®åº“è®¾è®¡çš„ï¼Œåº”è¯¥æ˜¯è¿™æ„æ€å§ï¼Œæ¯”å¦‚æ–‡ä»¶ç³»ç»Ÿæ˜¯æ–‡ä»¶ä¸ºå•ä½çš„ï¼Œä¹Ÿæœ‰é€šç”¨çš„ç¼“å­˜ç­–ç•¥ï¼Œæ‰€ä»¥æ•°æ®åº“ç³»ç»Ÿéƒ½åŸºäºæ–‡ä»¶ç³»ç»Ÿå®ç°äº†è‡ªå·±çš„ B+Tree ç»“æ„ç­‰ç´¢å¼•ç»“æ„ï¼Ÿ æ“ä½œç³»ç»Ÿ OS åº”è¯¥å°½é‡æš´éœ² low level çš„åŸè¯­ ","date":"2024-09-11","objectID":"/posts/exokernel-paper/:4:1","tags":["Paper Reading"],"title":"Paper Reading: Exokernel","uri":"/posts/exokernel-paper/"},{"categories":null,"content":"Exokernels: An End-to-End Argument ä¸ºäº†æä¾›æœ€å¤§çš„åº”ç”¨ç¨‹åºçº§åˆ«èµ„æºç®¡ç†æœºä¼šï¼ŒExokernel æ¶æ„ç”±ä¸€ä¸ªè–„çš„ Exokernel å¤–å£³ç»„æˆï¼Œé€šè¿‡ä¸€ç»„ä½çº§åŸè¯­å®‰å…¨åœ°å¤ç”¨å’Œå¯¼å‡ºç‰©ç†èµ„æºã€‚åº“æ“ä½œç³»ç»Ÿä½¿ç”¨ä½çº§çš„ Exokernel æ¥å£å®ç°æ›´é«˜å±‚æ¬¡çš„æŠ½è±¡ï¼Œå¹¶ä¸”å¯ä»¥å®šä¹‰ä¸“é—¨ç”¨é€”çš„å®ç°ï¼Œä»¥æœ€å¥½åœ°æ»¡è¶³åº”ç”¨ç¨‹åºçš„æ€§èƒ½å’ŒåŠŸèƒ½ç›®æ ‡.åº”ç”¨ç¨‹åºå¯ä»¥é€‰æ‹©ä¸€ä¸ªå…·æœ‰ç‰¹å®šé¡µè¡¨å®ç°çš„åº“ï¼Œè¯¥å®ç°æœ€é€‚åˆå…¶éœ€æ±‚ã€‚æ®æˆ‘ä»¬æ‰€çŸ¥ï¼Œæ²¡æœ‰å…¶ä»–å®‰å…¨çš„æ“ä½œç³»ç»Ÿæ¶æ„å…è®¸åº”ç”¨ç¨‹åºå¦‚æ­¤å¤šçš„æœ‰ç”¨è‡ªç”±ã€‚ æ­¤å¤–ï¼Œå®‰å…¨å¤ç”¨ä¸éœ€è¦å¤æ‚çš„ç®—æ³•ï¼›å®ƒä¸»è¦éœ€è¦è¡¨æ¥è·Ÿè¸ªæ‰€æœ‰æƒã€‚å› æ­¤ï¼ŒExokernel çš„å®ç°å¯ä»¥å¾ˆç®€å•ã€‚ç®€å•çš„å†…æ ¸æé«˜äº†å¯é æ€§å’Œç»´æŠ¤çš„ä¾¿åˆ©æ€§ï¼Œæ¶ˆè€—è¾ƒå°‘çš„èµ„æºï¼Œå¹¶èƒ½å¤Ÿå¿«é€Ÿé€‚åº”æ–°çš„éœ€æ±‚ï¼ˆä¾‹å¦‚ï¼Œåƒå…†ä½ç½‘ç»œï¼‰ã€‚æ­¤å¤–ï¼Œæ­£å¦‚ RISC æŒ‡ä»¤çš„æƒ…å†µä¸€æ ·ï¼ŒExokernel æ“ä½œçš„ç®€å•æ€§ä½¿å®ƒä»¬èƒ½å¤Ÿé«˜æ•ˆåœ°å®ç°ã€‚ è¿™æ ·åšçš„é—®é¢˜åœ¨å“ªï¼Ÿæ¯ä¸ªåº”ç”¨ç¨‹åºéƒ½å¾—å®ç°è‡ªå·±çš„é¡µè¡¨ï¼Ÿä¸å®‰å…¨ï¼Ÿä¸Šä¸‹æ–‡åˆ‡æ¢æ›´å¤æ‚ ï¼Ÿç¼“å­˜ä¸€è‡´æ€§ï¼Ÿ ","date":"2024-09-11","objectID":"/posts/exokernel-paper/:4:2","tags":["Paper Reading"],"title":"Paper Reading: Exokernel","uri":"/posts/exokernel-paper/"},{"categories":null,"content":"Library Operating Systems library operating systems, ä¸å— Exokernel çš„ä¿¡ä»», å¯ä»¥è‡ªç”±åœ°ä¿¡ä»»åº”ç”¨ç¨‹åº ä¾‹å¦‚ï¼Œå¦‚æœåº”ç”¨ç¨‹åºå‘åº“ä¼ é€’é”™è¯¯çš„å‚æ•°ï¼Œåªä¼šå½±å“è¯¥åº”ç”¨ç¨‹åºã€‚æœ€åï¼ŒExokernel ç³»ç»Ÿä¸­çš„å†…æ ¸äº¤å‰æ¬¡æ•°å¯ä»¥æ›´å°‘ï¼Œå› ä¸ºå¤§éƒ¨åˆ†æ“ä½œç³»ç»Ÿè¿è¡Œåœ¨åº”ç”¨ç¨‹åºçš„åœ°å€ç©ºé—´ä¸­ã€‚ åº“æ“ä½œç³»ç»Ÿå¯ä»¥æä¾›æ‰€éœ€çš„å°½å¯èƒ½å¤šçš„å¯ç§»æ¤æ€§å’Œå…¼å®¹æ€§ã€‚ç›´æ¥ä½¿ç”¨ Exokernel æ¥å£çš„åº”ç”¨ç¨‹åºå°†ä¸å…·å¤‡å¯ç§»æ¤æ€§ï¼Œå› ä¸ºæ¥å£å°†åŒ…å«ç¡¬ä»¶ç‰¹å®šçš„ä¿¡æ¯ã€‚ä½¿ç”¨å®ç°æ ‡å‡†æ¥å£ï¼ˆä¾‹å¦‚ POSIXï¼‰çš„åº“æ“ä½œç³»ç»Ÿçš„åº”ç”¨ç¨‹åºå°†åœ¨ä»»ä½•æä¾›ç›¸åŒæ¥å£çš„ç³»ç»Ÿä¸Šå…·æœ‰å¯ç§»æ¤æ€§ã€‚åœ¨ Exokernel ä¸Šè¿è¡Œçš„åº”ç”¨ç¨‹åºå¯ä»¥è‡ªç”±åœ°æ›¿æ¢è¿™äº›åº“æ“ä½œç³»ç»Ÿï¼Œè€Œæ— éœ€ä»»ä½•ç‰¹æ®Šæƒé™ï¼Œè¿™ç®€åŒ–äº†æ–°æ ‡å‡†å’ŒåŠŸèƒ½çš„æ·»åŠ å’Œå¼€å‘ã€‚ ä¸å¾®å†…æ ¸ç³»ç»Ÿä¸€æ ·ï¼ŒExokernel å¯ä»¥é€šè¿‡ä¸‰ç§æ–¹å¼æä¾›å‘åå…¼å®¹æ€§ï¼šä¸€æ˜¯æ“ä½œç³»ç»Ÿå’Œå…¶ç¨‹åºçš„äºŒè¿›åˆ¶ä»¿çœŸï¼›äºŒæ˜¯åœ¨ Exokernel ä¹‹ä¸Šå®ç°å…¶ç¡¬ä»¶æŠ½è±¡å±‚ï¼›ä¸‰æ˜¯åœ¨ Exokernel ä¹‹ä¸Šé‡æ–°å®ç°æ“ä½œç³»ç»Ÿçš„æŠ½è±¡ã€‚ å¯ç§»æ¤æ€§ä¹Ÿæ˜¯ä¸€ä¸ªé‡è¦çš„å› ç´ å§ï¼Œè¿˜æ˜¯å¾—ä½¿ç”¨æ ‡å‡†åº“ã€‚ å¾®å†…æ ¸åˆæ˜¯ä»€ä¹ˆï¼Œå¾®å†…æ ¸æ˜¯å°†æœåŠ¡è½¬ç§»åˆ°è¿›ç¨‹ä¸Šçš„ä¸€ç§å†…æ ¸æ¨¡å¼ã€‚å®å†…æ ¸æ˜¯ä¸€ç§ä¼ ç»Ÿçš„å†…æ ¸ç»“æ„ï¼Œå®ƒå°†è¿›ç¨‹ç®¡ç†ï¼Œå†…å­˜ç®¡ç†ç­‰å„é¡¹æœåŠ¡åŠŸèƒ½éƒ½æ”¾åˆ°å†…æ ¸ä¸­å»ï¼Œé€šå¸¸ç”¨åœ¨é€šç”¨å¼çš„å†…æ ¸ä¸Šï¼Œå¦‚ unixï¼Œlinux ç­‰ã€‚å¾®å†…æ ¸çš„ä»£è¡¨ï¼šMinixï¼Œåœ¨ Minix ä¸­ï¼Œæ“ä½œç³»ç»Ÿçš„å†…æ ¸ï¼Œå†…å­˜ç®¡ç†ï¼Œç³»ç»Ÿç®¡ç†éƒ½æœ‰è‡ªå·±çš„è¿›ç¨‹è¡¨ï¼Œæ¯ä¸ªéƒ¨åˆ†çš„è¡¨åŒ…å«äº†è‡ªå·±éœ€è¦çš„åŸŸã€‚è¡¨è±¡æ˜¯ç²¾ç¡®å¯¹åº”çš„ï¼Œä¸ºäº†ä¿æŒåŒæ­¥ï¼Œåœ¨è¿›ç¨‹åˆ›å»ºæˆ–ç»“æŸæ—¶ï¼Œè¿™ä¸‰ä¸ªéƒ¨åˆ†éƒ½è¦æ›´æ–°å„è‡ªçš„è¡¨ã€‚ å¾®å†…æ ¸æ€ä¹ˆåšè¿›ç¨‹ç®¡ç†ï¼Œä¿¡æ¯ä¼ é€’ï¼Œå¼€å‘éš¾åº¦æ˜¯ä¸æ˜¯å¾ˆé«˜ï¼Œæ›´å®‰å…¨ï¼Ÿå´©æºƒä¸ä¼šå½±å“åˆ«çš„ï¼ŸIPC æ€ä¹ˆåšï¼Œæ€§èƒ½æ˜¯ä¸æ˜¯æ›´å·®ï¼Ÿ ","date":"2024-09-11","objectID":"/posts/exokernel-paper/:4:3","tags":["Paper Reading"],"title":"Paper Reading: Exokernel","uri":"/posts/exokernel-paper/"},{"categories":null,"content":"ExoKernel Design å¼•ç”¨ mit os çš„è¯¾ï¼Œä½†æ˜¯å¾ˆå¤šåµŒå…¥å¼ç³»ç»Ÿï¼Œä¾‹å¦‚ Minixï¼ŒCellï¼Œè¿™äº›éƒ½æ˜¯å¾®å†…æ ¸è®¾è®¡ã€‚è¿™ä¸¤ç§è®¾è®¡éƒ½å¾ˆæµè¡Œï¼Œå¦‚æœä½ ä»å¤´å¼€å§‹å†™ä¸€ä¸ªæ“ä½œç³»ç»Ÿï¼Œä½ å¯èƒ½ä¼šä»ä¸€ä¸ªå¾®å†…æ ¸è®¾è®¡å¼€å§‹ã€‚ä½†æ˜¯ä¸€æ—¦ä½ æœ‰äº†ç±»ä¼¼äº Linux è¿™æ ·çš„å®å†…æ ¸è®¾è®¡ï¼Œå°†å®ƒé‡å†™åˆ°ä¸€ä¸ªå¾®å†…æ ¸è®¾è®¡å°†ä¼šæ˜¯å·¨å¤§çš„å·¥ä½œã€‚å¹¶ä¸”è¿™æ ·é‡æ„çš„åŠ¨æœºä¹Ÿä¸è¶³ï¼Œå› ä¸ºäººä»¬æ€»æ˜¯æƒ³æŠŠæ—¶é—´èŠ±åœ¨å®ç°æ–°åŠŸèƒ½ä¸Šï¼Œè€Œä¸æ˜¯é‡æ„ä»–ä»¬çš„å†…æ ¸ã€‚ è®¾è®¡ä¸»è¦å…³æ³¨ç‚¹æ˜¯å‡å°‘å†…æ ¸ä¸­çš„ä»£ç ï¼Œå®ƒè¢«ç§°ä¸º Micro Kernel Designï¼ˆå¾®å†…æ ¸ï¼‰ã€‚åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œå¸Œæœ›åœ¨ kernel mode ä¸­è¿è¡Œå°½å¯èƒ½å°‘çš„ä»£ç ã€‚æ‰€ä»¥è¿™ç§è®¾è®¡ä¸‹è¿˜æ˜¯æœ‰å†…æ ¸ï¼Œä½†æ˜¯å†…æ ¸åªæœ‰éå¸¸å°‘çš„å‡ ä¸ªæ¨¡å—ï¼Œä¾‹å¦‚ï¼Œå†…æ ¸é€šå¸¸ä¼šæœ‰ä¸€äº› IPC çš„å®ç°æˆ–è€…æ˜¯ Message passingï¼›éå¸¸å°‘çš„è™šæ‹Ÿå†…å­˜çš„æ”¯æŒï¼Œå¯èƒ½åªæ”¯æŒäº† page tableï¼›ä»¥åŠåˆ†æ—¶å¤ç”¨ CPU çš„ä¸€äº›æ”¯æŒã€‚ ä¼šå¾ˆä¾èµ– IPCï¼Ÿç°åœ¨ï¼Œå¯¹äºä»»ä½•æ–‡ä»¶ç³»ç»Ÿçš„äº¤äº’ï¼Œéƒ½éœ€è¦åˆ†åˆ«å®Œæˆ 2 æ¬¡ç”¨æˆ·ç©ºé—´\u003c-\u003eå†…æ ¸ç©ºé—´çš„è·³è½¬ã€‚ä¸å®å†…æ ¸å¯¹æ¯”ï¼Œåœ¨å®å†…æ ¸ä¸­å¦‚æœä¸€ä¸ªåº”ç”¨ç¨‹åºéœ€è¦ä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’ï¼Œåªéœ€è¦å®Œæˆ 1 æ¬¡ç”¨æˆ·ç©ºé—´\u003c-\u003eå†…æ ¸ç©ºé—´çš„è·³è½¬ï¼Œæ‰€ä»¥å¾®å†…æ ¸çš„çš„è·³è½¬æ˜¯å®å†…æ ¸çš„ä¸¤å€ã€‚é€šå¸¸å¾®å†…æ ¸çš„æŒ‘æˆ˜åœ¨äºæ€§èƒ½æ›´å·®ï¼Œè¿™é‡Œæœ‰ä¸¤ä¸ªæ–¹é¢éœ€è¦è€ƒè™‘ï¼š åœ¨ user/kernel mode åå¤è·³è½¬å¸¦æ¥çš„æ€§èƒ½æŸè€—ã€‚ åœ¨ä¸€ä¸ªç±»ä¼¼å®å†…æ ¸çš„ç´§è€¦åˆç³»ç»Ÿï¼Œå„ä¸ªç»„æˆéƒ¨åˆ†ï¼Œä¾‹å¦‚æ–‡ä»¶ç³»ç»Ÿå’Œè™šæ‹Ÿå†…å­˜ç³»ç»Ÿï¼Œå¯ä»¥å¾ˆå®¹æ˜“çš„å…±äº« page cacheã€‚è€Œåœ¨å¾®å†…æ ¸ä¸­ï¼Œæ¯ä¸ªéƒ¨åˆ†ä¹‹é—´éƒ½å¾ˆå¥½çš„éš”ç¦»å¼€äº†ï¼Œè¿™ç§å…±äº«æ›´éš¾å®ç°ã€‚è¿›è€Œå¯¼è‡´æ›´éš¾åœ¨å¾®å†…æ ¸ä¸­å¾—åˆ°æ›´é«˜çš„æ€§èƒ½ã€‚ åœ¨å°†ä¿æŠ¤ä¸ç®¡ç†åˆ†ç¦»çš„è¿‡ç¨‹ä¸­ï¼ŒExokernel æ‰§è¡Œä¸‰é¡¹é‡è¦ä»»åŠ¡ï¼š tracking ownership of resources ensuring protection by guarding all resource usage or binding points, and revoking access to resources Exokernel é‡‡ç”¨äº†ä¸‰ç§æŠ€æœ¯ã€‚é¦–å…ˆï¼Œä½¿ç”¨å®‰å…¨ç»‘å®šï¼Œåº“æ“ä½œç³»ç»Ÿå¯ä»¥å®‰å…¨åœ°ç»‘å®šåˆ°æœºå™¨èµ„æºã€‚å…¶æ¬¡ï¼Œå¯è§æ’¤é”€å…è®¸åº“æ“ä½œç³»ç»Ÿå‚ä¸èµ„æºæ’¤é”€åè®®ã€‚ç¬¬ä¸‰ï¼Œä¸­æ­¢åè®®ç”± Exokernel ä½¿ç”¨ï¼Œé€šè¿‡å¼ºåˆ¶æ‰‹æ®µæ‰“ç ´ä¸åˆä½œåº“æ“ä½œç³»ç»Ÿçš„å®‰å…¨ç»‘å®šã€‚ ","date":"2024-09-11","objectID":"/posts/exokernel-paper/:5:0","tags":["Paper Reading"],"title":"Paper Reading: Exokernel","uri":"/posts/exokernel-paper/"},{"categories":null,"content":"Design Principles An exokernel specifies the details of the interface that library operating systems use to claim, release, and use machine resources. å®‰å…¨åœ°æš´éœ²ç¡¬ä»¶ã€‚å¯¼å‡ºçš„èµ„æºæ˜¯åº•å±‚ç¡¬ä»¶æä¾›çš„èµ„æºï¼šç‰©ç†å†…å­˜ã€CPUã€ç£ç›˜å†…å­˜ã€è½¬æ¢åå¤‡ç¼“å†²åŒºï¼ˆTLBï¼‰å’Œåœ°å€ä¸Šä¸‹æ–‡æ ‡è¯†ç¬¦ã€‚è¿™ä¸€åŸåˆ™çš„åŠ¨æœºæ˜¯æˆ‘ä»¬è®¤ä¸ºåˆ†å¸ƒå¼ã€åº”ç”¨ç¨‹åºç‰¹å®šçš„èµ„æºç®¡ç†æ˜¯æ„å»ºé«˜æ•ˆçµæ´»ç³»ç»Ÿçš„æœ€ä½³æ–¹å¼ã€‚åç»­åŸåˆ™å¤„ç†å®ç°è¿™ä¸€ç›®æ ‡çš„ç»†èŠ‚ã€‚ æš´éœ²åˆ†é…ã€‚ æš´éœ²åç§°ã€‚physical names æš´éœ²æ’¤é”€ï¼Œåˆ©ç”¨å¯è§çš„èµ„æºæ’¤é”€åè®®ï¼Œ å°½å¯èƒ½åœ°å‡å°‘åŸè¯­ï¼Œæš´éœ²ä½çº§åŸè¯­ï¼ŒåŒæ—¶ä¿è¯å®‰å…¨å’Œçµæ´»ï¼Œ exokernel hands over resource policy decisions to library operating systems èµ„æºç®¡ç†ä¹Ÿäº¤ç»™åº“ç³»ç»Ÿï¼Ÿè®© app å†³å®šæ€ä¹ˆä½¿ç”¨èµ„æºï¼Œ ","date":"2024-09-11","objectID":"/posts/exokernel-paper/:5:1","tags":["Paper Reading"],"title":"Paper Reading: Exokernel","uri":"/posts/exokernel-paper/"},{"categories":null,"content":"Secure Bindings Exokernel çš„ä¸»è¦ä»»åŠ¡ä¹‹ä¸€æ˜¯å®‰å…¨åœ°å¤ç”¨èµ„æºï¼Œä¸ºç›¸äº’ä¸ä¿¡ä»»çš„åº”ç”¨ç¨‹åºæä¾›ä¿æŠ¤ã€‚ä¸ºäº†å®ç°ä¿æŠ¤ï¼ŒExokernel å¿…é¡»ä¿æŠ¤æ¯ä¸ªèµ„æºã€‚ä¸ºäº†é«˜æ•ˆåœ°å®Œæˆè¿™é¡¹ä»»åŠ¡ï¼ŒExokernel å…è®¸åº“æ“ä½œç³»ç»Ÿä½¿ç”¨å®‰å…¨ç»‘å®šç»‘å®šåˆ°èµ„æº æ²¡å¤ªç†è§£ä»€ä¹ˆæ˜¯ä¿æŠ¤åº”ç”¨ç¨‹åº ä½¿ç”¨ä¸‰ç§åŸºæœ¬æŠ€æœ¯æ¥å®ç°å®‰å…¨ç»‘å®šï¼šç¡¬ä»¶æœºåˆ¶ã€è½¯ä»¶ç¼“å­˜å’Œä¸‹è½½åº”ç”¨ç¨‹åºä»£ç ã€‚ å®‰å…¨ç»‘å®šå¯ä»¥åœ¨ Exokernel ä¸­ç¼“å­˜ã€‚ä¾‹å¦‚ï¼ŒExokernel å¯ä»¥ä½¿ç”¨å¤§å‹è½¯ä»¶ TLB [7, 28] ç¼“å­˜ä¸é€‚åˆç¡¬ä»¶ TLB çš„åœ°å€è½¬æ¢ã€‚è½¯ä»¶ TLB å¯ä»¥è¢«è§†ä¸ºç»å¸¸ä½¿ç”¨çš„å®‰å…¨ç»‘å®šçš„ç¼“å­˜ã€‚ å®‰å…¨ç»‘å®šå¯ä»¥é€šè¿‡å°†ä»£ç ä¸‹è½½åˆ°å†…æ ¸ä¸­æ¥å®ç°ã€‚æ¯æ¬¡èµ„æºè®¿é—®æˆ–äº‹ä»¶æ—¶éƒ½ä¼šè°ƒç”¨æ­¤ä»£ç ä»¥ç¡®å®šæ‰€æœ‰æƒå’Œå†…æ ¸åº”æ‰§è¡Œçš„æ“ä½œã€‚å°†ä»£ç ä¸‹è½½åˆ°å†…æ ¸ä¸­å…è®¸åœ¨å‘ç”Ÿå†…æ ¸äº‹ä»¶æ—¶ç«‹å³æ‰§è¡Œåº”ç”¨ç¨‹åºæ§åˆ¶çº¿ç¨‹ã€‚ä¸‹è½½ä»£ç çš„ä¼˜ç‚¹æ˜¯å¯ä»¥é¿å…æ½œåœ¨çš„æ˜‚è´µäº¤å‰ï¼Œå¹¶ä¸”æ­¤ä»£ç å¯ä»¥åœ¨ä¸è¦æ±‚è°ƒåº¦åº”ç”¨ç¨‹åºæœ¬èº«çš„æƒ…å†µä¸‹è¿è¡Œã€‚ç±»å‹å®‰å…¨è¯­è¨€ [9, 42]ã€è§£é‡Šå’Œæ²™ç®± [52] å¯ä»¥ç”¨äºå®‰å…¨åœ°æ‰§è¡Œä¸å—ä¿¡ä»»çš„åº”ç”¨ç¨‹åºä»£ç  [21]ã€‚ Multiplexing Physical Memory åŸå‹ Exokernel ä¸­å®ç°äº†ç‰©ç†å†…å­˜çš„å®‰å…¨ç»‘å®šï¼Œ å½“åº“æ“ä½œç³»ç»Ÿåˆ†é…ä¸€ä¸ªç‰©ç†å†…å­˜é¡µé¢æ—¶ï¼ŒExokernel é€šè¿‡è®°å½•æ‰€æœ‰è€…å’Œåº“æ“ä½œç³»ç»ŸæŒ‡å®šçš„è¯»å†™èƒ½åŠ›æ¥ä¸ºè¯¥é¡µé¢åˆ›å»ºä¸€ä¸ªå®‰å…¨ç»‘å®šã€‚é¡µé¢çš„æ‰€æœ‰è€…æœ‰æƒæ›´æ”¹ä¸å…¶å…³è”çš„èƒ½åŠ›å¹¶å°†å…¶é‡Šæ”¾ã€‚ç‰¹æƒæœºå™¨æ“ä½œï¼ˆå¦‚ TLB åŠ è½½å’Œ DMAï¼‰å¿…é¡»ç”± Exokernel ä¿æŠ¤ã€‚æ ¹æ® Exokernel æš´éœ²å†…æ ¸ç°¿è®°ç»“æ„çš„åŸåˆ™ï¼Œé¡µè¡¨åº”åœ¨åº”ç”¨ç¨‹åºçº§åˆ«å¯è§ï¼ˆåªè¯»ï¼‰ã€‚ Multiplexing Network ç½‘ç»œè§£å¤ç”¨æ”¯æŒå¯ä»¥é€šè¿‡è½¯ä»¶æˆ–ç¡¬ä»¶æä¾›ã€‚ç¡¬ä»¶æœºåˆ¶çš„ä¸€ä¸ªä¾‹å­æ˜¯ä½¿ç”¨ ATM ä¿¡å…ƒä¸­çš„è™šæ‹Ÿç”µè·¯å°†æµå®‰å…¨åœ°ç»‘å®šåˆ°åº”ç”¨ç¨‹åº [19]ã€‚è½¯ä»¶æ”¯æŒå¯ä»¥é€šè¿‡åŒ…è¿‡æ»¤å™¨ [37] æä¾›æ¶ˆæ¯è§£å¤ç”¨ã€‚åŒ…è¿‡æ»¤å™¨å¯ä»¥è¢«è§†ä¸ºå®‰å…¨ç»‘å®šçš„å®ç°ï¼Œå…¶ä¸­åº”ç”¨ç¨‹åºä»£ç â€”â€”è¿‡æ»¤å™¨â€”â€”è¢«ä¸‹è½½åˆ°å†…æ ¸ä¸­ã€‚åè®®çŸ¥è¯†ä»…é™äºåº”ç”¨ç¨‹åºï¼Œè€Œç¡®å®šæ•°æ®åŒ…æ‰€æœ‰æƒçš„ä¿æŠ¤æ£€æŸ¥ä»¥å†…æ ¸ç†è§£çš„è¯­è¨€è¡¨è¾¾ã€‚é€šè¿‡ä»”ç»†çš„è¯­è¨€è®¾è®¡ï¼ˆä»¥é™åˆ¶è¿è¡Œæ—¶ï¼‰å’Œè¿è¡Œæ—¶æ£€æŸ¥ï¼ˆä»¥é˜²æ­¢é‡æŒ‡é’ˆå’Œå±é™©æ“ä½œï¼‰ç¡®ä¿æ•…éšœéš”ç¦»ã€‚ ","date":"2024-09-11","objectID":"/posts/exokernel-paper/:5:2","tags":["Paper Reading"],"title":"Paper Reading: Exokernel","uri":"/posts/exokernel-paper/"},{"categories":null,"content":"Downloading Code é™¤äº†å®ç°å®‰å…¨ç»‘å®šå¤–ï¼Œä¸‹è½½ä»£ç è¿˜å¯ä»¥ç”¨äºæé«˜æ€§èƒ½ã€‚å°†ä»£ç ä¸‹è½½åˆ°å†…æ ¸æœ‰ä¸¤ä¸ªä¸»è¦çš„æ€§èƒ½ä¼˜åŠ¿ã€‚ç¬¬ä¸€ä¸ªæ˜¯æ˜¾è€Œæ˜“è§çš„ï¼šæ¶ˆé™¤å†…æ ¸äº¤å‰ã€‚ å¤ªå¤šæ¦‚å¿µä¸æ‡‚äº† ï¼Œå‘¨æœ«æœ‰ç©ºçœ‹çœ‹ mit os ","date":"2024-09-11","objectID":"/posts/exokernel-paper/:5:3","tags":["Paper Reading"],"title":"Paper Reading: Exokernel","uri":"/posts/exokernel-paper/"},{"categories":null,"content":"Visible Resource Revocation Exokernel å¯¹å¤§å¤šæ•°èµ„æºä½¿ç”¨å¯è§æ’¤é”€ã€‚å³ä½¿åœ¨æ—¶é—´ç‰‡ç»“æŸæ—¶ï¼Œå¤„ç†å™¨ä¹Ÿä¼šè¢«æ˜¾å¼æ’¤é”€ï¼› æ’¤é”€æ˜¯ä»€ä¹ˆï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Ÿ åœ¨å¯è§æ’¤é”€ä¸­ï¼Œæ“ä½œç³»ç»Ÿæˆ–å†…æ ¸åœ¨å›æ”¶èµ„æºä¹‹å‰ä¼šé€šçŸ¥åº”ç”¨ç¨‹åºæˆ–åº“æ“ä½œç³»ç»Ÿã€‚åº”ç”¨ç¨‹åºæœ‰æœºä¼šåœ¨èµ„æºè¢«å›æ”¶ä¹‹å‰æ‰§è¡Œä¸€äº›æ¸…ç†æˆ–ä¿å­˜æ“ä½œã€‚æ’¤é”€ï¼ˆRevocationï¼‰æ˜¯æŒ‡æ“ä½œç³»ç»Ÿæˆ–å†…æ ¸å›æ”¶å·²ç»åˆ†é…ç»™åº”ç”¨ç¨‹åºæˆ–è¿›ç¨‹çš„èµ„æºçš„è¿‡ç¨‹ã€‚è¿™äº›èµ„æºå¯èƒ½åŒ…æ‹¬ç‰©ç†å†…å­˜ã€å¤„ç†å™¨æ—¶é—´ç‰‡ã€æ–‡ä»¶æè¿°ç¬¦ã€ç½‘ç»œè¿æ¥ç­‰ã€‚æ’¤é”€çš„ç›®çš„æ˜¯ç¡®ä¿èµ„æºèƒ½å¤Ÿè¢«é‡æ–°åˆ†é…ç»™å…¶ä»–åº”ç”¨ç¨‹åºæˆ–è¿›ç¨‹ï¼Œä»è€Œæé«˜ç³»ç»Ÿçš„æ•´ä½“èµ„æºåˆ©ç”¨ç‡ã€‚ ","date":"2024-09-11","objectID":"/posts/exokernel-paper/:5:4","tags":["Paper Reading"],"title":"Paper Reading: Exokernel","uri":"/posts/exokernel-paper/"},{"categories":null,"content":"Revocation and Physical Naming æˆ‘ä»¬å°†æ’¤é”€è¿‡ç¨‹è§†ä¸º Exokernel å’Œåº“æ“ä½œç³»ç»Ÿä¹‹é—´çš„å¯¹è¯ã€‚åº“æ“ä½œç³»ç»Ÿåº”ç»„ç»‡èµ„æºåˆ—è¡¨ï¼Œä»¥ä¾¿å¯ä»¥å¿«é€Ÿé‡Šæ”¾èµ„æºã€‚ä¾‹å¦‚ï¼Œåº“æ“ä½œç³»ç»Ÿå¯ä»¥æ‹¥æœ‰ä¸€ä¸ªç®€å•çš„ç‰©ç†é¡µé¢å‘é‡ï¼šå½“å†…æ ¸æŒ‡ç¤ºæŸäº›é¡µé¢åº”è¢«é‡Šæ”¾æ—¶ï¼Œåº“æ“ä½œç³»ç»Ÿé€‰æ‹©å…¶é¡µé¢ä¹‹ä¸€ï¼Œå°†å…¶å†™å…¥ç£ç›˜ï¼Œå¹¶é‡Šæ”¾å®ƒã€‚ å†™å…¥ç£ç›˜ï¼Ÿ ","date":"2024-09-11","objectID":"/posts/exokernel-paper/:5:5","tags":["Paper Reading"],"title":"Paper Reading: Exokernel","uri":"/posts/exokernel-paper/"},{"categories":null,"content":"Abort Protocol çœ‹ä¸æ‡‚äº† åé¢æ˜¯ Aegis çš„å®ç°ï¼Œå’Œä¸€äº›ä¸ Ultrix çš„æ€§èƒ½æ¯”è¾ƒ ","date":"2024-09-11","objectID":"/posts/exokernel-paper/:5:6","tags":["Paper Reading"],"title":"Paper Reading: Exokernel","uri":"/posts/exokernel-paper/"},{"categories":null,"content":"åè®° ä¸å¾—ä¸æ„Ÿå¹è‡ªå·±è¯»è®ºæ–‡æ•ˆç‡ä½ä¸‹ï¼Œæµ…æ˜¾çš„çœ‹å¾—æ…¢ï¼Œæ·±å…¥çš„çœ‹ä¸æ‡‚ï¼Œè¯»èµ·æ¥è¿™è¡¥è¡¥é‚£è¡¥è¡¥ï¼Œå¾ˆå®¹æ˜“å°±çœ‹ä¸å®Œ ","date":"2024-09-11","objectID":"/posts/exokernel-paper/:6:0","tags":["Paper Reading"],"title":"Paper Reading: Exokernel","uri":"/posts/exokernel-paper/"},{"categories":null,"content":"Scalability! But at what COST? æ¯”è¾ƒçŸ­çš„ paperï¼Œä¹‹å‰ä¹Ÿç•¥æœ‰çœ‹è¿‡ï¼Œä¸»è¦è®²ä¸»æµåˆ†å¸ƒå¼æ¡†æ¶åœ¨å¤šæœºå™¨ä¸Šå­˜åœ¨ COST(ä¸æ˜¯æˆæœ¬) é—®é¢˜ï¼Œå¹¶ä¸ä¸€å®šèƒ½æ¯”å•æœºæ›´å¥½ã€‚æ˜¯å¾ˆæœ‰æ„æ€çš„ä¸»é¢˜ã€‚ ","date":"2024-09-08","objectID":"/posts/scalability-cost/:1:0","tags":["Paper Reading"],"title":"Paper Reading: Scalability! But at what COST","uri":"/posts/scalability-cost/"},{"categories":null,"content":"Abstract new metric for big data platforms: COST Configuration that Outperforms a Single Thread, è¶…è¶Šå•çº¿ç¨‹çš„é…ç½® è®¸å¤šç³»ç»Ÿçš„ COST å‡ºä¹æ„æ–™åœ°å¤§ï¼Œé€šå¸¸éœ€è¦æ•°ç™¾ä¸ªæ ¸å¿ƒï¼Œæˆ–è€…åœ¨æ‰€æœ‰æŠ¥å‘Šçš„é…ç½®ä¸­ï¼Œå…¶æ€§èƒ½å§‹ç»ˆæ— æ³•è¶…è¶Šå•çº¿ç¨‹ã€‚ ","date":"2024-09-08","objectID":"/posts/scalability-cost/:2:0","tags":["Paper Reading"],"title":"Paper Reading: Scalability! But at what COST","uri":"/posts/scalability-cost/"},{"categories":null,"content":"Introduction å¯æ‰©å±•æ€§è§†ä¸ºåˆ†å¸ƒå¼æ•°æ®å¤„ç†å¹³å°æœ€é‡è¦çš„ç‰¹æ€§ï¼Œä½†å¾ˆå°‘æœ‰ç ”ç©¶ç›´æ¥è¯„ä¼°å…¶ç³»ç»Ÿåœ¨åˆç†åŸºå‡†æµ‹è¯•ä¸‹çš„ç»å¯¹æ€§èƒ½ã€‚è¿™äº›ç³»ç»Ÿåœ¨å¤šå¤§ç¨‹åº¦ä¸ŠçœŸæ­£æå‡äº†æ€§èƒ½ï¼Œè€Œä¸æ˜¯ä»…ä»…å¹¶è¡ŒåŒ–äº†å®ƒä»¬è‡ªèº«å¼•å…¥çš„å¼€é”€ï¼Ÿ any system can scale arbitrarily well with a sufficient lack of care in its implementation. æ¶ˆé™¤äº†å¹¶è¡Œå¸¦æ¥çš„å¼€é”€ï¼ŒæŸå®³äº†å¯æ‰©å±•æ€§ï¼Œä½†æ˜¯æé«˜äº†æ€§èƒ½ã€‚ï¼ˆå¤šæ ¸æƒ…å†µä¸‹ speed up é™ä½äº†ï¼Œä½†æ˜¯å»¶è¿Ÿå´ä½äº†ï¼‰ ","date":"2024-09-08","objectID":"/posts/scalability-cost/:3:0","tags":["Paper Reading"],"title":"Paper Reading: Scalability! But at what COST","uri":"/posts/scalability-cost/"},{"categories":null,"content":"Methodology graph processing, many published systems have unbounded COSTâ€”i.e., no configuration outperforms the best single-threaded implementationâ€”for all of the problems to which they have been applied In some cases the singlethreaded implementations are more than an order of mag- nitude faster than published results for systems using hundreds of cores. è®¸å¤šè€çš„ç³»ç»Ÿå¾ˆéš¾è¶…è¶Šå•æœºçš„è¡¨ç°ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿä½œè€…æ˜¯å¦æ¶ˆé™¤äº†å¹¶è¡Œçš„å¼€é”€ï¼Œæ¯”å¦‚å…±è¯†ç®—æ³•ï¼Ÿå†è€…è¯´æ‹¿æ—§çš„ç³»ç»Ÿç°åœ¨æ¥æ¯”ï¼Œæ˜¯ä¸æ˜¯æœ‰äº›ä¸å…¬å¹³å‘¢ï¼Œä¼˜åŒ–ä»€ä¹ˆçš„ä¹Ÿä¸å¤ªä¸€æ ·ã€‚ ä¸è¿‡æ¯”è¾ƒäº† pagerank åœ¨ä¸åŒç³»ç»Ÿçš„è¡¨ç° ","date":"2024-09-08","objectID":"/posts/scalability-cost/:3:1","tags":["Paper Reading"],"title":"Paper Reading: Scalability! But at what COST","uri":"/posts/scalability-cost/"},{"categories":null,"content":"Basic Graph Computations ä½œè€…ç”¨çš„æ˜¯å•çº¿ç¨‹ C# ä»£ç ï¼Œæœ‰ç‚¹ç¥ç§˜ ","date":"2024-09-08","objectID":"/posts/scalability-cost/:4:0","tags":["Paper Reading"],"title":"Paper Reading: Scalability! But at what COST","uri":"/posts/scalability-cost/"},{"categories":null,"content":"PageRank å¯ä»¥çœ‹åˆ°å•æœºçš„æ€§èƒ½åè€Œä¼˜ç§€å¾ˆå¤š è®ºæ–‡æ˜¯ä½¿ç”¨ SSD + RAMï¼Œæœ‰æ²¡æœ‰æœºæ¢°ç¡¬ç›˜çš„æ¯”è¾ƒå‘¢ ","date":"2024-09-08","objectID":"/posts/scalability-cost/:4:1","tags":["Paper Reading"],"title":"Paper Reading: Scalability! But at what COST","uri":"/posts/scalability-cost/"},{"categories":null,"content":"Connected Components å•çº¿ç¨‹è¿˜æ˜¯å¿« ä»–çš„å•æœºæ€§èƒ½åˆ°åº•å¦‚ä½•å‘¢ï¼Ÿä¹‹å‰æˆ‘ä¹Ÿåšäº†å¤š ec2 å’Œå• ec2 çš„æ¯”è¾ƒï¼Œæ ¸å¿ƒè¾ƒå°‘çš„æ—¶å€™ç¡®å®æ˜¯æœ‰æ€§èƒ½æå‡çš„ï¼Œä½†éšç€æ ¸æ•°å¢å¤šï¼Œç¡®å®å­˜åœ¨ç”±äºåˆ†ç‰‡ç®—æ³•ç²¾åº¦ä¸¢å¤±å¯¼è‡´çš„ä¸å‡åŒ€å¯¼è‡´æå‡ä¸æ˜¯çº¿æ€§ ","date":"2024-09-08","objectID":"/posts/scalability-cost/:4:2","tags":["Paper Reading"],"title":"Paper Reading: Scalability! But at what COST","uri":"/posts/scalability-cost/"},{"categories":null,"content":"Better Baselines ","date":"2024-09-08","objectID":"/posts/scalability-cost/:5:0","tags":["Paper Reading"],"title":"Paper Reading: Scalability! But at what COST","uri":"/posts/scalability-cost/"},{"categories":null,"content":"Improving graph layout è®ºæ–‡ä¼˜åŒ–äº†å…¶ä»–çš„å®ç°ï¼Œæ¯”å¦‚å›¾å®ç° ","date":"2024-09-08","objectID":"/posts/scalability-cost/:5:1","tags":["Paper Reading"],"title":"Paper Reading: Scalability! But at what COST","uri":"/posts/scalability-cost/"},{"categories":null,"content":"Improving algorithms ä¼˜åŒ–ç®—æ³•ï¼Œå›¾è”é€šï¼Œåº”è¯¥å¹¶ä¸æ˜¯é€‚åˆå¹¶è¡Œçš„æŠŠ æ€ä¹ˆè¿˜æœ‰å¹¶æŸ¥é›†ï¼Ÿ ","date":"2024-09-08","objectID":"/posts/scalability-cost/:5:2","tags":["Paper Reading"],"title":"Paper Reading: Scalability! But at what COST","uri":"/posts/scalability-cost/"},{"categories":null,"content":"Applying COST to prior work ","date":"2024-09-08","objectID":"/posts/scalability-cost/:6:0","tags":["Paper Reading"],"title":"Paper Reading: Scalability! But at what COST","uri":"/posts/scalability-cost/"},{"categories":null,"content":"PageRank ","date":"2024-09-08","objectID":"/posts/scalability-cost/:7:0","tags":["Paper Reading"],"title":"Paper Reading: Scalability! But at what COST","uri":"/posts/scalability-cost/"},{"categories":null,"content":"Graph connectivity ","date":"2024-09-08","objectID":"/posts/scalability-cost/:8:0","tags":["Paper Reading"],"title":"Paper Reading: Scalability! But at what COST","uri":"/posts/scalability-cost/"},{"categories":null,"content":"Lessons learned scalable systems design and implementation contribute to overheads and increased COST å…¶å®åˆ°åº•åšäº†ä»€ä¹ˆå¯¼è‡´ overhead å’Œ COSTï¼Ÿæ˜¯ä¹‹å‰çš„ç ”ç©¶åŸºå‡†æµ‹è¯•ä¸å¯¹å—ï¼Œè¿˜æ˜¯è¯´è¿™ç¯‡æ–‡ç« åœ¨å›¾å¤„ç†ä¸Šæœ‰é—®é¢˜ï¼Ÿ é‚£ä¸ºä»€ä¹ˆå¤§å®¶è¿˜ç”¨ mapreduce, spark å‘¢ï¼Ÿç”šè‡³ç°åœ¨è¶Šæ¥è¶Šå¤šåˆ†å¸ƒå¼æ•°æ®åº“å‘¢ ä½œè€…æåˆ° MapReduce å­˜åœ¨è®¸å¤šç£ç›˜å†™å…¥ï¼Œæ˜¯æŒä¹…åŒ–çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä»–çš„å®éªŒå¾ˆå¯èƒ½éƒ½æ˜¯å†…å­˜çš„ï¼Ÿ ","date":"2024-09-08","objectID":"/posts/scalability-cost/:9:0","tags":["Paper Reading"],"title":"Paper Reading: Scalability! But at what COST","uri":"/posts/scalability-cost/"},{"categories":null,"content":"Future directions (for the area) è®¸å¤šé«˜æ€§èƒ½çš„å¯æ‰©å±•ç³»ç»Ÿå®ä¾‹å­˜åœ¨ã€‚Galois [17] å’Œ Ligra [23] éƒ½æ˜¯å…±äº«å†…å­˜ç³»ç»Ÿï¼Œå½“åœ¨å•å°æœºå™¨ä¸Šè¿è¡Œæ—¶ï¼Œå®ƒä»¬çš„è¡¨ç°æ˜¾è‘—ä¼˜äºå…¶åˆ†å¸ƒå¼åŒç±»ç³»ç»Ÿã€‚Naiad [16] å¼•å…¥äº†ä¸€ç§æ–°çš„é€šç”¨æ•°æ®æµæ¨¡å‹ï¼Œç”šè‡³è¶…è¶Šäº†ä¸“ç”¨ç³»ç»Ÿã€‚ç†è§£è¿™äº›ç³»ç»Ÿåšå¾—æ­£ç¡®çš„åœ°æ–¹ä»¥åŠå¦‚ä½•æ”¹è¿›å®ƒä»¬ï¼Œæ¯”åœ¨æ–°çš„é¢†åŸŸä¸­é‡å¤ç°æœ‰æƒ³æ³•å¹¶ä¸å…ˆå‰å·¥ä½œä¸­æœ€å·®çš„éƒ¨åˆ†è¿›è¡Œæ¯”è¾ƒæ›´ä¸ºé‡è¦ã€‚ ","date":"2024-09-08","objectID":"/posts/scalability-cost/:10:0","tags":["Paper Reading"],"title":"Paper Reading: Scalability! But at what COST","uri":"/posts/scalability-cost/"},{"categories":null,"content":"The Multikernel: A New OS Architecture for Scalable Multicore Systems SOSP 09 çš„æ–‡ç« ï¼Œæå‡ºäº† MultiKernel åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œç½‘ç»œæ¶æ„æ˜¯å¦‚ä½•åšé€šä¿¡ã€æ¶ˆæ¯ä¼ é€’çš„ã€‚ ","date":"2024-09-08","objectID":"/posts/multikernel-os/:1:0","tags":["Paper Reading"],"title":"Paper Reading: The Multikernel: A New OS Architecture for Scalable Multicore Systems","uri":"/posts/multikernel-os/"},{"categories":null,"content":"ABSTRACT å•†ç”¨è®¡ç®—æœºè¶Šæ¥è¶Šå¤šçš„ processor cores å’Œå¤šæ ·åŒ–çš„æ¶æ„ï¼Œå†…å­˜ã€äº’è” ã€æŒ‡ä»¤é›†ã€IO é…ç½®ç­‰ç­‰ï¼Œä»¥å‰çš„é«˜æ€§èƒ½è®¡ç®—æœºå·²ç»å¯ä»¥ scaledï¼Œä½†æ˜¯ç°ä»£ server workloads æ˜¯åŠ¨æ€çš„ï¼ŒOS æ˜¯é™æ€çš„ï¼Ÿä¼˜åŒ–å¾ˆéš¾åšï¼Ÿ æå‡ºäº† multikernel æ¶æ„ï¼Œå°†æœºå™¨çœ‹ä½œç½‘ç»œ/ç‹¬ç«‹æ ¸å¿ƒï¼Œå‡è®¾åº•å±‚æ²¡æœ‰ inter-core sharingï¼Œå°†ä¼ ç»Ÿ os åŠŸèƒ½æ”¾åˆ°äº†åˆ†å¸ƒå¼ç³»ç»Ÿè¿›ç¨‹ä¸­ï¼Œä½¿ç”¨ message-passing è¿›è¡Œæ¶ˆæ¯ä¼ é€’ã€‚ æ²¡çœ‹æ‡‚ motivationï¼Œéš¾ç‚¹åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿè§£å†³äº†ä»€ä¹ˆï¼Ÿ ","date":"2024-09-08","objectID":"/posts/multikernel-os/:2:0","tags":["Paper Reading"],"title":"Paper Reading: The Multikernel: A New OS Architecture for Scalable Multicore Systems","uri":"/posts/multikernel-os/"},{"categories":null,"content":"INTRODUCTION ç¡¬ä»¶å‘å±•å¿«äºè½¯ä»¶ï¼Œscalability and correctness å¸¦æ¥äº†æŒ‘æˆ˜ã€‚å¤šæ ¸ç³»ç»Ÿçš„ workloads æ›´åŠ éš¾ä»¥é¢„æµ‹ï¼Œæ›´åå‘äº os-intensiveã€‚ é’ˆå¯¹ç‰¹å®šç¡¬ä»¶è°ƒä¼˜é€šç”¨ OS ä¸å†èƒ½æ¥å—ï¼Œç¡¬ä»¶åŒºåˆ«å¤ªå¤§ï¼Œå½“æœ‰æ–°ç¡¬ä»¶æ—¶ï¼Œä¼˜åŒ–ä¼šè¿‡æ—¶ã€‚ ä¼˜åŒ–å¾€å¾€è°ƒå‚ï¼ˆå†…å­˜ä¸€è‡´æ€§æ¨¡å‹ã€ç¼“å­˜å±‚æ¬¡ã€æˆæœ¬ï¼‰ï¼Œå¯ç§»æ¤æ€§ä¸é«˜ã€‚ shared-memory kernelï¼Œä½¿ç”¨é”æ¥åŒ…å«å…±äº«æ•°æ®ç»“æ„ï¼Œæœ¬æ–‡å°† OS çœ‹ä½œåˆ†å¸ƒå¼ç³»ç»Ÿçš„ä¸€ä¸ªåŠŸèƒ½å•å…ƒï¼ˆç”¨æ¶ˆæ¯è¿›è¡Œé€šä¿¡ï¼‰ï¼Œéµå¾ªä¸‰ä¸ªè®¾è®¡åŸåˆ™ï¼Œæ‰€æœ‰å†…æ ¸é—´é€šä¿¡æ˜¯æ˜¾å¼çš„ï¼›OS ç»“æ„ä¸ç¡¬ä»¶æ— å…³ï¼›çŠ¶æ€æ˜¯å¤åˆ¶è€Œä¸æ˜¯å…±äº«ã€‚ å¦‚å›¾æ˜¯æœ¬æ–‡æå‡ºçš„ multikernel æ¶æ„ å°½ç®¡æ˜¯å½“å‰é«˜æ•ˆçš„ cache-coherent shared memoryï¼Œä½¿ç”¨æ¶ˆæ¯ä¼ é€’ OS ä¹Ÿå¸¦æ¥äº†å¥½å¤„ï¼Œshared data structure ä¼šå—åˆ°ä¸²è¡Œã€è¿œç¨‹æ•°æ®è®¿é—®çš„å½±å“ï¼Œå¯¹è¿œç¨‹æ•°æ®è¿›è¡Œç®¡é“ pipeline å’Œ batch messages encoding å¯ä»¥è®©ä¸€ä¸ª core åŠ å¤§ååå’Œå‡å°‘ interconnect utilizationï¼Œä¹Ÿé€‚ç”¨äºå„ç§å¼‚æ„æ¶æ„ã€‚ æœ¬æ–‡çš„è´¡çŒ®ï¼š è®¾è®¡äº† multi-kernel æ¶æ„ï¼Œæ˜¾å¼æ¶ˆæ¯ä¼ é€’ï¼Œç¡¬ä»¶æ— å…³ï¼ŒçŠ¶æ€å¤åˆ¶ åŸºäºæ¶æ„è®¾è®¡äº† Barrelfish OSï¼Ÿ æµ‹é‡äº† Barrelfish æ»¡è¶³å¯ä¼¸ç¼©æ€§å’Œé€‚åº”æ€§ã€‚ å°† OS çœ‹ä½œåˆ†å¸ƒå¼ï¼Œåœ¨æˆ‘çœ‹æ¥æ˜¯éå¸¸å¤¸å¼ çš„æƒ³æ³•ï¼ŒOS æœ¬èº«å°±æ˜¯å’Œç¡¬ä»¶ç´§å¯†ç›¸è¿çš„ï¼Œå¦‚æœçŠ¶æ€éƒ½æ˜¯å¤åˆ¶ï¼Œéƒ½æ˜¯é€šä¿¡ï¼ŒIO å¸¦æ¥çš„å»¶è¿Ÿè°èƒ½æ¥å—å‘¢ï¼Œé‚£ RTOS æ€ä¹ˆåšå‘¢ã€‚ æ­¤å¤–ï¼Œæˆ‘ä¸€ç›´ä»¥ä¸º CPU çš„è®¾è®¡æ˜¯ç°ä»£ç¡¬ä»¶çš„åŸºç¡€ï¼ŒCPU å†³å®šäº†æ¶æ„ï¼Œå†³å®šäº† OS é•¿ä»€ä¹ˆæ ·ã€‚å› ä¸ºç¨‹åºéœ€è¦ç¼–è¯‘æˆæŒ‡ä»¤é›†è¿è¡Œåœ¨ CPU ä¸Šï¼Œä¸åŒæŒ‡ä»¤é›†å¯èƒ½æ•ˆæœä¸ä¸€æ · æ¶ˆæ¯ä¼ é€’åˆæ€ä¹ˆä¿æŒä¸€è‡´æ€§å‘¢ï¼ŸOS åˆ°åº•æ˜¯åŸºäºç¡¬ä»¶äº§ç”Ÿçš„ï¼Ÿè¿˜æ˜¯å…ˆæœ‰ OS å†æœ‰ç¡¬ä»¶ï¼Ÿè¿™æ ¹æœ¬ä¸æ˜¯å…ˆæœ‰é¸¡å…ˆæœ‰è›‹çš„é—®é¢˜å§ã€‚ å…¶å®æ–‡ç« å¼•å‡ºäº†ä¸€ä¸ªå¾ˆå¥½çš„é—®é¢˜ï¼Œå…±äº«å†…å­˜ è¿˜æ˜¯ æ¶ˆæ¯ä¼ é€’ã€‚ ","date":"2024-09-08","objectID":"/posts/multikernel-os/:3:0","tags":["Paper Reading"],"title":"Paper Reading: The Multikernel: A New OS Architecture for Scalable Multicore Systems","uri":"/posts/multikernel-os/"},{"categories":null,"content":"MOTIVATIONS ç°ä»£è®¡ç®—æœºéƒ½æœ‰å¤šæ ¸å¤„ç†å™¨ï¼Œå•†ä¸šæœåŠ¡å™¨å·²ç»æœ‰å‡ ç™¾æ ¸çš„å¤„ç†å™¨ï¼Œæ‰€ä»¥éœ€è¦æ–°çš„ OS æŠ€æœ¯é¢å¯¹å¤šæ ¸ç¡¬ä»¶ï¼Œè¿˜æ˜¯è¯´å•†ç”¨ OS åªéœ€è¦åˆ©ç”¨å¤šæ ¸å¤„ç†å™¨çš„æŠ€æœ¯ï¼Ÿ æœ¬æ–‡è®¤ä¸º OS åœ¨é¢å¯¹æœªæ¥ç¡¬ä»¶çš„é—®é¢˜å’Œç”¨äºé«˜æ€§èƒ½è®¡ç®—çš„ ccNUMA å’Œ SMP ä¸åŒï¼ˆå‰è€…ä½¿ç”¨éç»Ÿä¸€å†…å­˜è®¿é—®å’Œç¼“å­˜ä¸€è‡´æ€§ï¼Œè®¿é—®è¿œå¤„çš„å†…å­˜è¿˜æ˜¯éœ€è¦ç­‰å¾…ï¼›åè€…æ˜¯ Symmetric Multi-Processor è¡¨ç¤ºæ¯ä¸ªå¤„ç†å™¨éƒ½æ˜¯å¯¹ç§°çš„ï¼Œæ²¡æœ‰ä¸»ä»å…³ç³»ï¼Œå…±äº«æ‰€æœ‰å†…å­˜ï¼Œä½†æ˜¯å­˜åœ¨ç«äº‰ï¼Œæ‰€ä»¥æ‰©å±•æ€§è¾ƒå·®ï¼‰ éç»Ÿä¸€å†…å­˜ï¼Œå†…å­˜åˆ†æˆå¤šä¸ªèŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹å±äºä¸€ä¸ªæ ¸å¿ƒ ç¼“å­˜ä¸€è‡´æ€§ï¼ŒccNUMA æ‰€æœ‰å¤„ç†å™¨å…±äº«ä¸€ä¸ªå…¨å±€å†…å­˜ï¼Œéœ€è¦ç¼“å­˜ä¸€è‡´æ€§ä¿è¯æ‰€æœ‰å¤„ç†å™¨çœ‹åˆ°çš„å†…å­˜æ•°æ®æ˜¯ä¸€è‡´çš„ã€‚ MPP(Massive Parallel Processing) æ˜¯å¤šä¸ª SMPï¼Œæ˜¯ share nothing æ¶æ„ï¼Œæ‰©å±•èƒ½åŠ›å¼ºï¼ŒèŠ‚ç‚¹é—´ä¿¡æ¯äº¤æ¢æ˜¯äº’è”ç½‘é€šä¿¡ SMP å¯ä»¥çº¿æ€§æ‰©å±•ï¼ŒNUMA ç†è®ºå¯ä»¥æ— é™æ‰©å±•ï¼Œä½†ä¸æ˜¯çº¿æ€§çš„ï¼Œéœ€è¦ç­‰å¾…è¿œå¤„å†…å­˜è®¿é—® çœ‹å®Œ motivation åè€Œè§‰å¾—æ–‡ç« åˆç†äº†è®¸å¤šï¼Œæ–‡ç« æ³¨é‡ç‚¹åœ¨äºå¯æ‰©å±•æ€§ ","date":"2024-09-08","objectID":"/posts/multikernel-os/:4:0","tags":["Paper Reading"],"title":"Paper Reading: The Multikernel: A New OS Architecture for Scalable Multicore Systems","uri":"/posts/multikernel-os/"},{"categories":null,"content":"Systems are increasingly diverse å’Œ hpc ä¸åŒï¼Œé€šç”¨ OS å¿…é¡»åœ¨å¤šç§ç¡¬ä»¶/ç³»ç»Ÿè®¾è®¡ä¸­è¡¨ç°è‰¯å¥½ï¼Œæ‰€ä»¥æ— æ³•å¯¹ç‰¹å®šçš„ ç¡¬ä»¶è¿›è¡Œä¼˜åŒ– æ¯”å¦‚ï¼š Dice and Shavit show how a reader-writer lock can be built to exploit the shared, banked L2 cache on the Sun Niagara processor, using concurrent writes to the same cache line to track the presence of readers ç‰¹å®šå¤„ç†å™¨ä¸Šï¼Œåˆ©ç”¨å…±äº« L2 ç¼“å­˜å®ç°é«˜æ•ˆè¯»å†™é”ï¼Œç¼“å­˜è¡Œåœ¨ L2 ä¸ä¼šé¢‘ç¹ç§»åŠ¨ã€‚ä½†æ˜¯è¿™åœ¨ä¼ ç»Ÿå¤šæ ¸å¤„ç†å™¨ä¸é«˜æ•ˆï¼Œä¼šç§»åŠ¨ç¼“å­˜ã€‚ æ‰€ä»¥ï¼ŒOS è®¾è®¡å¦‚æœé’ˆå¯¹ç‰¹å®šçš„åŒæ­¥æœºåˆ¶ï¼Œå¯¹ä¸åŒçš„ç¡¬ä»¶å¯èƒ½æ— æ³•é€‚åº”ã€‚æ¨å‡ºæ–°ç¡¬ä»¶æ—¶ï¼ŒOS å¯èƒ½å´éš¾ä»¥é€‚åº”ã€‚ os ä¸ºäº†é€‚åº”ç°ä»£ç¡¬ä»¶ï¼Œéœ€è¦é‡‡ç”¨æ—¥æ¸å¤æ‚çš„ä¼˜åŒ–æ–¹æ³•ï¼ˆä¸¾ä¾‹â€¦ï¼‰ï¼Œlinux readcopy update implementation éœ€è¦å¤§é‡çš„è¿­ä»£/ æœ¬æ–‡é’ˆå¯¹å¯æ‰©å±•æ€§ï¼ŒOS çš„å¯æ‰©å±•æ€§ï¼Ÿä½†æ˜¯è¿™äº›ç¡¬ä»¶ä¹Ÿä¸æ˜¯ä¸€èˆ¬å•†ç”¨ï¼Œä¹Ÿä¸é€šç”¨å•Š Sun Niagara æ˜¯æ›´åŠ å¤šæ ¸å¤šçº¿ç¨‹ï¼ŒæŒ‡ä»¤é›†ä¹Ÿæ˜¯ç‰¹æ®Šçš„ SPARC V9ï¼Œä¹Ÿæ˜¯å•†ç”¨çš„æœåŠ¡å™¨æ‰èƒ½ç”¨ä¸Šå§ï¼Œå•†ç”¨è‚¯å®šä¼šæœ‰å‚å®¶åšä¸“é—¨çš„ OSï¼Ÿ å†è¯´äº†ï¼Œæ˜¯å¼€å‘æ–°çš„ç¡¬ä»¶éš¾ ï¼Œè¿˜æ˜¯ OS å†…æ ¸å¼€å‘è€…åšé€‚é…éš¾å‘¢ï¼Ÿæ–‡ç« ä¹Ÿä¸¾ä¾‹ä¸€äº› OS çš„é—®é¢˜ï¼Œä¼˜åŒ–å¾ˆå¤æ‚ç­‰ç­‰ï¼Œä½†æ˜¯è¿™ä¾‹å­ çœŸçš„ä»¤äººä¿¡æœå—ï¼Œwin7, linux, windows server 2003 éƒ½æ˜¯æ™®éæ€§çš„ï¼Œå¤§é‡å•†ç”¨çš„ï¼Œæ˜¯æœ‰å¤§é‡ç»´æŠ¤å’Œä½¿ç”¨çš„ï¼Œå†è¯´ linux å¼€æºä¹Ÿæœ‰ä¸åŒå‘è¡Œç‰ˆã€‚ ","date":"2024-09-08","objectID":"/posts/multikernel-os/:4:1","tags":["Paper Reading"],"title":"Paper Reading: The Multikernel: A New OS Architecture for Scalable Multicore Systems","uri":"/posts/multikernel-os/"},{"categories":null,"content":"Cores are increasingly diverse å¤šæ ·æ€§ã€‚ Moreover, core heterogeneity means cores can no longer share a single OS kernel instance, either because the performance tradeoffs vary, or because the ISA is simply different æ ¸å¿ƒå¼‚æ„ï¼Œä¸åŒæ ¸å¿ƒä¸åŒæ¶æ„ï¼Œä¸åŒæŒ‡ä»¤é›†ï¼Œæ¯”å¦‚å¸¸è§é«˜é€šéªé¾™å¤„ç†å™¨ï¼Œå¤§æ ¸å¿ƒå°æ ¸å¿ƒå¼‚æ„ï¼Œè¿˜æœ‰å›¾å½¢ GPU æ¶æ„ï¼Œä¹Ÿæœ‰ AMD çš„ APU æ¶æ„ä¹Ÿæ˜¯ CPU GPU å¼‚æ„ã€‚ ","date":"2024-09-08","objectID":"/posts/multikernel-os/:4:2","tags":["Paper Reading"],"title":"Paper Reading: The Multikernel: A New OS Architecture for Scalable Multicore Systems","uri":"/posts/multikernel-os/"},{"categories":null,"content":"The interconnect matters å°½ç®¡å¯¹äºç°ä»£ cache-coherent multiprocessorï¼Œæ¶ˆæ¯ä¼ é€’ä¹Ÿæ›¿ä»£äº†å•ä¸ªå…±äº«ï¼Œå› ä¸ºå¯æ‰©å±•æ€§ã€‚CPU ä¹‹é—´çš„ç¼“å­˜ä¸€è‡´æ€§åè®®ç¡®ä¿äº† OS å¯ä»¥å®‰å…¨åœ°ä½¿ç”¨å•ä¸ªå…±äº«å†…å­˜ï¼Œä½†æ˜¯åƒ è·¯ç”± routing å’Œ congestion æ‹¥å¡è¿™ç§ç½‘ç»œé—®é¢˜æ˜¯æ€»æ‰€å‘¨çŸ¥çš„ã€‚ ","date":"2024-09-08","objectID":"/posts/multikernel-os/:4:3","tags":["Paper Reading"],"title":"Paper Reading: The Multikernel: A New OS Architecture for Scalable Multicore Systems","uri":"/posts/multikernel-os/"},{"categories":null,"content":"Messages cost less than shared memory å…±äº«å†…å­˜ä¹‹å‰è¢«è®¤ä¸ºæ˜¯æ€§èƒ½æ›´å¥½ï¼Œä½†æ¶ˆæ¯ä¼ é€’ç°åœ¨åè½¬äº†ï¼Ÿ å®éªŒä¸­ 4x4 æ ¸å¿ƒçš„ AMD éšç€æ ¸å¿ƒæ•°å¢å¤§ï¼Œshared memory å»¶è¿Ÿä¹Ÿå¢å¤§ï¼Œçº¿æ€§å¢é•¿ï¼Œå› ä¸ºç¼“å­˜ä¸¢å¤±éœ€è¦ç­‰å¾…ã€‚ æ ¸å¿ƒé—´å»¶è¿Ÿï¼Ÿ ä½†æ˜¯å¯¹äºæ¶ˆæ¯ä¼ é€’ï¼Œcache line åœ¨æœåŠ¡ç«¯æœ¬åœ°ç¼“å­˜ï¼Œæ‰€ä»¥å»¶è¿Ÿä¸ä¼šçº¿æ€§å¢é•¿ã€‚ä½†æ˜¯å¯¹äºæœ‰æ—¶å€™å»¶è¿Ÿä¹Ÿé«˜äºå…±äº«å†…å­˜ è¿™ä¸ªä¾‹å­å±•ç¤ºäº†åœ¨ cache-coherent shared memory åœ¨å°‘é‡æ ¸å¿ƒä¸Šçš„å¯æ‰©å±•é—®é¢˜ï¼Œæœ¬æ–‡çš„æ¡ä»¶å°±æ˜¯å…±äº«å†…å­˜æ¨¡å‹å­˜åœ¨ä¸å¯/éš¾ä»¥æ‰©å±•çš„é—®é¢˜ï¼Œå¹¶ä¸”ç¡¬ä»¶åˆ›æ–°é€Ÿåº¦å¾ˆå¿«ï¼Œä¸º OS å†…æ ¸å¸¦æ¥é—®é¢˜ã€‚ å¸¦æ¥ä»€ä¹ˆé—®é¢˜ï¼Ÿå¯æ‰©å±•é—®é¢˜ï¼Ÿ OS kernel ä¸åº”è¯¥æ˜¯æ€§èƒ½å’Œç¨³å®šä¼˜å…ˆï¼Œå¯ç§»æ¤æ€§æ˜¯å¾ˆé‡è¦çš„æŒ‡æ ‡å—ï¼Ÿç¡¬ä»¶æ›´æ–°é€Ÿåº¦çœŸçš„éµä»æ‘©å°”å®šå¾‹å—ï¼Œè€Œä¸”ç¡¬ä»¶æ›´æ–°é€Ÿåº¦å’Œå¯ç§»æ¤æ€§åº”è¯¥å…³ç³»å¹¶ä¸æ˜¯å¾ˆå¤§æ‰å¯¹ã€‚ ","date":"2024-09-08","objectID":"/posts/multikernel-os/:4:4","tags":["Paper Reading"],"title":"Paper Reading: The Multikernel: A New OS Architecture for Scalable Multicore Systems","uri":"/posts/multikernel-os/"},{"categories":null,"content":"Cache coherence is not a panacea æ ¸å¿ƒæ•°é‡å¢åŠ ï¼Œäº’è¿å¢åŠ ï¼Œç¡¬ä»¶çš„ cache-coherence protocols ä¹Ÿä¼šéå¸¸æ˜‚è´µã€‚æ‰€ä»¥æœªæ¥çš„ OS éœ€è¦å¤„ç†éä¸€è‡´æ€§å†…å­˜ï¼Œæˆ–è€…èƒ½å¤Ÿç»•è¿‡ cache-coherence protocol NIC å’Œ GPU ç­‰å¯ç¼–ç¨‹å¤–å›´å·²ç»å¯ä»¥ä¸éœ€è¦å’Œ CPU ä¿æŒç¼“å­˜ä¸€è‡´æ€§ï¼Œè®¸å¤šå¤šæ ¸å¤„ç†å™¨ä¹Ÿå¯ä»¥ä½¿ç”¨éä¸€è‡´æ€§å…±äº«å†…å­˜ã€‚ ","date":"2024-09-08","objectID":"/posts/multikernel-os/:4:5","tags":["Paper Reading"],"title":"Paper Reading: The Multikernel: A New OS Architecture for Scalable Multicore Systems","uri":"/posts/multikernel-os/"},{"categories":null,"content":"Messages are getting easier æ¶ˆæ¯ä¼ é€’ï¼Œæ˜¯ shared nothing çš„å—ã€‚å…±äº«æ•°æ®å­˜åœ¨æ­£ç¡®æ€§å’Œæ€§èƒ½ç¼ºé™·ï¼Œéœ€è¦å„ç§ç²’åº¦çš„é”ã€æ•°æ®ç»“æ„æ¥ä¿è¯ cache line ç«äº‰é—®é¢˜ã€‚ shared nothing æ˜¯ä¸€ç§åˆ†å¸ƒå¼è®¡ç®—æ¶æ„ï¼Œå°¤å…¶æ˜¯åˆ†å¸ƒå¼æ•°æ®åº“ä¸­ï¼Œä¹Ÿæœ‰æ•°æ®ä»“åº“æ•°æ®æ¹–çš„è¶‹åŠ¿ï¼Œæ¯ä¸ªèŠ‚ç‚¹æœ‰è‡ªå·±çš„èµ„æºï¼Œå…·æœ‰è‰¯å¥½çš„å¯æ‰©å±•æ€§ ï¼Œæ€§èƒ½ä¼˜ç§€ä¹Ÿçµæ´»ã€‚ä½†æ˜¯å®ç°éš¾åº¦å¤§ï¼Œèµ„æºåˆ©ç”¨ç‡å¯èƒ½ä¸è¶³ï¼Œæ•°æ®æ ¼å¼ä¹Ÿæ˜¯ä¸ªé—®é¢˜ã€‚ æ¶ˆæ¯ä¼ é€’å¸¦æ¥çš„å¦ä¸€ä¸ªé¡¾è™‘æ˜¯ï¼Œstack ripping (è°ƒç”¨æ ˆå‰¥ç¦»é—®é¢˜)ï¼Œå’Œäº‹ä»¶é©±åŠ¨å¸¦æ¥çš„ control flow æ··æ·†ï¼Ÿä½†æ˜¯ï¼Œä¼ ç»Ÿçš„ monolithic kernels å°±æ˜¯äº‹ä»¶é©±åŠ¨çš„ï¼Œå°½ç®¡åœ¨å¤šæ ¸å¤„ç†å™¨ä¸Šã€‚ æœ€åï¼Œæ¶ˆæ¯ä¼ é€’å’Œäº‹ä»¶é©±åŠ¨æ¨¡å‹æ˜¯ç¼–ç¨‹èŒƒå¼ã€‚ ","date":"2024-09-08","objectID":"/posts/multikernel-os/:4:6","tags":["Paper Reading"],"title":"Paper Reading: The Multikernel: A New OS Architecture for Scalable Multicore Systems","uri":"/posts/multikernel-os/"},{"categories":null,"content":"Discussion æœªæ¥è®¡ç®—æœºæ¶æ„å‘å±•è¶‹åŠ¿ï¼šè¶Šæ¥è¶Šå¤šçš„æ ¸å¿ƒæ•°é‡ã€ç¡¬ä»¶å¤šæ ·åŒ–ï¼ˆå†…æ ¸ä¹‹é—´ã€ç³»ç»Ÿä¹‹é—´ï¼‰ we take the opposite approach: design and reason about the OS as a distributed, non-shared system, and then employ sharing to optimize the model where appropriate åº”è¯¥æ˜¯ä¸€ä¸ªå¤åˆçš„ï¼Œå…±äº« + æ¶ˆæ¯æ¶æ„ï¼Œä½†è¿™æ ·å’Œ NUMA åˆæœ‰ä»€ä¹ˆå¾ˆå¤§çš„å·®åˆ«å‘¢ ï¼Ÿæ–‡ç« å¥½åƒä¹Ÿæ²¡æœ‰æ·±å…¥è®¨è®ºæ¶ˆæ¯ä¼ é€’ç¼“å­˜ä¸€è‡´æ€§çš„é—®é¢˜ï¼Œ ","date":"2024-09-08","objectID":"/posts/multikernel-os/:4:7","tags":["Paper Reading"],"title":"Paper Reading: The Multikernel: A New OS Architecture for Scalable Multicore Systems","uri":"/posts/multikernel-os/"},{"categories":null,"content":"THE MULTIKERNEL MODEL Make all inter-core communication explicit Make OS structure hardware-neutral View state as replicated instead of shared ","date":"2024-09-08","objectID":"/posts/multikernel-os/:5:0","tags":["Paper Reading"],"title":"Paper Reading: The Multikernel: A New OS Architecture for Scalable Multicore Systems","uri":"/posts/multikernel-os/"},{"categories":null,"content":"Make inter-core communication explicit ä¸å…±äº«å†…å­˜ï¼Œä½†æ˜¯ä¸æ’é™¤ç¨‹åºåœ¨æ ¸å¿ƒä¹‹é—´å…±äº«å†…å­˜ï¼ŸOS è®¾è®¡ä¸ä¾èµ–è¿™ä¸ªã€‚ explicit communication æœ‰åŠ©äºç³»ç»Ÿäº’è¿ã€‚æ›´åŠ ç¬¦åˆåˆ†å¸ƒå¼ç³»ç»Ÿï¼Œæœ‰åˆ©äº pipelining å’Œ batchingã€‚ä¹Ÿèƒ½æä¾› isolation å’Œèµ„æºç®¡ç†ã€‚ æ¶ˆæ¯ä¼ é€’æ˜¯å¼‚æ­¥çš„ï¼Ÿå‘é€åå¯ä»¥ä¼‘çœ ã€åšåˆ«çš„äº‹ã€‚ ","date":"2024-09-08","objectID":"/posts/multikernel-os/:5:1","tags":["Paper Reading"],"title":"Paper Reading: The Multikernel: A New OS Architecture for Scalable Multicore Systems","uri":"/posts/multikernel-os/"},{"categories":null,"content":"Make OS structure hardware-neutral ä¿¡æ¯ä¼ é€’æœºåˆ¶å’Œç¡¬ä»¶æ¥å£ï¼ˆCPU å’Œè®¾å¤‡ï¼‰ ä¸€äº›å¹³å°æ²¡æœ‰ç¼“å­˜ä¸€è‡´æ€§æœºåˆ¶ï¼Œæ¯”å¦‚åµŒå…¥å¼ï¼ŒRTOSï¼Œä¸“ç”¨è®¡ç®—è®¾å¤‡ GPU FPGAï¼Ÿ late binding + æ¶ˆæ¯ä¼ é€’ï¼ŒåŠ¨æ€ç»‘å®šï¼Œçµæ´»ï¼Œä¼˜åŒ–äº† TLB shootdown ç»´æŠ¤ TLB ä¸€è‡´æ€§ ","date":"2024-09-08","objectID":"/posts/multikernel-os/:5:2","tags":["Paper Reading"],"title":"Paper Reading: The Multikernel: A New OS Architecture for Scalable Multicore Systems","uri":"/posts/multikernel-os/"},{"categories":null,"content":"View state as replicated å¤åˆ¶æ˜¯å¯ä¼¸ç¼©çš„é‡è¦æŠ€æœ¯ æ–‡ç« è¿˜æ˜¯ share replicas of system states ä¸è¿‡æ˜¯å¯¹äºç´§å¯†è€¦åˆçš„æ ¸å¿ƒæˆ–è€…çº¿ç¨‹ï¼Œä½¿ç”¨è‡ªæ—‹é”ä¿æŠ¤åŒæ­¥ã€‚ ","date":"2024-09-08","objectID":"/posts/multikernel-os/:5:3","tags":["Paper Reading"],"title":"Paper Reading: The Multikernel: A New OS Architecture for Scalable Multicore Systems","uri":"/posts/multikernel-os/"},{"categories":null,"content":"Applying the model ç¼ºç‚¹ï¼š æŸäº›åŸºäºç‰¹å®šå¹³å°çš„æ€§èƒ½ä¼˜åŒ–å¯èƒ½è¢«ç‰ºç‰²ï¼Œæ¯”å¦‚ æ ¸å¿ƒä¹‹é—´å…±äº«çš„ L2 ç¼“å­˜ å¤åˆ¶éœ€è¦ä¿æŒä¸€è‡´æ€§åè®® Barrelfish çš„ç›®æ ‡ï¼š æ€§èƒ½å’Œç›®å‰å•†ç”¨æ“ä½œç³»ç»Ÿå¯ä»¥æ¯”è¾ƒ åœ¨å¤§é‡æ ¸å¿ƒä¸Šå¯ä»¥æ‰©å±•ï¼Œå°¤å…¶æ˜¯åœ¨å…¨å±€ OS data structure ä¸‹çš„ workload å¯ä»¥ä½¿ç”¨ä¸åŒçš„å…±äº«æœºåˆ¶ã€å®šä½åˆ°ä¸åŒç¡¬ä»¶ï¼Œä¸éœ€è¦é‡æ„ å¯ä»¥é€šè¿‡æ¶ˆæ¯ä¼ é€’ï¼Œé€šè¿‡ pipeline, batching å®ç°è‰¯å¥½æ€§èƒ½ OS æ¨¡å—åŒ–ï¼Œåˆ©ç”¨ç¡¬ä»¶æ‹“æ‰‘æˆ–è´Ÿè½½ ","date":"2024-09-08","objectID":"/posts/multikernel-os/:5:4","tags":["Paper Reading"],"title":"Paper Reading: The Multikernel: A New OS Architecture for Scalable Multicore Systems","uri":"/posts/multikernel-os/"},{"categories":null,"content":"IMPLEMENTATION ","date":"2024-09-08","objectID":"/posts/multikernel-os/:6:0","tags":["Paper Reading"],"title":"Paper Reading: The Multikernel: A New OS Architecture for Scalable Multicore Systems","uri":"/posts/multikernel-os/"},{"categories":null,"content":"Test platforms x86, ä½†æ˜¯ ARM å´è¿˜åœ¨ wipï¼Ÿ è¯´å¥½çš„å¯ä»¥æ‰©å±•å‘¢ï¼Œè€Œä¸”å®éªŒçœ‹ä¸Šå»ä¹Ÿä¸æ˜¯å¼‚æ„å¤„ç†å™¨ã€‚ ","date":"2024-09-08","objectID":"/posts/multikernel-os/:6:1","tags":["Paper Reading"],"title":"Paper Reading: The Multikernel: A New OS Architecture for Scalable Multicore Systems","uri":"/posts/multikernel-os/"},{"categories":null,"content":"System structure OS instance on each core into a privileged-mode CPU driver and a distinguished user-mode monitor process, kernel space: cpu driver user space: monitor ","date":"2024-09-08","objectID":"/posts/multikernel-os/:6:2","tags":["Paper Reading"],"title":"Paper Reading: The Multikernel: A New OS Architecture for Scalable Multicore Systems","uri":"/posts/multikernel-os/"},{"categories":null,"content":"CPU drivers CPU driver æ˜¯æ—¶é—´é©±åŠ¨ã€å•çº¿ç¨‹ã€ä¸å¯æŠ¢å çš„ï¼Œå®ƒä»¥ trap çš„å½¢å¼è¿ç»­å¤„ç†æ¥è‡ªç”¨æˆ·è¿›ç¨‹çš„äº‹ä»¶æˆ–æ¥è‡ªè®¾å¤‡æˆ–å…¶ä»–æ ¸å¿ƒçš„ä¸­æ–­ã€‚ å…¨æ˜¯ X86-64 æ¶æ„ï¼Œæƒ³çŸ¥é“åŸºäº ARM å¼€å‘ OS çš„éš¾åº¦ç©¶ç«Ÿå¦‚ä½•ã€‚è€Œä¸” LRPC çš„å»¶è¿Ÿçœ‹ä¸Šå»è›®é«˜çš„ï¼Œä¸€èˆ¬ E5 åº”è¯¥åœ¨ us microseconds çº§åˆ«ï¼Œæ–‡ç« æ•°æ®åŸºæœ¬éƒ½æ˜¯ nanosecondsã€‚ ","date":"2024-09-08","objectID":"/posts/multikernel-os/:6:3","tags":["Paper Reading"],"title":"Paper Reading: The Multikernel: A New OS Architecture for Scalable Multicore Systems","uri":"/posts/multikernel-os/"},{"categories":null,"content":"Monitors æ¯ä¸ªæ ¸å¿ƒï¼Œå¤åˆ¶çš„æ•°æ®ç»“æ„ï¼Œæ¯”å¦‚å†…å­˜åˆ†é…è¡¨å’Œåœ°å€æ˜ å°„è¡¨ï¼Œéƒ½å…¨å±€ä¸€è‡´ã€‚æ˜¯ monitor è¿è¡Œä¸€è‡´æ€§åè®®ã€‚ çœ‹ä¸Šå» monitor æ‰æ˜¯å®ç°çš„æ ¸å¿ƒï¼Œéœ€è¦è€ƒè™‘å¤åˆ¶ã€ä¿æŒä¸€è‡´ã€‚å…¶å®è¿™é‡Œèƒ½ä¸èƒ½ä¹Ÿå®ç°ä¸€äº›é›¶æ‹·è´å‘¢ï¼Ÿ ","date":"2024-09-08","objectID":"/posts/multikernel-os/:6:4","tags":["Paper Reading"],"title":"Paper Reading: The Multikernel: A New OS Architecture for Scalable Multicore Systems","uri":"/posts/multikernel-os/"},{"categories":null,"content":"Process structure Communication in Barrelfish is not actually between processes but between dispatchers (and hence cores) ","date":"2024-09-08","objectID":"/posts/multikernel-os/:6:5","tags":["Paper Reading"],"title":"Paper Reading: The Multikernel: A New OS Architecture for Scalable Multicore Systems","uri":"/posts/multikernel-os/"},{"categories":null,"content":"Inter-core communication ä¸åŒåœºæ™¯ä¸åŒä¼ è¾“å®ç°ï¼Œä½†æ˜¯æœ¬æ–‡æ ¸é—´é€šä¿¡åªå®ç°äº†ç¼“å­˜ä¸€è‡´æ€§ï¼Ÿ inter-core å’Œ per-cores/dispatchers æ¶ˆæ¯ä¼ é€’è¿˜ä¸ä¸€æ ·ï¼Œè€Œä¸”å®é™…ä¸Šå¹¶ä¸æ˜¯ processes ä¹‹é—´é€šä¿¡ï¼Œæ˜¯è°ƒåº¦å™¨ æ ¸é—´é€šä¿¡å¾ˆé‡è¦ï¼Œä½¿ç”¨ URPCï¼Œ urpc å¥½åƒåŸºæœ¬åªæœ‰å›½å¤–æ•™ææ‰æœ‰äº†ï¼Œä¸å¤ªæ¸…æ¥šç”¨æˆ·çº§åˆ«çš„ rpc æœ‰ä»€ä¹ˆåŒºåˆ« ï¼Œçœ‹ä¸Šå»åˆ©ç”¨äº†ç¼“å­˜ï¼Œè½®è¯¢ï¼Œé˜»å¡ç­‰ç­‰ï¼Œé‚£èƒ½ä¸èƒ½æ”¹è¿›æˆç±»ä¼¼ epoll ç­‰çº¢é»‘æ ‘ç»“æ„å‘¢ï¼Ÿ urpc æ€§èƒ½çœ‹ä¸Šå»æŒºä¸é”™çš„ ","date":"2024-09-08","objectID":"/posts/multikernel-os/:6:6","tags":["Paper Reading"],"title":"Paper Reading: The Multikernel: A New OS Architecture for Scalable Multicore Systems","uri":"/posts/multikernel-os/"},{"categories":null,"content":"Memory management è™šæ‹Ÿå†…å­˜ç®¡ç† æœ¬æ¥æƒ³ä»”ç»†çœ‹çœ‹è¿™éƒ¨åˆ†ï¼Œä½†çœ‹èµ·æ¥ä½œè€…èµ°äº†å¼¯è·¯ï¼Œä¸çŸ¥é“æœ€åæ˜¯æ€ä¹ˆå®ç°çš„ã€‚æ–‡ç« æåˆ°çš„å†…å­˜ç®¡ç†èƒ½åŠ› capability å°±æ˜¯å†…å­˜ç®¡ç†æœºåˆ¶ï¼Œé€šè¿‡èƒ½åŠ›å¼•ç”¨å’Œæ“ä½œï¼Œæ ‡è¯†å†…å­˜å¯¹è±¡ï¼Œæƒé™ç­‰ç­‰ã€‚åŒæ­¥æ€ä¹ˆåšï¼Ÿè¿˜éœ€è¦ 2PC æ¥åŒæ­¥å—ï¼Ÿ ","date":"2024-09-08","objectID":"/posts/multikernel-os/:6:7","tags":["Paper Reading"],"title":"Paper Reading: The Multikernel: A New OS Architecture for Scalable Multicore Systems","uri":"/posts/multikernel-os/"},{"categories":null,"content":"Shared address spaces çº¿ç¨‹å¯ä»¥å…±äº«åœ°å€ç©ºé—´ï¼Œè¿™æ ·ä¸éœ€è¦ IPCï¼Œä½†ä¼šé¢ä¸´æ•°æ®ä¸ä¸€è‡´é—®é¢˜ã€‚ TLB ç”¨äºåŠ é€Ÿè™šæ‹Ÿåœ°å€åˆ°ç‰©ç†åœ°å€ã€‚ Barrelfish æ”¯æŒä¼ ç»Ÿçš„è¿›ç¨‹æ¨¡å‹ï¼Œå³å¤šä¸ªè°ƒåº¦å™¨ï¼ˆdispatcherï¼‰åœ¨å¤šä¸ªæ ¸å¿ƒä¸Šå…±äº«å•ä¸€çš„è™šæ‹Ÿåœ°å€ç©ºé—´ã€‚ å¯ä»¥é€šè¿‡ å…±äº«æ‰€æœ‰è°ƒåº¦å™¨çš„ç¡¬ä»¶é¡µè¡¨ TLB ï¼Œæˆ–è€…é€šè¿‡æ¶ˆæ¯åè®®å¤åˆ¶ç¡¬ä»¶é¡µè¡¨æ¥å®ç°ã€‚ æœ¬æ–‡æ˜¯æ€ä¹ˆåšçš„ï¼Ÿ ","date":"2024-09-08","objectID":"/posts/multikernel-os/:6:8","tags":["Paper Reading"],"title":"Paper Reading: The Multikernel: A New OS Architecture for Scalable Multicore Systems","uri":"/posts/multikernel-os/"},{"categories":null,"content":"Knowledge and policy engine è¿™ä¸€æ®µä¸ç†è§£ ","date":"2024-09-08","objectID":"/posts/multikernel-os/:6:9","tags":["Paper Reading"],"title":"Paper Reading: The Multikernel: A New OS Architecture for Scalable Multicore Systems","uri":"/posts/multikernel-os/"},{"categories":null,"content":"Experiences å¤§éƒ¨åˆ†æ˜¯ RPC è°ƒç”¨è€Œä¸æ˜¯ç³»ç»Ÿè°ƒç”¨ï¼Œéœ€è¦æ›´å¤šçš„ä¸Šä¸‹æ–‡åˆ‡æ¢ ","date":"2024-09-08","objectID":"/posts/multikernel-os/:6:10","tags":["Paper Reading"],"title":"Paper Reading: The Multikernel: A New OS Architecture for Scalable Multicore Systems","uri":"/posts/multikernel-os/"},{"categories":null,"content":"EVALUATION ","date":"2024-09-08","objectID":"/posts/multikernel-os/:7:0","tags":["Paper Reading"],"title":"Paper Reading: The Multikernel: A New OS Architecture for Scalable Multicore Systems","uri":"/posts/multikernel-os/"},{"categories":null,"content":"Case study: TLB shootdown ä¿æŒ TLB ä¸€è‡´æ€§ï¼ŒTLB shootdown æ˜¯æŒ‡åœ¨é¡µé¢è¢«å–æ¶ˆæ˜ å°„æ—¶ï¼Œé€šè¿‡ä½¿ TLB æ¡ç›®å¤±æ•ˆæ¥ä¿æŒ TLB ä¸€è‡´æ€§çš„è¿‡ç¨‹ã€‚ æœ¬æ–‡ä½¿ç”¨æ¶ˆæ¯ä¼ é€’ï¼Œå¹¿æ’­æ¥å®ç° TLB shootdownï¼Œå»¶è¿Ÿä¼šé«˜ä¸€äº›ã€‚ ","date":"2024-09-08","objectID":"/posts/multikernel-os/:7:1","tags":["Paper Reading"],"title":"Paper Reading: The Multikernel: A New OS Architecture for Scalable Multicore Systems","uri":"/posts/multikernel-os/"},{"categories":null,"content":"Messaging performance 2 é˜¶æ®µæäº¤ã€è½®è¯¢ã€IP lookback ä¸¤é˜¶æ®µæäº¤çš„é—®é¢˜åœ¨è¿™é‡Œä¼šä¸ä¼šæ›´æ˜æ˜¾å‘¢ï¼Ÿå°¤å…¶æ˜¯å½“ monitor é˜»å¡çš„æ—¶å€™ï¼Œå¾ˆå¯èƒ½äº§ç”Ÿé•¿æ—¶é—´çš„é˜»å¡å’Œå•ç‚¹æ•…éšœï¼Œå½“ç„¶æ€§èƒ½ä¹Ÿéš¾ä»¥æ¥å— ","date":"2024-09-08","objectID":"/posts/multikernel-os/:7:2","tags":["Paper Reading"],"title":"Paper Reading: The Multikernel: A New OS Architecture for Scalable Multicore Systems","uri":"/posts/multikernel-os/"},{"categories":null,"content":"Compute-bound workloads è¿™äº›åŸºå‡†æµ‹è¯•åœ¨ä»»ä¸€æ“ä½œç³»ç»Ÿä¸Šéƒ½æ²¡æœ‰ç‰¹åˆ«å¥½çš„æ‰©å±•æ€§ï¼Œä½†è‡³å°‘è¯æ˜äº†å°½ç®¡ Barrelfish å…·æœ‰åˆ†å¸ƒå¼ç»“æ„ï¼Œå®ƒä»ç„¶å¯ä»¥æ”¯æŒå¤§è§„æ¨¡çš„å…±äº«åœ°å€ç©ºé—´å¹¶è¡Œä»£ç ï¼Œä¸”æ€§èƒ½æŸå¤±å¾ˆå°ã€‚ æ€§èƒ½å·®è·å¹¶ä¸æ˜¯å¾ˆå¤§ï¼Œè‡³å°‘è¶…å‡ºäº†æˆ‘çš„é¢„æœŸï¼Œæˆ‘ä»¥ä¸ºæ€§èƒ½å·®è·ä¼šå¾ˆå¤§ã€‚ä½†å¾ˆæ˜æ˜¾è¿˜æ˜¯è¦çœ‹ latency è€Œä¸æ˜¯åªçœ‹ cyclesã€è¿˜éœ€è¦çœ‹èµ„æºåˆ©ç”¨ç‡ã€ä¸Šä¸‹æ–‡åˆ‡æ¢ã€åå ååé‡çœ‹ç€ä¹Ÿä¸é”™ï¼Œ Web server and relational database ä½œä¸ºæœåŠ¡å™¨ç³»ç»Ÿï¼Œè¯´æ˜¯é¿å…äº†å†…æ ¸-ç”¨æˆ·æ€åˆ‡æ¢ï¼Œèƒ½å¤Ÿæ˜æ˜¾å‡å°‘ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæ‰€ä»¥èƒ½æ¯ç§’å¤„ç†æ›´å¤šçš„è¯·æ±‚ï¼Ÿ ä¸ºä»€ä¹ˆï¼Ÿ ","date":"2024-09-08","objectID":"/posts/multikernel-os/:7:3","tags":["Paper Reading"],"title":"Paper Reading: The Multikernel: A New OS Architecture for Scalable Multicore Systems","uri":"/posts/multikernel-os/"},{"categories":null,"content":"SUMMARY microbenchmarks ç»“æœçœ‹ç€ä¸é”™ ä½†æ˜¯è¯„ä¼°ä¸€ä¸ª os æ˜¯éå¸¸å¤æ‚çš„å·¥ä½œ æ–‡ç« æ²¡æœ‰çœŸçš„åœ¨å¼‚æ„ç¡¬ä»¶ä¸Šæµ‹è¯• ","date":"2024-09-08","objectID":"/posts/multikernel-os/:8:0","tags":["Paper Reading"],"title":"Paper Reading: The Multikernel: A New OS Architecture for Scalable Multicore Systems","uri":"/posts/multikernel-os/"},{"categories":null,"content":"Mini-LSM Week 1 Day3 Week1 Day3 çš„å†…å®¹ï¼Œå®ç° SST block ç¼–è§£ç å’Œ iterator ","date":"2024-07-27","objectID":"/posts/minilsm-3/:1:0","tags":["Database","LSM"],"title":"Mini-LSM Week 1 Day3","uri":"/posts/minilsm-3/"},{"categories":null,"content":"Task 1: Block Builder å‰ä¸¤ç« å®ç°äº† LSM åœ¨å†…å­˜ä¸­çš„ç»“æ„ï¼Œç°åœ¨å®ç° on-disk çš„ç»“æ„ï¼Œå³ Block å—ã€‚ Blocks ä¸€èˆ¬ 4-KB å¤§å°ï¼ˆå¯èƒ½å› å­˜å‚¨ä»‹è´¨ä¸åŒï¼‰ï¼Œå’Œæ“ä½œç³»ç»Ÿä»¥åŠ SSD ä¸­çš„é¡µ page å¤§å°ä¸€è‡´ã€‚å—å­˜å‚¨æ’åºåçš„ key-value pairsã€‚ SST ç”±å¤šä¸ª blocks ç»„æˆï¼Œå½“ memtables çš„æ•°é‡è¶…è¿‡äº† system limitï¼Œå°±ä¼š flush memtables æˆä¸º SSTã€‚è¿™ä¸€ç« å®ç° encoding and decoding of a block. éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶ï¼š src/block/builder.rs src/block.rs æ•™ç¨‹çš„ block çš„ç¼–ç æ ¼å¼ä¸ºï¼š ---------------------------------------------------------------------------------------------------- | Data Section | Offset Section | Extra | ---------------------------------------------------------------------------------------------------- | Entry #1 | Entry #2 | ... | Entry #N | Offset #1 | Offset #2 | ... | Offset #N | num_of_elements | ---------------------------------------------------------------------------------------------------- æ¯ä¸ª Entry æ˜¯ key-value å¯¹ï¼š ----------------------------------------------------------------------- | Entry #1 | ... | ----------------------------------------------------------------------- | key_len (2B) | key (keylen) | value_len (2B) | value (varlen) | ... | ----------------------------------------------------------------------- key_len å’Œ value_len éƒ½æ˜¯ 2 ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥æœ€é•¿é•¿åº¦ä¸º $2^16 = 65535$ï¼Œä¸€èˆ¬ä½¿ç”¨ u16 è¡¨ç¤º block å…·æœ‰å¤§å°é™åˆ¶ target_sizeï¼Œé™¤éç¬¬ä¸€ä¸ª key-value pair è¶…è¿‡äº† block sizeï¼Œä¸ç„¶ä½ éœ€è¦ä¿è¯ç¼–ç åçš„ block size å°äºæˆ–ç­‰äº target_size (æä¾›çš„ä»£ç é‡Œï¼Œtarget_size ä¸ block_size æœ¬è´¨ä¸€æ ·) å½“ build è¢«è°ƒç”¨æ—¶ï¼ŒBlockBuilder ä¼šäº§ç”Ÿ data part å’Œ unencoded entry offsetsã€‚ä¿¡æ¯ä¼šè¢«å­˜åœ¨ Block ç»“æ„ä¸­ï¼Œkey-value entries ä½¿ç”¨ raw æ ¼å¼ï¼Œoffsets ç”¨å•ç‹¬çš„ vectorï¼Œè¿™å‡å°‘äº†è§£ç æ•°æ®æ—¶ä¸å¿…è¦çš„å†…å­˜åˆ†é…å’Œå¤„ç†å¼€é”€ï¼Œä½ åªéœ€è¦ç®€å•åœ°æ‹·è´ raw block data åˆ° data vector å¹¶ä¸”æ¯ 2 ä¸ª bytes è¿›è¡Œ decode entry offsetsï¼Œè€Œä¸æ˜¯åˆ›å»º Vec\u003c(Vec\u003cu8\u003e, Vec\u003cu8\u003e)\u003e è¿™æ ·çš„ç»“æ„ï¼Œåœ¨ä¸€ä¸ª block å’Œå†…å­˜ä¸­å»å­˜æ‰€æœ‰çš„ key-value pairsã€‚è¿™æ · compact memory layout æ›´é«˜æ•ˆã€‚ åœ¨ Block::encode å’Œ Block::decodeï¼Œä½ éœ€è¦æŒ‰ç…§ä¸Šè¿°çš„ç»“æ„ encode/decode block. ","date":"2024-07-27","objectID":"/posts/minilsm-3/:2:0","tags":["Database","LSM"],"title":"Mini-LSM Week 1 Day3","uri":"/posts/minilsm-3/"},{"categories":null,"content":"Task 1: Solution æŸ¥çœ‹ src/block/builder.rs è§‚å¯Ÿ Block ç»“æ„ä½“ï¼Œoffsets Vec\u003cu16\u003e åç§»é‡ï¼Œ data vec\u003cu8\u003e kv æ•°æ®ç­‰ç­‰ï¼Œå…·æœ‰ new(block_size: usize) -\u003e Self, add(\u0026mut self, key: KeySlice, value: \u0026[u8]) -\u003e bool, is_empty(\u0026self) -\u003e bool å’Œ build(self) -\u003e Block æ–¹æ³•ã€‚ /// Builds a block. pub struct BlockBuilder { /// Offsets of each key-value entries. offsets: Vec\u003cu16\u003e, /// All serialized key-value pairs in the block. data: Vec\u003cu8\u003e, /// The expected block size. block_size: usize, /// The first key in the block first_key: KeyVec, } /// Creates a new block builder. pub fn new(block_size: usize) -\u003e Self { Self { offsets: Vec::new(), data: Vec::new(), block_size, first_key: KeyVec::new(), } } å…ˆå®ç° new(block_size) æ–¹æ³•åˆ›å»ºä¸€ä¸ª BlockBuilder ç»“æ„ä½“ï¼Œéœ€è¦æ³¨æ„è¿™é‡Œä½¿ç”¨äº† bytes::BufMut åº“ï¼ŒBufMut æ˜¯ bytes åº“ä¸­çš„ä¸€ä¸ª traitï¼Œå®ƒå®šä¹‰äº†ä¸€äº›æ–¹æ³•æ¥æ“ä½œå¯å˜çš„å­—èŠ‚ç¼“å†²åŒºã€‚é€šè¿‡å®ç° BufMutï¼Œä½ å¯ä»¥ä¸ºè‡ªå®šä¹‰ç±»å‹æ·»åŠ ä¸€äº›æ–¹ä¾¿çš„æ–¹æ³•æ¥æ“ä½œå­—èŠ‚æ•°æ®ã€‚ BufMut trait ä¸­å®šä¹‰äº†ä¸€ä¸ª put æ–¹æ³•ï¼Œç”¨äºå°†æ•°æ®å†™å…¥ç¼“å†²åŒºã€‚è¿™ä¸ªæ–¹æ³•å¯ä»¥ç”¨äºå¤šç§ç±»å‹ï¼ŒåŒ…æ‹¬ u8ã€\u0026[u8]ã€\u0026str ç­‰ã€‚æ­¤æ—¶ Vec ä½¿ç”¨ put ä¹Ÿæ›´åˆç†ï¼ŒæŒæ‰¹é‡å†™å…¥ç¼“å†²åŒºï¼Œå‡å°‘å†…å­˜å¤åˆ¶ã€‚ ç„¶åå®ç° add å‡½æ•°ï¼Œå‘ Block æ·»åŠ ä¸€ä¸ª key-value å€¼ï¼Œé¦–å…ˆéœ€è¦çŸ¥é“æ•°æ®çš„ offset å³å­˜æ”¾çš„ä½ç½® self.data.len()ï¼Œç„¶åæŒ‰ç…§æ ¼å¼ key_len key value_len value å­˜å…¥æ•°æ®ã€‚ä½†éœ€è¦æ³¨æ„åˆ¤æ–­å½“å‰ç¼–ç åçš„ Block æ˜¯å¦è¶…è¿‡äº† block_sizeï¼ˆæ³¨æ„ï¼šé™¤éç¬¬ä¸€ä¸ª key-value pair è¶…è¿‡äº† block sizeï¼‰ï¼š /// Adds a key-value pair to the block. Returns false when the block is full. #[must_use] pub fn add(\u0026mut self, key: KeySlice, value: \u0026[u8]) -\u003e bool { // data: [u8] | offsets: [u16] | num of elements: u16 if !self.is_empty() \u0026\u0026 /* can store one large key */ self.data.len() + self.offsets.len() * 2 + 2 + /* current encode */ key.len() + 2 + value.len() + 2 + 2 /* key_len: 2b | key: keylen | value_len: 2b | value: val_len + offset */ \u003e self.block_size { return false; } if self.offsets.is_empty() { self.first_key = key.to_key_vec(); } self.data.put_u16(key.len() as u16); self.data.put(key.into_inner()); self.data.put_u16(value.len() as u16); self.data.put(value); self.offsets.push(self.data.len() as u16); true } /// Check if there is no key-value pair in the block. pub fn is_empty(\u0026self) -\u003e bool { self.offsets.is_empty() } /// Finalize the block. pub fn build(self) -\u003e Block { Block { offsets: self.offsets, data: self.data, } } æ‰€ä»¥æ£€æŸ¥ Block::is_empty æ˜¯å¦ä¸ºç©ºå°±å¾ˆç®€å•äº†ï¼Œåªéœ€è¦æ£€æŸ¥ offset æ•°ç»„æ˜¯ä¸æ˜¯ç©ºçš„ï¼ŒåŒæ—¶ build å°±ç›´æ¥è¿”å›å½“å‰çš„ Block å¸¦ä¸Š offset å’Œ data ç„¶åå®ç° Block::encode ç¼–ç æ•°æ®ï¼ŒæŒ‰ç…§ data offset è¿™ç§ç¼–ç æ ¼å¼ encodeï¼Œå³æ•™ç¨‹ä¸­çš„ æ‹·è´ raw block data åˆ° data vector å¹¶ä¸”æ¯ 2 ä¸ª bytes è¿›è¡Œ decode entry offsetsï¼Œç”±äºæ­¤æ—¶çš„ data æ˜¯ Vec\u003cu8\u003e ç±»å‹ï¼Œéœ€è¦è½¬æˆ Bytes è¿”å›ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ .into() æ–¹æ³•ã€‚ä½†æ˜¯æ•™ç¨‹æåˆ°åªéœ€è¦ä¸€ä¸ª Vec\u003cu8\u003eï¼Œæ‰€ä»¥éœ€è¦å°† offsets ä¹Ÿå¡åˆ° data é‡Œå»ï¼š impl Block { /// Encode the internal data to the data layout illustrated in the tutorial /// Note: You may want to recheck if any of the expected field is missing from your output pub fn encode(\u0026self) -\u003e Bytes { let mut buf = self.data.clone(); for offset in \u0026self.offsets { buf.put_u16(*offset); } // num of elements buf.put_u16(self.offsets.len() as u16); buf.into() } /// Decode from the data layout, transform the input `data` to a single `Block` pub fn decode(data: \u0026[u8]) -\u003e Self { let offsets_len = (\u0026data[data.len() - 2..data.len()]).get_u16() as usize; let offsets = (\u0026data[data.len() - 2 - offsets_len * 2..data.len() - 2]) .chunks(2) .map(|mut chunk| chunk.get_u16()) .collect(); let data = data[..data.len() - 2 - offsets_len * 2].to_vec(); Self { data, offsets } } } ç›¸åº”çš„ï¼Œdecode ä¹Ÿæ˜¯ä»ä¸€ä¸ª data: \u0026[u8] å–å¾—æ‰€æœ‰çš„ data å’Œç›¸åº”çš„ offsetï¼Œä»ç¼“å†²åŒºæœ€åä¸€ä¸ª u16 å¯ä»¥è·å¾— offset æ•°ç»„çš„é•¿åº¦ ä»£ç é‡Œçš„æ‰€æœ‰ 2 éƒ½æ˜¯ u16 çš„é•¿åº¦ï¼Œæ›´è§„èŒƒåº”è¯¥ä½¿ç”¨å¸¸é‡æ¥è¡¨ç¤ºï¼Œæ¯”å¦‚ pub(crate) const SIZEOF_U16: usize = std::mem::size_of::\u003cu16\u003e(); ","date":"2024-07-27","objectID":"/posts/minilsm-3/:3:0","tags":["Database","LSM"],"title":"Mini-LSM Week 1 Day3","uri":"/posts/minilsm-3/"},{"categories":null,"content":"Task 2: Block Iterator ä¿®æ”¹ src/block/iterator.rsï¼Œè¿™ä¸€å°èŠ‚ï¼Œå› ä¸ºæœ‰äº† encoded blockï¼Œéœ€è¦å®ç° BlockIterator æ¥å£ï¼Œä½¿å¾—ç”¨æˆ·å¯ä»¥ lookup/scan blocks é‡Œçš„ keysã€‚ BlockIterator å¯ä»¥è¢« Arc\u003cBlock\u003e å®ç°ï¼Œå¦‚æœ create_and_seek_to_first è¢«è°ƒç”¨ï¼Œå®ƒä¼šæ”¾åœ¨ block çš„ç¬¬ä¸€ä¸ª keyã€‚å¦‚æœ create_and_seek_to_key è¢«è°ƒç”¨ï¼Œiterator ä¼šè¢«æ”¾åœ¨ç¬¬ä¸€ä¸ª \u003e= å¤§äºç­‰äºç›¸åº” key çš„ä½ç½®ï¼Œæ¯”å¦‚ 1, 3, 5 åœ¨ä¸€ä¸ª Block æ—¶ let mut iter = BlockIterator::create_and_seek_to_key(block, b\"2\"); // åˆ›å»º key 2 assert_eq!(iter.key(), b\"3\"); // æ­¤æ—¶ iterator ä½ç½®åœ¨ç¬¬ä¸€ä¸ªå¤§äºç­‰äº 2 çš„ä½ç½®å³ 3 çš„ä½ç½® ä¸Šé¢çš„ seek 2 å°†ä½¿è¿­ä»£å™¨å®šä½åœ¨ä¸‹ä¸€ä¸ªå¯ç”¨é”® 2ï¼Œåœ¨æœ¬ä¾‹ä¸­ä¸º 3ã€‚ iterator åº”è¯¥ä» block æ‹·è´ key å¹¶ä¸”å­˜åˆ° iterator æœ¬èº«ï¼ˆæœªæ¥ä¼šæœ‰ key compression å‹ç¼©çš„å†…å®¹ï¼‰ï¼Œå¯¹äºå€¼ valueï¼Œå¿…é¡»åœ¨ iterator å­˜å‚¨èµ·å§‹/ç»“æŸ begin/end offset åç§»ï¼Œå¹¶ä¸”ä¸èƒ½æ‹·è´ã€‚ å½“ next è¢«è°ƒç”¨ï¼Œiterator ä¼šç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªä½ç½®ã€‚å¦‚æœæŠµè¾¾ block ç»“æŸä½ç½®ï¼Œå¯ä»¥è®¾ç½® key ä¸ºç©ºç„¶åä» is_valid è¿”å› falseï¼Œè¿™æ ·è°ƒç”¨è€…å¯ä»¥åˆ‡æ¢åˆ°å¦å¤–çš„ blockã€‚ ","date":"2024-07-27","objectID":"/posts/minilsm-3/:4:0","tags":["Database","LSM"],"title":"Mini-LSM Week 1 Day3","uri":"/posts/minilsm-3/"},{"categories":null,"content":"Task 2: Solution æœ¬èŠ‚éœ€è¦å®ç°çš„å‡½æ•°è¾ƒå¤šï¼Œå…ˆè§‚å¯Ÿ BlockIterator::new æ„é€ å‡½æ•°ï¼Œä¼ å…¥ä¸€ä¸ª Arc\u003cBlock\u003eï¼Œä½†è§‚å¯Ÿæµ‹è¯•ï¼ŒåŸºæœ¬éƒ½æ²¡æœ‰ä½¿ç”¨è¿™ä¸ªæ„é€ å‡½æ•°è€Œæ˜¯ä½¿ç”¨ create_and_... ç­‰å‡½æ•°ã€‚ æ‰€ä»¥ create_and_seek_to_first(block: Arc\u003cBlock\u003e) å’Œ create_and_seek_to_key(block: Arc\u003cBlock\u003e, key: KeySlice) éƒ½æ¥å—ä¸€ä¸ªåŸå­è®¡æ•°å¼•ç”¨ï¼Œè°ƒç”¨æ„é€ å‡½æ•°ï¼Œè°ƒç”¨ç›¸åº”å‡½æ•°ï¼Œè¿”å›è¿­ä»£å™¨ï¼š pub fn create_and_seek_to_first(block: Arc\u003cBlock\u003e) -\u003e Self { let mut iter = Self::new(block); iter.seek_to_first(); iter } /// Creates a block iterator and seek to the first key that \u003e= `key`. pub fn create_and_seek_to_key(block: Arc\u003cBlock\u003e, key: KeySlice) -\u003e Self { let mut iter = Self::new(block); iter.seek_to_key(key); iter } å¯¹äº key value å‡½æ•°ï¼Œç›´æ¥è¿”å›å½“å‰çš„ entry: /// Returns the key of the current entry. pub fn key(\u0026self) -\u003e KeySlice { self.key.as_key_slice() } /// Returns the value of the current entry. pub fn value(\u0026self) -\u003e \u0026[u8] { \u0026self.block.data[self.value_range.0..self.value_range.1] } /// Returns true if the iterator is valid. /// Note: You may want to make use of `key` pub fn is_valid(\u0026self) -\u003e bool { !self.key.is_empty() } ","date":"2024-07-27","objectID":"/posts/minilsm-3/:5:0","tags":["Database","LSM"],"title":"Mini-LSM Week 1 Day3","uri":"/posts/minilsm-3/"},{"categories":null,"content":"DuckDB: an Embeddable Analytical Database è¯»ä¸€ä¸‹ DuckDB çš„è®ºæ–‡ï¼Œå¯¹ OLAP æ²¡ä»€ä¹ˆäº†è§£ï¼Œä½†è®ºæ–‡å¾ˆçŸ­ä¹Ÿå¯ä»¥çœ‹çœ‹ã€‚ ","date":"2024-06-07","objectID":"/posts/duckdb-2019/:1:0","tags":["Paper Reading"],"title":"Paper Reading: DuckDB: an Embeddable Analytical Database","uri":"/posts/duckdb-2019/"},{"categories":null,"content":"ABSTRACT SQLite åº”ç”¨å¾ˆå¹¿ï¼Œunobtrusive in-process data management æ˜¯æœ‰å¿…è¦çš„ï¼Œä½†ç›®å‰æ²¡æœ‰ç³»ç»Ÿåš è¿™æ ·çš„ analytical workloadsã€‚ DuckDB æå‡ºäº† analytical SQL queries while embedded in another process. DuckDB å¼€æºï¼Œä½¿ç”¨ CPP å®ç°ï¼šDuckDB Github ç­‰æœ‰ç©ºå¯ä»¥å­¦å­¦ SQLiteï¼Œæ˜¯æ€ä¹ˆåšåˆ°ä½“ç§¯å°ä½†æ˜¯åˆåº”ç”¨è¿™ä¹ˆå¹¿æ³›çš„ã€‚ unobtrusive è¡¨ç¤ºä»€ä¹ˆï¼Ÿä¸å¼•äººæ³¨ç›®ï¼Ÿ embbed database å’Œ database server çš„åŒºåˆ«åœ¨äºï¼Œå‰è€…ä¸å±äºæœåŠ¡å™¨ï¼Œä½“ç§¯å°ï¼Œå’Œåº”ç”¨ç¨‹åºè¿è¡Œåœ¨åŒä¸€è¿›ç¨‹ã€‚åè€…æœåŠ¡å™¨ç‹¬ç«‹è¿è¡Œã€‚ ","date":"2024-06-07","objectID":"/posts/duckdb-2019/:2:0","tags":["Paper Reading"],"title":"Paper Reading: DuckDB: an Embeddable Analytical Database","uri":"/posts/duckdb-2019/"},{"categories":null,"content":"INTRODUCTION æ•°æ®å¤„ç†ç°åœ¨æœ‰è®¸å¤š large monolithic database servers running as stand-alone processesï¼Œæ˜¯å› ä¸ºéœ€è¦è§£å†³å¤šå®¢æˆ·ç«¯ï¼Œé«˜å¹¶å‘å¸¦æ¥çš„æ•°æ®å®Œæ•´æ€§é—®é¢˜ã€‚ è€ŒåµŒå…¥å¼æ•°æ®åº“å®Œå…¨ä¸åŒï¼Œåªéœ€è¦åµŒå…¥åˆ°å®¿ä¸»è¿›ç¨‹ã€‚æ¯”å¦‚ä¸“æ³¨äº‹åŠ¡å¤„ç† OLTP çš„ SQLiteï¼Œä½¿ç”¨ B-Tree å’Œè¡Œå­˜ä½œä¸ºå­˜å‚¨å¼•æ“ï¼Œæ‰€ä»¥åœ¨ OLAP è¡¨ç°ä¸å¥½ã€‚ å¯åµŒå…¥çš„ OLAP æ˜¯æœ‰å¿…è¦çš„ï¼š1. Interactive data analysis 2. edge computing æ¯”å¦‚ R, Python è¿›è¡Œæ•°æ®åˆ†æï¼Œç¼ºå°‘æŸ¥è¯¢ä¼˜åŒ–å’Œäº‹åŠ¡å¤„ç†ã€‚è¾¹ç¼˜è®¡ç®—ç”¨åµŒå…¥æ•°æ®åº“å¯ä»¥åšä¸€äº›åœ¨çº¿åˆ†æï¼Œè®ºæ–‡ä¸¾äº†ä¸ª power meters å¸¦å®½é™åˆ¶çš„ä¾‹å­ã€‚ è®ºæ–‡åˆ†æäº†å‡ ä¸ªåµŒå…¥å¼ OLAP æ•°æ®åº“çš„éœ€æ±‚ï¼š é«˜æ•ˆç‡ OLAP å·¥ä½œè´Ÿè½½ï¼Œä½†ä¸å®Œå…¨ç‰ºç‰² OLTP æ€§èƒ½ï¼šæ¯”å¦‚ dashboard ä¸­çš„æ•°æ®å¹¶å‘ä¿®æ”¹ï¼ŒOLAP è¿›è¡Œå¯è§†åŒ–ï¼ŒOLTP è¿›è¡Œæ•°æ®æ›´æ–° é«˜æ•ˆåœ°ä» tables åˆ° database çš„ä¼ è¾“ï¼šåµŒå…¥å¼æ•°æ®åº“å’Œåº”ç”¨åœ¨åŒä¸€ä¸ªè¿›ç¨‹å’Œåœ°å€ç©ºé—´ï¼Œå¯ä»¥é«˜æ•ˆåœ°å®ç° data sharing é«˜åº¦ç¨³å®šæ€§ï¼šå¦‚æœåµŒå…¥æ•°æ®åº“å´©æºƒï¼Œæ¯”å¦‚ OOM å¯èƒ½ä¼šæŠŠå®¿ä¸»è¿›ç¨‹éƒ½å¸¦èµ°ï¼Œæ‰€ä»¥æŸ¥è¯¢å¦‚æœç”¨å®Œäº†èµ„æºï¼Œå¿…é¡»æ˜¯å¯ä»¥ aborted cleanly çš„ï¼Œè€Œä¸”ç³»ç»Ÿéœ€è¦å¯ä»¥ gracefully é€‚åº”èµ„æºç«äº‰ã€‚ å®ç”¨çš„å¯åµŒå…¥æ€§å’Œå¯ç§»æ¤æ€§ï¼Œæ•°æ®åº“éœ€è¦å¯ä»¥è¿è¡Œåœ¨ä¸è®ºä¸»æœºè¿è¡Œåœ¨çš„ä»»ä½•ç¯å¢ƒã€‚å¤–éƒ¨ä¾èµ–æ˜¯æœ‰é—®é¢˜çš„ã€ä¿¡å·å¤„ç†ä¹Ÿä¸è¡Œã€‚ è®ºæ–‡æå‡ºäº† DuckDBï¼Œå¼€æºçš„ï¼Œå¯åµŒå…¥çš„å…³ç³»å‹æ•°æ®åº“ã€‚å…·æœ‰å®Œæ•´çš„ SQL æ¥å£ã€‚ ","date":"2024-06-07","objectID":"/posts/duckdb-2019/:3:0","tags":["Paper Reading"],"title":"Paper Reading: DuckDB: an Embeddable Analytical Database","uri":"/posts/duckdb-2019/"},{"categories":null,"content":"DESIGN AND IMPLEMENTATION DuckDB è®¾è®¡ç›®çš„ï¼šåµŒå…¥å¼åˆ†æï¼Œè¿›è¡Œäº†ç»„ä»¶åˆ†ç¦»ï¼šparser, logical planner, optimizer, physical planner, execution engine. ä»¥åŠ Orthogonal components: transaction, storage managers. ä½œä¸ºåµŒå…¥æ•°æ®åº“ï¼ŒDuckDB æ²¡æœ‰å®¢æˆ·ç«¯åè®®æ¥å£æˆ–è€…æœåŠ¡å™¨è¿›ç¨‹ï¼Œè€Œæ˜¯ä½¿ç”¨ C/C++ API è®¿é—®ã€‚æ­¤å¤–ï¼ŒDuckDB æä¾›äº†ä¸€ä¸ª SQLite å…¼å®¹å±‚ï¼Œå¯ä»¥è®©ä½¿ç”¨ SQLite çš„ç¨‹åºé€šè¿‡ re-linking æˆ–è€… library overloading è¿æ¥ã€‚ DuckDB SQL parser è¡ç”Ÿè‡ª Postgresâ€™ SQL parserï¼Œå¹¶ä¸”å°½å¯èƒ½åœ°åˆ†ç¦»äº†ã€‚å¯ä»¥ä¸º DuckDB æä¾›å…¨åŠŸèƒ½ã€ç¨³å®šçš„è§£æå™¨ï¼Œå¯ä»¥å¤„ç†æœ€ä¸ç¨³å®šçš„è¾“å…¥å½¢å¼ï¼šSQL æŸ¥è¯¢ã€‚è§£æå™¨å°† SQL æŸ¥è¯¢å­—ç¬¦ä¸²ä½œä¸ºè¾“å…¥ï¼Œå¹¶ä¸”è¿”å›ä¸€ä¸ªè§£ææ ‘ï¼ˆC è¯­è¨€ç»“æ„ï¼‰ã€‚è§£ææ ‘ä¼šç«‹å³è¢«è½¬æˆ DuckDB è‡ªå·±çš„è§£ææ ‘ï¼ˆC++ ç±»ï¼‰ä»¥é™åˆ¶ Postgres æ•°æ®ç»“æ„çš„èŒƒå›´ã€‚ ä¸ºä»€ä¹ˆè¦ limit the reach of Pgâ€™s data structure? logical planner é€»è¾‘è§„åˆ’å™¨å…·æœ‰ä¸¤ä¸ªéƒ¨åˆ†ï¼šbinder å’Œ plan generatorã€‚binder è§£æè¡¨è¾¾å¼å’Œå…¶å¼•ç”¨çš„ schema object æ¯”å¦‚è¡¨ã€è§†å›¾çš„åˆ—åå’Œç±»å‹ã€‚logical planner generator å°†è§£ææ ‘è½¬æ¢æˆ tree of logical query operators æ¯”å¦‚ scan, filter, project ç­‰ç­‰ã€‚åœ¨ planning é˜¶æ®µåï¼Œå°±æœ‰äº† fully type-resolved logical query plan. DuckDB ä¿ç•™äº†å­˜å‚¨æ•°æ®çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œè¿™äº›æ•°æ®ä¼šåœ¨ planning é˜¶æ®µé€šè¿‡ä¸åŒçš„è¡¨è¾¾å¼æ ‘ä¼ æ’­ propagate. è¿™äº›ç»Ÿè®¡ä¿¡æ¯ä¼šåœ¨ optimizer ä¸­ä½¿ç”¨ï¼Œå¹¶ä¸”ä¹Ÿå¯ä»¥ç”¨æ¥åœ¨å‡çº§ç±»å‹æ—¶åšé¢„é˜²æ•´å‹æº¢å‡ºã€‚ DuckDB optimizer ä½¿ç”¨ dynamic programming åŠ¨æ€è§„åˆ’å®ç° join order optimizationï¼Œä½¿ç”¨è´ªå¿ƒä½œä¸º fallback å¤„ç†å¤æ‚çš„ join graphs. It performs flattening of arbitrary subqueries as described in Neumann et al. [9]. Thomas Neumann and Alfons Kemper. 2015. Unnesting Arbitrary Queries. In Datenbanksysteme fÃ¼r Business, Technologie und Web (BTW), 16. Fachtagung des GI-Fachbereichs â€œDatenbanken und Informationssys- temeâ€ (DBIS), 4.-6.3.2015 in Hamburg, Germany. Proceedings. æ²¡çœ‹æ‡‚è¿™é‡Œ æ­¤å¤–ï¼Œduckdb è¿˜æœ‰ä¸€ç³»åˆ—é‡å†™çš„è§„åˆ™ï¼Œå¯ä»¥ç®€åŒ–è¡¨è¾¾å¼æ ‘ï¼Œæ¯”å¦‚ common subexpression elimination, constant folding. åŸºæ•°ä¼°è®¡ cardinality estimation ä½¿ç”¨äº†é‡‡æ ·å’Œ HyperLog å®ç°ã€‚æ­¤è¿‡ç¨‹çš„ç»“æœæ˜¯æŸ¥è¯¢çš„ä¼˜åŒ–é€»è¾‘è®¡åˆ’ optimized plan for the query. The physical planner ç‰©ç†è§„åˆ’å™¨å°†é€»è¾‘è§„åˆ’è½¬æˆç‰©ç†è§„åˆ’ï¼Œé€‰æ‹©åˆé€‚çš„å®ç°æ–¹æ³•ã€‚æ¯”å¦‚ï¼Œscan å¯èƒ½å†³å®šä½¿ç”¨ç°æœ‰çš„ç´¢å¼•è€Œä¸æ˜¯æ ¹æ® selectivity estimates æ‰«æ base tables, æˆ–è€…æ ¹æ® join è°“è¯é€‰æ‹© hash join è¿˜æ˜¯ merge joinã€‚ DuckDB ä½¿ç”¨äº† vectorized interpreted execution engine. ä½¿ç”¨äº† SQL æŸ¥è¯¢ JIT å³æ—¶ç¼–è¯‘ï¼Œæœ‰åˆ©äºå¯ç§»æ¤æ€§ã€‚JIT å¼•æ“ä¾èµ–äºå¤§é‡çš„ç¼–è¯‘åº“ï¼ˆæ¯”å¦‚ LLVMï¼‰ï¼ŒDuckDB ä½¿ç”¨äº†å›ºå®šæœ€å¤§å€¼çš„å‘é‡ï¼ˆé»˜è®¤å€¼ 1024ï¼‰ã€‚å›ºå®šé•¿åº¦ç±»å‹çš„å€¼ï¼Œæ¯”å¦‚æ•´æ•°å¯ä»¥è¡¨ç¤ºä¸ºåŸç”Ÿæ•°ç»„ native arrays. å¯å˜é•¿åº¦å€¼æ¯”å¦‚å­—ç¬¦ä¸²ï¼Œå¯ä»¥è¡¨ç¤ºä¸ºåŸç”Ÿæ•°ç»„æŒ‡é’ˆ into a separate string heap. NULL å€¼ä½¿ç”¨å•ç‹¬çš„ä½å‘é‡è¡¨ç¤ºï¼Œå½“ NULL å€¼å‡ºç°åœ¨å‘é‡æ—¶æ‰å­˜åœ¨ã€‚ è¿™å…è®¸ fast intersection (é€»è¾‘ä¹˜) of NULL vectors for binary vector operation and avoids redundant computationâ€¦. Peter A. Boncz, Marcin Zukowski, and Niels Nes. 2005. MonetDB/X100: Hyper-Pipelining Query Execution. In CIDR 2005, Second Biennial Conference on Innovative Data Systems Research, Asilomar, CA, USA, January 4-7, 2005. 225â€“237. ç°ä»£æŸ¥è¯¢å¼•æ“çš„ä¸¤ç§ä¼˜åŒ–æ–¹å¼ - Vectorization and Compilationï¼Œæœ‰æœºä¼šå¯ä»¥çœ‹çœ‹ æ‰§è¡Œå¼•æ“ä½¿ç”¨ ç«å±±æ¨¡å‹ æ‰§è¡ŒæŸ¥è¯¢ï¼ŒæŸ¥è¯¢æ‰§è¡Œé€šè¿‡ç‰©ç†è®¡åˆ’çš„æ ¹èŠ‚ç‚¹æ‹‰å–ç¬¬ä¸€ä¸ª â€œchunkâ€ çš„æ•°æ®ã€‚ chunk æ˜¯ç»“æœé›†åˆã€æŸ¥è¯¢ä¸­é—´ç»“æœæˆ– base table çš„ä¸€ä¸ªæ°´å¹³å­é›†ã€‚èŠ‚ç‚¹ä¼šé€’å½’åœ°ä»å­èŠ‚ç‚¹æ‹‰å– chunksï¼Œæœ€ç»ˆè¾¾åˆ° scan operatorï¼Œé€šè¿‡è¯»æŒç»­åŒ–çš„è¡¨æ¥äº§ç”Ÿ chunks. è¿‡ç¨‹æŒç»­åˆ°æ ¹èŠ‚ç‚¹ä¸ºç©ºï¼Œæ­¤æ—¶æŸ¥è¯¢å°±å®Œæˆäº†ã€‚ DuckDB é€šè¿‡ MVCC æä¾› ACIDï¼Œå®ç°äº† HyPerâ€™s å¯ä¸²è¡ŒåŒ– MVCC çš„å˜ç§ï¼Œä¸º OLAP/OLTP ç³»ç»Ÿé‡èº«å®šåšã€‚è¿™ä¸ªå˜ç§ä¼šåŸåœ°ç«‹åˆ»æ›´æ–°æ•°æ®ï¼Œå¹¶ä¸”ä¼šå•ç‹¬çš„ undo buffer ä¿å­˜ä¹‹å‰çš„çŠ¶æ€ï¼Œç”¨æ¥è¿›è¡Œå¹¶å‘äº‹åŠ¡å’Œ abortã€‚DuckDB é€‰æ‹©äº† MVCC å’Œç®€å•çš„ schemes æ¯”å¦‚ Optimistic Concurrency Controlã€‚å°½ç®¡ DuckDB ç”¨äº analyticsï¼Œä½†å¹¶è¡Œä¿®æ”¹ tables ","date":"2024-06-07","objectID":"/posts/duckdb-2019/:4:0","tags":["Paper Reading"],"title":"Paper Reading: DuckDB: an Embeddable Analytical Database","uri":"/posts/duckdb-2019/"},{"categories":null,"content":"Go å¹¶å‘ç¼–ç¨‹å®æˆ˜ https://time.geekbang.org/column/intro/100061801 æŒºå¥½çš„å®æˆ˜æ•™ç¨‹ ","date":"2024-05-22","objectID":"/posts/go-concurrent-1/:1:0","tags":["Go","å¹¶å‘ç¼–ç¨‹","ç¬”è®°"],"title":"é˜…è¯»ï¼šGo å¹¶å‘ç¼–ç¨‹å®æˆ˜ 1-4","uri":"/posts/go-concurrent-1/"},{"categories":null,"content":"èµ„æºå¹¶å‘è®¿é—®é—®é¢˜ ä½¿ç”¨ 10 ä¸ªçº¿ç¨‹å¯¹å˜é‡ counter è¿›è¡Œå¢åŠ ï¼Œæ¯ä¸ªå¢åŠ  10000ï¼Œç»“æœæœ€åæ˜¯ 10 * 10000 å—ï¼Ÿ ","date":"2024-05-22","objectID":"/posts/go-concurrent-1/:2:0","tags":["Go","å¹¶å‘ç¼–ç¨‹","ç¬”è®°"],"title":"é˜…è¯»ï¼šGo å¹¶å‘ç¼–ç¨‹å®æˆ˜ 1-4","uri":"/posts/go-concurrent-1/"},{"categories":null,"content":"äº’æ–¥é” ä¸´ç•ŒåŒºå°±æ˜¯ä¸€ä¸ªè¢«å…±äº«çš„èµ„æºã€‚ä¸ºäº†é¿å…ç«äº‰å¯¼è‡´å¹¶å‘ç»“æœä¸å¯¹ï¼Œå¯ä»¥ä½¿ç”¨äº’æ–¥é”ï¼Œé™å®šä¸´ç•ŒåŒºåªèƒ½åŒæ—¶ç”±ä¸€ä¸ªçº¿ç¨‹æŒæœ‰ï¼Œæ¯”å¦‚ Mutex é”ã€‚ ","date":"2024-05-22","objectID":"/posts/go-concurrent-1/:2:1","tags":["Go","å¹¶å‘ç¼–ç¨‹","ç¬”è®°"],"title":"é˜…è¯»ï¼šGo å¹¶å‘ç¼–ç¨‹å®æˆ˜ 1-4","uri":"/posts/go-concurrent-1/"},{"categories":null,"content":"Race Detector Go race detector åŸºäº Google çš„ C/C++ sanitizers æŠ€æœ¯å®ç°ï¼Œåœ¨ç¼–è¯‘æœŸæ£€æµ‹å¯¹å…±äº«å˜é‡çš„éåŒæ­¥è®¿é—®ã€‚ ","date":"2024-05-22","objectID":"/posts/go-concurrent-1/:2:2","tags":["Go","å¹¶å‘ç¼–ç¨‹","ç¬”è®°"],"title":"é˜…è¯»ï¼šGo å¹¶å‘ç¼–ç¨‹å®æˆ˜ 1-4","uri":"/posts/go-concurrent-1/"},{"categories":null,"content":"Mutex å®ç°åŸç† æœ€åˆçš„ Mutex ä½¿ç”¨ä¿¡å·é‡æ§åˆ¶ goroutine çš„é˜»å¡ä¼‘çœ å’Œå”¤é†’ + flag å­—æ®µæ ‡è®°æ˜¯å¦æŒæœ‰é”ï¼ˆCAS è¿›è¡Œåˆ¤æ–­ï¼Œ0 æœªæŒæœ‰ï¼Œ1 é”è¢«æŒæœ‰ä¸”æ— ç­‰å¾…ï¼Œn é”è¢«æŒæœ‰ä¸”æœ‰ n-1 ä¸ªç­‰å¾…ï¼‰ Go å¯ä»¥ä½¿ç”¨ defer æ¥é‡Šæ”¾é” åˆæœŸçš„ Mutex å­˜åœ¨å‡ ä¸ªé—®é¢˜ï¼šæ’é˜Ÿè¯·æ±‚é”éœ€è¦ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæ€§èƒ½ä¸å¥½ ","date":"2024-05-22","objectID":"/posts/go-concurrent-1/:3:0","tags":["Go","å¹¶å‘ç¼–ç¨‹","ç¬”è®°"],"title":"é˜…è¯»ï¼šGo å¹¶å‘ç¼–ç¨‹å®æˆ˜ 1-4","uri":"/posts/go-concurrent-1/"},{"categories":null,"content":"State å­—æ®µ 2011 å¹´è°ƒæ•´ Mutex çš„ state å­—æ®µä¸º int32ï¼Œç¬¬ä¸€ä½è¡¨ç¤ºé”æ˜¯å¦è¢«æŒæœ‰ï¼Œç¬¬äºŒä½è¡¨ç¤ºå”¤é†’çš„ goroutineï¼Œç¬¬ä¸‰éƒ¨åˆ†æ˜¯é˜»å¡ç­‰å¾…çš„æ•°é‡ã€‚ è·å–é” CAS æ£€æµ‹ state æ˜¯å¦ä¸º 0ï¼Œæ˜¯åˆ™ Swap æˆ mutexLocked çŠ¶æ€ atomic.CompareAndSwapInt32(\u0026m.state, 0, mutexLocked) â€”\u003e Fast Path è·å–é” æ£€æµ‹æ—§çŠ¶æ€å¹¶ä¸”åŠ é” old | mutexLockedï¼Œå¦‚æœåŠ é”å¤±è´¥åˆ™è¿›å…¥ç­‰å¾… new = old + 1 \u003c\u003c mutexWaiterShift å¦‚æœè¢«å”¤é†’åˆ™æ¶ˆé™¤ mutexWoken çŠ¶æ€ new \u0026^= mutexWoken CAS æ—§çŠ¶æ€è¿›å…¥æ–°çŠ¶æ€ï¼Œå¦‚æœæœªè¢«åŠ é”åˆ™ç»§ç»­å¾ªç¯ï¼Œå¦åˆ™è¯·æ±‚ä¿¡å·é‡å”¤é†’ã€‚ ç”¨ä½è¿ç®—æ¥åˆ¤æ–­çŠ¶æ€ã€‚ é‡Šæ”¾é” atomic.AddInt32(\u0026m.state, -mutexLocked) å»æ‰é”æ ‡å¿— æ£€æµ‹æ—§çŠ¶æ€ï¼Œå¦‚æœæ²¡æœ‰ç­‰å¾…è€…ï¼Œåˆ™é€€å‡º å¦‚æœæœ‰ç­‰å¾…è€…ï¼Œè®¾ç½®å”¤é†’æ ‡å¿— æ³¨ï¼šUnlock æ–¹æ³•å¯ä»¥è¢«ä»»æ„çš„ goroutine è°ƒç”¨é‡Šæ”¾é”ï¼Œå³ä½¿æ˜¯æ²¡æŒæœ‰è¿™ä¸ªäº’æ–¥é”çš„ goroutineï¼Œä¹Ÿå¯ä»¥è¿›è¡Œè¿™ä¸ªæ“ä½œã€‚Mutex æœ¬èº«å¹¶æ²¡æœ‰åŒ…å«æŒæœ‰è¿™æŠŠé”çš„ goroutine çš„ä¿¡æ¯ï¼Œæ‰€ä»¥ï¼ŒUnlock ä¹Ÿä¸ä¼šå¯¹æ­¤è¿›è¡Œæ£€æŸ¥ã€‚Mutex çš„è¿™ä¸ªè®¾è®¡ä¸€ç›´ä¿æŒè‡³ä»Šã€‚ ","date":"2024-05-22","objectID":"/posts/go-concurrent-1/:3:1","tags":["Go","å¹¶å‘ç¼–ç¨‹","ç¬”è®°"],"title":"é˜…è¯»ï¼šGo å¹¶å‘ç¼–ç¨‹å®æˆ˜ 1-4","uri":"/posts/go-concurrent-1/"},{"categories":null,"content":"è‡ªæ—‹ åœ¨ 2011 å¹´çš„åŸºç¡€ä¸Šï¼Œä¸è®ºæ˜¯æ–°æ¥çš„ goroutine è¿˜æ˜¯è¢«å”¤é†’çš„ï¼Œéƒ½ä¼šå°è¯•è¯·æ±‚é”ä¸”å¯ä»¥è‡ªæ—‹ runtime.canSpin(iter) ç¼“è§£äº†é¥¥é¥¿é—®é¢˜ã€‚ ç›®å‰çš„ Mutex æºç éå¸¸å¤æ‚ mutex.go åˆ†æˆäº† LockFast å’Œ LockSlowï¼Œä¹ŸåŠ å…¥äº†è¶…æ—¶çš„ä¸€äº›åˆ¤æ–­ï¼Œéƒ½åœ¨è§£å†³é¥¥é¥¿é—®é¢˜ã€‚ ","date":"2024-05-22","objectID":"/posts/go-concurrent-1/:3:2","tags":["Go","å¹¶å‘ç¼–ç¨‹","ç¬”è®°"],"title":"é˜…è¯»ï¼šGo å¹¶å‘ç¼–ç¨‹å®æˆ˜ 1-4","uri":"/posts/go-concurrent-1/"},{"categories":null,"content":"é¥¥é¥¿æ¨¡å¼ã€æ­£å¸¸æ¨¡å¼ è¢«å”¤é†’çš„ goroutine å’Œæ–°æ¥çš„ goroutine éœ€è¦ç«äº‰ï¼Œä¼šå¯¼è‡´é¥¥é¥¿äº§ç”Ÿã€‚å¦‚æœ waiter è·å–ä¸åˆ°é”çš„æ—¶é—´è¶…è¿‡äº†é˜ˆå€¼ï¼ˆ1msï¼‰ï¼ŒMutex è¿›å…¥é¥¥é¥¿æ¨¡å¼ã€‚ é¥¥é¥¿æ¨¡å¼ï¼šMutex æ‹¥æœ‰è€…ä¼šç›´æ¥æŠŠé”äº¤ç»™é˜Ÿåˆ—æœ€å‰é¢çš„ç­‰å¾…è€…ï¼Œæ–°æ¥çš„ goroutine ä¸ä¼šå°è¯•è·å–é”ï¼Œä¸è‡ªæ—‹ï¼ŒåŠ å…¥ç­‰å¾…é˜Ÿåˆ—å°¾éƒ¨ã€‚ æ­£å¸¸æ¨¡å¼ï¼šå¦‚æœ waiter å·²ç»æ˜¯é˜Ÿåˆ—æœ€åä¸€ä¸ªï¼Œæ²¡æœ‰å…¶ä»–ç­‰å¾…é”çš„ goroutineï¼Œæˆ–è€… waiter ç­‰å¾…æ—¶é—´å°äºé˜ˆå€¼ï¼ˆ1msï¼‰ã€‚ æ­£å¸¸æ¨¡å¼å…·æœ‰æ›´å¥½çš„æ€§èƒ½ã€‚ const ( mutexLocked = 1 \u003c\u003c iota // iota 0, 1 \u003c\u003c 0 = 1 mutexWoken // iota 1, 1 \u003c\u003c 1 = 2 mutexStarving // iota 2, 1 \u003c\u003c 2 = 4 mutexWaiterShift = iota // iota 3 starvationThresholdNs = 1e6 ) è¿™ç§ç”¨æ³•æ˜¯ Constant declarations ","date":"2024-05-22","objectID":"/posts/go-concurrent-1/:3:3","tags":["Go","å¹¶å‘ç¼–ç¨‹","ç¬”è®°"],"title":"é˜…è¯»ï¼šGo å¹¶å‘ç¼–ç¨‹å®æˆ˜ 1-4","uri":"/posts/go-concurrent-1/"},{"categories":null,"content":"Mutex æ˜“é”™åœºæ™¯ Lock/Unlock ä¸æ˜¯æˆå¯¹å‡ºç°ï¼Œä¼šäº§ç”Ÿæ­»é”ï¼Œæˆ– Unlock ä¸€ä¸ªæœªåŠ é”çš„ Mutex è€Œå¯¼è‡´ panicã€‚ï¼ˆå¤ªå¤š if-else/é‡æ„/è¯¯å†™/â€¦ï¼‰ é‡å…¥ï¼ŒJava ä¸­æœ‰ ReentrantLock å¯é‡å…¥é”ï¼Œè€Œ Mutex æ˜¯ä¸å¯é‡å…¥é”ã€‚ Lock() ä¹‹åä¸å¯ä»¥å† Lock()ã€‚ æ­»é”ï¼Œé¿å…æ­»é”çš„å››ä¸ªæ¡ä»¶ï¼šäº’æ–¥ã€æ‹¥æœ‰å’Œç­‰å¾…ã€ä¸å¯å‰¥å¤ºã€ç¯è·¯ç­‰å¾…ã€‚Go è¿è¡Œæ—¶æœ‰æ­»é”æ£€æµ‹åŠŸèƒ½ Copy å·²ä½¿ç”¨çš„ Mutexï¼Œsync åº“çš„åŒæ­¥åŸè¯­åœ¨ä½¿ç”¨åæ˜¯ä¸èƒ½å¤åˆ¶çš„ï¼ˆMutex æ˜¯æœ‰çŠ¶æ€çš„å¯¹è±¡ï¼Œstate è®°å½•é”çŠ¶æ€ï¼‰ï¼Œå¤åˆ¶ä½¿ç”¨åçš„ Mutex ä¼šç›´æ¥åŠ é”ã€‚é¿å…å€¼æ‹·è´ä¼ å…¥å‡½æ•°å‚æ•°ï¼Œgo vet å¯ä»¥æ£€æµ‹è¿™ç§æƒ…å†µï¼Œä½¿ç”¨ copylock åˆ†æå™¨é™æ€åˆ†æã€‚ ","date":"2024-05-22","objectID":"/posts/go-concurrent-1/:4:0","tags":["Go","å¹¶å‘ç¼–ç¨‹","ç¬”è®°"],"title":"é˜…è¯»ï¼šGo å¹¶å‘ç¼–ç¨‹å®æˆ˜ 1-4","uri":"/posts/go-concurrent-1/"},{"categories":null,"content":"Go å®ç°å¯é‡å…¥é” é”éœ€è¦è®°ä½å½“å‰æ˜¯å“ªä¸ª goroutine æŒæœ‰è¯¥é” goroutine id é€šè¿‡ runtime.Stack è·å–æ ˆå¸§ä¿¡æ¯å’Œ goroutine idï¼Œæ¯”å¦‚ goroutine 1 [running] é€šè¿‡å­—ç¬¦ä¸²å¤„ç†å¾—åˆ° goroutine idã€‚æˆ–è€…ç›´æ¥è°ƒç”¨ petermattis/goid ç­‰ç¬¬ä¸‰æ–¹åº“ã€‚ type RecursiveMutex struct { sync.Mutex owner int64 // å½“å‰æŒæœ‰é”çš„ goroutine id recursion int32 // è¿™ä¸ª goroutine é‡å…¥çš„æ¬¡æ•° } func (m *RecursiveMutex) Lock() { gid := goid.Get() // å¦‚æœå½“å‰æŒæœ‰é”çš„goroutineå°±æ˜¯è¿™æ¬¡è°ƒç”¨çš„goroutine,è¯´æ˜æ˜¯é‡å…¥ if atomic.LoadInt64(\u0026m.owner) == gid { m.recursion++ return } m.Mutex.Lock() // è·å¾—é”çš„goroutineç¬¬ä¸€æ¬¡è°ƒç”¨ï¼Œè®°å½•ä¸‹å®ƒçš„goroutine id,è°ƒç”¨æ¬¡æ•°åŠ 1 atomic.StoreInt64(\u0026m.owner, gid) m.recursion = 1 } func (m *RecursiveMutex) Unlock() { gid := goid.Get() // éæŒæœ‰é”çš„goroutineå°è¯•é‡Šæ”¾é”ï¼Œé”™è¯¯çš„ä½¿ç”¨ if atomic.LoadInt64(\u0026m.owner) != gid { panic(fmt.Sprintf(\"wrong the owner(%d): %d!\", m.owner, gid)) } // è°ƒç”¨æ¬¡æ•°å‡1 m.recursion-- if m.recursion != 0 { // å¦‚æœè¿™ä¸ªgoroutineè¿˜æ²¡æœ‰å®Œå…¨é‡Šæ”¾ï¼Œåˆ™ç›´æ¥è¿”å› return } // æ­¤goroutineæœ€åä¸€æ¬¡è°ƒç”¨ï¼Œéœ€è¦é‡Šæ”¾é” atomic.StoreInt64(\u0026m.owner, -1) m.Mutex.Unlock() } Token Go å¼€å‘è€…æ²¡æœ‰æš´éœ² goroutine idï¼Œå¼€å‘è€…å¯ä»¥è‡ªå·±æä¾› token type RecursiveMutex struct { sync.Mutex token int64 recursion int32 } func(m *RecursiveMutex) Lock(token int64) { if atomic.LoadInt64(\u0026m.token) == token { m.recursion++ return } m.Mutex.Lock() atomic.StoreInt64(\u0026m.token, token) m.recursion = 1 } func(m *RecursiveMutex) Unlock(token int64) { if atomic.LoadInt64(\u0026m.token) != token { panic(fmt.Sprintf(\"wrong the owner(%d): %d!\", m.token, token)) } // è°ƒç”¨æ¬¡æ•°å‡1 m.recursion-- if m.recursion != 0 { // å¦‚æœè¿™ä¸ªgoroutineè¿˜æ²¡æœ‰å®Œå…¨é‡Šæ”¾ï¼Œåˆ™ç›´æ¥è¿”å› return } // æ­¤goroutineæœ€åä¸€æ¬¡è°ƒç”¨ï¼Œéœ€è¦é‡Šæ”¾é” atomic.StoreInt64(\u0026m.token, 0) m.Mutex.Unlock() } ","date":"2024-05-22","objectID":"/posts/go-concurrent-1/:4:1","tags":["Go","å¹¶å‘ç¼–ç¨‹","ç¬”è®°"],"title":"é˜…è¯»ï¼šGo å¹¶å‘ç¼–ç¨‹å®æˆ˜ 1-4","uri":"/posts/go-concurrent-1/"},{"categories":null,"content":"æµè¡Œé¡¹ç›® issues Docker (Moby) Moby #36114 hotAddVHDsAtStart æ–¹æ³•å¯¹ serviceVM è¿›è¡Œ VHD çš„æ·»åŠ ï¼Œå¹¶ä¸”ä¼šå¯¹ svm åŠ é”ï¼Œå¦‚æœæ·»åŠ  VHS å¤±è´¥ä¼šè°ƒç”¨ hotRemoveVHDsAtStart æ–¹æ³•å»æ‰ VHDï¼Œè€Œè¿™ä¸ªæ–¹æ³•ä¹Ÿè¿›è¡Œäº† svm.Lock() å› ä¸º Mutex ä¸å¯é‡å…¥ï¼Œä¼šå¯¼è‡´æ­»é”ï¼Œæ‰€ä»¥æ”¹æˆäº† hotRemoveVHDsNoLock ä¸ç”¨é”çš„æ–¹æ³•æ¥ç§»é™¤ VHDã€‚ Moby #34881 è¿™ä¸ª PR åœ¨ if åˆ¤æ–­å return å´æ²¡æœ‰é‡Šæ”¾é” å…¶ä»–è¿˜æœ‰ 36840ã€37583ã€35517ã€35482ã€33305ã€32826ã€30696ã€29554ã€29191ã€28912ã€26507 ç­‰ issuesã€‚ Kubernetes Kubernetes #45192 å¿˜è®° Unlock å¯¼è‡´æ­»é” Kubernetes #72361 ä½¿ç”¨ mutex è§£å†³ç«äº‰é—®é¢˜ Kubernetes #71617 ä½¿ç”¨ mutex è§£å†³ç«äº‰é—®é¢˜ Kubernetes #70605 ä½¿ç”¨ mutex è§£å†³ç«äº‰é—®é¢˜ gRPC-go gRPC-go #795 Unlock() å†™é”™äº†ï¼Ÿæ‰€ä»¥è¿˜æ˜¯ defer unlock åˆç†ã€‚ gRPC-go #1318 æ·»åŠ  Lock é˜²æ­¢ data races gRPC-go #2074 æ·»åŠ  Lock é˜²æ­¢ data races etcd Distributed reliable key-value store for the most critical data of a distributed system etcd #10419 etcd Compact æ–¹æ³•è°ƒç”¨çš„æ—¶å€™ï¼Œä½¿ç”¨äº† mu.Lock() è€Œ Store æ–¹æ³•ä¹Ÿä¼šè°ƒç”¨ ","date":"2024-05-22","objectID":"/posts/go-concurrent-1/:4:2","tags":["Go","å¹¶å‘ç¼–ç¨‹","ç¬”è®°"],"title":"é˜…è¯»ï¼šGo å¹¶å‘ç¼–ç¨‹å®æˆ˜ 1-4","uri":"/posts/go-concurrent-1/"},{"categories":null,"content":"CatSQL: Towards Real World Natural Language to SQL Applications NL2SQL, text to SQL æ˜¯å¾ˆæœ‰è¶£çš„æ–¹å‘ã€‚æœ‰ DL æ–¹æ³•ä¹Ÿæœ‰ç°åœ¨çš„ LLM å¾®è°ƒã€‚ ","date":"2024-04-14","objectID":"/posts/catsql-nlsql/:1:0","tags":["Paper Reading"],"title":"Paper Reading: CatSQL: Towards Real World Natural Language to SQL Applications [VLDB 23]","uri":"/posts/catsql-nlsql/"},{"categories":null,"content":"ABSTRACT rule-based æˆ–è€… Deep Learning æ–¹æ³•ï¼Œè¦ä¹ˆæ— æ³•é€šç”¨ï¼Œæˆ–è€…å­˜åœ¨è¯­æ³•/è¯­ä¹‰é”™è¯¯/æ— æ³•æ‰§è¡Œã€‚ æœ¬æ–‡æå‡ºçš„æ–°æ¡†æ¶ï¼Œæ³¨é‡ Accuracy å’Œ runtimeï¼Œæå‡ºäº† novel CatSQL sketch, which constructs a template with slots that initially serve as placeholders, and tightly integrates with a deep learning model to fill in these slots with meaningful contents based on the database schema å¯¹æ¯” sequence-to-sequence æˆ– sketch-based æ–¹æ³•ï¼Œä¸éœ€è¦ç”Ÿæˆå…³é”®è¯ï¼Œæœ‰æ›´é«˜å‡†ç¡®å’Œæ›´å¿« å¯¹æ¯” sketch-based æ–¹æ³•ï¼Œæ›´åŠ é€šç”¨ï¼Œè€Œä¸”å¯ä»¥ç”¨å·²ç»å¡«å¥½çš„è¯æ¥æé«˜æ€§èƒ½ã€‚ æå‡ºäº† Semantics Correction technique, which is the first that leverages database domain knowledge in a deep learning based NL2SQL solution. Semantics Correction æ˜¯ post-processing åå¤„ç†ï¼Œé€šè¿‡ rules è¯†åˆ«å’Œä¿®æ”¹è¯­ä¹‰é”™è¯¯ï¼Œå¤§å¤§æé«˜äº† NL2SQL çš„å‡†ç¡®åº¦ã€‚ å®éªŒï¼šsingle-domain and cross-domainï¼Œå‡†ç¡®æ€§å’Œååé‡éƒ½æé«˜å¾ˆå¤šï¼Œå°¤å…¶æ˜¯åœ¨ Spider åŸºå‡†ä¸Šï¼Œæ¯”ä¹‹å‰æœ€å¥½çš„ stoa NL2SQL è¦é«˜å››åˆ†ï¼Œ63x çš„ååé‡ ","date":"2024-04-14","objectID":"/posts/catsql-nlsql/:2:0","tags":["Paper Reading"],"title":"Paper Reading: CatSQL: Towards Real World Natural Language to SQL Applications [VLDB 23]","uri":"/posts/catsql-nlsql/"},{"categories":null,"content":"INTRODUCTION æ—©æœŸ NL2SQL æ˜¯ rule-based, å…ˆå°† nl parse æˆä¸­é—´æ€(parsing tree) ç„¶åå¼€å‘ rules æ˜ å°„æˆ SQL æŠ½è±¡è¯­æ³•æ ‘ï¼Œç„¶åè½¬æˆ SQL queryã€‚è¿™æ ·éš¾ä»¥è·¨åŸŸï¼Œè€Œä¸”éœ€è¦å¤§é‡äººåŠ›å¼€å‘è§„åˆ™ã€‚ æœ€è¿‘å€ŸåŠ© Deep Learning å®ç° cross-domain adaptionï¼Œè€Œä¸”æä¾›äº†å¤§é‡æ•°æ®é›†ï¼Œæ¯”å¦‚ Wiki-SQL å’Œ Spiderã€‚éƒ¨åˆ† DL æ–¹æ³•å¯ä»¥è¾¾åˆ° 80-90% çš„ç²¾åº¦ï¼Œä½†æ˜¯å¯¹äºå¤æ‚æŸ¥è¯¢æ€§èƒ½ä¼šæ˜¾è‘—ä¸‹é™ï¼Œä¸åˆ° 50%ã€‚ä»¥å‰çš„æ–¹æ³•å°†å…¶è®¤ä¸ºæ˜¯ç¿»è¯‘é—®é¢˜ï¼Œæœºå™¨ç¿»è¯‘é—®é¢˜(seq2seq)ï¼Œæ²¡æœ‰åˆ©ç”¨æ•°æ®åº“çŸ¥è¯†ï¼Œå¾ˆå®¹æ˜“å¯¼è‡´è¯­ä¹‰é”™è¯¯ã€‚ æœ¬æ–‡æ˜¯ç¬¬ä¸€ä¸ªå°† DL ç»“åˆæ•°æ®åº“çš„ï¼Œå¼€å‘äº†æ–°çš„ NL2SQL é—®é¢˜ï¼Œå¯ä»¥æé«˜æ€§èƒ½ã€‚ CatSQL, is a deep learning-based approach, which can mitigate the issues of rule-based solutions to generalize across application domains. most existing deep learning approaches are based on a sequence-to-sequence or sequence-to-tree model . These methods do not guarantee the generated SQL queries are executable or even syntactically legal. Instead, our approach is a sketch-based solution, which relies on our novel CatSQL sketch to generate the SQL query. CatSQL sketch is a template with keywords and slots. These slots initially serve as placeholders. We use a deep learning model to fill in the empty slots to get a final SQL query, which is almost always a legal SQL query å®Œå½¢å¡«ç©ºï¼Ÿæ€»æ˜¯åˆæ³•çš„ SQL è¯­å¥ï¼Œé‚£è¯­ä¹‰èƒ½å¦ä¿è¯æ­£ç¡®å‘¢ï¼Œç»“æœæ€»æ˜¯æ­£ç¡®çš„å—ã€‚å¦‚æœç»“æœæ­£ç¡®ï¼Œæ€§èƒ½æ€ä¹ˆæ ·å‘¢ï¼ŸNL2SQL ä¼šä¸ä¼šçŸ¥é“ç´¢å¼•ï¼Œæˆ–è€…è¯´ä¼šä¸ä¼šç»“åˆ query optimization å‘¢ï¼Ÿ ä»¥å‰ä¹Ÿæœ‰ fill in slots çš„åšæ³•ï¼Œ sketch-based idea Our CatSQL SQL generation algorithm employs a novel CatSQL sketch, which is general enough, and can facilitate the idea of parameter sharing to boost the performance å¼ºè°ƒäº†æ›´åŠ  generalï¼Œè€Œä¸”å‚æ•°ä¹‹é—´å¯ä»¥å…±äº« ä»¥å‰çš„ DL æ²¡æœ‰ç»“åˆæ•°æ®åº“ä¿¡æ¯ï¼ŒCatSQL åšäº†è¯­ä¹‰çŸ«æ­£ï¼ŒTo the best of our knowledge, we are the first to incorporate semantic information into a deep learning-based NL2SQL solution. We evaluate our CatSQL approach on the well-known Spider dataset, and the results demonstrate that CatSQL is 4 points better than the previous state-of-the-art methods A novel sketch-based model CatSQL is proposed to achieve the state-of-the-art performance on various NL2SQL benchmarks; Semantics Correction of CatSQL is the first work that adopts database domain knowledge in a NL2SQL solution; Extensive evaluations demonstrate that CatSQL significantly outperforms all existing solutions on cross-domain benchmarks such as Spider and WikiSQL; On single-domain benchmarks, CatSQL solution also significantly outperforms existing solutions; CatSQL prototype achieves outstanding runtime performance: its single query runtime latency can be 2Ã—âˆ’20Ã— faster than all baselines; while its throughput can be 2.5Ã—âˆ’63Ã—higher than the previous approaches ä¸»è¦è´¡çŒ®ï¼ŒCatSQL æ–°æ–¹æ³•åŸºäº sketch-basedï¼Œè¯­ä¹‰çŸ«æ­£ï¼Œå¤§é‡æµ‹è¯•ï¼Œå•é¢†åŸŸå¤šé¢†åŸŸï¼Œè¿è¡Œæ—¶ã€ååé‡æ€§èƒ½æ›´å¥½ ","date":"2024-04-14","objectID":"/posts/catsql-nlsql/:3:0","tags":["Paper Reading"],"title":"Paper Reading: CatSQL: Towards Real World Natural Language to SQL Applications [VLDB 23]","uri":"/posts/catsql-nlsql/"},{"categories":null,"content":"OVERVIEW ","date":"2024-04-14","objectID":"/posts/catsql-nlsql/:4:0","tags":["Paper Reading"],"title":"Paper Reading: CatSQL: Towards Real World Natural Language to SQL Applications [VLDB 23]","uri":"/posts/catsql-nlsql/"},{"categories":null,"content":"Motivating Example The NL2SQL problem is to translate the natural language question into the corresponding SQL query. We need to figure out three challenging questions from the natural language description: (1) what tables and columns that will be used in the query; (2) what is the correct query structure; and (3) how to fill in query details and the literal in the query. è¡¨å’Œåˆ—ï¼Œquery ç»“æ„ï¼Œquery details å­—é¢é‡ã€‚ Solutions from the DB community requires designing rules for the mapping between natural language tokens into SQL elements, and translating a natural language parsing tree into a SQLâ€™s abstract syntax tree (AST). However, these approachesâ€™ performance decay significantly when they are applied to a new domain of database, that requires redesigning the mapping. rules éš¾ä»¥åº”å¯¹æ–°çš„ domainï¼Œæ–° domain æ˜¯ä»€ä¹ˆæ„æ€ï¼Œæ–°çš„è¡¨ï¼Ÿè¿˜æ˜¯æ–°çš„æ•°æ®ï¼Ÿ Deep Learning è®­ç»ƒå¤§æ¨¡å‹å¯ä»¥è§£å†³ cross-domain é—®é¢˜ï¼Œå¹¶ä¸”æ€§èƒ½å¾ˆå¥½ï¼Œä½†æ˜¯æ²¡æœ‰åˆ©ç”¨è¯­ä¹‰ä¿¡æ¯ç”ŸæˆæŸ¥è¯¢ï¼Œè€Œä¸”éš¾ä»¥å¤„ç†å¤æ‚æŸ¥è¯¢ï¼Œè€Œä¸”è¿è¡Œæ—¶æ€§èƒ½å’Œæ¨¡å‹å‚æ•°ã€å¤æ‚åº¦æœ‰å…³ã€‚è®­ç»ƒéœ€è¦å¾ˆå¤šè®¡ç®—ã€‚ æœ¬æ–‡ç»“åˆäº†è¿™ä¸¤ç§æ–¹æ³•ï¼Œand we demonstrate that our approach performs better than all existing solutions. Our approach employs a deep learning architecture, and we leverage DB domain knowledge to develop novel Semantics Correction techniques to postprocess the query generated by a neural network to fix obvious semantics errors. In the following, we will first provide necessary background on how a deep neural network NL2SQL solution works, and then we will give an overview of our approach. ","date":"2024-04-14","objectID":"/posts/catsql-nlsql/:4:1","tags":["Paper Reading"],"title":"Paper Reading: CatSQL: Towards Real World Natural Language to SQL Applications [VLDB 23]","uri":"/posts/catsql-nlsql/"},{"categories":null,"content":"Background Embedding: As an atomic operator, neural networks, such as LSTMs [18] and Transformers [41], can model a sequence of tokens into a sequence of ğ‘-dimensional numeric vectors called embedding è¿™é‡Œä¹Ÿæåˆ°äº† BERT, GraPPa æ˜¯å¦ä¸€ä¸ªè¡¨è¯­ä¹‰åˆ†æçš„é¢„è®­ç»ƒæ¨¡å‹ï¼Œåº”è¯¥æ˜¯ä¸“ç”¨äº SQL é¢†åŸŸçš„ã€è¡¨ç»“æ„çš„ã€‚æœäº†ä¸€ä¸‹æ‰çŸ¥é“ï¼Œä¹‹å‰æœ‰ä¸€ç¯‡ RatSQL å°±æ˜¯åˆ©ç”¨è‡ªæ³¨æ„åŠ›æœºåˆ¶æ¥åšçš„ï¼Œèƒ½çŸ¥é“å…³ç³»ï¼Œä¹Ÿå°±æ˜¯ Relation-Aware Text2SQL Classifier: Using this operator, we can build a classifier to classify the input sequence into one of ğ¶ categories as follows. Sequence-to-sequence translation: Training: åŸºç¡€çŸ¥è¯†ç•¥ ","date":"2024-04-14","objectID":"/posts/catsql-nlsql/:4:2","tags":["Paper Reading"],"title":"Paper Reading: CatSQL: Towards Real World Natural Language to SQL Applications [VLDB 23]","uri":"/posts/catsql-nlsql/"},{"categories":null,"content":"Existing NL2SQL Approaches (1) rule-based approaches; (2) sequence-to-sequence approaches; These approaches typically face the problem of picking a wrong column or a wrong value. Therefore, most of the efforts in these works are devoted to tackling this issue (3) sketch-based approaches. We will briefly explain the basic ideas below å…·ä½“ä»‹ç»ç•¥ï¼Œä½† rule-based å¯ä»¥å¤„ç†å¤æ‚ç»“æ„å’Œ queryï¼Ÿè€Œä¸” Sketch-based æ–¹æ³•å¹¶ä¸æ–°ï¼Œä»¥å‰ä¹Ÿæœ‰ï¼Œæ¯”å¦‚ SyntaxSQLNet å’Œ Sqlnetï¼Œåªä¸è¿‡å¯èƒ½æ²¡æœ‰ç»“åˆ RL æˆ–è€…æ²¡æœ‰åšå¾—é‚£ä¹ˆå¥½ã€‚CatSQL å¯èƒ½å°±æ˜¯åˆ©ç”¨ GraPPa åŠ ä¸Š Sketch-Based çš„ç»“åˆ ","date":"2024-04-14","objectID":"/posts/catsql-nlsql/:4:3","tags":["Paper Reading"],"title":"Paper Reading: CatSQL: Towards Real World Natural Language to SQL Applications [VLDB 23]","uri":"/posts/catsql-nlsql/"},{"categories":null,"content":"CATSQL APPROACH Column Action Templates ","date":"2024-04-14","objectID":"/posts/catsql-nlsql/:5:0","tags":["Paper Reading"],"title":"Paper Reading: CatSQL: Towards Real World Natural Language to SQL Applications [VLDB 23]","uri":"/posts/catsql-nlsql/"},{"categories":null,"content":"CatSQL template The definition of the CatSQL template is designed to facilitate the idea of parameter sharing, which is not adapted by previous sketch-based approaches. In particular, since each of the four CAT clauses can be viewed as a sequence of CATs, we can train one sequence-to-sequence model for all four different clauses. At runtime, once the CATs are predicted, we can simply construct the final SQL query by assembling different CAT clauses. We will explain how our neural network fills a CatSQL sketch in the next section parameter sharing è¿™ä¸ªæ¦‚å¿µä¸å¤ªç†è§£ï¼Œå¦‚æœè¯´å¡«ç©ºä¹‹é—´æœ‰è”ç³»ï¼Œèƒ½ä¸èƒ½ç”¨å¾®è°ƒåçš„æ¨¡å‹ï¼Œåšä¸€ä¸ªä¸Šä¸‹æ–‡é¢„æµ‹ï¼Ÿ ","date":"2024-04-14","objectID":"/posts/catsql-nlsql/:5:1","tags":["Paper Reading"],"title":"Paper Reading: CatSQL: Towards Real World Natural Language to SQL Applications [VLDB 23]","uri":"/posts/catsql-nlsql/"},{"categories":null,"content":"CatSQL query generation the overall architecture of CatSQL is composed of four components, namely GraPPa embedding network, CAT decoder network, conjunction network, and FROM decoder network. We now explain each of these components å°±æ˜¯ç”¨ GraPPa å®ç°äº† parameter sharingï¼Œçœ‹æ¥æœ¬è´¨è¿˜æ˜¯ä¸Šä¸‹æ–‡é¢„æµ‹ã€‚æƒ³çŸ¥é“å’Œ CatSQL çš„åŒºåˆ«åœ¨å“ªå‘¢ï¼Ÿ ","date":"2024-04-14","objectID":"/posts/catsql-nlsql/:5:2","tags":["Paper Reading"],"title":"Paper Reading: CatSQL: Towards Real World Natural Language to SQL Applications [VLDB 23]","uri":"/posts/catsql-nlsql/"},{"categories":null,"content":"Semantics Correction Semantics Correction technique significantly improves the accuracy by leveraging database domain knowledge. While a deep learning model is effective in understanding the intention of a question, sometimes the generated SQL query expresses the same intention, but is semantically invalid considering the database schema. å¦‚æœå’Œ CatSQL + GraPPa åŒºåˆ«ä¸å¤§ï¼Œæ˜¯ä¸æ˜¯è¯­ä¹‰çŸ«æ­£æé«˜äº†æ›´å¤šçš„å‡†ç¡®æ€§ å¦‚æœè¯´ ChatGPT ç”Ÿæˆçš„ SQL è´¨é‡è¾ƒå¥½ï¼Œæ˜¯å› ä¸º RLHF å—ï¼Ÿ We classify our Semantics Correction rules into three categories: (1) token-level violation, (2) FROM clause revision, and (3) join-path revision. æœ‰ä¸‰ä¸ªç±»å‹å¯ä»¥ä¿®æ­£ï¼Œæ˜¯ best-effort è€Œä¸æ˜¯ä¿è¯å¯ä»¥çš„ï¼Œä¹Ÿä¸ä¼šæŠŠå¯¹çš„å†™æˆé”™çš„ token-level violation çœ‹ä¸Šå»æ˜¯æ˜¯ç±»å‹æ£€æŸ¥ FROM clause revision æœ‰æ—¶å€™ query ä¼šå‡ºç°ä¸€äº›æ²¡å‡ºç°è¿‡çš„ column æ¯”å¦‚ FROM é‡Œæ²¡å‡ºç°è¿‡çš„ï¼Œæ­¤æ—¶ä¼šç›´æ¥åŠ åˆ° FROM é‡Œï¼Ÿç”¨æœ€å°ç”Ÿæˆæ ‘æ¥åˆ¤æ–­è¿™äº› JOIN æƒ…å†µã€‚ join-path revision æœ‰æ—¶å€™ join ä¼šå¤±è´¥ ","date":"2024-04-14","objectID":"/posts/catsql-nlsql/:5:3","tags":["Paper Reading"],"title":"Paper Reading: CatSQL: Towards Real World Natural Language to SQL Applications [VLDB 23]","uri":"/posts/catsql-nlsql/"},{"categories":null,"content":"SYSTEM IMPLEMENTATION åŸºäº MySQL v5.7.30 Offline processing. ç¦»çº¿é¢„å¤„ç†ï¼Œæ¨¡å‹è®­ç»ƒã€‚ç”šè‡³ç”¨äº† redis å­˜å‚¨ literals to embedding (word2vec è€Œä¸æ˜¯ BERT çš„åŸå› æ˜¯æ›´å¿«) Online serving. åœ¨çº¿æ¨ç†ï¼Œç”±äºæ„å»ºäº†åç«¯ï¼Œå¥½åƒå¯ä»¥å¹¶è¡ŒåŒ–ï¼ˆååé‡çš„ç”±æ¥ï¼Ÿï¼‰ Model details: ","date":"2024-04-14","objectID":"/posts/catsql-nlsql/:6:0","tags":["Paper Reading"],"title":"Paper Reading: CatSQL: Towards Real World Natural Language to SQL Applications [VLDB 23]","uri":"/posts/catsql-nlsql/"},{"categories":null,"content":"EXPERIMENTS accuracy, running speed, throughput ","date":"2024-04-14","objectID":"/posts/catsql-nlsql/:7:0","tags":["Paper Reading"],"title":"Paper Reading: CatSQL: Towards Real World Natural Language to SQL Applications [VLDB 23]","uri":"/posts/catsql-nlsql/"},{"categories":null,"content":"Benchmarks and Baselines Dataset: cross-domain: WikiSQL, Spider å…·æœ‰å¤§é‡çš„ queries, tables å’Œ databases single-domain: GeoQuery, Scholar, IMDBâ€¦ Spider is considered as the hardest NL2SQL dataset currently. Spider supports much richer SQL syntax, and it classifies the dataset into four categories based on their hardness levels Evaluation metrics: accuracy (i.e., Accex ). è¯­ä¹‰ä¸Šæ­£ç¡®çš„ SQLï¼Ÿè¿˜æ˜¯ç»“æœä¸€è‡´ï¼Ÿ logical form accuracy (i.e., Acclf ). å®Œå…¨ä¸€è‡´çš„ SQLï¼Ÿ executable rate: æœ¬æ–‡æå‡ºçš„ Baseline approaches: æ–‡ç« é€‰äº† RAT-SQLï¼Œä½†æ˜¯æ˜¯ç”¨ GraPPa é¢„è®­ç»ƒçš„ï¼Œè€Œ NatSQL å’Œ SmBoP é€‰çš„æ˜¯ GraPPa ä¸è®­ç»ƒçš„ ","date":"2024-04-14","objectID":"/posts/catsql-nlsql/:7:1","tags":["Paper Reading"],"title":"Paper Reading: CatSQL: Towards Real World Natural Language to SQL Applications [VLDB 23]","uri":"/posts/catsql-nlsql/"},{"categories":null,"content":"Cross-Domain Evaluation Results åˆ†åˆ«æµ‹è¯•äº†æ²¡æœ‰ parameter sharing çš„ï¼Œæ²¡æœ‰ semantic correction çš„ï¼Œå®Œæ•´çš„ï¼Œ åœ¨ Spider ä¸Šè¡¨ç°éå¸¸å¥½ï¼Œå‡ ä¹å„é¡¹éƒ½æ˜¯ç¬¬ä¸€ï¼Œæ²¡æœ‰ parameter sharing çš„æ•°æ®éƒ½æŒºå¥½ä½†çœ‹ä¸Šå» SC çš„æå‡åœ¨ easy æå‡å¾ˆæ˜æ˜¾ï¼Œä½† Extra Hard å°±æå‡æ²¡é‚£ä¹ˆå¤šã€‚ è€Œä¸”å¯æ‰§è¡Œçš„æ¦‚ç‡ä¹Ÿç‰¹åˆ«é«˜ï¼Œé™¤éæ²¡æœ‰è¯­ä¹‰çŸ«æ­£ï¼Œéƒ½æ˜¯ 100% è®ºæ–‡æåˆ° not designed for logical form accuracyï¼Ÿ è¿è¡Œé€Ÿåº¦ä¹Ÿå¾ˆå¿«ï¼Œååé‡ä¹Ÿå¾ˆå¤§ã€‚ ","date":"2024-04-14","objectID":"/posts/catsql-nlsql/:7:2","tags":["Paper Reading"],"title":"Paper Reading: CatSQL: Towards Real World Natural Language to SQL Applications [VLDB 23]","uri":"/posts/catsql-nlsql/"},{"categories":null,"content":"Single-Domain Evaluation Results æ¯” rule based ä¹Ÿè¦å¥½ï¼Œä½†æ˜¯åœ¨ IMDB ä¸Šè¡¨ç°æ¯”è¾ƒå·®ï¼Œä½†ä¹Ÿæ¯”å…¶ä»–éƒ½å¥½ ä½¿ç”¨çš„æ˜¯ Spider æ•°æ®è®­ç»ƒï¼Œåœ¨ IMDB ä¸Šè¡¨ç°å·®æ˜¯å› ä¸ºå¾ˆå¤š join rules ä¸å¤ªé€‚ç”¨ï¼Ÿ ","date":"2024-04-14","objectID":"/posts/catsql-nlsql/:7:3","tags":["Paper Reading"],"title":"Paper Reading: CatSQL: Towards Real World Natural Language to SQL Applications [VLDB 23]","uri":"/posts/catsql-nlsql/"},{"categories":null,"content":"Throughput analysis ååé‡é«˜çš„åŸå› ï¼Œç”¨äº†å°çš„æ¨¡å‹ GraPPaï¼Œæ‰€ä»¥ä¹Ÿæ›´å¿«ã€‚è€Œä¸”åœ¨ decoding æ—¶ï¼Œä¸€ä¸ª CAT ç”Ÿæˆä¸€ç»„ slotsï¼Œå¯ä»¥å¤§å¹…å¹¶è¡Œã€‚å¯ä»¥å¹¶è¡Œå¤„ç† 11 ä¸ªæŸ¥è¯¢ï¼Œ ","date":"2024-04-14","objectID":"/posts/catsql-nlsql/:7:4","tags":["Paper Reading"],"title":"Paper Reading: CatSQL: Towards Real World Natural Language to SQL Applications [VLDB 23]","uri":"/posts/catsql-nlsql/"},{"categories":null,"content":"Case Study åˆ†æäº†å‡ ä¸ªç”¨ä¾‹ï¼Œæ¯”è¾ƒæœ‰è¶£çš„æ˜¯æ²¡æ³•ç”Ÿæˆ AVG() è¿™ç§ï¼Œè€Œæ˜¯ç›´æ¥ select averageï¼Œä½†æ˜¯è¡¨å¸¦æœ‰ average åˆ—ï¼Ÿ è¿˜æœ‰å°±æ˜¯ Column Action Template ä¼š flatten conjunction å…³ç³» å¯¼è‡´æ— æ³•ç”Ÿæˆåˆé€‚çš„ SQL æ¥é€‰å– OR å…³ç³»ã€‚ è®ºæ–‡è®¤ä¸ºå¯ä»¥å¤šè®­ç»ƒ This problem could be possibly handled by either collecting more training data containing queries with complex conjunction relationships, or designing new architecture to predict logical operations explicitly. Both approaches are challenging to implement and require high-quality manual labels. We leave this issue as a further research to study å¤šè®­ç»ƒæ˜¯åˆç†çš„ï¼Œä¸çŸ¥é“å¾®è°ƒ GraPPa èƒ½ä¸èƒ½é¢„æµ‹ä¸€äº› conjunction å…³ç³» ","date":"2024-04-14","objectID":"/posts/catsql-nlsql/:7:5","tags":["Paper Reading"],"title":"Paper Reading: CatSQL: Towards Real World Natural Language to SQL Applications [VLDB 23]","uri":"/posts/catsql-nlsql/"},{"categories":null,"content":"RELATED WORK æåˆ°äº† GraPPa éå¸¸æœ‰ç”¨ ","date":"2024-04-14","objectID":"/posts/catsql-nlsql/:8:0","tags":["Paper Reading"],"title":"Paper Reading: CatSQL: Towards Real World Natural Language to SQL Applications [VLDB 23]","uri":"/posts/catsql-nlsql/"},{"categories":null,"content":"CONCLUSION ç•¥ åå­—éå¸¸å¥½ç©ï¼Œä» RatSQL åˆ° CatSQLï¼Œä½†å®é™…ä¸Šè®ºæ–‡æ²¡æœ‰å¤ªå¤šæ¯”è¾ƒ RatSQL ç”šè‡³ RatSQL åªç”¨äº† BERT æ¥ä½œä¸º baseline ä¹Ÿéå¸¸åˆ›æ–°åœ°åˆ©ç”¨ RL ä»ç¿»è¯‘å˜æˆäº†å®Œå½¢å¡«ç©ºï¼Œè€Œä¸”ç”¨ LLM å¯ä»¥é¢„æµ‹ä¸Šä¸‹æ–‡çš„èƒ½åŠ›è¿›è¡Œå…³è”ï¼Œéå¸¸å·§å¦™ è€Œä¸”ç”¨ Semantic Correction å¯ä»¥åå¤„ç†è¿™äº›å¯èƒ½é”™è¯¯çš„è¯­ä¹‰ï¼Œåªæ˜¯è¿˜æœ‰ä¸€äº›ç¼ºé™·ï¼Œæ–‡ä¸­ä¹Ÿè¯´è®­ç»ƒä¹Ÿå¯èƒ½å¯ä»¥è§£å†³ã€‚ çœ‹äº†ä¸‹ç›®å‰ CatSQL 78 åˆ† Accğ‘’ğ‘¥ å¹¶ä¸ç®—é«˜çš„ï¼Œé˜¿é‡Œåé¢çš„ DAIL-SQL + GPT-4 å’Œ DAIL-SQL + GPT-4 + Self-Consistency åˆ·åˆ°äº† 86 åˆ†ã€‚ç”šè‡³æœ‰åŒ¿åçš„ MiniSeek åˆ·åˆ°äº† 91 åˆ†ï¼Œå¯èƒ½ GPT å‚æ•°æ›´å¤§ï¼Œè¿˜æ˜¯è¦æ›´å¼ºå§ã€‚ åŒæ—¶æœ€è¿‘è¿˜æœ‰æ–°çš„ benchmark BIRD-SQL æ˜¯é˜¿é‡Œå’Œæ¸¯å¤§ä¸€èµ·æ¨å‡ºçš„ï¼Œ Summarize The paper propose a novel framework called CatSQL, which tackles the challenge of translating natural language questions into SQL queries. While existing systems like rule-based and deep-learning-based cannot handle cross-domain datasets or donot use the database information, CatSQL creatively combines two approaches. CatSQL leverages the contextual prediction capabilities of language models such as GraPPa to enable parameter sharing based on a sketch-based method and can generate more accurate SQL statements with semantics correction. In addition, CatSQL not only exhibits better accuracy, it is also faster and has greater throughput. Contributions: CatSQL innovatively bridges two existing Text-to-SQL approaches (deep-learning and rule-based) and overcomes their problems, for example, rule-based emthods are almost exclusively used for single-domain datasets. CatSQL also turns the existing Deep Learning translation task into a filling task with faster runtime and higher throughput. CatSQL applies sketches to construct a SQL statement template with slots and placeholders, and then uses deep learning model like GraPPa to fill the slots with meaningful content based on the database schema. The method is called parameter sharing and can reduce the computational complexity and improve generalization capability and flexibility. The paper proposes a semantic correction technique to identify and correct semantic errors in the generated SQL queries with database domain knowledge. The method can detect erros on token level, FROM clause level and join-path level, improving the exact set match accuracy and obtaining a significant improvement over baseline models (RAT-SQL with BERT model). Limitations: CatSQL would be very dependent on the performance of deep learning models, although the paper compares Rat-SQL, which is using the BERT model. If the GraPPa model is also used, RAT-SQL as a baseline will also perform better. And from the current Spider Leader Board, the front runners are using larger models like GPT-4, and the score is much higher than CatSQL, at 86 (DAIL-SQL + GPT-4). The paper says that CatSQL doesnâ€™t focus on accuracy, but no attempt is made to solve the problems encountered in the Case Study such as conjunction and column name confusion by more training, or by switching to a larger model. The method Semantic correction is post-processed and could be improved if it can be performed when reasoning or generating SQL statements. In addition, when new benchmarks come out, such as BIRD, which can better evaluate a modelâ€™s ability to work across data domains, and CatSQL might need to be retrained to achieve better performance. Improve: This paper is very innovative and methodologically sound. I might try to replace the language model with a larger one at first, possibly with more parameters capable of stronger context and parameter sharing. And I may do more model training to try to solve the problems in cast study, especially conjunction errors and semantic obfuscation. In addition, perhaps the ChatGPT fine-tuning approach, or Reinforcement Learning Human Feedback (RLHF) could also help CatSQL to achieve higher accuracy. Finally, I would try to run the modified model on more benchmarks for evaluation, especially on the BIRD benchmark. ","date":"2024-04-14","objectID":"/posts/catsql-nlsql/:9:0","tags":["Paper Reading"],"title":"Paper Reading: CatSQL: Towards Real World Natural Language to SQL Applications [VLDB 23]","uri":"/posts/catsql-nlsql/"},{"categories":null,"content":"The Case for a Learned Sorting Algorithm é™¤äº† Query Optimization, Index, Tunning, ML è¿˜å¯ä»¥ç”¨åœ¨ Database å…¶ä»–æ–¹é¢ï¼Œæ¯”å¦‚æ’åºï¼Ÿ è®ºæ–‡ä½œè€…ä¸­çš„ Tim Kraska ä»¥åŠå…¶å›¢é˜Ÿï¼Œæ˜¯ SageDB, Bao: Learned Query Optimization, Neo çš„ä½œè€…ï¼Œæ­¤å¤–è¿˜æœ‰ FITing-Tree ç´¢å¼•ç»“æ„ã€‚ çœ‹äº†ä¸€ä¸‹ Tim é™¤äº†åœ¨ MIT å½“ APï¼Œè¿˜åœ¨ä¸€å®¶å« Einblick çš„å…¬å¸åˆ›ä¸šï¼ˆçœ‹äº†ä¸‹å¥½åƒæ˜¯ text2SQL ç±»å‹çš„ï¼Œåº”è¯¥å·²ç»è¢« Databricks æ”¶è´­äº†ï¼‰ï¼Œç„¶ååœ¨ Amazon ç ”ç©¶ Data Science å’Œ AI çš„ç»“åˆï¼Ÿæœ€è¿‘ä¹Ÿæœ‰ä¸€äº›æ¯”å¦‚ 2023 çš„ BRAD: simplifying cloud data processing with learned automated data meshes å’Œä¹‹å‰çœ‹çš„ SEED: Domain-specific data curation with large language models ä¹Ÿæ˜¯ Tim å›¢é˜Ÿçš„ï¼Œä»–ä»¬åšäº†å¾ˆå¤š AI ä¸æ•°æ®åº“ã€æ•°æ®ã€æ•°æ®ç»“æ„ã€æ•°æ®å¤„ç†ç»“åˆçš„äº‹æƒ…ã€‚ å›åˆ°æœ¬ç¯‡ï¼ŒML æ’åºå’Œ Query Optimization çš„æ€è·¯å·®ä¸å¤šï¼Œæ¯”è¾ƒé‡è¦çš„ä¸€ç‚¹éƒ½æ˜¯éœ€è¦ ML å­¦ä¹ æ•°æ®çš„åˆ†å¸ƒå‡½æ•°ï¼šcumulative distribution function (CDF)ï¼Œä¹Ÿæ˜¯ SageDB å½“ä¸­é‡è¦çš„ä¸€ç‚¹ã€‚ ","date":"2024-04-12","objectID":"/posts/learned-sorting/:1:0","tags":["Paper Reading"],"title":"Paper Reading: The Case for a Learned Sorting Algorithm [SIGMOD 2020]","uri":"/posts/learned-sorting/"},{"categories":null,"content":"ABSTRACT Sorting is one of the most fundamental algorithms in Computer Science and a common operation in databases not just for sorting query results but also as part of joins (i.e., sort merge-join) or indexing. In this work, we introduce a new type of distribution sort that leverages a learned model of the empirical CDF of the data. Our algorithm uses a model to efficiently get an approximation of the scaled empirical CDF for each record key and map it to the corresponding position in the output array. We then apply a deterministic sorting algorithm that works well on nearly-sorted arrays (e.g., Insertion Sort) to establish a totally sorted order. leverages a learned model of the empirical CDF of the data çœ‹ä¸Šå»æ˜¯å…ˆæ˜ å°„/åˆ†åŒºï¼Œç„¶åç”¨æ’å…¥æ’åºåœ¨å‡ ä¹æœ‰åºçš„æ•°ç»„ä¸Šæ’åºï¼Œé€Ÿåº¦åº”è¯¥æ˜¯å¾ˆå¿«çš„ã€‚å’Œ C++ STL sort æ€æƒ³ä¹Ÿå·®ä¸å¤šï¼Œè¿‘ä¹æœ‰åºå°±ç›´æ¥æ’å…¥æ’åºï¼ˆå½“å¿«é€Ÿæ’åºé€’å½’å­åŒºé—´è¶³å¤Ÿå°çš„æ—¶å€™ï¼Œæ’å…¥æ’åºï¼‰ We compared this algorithm against common sorting approaches and measured its performance for up to 1 billion normally-distributed double-precision keys. The results show that our approach yields an average 3.38Ã— performance improvement over C++ STL sort, which is an optimized Quicksort hybrid, 1.49Ã— improvement over sequential Radix Sort, and 5.54Ã— improvement over a C++ implementation of Timsort, which is the default sorting function for Java and Python. å®é™…ä¸Š C++ STL sort åˆå« Introsortï¼Œä¹Ÿå°±æ˜¯ Hybrid Quicksortï¼Œæ²¡æœ‰ç¨³å®šæ€§ã€‚è€Œ TimSort æ˜¯ä¿æŒç¨³å®šæ€§çš„å½’å¹¶å’Œæ’å…¥æ··åˆæ’åºã€‚ å‰ä¸¤å¹´å‡ºç°äº†ä¸€ä¸ªæ›´å¿«çš„ pdqsortï¼ŒRust å’Œ Go ä¹Ÿå°†å…¶å¼•å…¥äº†æ ‡å‡†åº“ã€‚ä¸»è¦æ€æƒ³ä¹Ÿæ˜¯æ‹†åˆ†æˆå‡ ç§æƒ…å†µï¼Œæ­£å¸¸ quicksortï¼ŒçŸ­çš„è¿‘ä¼¼æœ‰åºçš„ç”¨ insertion sort æœ€åæƒ…å†µç”¨ heapsort ä¿è¯æœ€å nlogn æ—¶é—´å¤æ‚åº¦ã€‚ä½†æ˜æ˜¾ pdqsort ä¹Ÿæ˜¯ä¸ç¨³å®šçš„ã€‚ radix sort å°±æ˜¯åŸºæ•°æ’åºï¼ŒæŒ‰ç…§æ•°ä½ä»ä½åˆ°é«˜ / ä»é«˜åˆ°ä½æ’åºã€‚ä¸ä»…æ•´æ•°ä¹Ÿæ”¯æŒæµ®ç‚¹æ•°ã€‚ ","date":"2024-04-12","objectID":"/posts/learned-sorting/:2:0","tags":["Paper Reading"],"title":"Paper Reading: The Case for a Learned Sorting Algorithm [SIGMOD 2020]","uri":"/posts/learned-sorting/"},{"categories":null,"content":"INTRODUCTION å¯¹æ¯”äº† radix sort ï¼ˆæŒ‰ key æ’åºï¼‰å’Œæ¯”è¾ƒæ’åºï¼Œæå‡ºç”¨ Tim å›¢é˜Ÿåœ¨ SageDB ä¸­çš„ä¸€ä¸ªæƒ³æ³•ï¼š ML å¢å¼ºæ’åºç®—æ³•ã€‚ æ ¸å¿ƒæ€æƒ³ï¼šwe train a CDF model $F$ over a small sample of keys $A$ and then use the model to predict the position of each key in the sorted output. If we would be able to train the perfect model of the empirical CDF, we could use the predicted probability $P$ ($A â‰¤ x$) for a key x, scaled to the number of keys $N$, to predict the final position for every key in the sorted output: $pos = FA(x) Â· N =P (A â‰¤ x ) Â· N$ . Assuming the model already exists, this would allow us to sort the data with only one pass over the input, in $O(N)$ time è¿˜æ˜¯ä¸€ä¸ªå¼ºå‰æï¼Œå¿…é¡»è®­ç»ƒä¸€ä¸ªå®Œç¾çš„ CDF modelï¼Œå…ˆä¸è¯´è®­ç»ƒæ—¶é—´ï¼Œè®­ç»ƒç²¾åº¦èƒ½å¦æ‹Ÿåˆéƒ½æ˜¯ä¸ªé—®é¢˜ Obviously, several challenges exists with this approach. Most importantly, it is unlikely that we can build a perfect empirical model. Furthermore, state-of-the-art approaches to model the CDF, in particular NN, would be overly expensive to train and execute. More surprising though, even with a perfect model the sorting time might be slower than a highly optimized Radix Sort algorithm. Radix Sort can be implemented to only use sequential writes, whereas a naÃ¯ve ML-enhanced sorting algorithm as the one we outlined in [28] creates a lot of random writes to place the data directly into its sorted order è‡ªå·±ä¹Ÿæå‡ºäº†é—®é¢˜ï¼šperfect empirical model å®Œç¾çš„ç»éªŒæ¨¡å‹æ˜¯ä¸å­˜åœ¨çš„ã€‚è®­ç»ƒæ–¹æ³• NN ä¹Ÿæ¯”è¾ƒæ˜‚è´µï¼Ÿè€Œä¸”å°±ç®—å®Œç¾çš„ CDF æ¨¡å‹ï¼Œä¹Ÿå¯èƒ½æ¯” radix sort æ…¢ã€‚ä½†ä¸å¤ªæ‡‚ä»€ä¹ˆæ˜¯ highly optimized radix sortï¼Œæ˜¯åªæœ‰é¡ºåºå†™çš„å—ï¼Ÿè€Œ ML sort å¯èƒ½ä¼šäº§ç”Ÿè®¸å¤šéšæœºå†™å…¥ï¼Œå¯¼è‡´æœ‰å¾ˆå¤š IO ä»£ä»·ï¼Ÿä¸çŸ¥é“æ˜¯ä¸æ˜¯ SageDB é‡åˆ°çš„é—®é¢˜ã€‚ æœ¬æ–‡æå‡ºäº† Learned Sortï¼Œsequential ML-enhanced sorting algorithm æ¥è§£å†³è¿™äº›é—®é¢˜ã€‚æ­¤å¤–è¿˜æœ‰ a fast training and inference algorithm for CDF modeling. æœ¬æ–‡åº”è¯¥æ˜¯ç¬¬ä¸€ç¯‡ cache-efficient ML-enhanced sorting algorithm which does not suffer from the random access problem. We propose a first ML-enhanced sorting algorithm, called Learned Sort, which leverages simple ML models to model the empirical CDF to significantly speed-up a new variant of Radix Sort We theoretically analyze our sorting algorithm We exhaustively evaluate Learned Sort over various synthetic and real-world datasets ","date":"2024-04-12","objectID":"/posts/learned-sorting/:3:0","tags":["Paper Reading"],"title":"Paper Reading: The Case for a Learned Sorting Algorithm [SIGMOD 2020]","uri":"/posts/learned-sorting/"},{"categories":null,"content":"LEARNING TO SORT NUMBERS pdf: æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼Œè¿ç»­éšæœºå˜é‡ã€‚CDF: ç´¯ç§¯åˆ†å¸ƒå‡½æ•°ï¼Œåˆ†å¸ƒå‡½æ•°ï¼Œæ¦‚ç‡å¯†åº¦å‡½æ•°çš„ç§¯åˆ†ï¼Œèƒ½æè¿°ä¸€ä¸ªéšæœºå˜é‡ x çš„æ¦‚ç‡åˆ†å¸ƒã€‚ é«˜æ–¯åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°å¾ˆå¸¸è§ï¼Œå®ƒçš„ç´¯ç§¯åˆ†å¸ƒå‡½æ•°ï¼Œå–ç§¯åˆ†åå°±æ˜¯ 0 åˆ° 1 å¾ˆåƒ sin å‡½æ•°ï¼Œæ˜¯ä¸¥æ ¼é€’å¢çš„ é€šè¿‡ CDF èƒ½çŸ¥é“ä¸€ä¸ªæ•°æ®å¤§æ¦‚åœ¨ä»€ä¹ˆåŒºé—´çš„æ¦‚ç‡ï¼Œä¹˜ä¸Šé•¿åº¦å°±å¯ä»¥çŸ¥é“ä½ç½®ï¼Œæœ€åæ•°ç»„å°±æ˜¯æ¥è¿‘æœ‰åºçš„ Given a function FA(x), which returns the exact empirical CDF value for each key x âˆˆ A, we can sort A by calculating the position of each key within the sorted order as pos â† FA(x )Â· |A|. This would allow us to sort a dataset with a single pass over the data as visualized in Figure 1 ä½†ä¸å¯èƒ½ä¼šæœ‰å®Œç¾çš„ CDF å‡½æ•°ï¼Œè€Œä¸”ä¹Ÿåªèƒ½é€‰å–æ•°æ®ä¸­çš„ä¸€äº›æ ·æœ¬æ¥è®­ç»ƒæ¨¡å‹ï¼Œè€Œä¸”æ•°æ®ä¼šæœ‰é‡å¤ã€‚ è®¨è®ºäº† out-of-place å’Œ in-place ä¸¤ç§ï¼Ÿ çœ‹ä¸Šå»è¿˜éœ€è¦é¢å¤–çš„è¾…åŠ©ç©ºé—´ ","date":"2024-04-12","objectID":"/posts/learned-sorting/:4:0","tags":["Paper Reading"],"title":"Paper Reading: The Case for a Learned Sorting Algorithm [SIGMOD 2020]","uri":"/posts/learned-sorting/"},{"categories":null,"content":"Sorting with imprecise models duplicate keys and imprecise models may lead to the mapping of multiple keys to the same output position in the sorted array. Moreover, some models (e.g., NN or even the Recursive Model Index (RMI) [29]) may not be able to guarantee monotonicity, creating small misplacements in the output. That is, for two keys a and b with $a \u003c b$ the CDF value of a might be greater than the one of $b (F (a) \u003eF (b))$, thus, causing the output to not be entirely sorted. å¦‚ä½•è§£å†³é‡å¤é”®ã€ä¸ç²¾ç¡®æ¨¡å‹çš„é—®é¢˜ï¼Ÿ æ­¤å¤–æ¨¡å‹è¿˜å¯èƒ½ä¸æ˜¯å•è°ƒçš„ æ‰€ä»¥å¦‚æœä½ç½®å‘ç”Ÿç¢°æ’ collisionsï¼Œå’Œå“ˆå¸Œæ–¹æ³•ä¸€æ ·é‡‡ç”¨äº† Linear probing, Chaining, Spill bucket ç­‰æ–¹æ³•æ¥è§£å†³å†²çªã€‚ Linear Probing ä¼šå¯¼è‡´é”™çš„é”®è¶Šæ¥è¶Šå¤šï¼Œå°¤å…¶æ˜¯éå•è°ƒçš„æ—¶å€™ã€‚å…¶ä»–æ–¹æ³•ä¼šå¢åŠ ç©ºé—´å¼€é”€ï¼Œæ¯”å¦‚ spill bucket ç”¨æ–°çš„æ¡¶å­˜ï¼Œåˆ™éœ€è¦å•ç‹¬å½’å¹¶ã€‚ è®ºæ–‡éƒ½é‡‡ç”¨äº† spill bucket çš„æ–¹æ³•ï¼Œå¯¹äºéå•è°ƒçš„æƒ…å†µï¼Œç”¨æ’å…¥æ’åºæ¥è§£å†³é—®é¢˜ã€‚ the expected number of collisions depends on how well the model overfits to the observed data. è¯´äº†ä¸€å †ï¼Œå°±æ˜¯ç¢°æ’çš„æ¦‚ç‡è¿˜æ˜¯å¾ˆé«˜ï¼Œé™¤éæ˜¯å®Œç¾çš„ CDFï¼Œä½†æ˜¯æœ‰éœ€è¦å‡å°‘è®­ç»ƒæ—¶é—´ï¼Œè€Œä¸”åªèƒ½æŠ½å–æ ·æœ¬è®­ç»ƒï¼Œæ²¡æ³•å­¦åˆ°å®Œç¾çš„ CDF ä½¿ç”¨äº†é¢å¤–çš„è¾…åŠ©ç©ºé—´è§£å†³ collisionã€‚ å°±ç®—å®Œç¾ CDF ä¹Ÿæ¯” Radix æ…¢ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ è¿™ä¸€éƒ¨åˆ†åˆ†æè¯´è®¤ä¸ºæ˜¯éšæœºè®¿é—®å¯¼è‡´äº† CPU cache å’Œ TLB å±€éƒ¨æ€§å¤±æ•ˆï¼Œè€Œ radix æ˜¯é¡ºåºå†™å…¥çš„ï¼Œèƒ½å¤Ÿåˆ©ç”¨ç¼“å­˜å’Œå±€éƒ¨æ€§ã€‚æ‰€ä»¥æœ¬æ–‡è¿˜æå‡ºäº†åˆ©ç”¨ç¼“å­˜çš„ ML-enhanced ç®—æ³• ","date":"2024-04-12","objectID":"/posts/learned-sorting/:4:1","tags":["Paper Reading"],"title":"Paper Reading: The Case for a Learned Sorting Algorithm [SIGMOD 2020]","uri":"/posts/learned-sorting/"},{"categories":null,"content":"Cache-optimized learned sorting å…¶å® ML sort å’Œ Radix å¾ˆåƒï¼Œéƒ½æ˜¯ bitmap ç±»å‹çš„ï¼Œè®ºæ–‡ä¹Ÿæåˆ°å¦‚æœ the number of elements to sort is close to the key domain size (e.g., 23^2 for 32-bit keys) å°±æ˜¯å‡ ä¹ä¸€è‡´çš„ã€‚ æ‰€ä»¥ä¸»è¦æ˜¯å’Œ radix æ¯”è¾ƒï¼Ÿ radix é€Ÿåº¦å–å†³äº key domain sizeï¼Œè€Œå½“å…ƒç´ æ•°é‡è¿œå°äº key domain size æ—¶ï¼ŒLearned Sort é€Ÿåº¦ä¹Ÿæ¯” radix å¿«å¾ˆå¤šã€‚ We organize the input array into logical buckets. That is, instead of predicting an exact position, the model only has to predict a bucket index for each element, which reduces the number of collisions as explained earlier. Step 1: For cache efficiency, we start with a few large buckets and recursively split them into smaller ones. By carefully choosing the fan-out ( f ) per iteration, we can ensure that at least one cache-line per bucket fits into the cache, hence transforming the memory access pattern into a more sequential one. This recursion repeats until the buckets become as small as a preset threshold t . Section 3.1 explains how f and t should be set based on the CPU cache size. Step 2: When the buckets reach capacity t , we use the CDF model to predict the exact position for each element within the bucket. Step 3: Afterwards we take the now sorted buckets and merge them into one sorted array. If we use a non-monotonic model, we also correct any sorting mistakes using Insertion Sort. Step 4: The buckets are of fixed capacity, which minimizes the cost of dynamic memory allocation. However, if a bucket becomes full, the additional keys are placed into a separate spill bucket array (see Figure 4 the â€œSâ€bucket symbol). As a last step, the spill bucket has to be sorted and merged. The overhead of this operation is low as long as the model is capable of evenly distributing the keys to buckets. cache-optimized learned sort æœ‰å‡ ä¸ªä¼˜åŒ–ï¼š1. é¢„æµ‹æ¡¶çš„ä½ç½®ï¼Œé¿å…ç¢°æ’ 2. ä¸ºäº†æé«˜ç¼“å­˜æ•ˆç‡ï¼Œé‡‡ç”¨å‡ ä¸ªå¤§çš„æ¡¶ï¼Œåˆ†æˆå°çš„æ¡¶ï¼Œé€‰æ‹©ä¸€ä¸ª fan-out f å‡½æ•°ï¼Ÿ 3. æ¡¶è¾¾åˆ°å®¹é‡æ—¶ï¼Œç”¨ CDF æ¨¡å‹é¢„æµ‹ä½ç½® 4. å¦‚æœç”¨éå•è°ƒæ¨¡å‹ï¼Œç”¨æ’å…¥æ’åºä¿®æ­£ 5. å°æ¡¶å®¹é‡å›ºå®šï¼Œè¿˜æœ‰æº¢å‡º spill bucket è¿˜æ˜¯è¦ä¿è¯ CDF çš„æ‹Ÿåˆç¨‹åº¦ï¼Œä»¥åŠåˆ†å¸ƒçš„å‡åŒ€æ€§ ç®—æ³•ç»†èŠ‚ç•¥ ","date":"2024-04-12","objectID":"/posts/learned-sorting/:4:2","tags":["Paper Reading"],"title":"Paper Reading: The Case for a Learned Sorting Algorithm [SIGMOD 2020]","uri":"/posts/learned-sorting/"},{"categories":null,"content":"Implementation optimizations å®ç°ä¸Šæœ‰å‡ ä¸ªä¼˜åŒ– We process elements in batches. First we use the model to get the predicted indices for all the elements in the batch, and then place them into the predicted buckets. This batch-oriented approach maintains cache locality As in Algorithm 1, we can over-provision array B by a small factor (e.g., 1.1Ã—) in order to increase the bucket sizes and consequently reduce the number of overflowing elements in the spill bucket S. This in turn reduces the sorting time for S. Since the bucket sizes in Stage 2 are small (i.e., b â‰¤ t ), we can cache the predicted position for every element in the current bucket in Line 28 and reuse them in Line 34. In order to preserve the cacheâ€™s and TLBâ€™s temporal locality, we use a bucket-at-a-time approach, where we perform all the operations in Lines 11-40 for all the keys in a single bucket before moving on to the next one. The code for the algorithm can be found at http://dsg.csail.mit.edu/mlforsystems. é¦–å…ˆè¿™æ˜¯æ‰¹å¤„ç†çš„ï¼Œå…ˆé¢„æµ‹ä½ç½®ï¼Œç„¶åå…¥æ¡¶ï¼Œèƒ½å¤Ÿä¿è¯ç¼“å­˜å±€éƒ¨æ€§ã€‚å¯ä»¥å¢åŠ è¾…åŠ©æ•°ç»„çš„å¤§å°ï¼Ÿå‡å°‘æ¡¶æº¢å‡ºçš„æ¦‚ç‡ã€‚è€Œä¸”æ¡¶å¤§å°å¾ˆå°ï¼Œå¯ä»¥é‡å¤åˆ©ç”¨ã€‚æœ€ä¸»è¦çš„æ˜¯ bucket-at-a-time approachï¼Œæ¯æ¬¡åªå¤„ç†ä¸€ä¸ªæ¡¶é‡Œçš„æ‰€æœ‰é”®ï¼Œæé«˜ç¼“å­˜å±€éƒ¨æ€§ã€‚ ç®—æ³• 2 æ¯”è¾ƒé•¿ï¼Œä½†å¤§è‡´æ€è·¯å°±æ˜¯åˆ©ç”¨å°æ¡¶ï¼ˆæ¡¶å’Œæ¡¶ä¹‹é—´åº”è¯¥ä¹Ÿæ˜¯æœ‰åºçš„ï¼‰å±€éƒ¨æ€§ï¼Œè€Œä¸”èƒ½å¤Ÿé¿å…éƒ¨åˆ†ç¢°æ’ åªæ˜¯è¿™ä¸ªæ¡¶çš„æ•°é‡è¦æ€ä¹ˆé€‰å‘¢ï¼Ÿè®ºæ–‡å¥½åƒæ²¡æœ‰ä»”ç»†è®²ã€‚è€Œä¸”å…³äºç¨³å®šæ€§ï¼Œåªæ˜¯ç¨å¾®è®²äº†ä¸€å¥åªè¦æº¢å‡ºæ¡¶çš„æ’åºæ˜¯ç¨³å®šçš„ï¼Œåˆ™ Learned Sort æ˜¯ç¨³å®šçš„ï¼Œæˆ‘è§‰å¾—å¯ä»¥å¤šè®¨è®ºä¸€ä¸‹å’ŒéªŒè¯ï¼Œå°¤å…¶æ˜¯å½“æº¢å‡ºæ¡¶æ•°æ®æ¯”è¾ƒå¤šçš„æ—¶å€™ï¼Œé€‰æ‹©ä»€ä¹ˆç®—æ³•ï¼Ÿæ˜¯æ’æ’è¿˜æ˜¯å½’å¹¶ï¼Ÿè¿˜æ˜¯éœ€è¦åˆ†æç®—æ³•çš„ã€‚ ","date":"2024-04-12","objectID":"/posts/learned-sorting/:4:3","tags":["Paper Reading"],"title":"Paper Reading: The Case for a Learned Sorting Algorithm [SIGMOD 2020]","uri":"/posts/learned-sorting/"},{"categories":null,"content":"Choice of the CDF model å¦‚ä½•é€‰å– CDF modelï¼Ÿè™½ç„¶è®ºæ–‡è¯´ä¸å–å†³äºç‰¹å®šçš„æ¨¡å‹ï¼Œä½†æ˜¯è¿˜æ˜¯éœ€è¦è€ƒè™‘è®­ç»ƒå’Œæ¨ç†å¿«çš„ã€‚ Thus, models such as KDE[43, 47], neural networks or even perfect order-preserving hash functions are usually too expensive to train or execute for our purposes. One might think that histograms would be an interesting alternative, and indeed histogram-based sorting algorithms have been proposed in the past. Unfortunately, histograms have the problem that they are either too coarse-grained, making any prediction very inaccurate, or too fine-grained, which increase the time to navigate the histogram itself (see also Section 6.8). Certainly many model architectures could be used, however, for this paper we use the recursive model index (RMI) architecture as proposed in [29] (shown in Figure 5). RMIs contain simple linear models which are organized into a layered structure, acting like a mixture of experts[29]. è€ƒè™‘äº†ä¸€äº›ä¼ ç»Ÿçš„ NN æˆ–è€…å¸¦é¡ºåºçš„å“ˆå¸Œï¼Œç”šè‡³ç›´æ–¹å›¾ï¼Œä½†å¯èƒ½ä¸å¤ªå‡†æˆ–è€…ç²’åº¦å¤ªç»†ã€‚ è¿˜æ˜¯ä½¿ç”¨äº† SageDB ä¸­æå‡ºçš„ recursive model index RMI æ¨¡å‹ï¼Œ æ¨ç†é€Ÿåº¦å¾ˆå¿«ï¼Œä¸€æ¬¡åŠ æ³•ã€ä¹˜æ³•å’ŒæŸ¥æ‰¾ è®­ç»ƒï¼šé‡‡æ ·å‡ ä¸ªè¾“å…¥ï¼Œç„¶åæ’åºä¹‹å(std::sort), ç”Ÿæˆäº†ä¸€æ£µæ ‘ï¼Œè‡ªé¡¶å‘ä¸‹è®­ç»ƒä¸€ä¸ªçº¿æ€§æ¨¡å‹ã€‚é™¤äº†ä¸‰ç»´ä¹Ÿå¯ä»¥äºŒç»´ï¼Œ å•ä¸ªæ¨¡å‹çš„è®­ç»ƒï¼Œä¸ºäº†ä¿è¯æ¨¡å‹æ˜¯å•è°ƒçš„ï¼Œç®—æ³• 2 å°±ä¸éœ€è¦æ’å…¥æ’åºä¿®æ­£ï¼Œéœ€è¦è®­ç»ƒæ—¶è¿›è¡Œè¾¹ç•Œæ£€æŸ¥ï¼Œä½†åˆä¼šä½¿å¾—ç®—æ³• 2 éœ€è¦é¢å¤–çš„åˆ†æ”¯å‘½ä»¤ï¼ˆæ²¡æœ‰ cacheï¼Ÿï¼‰ ç”¨äº†å•è°ƒæ€§æ›´å¥½çš„ linear spline fittingï¼Ÿè®­ç»ƒå¿«ï¼Œæ’å…¥æ’åºä¹Ÿå‡å°‘äº† 35% çš„ swap ","date":"2024-04-12","objectID":"/posts/learned-sorting/:4:4","tags":["Paper Reading"],"title":"Paper Reading: The Case for a Learned Sorting Algorithm [SIGMOD 2020]","uri":"/posts/learned-sorting/"},{"categories":null,"content":"ALGORITHM ANALYSIS è®¨è®ºæ—¶é—´å¤æ‚åº¦å’Œæ€§èƒ½ï¼Œä»¥åŠä¸åŒå‚æ•°ä¸‹çš„è¡¨ç° ","date":"2024-04-12","objectID":"/posts/learned-sorting/:5:0","tags":["Paper Reading"],"title":"Paper Reading: The Case for a Learned Sorting Algorithm [SIGMOD 2020]","uri":"/posts/learned-sorting/"},{"categories":null,"content":"Analysis of the sorting parameters 3.1.1 Choosing the fan-out ( f ) f å¤§ï¼Œå¯ä»¥ä½¿å¾—æ¨¡å‹æ›´å‡†ï¼Ÿé‚£ä¸å°±æˆäº† radix å— ä¸ºäº†åˆ©ç”¨ç¼“å­˜ï¼Œf ä¹Ÿå¿…é¡»è¦é™åˆ¶ã€‚æµ‹è¯•äº† 100m doubles å’Œä¸åŒçš„ fï¼Œè¡¨ç°äº†å…¶æ€§èƒ½å’Œ L1 L2 cache size(f = 1-5K) ç›¸å…³ã€‚ 3.1.2 Choosing the threshold ( t ). The threshold t determines the minimum bucket capacity as well as when to switch to a Counting Sort subroutine (Line 11 in Algorithm 2). We do this for two reasons: (1) to reduce the number of overflows (i.e., the number of elements in the spill bucket) and (2) to take better advantage of the model for the in-bucket sorting. Here we show how the threshold t affects the size of the spill bucket, which directly influences the performance t æ˜¯ bucket sizeï¼Œä¼šå½±å“æº¢å‡ºçš„æ¦‚ç‡ è®ºæ–‡ä¹Ÿæåˆ°ï¼ŒåŸºäºæ ·æœ¬è®­ç»ƒï¼Œä¸å¯èƒ½ä¼šæœ‰å®Œç¾çš„æ¨¡å‹ï¼Œä¸å¯èƒ½å¯ä»¥æŠŠæ¯ä¸ªå…ƒç´ æ˜ å°„åˆ°å”¯ä¸€çš„ä½ç½®ï¼Œæ€»æ˜¯ä¼šå‘ç”Ÿä¸åŒå…ƒç´ æ˜ å°„åˆ°åŒä¸€ä¸ªä½ç½®ã€‚è¿™é‡Œæ¨å¯¼äº† E[s] = N / e è¡¨ç¤ºæº¢å‡ºæ¡¶çš„å¤§å°ï¼ŒN è¡¨ç¤ºæ¡¶çš„æ•°é‡ï¼Œè®ºæ–‡é€šè¿‡æµ‹è¯•ä¸åŒçš„å¤§å°ï¼Œå½“ t = 100 æ—¶ï¼Œoverflow æ¦‚ç‡ 3.9% \u003c 5%, Learned Sort æ€§èƒ½æœ€å¥½ã€‚ä½†è¯´çš„æ˜¯ç»éªŒä¸Šæ¥çœ‹ï¼Ÿæ²¡æœ‰ç»™å‡ºåˆç†çš„è¯æ˜å’Œæ›´è¯¦ç»†çš„æµ‹è¯•ã€‚ 3.1.3 The effect of model quality on the spill bucket size. ä¸åŒæ¨¡å‹ä¼šå¯¼è‡´ç¢°æ’ã€æº¢å‡ºã€‚è®ºæ–‡å‡è®¾æ ·æœ¬æ˜¯ä»åˆ†å¸ƒä¸­ç‹¬ç«‹ç”Ÿæˆçš„ï¼Ÿè¿™éƒ¨åˆ†æ²¡çœ‹æ‡‚ï¼Œå¯¹äºå°æ ·æœ¬ï¼Œæ€ä¹ˆå­¦ä¹ åˆ†å¸ƒæ‰èƒ½å¯¼è‡´æº¢å‡ºæ›´å°‘ï¼Ÿåæ­£è¿˜æ˜¯è¦å°½å¯èƒ½åœ°æ‹Ÿåˆ CDF 3.1.4 Choosing the sample size. å¤ªå¤šç»éªŒæ“ä½œäº†ï¼Œç›´æ¥å°± 1% é‡‡æ ·ç‡äº†ï¼Œè€Œä¸”ä»–è¿™ä¸ªé‡‡æ ·ç‡åªæµ‹è¯•äº†é‡‡æ ·ç‡å’Œè®­ç»ƒ/æ’åºçš„æ—¶é—´ï¼Œæ²¡æœ‰æµ‹å…¶ä»–å‚æ•°ï¼Ÿ ","date":"2024-04-12","objectID":"/posts/learned-sorting/:5:1","tags":["Paper Reading"],"title":"Paper Reading: The Case for a Learned Sorting Algorithm [SIGMOD 2020]","uri":"/posts/learned-sorting/"},{"categories":null,"content":"Complexity This process takes $O(N Â·L)$ time, where L is the number of layers in the model. Since we split the buckets progressively using a fan-out factor f until a threshold size t , the number of iterations and the actual complexity depend on the choice of f and t . However, in practice we use a large fan-out factor, therefore the number of iterations can be considered constant t å’Œ f ä¹‹é—´æ˜¯å¦å­˜åœ¨å…³ç³»ï¼Ÿæ—¶é—´å¤æ‚åº¦ O(N L) L æ˜¯æ¨¡å‹å±‚æ•°ï¼Ÿf æ¯”è¾ƒå¤§ï¼Œè¿­ä»£æ¬¡æ•°æ˜¯å¸¸æ•°çº§åˆ«çš„ï¼Ÿ æœ€é‡è¦çš„é—®é¢˜è¿˜æ˜¯å–å†³äºæ¨¡å‹è´¨é‡ï¼Œä¸è®ºæ˜¯ä»€ä¹ˆé˜¶æ®µï¼Œå¦‚æœæ¨¡å‹å¤ªå·®ï¼ŒåŸºæœ¬å°±æ˜¯é€€åŒ–åˆ°æ’å…¥æ’åºï¼ŒO(n^2)ï¼Œæ¡¶çš„æº¢å‡ºä¹Ÿå—å½±å“ï¼Œæº¢å‡ºæ¡¶ä¹Ÿå—å½±å“ã€‚ ç®—æ³•ä½¿ç”¨äº†è¾…åŠ©ç©ºé—´ï¼Œç©ºé—´å¤æ‚åº¦ O(N) ä½†åç»­å®ç°äº† in-place çš„ O(1) ç©ºé—´å¤æ‚åº¦ ","date":"2024-04-12","objectID":"/posts/learned-sorting/:5:2","tags":["Paper Reading"],"title":"Paper Reading: The Case for a Learned Sorting Algorithm [SIGMOD 2020]","uri":"/posts/learned-sorting/"},{"categories":null,"content":"EXTENSIONS åœ¨å­—ç¬¦ä¸²ä¸Š in-place æ’åº ","date":"2024-04-12","objectID":"/posts/learned-sorting/:6:0","tags":["Paper Reading"],"title":"Paper Reading: The Case for a Learned Sorting Algorithm [SIGMOD 2020]","uri":"/posts/learned-sorting/"},{"categories":null,"content":"Making Learned Sort in-place è¿˜æ˜¯åˆ†ç»„ï¼Œä½†æ˜¯æ˜¯ç”¨ buffer ","date":"2024-04-12","objectID":"/posts/learned-sorting/:6:1","tags":["Paper Reading"],"title":"Paper Reading: The Case for a Learned Sorting Algorithm [SIGMOD 2020]","uri":"/posts/learned-sorting/"},{"categories":null,"content":"Learning to sort strings å­—ç¬¦ä¸²å’Œæµ®ç‚¹æ•°çš„åŒºåˆ« ä½†æ˜¯æ€ä¹ˆè®­ç»ƒ CDFï¼Ÿé™åˆ¶å­—ç¬¦æœ‰å¯èƒ½å¯¼è‡´éå•è°ƒã€‚ ","date":"2024-04-12","objectID":"/posts/learned-sorting/:6:2","tags":["Paper Reading"],"title":"Paper Reading: The Case for a Learned Sorting Algorithm [SIGMOD 2020]","uri":"/posts/learned-sorting/"},{"categories":null,"content":"Duplicates é‡å¤å€¼äº§ç”Ÿå¾ˆå¤§å½±å“ï¼Œä¼šå¯¼è‡´å¾ˆå¤šç¢°æ’ã€‚ æ¯”å¦‚ [0,1,0,1,0,1] è¿™ç§æ•°æ®ï¼Œåº”è¯¥ä¼šå¯¼è‡´å¾ˆå¤šé—®é¢˜ ","date":"2024-04-12","objectID":"/posts/learned-sorting/:6:3","tags":["Paper Reading"],"title":"Paper Reading: The Case for a Learned Sorting Algorithm [SIGMOD 2020]","uri":"/posts/learned-sorting/"},{"categories":null,"content":"RELATED WORK æ’åºç®—æ³•é€šå¸¸è¢«åˆ†ç±»ä¸º åŸºäºæ¯”è¾ƒ æˆ– åŸºäºåˆ†å¸ƒ çš„ Comparison sorts: Distribution sorts: SIMD optimization Hashing functions ML-enhanced algorithms ç¥å¥‡çš„æ˜¯ï¼Œè¿™ä¸€éƒ¨åˆ†æåˆ°äº† Swift5 æ¢äº†æ–°çš„ PDQSortï¼Œè®ºæ–‡å´æ²¡æœ‰è¿›è¡Œå¯¹æ¯”ï¼Ÿ è®ºæ–‡è¿˜æåˆ°äº† radix éå¸¸é€‚åˆ SIMD å’Œå¤šæ ¸åœºæ™¯ï¼Œä¸çŸ¥é“ Learned Sort èƒ½å¦ä¹Ÿæ‰©å±•åˆ°è¿™ç§æƒ…å†µ CDF model å’Œ order-preserving å“ˆå¸Œå‡½æ•°å¾ˆåƒï¼Œä½† CDF è¿˜æ˜¯éœ€è¦åˆ†ç±»ï¼Œè€Œ hash è®­ç»ƒæ…¢è€Œä¸”ä¸€èˆ¬æ²¡æœ‰ order-preserving ","date":"2024-04-12","objectID":"/posts/learned-sorting/:7:0","tags":["Paper Reading"],"title":"Paper Reading: The Case for a Learned Sorting Algorithm [SIGMOD 2020]","uri":"/posts/learned-sorting/"},{"categories":null,"content":"EVALUATION â€¢ Evaluate the performance of Learned Sort compared to other highly-tuned sorting algorithms over real and synthetic datasets â€¢ Explain the time-breakdown of the different stages of Learned Sort â€¢ Evaluate the main weakness of Learned Sort: duplicates â€¢ Show the relative performance of the in-place versus the out-of-place Learned Sort â€¢ Evaluate the Learned Sort performance over strings. ","date":"2024-04-12","objectID":"/posts/learned-sorting/:8:0","tags":["Paper Reading"],"title":"Paper Reading: The Case for a Learned Sorting Algorithm [SIGMOD 2020]","uri":"/posts/learned-sorting/"},{"categories":null,"content":"6.1 Setup and datasets è¿™é‡Œè¿˜æ˜¯æ¯”è¾ƒäº† PDQ çš„ï¼Œä½†æ˜¯è®¤ä¸º PDQS æ¯” baseline å·®å¾ˆå¤šï¼Ÿè¿™ä¸å¤ªåˆç†å§ã€‚ã€‚PDQS èƒ½æ¶ˆé™¤å¾ˆå¤šåˆ†æ”¯é¢„æµ‹ï¼Œæ—¶é—´å¤æ‚åº¦åº”è¯¥ä¹Ÿæ˜¯ O(nk) å’Œ O(nlogn) çº§åˆ«çš„ è€Œä¸”è®­ç»ƒæ—¶é—´ä¹Ÿç®—å…¥äº†æ’åºæ—¶é—´ï¼Œé™¤éå¦æœ‰è¯´æ˜ synthetic datasets: ä¸åŒåˆ†å¸ƒçš„ï¼Œæ··åˆåˆ†å¸ƒçš„ï¼Œ çœŸå®æ•°æ®ï¼šåœ°å›¾æ•°æ®ã€ç‰©è”ç½‘æ•°æ®ã€FaceBook Rw æ•°æ®ã€TPC-Hï¼ˆå…¶å®ä¹Ÿä¸æ˜¯çœŸå®çš„ï¼‰ å¯¹æ¯”çš„æ•°æ®æ˜¯ Sorting Rateï¼Œååé‡ï¼ŒLearned Sort éƒ½æ¯”è¾ƒé«˜ï¼Œè€Œ IS4o å’Œ Radix æ¯”è¾ƒæ¥è¿‘ï¼Œå…¶ä»–éƒ½æ²¡æœ‰å¤ªé«˜ æˆ‘è®¤ä¸ºä»–è¿™ä¸ªæµ‹è¯•å¯¹ä¼ ç»Ÿçš„æ’åºç®—æ³•ä¸æ˜¯å¾ˆå¥½ï¼Œä¼ ç»Ÿçš„æ’åºååé‡éƒ½æ¯”è¾ƒä½ã€‚è€Œä¸”ä¸å¤ªç†è§£è¿™ä¸ªæŒ‡æ ‡çš„æ¦‚å¿µæ˜¯ä»€ä¹ˆï¼Œä¸ç›´è§‚ ","date":"2024-04-12","objectID":"/posts/learned-sorting/:8:1","tags":["Paper Reading"],"title":"Paper Reading: The Case for a Learned Sorting Algorithm [SIGMOD 2020]","uri":"/posts/learned-sorting/"},{"categories":null,"content":"Overall Performance ","date":"2024-04-12","objectID":"/posts/learned-sorting/:8:2","tags":["Paper Reading"],"title":"Paper Reading: The Case for a Learned Sorting Algorithm [SIGMOD 2020]","uri":"/posts/learned-sorting/"},{"categories":null,"content":"Sorting rate æ²¡èƒ½çœ‹åˆ° runtime, memory usage, comparisons/swaps ç­‰æ›´å¤šæŒ‡æ ‡ ","date":"2024-04-12","objectID":"/posts/learned-sorting/:8:3","tags":["Paper Reading"],"title":"Paper Reading: The Case for a Learned Sorting Algorithm [SIGMOD 2020]","uri":"/posts/learned-sorting/"},{"categories":null,"content":"Sorting Strings è¿™é‡Œå°±æ’é™¤äº†è®­ç»ƒæ—¶é—´ï¼Œè€Œä¸”å»æ‰äº† Radixï¼Œæ¯” baseline æ…¢å¾ˆå¤š Learn sort åœ¨è¿™é‡Œçš„ååé‡å¹¶ä¸æ˜¯å¾ˆé«˜ï¼Œå‡ ä¹æ˜¯æµ®ç‚¹æ•°çš„ååˆ†ä¹‹ä¸€ï¼Œä½†è¿˜æ˜¯è¦æ¯” IS4O é«˜ï¼Œæ¯”ä¼ ç»Ÿæ’åºä¹Ÿé«˜ ","date":"2024-04-12","objectID":"/posts/learned-sorting/:8:4","tags":["Paper Reading"],"title":"Paper Reading: The Case for a Learned Sorting Algorithm [SIGMOD 2020]","uri":"/posts/learned-sorting/"},{"categories":null,"content":"The impact of duplicates è¿™é‡Œå¾ˆæœ‰æ„æ€ï¼Œé‡å¤å¾ˆå¤šçš„æ—¶å€™ï¼ŒLearned Sort ååé‡å˜åŒ–å…¶å®å¹¶ä¸å¤§ï¼Ÿåªæœ‰éå¸¸å¤šé‡å¤çš„æ—¶å€™æ‰ä¼šé™ä½å¾ˆå¤šã€‚ ","date":"2024-04-12","objectID":"/posts/learned-sorting/:8:5","tags":["Paper Reading"],"title":"Paper Reading: The Case for a Learned Sorting Algorithm [SIGMOD 2020]","uri":"/posts/learned-sorting/"},{"categories":null,"content":"In-place sorting ååé‡ä¸‹é™äº† 10% å·¦å³ ","date":"2024-04-12","objectID":"/posts/learned-sorting/:8:6","tags":["Paper Reading"],"title":"Paper Reading: The Case for a Learned Sorting Algorithm [SIGMOD 2020]","uri":"/posts/learned-sorting/"},{"categories":null,"content":"Performance decomposition å¤§éƒ¨åˆ†æ—¶é—´åœ¨æ¡¶åˆ†ç±» ","date":"2024-04-12","objectID":"/posts/learned-sorting/:8:7","tags":["Paper Reading"],"title":"Paper Reading: The Case for a Learned Sorting Algorithm [SIGMOD 2020]","uri":"/posts/learned-sorting/"},{"categories":null,"content":"Using histograms as CDF models RMI æ¨¡å‹æ›´é€‚åˆï¼Œæ›´å¿«ï¼Œç”¨äº†è¿ç»­å‡½æ•° ","date":"2024-04-12","objectID":"/posts/learned-sorting/:8:8","tags":["Paper Reading"],"title":"Paper Reading: The Case for a Learned Sorting Algorithm [SIGMOD 2020]","uri":"/posts/learned-sorting/"},{"categories":null,"content":"CONCLUSION AND FUTURE WORK åŠ é€Ÿåˆ†ç±»ï¼Œå¯¹å­—ç¬¦ä¸²å¤„ç†å’Œæ’åºåšäº†å±•æœ›ï¼Œä»¥åŠå¹¶è¡Œã€å¤šæ ¸æ’åºã€SIMD ç­‰ç­‰ã€‚è¿˜æœ‰æ›´å¤šå¤æ‚ç±»å‹ æ˜¯ä¸€ç¯‡å¾ˆå¥½çš„è®ºæ–‡ï¼Œä½† evaluation åªæœ‰ä¸€ä¸ªæŒ‡æ ‡ï¼Œä¸çŸ¥é“èƒ½ä¸èƒ½ä¼˜åŒ–ä¸€ä¸‹ std::sort ä¹‹ç±»çš„ cacheï¼Œä¸çŸ¥é“è¡¨ç°ä¼šæ€ä¹ˆæ ·ã€‚ The paper proposes a sorting algorithm called Learned Sort, which is developed from learned database SageDB by the same team. Learned Sort leverages machine learning (ML) to predict the sorted position of elements, significantly improving sorting efficiency for large datasets. The main idea is to train a CDF model over a small sample of the data and then use the model to predict the position of each key. In addition, the paper also proposes a highly optimized Learned Sort algorithm to maximize cache utilization with bucketization, and compares its performance between in-place and out-of-place implementation. Learned Sort outperforms existing sorting algorithms, particularly when dealing with large datasets that overflow the CPUâ€™s cache. The paper also discusses where Learned Sort can be improved, such as more complex data types and parallel multicore sorting. Contributions: The paper propose the first ML-enhanced sorting algorithm, Learned Sort, which leverages RMI to model the empirical cumulative distribution function (CDF) of the data. The prediction allows Learned Sort to directly place elements close to their final position, reducing the number of comparisons and swaps needed compared to traditional comparison-based sorting methods. Besides the basic ML-enhanced sorting algorithm, the paper also explores an optimized Learned Sort algorithm that can take advantage of caching, and provides an exhaustive comparison with Radix Sort with large datasets. Optimized Learned Sort makes use of buckets and spill buckets for sorting, and the paper also presents an improved version that does not require auxiliary space that can sort in-place. The paper provides a detailed theoretical analysis of Learned Sort, and also gives complete evaluations based on the analysis, comparing not only traditional sorting algorithms such as std::sort and Timsort, but also the optimized Radix Sort and IS4o. The experimental result proves that Learned Sort has better throughput with large datasets (real-world, synthetic, mixed distributions, and large number of duplicates). Limitations: Learned Sort heavily relies on the CDF models to predict the positions of keys. Not only it relies on the accuracy of the model, the paper also points out that even if there is a perfect prediction model, collisions will inevitably occur due to the sampling method used in training. There are too few metrics for evaluation, the paper only compares sorting rate, which may not show the performance of Learned Sort in other aspects, such as runtime, memory usage, exchange rate or comparison ratio, etc. Compared with floating numbers, the throughput of Learned Sort drops sharply, which means that it is necessary to compare other metrics. The paperâ€™s comparison of Recursive Model Index (RMI) and other CDF models is less detailed, especially how to select the fan-out function f and bucket size t under different models, and the impact on overflow and spill buckets. In addition, the paper does not discuss the internal relationship between f and t. And when analyzing the algorithm, the paper doesnot give detailed proof that the algorithm is stable or unstable. Improve: First I would try to explore some techniques like transfer learning to leverage a pre-trained model on a broader data set like Zero-shot model, which could improve Learned Sortâ€™s performance on new data types without retraining. And according to different CDF models, I will try to select different parameters such as fan-out function f and bucket size, discuss the relationship between them. Then I would try to optimize std::sort and timesort and even pdq sort to make them take advantages of cache and sequential writes, making a more detailed evaluation based on various metrics, such as runtime and memory usage. This paper is very innovative and well written, and I might also t","date":"2024-04-12","objectID":"/posts/learned-sorting/:9:0","tags":["Paper Reading"],"title":"Paper Reading: The Case for a Learned Sorting Algorithm [SIGMOD 2020]","uri":"/posts/learned-sorting/"},{"categories":null,"content":"An Inquiry into Machine Learning-based Automatic Configuration Tuning Services on Real-World Database Management Systems CMU çš„å¯¹äº DBMS è‡ªåŠ¨è°ƒä¼˜çš„è®ºæ–‡ï¼Œé‡‡ç”¨äº† ML æœºå™¨å­¦ä¹ æ–¹æ³•ï¼Œæ˜¯ Ottertune çš„è®ºæ–‡ã€‚ ","date":"2024-04-07","objectID":"/posts/ml-based-autotunning/:1:0","tags":["Paper Reading"],"title":"Paper Reading: An Inquiry into Machine Learning-based Automatic Configuration Tuning Services on Real-World Database Management Systems","uri":"/posts/ml-based-autotunning/"},{"categories":null,"content":"ABSTRACT Modern database management systems (DBMS) expose dozens of configurable knobs that control their runtime behavior ä¸ä¸“å®¶ DBA ç›¸æ¯”ï¼Œä½¿ç”¨æœºå™¨å­¦ä¹ ï¼ˆMLï¼‰è¿›è¡Œè‡ªåŠ¨è°ƒæ•´æ–¹æ³•ï¼Œçš„æœ€æ–°å·¥ä½œå·²æ˜¾ç¤ºå‡ºæ›´å¥½çš„æ€§èƒ½ã€‚ç„¶è€Œï¼Œè¿™äº›åŸºäº ML çš„æ–¹æ³•æ˜¯åœ¨å…·æœ‰æœ‰é™è°ƒä¼˜æœºä¼šçš„åˆæˆå·¥ä½œè´Ÿè½½ä¸Šè¿›è¡Œè¯„ä¼°çš„ï¼Œå› æ­¤å°šä¸æ¸…æ¥šå®ƒä»¬æ˜¯å¦åœ¨ç”Ÿäº§ç¯å¢ƒä¸­æä¾›ç›¸åŒçš„å¥½å¤„ To better understand ML-based tuning, we conducted a thorough evaluation of ML-based DBMS knob tuning methods on an enterprise database application. We use the OtterTune tuning service to compare three state-of-the-art ML algorithms on an Oracle installation with a real workload trace. Our results with OtterTune show that these algorithms generate knob configurations that improve performance by 45% over enterprise-grade configurations. We also identify deployment and measurement issues that were overlooked by previous research in automated DBMS tuning services åœ¨ä¼ä¸šæ•°æ®åº“ä¸Šå®ç°äº† OtterTuneï¼Œæé«˜äº† 45% çš„æ€§èƒ½ï¼Œå¹¶ä¸”å‘ç°äº†éƒ¨ç½²å’Œæ£€æµ‹é—®é¢˜ã€‚ ","date":"2024-04-07","objectID":"/posts/ml-based-autotunning/:2:0","tags":["Paper Reading"],"title":"Paper Reading: An Inquiry into Machine Learning-based Automatic Configuration Tuning Services on Real-World Database Management Systems","uri":"/posts/ml-based-autotunning/"},{"categories":null,"content":"INTRODUCTION automate the tuning of database management systems (DBMSs) â€œself-adaptiveâ€ DBMSs that used recommendation tools with physical database design (e.g., indexes, partitioning). In the early 2000s, â€œself-tuningâ€ systems expanded the scope of the problem to include automatic knob configuration. These knobs are tunable options that control nearly all aspects of the DBMSâ€™s runtime behavior. DBMSs have hundreds of knobs, and a database administrator (DBA) cannot reason about how to tune all of them for each application. Unlike physical database design tools [11], knob configuration tools cannot use the built-in cost models of the DBMSâ€™s query optimizers. There are two ways that these tools automatically tune knobs. The first is to use heuristics (i.e., static rules) that the tool developers manually create [1, 5, 14, 27, 42]. Previous evaluations with open-source DBMSs (Postgres, MySQL) showed that these tools improve their throughput by 2â€“5Ã—over their default configuration for OLTP workloads [38]. These are welcomed improvements, but there are additional optimizations that the tools failed to achieve. This is partly because they only target the 10â€“15 knobs that are thought to have the most impact. It is also because the rules do not capture the nuances of each workload that are difficult to codify ä¸ºä»€ä¹ˆæ— æ³•ç”¨å†…ç½®çš„ cost model è°ƒæ•´ knobsï¼Ÿå¯å‘å¼è§„åˆ™æ²¡æ³•æ•æ‰åˆ° workload ä¹‹é—´ç»†å¾®çš„å·®åˆ«ï¼Ÿ tune a DBMS s knobs is to use machine learning (ML) methods that devise strategies to configure knobs without using hardcoded rules åœ¨ OLTP ä»»åŠ¡ä¸­ ML æ–¹æ³•æ¯”é™æ€å·¥å…·ååé‡æé«˜ 15 35%ï¼ŒåŸå› æ˜¯ ML æ¯”é™æ€è§„åˆ™è€ƒè™‘äº†æ›´å¤š knobsï¼Œè€Œä¸”è¿˜ä¼šè€ƒè™‘ knobs ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œæ˜¯éçº¿æ€§çš„ï¼Œäººç±»éš¾ä»¥æ¨¡æ‹Ÿ ML æ–¹æ³•æ¯”äººç±» DBA æ›´å¥½ï¼Œæ€§èƒ½å¥½ã€‚(1) opensource DBMS with limited tuning potential (e.g., Postgres, MySQL, MongoDB) and (2) synthetic benchmarks with uniform workload patterns è€Œä¸”ç”¨äº†æœ¬åœ°å­˜å‚¨ï¼ˆSSDï¼‰ï¼Œæ˜¾ç¤º DBMS éƒ½ç”¨çš„éæœ¬åœ°å…±äº«å­˜å‚¨ï¼Œæ¯”å¦‚ on-premise SANs and cloud-based block stores (S3)? åè€…æœ‰æ›´é«˜çš„è¯»å†™å»¶è¿Ÿï¼Œ incur more variance in their performance than local storageã€‚ ç›®å‰å¹¶ä¸æ¸…æ¥šè¿™äº›å·®å¼‚æ€ä¹ˆå½±å“ ML è°ƒä¼˜æ–¹æ³•ï¼Ÿä¸ºä»€ä¹ˆå‘¢ï¼Œå¦‚æœäº‘å­˜å‚¨å¯¼è‡´è¯»å†™å»¶è¿Ÿé«˜ï¼Œé‚£ ML è°ƒä¼˜ å»ºæ¨¡çš„æ—¶å€™åº”è¯¥ä¹Ÿèƒ½è€ƒè™‘åˆ°è¿™äº›æƒ…å†µï¼Ÿ ä¹‹å‰çš„ç ”ç©¶ä¹Ÿæ²¡æœ‰æåˆ°è‡ªåŠ¨åŒ–è°ƒä¼˜ï¼Œthey do not specify how they select the bounds of the knobs they are tuning. This means that the quality of the configurations may still depend on a human initializing it with the right parameters è¿˜æ˜¯éœ€è¦ DBA åˆå§‹åŒ– this paper presents a field study of automatic knob configuration tuning on a commercial DBMS with a real-world workload in a production environment. We provide an evaluation of state-of-the-art ML-based methods for tuning an enterprise Oracle DBMS (v12) instance running on virtualized computing infrastructure with non-local storage. We extended the OtterTune [3] tuning service to support three ML tuning algorithms: (1) Gaussian Process Regression (GPR) from OtterTune [38], (2) Deep Neural Networks (DNN) [4, 39], and (3) Deep Deterministic Policy Gradient (DDPG) from CDBTune [40]. We also present optimizations for OtterTune and its ML algorithms that were needed to support this study. æœ¬æ–‡åº”è¯¥æ˜¯é›†å¤§æˆçš„ï¼Œè‡ªåŠ¨è°ƒä¼˜ã€å•†ä¸šæ•°æ®åº“ã€ç”Ÿäº§ç¯å¢ƒã€stoa benchmarkã€äº‘å­˜å‚¨ã€‚OtterTune ä½¿ç”¨äº† GDR ã€DNN å’Œ DDPG æ–¹æ³•ã€‚ the quality of the configurations from the ML algorithms (GPR, DDPG, DNN) are about the same on higher knob counts, but vary in their convergence times. knob å¤šçš„æ—¶å€™ï¼Œæ•ˆæœå·®ä¸å¤šï¼Œä½†æ”¶æ•›é€Ÿåº¦ä¸ä¸€æ · ","date":"2024-04-07","objectID":"/posts/ml-based-autotunning/:3:0","tags":["Paper Reading"],"title":"Paper Reading: An Inquiry into Machine Learning-based Automatic Configuration Tuning Services on Real-World Database Management Systems","uri":"/posts/ml-based-autotunning/"},{"categories":null,"content":"BACKGROUND how an automated tuning service works using OtterTune as an example limitations of previous evaluations why a more robust assessment is needed to understand their capabilities ","date":"2024-04-07","objectID":"/posts/ml-based-autotunning/:4:0","tags":["Paper Reading"],"title":"Paper Reading: An Inquiry into Machine Learning-based Automatic Configuration Tuning Services on Real-World Database Management Systems","uri":"/posts/ml-based-autotunning/"},{"categories":null,"content":"OtterTune Overview ä»‹ç» OtterTuneï¼ŒIt maintains a repository of data collected from previous tuning sessions and uses it to build models of how the DBMS responds to different knob configurations. It uses these models to guide experimentation and recommend new settings. Each recommendation provides the service with more data in a feedback loop for refining and improving the accuracy of its models feedback loop æœ‰ç‚¹åƒ RL OtterTune is made up of a controller and a tuning manager. The controller acts as an intermediary between the target DBMS and the tuning manager. It collects runtime data from the target DBMS and installs configurations recommended by the tuning manager. The tuning manager updates its repository and internal ML models with the information provided by the controller and then recommends a new configuration for the user to try At the start of a tuning session, the user specifies which metric should be the target objective for the service to optimize. éœ€è¦ç”¨æˆ·æŒ‡å®šä¼˜åŒ–ç›®æ ‡ first tuning iteration, 1.executes the target workload on the DBMS. After the workload finishes, the controller 2.collects the runtime metrics and configuration knobs from the DBMS and 3.uploads them to the tuning manager. OtterTuneâ€™s tuning manager 4.receives the latest result from the controller and stores it in its repository. Next, the tuning manager 5.uses its ML models to generate the next knob configuration and returns it to the controller. The controller 6.applies the knob configuration to the DBMS and starts the next tuning iteration. This loop continues until the user is satisfied with the improvements over the original configuration æ§åˆ¶å™¨ 1â—‹ æ‰§è¡Œ DBMS ä¸Šçš„ç›®æ ‡å·¥ä½œè´Ÿè½½ã€‚å·¥ä½œè´Ÿè½½å®Œæˆåï¼Œæ§åˆ¶å™¨ 2â—‹ æ”¶é›† DBMS çš„è¿è¡Œæ—¶æŒ‡æ ‡å’Œé…ç½®æ—‹é’®å°†å…¶ä¸Šä¼ åˆ° Tuning Managerã€‚Ottertune çš„è°ƒæ•´ç®¡ç†å™¨ 4â—‹ æ”¶åˆ°æ§åˆ¶å™¨çš„æœ€æ–°ç»“æœï¼Œå¹¶å°†å…¶å­˜å‚¨åœ¨å…¶å­˜å‚¨åº“ä¸­ã€‚æ¥ä¸‹æ¥ï¼ŒTuning Manager 5â—‹ ä½¿ç”¨å…¶ ML å‹å·ç”Ÿæˆä¸‹ä¸€ä¸ªæ—‹é’®é…ç½®å¹¶å°†å…¶è¿”å›åˆ°æ§åˆ¶å™¨ã€‚æ§åˆ¶å™¨ 6â—‹ å°†æ—‹é’®é…ç½®åº”ç”¨äº DBMSï¼Œå¹¶å¼€å§‹ä¸‹ä¸€ä¸ªè°ƒæ•´è¿­ä»£ã€‚è¯¥å¾ªç¯ç»§ç»­è¿›è¡Œï¼Œç›´åˆ°ç”¨æˆ·å¯¹åŸå§‹é…ç½®çš„æ”¹è¿›æ„Ÿåˆ°æ»¡æ„ ","date":"2024-04-07","objectID":"/posts/ml-based-autotunning/:4:1","tags":["Paper Reading"],"title":"Paper Reading: An Inquiry into Machine Learning-based Automatic Configuration Tuning Services on Real-World Database Management Systems","uri":"/posts/ml-based-autotunning/"},{"categories":null,"content":"Motivation (1) workload, (2) DBMS, and (3) operating environment. Workload Complexity: Gaining access to production workloads to evaluate new research ideas is non-trivial due to privacy constraints and other restrictions. Prior studies evaluate their techniques using synthetic benchmarks; the most complex benchmark used to evaluate ML-based tuning techniques to date is the TPC-C OLTP benchmark from the early 1990s. But previous studies have found that some characteristics of TPC-C are not representative of real-world database applications [23, 25]. Many of the unrealistic aspects of TPC-C are due to its simplistic database schema and query complexity. Another notable difference is the existence of temporary and large objects in production databases. Some DBMSs provide knobs for tuning these objects (e.g., Postgres, Oracle), which have not been considered in prior work ä¹‹å‰çš„ç ”ç©¶éƒ½æ˜¯ synthetic benchmarks, TPC-C OLTP benchmark æ— æ³•ä»£è¡¨æ˜¾ç¤ºï¼Œå¾ˆå¤šä¸ç¬¦åˆå®é™…ã€‚è€Œä¸”è®¸å¤šç”Ÿäº§æ•°æ®åº“ä¼šæœ‰è¶…å¤§ä¸´æ—¶å¯¹è±¡ï¼Œä»¥å‰çš„å·¥ä½œæ²¡æœ‰è€ƒè™‘è¿™ç§ System Complexity: The simplistic nature of workloads like TPC-C means that there are fewer tuning opportunities in some DBMSs, especially for the two most common DBMSs evaluated in previous studies (i.e., MySQL, Postgres). For these two DBMSs, one can achieve a substantial portion of the performance gain from configurations generated by ML-based tuning algorithms by setting two knobs according to the DBMSâ€™s documentation. These two knobs control the amount of RAM for the buffer pool cache and the size of the redo log file on disk TPC-C workload ç®€å•ï¼ŒæŸäº›æ•°æ®åº“è°ƒæ•´çš„æœºä¼šæ¯”è¾ƒå°‘ï¼Œå°±èƒ½å¾—åˆ°å¾ˆå¤§çš„æ€§èƒ½è°ƒæ•´ï¼ˆbuffer pool å’Œ redo log file sizeï¼‰ Postgres Knobs â€“ SHARED_BUFFERS, MAX_WAL_SIZE MySQL Knobs â€“ INNODB_BUFFER_POOL_SIZE, INNODB_LOG_FILE_SIZE æ–‡ç« ç”¨ OtterTune åœ¨ DDPG ç®—æ³•ä¸‹è°ƒèŠ‚åä¸ª knobï¼Œæ”¹å–„äº† TPC-C åœ¨ DBMS çš„æ€§èƒ½ï¼Œ More importantly, however, the configurations generated by ML algorithms achieve only 5â€“25% higher throughput than the two-knob configuration across the different versions of MySQL and Postgres. That is, one can achieve 75â€“95% of the performance obtained by ML-generated configurations by tuning only two knobs for the TPC-C benchmark è¿™ä¸ªå®éªŒè¡¨ç°äº†åªç”¨è°ƒæ•´ä¸¤ä¸ª knob å°±èƒ½åœ¨ TPC-C workload ä¸Šå¾—åˆ°å¾ˆå¥½çš„ååé‡è¡¨ç°ï¼Œæ¯”æ ‡å‡†é…ç½®é«˜å¾ˆå¤š Operating Environment: Disk speed is often the most important factor in a DBMSâ€™s performance. Although the previous studies used virtualized environments to evaluate their methods, to our knowledge, they deploy the DBMS on ephemeral storage that is physically attached to the host machine. But many real-world DBMS deployments use durable, non-local storage for data and logs, such as on-premise SANs and cloud-based block/object stores. The problem with these non-local storage devices is that their performance can vary substantially in a multi-tenant cloud environment å¼ºè°ƒäº†éæœ¬åœ°å­˜å‚¨çš„æƒ…å†µï¼Œå¯¹æ¯”äº†æœ¬åœ°å­˜å‚¨ SSD å’Œäº‘å­˜å‚¨ VM å­˜å‚¨ï¼Œåè€…å»¶è¿Ÿä¸å¥½é¢„æµ‹ï¼Œå‰è€…åˆ™ç¨³å®šã€‚ ","date":"2024-04-07","objectID":"/posts/ml-based-autotunning/:4:2","tags":["Paper Reading"],"title":"Paper Reading: An Inquiry into Machine Learning-based Automatic Configuration Tuning Services on Real-World Database Management Systems","uri":"/posts/ml-based-autotunning/"},{"categories":null,"content":"AUTOMATED TUNING FIELD STUDY æ–‡ç« çš„çªç ´ç‚¹åœ¨äºï¼Œæ›´åŠ ç°å®çš„è‡ªåŠ¨è°ƒä¼˜ DBMSï¼Œç»™å‡ºäº†å•†ä¸šæ•°æ®åº“çš„ä¾‹å­ï¼Œç”šè‡³å¯¹æ¯”ä¸“ä¸šçš„ DBA éƒ½æœ‰å¾ˆå¥½çš„è¡¨ç°ã€‚ ","date":"2024-04-07","objectID":"/posts/ml-based-autotunning/:5:0","tags":["Paper Reading"],"title":"Paper Reading: An Inquiry into Machine Learning-based Automatic Configuration Tuning Services on Real-World Database Management Systems","uri":"/posts/ml-based-autotunning/"},{"categories":null,"content":"Target Database Application TicketTracker æ•°æ® Database: We created a snapshot of the TicketTracker database from its production server using the Oracle Recovery Manager tool. The total uncompressed size of the database on disk is âˆ¼1.1 TB, of which 27% is table data, 19% is table indexes, and 54% is large objects (LOBs). This LOB data is notable because Oracle exposes knobs that control how it manages LOBs, and previous work has not explored this aspect of DBMS tuning. large objects LOB æ•°æ®æ˜¯ä»¥å‰æ²¡æœ‰æ¢è®¨è¿‡çš„ï¼Œ Workload: We collected the TicketTracker workload trace using Oracleâ€™s Real Application Testing (RAT) tool. RAT captures the queries that the application executes on the production DBMS instance starting at the snapshot. It then supports replaying those queries multiple times on a test database with the exact timing, concurrency, and transaction characteristics of the original workload [19]. Our trace is from a two-hour period during regular business hours and contains over 3.6m query invocations. å¤§éƒ¨åˆ†æŸ¥è¯¢éƒ½æ˜¯ SELECT çŸ­æŸ¥è¯¢ï¼Œ2% æŸ¥è¯¢æ˜¯å¤šè¡¨æŸ¥è¯¢ï¼Œ98% éƒ½æ˜¯å•è¡¨ã€‚å¤§éƒ¨åˆ†æŸ¥è¯¢éƒ½èµ°äº†ç´¢å¼•ã€‚ There are important differences in the TicketTracker application compared to the TPC-C benchmark used in previous ML tuning evaluations. Foremost is that the TicketTracker database has hundreds of tables and the TPC-C database only has nine. TPC-C also has a much higher write ratio for queries (46%) than the TicketTracker workload (10%). This finding is consistent with previous work that has compared TPC-C with real-world workloads [23, 25]. Prior to our study, it was unknown whether these differences affect the efficacy of ML-based tuning algorithms. åˆ†æäº† TPC-C å’Œè¯¥ workload çš„åŒºåˆ«ï¼Œè™½ç„¶è¿™æ˜¯ç°å®ä¾‹å­ï¼Œä½†å®ƒå…·æœ‰ä»£è¡¨æ€§å—ï¼Ÿ ","date":"2024-04-07","objectID":"/posts/ml-based-autotunning/:5:1","tags":["Paper Reading"],"title":"Paper Reading: An Inquiry into Machine Learning-based Automatic Configuration Tuning Services on Real-World Database Management Systems","uri":"/posts/ml-based-autotunning/"},{"categories":null,"content":"Deployment DBA å®ç°æ ¹æ®æ–‡æ¡£ä¹Ÿè°ƒæ•´äº†ä¸€äº› knobsï¼Œ As such, for the TicketTracker workload, the DBA further customized some of the knobs in the pre-tuned configuration, including one that improves the performance of LOBs We set up multiple of OtterTuneâ€™s tuning managersand controllers in the same data center as the Oracle DBMSs. We ran each component in a Docker container with eight vCPUs and 16 GB RAM. Each DBMS instance has a dedicated OtterTune tuning manager assigned to it. This separation prevents one session from using training data collected in another session, which will affect the convergence rate and efficacy of the algorithms Oracle Knob: DB_32K_CACHE_SIZE ","date":"2024-04-07","objectID":"/posts/ml-based-autotunning/:5:2","tags":["Paper Reading"],"title":"Paper Reading: An Inquiry into Machine Learning-based Automatic Configuration Tuning Services on Real-World Database Management Systems","uri":"/posts/ml-based-autotunning/"},{"categories":null,"content":"Tuning At the beginning of each iteration in a tuning session, the controller first restarts its target DBMS instance. Restarting ensures that the knob changes that OtterTune made to the DBMS in the last iteration take effect. Some knobs in Oracle do not require restarting the DBMS, but changing them is not instantaneous and requires additional monitoring to determine when their updated values have been fully applied. To avoid issues with incomplete or inconsistent configurations, we restart the DBMS each time éœ€è¦é‡å¯ï¼Œä»¥æ›´æ”¹ knobï¼Œè¿™æ˜¯ä¸æ˜¯ä¸€ä¸ªé™åˆ¶ï¼Ÿä¹Ÿæœ‰å¾ˆå¤š knob ä¸éœ€è¦é‡å¯ DBMSï¼Œä½†ä¿®æ”¹ä¸æ˜¯ç«‹åˆ»è§æ•ˆçš„ï¼Œè¿˜éœ€è¦é¢å¤–æ£€æµ‹ï¼Œæ‰€ä»¥è¿˜æ˜¯éœ€è¦é‡å¯ã€‚ Another issue is that Oracle could refuse to start if one of its knobs has an invalid setting. å¯åŠ¨å¤±è´¥çš„æ—¶å€™ï¼Œæ²¡æœ‰é”™è¯¯æ—¥å¿—ï¼Œè°ƒä¼˜è¿­ä»£å°±ä¼šåœæ­¢ç„¶åæŠ¥å‘Šç»™ tuning managerï¼Œæ‰¾åˆ°ä¸‹ä¸€ä¸ªé…ç½®å†è¿­ä»£ã€‚ä½†é‡å¯ä¹‹åçš„æ¢å¤ workload trace ä¹Ÿå¾ˆå¿«ï¼Ÿäº”åˆ†é’Ÿï¼Œåˆ©ç”¨äº† snapshot ä»…é‡ç½®ä¿®æ”¹è¿‡çš„ pages å°½ç®¡ workload æœ‰ 1T reset ä¹‹åä¼šè·‘ä¸€ä¸ª microbenchmark è¯„æµ‹æ€§èƒ½ï¼Œä½†ä¸æ˜¯å¿…é¡»çš„ã€‚This step is not necessary for tuning, and none of the algorithms use this data in their models. Instead, we use these metrics to explain the DBMSsâ€™ performance in noisy cloud environments (see Section 6). æ²¡å¤ªç†è§£è¿™é‡Œï¼Œbenchmark çš„ç»“æœæ˜¯ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆå¯¹äº tuning ä¸æ˜¯å¿…é¡»çš„ï¼Ÿ OtterTuneâ€™s controller executes TicketTrackerâ€™s workload trace using Oracle RAT. We limit the replay time for two reasons. First, the segmentâ€™s timespan is based on the wall clock of when the trace was collected on the production DBMS. This means that when the trace executes on a DBMS with a sub-optimal configuration (which is often the case at the beginning of a tuning session), the 10-minute segment could take several hours to complete. We halt replays that run longer than 45 minutes. The second reason is specific to Oracle: RAT is unstable on large traces for our DBMS version. Oracleâ€™s engineers did provide SG with a fix, but only several months after we started our study, and therefore it was too late to restart our experiments replay time æ˜¯ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆé™åˆ¶ replay timeï¼Œä¸€ä¸ªæ˜¯ 10min segtime å¯èƒ½éœ€è¦å‡ ä¸ªå°æ—¶å®Œæˆï¼Œä¸€ä¸ªæ˜¯ Oracle RAT ä¸ç¨³å®šï¼Œå°½ç®¡æä¾›äº†è§£å†³æ–¹æ¡ˆä½†å¤ªæ™šäº†ï¼ˆå¯èƒ½ä¹Ÿæ˜¯å¦ä¸€ä¸ª limitationï¼‰ ","date":"2024-04-07","objectID":"/posts/ml-based-autotunning/:5:3","tags":["Paper Reading"],"title":"Paper Reading: An Inquiry into Machine Learning-based Automatic Configuration Tuning Services on Real-World Database Management Systems","uri":"/posts/ml-based-autotunning/"},{"categories":null,"content":"TUNING ALGORITHMS (1) Gaussian Process Regression (GPR), (2) Deep Neural Network (DNN), and (3) Deep Deterministic Policy Gradient (DDPG). Although there are other algorithms that use query data to guide the search process [28], they are not usable at SG because of privacy concerns since the queries contain user-identifiable data. Methods to anonymize this data are outside the scope of this paper ä¸ºä»€ä¹ˆå…¶ä»–æ–¹æ³•ä¼šè®¾è®¡éšç§ï¼Ÿé‚£ä¸ºä»€ä¹ˆ DDPG ä¸ä¼šï¼Ÿ ","date":"2024-04-07","objectID":"/posts/ml-based-autotunning/:6:0","tags":["Paper Reading"],"title":"Paper Reading: An Inquiry into Machine Learning-based Automatic Configuration Tuning Services on Real-World Database Management Systems","uri":"/posts/ml-based-autotunning/"},{"categories":null,"content":"4.1 GPR â€” OtterTune (2017) Data Pre-Processing: Each invocation takes up to an hour, depending on the number of samples and DBMS metrics å…·ä½“ç®—æ³•ç•¥ ","date":"2024-04-07","objectID":"/posts/ml-based-autotunning/:6:1","tags":["Paper Reading"],"title":"Paper Reading: An Inquiry into Machine Learning-based Automatic Configuration Tuning Services on Real-World Database Management Systems","uri":"/posts/ml-based-autotunning/"},{"categories":null,"content":"4.2 DNN â€” OtterTune (2019) Previous research has argued that Gaussian process models do not perform well on larger data sets and high-dimensional feature vectors ","date":"2024-04-07","objectID":"/posts/ml-based-autotunning/:6:2","tags":["Paper Reading"],"title":"Paper Reading: An Inquiry into Machine Learning-based Automatic Configuration Tuning Services on Real-World Database Management Systems","uri":"/posts/ml-based-autotunning/"},{"categories":null,"content":"4.3 DDPG â€” CDBTune (2019) RL æ–¹æ³•ï¼ŒOtterTune å®ç°äº† DDPG++ We identified a few optimizations to CDBTuneâ€™s DDPG algorithm that reduce the amount of training data needed to learn the representation of the Q-value. We call this enhanced version DDPG++. ","date":"2024-04-07","objectID":"/posts/ml-based-autotunning/:6:3","tags":["Paper Reading"],"title":"Paper Reading: An Inquiry into Machine Learning-based Automatic Configuration Tuning Services on Real-World Database Management Systems","uri":"/posts/ml-based-autotunning/"},{"categories":null,"content":"EVALUATION ä½¿ç”¨ Random sampling æ–¹æ³•è¯„ä¼° ","date":"2024-04-07","objectID":"/posts/ml-based-autotunning/:7:0","tags":["Paper Reading"],"title":"Paper Reading: An Inquiry into Machine Learning-based Automatic Configuration Tuning Services on Real-World Database Management Systems","uri":"/posts/ml-based-autotunning/"},{"categories":null,"content":"Performance Variability Because each tuning session in our experiments takes multiple days to complete, we deployed the Oracle DBMS on multiple VMs to run the sessions in parallel. Our VMs run on the same physical machines during this time, but the other tenants on these machines or in the same rack may change. As discussed in Section 2.2, running a DBMS in virtualized environments with shared storage can lead to unexplained changes in the systemâ€™s performance across instances with the same hardware allocations and even on the same instance æ¯æ¬¡ tuning session éƒ½éœ€è¦å¥½å‡ å¤©ï¼Ÿè¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿç”šè‡³èŠ±äº†å…­ä¸ªæœˆæ¥æ£€æµ‹ï¼Œæ¯å‘¨æµ‹ä¸€æ¬¡ã€‚ç”šè‡³åŒä¸€ä¸ª VM ä¸Š DBMS ä¹Ÿæœ‰æ€§èƒ½æ³¢åŠ¨ï¼Ÿ We believe that these inconsistent results are due to latency spikes in the shared-disk storage. Figure 9 shows the DBMSâ€™s performance for one VM during a tuning session, along with its CPU busy time and I/O latency. These results show a correlation between spikes in the I/O latency (three highlighted regions) and degradation in the DBMSâ€™s performance. In this example, the algorithm had converged at this point of the tuning session, so the å‡ºç°äº†ä¸€äº›ä¸ä¸€è‡´çš„ç»“æœï¼Œè®ºæ–‡è®¤ä¸ºæ˜¯å…±äº«å­˜å‚¨çš„ä¸€äº›å»¶è¿Ÿå°–å³°å¼•èµ·çš„ï¼Œå› ä¸ºä»–ä»¬æµ‹äº† VM çš„æ€§èƒ½ï¼ŒCPU å ç”¨ç‡å’Œ IO å»¶è¿Ÿï¼Œè®¤ä¸ºç®—æ³•å·²ç»æ”¶æ•›ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯å¤–éƒ¨å› ç´ æœ‰å…³ï¼Œè€Œä¸æ˜¯ DBMS å†…éƒ¨é—®é¢˜ã€‚ ä¸ºä»€ä¹ˆä¸æ˜¯æŸæ¬¡çš„ knob è°ƒæ•´å‡ºé—®é¢˜äº†ï¼Ÿè¿™é‡Œæ²¡æœ‰æåˆ° knob æ˜¯å¦æ›´æ”¹ï¼Œè™½ç„¶ IO çš„é—®é¢˜åº”è¯¥æ›´å¤§ä¸€äº›ã€‚Performance Variability è¿™éƒ¨åˆ†æ²¡æœ‰å¾ˆå¥½åœ°è§£é‡Šè¿™ä¸ªå˜åŒ–åˆ°åº•æ˜¯ä¸ºä»€ä¹ˆï¼Œä¹Ÿä¸å¤ªç›´ç™½ã€‚ ","date":"2024-04-07","objectID":"/posts/ml-based-autotunning/:7:1","tags":["Paper Reading"],"title":"Paper Reading: An Inquiry into Machine Learning-based Automatic Configuration Tuning Services on Real-World Database Management Systems","uri":"/posts/ml-based-autotunning/"},{"categories":null,"content":"Tuning Knobs Selected by DBA è®© DBA é€‰ 40 ä¸ª knobs æ¥è°ƒä¼˜ï¼Œ Figure 11 shows that the configurations recommended by DNN and DDPG++ that tune 10 knobs improve the DB Time by 45% and 43% over the default settings, respectively. Although LHS, GPR, and DDPG achieve over 35% better DB Time, they do not perform as well as DNN and DDPG++ because they select a sub-optimal version of the optimizer features to enable DNN å’Œ DDPG++ æ”¹äº† 10 ä¸ª knobs æé«˜äº† 45% å·¦å³çš„æ€§èƒ½ï¼Œæ”¹ 20 ä¸ª knobs æ—¶æé«˜ 33-40% æ€§èƒ½ä½†å­˜åœ¨è‡³å°‘ä¸€ä¸ª knob é”™è¯¯ï¼Œè®ºæ–‡è®¤ä¸ºæ˜¯å¤æ‚åº¦å¤ªé«˜ï¼Œç®—æ³•çš„éšæœºæ€§ä»¥åŠ VM çš„å™ªå£°å¼•èµ·çš„ã€‚ä½†æ²¡æœ‰è§£é‡Šå“ªä¸ªåŸå› æ‰æ˜¯æ ¹æœ¬çš„ã€‚ We also see that DNN has the largest gap between its minimum and maximum optimized configurations. the configurations from DNN and GPR achieve 40% better DB Time than the default configuration. DDPG and DDPG++ only achieve 18% and 32% improvement, respectively. The reason is that neither of them can fully optimize the 40 knobs within 150 iterations. DDPG++ outperforms DDPG because of the optimizations that help it converge more quickly (see Section 4.3). With more iterations, DDPG would likely achieve similar performance to the other ML-based algorithms. But due to computing costs and labor time, it was not practical to run a session for more than 150 iterations in our evaluation. The LHS configuration performs the worst of all, achieving only 10% improvement over the 150 è¿­ä»£éƒ½æ²¡æ³•ä¼˜åŒ– 40 ä¸ª knobsï¼Œä¸ºä»€ä¹ˆï¼ŸDDPG++ æ”¶æ•›æ›´å¿«ä¸€äº›ï¼Œ In summary, we find that the configurations generated by all of the algorithms that tune 10, 20, and 40 knobs can improve the DBMSâ€™s performance over the default configuration. GPR always converges quickly, even when optimizing 40 knobs. But GPR is prone to getting stuck in local minima, and once it converges, it stops exploring and thus does not continue to improve after that point. The performance of GPR, therefore, depends on whether it explores the best-observed ranges of the impactful knobs from Table 2. We also observe that its performance is influenced by the initial samples executed at the start of the tuning session. This is consistent with findings from previous studies [26]. In contrast, DNN, DDPG, and DDPG++ require more data to converge and carry out more exploration. The configurations that tune 10 knobs perform the best overall. This is because the lower complexity of the configuration space enables DNN and DDPG++ to find good settings for the impactful knobs in Table 2. GPR å¯ä»¥å¿«é€Ÿæ”¶æ•›ï¼Œä½†å®¹æ˜“é™·å…¥ local minimaï¼Œæ‰€ä»¥é€‰å–åˆå§‹ knob å°±å¾ˆé‡è¦ï¼Œè€Œå…¶ä»–çš„éœ€è¦æ›´å¤šæ•°æ®ã€‚ ","date":"2024-04-07","objectID":"/posts/ml-based-autotunning/:7:2","tags":["Paper Reading"],"title":"Paper Reading: An Inquiry into Machine Learning-based Automatic Configuration Tuning Services on Real-World Database Management Systems","uri":"/posts/ml-based-autotunning/"},{"categories":null,"content":"Tuning Knobs Ranked by OtterTune ä¸éœ€è¦ DBA å‚ä¸ï¼Œä½¿ç”¨ OtterTune Lasso ç®—æ³•é€‰æ‹©æ—‹é’®ï¼Œç„¶åç”¨ LHSã€‚ å®é™…ä¸Š OtterTune é€‰æ‹©çš„ knobs å’Œ DBA å¾ˆè¿‘ä¼¼ï¼Œè€Œä¸”ä¼šé€‰å¾ˆé‡è¦çš„å‡ ä¸ª knob æ¯”å¦‚ DB_CACHE_SIZE LHS é…ç½®æ— æ³•è¯†åˆ«ï¼Ÿä½†æ˜¯æå‡å¾ˆå¤§ï¼Œ10knobs éƒ½æœ‰æå‡ï¼Œä½†æ˜¯ 20knobs åªæœ‰ GPR å’Œ DNN æœ‰æå‡ï¼Œå¤§éƒ¨åˆ†è¦ä¹ˆæ²¡æå‡ï¼Œè¦ä¹ˆå°±ä¸€ç‚¹ï¼Œç”šè‡³ä¸è¶…è¿‡é»˜è®¤é…ç½®ã€‚è®ºæ–‡è®¤ä¸ºæ˜¯å½“æ—¶å…±äº«å­˜å‚¨çš„ noise å¾ˆå¤šï¼Œå¯¼è‡´äº†å·®å¼‚ã€‚ä½†è¿™å·®å¼‚ä¹Ÿå¤ªå¤§äº†ã€‚ã€‚ã€‚ è®ºæ–‡ä¹Ÿæ²¡æ€ä¹ˆä»‹ç» Lasso ç®—æ³•ï¼Œç”šè‡³åœ¨ 10knobs ä¹Ÿä¸çŸ¥é“å“ªä¸ªç®—æ³•æ˜¯æ¯”è¾ƒå¥½çš„ï¼Œæœ‰äº›å°çš„æ”¹è¿›è¿˜å¯èƒ½æ˜¯ noise å¼•èµ·çš„ ","date":"2024-04-07","objectID":"/posts/ml-based-autotunning/:7:3","tags":["Paper Reading"],"title":"Paper Reading: An Inquiry into Machine Learning-based Automatic Configuration Tuning Services on Real-World Database Management Systems","uri":"/posts/ml-based-autotunning/"},{"categories":null,"content":"Adaptability to Different Workload We next analyze the quality of ML-generated configurations when we train their models on one workload and then use them to tune another workload. The ability to reuse training data across workloads potentially reduces the number of iterations that the algorithms need for their models to converge. æœ€è¿‘çœ‹çš„ä¸€äº›è°ƒä¼˜ç›¸å…³çš„ï¼Œéƒ½å¾ˆæ³¨é‡ across workloads ç”¨ TPC-C è®­ç»ƒ We examined the configurations for differences in the best-observed settings for TPC-C and TicketTracker that may explain why the algorithms were unable to achieve performance comparable to the results in Figures 11 and 13. We observed that none of the algorithms changed the sizes of the two buffer caches in Table 2 from their SG default settings. This is expected for the LOB buffer cache since none of TPC-Câ€™s data is stored in the 32 KB tablespace. å‰æ–‡æåˆ°çš„ LOB ï¼Œä½†æ˜¯å´æ²¡æœ‰ä¿®æ”¹ LOB bufferï¼Œå› ä¸º TPC-C æ•°æ®æ¯”è¾ƒå°ï¼Œè€Œä»–ä»¬å®éªŒæ˜¯åœ¨ TicketTracker è¿™ç§å¾ˆå¤§çš„æ•°æ®é›†ä¸Šï¼Œå®é™…ä¸Šéœ€è¦æ‰“å¼€ã€‚ ","date":"2024-04-07","objectID":"/posts/ml-based-autotunning/:7:4","tags":["Paper Reading"],"title":"Paper Reading: An Inquiry into Machine Learning-based Automatic Configuration Tuning Services on Real-World Database Management Systems","uri":"/posts/ml-based-autotunning/"},{"categories":null,"content":"Execution Time Breakdown DDPG++ has fewer canceled replays than DDPG due to its improved convergence rate (see Section 4.3). LHS has the highest workload execution time and percentage of canceled replays because it is a sampling technique and never converges ","date":"2024-04-07","objectID":"/posts/ml-based-autotunning/:7:5","tags":["Paper Reading"],"title":"Paper Reading: An Inquiry into Machine Learning-based Automatic Configuration Tuning Services on Real-World Database Management Systems","uri":"/posts/ml-based-autotunning/"},{"categories":null,"content":"LESSONS LEARNED (1) Handling Long-running Configurations: Given this, the controller needs to support an early abort mechanism that stops long-running workload replays. Setting the early abort threshold to lower values is beneficial because it reduces the total tuning time. This threshold, however, must be set high enough to account for variability in cloud environments. We found that the 45-minute cut-off worked well, but further investigation is needed on more robust methods. For early aborted configurations, the DBMSâ€™s metrics, especially Oracleâ€™s DB Time, are incorrectly smaller because the workload is cut off. Thus, to correct this data, the controller calculates a completion ratio as the number of finished transactions divided by the total transactions in the workload. It then uses this ratio to scale all counter metrics to approximate what they would have been if the DBMS executed the full workload trace éœ€è¦ä¸€ä¸ªå¯ä»¥æ—©èµ·ç»ˆæ­¢çš„æœºåˆ¶ (2) Handling Failed Configurations éœ€è¦ä¸€ä¸ªæœºåˆ¶å¯ä»¥çŸ¥é“ä»€ä¹ˆæ—¶å€™ knob ä¸æ­£ç¡® ï¼Œ (3) DBMS Maintenance Tasks (4) Unexpected Cost Considerations: ","date":"2024-04-07","objectID":"/posts/ml-based-autotunning/:8:0","tags":["Paper Reading"],"title":"Paper Reading: An Inquiry into Machine Learning-based Automatic Configuration Tuning Services on Real-World Database Management Systems","uri":"/posts/ml-based-autotunning/"},{"categories":null,"content":"RELATED WORK ç•¥ ","date":"2024-04-07","objectID":"/posts/ml-based-autotunning/:9:0","tags":["Paper Reading"],"title":"Paper Reading: An Inquiry into Machine Learning-based Automatic Configuration Tuning Services on Real-World Database Management Systems","uri":"/posts/ml-based-autotunning/"},{"categories":null,"content":"CONCLUSION In this study, we conducted a thorough evaluation of machine learning-based DBMS knob tuning methods with a real workload on an Oracle installation in an enterprise environment. We implemented three state-of-the-art ML algorithms in the OtterTune tuning service in order to make a head-to-head comparison. Our results showed that these algorithms could generate knob configurations that improved performance by up to 45% over ones generated by a human expert, but the performance was influenced by the number of tuning knobs and the assistance of human experts in knob selection. We also solved several deployment and measurement issues that were overlooked by previous studies è¿™ç¯‡è®ºæ–‡è¯»ç€å¤ªåƒåŠ›äº†ï¼Œè€Œä¸”å¯¹ ML è°ƒä¼˜çš„å°è±¡æ›´åŠ å·®äº†ã€‚åšäº†ä¸€å †äº‹æƒ…ï¼Œå¥½åƒä»€ä¹ˆéƒ½æ²¡è§£å†³ï¼Œä¹Ÿä¸çŸ¥é“åŸå› ã€‚ æ›´åƒæ˜¯ OtterTune åœ¨ç°å®æ•°æ®åº“å’Œæ•°æ®é›†çš„ä¸€ä¸ªå°è¯•ï¼Œä½†è¿™ä¸ªæ–°çš„æ•°æ®é›†åŒºåˆ«åˆå¾ˆå¤§ï¼Œå®éªŒç»“æœä¹Ÿå¾ˆè«åå…¶å¦™ï¼Œ10-20 knobs æ•ˆæœæœ‰ï¼Œä½†æ˜¯ 40 knobs æ•ˆæœä¸å¥½åˆè¯´æ˜¯å…±äº«å­˜å‚¨çš„é—®é¢˜ The paper investigates the effectiveness of using machine learning (ML) for automatic configuration and knobs tuning in real-world database management systems (an enterprise database called Oracle). Since previous ML-based tuning methods were tested on synthetic workloads and cannot represent real-world conditions, the paper conducted an evaluation of ML-based tuning methods using the OtterTune framework on an Oracle DBMS with a real-world workload trace SG and TicketTracker. The paper experiments with many ML algorithms (GPR, DNN, DDPG, DDPG++ and LHS) for automatic DBMS knob tuning, and achieves over 45% improvement with 10 and 20 tuning knobs chosen by OtterTune and compared the results with knobs chosen by DBA. And the paper also discusses the problems encountered in the experiment, such as I/O latency with shared storage, long tuning time and convergence speed. Contributions: While previous ML tuning methods mainly benchmarked on synthetic workloads and open-source DBMSs, this paper uses a real-world workload trace from a bankâ€™s application(SG and TicketTracker) and commercial DBMS(Oracle), offering insights into the practical effectiveness of ML tuning. The paper conducts lots of experiments by using the OtterTune framework to evaluate many ML-based methods on the commercial DBMS, they tested Gaussian Process Regression (GPR) and Deep Neural Networks (DNNs), as well as Reinforcement Learning (RL) with Deep Deterministic Policy Gradient (DDPG) and DDPG++. Prior research often uses local storage like SSDs to do experiments, the paper points out that local storage can impact the performance and the effectiveness of the tuning algorithms being evaluated because shared storage is more real-world, and the I/O latency of shared storage will have an impact on tuning. Limitations: Though the paper conducts lots of experiments, there was a big difference in the experimental results when using OtterTune tuning 20 knobs. The evaluation was heavily affected by the latency of non-local storage. When the paper introduces various ML tuning methods, it does not carefully distinguish their differences. Especially when analyzing the experimental results, DDPG++ should converge faster than DDPG, but the experiments cannot present the advantages of DDPG++. The paper mentions that when using shared storage, I/O latency will lead to great variability in tuning results, but it does not provide a control group or a reproduction of the situation. Moreover, the TicketTracker database looks very different from TPC-C. The paper should try to analyze some other representative real-world workloads. The paper did a lot of experiments, but the paper also mentioned that Oracle fixed a very important issue in the later stage. I guess this will require re-experimenting, although this may be very time consuming. I may also want to try some methods to reduce the tuning time, because this will allow me to experiment with more rounds and reflect the differences between DDPG and DDPG++. In addition, I would like to conduct the experiments on other real-world workloads, which can demonstrate the ability of OtterTune and ML-based tuning met","date":"2024-04-07","objectID":"/posts/ml-based-autotunning/:10:0","tags":["Paper Reading"],"title":"Paper Reading: An Inquiry into Machine Learning-based Automatic Configuration Tuning Services on Real-World Database Management Systems","uri":"/posts/ml-based-autotunning/"},{"categories":null,"content":"MB2: Decomposed Behavior Modeling for Self-Driving Database Management Systems self-driving database management systems ","date":"2024-04-05","objectID":"/posts/mb2-self-driving-db/:1:0","tags":["Paper Reading"],"title":"Paper Reading: MB2: Decomposed Behavior Modeling for Self-Driving Database Management Systems","uri":"/posts/mb2-self-driving-db/"},{"categories":null,"content":"ABSTRACT Database management systems (DBMSs) are notoriously difficult to deploy and administer.self-driving DBMS is to remove these impediments by managing itself automatically predict the DBMSâ€™s runtime behavior and resource consumption. ModelBot2 e2e framework for constructing and maintaining prediction models using machine learning (ML) in self-driving DBMSs. decomposes a DBMSâ€™s architecture into fine-grained operating units that make it easier to estimate the systemâ€™s behavior for configurations ModelBot2 then provides an offline execution environment to exercise the system to produce the training data used to train its models. We integrated ModelBot2 in an in-memory DBMS and measured its ability to predict its performance for OLTP and OLAP workloads running in dynamic environments. We also compare ModelBot2 against state-of-the-art ML models and show that our models are up to 25Ã—more accurate in multiple scenarios å®Œå…¨è‡ªæ²»çš„æ•°æ®åº“ï¼Œç”¨ ML é¢„æµ‹å’Œä¿®æ”¹é…ç½®ã€‚å’ŒåŒæ ·æ˜¯ Andy ç»„çš„ Ottertune åŒºåˆ«åœ¨å“ªå‘¢ï¼Ÿ ","date":"2024-04-05","objectID":"/posts/mb2-self-driving-db/:2:0","tags":["Paper Reading"],"title":"Paper Reading: MB2: Decomposed Behavior Modeling for Self-Driving Database Management Systems","uri":"/posts/mb2-self-driving-db/"},{"categories":null,"content":"INTRODUCTION A self-driving DBMS can configure, tune, and optimize itself without human intervention, even as the applicationâ€™s workload, dataset, and operating environment evolve. Such automation seeks to remove the complications and costs involved with DBMS deployments. The core component that underlies a self-driving DBMSâ€™s decision-making is behavior models [51]. These models estimate and explain how the systemâ€™s performance changes due to a potential action (e.g., changing knobs, creating an index). This is similar to how self-driving vehicles use physical models to guide their autonomous planning [49]. Techniques for constructing database behavior models fall under two categories: (1) â€œwhite-boxâ€ analytical methods and (2) ML methods. Analytical models use a human-devised formula to describe a DBMS componentâ€™s behavior, such as the buffer pool or lock manager [42, 45, 74]. These models are customized per DBMS and version. They are difficult to migrate to a new DBMS and require redesign under system updates or reconfiguration. Recent works on using ML methods to construct models have shown that they are more adaptable and scalable than white-box approaches, but they have several limitations. These works mostly target isolated query execution [9, 17, 20, 34, 40]. The models that support concurrent queries focus on real-time settings where the interleaving of queries is known [16, 68, 72], but a self-driving DBMS needs to plan for future workloads without such accurate information [37]. Many ML-based models also rely on dataset or workload-dependent information [16, 40, 58]; thus, a DBMS cannot deploy these models in new environments without expensive retraining. white-box analytical æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆæŒ‡çš„æ˜¯ Buffer Pool å’Œ Lock Managerï¼Ÿç™½ç›’æ˜¯å¼€å‘äººå‘˜å¯ä»¥çœ‹åˆ°æ‰€æœ‰çš„å†…éƒ¨ç»„ä»¶å’Œæºç ï¼Œæ‰€ä»¥èƒ½å¤ŸçŸ¥é“ buffer pool å’Œ lock manager ä¸­çš„å†…å®¹ï¼Œç”šè‡³é¢„æµ‹å—ï¼Ÿ ä½¿ç”¨ ML æ–¹æ³•æ¥æ„å»ºæ¨¡å‹ï¼Œæ›´é€‚åˆæ‰©å±•ï¼Œä½†å­˜åœ¨å±€é™ï¼Œä¹‹å‰çš„å·¥ä½œä¸»è¦é›†ä¸­åœ¨éš”ç¦»çš„æŸ¥è¯¢ï¼Œè€Œæ”¯æŒå¹¶è¡ŒæŸ¥è¯¢çš„æ¨¡å‹ä¸»è¦é›†ä¸­åœ¨å®æ—¶è®¾ç½®å¹¶ä¸”äº¤ç»‡æŸ¥è¯¢å·²çŸ¥ã€‚å®Œå…¨è‡ªæ²»çš„ DBMS æ— æ³•çŸ¥é“å‡†ç¡®çš„ä¿¡æ¯ï¼Œè€Œä¸”ä¸€äº› ML é¢„æµ‹æ¨¡å‹ä¾èµ–äºæ•°æ®é›†/workload ä¿¡æ¯ã€‚ç”šè‡³è¿˜éœ€è¦è®­ç»ƒã€‚ æœ¬æ–‡æå‡ºäº† ModelBot2 (MB2), generates behavior models that estimate the performance of a self-driving DBMSâ€™s components and their interference during concurrent execution. ä½¿å¾— DBMS planning components å¯ä»¥æ¨ç†å¯¹ action çš„å½±å“ï¼ŒæœŸæœ›æ”¶ç›Šã€‚æ¯”å¦‚ï¼ŒMB2 å¯ä»¥å›ç­”åˆ›å»ºç´¢å¼•éœ€è¦å¤šé•¿æ—¶é—´ï¼Œç´¢å¼•åˆ›å»ºä¼šæ€ä¹ˆå½±å“ç³»ç»Ÿæ€§èƒ½ï¼Œæ–°ç´¢å¼•ä¼šå¦‚ä½•åŠ é€Ÿ workloadâ€™s queryã€‚ MB2 ä¸»è¦æ€æƒ³æ˜¯åˆ†è§£ DBMS çš„å†…éƒ¨ç»“æ„ï¼Œåˆ†æˆäº†å‡ ä¸ªå°çš„ã€äº’ç›¸ç‹¬ç«‹çš„æ“ä½œå•å…ƒ operating units (OUs) (e.g., building a hash table, flushing log records). MB2 then uses ML methods to train an OU-model for each OU that predicts its runtime and resource consumption for the current DBMS stateã€‚ å°çš„ OU å•å…ƒæ¨¡å‹éœ€è¦æ›´å°‘çš„è®­ç»ƒæ—¶é—´ï¼Œå¹¶ä¸”å¯¹æ¯ä¸ª DBMS ç»„ä»¶éƒ½æœ‰æ€§èƒ½ insightã€‚æ¨ç†æ—¶ï¼ŒMB2 ç»“åˆæ‰€æœ‰ OU-models é¢„æµ‹ DBMS å¯¹æœªæ¥çš„ workload çš„æ€§èƒ½å’Œç³»ç»ŸçŠ¶æ€ï¼ˆå·¥ä½œé‡ä¹Ÿæ˜¯é¢„æµ‹çš„ï¼‰ã€‚ multi-core environments with concurrent threads, MB2 also estimates the interference between OUs by defining the OUmodelsâ€™ outputs as a set of measurable performance metrics that summarizes each OUâ€™s behavior æ‹†æˆæ›´å°å•å…ƒï¼Œè®­ç»ƒæ¯ä¸ªå°çš„ï¼Œè”åˆé¢„æµ‹ã€‚è¯„æµ‹ç»“æœæ”¯æŒ OLTP OLAP å·¥ä½œè´Ÿè½½ï¼Œwith a minimal loss of accuracy ","date":"2024-04-05","objectID":"/posts/mb2-self-driving-db/:3:0","tags":["Paper Reading"],"title":"Paper Reading: MB2: Decomposed Behavior Modeling for Self-Driving Database Management Systems","uri":"/posts/mb2-self-driving-db/"},{"categories":null,"content":"BACKGROUND AND MOTIVATION ç±»æ¯” self-driving DBMS å’Œæ— äººé©¾é©¶ï¼ŒåŒæ ·æœ‰ 1. forecasting 2. behavior model 3. planning system The forecasting system is how the DBMS observes and predicts the applicationâ€™s future workload The DBMS then uses these forecasts with its behavior models to predict its runtime behavior relative to the target objective function (e.g., latency, throughput). The DBMSâ€™s planning system selects actions that improve this objective function é¢„æµ‹ + action + ç›®æ ‡å‡½æ•° Behavior models æ˜¯åŸºç¡€ ","date":"2024-04-05","objectID":"/posts/mb2-self-driving-db/:4:0","tags":["Paper Reading"],"title":"Paper Reading: MB2: Decomposed Behavior Modeling for Self-Driving Database Management Systems","uri":"/posts/mb2-self-driving-db/"},{"categories":null,"content":"Behavior Modeling Given an action, a self-driving DBMSâ€™s behavior models estimate (1) how long the action takes, (2) how much resource the action consumes, (3) how applying the action impacts the system performance, and (4) how the action impacts the system once it is deployed. å¯¹æ¯” Analytical models å’Œ Behavir Modelï¼Œå‰è€…æœ€è¿‘å¯ä»¥ç”¨ ML åˆ†æï¼Œç”¨ query plan information (cardinality estimates) ä¼°è®¡æ€§èƒ½å‚æ•° (latency) å°½ç®¡ ML æ–¹æ³•å¯æ‰©å±•ï¼Œä½†è¿˜éœ€è¦è°ƒæ•´æˆ–é‡æ–°è®­ç»ƒï¼Œè€Œä¸”ä¸æ”¯æŒäº‹åŠ¡ workloadï¼Œä¹Ÿæ²¡è€ƒè™‘ DBMS ç»´æŠ¤æ“ä½œï¼ˆGCï¼‰ã€‚ä¸€äº›æ–¹æ³•æ”¯æŒå¹¶å‘æŸ¥è¯¢ï¼Œä½†å¯¹å®Œå…¨è‡ªæ²»çš„ DBMS è¿˜ä¸å¤Ÿï¼Œå› ä¸ºæœªæ¥å·¥ä½œé‡æœªçŸ¥ã€‚ ä¸¾äº†ä¸ªä¾‹å­ï¼Œå¦‚æœåˆ é™¤äºŒçº§ç´¢å¼•ï¼ŒDBMS ä¼šé‡æ–°åŠ å›æ¥ï¼Œå¯åŠ¨ä¹‹å‰ä¼šç”¨ planning component å’Œ behavior model é¢„æµ‹ä»€ä¹ˆç´¢å¼•æ¯”è¾ƒå¥½ï¼Œè¿˜ä¼šé€‰æ‹©åˆ›å»ºç´¢å¼•çš„çº¿ç¨‹æ•°ã€‚ ","date":"2024-04-05","objectID":"/posts/mb2-self-driving-db/:4:1","tags":["Paper Reading"],"title":"Paper Reading: MB2: Decomposed Behavior Modeling for Self-Driving Database Management Systems","uri":"/posts/mb2-self-driving-db/"},{"categories":null,"content":"Challenges ML æ–¹æ³•å»ºé€ ä¸€ä¸ªè‡ªæ²» DBMS ä¼šé‡åˆ°çš„é—®é¢˜ï¼š High Dimensionality é«˜çº¬åº¦ï¼Œä¸€ä¸ªå¤§æ¨¡å‹æ•æ‰ DBMS æ‰€æœ‰æ–¹é¢ï¼Œworkload, configuration, actions. è‡ªæ²» DBMS è¿˜éœ€è¦è€ƒè™‘ runtime state (e.g., database contents, knob configurations), interactions with other components (e.g., garbage collection), and other autonomous actions (e.g., building indexes), which further increases dimensionality Concurrent Operations å¹¶è¡Œæ“ä½œï¼ŒåŠ¨æ€ç¯å¢ƒ query ä¹‹é—´çš„å¹²æ¶‰ interferenceï¼Œèµ„æºç«äº‰ã€‚ Training, Generalizability, and Explainabilityï¼Œèµ„æºæ”¶é›†æ¯”è¾ƒå›°éš¾ï¼Œæ„å»ºç´¢å¼•è€—æ—¶å¾ˆä¹…ã€‚ ","date":"2024-04-05","objectID":"/posts/mb2-self-driving-db/:4:2","tags":["Paper Reading"],"title":"Paper Reading: MB2: Decomposed Behavior Modeling for Self-Driving Database Management Systems","uri":"/posts/mb2-self-driving-db/"},{"categories":null,"content":"OVERVIEW MB2, embedde behavior modeling framework for self-driving DBMS. MB2 generates model offline in a dataset and workload independent manner MB2â€™s models are debuggable, explainable, and adaptable. decompose the DBMS into independent operating units (OUs). An OU represents a step that the DBMS performs to complete a specific task. These tasks include query execution steps (e.g., building join hash tables (JHTs)) and internal maintenance steps (e.g., garbage collection). DBMS developers are responsible for creating OUs and deciding their boundaries based on the systemâ€™s implementation. MB2 pairs each OU with an OU-runner that exercises the OUâ€™s corresponding DBMS component by sweeping the componentâ€™s input parameter space. MB2 then provides a lightweight data collection layer to transform these OU-runnersâ€™ inputs to OU features and track the OUâ€™s behavior metrics (e.g., runtime, CPU utilization). For each OU, MB2 automatically searches, trains, and validates an OU-model using the data collected from the related OU-runner simulate concurrent enviornments, MB2 uses concurrent runners to execute e2e workloads. å°†æ•°æ®åº“æ“ä½œæ‹†æˆ OU å’Œå¯¹åº”çš„ OU runnerï¼Œæ¯”å¦‚åˆ›å»ºç´¢å¼•ã€åƒåœ¾å›æ”¶ã€Flush Logï¼Œå¼€å‘è€…æ¥æä¾› OU é›†åˆã€‚OU runner ç”¨äºè®­ç»ƒ OU æ¨¡å‹ï¼Œéœ€è¦çŸ¥é“æœ‰å¤šå°‘ tuple, column ç­‰ç­‰ï¼Œä»¥åŠ output feature: CPU, memory utilization, IO ç­‰ç­‰ã€‚ MB2 also estimates the effect of building the index on the regular workload by converting its queries into OUs and predicting their performance. The DBMSâ€™s planning system then decides whether to build this index and provides explanations for its decision based on these detailed predictions Assumptions and Limitations: framework uses a forecasting system to generate estimations for future workload arrival rates in fixed intervals (e.g., a minute/hour). The workload forecasting system cannot predict ad-hoc queries it has never seen before. Thus, we assume the DBMS executes queries with a cached query plan except for the initial invocation the target system is an in-memory DBMS. MB2 does not support disk-oriented DBMSs with buffer pools. This assumption simplifies MB2â€™s behavior models since it does not have to consider what pages could be in memory for each query. Estimating cache contents is difficult enough for a single query. It is more challenging when evaluating a sequence of forecasted queries. MB2 supports OLTP and OLAP, and mixed workloads. We assume that the DBMS uses MVCC and MB2 supports capturing lock contention. MB2 does not, however, model transaction aborts due to data conflicts because it is challenging to get precise forecasts of overlapping queries MB2â€™s OU-modelsâ€™ input features contain the cardinality estimation from the DBMS optimizer, which is known to be error-prone Our evaluation shows that MB2â€™s prediction is insensitive against cardinality estimation errors within a reasonable range (30%). There are recent works that use ML to improve an optimizerâ€™s cardinality estimations , which MB2 may leverage Lastly, while MB2 supports hardware context in its models (see Sec. 4.2), we defer the investigation on what features to include for different hardware (e.g., CPU, disk) and environments (e.g., bare-metal, container) as future work. æ²¡æ³•é¢„æµ‹ ad-hoc ç”¨æˆ·è‡ªå·±çš„æ•°æ®é›†ï¼Œé¢„æµ‹ç¼“å­˜éå¸¸å›°éš¾ã€‚ä¹Ÿåªæ”¯æŒå†…å­˜æ•°æ®åº“ã€‚ ","date":"2024-04-05","objectID":"/posts/mb2-self-driving-db/:5:0","tags":["Paper Reading"],"title":"Paper Reading: MB2: Decomposed Behavior Modeling for Self-Driving Database Management Systems","uri":"/posts/mb2-self-driving-db/"},{"categories":null,"content":"OU-MODELS create a DBMSâ€™s OU-models with MB2. The goal of these models is to estimate the time and resources that the DBMS will consume to execute a query or action. A self-driving DBMS can make proper planning decisions by combining these estimates from multiple queries in a workload forecast interval. In addition to accuracy, these models need to have three properties that are important for self-driving operations: (1) they provide explanations of the DBMSâ€™s behavior, (2) they support any dataset and workload, and (3) they adapt to DBMS software updates é™¤äº†ç²¾ç¡®åº¦ï¼Œèƒ½å¤Ÿæä¾›è§£é‡Šã€æ”¯æŒä»»ä½•æ•°æ®é›†ã€æ”¯æŒåŠ¨æ€æ›´æ–° ","date":"2024-04-05","objectID":"/posts/mb2-self-driving-db/:6:0","tags":["Paper Reading"],"title":"Paper Reading: MB2: Decomposed Behavior Modeling for Self-Driving Database Management Systems","uri":"/posts/mb2-self-driving-db/"},{"categories":null,"content":"Principles Developers use MB2 to decompose the DBMS into OUs to build explainable, adaptable, and workload independent behavior models. å¼€å‘äººå‘˜æ¥åš decompose, å› ä¸º NoisePage æ˜¯ CMU è‡ªå·±çš„å…³ç³»å‹æ•°æ®åº“ï¼Œå¯ä»¥æ‹†é™¤å¾ˆå¤šæ“ä½œå•å…ƒï¼Œæ¯”å¦‚ Hash Table Build, Probe ç­‰ç­‰ Independent: The runtime behavior of an OU must be independent of other OUs. Thus, changes to one OU do not directly affect another unrelated OU. For example, if the DBMS changes the knob that controls the join hash table size then this does not change the resource consumption of the DBMSâ€™s WAL component or the resource consumption of sequential scans for the same queries. æ¯”è¾ƒå¥½å¥‡æ€ä¹ˆæ‹†æˆç‹¬ç«‹çš„ OUï¼Œå¦‚æœæ”¹ join hash table sizeï¼Œä¼šä¸ä¼šå½±å“ join table probe OU å‘¢ Low-dimensional: An OU is a basic operation in the DBMS with a small number of input features. Comprehensive: Lastly, the framework must have OUs that encompass all DBMS operations which consume resources. Thus, for any workload, the OUs cover the entire DBMS, including background maintenance tasks (e.g., garbage collection) and self-driving actions that the DBMS may deploy on its own (e.g., index creation). OU åˆ°åº•æ˜¯å¯¹ DBMS è®¾ç½®ï¼Œè¿˜æ˜¯é’ˆå¯¹æ•°æ®é›†è®¾ç½®çš„ï¼Ÿ ","date":"2024-04-05","objectID":"/posts/mb2-self-driving-db/:6:1","tags":["Paper Reading"],"title":"Paper Reading: MB2: Decomposed Behavior Modeling for Self-Driving Database Management Systems","uri":"/posts/mb2-self-driving-db/"},{"categories":null,"content":"Input Features After deciding which OUs to implement, DBMS developers then specify the OU-modelsâ€™ input features based on their degree of freedom the amount of work for a single OU invocation or multiple OU invocations in a batch (the number of tuples to process) the parallel invocation status of an OU (e.g., number of threads to create an index), and the DBMS configuration knobs (e.g., the execution mode). degree of freedom ç»Ÿè®¡å­¦æ¦‚å¿µï¼Ÿ Although humans select the features for each OU-model, the featuresâ€™ values are generated automatically by the DBMS based on the workload and actions. Some features are generic and will be the same across many DBMSs, whereas others are specific to a DBMSâ€™s implementation. We categorize OUs into three types based on their behavior pattern, which impacts what information the input features have Singular OUs: The first type of OUs have input features that represent the amount of work and resource consumption for a single invocation. These include NoisePageâ€™s execution category OUs in Table 1. Almost all its execution OUs have the same seven input features. The first six features are related to the relational operator that the OU belongs to: (1) number of input tuples, (2) number of columns of input tuples, (3) average input tuple size, (4) estimated key cardinality (e.g., sorting, joins), (5) payload size (e.g., hash table entry size for hash joins), and (6) number of loops (only for index nested loop joins). Lastly, the seventh feature is an execution mode flag that is specific to NoisePage; this indicates whether the DBMS executes a query with its interpreter or as JIT-compiled. NoisePageâ€™s networking OU also belongs to this type since network communication is discrete amount of work. Batch OUs: The second type of OUs have input features that represent a batch of work across multiple OU invocations. It is challenging to derive features for these OUs since a single invocation may span multiple queries based on when those queries arrive and the invocation interval. (log flushes) To address this, we define the log flush OUâ€™s input features to represent the total amount of records generated by the set of queries predicted to arrive in a workload forecasting interval: (1) the total number of bytes, (2) the total number of log buffers, and (3) the log flush interval. These features are independent of what plans the DBMS chooses for each query Contending OUs: The last type of OUs are for operations that may incur contention in parallel invocations. ç‹¬ç«‹çš„ OUï¼Œæ‰¹å¤„ç† OUï¼Œç«äº‰ OUã€‚ç¬¬ä¸€ä¸ªå¯ä»¥è¿ç§»ï¼Œå› ä¸º input ç±»ä¼¼ï¼Œæ¯”å¦‚è¡Œæ•°ã€åˆ—æ•°ã€è¡Œå¤§å°ã€åŸºæ•°ç­‰ç­‰ã€‚ç¬¬äºŒä¸ªå¯èƒ½è·¨ query æ¯”å¦‚æ—¥å¿—è½ç›˜ã€‚ç¬¬ä¸‰ä¸ªæ˜¯å¹¶è¡Œå¯èƒ½å¼•èµ·é”ç«äº‰çš„ OUï¼Œæ¯”å¦‚å¤šçº¿ç¨‹æ„å»ºç´¢å¼•ï¼Œéœ€è¦çŸ¥é“è¡Œæ•°ã€key æ•°é‡ã€key å¤§å°ã€key åŸºæ•°ä¼°è®¡ã€ç­‰ç­‰ A self-driving DBMS must also predict how changes to its configuration knobs impact its OUs. We categorize these tunable knobs into behavior knobs and resource knobs. ","date":"2024-04-05","objectID":"/posts/mb2-self-driving-db/:6:2","tags":["Paper Reading"],"title":"Paper Reading: MB2: Decomposed Behavior Modeling for Self-Driving Database Management Systems","uri":"/posts/mb2-self-driving-db/"},{"categories":null,"content":"Output Labels Every OU-model produces the same output labels, (1) elapsed time, (2) CPU time, (3) CPU cycles, (4) CPU instructions, (5) CPU cache references, (6) CPU cache misses, (7) disk block reads, (8) disk block writes (for logging), and (9) memory consumption. These metrics explain what work an OU does independent of which OU it is. Using the same labels enables MB2 to combine them together to predict the interference among concurrent OUs. They also help the self-driving DBMS estimate the impact of knobs for resource allocation. For example, the OU-models can predict each queryâ€™s memory consumption by predicting the memory consumption for all the OUs related to the query. A self-driving DBMS evaluates what queries can execute under the knob that limits the working memory for each query, and then sets that knob according to its memory budget. Similarly, CPU usage predictions help a self-driving DBMS evaluate whether it has assigned enough CPU resources for queries or its internal components OU-model è¾“å‡º labelï¼Œæ‰€ä»¥æœ‰åˆ©äº debug Output Label Normalization: We now discuss how MB2 normalizes OU-modelsâ€™ output labels by tuple counts to improve their accuracy and efficiency. DBMSs can execute queries that range from accessing a single tuple (i.e., OLTP workloads) to scanning billions of tuples (i.e., OLAP workloads). The former is fast to replicate with OU-runners, but the latter is expensive and time-consuming. To overcome this issue, MB2 employs a normalization method inspired by a previous approach for scaling query execution modeling [34]. We observe that many OUs have a known complexity based on the number of tuples processed, which we denote as ğ‘›. For example, if we fix all the input features except for ğ‘›, the time and resources required to build a hash table for a join are O(ğ‘›). Likewise, the time and resources required to build buffers for sorting are O(ğ‘› log ğ‘›). We have found in our evaluations with NoisePage that with typically less than a million tuples, the output labels converge to the OUâ€™s asymptotic complexity multiplied by a constant factor å¦‚ä½•å¤„ç† labelï¼Ÿä½¿ç”¨ normalize, divides the outputs by the related OUâ€™s complexity based on the number of tuples, ä½†æ˜¯æ„å»ºå“ˆå¸Œè¡¨æ—¶ï¼Œç”±äº NoisePage ä½¿ç”¨ä¸åŒçš„å“ˆå¸Œè¡¨å¤„ç† join å’Œ aggï¼šé¢„å…ˆåˆ†é…å†…å­˜ç»™ joinï¼Œå“ˆå¸Œè¡¨ä¼šå¯¹æ’å…¥çš„ unique key é¢å¤–å¢é•¿ã€‚æ‰€ä»¥ MB2 éœ€è¦ç”¨é™¤æ³•æ¥å½’ä¸€åŒ–ã€‚ ","date":"2024-04-05","objectID":"/posts/mb2-self-driving-db/:6:3","tags":["Paper Reading"],"title":"Paper Reading: MB2: Decomposed Behavior Modeling for Self-Driving Database Management Systems","uri":"/posts/mb2-self-driving-db/"},{"categories":null,"content":"INTERFERENCE MODEL The OU-models capture the internal contention on data structures or latches within an OU (Sec. 4.2). But there can also be interference among OUs due to resource competition, such as CPU, I/O, and memory.2 MB2 builds a common interference model to capture such interference since it may impact any OU. è®ºæ–‡ä¹Ÿè§‚å¯Ÿåˆ°ï¼ŒOU ä¹‹é—´ä¹Ÿå­˜åœ¨èµ„æºå…±äº«ï¼Œæ¯”å¦‚è¿ç»­è¿è¡Œçš„ OU ä¼šæœ‰ç¼“å­˜å±€éƒ¨æ€§ã€‚ä½†è®ºæ–‡è¯´è¿™æ˜¯æç«¯æƒ…å†µã€‚ Building such an interference model has two challenges: (1) there are an exponential number of concurrent OU combinations, and (2) self-driving DBMSs need to plan actions ahead of time [50], but predicting queriesâ€™ exact future arrival times and concurrent interleavings is arguably impossible éœ€è¦æå‰é¢„æµ‹ï¼Œä½†ä¸èƒ½ç²¾ç¡®é¢„æµ‹å¹¶è¡Œå‘ç”Ÿçš„æ—¶é—´ï¼Œå¹¶ä¸” OU ç»„åˆæ˜¯æŒ‡æ•°çº§çš„ ","date":"2024-04-05","objectID":"/posts/mb2-self-driving-db/:7:0","tags":["Paper Reading"],"title":"Paper Reading: MB2: Decomposed Behavior Modeling for Self-Driving Database Management Systems","uri":"/posts/mb2-self-driving-db/"},{"categories":null,"content":"Input Features The interference modelâ€™s inputs are the OU-modelâ€™s output labels for the OU to predict and summary statistics of the OUs forecasted to run in the same interval (e.g., one minute). ","date":"2024-04-05","objectID":"/posts/mb2-self-driving-db/:7:1","tags":["Paper Reading"],"title":"Paper Reading: MB2: Decomposed Behavior Modeling for Self-Driving Database Management Systems","uri":"/posts/mb2-self-driving-db/"},{"categories":null,"content":"Output Labels The interference model generates the same set of outputs as the OU-models. ","date":"2024-04-05","objectID":"/posts/mb2-self-driving-db/:7:2","tags":["Paper Reading"],"title":"Paper Reading: MB2: Decomposed Behavior Modeling for Self-Driving Database Management Systems","uri":"/posts/mb2-self-driving-db/"},{"categories":null,"content":"DATA GENERATION AND TRAINING MB2 is an end-to-end solution that enables self-driving DBMSs to generate training data from OUs and then build accurate models that predict their behavior. MB2 å¦‚ä½•æœ‰åˆ©äºæ”¶é›†æ•°æ®å’Œè®­ç»ƒæ¨¡å‹ï¼Œå¹¶ä¸”å†æ¬¡å¼ºè°ƒéœ€è¦åœ¨ç¦»çº¿æƒ…å†µä¸‹ï¼Œéç”Ÿäº§ç¯å¢ƒï¼Œè¿è¡Œ MB2ã€‚æ¨è¿Ÿäº†å¦‚ä½•åœ¨åœ¨çº¿ç³»ç»Ÿæ”¶é›†æ•°æ®ï¼Œè€Œä¸ä¼šå¯¼è‡´æ€§èƒ½è§‚å¯Ÿé€€åŒ–çš„é—®é¢˜ã€‚ ","date":"2024-04-05","objectID":"/posts/mb2-self-driving-db/:8:0","tags":["Paper Reading"],"title":"Paper Reading: MB2: Decomposed Behavior Modeling for Self-Driving Database Management Systems","uri":"/posts/mb2-self-driving-db/"},{"categories":null,"content":"Data Collection Infrastructure OU Translator: This component extracts OUs from query and action plans and then generates their corresponding input features. MB2 uses the same translator infrastructure for both offline training data collection and runtime inference. Resource Tracker: Next, MB2â€™s tracker records the elapsed time and resource consumption metrics (i.e., output labels) during OUs execution. The framework also uses this method for the interference model data since it uses the same output labels to adjust the OU-modelsâ€™ outputs. Metrics Collector: The challenges with collecting training data are that (1) multiple threads produce metrics and thus require coordination, and (2) resource tracker can incur a noticeable cost. It is important for MB2 to support low-overhead metrics collection to reduce the cost of accumulating training data and interference with the behavior of OUs, especially in concurrent environments MB2 uses a decentralized metrics collector to address the first issue. When the DBMS executes in training mode, a worker thread records the features and metrics for each OU that it encounters in its thread-local memory. MB2 then uses a dedicated aggregator to periodically gather this data from the threads and store it in the DBMSâ€™s training data repository. To address the second challenge, MB2 supports resource tracking only for a subset of queries or DBMS components. For example, when MB2 collects training data for the OUs in the execution engine, the DBMS can turn off the tracker and metrics collector for other components æ•°æ®æ”¶é›†çš„æ¶æ„ ","date":"2024-04-05","objectID":"/posts/mb2-self-driving-db/:8:1","tags":["Paper Reading"],"title":"Paper Reading: MB2: Decomposed Behavior Modeling for Self-Driving Database Management Systems","uri":"/posts/mb2-self-driving-db/"},{"categories":null,"content":"OU-Runners An OU-runner is a specialized microbenchmark in MB2 that exercises a single OU. The goal of each OU-runner is to reproduce situations that an OU could encounter when the DBMS executes a real applicationâ€™s workload. The OU-runners sweep the input feature space (i.e., number of rows, columns, and column types) for each OU with fixed-length and exponential step sizes, which is similar to the grid search optimization There are two ways to implement OU-runners: (1) low-level execution code that uses the DBMSâ€™s internal API and (2) high level SQL statements. We chose the latter for NoisePage because it requires less upfront engineering effort to implement them, and has little to no maintenance costs if the DBMSâ€™s internal API changes ç”¨ SQL statement å®ç° OU runner æ˜¯æ€ä¹ˆåšåˆ°çš„ MB2 supports modeling OLTP and OLAP workloads. To the best of our knowledge, we are the first to support both workload and data-independent modeling for OLTP query execution. Prior work either focused on modeling OLAP workloads [34, 40, 68] or assumes a fixed set of queries/stored procedures in the workload [42, 45]. Modeling the query execution in OLTP workloads is challenging for in-memory DBMSs: since OLTP queries access a small number of tuples in a short amount of time, spikes in hardware performance (e.g., CPU scaling), background noise (e.g., OS kernel tasks), and the precision of the resource trackers (e.g., hardware counters) can inflict large variance on query performance. Furthermore, DBMSs typically execute repeated OLTP queries as prepared statements ç¬¬ä¸€ä¸ªæ”¯æŒ OLAP å’Œ OLTP æ•°æ®é›†ï¼Œå¹¶ä¸”æ˜¯ workload and data-independent çš„ï¼Œæ”¯æŒ OLTPã€‚ä½† NoisePage æœ¬èº«å°±æ˜¯äº‹åŠ¡æ•°æ®åº“ï¼ŒMB2 æ˜¯æ€ä¹ˆåšåˆ°è¿™ç§ç‰¹æ€§çš„ã€‚ MB2 executes the OU-runners for the OUs in the execution engine with sufficient repetitions (10Ã—) and applies robust statistics to derive a reliable measurement of the OUâ€™s behavior. MB2 executes each query for five warm-up iterations before taking measurements for the queryâ€™s OUs, with all executions of a given query using the same query template. MB2 starts a new transaction for each execution to avoid the data residing in CPU caches. For queries that modify the DBMS state, MB2 reverts the queryâ€™s changes using transaction rollbacks. We find the labels insensitive to the trimmed mean percentage and the number of warm-up iterations. å¤šæ¬¡é‡å¤å’Œ warm upï¼Œæ‰€ä»¥è¿™æ˜¯æ²¡æ³•åœ¨ ç£ç›˜ DBMS ä½¿ç”¨ MB2 çš„åŸå› å—ï¼Œæ²¡æœ‰åŠæ³•é¢„æµ‹ buffer pool ä¸­çš„å†…å®¹ï¼Œé‚£ NoisePage æœ‰ç¼“å­˜å—ï¼Ÿ MB2 starts a new transaction for each execution to avoid the data residing in CPU caches. For queries that modify the DBMS state, MB2 reverts the queryâ€™s changes using transaction rollbacks. We find the labels insensitive to the trimmed mean percentage and the number of warm-up iterations. æ¯æ¬¡éƒ½æ˜¯ç”¨äº‹åŠ¡ï¼Œé¿å…äº† CPU data cacheï¼Œå¹¶ä¸”ç”¨ rollback æ”¹å›äº† DBMS çš„çŠ¶æ€ã€‚label å’Œ trimmed mean percentage and warmup iterations ä¸æ•æ„Ÿã€‚é‚£ä¸ºä»€ä¹ˆè¦ warm upï¼Ÿ ","date":"2024-04-05","objectID":"/posts/mb2-self-driving-db/:8:2","tags":["Paper Reading"],"title":"Paper Reading: MB2: Decomposed Behavior Modeling for Self-Driving Database Management Systems","uri":"/posts/mb2-self-driving-db/"},{"categories":null,"content":"Concurrent Runners Since OU-runners invoke their SQL queries one at a time, MB2 also provides concurrent runners that execute end-to-end benchmarks (e.g., TPC-C, TPC-H). These concurrent runners provide MB2 with the necessary data to train its interference model ","date":"2024-04-05","objectID":"/posts/mb2-self-driving-db/:8:3","tags":["Paper Reading"],"title":"Paper Reading: MB2: Decomposed Behavior Modeling for Self-Driving Database Management Systems","uri":"/posts/mb2-self-driving-db/"},{"categories":null,"content":"Model Training Lastly, we discuss how MB2 trains its behavior models using the runner-generated data. Since OUs have different input features and behaviors, they may require using different ML algorithms that are better at handling their unique properties and assumptions about their behavior. For example, Huber regression (a variant of linear regression) is simple enough to model the filter OUs with arithmetic operations. In contrast, sorting and hash join OUs require more complex models, such as random forests, to support their behaviors under different key number, key size, and cardinality combinations ä½¿ç”¨ä¸åŒçš„ ML æ–¹æ³•ï¼Œé‚£æ€ä¹ˆé€‰ï¼Ÿ MB2 trains multiple models per OU and then automatically selects the one with the best accuracy for each OU. MB2 currently supports seven ML algorithms for its models: (1) linear regression, (2) Huber regression, (3) support vector machine, (4) kernel regression, (5) random forest, (6) gradient boosting machine, and (7) deep neural network. For each OU, MB2 first trains an ML model using each algorithm under the common 80/20% train/test data split and then uses cross-validation to determine the best ML algorithm to use. MB2 then trains a final OU-model with all the available training data using the best ML algorithm determined previously. Thus, MB2 utilizes all the data that the runners collect to build the models. MB2 uses this same procedure to train its interference models. è‡ªåŠ¨é€‰äº† ML æ–¹æ³•ï¼ˆç²¾åº¦æœ€é«˜çš„ï¼‰ ","date":"2024-04-05","objectID":"/posts/mb2-self-driving-db/:8:4","tags":["Paper Reading"],"title":"Paper Reading: MB2: Decomposed Behavior Modeling for Self-Driving Database Management Systems","uri":"/posts/mb2-self-driving-db/"},{"categories":null,"content":"HANDLING SOFTWARE UPDATES è®¨è®ºäº† DBMS å¯ä»¥æ›´æ–°ï¼ˆbug ä¿®å¤ï¼Œæ€§èƒ½æå‡ç­‰ç­‰ï¼‰çš„æƒ…å†µä¸‹ï¼Œè‡ªåŠ¨é©¾é©¶çš„ DBMS åº”è¯¥æ€ä¹ˆå¤„ç†ã€‚å› ä¸º OUs ä¹‹é—´æ˜¯ç‹¬ç«‹çš„ï¼ŒMB2 åªéœ€è¦é‡æ–°è·‘å—å½±å“çš„ OU-runners ã€‚ This restricted retraining is possible because the OUs are independent of each other. The OU-runners issue SQL queries to the DBMS to exercise the OUs, which means that developers do not need to update them unless there are changes to the DBMSâ€™s SQL syntax. Furthermore, MB2 does not need to retrain its interference models in most cases because resource competition is not specific to any OU. In NoisePage, we currently use a heuristic for MB2 to retrain the interference models when a DBMS update affects at least five OUs ä¸éœ€è¦é‡æ–°è®­ç»ƒå¹²æ‰°æ¨¡å‹ï¼Œåªéœ€è¦é‡æ–°è·‘ OU runnerã€‚é™¤é DBMS å¼•å…¥äº†æ–°çš„ OU behavior æ¯”å¦‚æ–°çš„ç»„ä»¶ï¼ŒMB2 å°±éœ€è¦é‡æ–°è¿è¡Œ OU concurrent runners ç”Ÿæˆå¹²æ‰°æ¨¡å‹ã€‚ ","date":"2024-04-05","objectID":"/posts/mb2-self-driving-db/:9:0","tags":["Paper Reading"],"title":"Paper Reading: MB2: Decomposed Behavior Modeling for Self-Driving Database Management Systems","uri":"/posts/mb2-self-driving-db/"},{"categories":null,"content":"EXPERIMENTAL EVALUATION NoisePage DBMS: OLTP-Bench testbed as an end-to-end workload generator for the SmallBank, TATP , TPC-C, and TPC-H benchmarks. OLAP å’Œ OLTP éƒ½æµ‹äº†ï¼Œä½¿ç”¨ä¸åŒçš„æŒ‡æ ‡ We use two evaluation metrics. For OLAP workloads, we use the average relative error ( |ğ´ğ‘ğ‘¡ğ‘¢ğ‘ğ‘™âˆ’ğ‘ƒğ‘Ÿğ‘’ğ‘‘ğ‘–ğ‘ğ‘¡| ğ´ğ‘ğ‘¡ğ‘¢ğ‘ğ‘™ ) used in similar prediction tasks in previous work . Since OLTP queries have short run-times with high variance, their relative errors are too noisy to have a meaningful interpretation. Thus, we use the average absolute error ( |ğ´ğ‘ğ‘¡ğ‘¢ğ‘ğ‘™ âˆ’ğ‘ƒğ‘Ÿğ‘’ğ‘‘ğ‘–ğ‘ğ‘¡|) per OLTP query template ","date":"2024-04-05","objectID":"/posts/mb2-self-driving-db/:10:0","tags":["Paper Reading"],"title":"Paper Reading: MB2: Decomposed Behavior Modeling for Self-Driving Database Management Systems","uri":"/posts/mb2-self-driving-db/"},{"categories":null,"content":"Data Collection and Training MB2â€™s data collection and model training. çœ‹ä¸Šå»è®­ç»ƒæ•°æ®ä¸æ˜¯å¾ˆå¤§ï¼Œè®­ç»ƒæ—¶é—´ä¹Ÿä¸æ˜¯å¾ˆä¹…ã€‚ ","date":"2024-04-05","objectID":"/posts/mb2-self-driving-db/:10:1","tags":["Paper Reading"],"title":"Paper Reading: MB2: Decomposed Behavior Modeling for Self-Driving Database Management Systems","uri":"/posts/mb2-self-driving-db/"},{"categories":null,"content":"OU-Model Accuracy the OU-model test relative error averaged across all output labels. More than 80% of the OU-models have an average prediction error less than 20%, which demonstrates the effectiveness of the OU-models. OU æ¨¡å‹çš„é¢„æµ‹è¯¯å·®å°äº 20%ï¼Œè¯æ˜äº†æœ‰æ•ˆæ€§ã€‚ä½†æ²¡çœ‹æ‡‚è¿™ä¸ªç»“æœï¼Œç”¨ä¸åŒçš„ ML æ–¹æ³•å¾—åˆ°çš„è¯¯å·®éƒ½ä¸åŒï¼Œæœ‰çš„å¾ˆä½æœ‰çš„å¾ˆé«˜ï¼Œæ¯”å¦‚éšæœºæ£®æ—æ€»æ˜¯å¾ˆä½çš„è¯¯å·®ï¼Œè®ºæ–‡ä¹Ÿæåˆ° OU æ¨¡å‹ç»´åº¦å¾ˆä½ï¼Œå®¹æ˜“å‡ºç°è¿‡æ‹Ÿåˆã€‚ we show the predictive accuracy of the OU-models for each output label, averaging across all OUs. Most labels have an average error of less than 20%, where the highest error is on the cache miss label. Accurately estimating the cache misses for OUs is challenging because the metrics depend on the real-time contents of the CPU cache. Despite the higher cache miss error, MB2â€™s interference model still captures the interference among concurrent OUs (see Sec. 8.4) because the interference model extracts information from all the output labels. The results in Fig. 6 also show the OU-model errors without output label normalization optimization from Sec. 4.3. From this, we see that normalization has minimal impact on OU-model accuracy while enabling generalizability çœ‹ä¸Šå»ç»“æœå¾ˆå®¹æ˜“å—åˆ° CPU ç¼“å­˜å½±å“ã€‚ä½†å‰æ–‡åˆè¯´å½±å“ä¸å¤§ï¼Ÿèƒ½å¤Ÿé¢„æµ‹ query runtime å’Œ workload ","date":"2024-04-05","objectID":"/posts/mb2-self-driving-db/:10:2","tags":["Paper Reading"],"title":"Paper Reading: MB2: Decomposed Behavior Modeling for Self-Driving Database Management Systems","uri":"/posts/mb2-self-driving-db/"},{"categories":null,"content":"OU-Model Generalization For a state-of-the-art baseline, we compare against the QPPNet ML model for query performance prediction QPPNet uses a tree-structured neural network to capture a query planâ€™s structural information. It outperforms other recent models on predicting query runtime especially when generalizing the trained model to different workloads (e.g., changing dataset sizes) Since NoisePage is an in-memory DBMS with a fused-operator JIT query engine, we remove any disk-oriented features from QPPNetâ€™s inputs and adapt its operator-level tree structure to support pipelines. But such adaptation requires QPPNetâ€™s training data to contain all the operator combinations in the test data pipelines to do inference with the proper tree structure. Thus, we can only train QPPNet on more complex workloads (e.g., TPC-C) and test on the same or simpler workloads (e.g., SmallBank) è¿˜æ˜¯å¼ºè°ƒäº† NoisePage æ˜¯å†…å­˜æ•°æ®åº“ï¼Œè€Œä¸”æ˜¯ JIT çš„ We evaluate MB2 and QPPNet on the (1) TPC-H OLAP workload and (2) TPC-C, TATP, and SmallBank OLTP workloads. To evaluate generalizability, we first train a QPPNet model with query metrics from a 1 GB TPC-H dataset and evaluate it on two other dataset sizes (i.e., 0.1 GB, 10 GB). åœ¨ TPCH ä¸Šè®­ç»ƒå’Œè¯„ä¼°ã€‚QPPNET çš„å‡†ç¡®æ€§éå¸¸å¥½ï¼Œä½†åœ¨å…¶ä»–æ•°æ®é›†ä¸Šé”™è¯¯ç‡å¾ˆé«˜ã€‚ è€Œ MB2 æ¯” QPPNET é«˜ 25x çš„ç²¾åº¦ï¼Œå¹¶ä¸”æ‰€æœ‰ workload size ä¸Šé¢„æµ‹çš„ç²¾ç¡®åº¦éƒ½å¾ˆç¨³å®šã€‚ We attribute this difference to how (1) MB2 decomposes the DBMS into fine-grained OUs and the corresponding OU-runner enumerates various input features that cover a range of workloads, and (2) MB2â€™s output label normalization technique further bolsters OU-modelsâ€™ generalizability. æœ€é‡è¦çš„ä¸¤ä¸ªå› ç´ ï¼Œåˆ†è§£æˆå°çš„ OUï¼Œå°†ç»“æœ label normalizationï¼Œæ‰€ä»¥èƒ½å¤Ÿæ³›åŒ–ã€‚ Even though the 10 GB TPC-H workload has tables up to 60m tuples, which is 60Ã— larger than the largest table considered by MB2â€™s OU-runners, MB2 is still able to generalize with minimal loss of accuracy. MB2 without the output normalization has much worse accuracy on large datasets. å†æ¬¡å¼ºè°ƒ normalization çš„é‡è¦æ€§ ","date":"2024-04-05","objectID":"/posts/mb2-self-driving-db/:10:3","tags":["Paper Reading"],"title":"Paper Reading: MB2: Decomposed Behavior Modeling for Self-Driving Database Management Systems","uri":"/posts/mb2-self-driving-db/"},{"categories":null,"content":"Interference Model Accuracy We next measure the ability of MB2â€™s interference model to capture the impact of resource competition on concurrent OUs. We run the concurrent runner with the 1 GB TPC-H benchmark since it contains a diverse set of OUs. The concurrent runner enumerates three parameters: (1) subsets of TPC-H queries, (2) number of concurrent threads, and (3) query arrival rate. Since the interference model is not specific to any OU or DBMS configuration, the concurrent runner does not need to exercise all OU-model inputs or knobs. For example, with the knob that controls the number of threads, we only generate training data for odd-numbered settings (i.e., 1, 3, 5, . . . 19) and then test on even-numbered settings. The concurrent runner executes each query setup for 20s. To reduce the evaluation time, we assume the average query arrival rate per query template per 10s is given to the model. In practice, this interval can be larger. Neural network performs the best for this model given its capacity to consume the summary statistics of OU-model output labels To evaluate the modelâ€™s generalizability, the concurrent runner executes queries only in the DBMSâ€™s interpretive mode (execution knob discussed in Sec. 4.2), but we test the model under JIT compilation mode. We also evaluate the model with thread numbers and workload sizes that are different from those used by MB2â€™s concurrent runners. To isolate the interference modelâ€™s estimation, we execute the queries in both single-thread and concurrent environments and compare the true adjustment factors (the concurrent interference impact) against the predicted adjustment factors ä»€ä¹ˆæ˜¯ interpretive modeï¼Ÿ the actual and interference model-estimated average query run times under concurrent environments. The interference model has less than 20% error in all cases. It generalizes to these environments because (1) it leverages summary statistics of the OU-model output labels that are agnostic to specific OUs and (2) the elapsed time-based input normalization and ratio-based output labels help the model generalize across various scenarios. We also observe that generalizing the interference model to small data sizes result in the highest error (shown under TPC-H 0.1 GB in Fig. 8b) since the queries are shorter with potentially higher variance in the interference, especially since the model only has the average query arrival information in an interval as an input feature è¿˜æ˜¯ normalization ","date":"2024-04-05","objectID":"/posts/mb2-self-driving-db/:10:4","tags":["Paper Reading"],"title":"Paper Reading: MB2: Decomposed Behavior Modeling for Self-Driving Database Management Systems","uri":"/posts/mb2-self-driving-db/"},{"categories":null,"content":"Model Adaptation and Robustness å™ªå£°å½±å“ï¼Œnoisy estimation ","date":"2024-04-05","objectID":"/posts/mb2-self-driving-db/:10:5","tags":["Paper Reading"],"title":"Paper Reading: MB2: Decomposed Behavior Modeling for Self-Driving Database Management Systems","uri":"/posts/mb2-self-driving-db/"},{"categories":null,"content":"Hardware Context Since MB2 generates models offline, their predictions may be inaccurate when the hardware used for training data generation and production differs. åœ¨ä¸åŒçš„ CPU é¢‘ç‡ä¸Šè®­ç»ƒï¼Œå¸¦æ¥çš„è¯¯å·®ä¹Ÿä¸åŒï¼Œè€Œä¸”çœ‹ä¸Šå»å—å½±å“å¾ˆå¤§ï¼Ÿä½†ä¸ºä»€ä¹ˆæ˜¯è·Ÿä¸»é¢‘æœ‰å…³ï¼Ÿæ˜¯å› ä¸ºè®­ç»ƒçš„æ—¶å€™ï¼Œé”™è¯¯ä¼°è®¡äº†æŸ¥è¯¢æ—¶é—´å—ï¼Ÿæ‰€ä»¥å¯ä»¥æ‰©å±•å¤šä¸€äº›å‚æ•°å—ï¼Ÿ ","date":"2024-04-05","objectID":"/posts/mb2-self-driving-db/:10:6","tags":["Paper Reading"],"title":"Paper Reading: MB2: Decomposed Behavior Modeling for Self-Driving Database Management Systems","uri":"/posts/mb2-self-driving-db/"},{"categories":null,"content":"End-to-End Self-Driving Execution demonstrate MB2â€™s behavior modelsâ€™ application for a self-driving DBMSâ€™s planning components and show how it enables interpretation of its decision-making process. We assume that the DBMS has (1) workload forecasting information of average query arrival rate per query template in each 10s forecasting interval. and (2) an â€œoracleâ€ planner that makes decisions using predictions from behavior models. We assume a perfect workload forecast to isolate MB2â€™s prediction error åˆ›å»ºç´¢å¼•æ—¶ï¼Œruntimeï¼Œcpu å ç”¨ç‡éƒ½é¢„æµ‹å¾—å¾ˆå¥½ï¼Œæ˜¯ self-driving database çš„åŸºç¡€ This example demonstrates that MB2â€™s behavior models accurately estimate the cost, impact, and benefit of actions for self-driving DBMSs ahead of time given the workload forecasting, which is a foundational step towards building a self-driving DBMS demonstrate MB2â€™s estimations under an alternative action plan of the self-driving DBMS in Fig. 11c. The DBMS plans the same actions under the same setup as in Fig. 11a except to build the index earlier (at 58s) with four threads to reduce the impact on the running workload. MB2 accurately estimates the smaller query runtime increment along with the workload being impacted for longer. Such a trade-off between action time and workload impact is essential information for a self-driving DBMS to plan for target objectives (e.g., SLAs). We also observe that MB2 underestimates the index build time under this scenario by 27% due to a combination of OU and interference-model errors. ä½†ä¹Ÿå­˜åœ¨é¢„æµ‹é”™è¯¯çš„æƒ…å†µ ","date":"2024-04-05","objectID":"/posts/mb2-self-driving-db/:10:7","tags":["Paper Reading"],"title":"Paper Reading: MB2: Decomposed Behavior Modeling for Self-Driving Database Management Systems","uri":"/posts/mb2-self-driving-db/"},{"categories":null,"content":"RELATED WORK We broadly classify the previous work in DBMS modeling into the following categories: ML models analytical models. Related to this are other methods for handling concurrent workloads. We also discuss other efforts on building automated DBMSs and reinforcement learning-based approaches Machine Learning Models: Most ML-based behavior models use query plan information as input features for estimating system performance. ML æ–¹æ³•éœ€è¦å¼€å‘äººå‘˜è°ƒæ•´ feature, æ”¶é›†æ•°æ®ï¼Œé‡æ–°è®­ç»ƒä»¥é€‚åº”æ–°ç¯å¢ƒã€‚å¹¶ä¸”å¾ˆå¤š ML æ¨¡å‹éƒ½æ˜¯åœ¨åˆæˆçš„å° benchmark ä¸Šè¿›è¡Œçš„ï¼Œæ‰€ä»¥åœ¨å…¶ä»– workload ä¸Šæœ‰å¾ˆå¤§çš„é¢„æµ‹é”™è¯¯ã€‚å¹¶ä¸”ä¸æ”¯æŒäº‹åŠ¡ workloadsï¼Œå¹¶ä¸”å¿½ç•¥äº† DBMS å†…éƒ¨æ“ä½œã€‚è€Œ MB2 å°±æ‹†åˆ†äº†å°çš„ OU æ“ä½œï¼Œå¹¶ä¸”ç”¨ SQL æ‰€ä»¥åªç”¨å°‘é‡é‡æ–°è®­ç»ƒï¼Œè€Œä¸”é€‚åº”æ›´æ–°ã€‚ Analytical Models: Researchers have also built analytical models for DBMS components. Concurrent Queries: Due to the difficulty of modeling concurrent operations as described in Sec. 2.2, the aforementioned techniques largely focus on performance prediction for one query at a time. For concurrent OLAP workloads, researchers have built sampling- based statistical models that are fixed for a known set of queries. Autonomous DBMSs: There is a long history of research on automating DBMS deployments è¿™é‡Œä¹Ÿæåˆ°äº†åŒæ ·æ˜¯ CMU çš„ Ottertuneï¼Œä½† Ottertune æ˜¯ Gaussian Process Regression to model how a DBMS will perform with different knob settings. Reinforcement Learning (RL) for DBMSs: Recent work ex- plores using RL [55, 59] to enhance individual DBMS components [39, 48, 75], which are independent of MB2â€™s goal to build behavior models for self-driving DBMSs that automate all the administrative tasks. We use a modularized design (Sec. 2) for self-driving DBMSs, which has a different methodology than RL-based approaches. We think this approach provides better data efficiency, debuggability, and explainability, which are essential for the systemâ€™s practical application. All major organizations working on self-driving cars also use a modularized approach instead of end-to-end RL æ²¡ç†è§£ä¸ºä»€ä¹ˆç”¨æ¨¡å—åŒ–æ–¹æ³•è€Œä¸æ˜¯ç«¯åˆ°ç«¯ RL ","date":"2024-04-05","objectID":"/posts/mb2-self-driving-db/:11:0","tags":["Paper Reading"],"title":"Paper Reading: MB2: Decomposed Behavior Modeling for Self-Driving Database Management Systems","uri":"/posts/mb2-self-driving-db/"},{"categories":null,"content":"CONCLUSION Behavior modeling is the foundation for building a self-driving DBMS. We propose a modeling framework ModelBot2 (MB2) that decomposes the DBMS into operating units (OUs) and builds models for each OU with runners that exercise OUsâ€™ behavior. Our evalua- tion shows that MB2â€™s behavior models provide the essential cost, impact, and benefit estimations for actions of self-driving DBMSs and generalize to various workloads and environments. ä¸»è¦è®²äº†æ€ä¹ˆå»ºæ¨¡ behavior modelï¼Œæ€ä¹ˆæ‹†åˆ† Operation Unit ç„¶åç”¨ ML æ–¹æ³•åšé¢„æµ‹ï¼Œè¿˜æœ‰å¾ˆé‡è¦çš„ normalizationã€‚ç»“åˆèµ·æ¥å°±æ˜¯ self-driving DBMS çš„åŸºç¡€ã€‚ ä¸­é—´å¾ˆå¤šåœ°æ–¹æ²¡æ€ä¹ˆçœ‹æ‡‚ï¼Œå¥½åƒå°±æ˜¯åœ¨ç‰¹æ®Šçš„æ•°æ®åº“ä¸Šæ‹†å‡ºå„ç§å•å…ƒä»»åŠ¡ï¼Œç”¨å„ç§ä¸åŒçš„ ML æ–¹æ³•é¢„æµ‹ï¼Œç„¶å normalize ç»“æœã€‚ä½† normalize éƒ¨åˆ†ä¸å¤ªæ¸…æ¥šï¼Œæ€ä¹ˆé€‰ ML æ–¹æ³•çœ‹ä¸Šå»ä¹Ÿç„å­¦ã€‚OU é€‰çš„ä¹ŸæŒºå°‘çš„ï¼Œè€Œä¸”æ— æ³•å¤„ç† disk-oriented DBMSï¼Œå‡è®¾è¿˜æ˜¯æŒºå¼ºçš„ã€‚ è®©æ•°æ®åº“è‡ªåŠ¨é©¾é©¶è¿˜æ˜¯éå¸¸å¸å¼•äººçš„ï¼Œå°¤å…¶æ˜¯ä¼˜åŒ–ã€‚ä½†æ•°æ®åº“è¿˜æ˜¯å¤ªå¤æ‚äº†ï¼Œä¸€ä¸ªæ¡†æ¶æ— æ³•å¤„ç†æ‰€æœ‰çš„æƒ…å†µï¼Œè€Œä¸”æ•°æ®éå¸¸éš¾æ”¶é›†ï¼Œä¸åŒæ•°æ®ä¸åŒæ–¹æ³•ä¹Ÿå·®å¼‚å¾ˆå¤§ï¼Œè®ºæ–‡å¾ˆæœ‰æ„æ€çš„ä¸€ç‚¹å°±æ˜¯ç”¨æ±½è½¦çš„è‡ªåŠ¨é©¾é©¶ç±»æ¯”æ•°æ®åº“çš„è‡ªåŠ¨é©¾é©¶ï¼Œæ˜¯å¾ˆç›¸ä¼¼çš„ï¼Œéƒ½éœ€è¦æ„ŸçŸ¥ï¼ŒçŸ¥é“æœ‰ä»€ä¹ˆå·¥ä½œè´Ÿè½½ï¼Œä¹Ÿéœ€è¦é¢„æµ‹æœªæ¥çš„å·¥ä½œè´Ÿè½½ï¼Œä½¿å…¶èƒ½å¤ŸçŸ¥é“æ€ä¹ˆä¼˜åŒ–ã€‚ç¬¬äºŒæ­¥å°±æ˜¯ä¼˜åŒ–ï¼Œæ¯”å¦‚å»ºç´¢å¼•ã€è°ƒå‚æ•°ï¼Œç¬¬ä¸‰æ­¥æ˜¯éœ€è¦çŸ¥é“åœ¨ä»€ä¹ˆæ—¶å€™ä¼˜åŒ–ï¼Œæ¯”å¦‚è´Ÿè½½ä½çš„æ—¶å€™å»ºç«‹ç´¢å¼•ï¼Œè¿˜è¦çŸ¥é“æ“ä½œå¸¦æ¥çš„å½±å“ã€‚ å†ä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„åœ°æ–¹æ˜¯ï¼ŒMB2 è€ƒè™‘äº†å¤šçº¿ç¨‹å¹¶å‘çš„æƒ…å†µï¼Œè¿™å¾ˆé‡è¦ï¼Œå°¤å…¶æ˜¯ç°åœ¨çš„æ•°æ®åº“å¤§éƒ¨åˆ†éƒ½æ˜¯æ”¯æŒå¹¶å‘çš„ã€‚ MB2 å®é™…ä¸Šæ˜¯ç»“åˆäº†æœºå™¨å­¦ä¹ å»ºæ¨¡å’Œåˆ†ææ–¹æ³•å»ºæ¨¡ï¼Œä½†å¤§éƒ¨åˆ†æƒ…å†µä¸‹ gradient boosting æ¨¡å‹è¡¨ç°æœ€å¥½ï¼Œä½†æ˜¯æ˜¯æ ¹æ®æ€ä¹ˆæŒ‡æ ‡æ¥ç¡®å®šçš„å‘¢ï¼Ÿ æ•°æ®å¯¹è‡ªæ²»æ•°æ®åº“çš„å®ç°ä¹Ÿæ˜¯éå¸¸é‡è¦çš„ Summarize: The paper proposes a modeling framework called ModelBot2(MB2) for building a self-driving DBMS. MB2 decomposes DBMS into many fine-grained and independent operating units(OUs) such as building a hash table and interference model for concurrent operations such as log record flush. MB2 trains these models with different ML methods like gradient boosting, and use different input features to estimate system performance metrics. The experiment result shows that MB2 is able to predict DBMS performance more accurately than the state-of-the-art ML models called QPPNet, especially under dynamic different workload scenarios. MB2 performs behavioral modeling on DBMS and predicts the impact and benefit of automated operations of various datasets(OLAP and OLTP), which is foundational for establishing an self-driving database. Contributions: MB2 breaks down the database management systemâ€™s functionality into smaller, independent units called operating units (OUs), each OU can have a model trained to predict its runtime and resource consumption. Using decomposed OUs to build behavioral models not only reduces the high-dimensionality of the problem, but each OU requires less training data and gives more fine-grained predictions. MB2 also proposes a interference model, which captures contention on locks and data structures through individual OU models. Additionally, a separate interference model is designed to predict contention on hardware resources such as memory, CPU, and I/O. This model outputs summary statistics to generalize to various concurrent OUs. MB2 integrates the behavior model and interference model with NoisePage, which is a relational database management system from CMU. MB2 can predict the systemâ€™s performance for OLTP, OLAP and even mixed workloads in dynamic environments, while most ML-based models do not support transcational workloads. MB2 achieves this by applying output normalization techniques, and it outperforms QPPNet particularly in terms of generalizability and performance across different workloads. Limitations: MB2 is limited to train on an offline enviornment. Though MB2 is adaptive to dynamic workload and even transcational workload, it still needs retrain when there are some DBMS updates. Iâ€™m not an expert in database tuning, but maybe some OUs in MB2 still need to be retrained when knobs and configurations are changed. MB2 is not be directly designed for predicting disk-oriented database performance, and it uses in-memory database. Since MB2 might not be able to predict the cache content in CPU cache runs or buffer pool. And MB2 needs warm up and enough repetitions to be able to predict accurately. This may cause the CPU cache and buffer pool to cache a lot of data, resulting in inaccurate predictions. MB2 is designed to be a self-driving DBMS, however, the initial setup of MB2 needs developers to decompose the DBMSâ€™s architecture into operating units(OUs), whic","date":"2024-04-05","objectID":"/posts/mb2-self-driving-db/:12:0","tags":["Paper Reading"],"title":"Paper Reading: MB2: Decomposed Behavior Modeling for Self-Driving Database Management Systems","uri":"/posts/mb2-self-driving-db/"},{"categories":null,"content":"Mini-LSM Week 1 Day2 Week1 Day2 çš„å†…å®¹ï¼Œå®ç° Merge Iterator https://skyzh.github.io/mini-lsm/week1-02-merge-iterator.html ","date":"2024-03-23","objectID":"/posts/minilsm-2/:1:0","tags":["Database","LSM"],"title":"Mini-LSM Week 1 Day2","uri":"/posts/minilsm-2/"},{"categories":null,"content":"Merge Iterator æœ¬æ¬¡éœ€è¦å®ç°ï¼š Memtable Iterator Merge Iterator LSM read path scan for memtables ","date":"2024-03-23","objectID":"/posts/minilsm-2/:2:0","tags":["Database","LSM"],"title":"Mini-LSM Week 1 Day2","uri":"/posts/minilsm-2/"},{"categories":null,"content":"Task1: Memtable Iterator ä¿®æ”¹ src/mem_table.rsï¼Œå®ç° scan æ¥å£ï¼Œåœ¨ä¸€ç»„ key-value pairs ä¸Šåˆ›å»º iterator API æ¥è¿­ä»£ã€‚åœ¨ä¸Šä¸€èŠ‚å·²ç»å®ç°äº† get å’Œåˆ›å»º immutable memtable çš„é€»è¾‘ï¼Œæ­¤æ—¶ LSM state æœ‰å¤šä¸ª memtablesã€‚æ‰€ä»¥ scan éœ€è¦åœ¨ä¸€ä¸ª memtable ä¸Šåˆ›å»º iteratorï¼Œç„¶ååœ¨æ‰€æœ‰ memtables ä¸Šåˆ›å»ºä¸€ä¸ª merge iterator æ‰€æœ‰ LSM iterators åœ¨ lsm_iterator.rs ä¸­çš„ StorageIterator ç‰¹å¾ï¼Œæœ‰å››ä¸ªå‡½æ•° key, value, next å’Œ is_validã€‚å½“ iterator åˆ›å»ºåï¼Œcursor ä¼šåœåœ¨æŸäº›å…ƒç´ ï¼Œkey/value ä¼šè¿”å› memtable/block/SST ä¸­çš„ç¬¬ä¸€ä¸ªæ»¡è¶³ start condition çš„ keyï¼Œæ¯”å¦‚ start keyã€‚è¿™ä¸¤ä¸ªæ¥å£ä¼šè¿”å› \u0026[u8] å¼•ç”¨ç±»å‹é˜²æ­¢ copyã€‚æœ¬èŠ‚çš„ iterator interface å’Œ Rust iterator ä¸å¤ªä¸€æ ·ã€‚ next å°† cursor ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œis_valid æ£€æŸ¥ iterator æ˜¯å¦ç»ˆæ­¢æˆ–è€…å‘ç”Ÿé”™è¯¯ã€‚å¯ä»¥å‡è®¾ next ä¼šåœ¨ is_valid è¿”å›æˆåŠŸæ—¶æ‰ä¼šè¢«è°ƒç”¨ã€‚FusedIterator æ˜¯ä¸€ä¸ª wrapper åŒ…å«äº†æ‰€æœ‰çš„ iteratorï¼Œä¼šé˜²æ­¢ä¸æ­£ç¡®çš„ next è°ƒç”¨ï¼Œæ¯”å¦‚ not validã€‚ å›åˆ° memtable iterator, è¿™ä¸ªç»“æ„ä½“æ²¡æœ‰ä»»ä½•ç”Ÿå‘½å‘¨æœŸã€‚å¦‚æœä½ åˆ›å»ºäº†ä¸€ä¸ª Vec\u003cu64\u003e å¹¶ä¸”è°ƒç”¨ vec.iter()ï¼Œè¿™ä¸ª iterator ç±»å‹ä¼šæ˜¯ VecIterator\u003c'a\u003e è¡¨ç¤º vec çš„ç”Ÿå‘½å‘¨æœŸã€‚åŒæ ·åœ°ï¼ŒSkipMap ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œiter æ¥å£è¿”å›ä¸€ä¸ªå¸¦ç”Ÿå‘½å‘¨æœŸçš„ iteratorã€‚ä½†æ˜¯ï¼Œåœ¨ Mini LSM ä¸­ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›è¿™æ ·çš„ç”Ÿå‘½å‘¨æœŸå‡ºç°åœ¨è¿­ä»£å™¨ä¸­ï¼Œä½¿å¾—æ•´ä¸ªç³»ç»Ÿå˜å¾—è¿‡åˆ†å¤æ‚å’Œéš¾ä»¥ç¼–è¯‘ã€‚ å¦‚æœè¿­ä»£å™¨æ²¡æœ‰ç”Ÿå‘½å‘¨æœŸå‚æ•° lifetime generics parameterï¼Œæˆ‘ä»¬åº”è¯¥ä¿è¯ä¸ç®¡ä»€ä¹ˆæ—¶å€™ç”¨ iteratorï¼Œåº•å±‚çš„ skiplist éƒ½ä¸åº”è¯¥è¢«é‡Šæ”¾ã€‚è¿™æ ·çš„å”¯ä¸€åšæ³•æ˜¯å°† Arc\u003cSkipMap\u003e å¯¹è±¡æ”¾åˆ° iterator æœ¬èº«ï¼š pub struct MemetableIteraotr { map: Arc\u003cSkipMap\u003cBytes, Bytes\u003e\u003e, iter: SkipMapRangeIter\u003c'???\u003e, } é¢˜å¤–è¯ï¼Œä¸ºä»€ä¹ˆæœ‰äº›è¯­è¨€çš„ struct ç”¨é€—å·åˆ†éš”ï¼Œæœ‰äº›ç”¨åˆ†å·ï¼Œæœ‰äº›ç”¨æ¢è¡Œå‘¢ï¼Ÿå†™å¤šäº†ä¼šä¸ä¼šæ··æ·† æ­¤æ—¶æœ‰æ–°çš„é—®é¢˜ï¼šæˆ‘ä»¬æƒ³è¡¨ç¤º iterator çš„ç”Ÿå‘½å‘¨æœŸå’Œ map æ˜¯ä¸€æ ·çš„ï¼Œåº”è¯¥æ€ä¹ˆåšï¼Ÿ è¿™æ˜¯ Mini LSM ä¸­æœ€ tricky çš„ Rust æŠ€å·§ï¼šself-referential ç»“æ„ï¼š pub struct MemtableIterator { // \u003c- with lifetime 'this map: Arc\u003cSkipMap\u003cBytes, Bytes\u003e\u003e, iter: SkipMapRangeIter\u003c'this\u003e, } è¿™æ ·å°±è§£å†³äº†é—®é¢˜ï¼Œä¹Ÿå¯ä»¥ç”¨ç¬¬ä¸‰æ–¹åº“ ouroboros æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªç®€å•çš„æ–¹æ³•å®šä¹‰ self-referential ç»“æ„ï¼Œä¹Ÿå¯ä»¥ç”¨ unsafe Rust æ¥è§£å†³ï¼ˆouroboros å°±æ˜¯ç”¨ unsafe Rust å®ç°çš„ï¼‰ æ•™ç¨‹å·²ç»å®šä¹‰äº† self-referential MemtableIteratorï¼Œåªéœ€è¦å®ç° MemtableIterator å’Œ Memtable::scan æ¥å£ï¼š ","date":"2024-03-23","objectID":"/posts/minilsm-2/:3:0","tags":["Database","LSM"],"title":"Mini-LSM Week 1 Day2","uri":"/posts/minilsm-2/"},{"categories":null,"content":"Task1: Solution è§‚å¯Ÿ Memtable::scan å‡½æ•°ï¼Œpub fn scan(\u0026self, _lower: Bound\u003c\u0026[u8]\u003e, _upper: Bound\u003c\u0026[u8]\u003e) -\u003e MemTableIteratorï¼Œå…¶ä¸­ lower å’Œ upper å±äº Bound ç±»å‹ï¼Œè¡¨ç¤ºä¸€ä¸ªèŒƒå›´çš„ keysï¼ˆå·¦é—­å³å¼€ï¼‰ï¼Œæ¯”å¦‚ (1..12).start_bound(), Included(\u00261), (1..12).end_bound(), Excluded(\u002612)ã€‚BTreeMap é€šè¿‡ map.range((Excluded(3), Included(8))) æ¥è·å– (3, 8] èŒƒå›´å†…çš„ key-valueã€‚æ‰€ä»¥å¯¹äº memtable çš„ scanï¼Œåº”è¯¥è·å– [lower, upper] çš„èµ·å§‹è¿­ä»£å™¨ï¼š /// Get an iterator over a range of keys. pub fn scan(\u0026self, lower: Bound\u003c\u0026[u8]\u003e, upper: Bound\u003c\u0026[u8]\u003e) -\u003e MemTableIterator { let mut iter = MemTableIterator::new( self.map.clone(), // Arc\u003cSkipMap\u003cBytes, Bytes\u003e\u003e |map| map.range((map_bound(lower), map_bound(upper))), // iter FnOnce (Bytes::new(), Bytes::new()), // Stores the key-value pair. ); iter.next().unwrap(); iter } è°ƒç”¨ MemTableIterator::new æ–°å»ºä¸€ä¸ª MemTableIteratorï¼Œå…¶ç»“æ„ä½“ä¸ºï¼š type SkipMapRangeIter\u003c'a\u003e = crossbeam_skiplist::map::Range\u003c'a, Bytes, (Bound\u003cBytes\u003e, Bound\u003cBytes\u003e), Bytes, Bytes\u003e; #[self_referencing] pub struct MemTableIterator { /// Stores a reference to the skipmap. map: Arc\u003cSkipMap\u003cBytes, Bytes\u003e\u003e, /// Stores a skipmap iterator that refers to the lifetime of `MemTableIterator` itself. #[borrows(map)] #[not_covariant] iter: SkipMapRangeIter\u003c'this\u003e, /// Stores the current key-value pair. item: (Bytes, Bytes), } è¿™ä¸€ä¸ªç»“æ„ä½“ä»¤ Rust åˆå­¦çš„æˆ‘éå¸¸æ‡µï¼Œå°¤å…¶æ˜¯ #[borrows(map)] æ‰¾äº†å¾ˆä¹…æ²¡æœ‰æ‰¾åˆ°åœ¨å“ªï¼Œè€Œä¸” iter æˆ‘ä»¥ä¸ºä¼ å…¥ä¸€ä¸ªç»“æ„ä½“ï¼Œä½†å®é™…ä¸Šåº”è¯¥ä¼ å…¥ä¸€ä¸ªå‡½æ•°é—­åŒ…ï¼Œè¿™ä¸ªå‡½æ•°é—­åŒ…çš„è¿”å›ç±»å‹æ˜¯ Rangeã€‚æ‰€ä»¥ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ª Arc å˜é‡ self.map.clone() è¿”å›å½“å‰çš„ mapã€‚ç¬¬äºŒä¸ªå‚æ•°æ˜¯ |map| map.range((map_bound(lower), map_bound(upper)))ï¼Œæœ¬èº«å…¶å®æ˜¯ä¸€ä¸ª iterï¼Œå¯ä»¥è°ƒç”¨ next ç­‰ç­‰ï¼Œç„¶åæ˜¯ item ç”¨äºå­˜å½“å‰çš„ key-value å¯¹ã€‚åˆ›å»ºå®Œæˆåéœ€è¦è°ƒç”¨ä¸€æ¬¡ iter.next().unwrap() èµ°åˆ°ç¬¬ä¸€ä¸ª Rangeï¼Œç„¶åè¿”å›ã€‚ ç„¶åä¸º MemTableIterator å®ç° StorageIterator ç‰¹å¾ï¼Œå…·æœ‰ value, key, is_valid å’Œ next æ¥å£ï¼š impl StorageIterator for MemTableIterator { type KeyType\u003c'a\u003e = KeySlice\u003c'a\u003e; fn value(\u0026self) -\u003e \u0026[u8] { \u0026self.borrow_item().1.chunk() } fn key(\u0026self) -\u003e KeySlice { KeySlice::from_slice(\u0026self.borrow_item().0.chunk()) } fn is_valid(\u0026self) -\u003e bool { !\u0026self.borrow_item().0.is_empty() } fn next(\u0026mut self) -\u003e Result\u003c()\u003e { let entry = self.with_iter_mut(|iter| iter.next()); let item = entry.map(|en| (en.key().clone(), en.value().clone())); self.with_mut(|iter| *iter.item = item.unwrap_or_default()); Ok(()) } } è¿™é‡Œçš„ \u0026self.borrow_item() è¡¨ç¤ºå€Ÿç”¨å½“å‰çš„ itemï¼Œæ‰€ä»¥æ˜¯å¼•ç”¨ï¼Œå¹¶ä¸”ç”¨ .chunk() å°† Bytes è½¬æˆ \u0026[u8] ç±»å‹ï¼Œvalue, key å’Œ is_valid æ¥å£å®ç°éƒ½å¾ˆç±»ä¼¼ã€‚ è€Œ next å®ç°èµ·æ¥æ¯”è¾ƒéº»çƒ¦ï¼Œå¤§è‡´æ€è·¯æ˜¯å…ˆé€šè¿‡ iter å¾—åˆ°ä¸‹ä¸€ä¸ª Entryï¼Œç„¶åå°†å…¶å€¼è½¬æˆ (Bytes, Bytes) ç±»å‹ç„¶åèµ‹ç»™å½“å‰ self.itemï¼ŒåŒæ—¶ä¿®æ”¹æœ¬ä½“æ‰€ä»¥éœ€è¦ç”¨ self.with_mut() æ­¤æ—¶è°ƒç”¨ cargo x scheck å¯ä»¥é€šè¿‡å‰ä¸¤ä¸ªæµ‹è¯• ","date":"2024-03-23","objectID":"/posts/minilsm-2/:4:0","tags":["Database","LSM"],"title":"Mini-LSM Week 1 Day2","uri":"/posts/minilsm-2/"},{"categories":null,"content":"Task2: Merge Iterator æœ¬èŠ‚éœ€è¦ä¿®æ”¹ src/iterators/merge_iterator.rsã€‚ ç°åœ¨ä½ å·²ç»æœ‰å¤šä¸ª memtablesï¼Œä½ éœ€è¦åˆ›å»ºå¤šä¸ª memtable iteratorsï¼Œå¹¶ä¸”éœ€è¦ merge æ‰€æœ‰ memtables è¿”å›çš„ç»“æœï¼Œå¹¶ä¸”æ¯ä¸ª key å¯¹åº”æœ€æ–°çš„ç»“æœã€‚ MergeIterator ç»´æŠ¤ä¸€ä¸ª binary heapï¼Œä½ éœ€è¦å¤„ç†é”™è¯¯ï¼ˆæ¯”å¦‚å½“ iterator not valid æ—¶ï¼‰ï¼Œå¹¶ä¸”éœ€è¦ä¿è¯ key-value å¯¹æ˜¯æœ€æ–°çš„ï¼Œæ¯”å¦‚ï¼š iter1: b-\u003edel, c-\u003e4, d-\u003e5 iter2: a-\u003e1, b-\u003e2, c-\u003e3 iter3: e-\u003e4 merge iterator è¿”å›çš„ç»“æœåº”è¯¥æ˜¯ï¼š a-\u003e1, b-\u003edel, c-\u003e4, d-\u003e5, e-\u003e4 MergeIterator çš„æ„é€ å™¨ constructor æ¥å—ä¸€ä¸ª vector of iterators å‚æ•°ï¼Œå‡è®¾ index å°çš„æ˜¯æ–°çš„ã€‚ ä½†æ˜¯é”™è¯¯å¤„ç†æœ‰ä¸ªé™·é˜±ï¼Œæ¯”å¦‚ï¼š let Some(mut inner_iter) = self.iters.peek_mut() { inner_iter.next()?; } å¦‚æœ next è¿”å›äº†é”™è¯¯ï¼ˆdisk failure, network failure, checksum error, etcï¼‰ï¼Œä½†æ˜¯å½“è·³å‡ºäº† if æ¡ä»¶å¹¶ä¸”è¿”å›é”™è¯¯ç»™è°ƒç”¨è€…æ—¶ï¼ŒPeekMut çš„ç»“æœä¼šç§»åŠ¨ heap é‡Œçš„å…ƒç´ ï¼Œå¯¼è‡´è®¿é—®åˆ° invalid iteratorã€‚æ‰€ä»¥ï¼Œéœ€è¦é¢å¤–çš„é”™è¯¯å¤„ç†ï¼Œè€Œä¸æ˜¯ä½¿ç”¨åœ¨ PeekMut èŒƒå›´é‡Œç”¨ ?ã€‚ æˆ‘ä»¬æƒ³é¿å…å°½å¯èƒ½ dynamic dispatchï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸ä½¿ç”¨ Box\u003cdynStorageIterator\u003eã€‚åè€Œä½¿ç”¨é™æ€çš„åˆ†å‘ï¼Œä½¿ç”¨æ³›å‹ï¼Œå¹¶ä¸” StorageIterator ä½¿ç”¨äº† generic associated type (GAT)ï¼Œæ‰€ä»¥å®ƒå¯ä»¥æ”¯æŒ KeySlice å’Œ \u0026[u8] åŒæ—¶ä½œä¸º key çš„ç±»å‹ã€‚æˆ‘ä»¬ä¼šåœ¨å°†æ¥çš„ä½œä¸šæ”¹å˜ KeySlice ä½¿å…¶åŒ…å« timestampã€‚ Rust ä¸­çš„åŠ¨æ€åˆ†å‘ï¼Œæ¯”å¦‚ Trait Objectsï¼Œç±»ä¼¼è™šç»§æ‰¿ï¼Ÿ Generic Associated Type GAT æŒ‡çš„æ˜¯é€šç”¨å…³è”ç±»å‹ï¼Œå¯ä»¥ä½¿å¾—å…³è”ç±»å‹ä¾èµ–äº trait æ–¹æ³• æ¯”å¦‚ trait Processor{ type Output\u003c'a\u003e; fn process\u003c'a\u003e(\u0026self, data: \u0026a str) -\u003e Self::Output\u003c'a\u003e; } åœ¨ impl æ—¶å†æŒ‡å®š type æ˜¯ä»€ä¹ˆã€‚ ä¸ºäº†å¼€å§‹æœ¬èŠ‚ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨ Key\u003cT\u003e è¡¨ç¤º LSM key çš„ç±»å‹ï¼Œå¹¶ä¸”åŒºåˆ†å®ƒçš„å€¼ç±»å‹ã€‚ä½ åº”è¯¥ä½¿ç”¨ Key\u003cT\u003e æä¾›çš„æ¥å£è€Œä¸æ˜¯ç›´æ¥è®¿é—®å…¶å†…éƒ¨å€¼ã€‚æˆ‘ä»¬ä¼šä¸ºè¿™ä¸ª key æ·»åŠ æ—¶é—´æˆ³ï¼Œå¹¶ç”¨è¿™ä¸ª key abstraction è¿‡æ¸¡ä¼šæ¯”è¾ƒé¡ºåˆ©ã€‚æ‰€ä»¥ç›®å‰ KeySlice å’Œ \u0026[u8] æ˜¯ä¸€æ ·çš„ï¼ŒKeyVec å’Œ Vec\u003cu8\u003e ä¸€æ ·ï¼ŒKeyBates å’Œ Bytes ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚ ","date":"2024-03-23","objectID":"/posts/minilsm-2/:5:0","tags":["Database","LSM"],"title":"Mini-LSM Week 1 Day2","uri":"/posts/minilsm-2/"},{"categories":null,"content":"Task2: Solution è¿™ä¸€èŠ‚ä¸»è¦å®ç° src/iterators/merge_iterators ä¸­çš„ MergeIterator::key,MergeIterator::value, MergeIterator::is_valid å’Œ MergeIterator::nextï¼Œå¹¶ä¸”å®ç° MergeIterator::create é¦–å…ˆæ˜¯ MergeIterator::createï¼Œæ¥å—ä¸€ä¸ª iters æ•°ç»„ï¼Œéœ€è¦å°† iters: Vec\u003cBox\u003cI\u003e\u003e è½¬æ¢æˆ BinaryHeap\u003cHeapWrapper\u003cI\u003e, Global\u003eï¼Œå³ä¼˜å…ˆé˜Ÿåˆ— / å † / å®Œå…¨äºŒå‰æ ‘ï¼Œæ•™ç¨‹å·²ç»å®ç°äº† HeapWrapper çš„æ¯”è¾ƒç‰¹å¾ï¼Œæ‰€ä»¥åªéœ€è¦å°† iters éå†ä¸€éï¼Œå¹¶ä¸”å…¥å †ã€‚ æ¯”å¦‚ä¼ å…¥ [[(\"a\", 1), (\"b\", 2), (\"c\", 3)], [(\"a\", 1.2), (\"d\", 4)]] è¿™æ ·çš„æ•°ç»„ï¼Œå…ˆå®ç° MergeIterator::createï¼š impl\u003cI: StorageIterator\u003e MergeIterator\u003cI\u003e { pub fn create(iters: Vec\u003cBox\u003cI\u003e\u003e) -\u003e Self { let mut heap = BinaryHeap::new(); if iters.is_empty() { return Self { iters: heap, current: None, }; } for (i, iter) in iters.into_iter().enumerate() { if iter.is_valid() { heap.push(HeapWrapper(i, iter)); } } let current = heap.pop(); Self { iters: heap, current, } } } å…ˆæ£€æŸ¥ iters.is_empty() ä¼ å…¥çš„æ•°ç»„æ˜¯å¦ä¸ºç©ºï¼Œç„¶åéå† iters æ•°ç»„ï¼Œä½¿ç”¨ into_iter() æ¶ˆè€—åŸæ•°ç»„ï¼Œè½¬ç§»æ‰€æœ‰æƒï¼Œç„¶å enumerate() éå†ï¼Œéœ€è¦æ£€æŸ¥ iter.key() æ˜¯å¦æ˜¯ç©ºçš„ã€‚ fn key(\u0026self) -\u003e KeySlice { self.current.as_ref().unwrap().1.key() } fn value(\u0026self) -\u003e \u0026[u8] { self.current.as_ref().unwrap().1.value() } fn is_valid(\u0026self) -\u003e bool { self.current .as_ref() .map(|x| x.1.is_valid()) .unwrap_or(false) } key, value, is_valid æ¥å£ä¸å†é‡è¿°ï¼Œä½†éœ€è¦æ³¨æ„ç”¨ as_ref() å–å¾—å¼•ç”¨ã€‚next çš„å®ç°æ¯”è¾ƒç»•ï¼Œå› ä¸ºå¯¹äº MergeIteratorï¼Œæœ‰æ—¶å€™å‰é¢çš„ key ä¼šå°äºå †é¡¶çš„ keyï¼Œæ‰€ä»¥éœ€è¦è¿›è¡Œäº¤æ¢ï¼š fn next(\u0026mut self) -\u003e Result\u003c()\u003e { let current = self.current.as_mut().unwrap(); while let Some(mut iter) = self.iters.peek_mut() { if iter.1.key() == current.1.key() { let res = iter.1.next(); if let Err(e) = res { PeekMut::pop(iter); return Err(e); } else { if !iter.1.is_valid() { PeekMut::pop(iter); } } } else { break; } } current.1.next()?; if !current.1.is_valid() { if let Some(iter) = self.iters.pop() { *current = iter; } } else { // if the current key is smaller, swap it with the top of the heap // e.g. current \"e\" 101 \u003c heap top iter key \"d\" 100 // PartialOrd for HeapWrapper will reverse the ordering // so that the top of the heap is the smallest key if let Some(mut iter) = self.iters.peek_mut() { if !(*iter \u003c *current) { std::mem::swap(\u0026mut *iter, current); } } } Ok(()) } é¦–å…ˆæ˜¯ç”¨ while å¾ªç¯æ£€æŸ¥å½“å‰å †é¡¶çš„ iter.1.key() å¦‚æœå’Œå½“å‰çš„ current.1.key() ç›¸åŒï¼Œåˆ™åº”è¯¥ä»¥ current ä¸ºå‡†ï¼ˆæœ€æ–°ç‰ˆæœ¬ï¼‰ï¼Œå¹¶ä¸”è°ƒç”¨ iter.1.next() èµ°åˆ°ä¸‹ä¸€ä¸ª keyã€‚ ç„¶åä½¿ç”¨ current.1.next() èµ°åˆ°ä¸‹ä¸€ä¸ª keyï¼Œä½†æ­¤æ—¶å°±è¦å¤„ç†æ–°ç‰ˆæœ¬ä¸­çš„ key å®é™…å°äº iters.peek_mut() æ—¶çš„æƒ…å†µï¼Œä½†ç”±äºä¸ºäº†å®ç°å †ï¼ŒHeapWrapper é‡è½½äº† PartialOrd å¹¶åè½¬äº†ç»“æœï¼Œæ‰€ä»¥å †é¡¶çš„ key æ˜¯å°çš„ï¼Œé‚£ä¹ˆæ¯”è¾ƒå †é¡¶ iter å’Œ current å°±éœ€è¦åè¿‡æ¥ã€‚ ","date":"2024-03-23","objectID":"/posts/minilsm-2/:6:0","tags":["Database","LSM"],"title":"Mini-LSM Week 1 Day2","uri":"/posts/minilsm-2/"},{"categories":null,"content":"Task3: LSM Iterator + Fused Iterator æœ¬èŠ‚éœ€è¦ä¿®æ”¹ src/lsm_iterator.rs æˆ‘ä»¬ä½¿ç”¨ LsmIterator ç»“æ„è¡¨ç¤º LSM å†…éƒ¨çš„ iteratorsï¼Œåœ¨æ•´ä¸ª LSM æ•™ç¨‹ä¸­ï¼Œä¼šæœ‰å¤šä¸ª iterators è¢«åŠ è¿›ç³»ç»Ÿï¼Œæ‰€ä»¥ä½ éœ€è¦å¤šæ¬¡ä¿®æ”¹è¿™ä¸ªç»“æ„ã€‚ç°åœ¨ç”±äºåªæœ‰å¤šä¸ª memtables æ‰€ä»¥å®šä¹‰ä¸º type LsmIteratorInner = MergeIterator\u003cMemTableIterator\u003e; ä½ å¯ä»¥æå‰å®ç° LsmIterator ç»“æ„ï¼Œè°ƒç”¨ inner iterator å¹¶ä¸”è·³è¿‡ deleted keys. ä½†æœ¬èŠ‚ä¸æµ‹è¯• LsmIteratorï¼Œä½†ä¼šåœ¨ä¸‹ä¸€èŠ‚ä»»åŠ¡ Task4 æœ‰ä¸ª integration æ•´åˆã€‚ æˆ‘ä»¬æƒ³æä¾›é¢å¤–çš„å®‰å…¨æ€§ï¼Œé˜²æ­¢ç”¨æˆ·ç”¨é”™ iteratorsã€‚åœ¨ iterator not valid æ—¶ç”¨æˆ·ä¸åº”è¯¥è°ƒç”¨ key value æˆ– next æ¥å£ã€‚åŒæ—¶ï¼Œå½“ next è¿”å›é”™è¯¯æ—¶ï¼Œç”¨æˆ·ä¸åº”è¯¥å†ä½¿ç”¨è¿™ä¸ª iteratorã€‚FusedIterator æ˜¯ä¸€ä¸ª iterator wrapper ç”¨äº normalize è§„èŒƒåŒ–æ‰€æœ‰ iterators çš„è¡Œä¸ºã€‚ ","date":"2024-03-23","objectID":"/posts/minilsm-2/:7:0","tags":["Database","LSM"],"title":"Mini-LSM Week 1 Day2","uri":"/posts/minilsm-2/"},{"categories":null,"content":"Task3: Solution è§‚å¯Ÿ FusedIteratorï¼Œå®ƒåŒ…å«äº†ä¸€ä¸ª iter å’Œä¸€ä¸ª bool å­—æ®µè¡¨ç¤ºæ˜¯å¦æ˜¯é”™è¯¯çš„ï¼š pub struct FusedIterator\u003cI: StorageIterator\u003e { iter: I, has_errored: bool, } æœ¬èŠ‚éœ€è¦å®ç° FusedIterator::is_valid, FusedIterator::key, FusedIterator::value, FusedIterator::nextï¼ŒåŒæ—¶ä¿è¯å¦‚æœ !self.is_valid() å°±åº”è¯¥ panic: impl\u003cI: StorageIterator\u003e StorageIterator for FusedIterator\u003cI\u003e { type KeyType\u003c'a\u003e = I::KeyType\u003c'a\u003e where Self: 'a; fn is_valid(\u0026self) -\u003e bool { // first check if the iterator has errored // iter.is_valid() may iter to next !self.has_errored \u0026\u0026 self.iter.is_valid() } fn key(\u0026self) -\u003e Self::KeyType\u003c'_\u003e { if !self.is_valid() { panic!(\"called key on invalid iterator\"); } self.iter.key() } fn value(\u0026self) -\u003e \u0026[u8] { if !self.is_valid() { panic!(\"called value on invalid iterator\"); } self.iter.value() } fn next(\u0026mut self) -\u003e Result\u003c()\u003e { if self.has_errored { return Err(anyhow::anyhow!(\"called next on invalid iterator\")); } if self.iter.is_valid() { let res = self.iter.next(); if let Err(e) = res { self.has_errored = true; return Err(e); } } Ok(()) } } é€»è¾‘æ¯”è¾ƒç®€å•ï¼Œä½† is_valid() æœ€å¥½æ˜¯å…ˆæ£€æŸ¥ self.has_erroredï¼Œä¸ç„¶å…ˆè°ƒç”¨ iter.is_valid() å¯èƒ½ä¼šèµ° next å¯¼è‡´ index ä¸å¯¹ ","date":"2024-03-23","objectID":"/posts/minilsm-2/:8:0","tags":["Database","LSM"],"title":"Mini-LSM Week 1 Day2","uri":"/posts/minilsm-2/"},{"categories":null,"content":"Task4: Read Path - Scan æœ¬èŠ‚ä»»åŠ¡éœ€è¦ä¿®æ”¹ src/lsm_storage.rs å½“æ‰€æœ‰ iterators å®ç°åï¼Œä½ å°±å¯ä»¥å®ç° LSM å¼•æ“ scan æ¥å£äº†ã€‚ä½ å¯ä»¥ç®€å•åœ°åˆ›å»ºä¸€ä¸ª LSM iterator å’Œ memtable iteratorï¼ˆè®°å¾—åœ¨ merge iterator æœ€å‰é¢æ”¾æœ€æ–°çš„ memtable ï¼‰ï¼Œæ­¤æ—¶ä½ çš„ å­˜å‚¨å¼•æ“å°±å¯ä»¥åš scan æ‰«æè¯·æ±‚äº†ã€‚ ","date":"2024-03-23","objectID":"/posts/minilsm-2/:9:0","tags":["Database","LSM"],"title":"Mini-LSM Week 1 Day2","uri":"/posts/minilsm-2/"},{"categories":null,"content":"Task4: Solution ç»“åˆ Day1 å’Œ Day2ï¼Œä»å®ç° memtable å’Œ memtable iteratorï¼Œåˆ°å¤šä¸ª memtables å’Œå¤šä¸ª iteratorsï¼Œç°åœ¨éœ€è¦å°†è¿™äº› memtable iterators ç»“åˆèµ·æ¥ï¼Œå®ç°ä¸€ä¸ªæ‰«ææ–¹æ³•ï¼Œå›é¡¾å•ä¸ª Memtable::scanï¼Œæ¥å—ä¸€ä¸ª lower å’Œ upper å‚æ•°ï¼Œè¿”å›ä¸€ä¸ª MemtableIterator è¿­ä»£å™¨ï¼ŒåŒ…å«æ»¡è¶³ (lower, upper) çš„é”®å€¼å¯¹ï¼š /// Get an iterator over a range of keys. pub fn scan(\u0026self, lower: Bound\u003c\u0026[u8]\u003e, upper: Bound\u003c\u0026[u8]\u003e) -\u003e MemTableIterator { let mut iter = MemTableIterator::new( self.map.clone(), // Arc\u003cSkipMap\u003cBytes, Bytes\u003e\u003e |map| map.range((map_bound(lower), map_bound(upper))), // iter FnOnce (Bytes::new(), Bytes::new()), // Stores the key-value pair. ); iter.next().unwrap(); iter } åŒç†ï¼ŒLsmStorageInner ä¹Ÿæ˜¯æ¥å—ä¸€ä¸ª lower å’Œ upper å‚æ•°ï¼Œè¿”å›ä¸€ä¸ª FusedIterator\u003cLsmIterator\u003e èåˆçš„è¿­ä»£å™¨ã€‚ å…·ä½“åœ°ï¼Œéœ€è¦å…ˆæ‹¿å‡ºæ‰€æœ‰ memtables iteratorsï¼Œåˆ›å»ºä¸€ä¸ªæ•°ç»„å­˜å‚¨è¿™äº› MemtableIteratorï¼Œå…ˆå­˜å…¥æœ€æ–°çš„ memtable ç„¶åæ¨å…¥åé¢çš„ imm_memtablesï¼Œå¹¶ä½¿ç”¨ MergeIterator::create() åˆ›å»º MergeIterator ä¹‹ååˆ›å»º FusedIterator pub fn scan( \u0026self, lower: Bound\u003c\u0026[u8]\u003e, upper: Bound\u003c\u0026[u8]\u003e, ) -\u003e Result\u003cFusedIterator\u003cLsmIterator\u003e\u003e { let guard = self.state.read(); let mut memtable_iters = Vec::new(); memtable_iters.push(Box::new(guard.memtable.scan(lower, upper))); for memtable in guard.imm_memtables.iter() { memtable_iters.push(Box::new(memtable.scan(lower, upper))); } let memtable_iter = MergeIterator::create(memtable_iters); drop(guard); Ok(FusedIterator::new(LsmIterator::new(memtable_iter)?)) } ä½†æˆ‘çš„å®ç°æ–¹æ³•é”ç²’åº¦å¤§ï¼Œcheckpoint ä½¿ç”¨äº† Arc::clone(\u0026guard) å…‹éš†äº†ä¸€ä¸ªåŸå­å˜é‡ï¼Œè¿™æ ·ä¸´ç•ŒåŒºå°ï¼Œå¯ä»¥ç«‹åˆ»é‡Šæ”¾é”è¿˜ä¿è¯äº†æ¯ä¸ªçº¿ç¨‹éƒ½èƒ½è¯»åˆ°ä¸€æ ·çš„ snapshotï¼š let snapshot = { let guard = self.state.read(); Arc::clone(\u0026guard) }; // drop global lock here ä½†æ­¤æ—¶è¿˜æ— æ³•é€šè¿‡æµ‹è¯•ï¼Œè§‚å¯Ÿæµ‹è¯•å¯ä»¥å‘ç°ï¼ŒLsmStorageInner åœ¨ delete æŸä¸ª key åï¼Œæˆ‘çš„å®ç°æ–¹æ³•æ— æ³•å°†å…¶å¿½ç•¥æ‰ï¼Œæ‰€ä»¥è¦é‡æ–°è€ƒè™‘å¾—åˆ°ä¸€ä¸ª LsmIterator è¿­ä»£å™¨åï¼Œå¦‚æœ next ä¸ºç©ºæˆ–è€… deleted keyï¼Œåº”è¯¥æ€ä¹ˆåšï¼š impl LsmIterator { pub(crate) fn new(iter: LsmIteratorInner) -\u003e Result\u003cSelf\u003e { let mut iter = Self { inner: iter }; iter.move_to_non_delete()?; Ok(iter) } } impl LsmIterator { fn move_to_non_delete(\u0026mut self) -\u003e Result\u003c()\u003e { while self.is_valid() \u0026\u0026 self.inner.value().is_empty() { self.inner.next()?; } Ok(()) } } impl StorageIterator for LsmIterator { // ... fn next(\u0026mut self) -\u003e Result\u003c()\u003e { self.inner.next()?; self.move_to_non_delete()?; Ok(()) } } è¿™é‡Œ self.inner.next() é€»è¾‘ä¸å˜ï¼Œä½†æ–°å¢ä¸€ä¸ªå‡½æ•°åˆ¤æ–­ç»è¿‡ next åå½“å‰ self.is_emptyï¼Œå¦‚æœæ˜¯åˆ™ç»§ç»­è¿­ä»£ï¼ŒåŒæ—¶è¿˜éœ€è¦ä¿®æ”¹ new() å› ä¸ºæ–°å»º LsmIterator æ—¶å€™ä¹Ÿå¯èƒ½ä¼ å…¥å¸¦æœ‰åˆ é™¤é”®çš„ LsmIteratorInner ï¼ˆæµ‹è¯•å°±æ˜¯è¿™æ ·åšçš„ï¼‰ ","date":"2024-03-23","objectID":"/posts/minilsm-2/:10:0","tags":["Database","LSM"],"title":"Mini-LSM Week 1 Day2","uri":"/posts/minilsm-2/"},{"categories":null,"content":"Conclusion è¿™æ¬¡å†™ä¸‹æ¥æ¯”è¾ƒåƒåŠ›ï¼Œä¸€æ–¹é¢å¯¹ Rust è¯­æ³•ä¸å¤ªç†Ÿæ‚‰ï¼Œå°¤å…¶æ˜¯ç±»å‹ä¸å¤ªæ‡‚ã€‚å¦ä¸€æ–¹é¢æ˜¯å¯¹ MVCC å’Œå¤šçº¿ç¨‹å¹¶å‘å¦‚ä½•åœ¨ Rust ä¸­å®ç°è¿˜æ²¡æœ‰å¥½çš„ç†è§£ï¼Œéœ€è¦çœ‹ä¸€ä¸‹ Rust å¤šçº¿ç¨‹ç¼–ç¨‹çš„ä¸€äº›ä¾‹å­ã€‚ What is the time/space complexity of using your merge iterator? Merge Iterator æ—¶é—´å¤æ‚åº¦çœ‹ä¸Šå»æ˜¯ O(log N * M)ï¼ŒN ä¸ª memtableï¼Œæ¯ä¸ªå¤§å° Mï¼Œç©ºé—´å¤æ‚åº¦åˆ™åº”è¯¥æ˜¯ O(N * M) Why do we need a self-referential structure for memtable iterator? è‡ªå¼•ç”¨, æŒ‡çš„æ˜¯ä¸€ä¸ªç»“æ„ä½“ä¸­, æœ‰ä¸€ä¸ªå­—æ®µéœ€è¦å¼•ç”¨è‡ªå·±çš„å¦ä¸€ä¸ª field, åœ¨ mem_table.rs ä¸­æœ‰ #[self_referencing] pub struct MemTableIterator { map: Arc\u003cSkipMap\u003cBytes, Bytes\u003e\u003e, /// Stores a skipmap iterator that refers to the lifetime of `MemTableIterator` itself. #[borrows(map)] #[not_covariant] iter: SkipMapRangeIter\u003c'this\u003e, // éœ€è¦å¼•ç”¨ map çš„å€¼ } å°±æ˜¯æ•™ç¨‹ä¸­è¯´çš„ï¼Œä¸ºäº†æ ‡è®° MemtableIterator çš„ç”Ÿå‘½å‘¨æœŸå’Œ map ä¸€è‡´, ç»“åˆ \u003c'this\u003e ä¸ self_referencing ä½¿å¾—ä»–ä»¬çš„ç”Ÿå‘½å‘¨æœŸä¸€è‡´. å¦åˆ™ä¼šå‡ºç° ä½¿ç”¨å€¼ å’Œ å€¼çš„å¼•ç”¨ åŒæ—¶å‡ºç°, æœ€ç»ˆæ‰€æœ‰æƒè½¬ç§» å’Œ å€Ÿç”¨ä¸€èµ·å‘ç”Ÿ If a key is removed (there is a delete tombstone), do you need to return it to the user? Where did you handle this logic? è¿™é‡Œå‚è€ƒäº† checkpoint çš„å®ç°, è·³è¿‡äº† deleted key, æ²¡æœ‰è¿”å›ç»™ç”¨æˆ· If we want to get rid of self-referential structure and have a lifetime on the memtable iterator (i.e., MemtableIterator\u003câ€˜a\u003e, where â€˜a = memtable or LsmStorageInner lifetime), is it still possible to implement the scan functionality? What happens if (1) we create an iterator on the skiplist memtable (2) someone inserts new keys into the memtable (3) will the iterator see the new key? What happens if your key comparator cannot give the binary heap implementation a stable order? Why do we need to ensure the merge iterator returns data in the iterator construction order? Is it possible to implement a Rust-style iterator (i.e., next(\u0026self) -\u003e (Key, Value)) for LSM iterators? What are the pros/cons? The scan interface is like fn scan(\u0026self, lower: Bound\u003c\u0026[u8]\u003e, upper: Bound\u003c\u0026[u8]\u003e). How to make this API compatible with Rust-style range (i.e., key_a..key_b)? If you implement this, try to pass a full range .. to the interface and see what will happen. The starter code provides the merge iterator interface to store Box instead of I. What might be the reason behind that? å‰©ä¸‹çš„è¿˜æ˜¯ç­‰å†™å®Œå…¨éƒ¨æœ‰ä¸ªå…·ä½“æ¦‚å¿µå›æ¥å†æ¥è¡¥å…… ","date":"2024-03-23","objectID":"/posts/minilsm-2/:11:0","tags":["Database","LSM"],"title":"Mini-LSM Week 1 Day2","uri":"/posts/minilsm-2/"},{"categories":null,"content":"Mini-LSM Week 1 Day1 è®°å½•ä¸‹ LSM çš„å­¦ä¹ è¿‡ç¨‹ï¼Œæ„Ÿè°¢è¿Ÿå…ˆç”Ÿçš„æ•™ç¨‹ https://skyzh.github.io/mini-lsm/ ","date":"2024-03-22","objectID":"/posts/minilsm-1/:1:0","tags":["Database","LSM"],"title":"Mini-LSM Week 1 Day1","uri":"/posts/minilsm-1/"},{"categories":null,"content":"å‰è¨€ ä½¿ç”¨ Rust å®ç° LSM-Tree å­˜å‚¨ç»“æ„ ","date":"2024-03-22","objectID":"/posts/minilsm-1/:2:0","tags":["Database","LSM"],"title":"Mini-LSM Week 1 Day1","uri":"/posts/minilsm-1/"},{"categories":null,"content":"ä»€ä¹ˆæ˜¯ LSMï¼Œä¸ºä»€ä¹ˆ LSM LSM, Log-structured merge trees, æ˜¯ä¸€ç§ç»´æŠ¤ key-value å¯¹çš„æ•°æ®ç»“æ„ã€‚è¿™ç§æ•°æ®ç»“æ„å¹¿æ³›ç”¨äºåˆ†å¸ƒå¼æ•°æ®åº“ï¼ˆTiDBï¼Œ CockroachDBï¼‰åŠå…¶å­˜å‚¨å¼•æ“ã€‚RocksDB åŸºäº LevelDB å®ç°äº† LSM-Tree å­˜å‚¨å¼•æ“ã€‚LSM æä¾›è®¸å¤š key-value è®¿é—®å‡½æ•°ï¼Œå¹¶ä¸”è¢«ç”¨äºè®¸å¤šç”Ÿäº§ç³»ç»Ÿã€‚ LSM Tree å±äº append-friendly æ·»åŠ å‹å¥½çš„æ•°æ®ç»“æ„ã€‚å°† LSM ä¸ B-Tree æˆ– RB-Tree ç­‰ key-value æ•°æ®ç»“æ„æ¯”è¾ƒã€‚å¯¹äºåè€…ï¼Œæ‰€æœ‰æ•°æ®éƒ½åœ¨åŸåœ°æ“ä½œï¼Œæ¯”å¦‚ä½ æƒ³è¦æ›´æ–° key å¯¹åº”çš„ valueï¼Œå­˜å‚¨å¼•æ“ä¼šç”¨æ–°å€¼ç›´æ¥è¦†ç›–åŸæœ‰çš„å€¼ï¼ˆå†…å­˜æˆ–ç¡¬ç›˜ï¼‰ã€‚è€Œåœ¨ LSM-Tree ä¸­ï¼Œæ‰€æœ‰å†™æ“ä½œ (æ¯”å¦‚ insert, update, delete) ä¼š lazily æ‡’åœ°åº”ç”¨åˆ°å­˜å‚¨ä¸­ï¼Œå­˜å‚¨å¼•æ“æ‰¹é‡åœ°å°†è¿™äº›æ“ä½œåˆ†æˆ SST (sorted string table) æ–‡ä»¶å¹¶ä¸”å†™å…¥ç£ç›˜ã€‚ä¸€æ—¦è¢«å†™å…¥åˆ°ç£ç›˜ï¼Œå­˜å‚¨å¼•æ“ä¸ä¼šç›´æ¥ä¿®æ”¹å®ƒä»¬ã€‚è€Œæ˜¯åœ¨ compaction åå°ä»»åŠ¡ä¸­ï¼Œå­˜å‚¨å¼•æ“ä¼šåˆå¹¶è¿™äº›æ–‡ä»¶ï¼Œåº”ç”¨è¿™äº›æ›´æ–°æˆ–åˆ é™¤ã€‚ è¿™ä¸ªæ¶æ„è®¾è®¡ä½¿å¾— LSM-Tree æ˜“äºä½¿ç”¨ï¼š æ•°æ®åœ¨å­˜å‚¨ä¸­æ˜¯ä¸å¯å˜çš„ immutableã€‚å¹¶å‘æ§åˆ¶æ›´åŠ ç›´è§‚ã€‚å°†åå°ä»»åŠ¡ï¼ˆcompactionï¼‰å¸è½½? (offload) åˆ°è¿œç¨‹æœåŠ¡å™¨æ˜¯å¯è¡Œçš„ã€‚åœ¨äº‘åŸç”Ÿå­˜å‚¨ç³»ç»Ÿæ¯”å¦‚ S3 å­˜å‚¨æˆ–æä¾›æ•°æ®ä¹Ÿå˜å¾—å¯è¡Œã€‚ æ”¹å˜ compaction ç®—æ³•å…è®¸å­˜å‚¨å¼•æ“åœ¨è¯»æ”¾å¤§ã€å†™æ”¾å¤§ã€ç©ºé—´æ”¾å¤§ä¹‹é—´å–å¾—å¹³è¡¡ã€‚LSM-Tree æ˜¯å¤šåŠŸèƒ½çš„ï¼Œé€šè¿‡è°ƒæ•´ compaction å‚æ•°ï¼Œå¯ä»¥ä¼˜åŒ– LSM æ•°æ®ç»“æ„åœ¨ä¸åŒå·¥ä½œè´Ÿè½½ä¸­çš„è¡¨ç°ã€‚ ","date":"2024-03-22","objectID":"/posts/minilsm-1/:2:1","tags":["Database","LSM"],"title":"Mini-LSM Week 1 Day1","uri":"/posts/minilsm-1/"},{"categories":null,"content":"å‰ææ¡ä»¶ Rust key-value store engine (PingCap Bitcask é¡¹ç›®) LevelDB ä¸€äº›æ¦‚å¿µèƒ½å¸®åŠ©ç†è§£ å¯å˜å’Œä¸å¯å˜ mem-table, SST, compaction, WAL ç­‰ç­‰ã€‚ ","date":"2024-03-22","objectID":"/posts/minilsm-1/:2:2","tags":["Database","LSM"],"title":"Mini-LSM Week 1 Day1","uri":"/posts/minilsm-1/"},{"categories":null,"content":"æœŸæœ› å­¦ä¹ äº†è§£åŸºäº LSM-Tree çš„å­˜å‚¨å¼•æ“æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œå°¤å…¶æ˜¯ä»å„ç§ tradeoffs æƒè¡¡ä¸­å¯»æ‰¾æœ€ä¼˜çš„ã€ç¬¦åˆä½ çš„å·¥ä½œè´Ÿè½½çš„éœ€æ±‚æˆ–ç›®æ ‡ã€‚ ","date":"2024-03-22","objectID":"/posts/minilsm-1/:2:3","tags":["Database","LSM"],"title":"Mini-LSM Week 1 Day1","uri":"/posts/minilsm-1/"},{"categories":null,"content":"æ€»è§ˆ ç¬¬ä¸€éƒ¨åˆ†ä¸»è¦ç ”ç©¶ LSM Tree çš„å­˜å‚¨ç»“æ„å’Œå­˜å‚¨æ ¼å¼ã€‚ ç¬¬äºŒéƒ¨åˆ†ä¸»è¦å…³äº compaction å’Œå®ç°æŒä¹…åŒ–ã€‚ ç¬¬ä¸‰éƒ¨åˆ†å®ç° MVCC å¤šç‰ˆæœ¬æ§åˆ¶ã€‚ ","date":"2024-03-22","objectID":"/posts/minilsm-1/:3:0","tags":["Database","LSM"],"title":"Mini-LSM Week 1 Day1","uri":"/posts/minilsm-1/"},{"categories":null,"content":"LSM LSM å­˜å‚¨å¤§è‡´å«æœ‰ä¸‰éƒ¨åˆ†ï¼š Write-Ahead Log ç”¨äºæŒä¹…åŒ–æ•°æ®ï¼ˆRecoveryï¼‰ SSTs åœ¨ç£ç›˜ç”¨äºç»´æŠ¤ LSM-Tree ç»“æ„ Mem-Tables åœ¨å†…å­˜ç”¨äº batching æ‰¹å¤„ç†å†™æ“ä½œ å­˜å‚¨å¼•æ“å¤§è‡´æä¾›è¿™äº›æ¥å£ï¼š Put(key, value): åœ¨ LSM Tree å­˜å‚¨ä¸€ä¸ª key-value é”®å€¼å¯¹ Delete(key): æ ¹æ® key åˆ é™¤ä¸€ä¸ª key-value é”®å€¼å¯¹ Get(key): æ ¹æ® key è·å¾— value Scan(range): è·å¾—ä¸€ä¸ªèŒƒå›´çš„ key-value é”®å€¼å¯¹ ä¸ºäº†ä¿è¯æŒç»­åŒ–ï¼š Sync(): ç¡®ä¿æ‰€æœ‰æ“ä½œåœ¨ sync ä¹‹å‰éƒ½è¢«æŒä¹…åŒ–åˆ°ç¡¬ç›˜ ä¸€äº›å¼•æ“ä¼šç»“åˆ Put å’Œ Delete æˆä¸ºä¸€ä¸ªæ“ä½œ WriteBatchï¼Œæ¥å—ä¸€æ‰¹é”®å€¼å¯¹ã€‚ MiniLSM æ•™ç¨‹å‡è®¾ LSM ä½¿ç”¨ leveled compactionï¼Œæ˜¯å¹¿æ³›ä½¿ç”¨çš„ã€‚ ","date":"2024-03-22","objectID":"/posts/minilsm-1/:3:1","tags":["Database","LSM"],"title":"Mini-LSM Week 1 Day1","uri":"/posts/minilsm-1/"},{"categories":null,"content":"å†™è·¯å¾„ å†™æ“ä½œåŒ…å«å››æ­¥ï¼š åœ¨ WAL å†™å…¥é”®å€¼å¯¹ï¼Œåœ¨å¼•æ“ crash æ—¶å¯ä»¥ recovery åœ¨ memtable å†™å…¥é”®å€¼å¯¹ã€‚å½“ 1 å’Œ 2 å®Œæˆåï¼Œé€šçŸ¥ç”¨æˆ·å†™æ“ä½œå®Œæˆ (åå°) å½“ memtable æ»¡æ—¶ï¼Œfreeze å®ƒä»¬æˆä¸º immutable mem-tables ç„¶å flush åˆ°ç¡¬ç›˜æˆä¸º SST files (åå°) å¼•æ“ compact è¿™äº›æ–‡ä»¶ï¼ŒæŒ‰ levels åˆ°ä¸€äº›ä½å±‚çš„ï¼Œç»´æŠ¤ä¸€ä¸ªå¥½çš„ LSM ç»“æ„ï¼Œå‡å°‘è¯»æ”¾å¤§ ","date":"2024-03-22","objectID":"/posts/minilsm-1/:3:2","tags":["Database","LSM"],"title":"Mini-LSM Week 1 Day1","uri":"/posts/minilsm-1/"},{"categories":null,"content":"è¯»è·¯å¾„ å½“éœ€è¦è¯»ä¸€ä¸ª key æ—¶ probe æ‰€æœ‰çš„ mem-tablesï¼Œä»æœ€è¿‘çš„åˆ°æœ€æ—§çš„ å¦‚æœ key æ²¡æ‰¾åˆ°ï¼Œå°±æœç´¢æ•´ä¸ª LSM tree åŒ…æ‹¬ SSTsï¼Œç›´åˆ°æ‰¾åˆ°è¿™ä¸ªæ•°æ® æœ‰ä¸¤ç§è¯»æ“ä½œï¼šlookup å’Œ scanï¼Œlookup æ‰¾åˆ°ä¸€ä¸ª keyï¼Œscan åœ¨ä¸€ä¸ªèŒƒå›´é‡Œæ‰¾åˆ°æ‰€æœ‰çš„ keysã€‚ ","date":"2024-03-22","objectID":"/posts/minilsm-1/:3:3","tags":["Database","LSM"],"title":"Mini-LSM Week 1 Day1","uri":"/posts/minilsm-1/"},{"categories":null,"content":"MiniLSM ç¬¬ä¸€ç« éœ€è¦æ„å»ºå¿…è¦çš„å­˜å‚¨æ ¼å¼ã€è¯»è·¯å¾„ã€å†™è·¯å¾„ï¼Œä»¥åŠä¸€ä¸ªåŸºäº LSM çš„ key-value storeã€‚ ","date":"2024-03-22","objectID":"/posts/minilsm-1/:4:0","tags":["Database","LSM"],"title":"Mini-LSM Week 1 Day1","uri":"/posts/minilsm-1/"},{"categories":null,"content":"Mem-Table in-memory çš„è¯»å†™è·¯å¾„ åŸºäº skiplist å®ç° memtables å®ç° freezing memtable çš„é€»è¾‘ å®ç° LSM çš„ memtable è¯»è·¯å¾„ get ","date":"2024-03-22","objectID":"/posts/minilsm-1/:4:1","tags":["Database","LSM"],"title":"Mini-LSM Week 1 Day1","uri":"/posts/minilsm-1/"},{"categories":null,"content":"Task1: SkipList Memtable src/mem_table.rs åŸºäº crossbeam_skiplist è·³è¡¨ï¼Œæ”¯æŒ lock-free å¹¶å‘è¯»å†™ã€‚è·³è¡¨æ˜¯ä¸€ä¸ªå…è®¸å¹¶å‘è¯»å†™çš„æœ‰åº key-value mapã€‚ crossbeam-skiplist æä¾›äº†ä¸ Rust std BTreeMap ç±»ä¼¼çš„æ¥å£ï¼šinsert, get å’Œ iterã€‚åŒºåˆ«åœ¨äºä¿®æ”¹çš„æ¥å£æ¯”å¦‚ insert éœ€è¦ä¸€ä¸ª immutable reference åˆ° skiplist è€Œä¸æ˜¯ä¸€ä¸ª mutableã€‚å®ç°ä¸åº”è¯¥ä½¿ç”¨ä»»ä½• mutex é”ã€‚ MemTable ç»“æ„æ²¡æœ‰ delete æ¥å£ï¼Œåœ¨ mini-lsm é¡¹ç›®ä¸­ï¼Œdeletion å¯ä»¥ç”¨ key å’Œ empty value è¡¨ç¤ºã€‚ Task1 éœ€è¦å®ç° MemTable::get å’Œ MemTable::put ä½¿å¾—å¯ä»¥ä¿®æ”¹ memtable bytes crate åŒ…ç”¨äºå­˜å–æ•°æ®ï¼Œbytes::Byte å’Œ Arc\u003c[u8]\u003e ç±»ä¼¼ã€‚å½“ clone Bytes æˆ–ä½¿ç”¨ Bytes çš„åˆ‡ç‰‡æ—¶ï¼Œæ•°æ®ä¸ä¼šè¢« copy, it is cheap to clone. æ‰€ä»¥åªæ˜¯ create a new reference to the storage. When there are no references to the area, it will be freed. è·³è¡¨ skiplist å¥½åƒåœ¨ä¹‹å‰å¹¶å‘çš„è¯¾ä¸Šå­¦è¿‡ï¼Œä½†å½“æ—¶ä¸ç†è§£æœ‰ä»€ä¹ˆç”¨ã€‚ Redis ä¸­çš„æœ‰åºé›†åˆ zsetï¼ŒLevelDBã€RocksDBã€HBase ä¸­ Memtable éƒ½ç”¨åˆ°äº† SkipList æŸ¥è¯¢çš„æœŸæœ›æ—¶é—´å¤æ‚åº¦ O(log(n)) å’Œçº¢é»‘æ ‘ç­‰å¹³è¡¡äºŒå‰æ ‘çš„åŒºåˆ«ï¼Ÿ åŸºäºæœ‰åºé“¾è¡¨ï¼Œå¼•å…¥åˆ†å±‚çš„æ¦‚å¿µï¼Œä½¿å¾—æœç´¢å¯ä»¥åƒäºŒåˆ†ä¸€æ ·ä»é«˜å±‚å¾€åº•å±‚æŸ¥æ‰¾ã€‚ æ¯ä¸ªä½äºç¬¬ i å±‚çš„èŠ‚ç‚¹æœ‰ p çš„æ¦‚ç‡å‡ºç°åœ¨ç¬¬ i+1 å±‚ æŸ¥æ‰¾ã€åˆ é™¤ã€å¢åŠ çš„ç®€å•å®ç°ï¼šhttps://leetcode.cn/problems/design-skiplist/ ","date":"2024-03-22","objectID":"/posts/minilsm-1/:4:2","tags":["Database","LSM"],"title":"Mini-LSM Week 1 Day1","uri":"/posts/minilsm-1/"},{"categories":null,"content":"Task1 Solution åœ¨ src/mem_table.rs ä¸­å®ç° impl Memtable ä¸­çš„ pub fn get(\u0026self, key: \u0026[u8]) -\u003e Option\u003cBytes\u003e {} å‡½æ•° pub fn put(\u0026self, key: \u0026[u8], value: \u0026[u8]) -\u003e Result\u003c()\u003e {} å‡½æ•° Memtable ä¸­æœ‰å››ä¸ªæˆå‘˜ map: Arc\u003cSkipMap\u003cBytes, Bytes\u003e\u003e å³è·³è¡¨ wal: Option\u003cWal\u003e æ˜¯ WAL æ—¥å¿— id: usize approximate_size: Arc\u003cAtomicUsize\u003e ç”±äºä¸éœ€è¦å…³å¿ƒè·³è¡¨çš„å…·ä½“å®ç°æ–¹æ³•ï¼Œå¯¹äº Memtable åªéœ€è¦è°ƒç”¨ map çš„ insert å’Œ get å°±å¯ä»¥ï¼š é¦–å…ˆå®ç° Memtable::get ï¼Œä»è·³è¡¨ä¸­è·å–æ•°æ®ï¼Œä½† key: \u0026[u8] æ˜¯ä¸€ä¸ªåˆ‡ç‰‡æ¯”å¦‚ b\"key1\"ã€‚ å®ç°æ–¹æ³•ï¼šä½¿ç”¨ self.map.get(key) è·å–ç›¸åº”çš„ valueï¼Œç”±äº map.get() çš„è¿”å›å€¼æ˜¯ Option\u003cEntry\u003c'_, K, V\u003e\u003eï¼Œéœ€è¦å°†å…¶è½¬æˆ Bytesï¼Œæ‰€ä»¥ä½¿ç”¨ map.get(key).map(|v| v.value()) ä½†æ­¤æ—¶ v çš„ç±»å‹æ˜¯ Option\u003c\u0026bytes::Bytes\u003e è¿˜éœ€è¦è½¬æ¢ï¼Œå¯ä»¥ä½¿ç”¨ clone() å°†ç»“æœè½¬æˆå‡½æ•°è¿”å›ç±»å‹çš„ Option\u003cBytes\u003e pub fn get(\u0026self, key: \u0026[u8]) -\u003e Option\u003cBytes\u003e { self.map.get(key).map(|v| v.value().clone()) // v: Entry\u003c'_, Bytes, Bytes\u003e } å†å®ç° Memtable::putï¼Œå­˜å…¥ key: \u0026[u8] å’Œ value: \u0026[u8] å¹¶ä¸”è¿”å› Result\u003c()\u003eã€‚ç”±äº task1 ä¸éœ€è¦å…³å¿ƒè·³è¡¨çš„å®ç°ï¼Œä¹Ÿä¸éœ€è¦å…³å¿ƒ WAL æ—¥å¿—ï¼Œç›´æ¥ä½¿ç”¨ self.map.insert()ã€‚ä½†æ˜¯è¯¥å‡½æ•°çš„ç­¾åæ˜¯ insert(\u0026self, key: K, value: V) -\u003e Entry\u003c'_, K, V\u003eï¼Œæ­¤æ—¶ K å’Œ V éƒ½æ˜¯ Bytes æ‰€ä»¥éœ€è¦å°† key å’Œ value è½¬æ¢æˆ Bytes (ä½¿ç”¨ bytes åº“æä¾›çš„ Bytes::copy_from_slice æ–¹æ³•ã€‚) ç„¶åå°† insert() çš„è¿”å›å€¼è½¬æˆ Result\u003c()\u003e ï¼ˆè¿™é‡Œå‚ç…§å…¶ä»–å‡½æ•°ç›´æ¥è¿”å› OK(())ï¼‰ pub fn put(\u0026self, key: \u0026[u8], value: \u0026[u8]) -\u003e Result\u003c()\u003e { self.map .insert(Bytes::copy_from_slice(key), Bytes::copy_from_slice(value)); Ok(()) } å®ç° MemTable::create åï¼Œå¯ä»¥é€šè¿‡ mini-lsm-starter tests::week1_day1::test_task1_memtable_overwrite å’Œ mini-lsm-starter tests::week1_day1::test_task1_memtable_get ä¸¤ä¸ªæµ‹è¯• ","date":"2024-03-22","objectID":"/posts/minilsm-1/:4:3","tags":["Database","LSM"],"title":"Mini-LSM Week 1 Day1","uri":"/posts/minilsm-1/"},{"categories":null,"content":"Task2: A Single Memtable in the Engine Task2 éœ€è¦ä¿®æ”¹ src/lsm_storage.rsï¼Œå°† Memtable åŠ å…¥åˆ° LSM State ä¸­ã€‚ åœ¨ LsmStorageState::create ä¸­æ ¹æ®ä¸åŒçš„ compaction_options åˆ›å»ºäº†ä¸€ä¸ª LSM ç»“æ„ memtable, imm_memtable, l0_sstables, levels, sstablesã€‚ é»˜è®¤æƒ…å†µä¸‹ memtable: Arc::new(MemTable::create(0)) åˆ›å»ºäº†ä¸€ä¸ª id ä¸º 0 çš„ mutable memtableã€‚ä»»ä½•æ—¶é—´ï¼Œå¼•æ“åªä¼šæœ‰ä¸€ä¸ª mutable memtableï¼Œé€šå¸¸æœ‰ä¸ªå¤§å°é™åˆ¶ï¼ˆæ¯”å¦‚ 256MBï¼‰ï¼Œå¹¶ä¸”å½“å­˜æ»¡åä¼šè¢« frozen å˜æˆ immutable memtable åœ¨ lsm_storage.rs æ–‡ä»¶ä¸­ï¼Œæœ‰ä¸¤ä¸ªç»“æ„è¡¨ç¤ºäº†å­˜å‚¨å¼•æ“ï¼šMiniLSM å’Œ LsmStorageInnerï¼Œå‰è€…æ˜¯ä¸€ä¸ª thin wrapper: pub struct MiniLsm { pub(crate) inner: Arc\u003cLsmStorageInner\u003e, flush_notifier: crossbeam_channel::Sender\u003c()\u003e, flush_thread: Mutex\u003cOption\u003cstd::thread::JoinHandle\u003c()\u003e\u003e\u003e, compaction_notifier: crossbeam_channel::Sender\u003c()\u003e, compaction_thread: Mutex\u003cOption\u003cstd::thread::JoinHandle\u003c()\u003e\u003e\u003e, } éœ€è¦å®ç°çš„æ–¹æ³•å¤§éƒ¨åˆ†åœ¨ LsmStorageInner ç›´åˆ° Week2 Compactionï¼Œè¿™ä¸ªç»“æ„åŒ…å«äº†å½“å‰çš„ LSM storage engine ç»“æ„ã€‚Week 1 åªç”¨åˆ° memtable ç»“æ„ï¼Œå¹¶ä¸”æ˜¯ mutable memtableã€‚ Task2 éœ€è¦å®ç° LsmStorageInner::get, LsmStorageInner::put å’Œ LsmStorageInner::deleteï¼Œè¿™äº›æ¥å£ä¼šåˆ†å‘è¯·æ±‚åˆ° memtable è€ƒè™‘ delete å‡½æ•°ï¼Œåº”è¯¥æ˜¯ç®€å•çš„å°† key å¯¹åº”çš„ value ä¿®æ”¹ä¸ºç©ºï¼Œç§°ä¸º delete tombstone æ ‡è®°åˆ é™¤è€Œä¸æ˜¯çœŸçš„ç›´æ¥åˆ é™¤ã€‚å®ç° get æ—¶åº”è¯¥æ³¨æ„è¿™ç‚¹ã€‚ ä¸ç›´æ¥åˆ é™¤çš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯ä¸ºäº† MVCC è¿˜æ˜¯ä¸ºäº†åé¢çš„ compaction ä¸ºäº†è®¿é—® memtable éœ€è¦ä½¿ç”¨é”ï¼Œstate lockï¼Œå®ç° put æ—¶åªéœ€è¦ immutable referenceï¼Œæ‰€ä»¥ä¿®æ”¹ memtable æ—¶å€™åªéœ€è¦è°ƒç”¨ state è¯»é”ã€‚è¿™ç§æ–¹æ³•å…è®¸å¤šçº¿ç¨‹å¯¹ memtable å¹¶å‘è®¿é—®ã€‚ å¦‚æœ put ç”¨äº†ä¸å¯å˜çš„å¼•ç”¨ï¼Œåˆ™ä¸ä¼šä¿®æ”¹åŸæ•°æ®ç»“æ„ï¼Œæ‰€ä»¥ ","date":"2024-03-22","objectID":"/posts/minilsm-1/:4:4","tags":["Database","LSM"],"title":"Mini-LSM Week 1 Day1","uri":"/posts/minilsm-1/"},{"categories":null,"content":"Task2 Solution å…ˆå®ç° LsmStorageInner::put å’Œ LsmStorageInner::deleteï¼Œå‰è€…è°ƒç”¨è¯»é”ï¼Œåè€…å­˜å…¥ç©ºå€¼ï¼Œç„¶ååœ¨ get ä¸­å¤„ç† pub fn put(\u0026self, key: \u0026[u8], value: \u0026[u8]) -\u003e Result\u003c()\u003e { self.state.read().memtable.put(key, value) } /// Remove a key from the storage by writing an empty value. pub fn delete(\u0026self, key: \u0026[u8]) -\u003e Result\u003c()\u003e { self.state.read().memtable.put(key, b\"\") // handle empty value in get } get å®ç°éœ€è¦é¢å¤–åˆ¤æ–­å–å‡ºæ¥çš„ Bytes æ˜¯ä¸æ˜¯ç©ºå€¼ pub fn get(\u0026self, key: \u0026[u8]) -\u003e Result\u003cOption\u003cBytes\u003e\u003e { if let Some(v) = self.state.read().memtable.get(key) { if v.is_empty() { return Ok(None); } return Ok(Some(v)); } Ok(None) } ","date":"2024-03-22","objectID":"/posts/minilsm-1/:4:5","tags":["Database","LSM"],"title":"Mini-LSM Week 1 Day1","uri":"/posts/minilsm-1/"},{"categories":null,"content":"Task 3: Write Path - Freezing a Memtable åœ¨ src/lsm_storage.rs å’Œ src/mem_table.rs å®ç° freeze a memtable åŠŸèƒ½ã€‚ç”±äº memtable æ— æ³•ä¸€ç›´å¢é•¿ï¼Œæ‰€ä»¥éœ€è¦å†·å†» freeze èµ·æ¥ï¼Œåœ¨å½“ memtable è¶…è¿‡å¤§å°é™åˆ¶æ—¶å¯ä»¥ flushï¼Œåœ¨ lsm_storage ä¸­ target_sst_size å­—æ®µè¡¨ç¤º SST table size åŒæ—¶ä¹Ÿæ˜¯ memtable çš„å¤§è‡´å¤§å°ï¼ˆæ¯”å¦‚ 1 \u003c\u003c 20 1MBï¼‰ã€‚ æœ¬ task éœ€è¦åœ¨ put/delete æ—¶ï¼Œä¼°ç®— memtable çš„å¤§å°ï¼Œæ¯”å¦‚ put æ—¶ç®€å•åœ°å°† keys and values çš„å­—èŠ‚å¤§å°åŠ èµ·æ¥ï¼ˆå¦‚æœ put ä¸¤æ¬¡ï¼Œä½ ä¹Ÿå¯ä»¥è®¡ç®—ä¸¤æ¬¡ï¼‰ã€‚ä¸€æ—¦ memtable è¾¾åˆ°å¤§å°é™åˆ¶ï¼Œè°ƒç”¨ force_freeze_memtable å†»ç»“ memtable ç„¶ååˆ›å»ºä¸€ä¸ªæ–°çš„ memtableã€‚ å› ä¸ºæ­¤æ—¶å¯èƒ½æœ‰å¤šä¸ªçº¿ç¨‹ä»å­˜å‚¨å¼•æ“ä¸­è·å–æ•°æ®ï¼Œforce_freeze_memtable å¯èƒ½ä¼šè¢«å¤šä¸ªçº¿ç¨‹å¹¶è¡Œè°ƒç”¨ï¼Œéœ€è¦è€ƒè™‘é¿å… race condition æœ‰å¤šä¸ªåœ°æ–¹å¯ä»¥æ›´æ”¹ LSM state: freeze a mutable memtable, flush memtable to SST, and GC/compaction. æ‰€æœ‰çš„ä¿®æ”¹ï¼Œéƒ½å¯èƒ½æ˜¯ IO æ“ä½œï¼Œä¸ºäº†å®ç° freeze_memtable éœ€è¦è°ƒç”¨ state ä¸­çš„å†™é”ï¼šlet state = self.state.write(), state.immutable_memtable.push(/* something */) å’Œ state.memtable = create(); ä½†æ˜¯ï¼Œå½“éœ€è¦ä¸ºæ¯ä¸ª memtable åˆ›å»º write-ahead log æ—¶ state.memtable = MemTable::create_with_wal()? ç”±äºéœ€è¦å‡ ä¸ªæ¯«ç§’æ¯”è¾ƒè€—æ—¶ï¼Œå…¶ä»–çº¿ç¨‹å°±éœ€è¦ç­‰å¾…ï¼Œé€ æˆ spike of latency å»¶è¿Ÿå°–å³°ã€‚ å¯ä»¥å°† IO æ“ä½œæ”¾åœ¨é”åŒºåŸŸå¤–ï¼Œæ¥è§£å†³è¿™ç§é—®é¢˜ï¼ˆåˆ›å»º Memtable å®é™…ä¸Šä¸éœ€è¦é”ï¼‰ï¼š fn freeze_memtable(\u0026self) { let memtable = MemTable::create_with_wal()?; // \u003c- could take several milliseconds { let state = self.state.write(); state.immutable_memtable.push(/* something */); state.memtable = memtable; } } ä½†è¿™å¼•èµ·äº†å¦ä¸€ç§æƒ…å†µï¼šmemtable å¿«è¦è¾¾åˆ°å®¹é‡é™åˆ¶ï¼Œå¹¶ä¸”ä¸¤ä¸ªçº¿ç¨‹æˆåŠŸ put äº†ä¸¤ä¸ª keys åˆ° memtableï¼Œå¹¶ä¸”éƒ½å‘ç°äº† memtable è¾¾åˆ°äº†å®¹é‡é™åˆ¶ã€‚ä¸¤ä¸ªçº¿ç¨‹éƒ½ä¼šæ£€æŸ¥ size ç„¶åå†³å®šè°ƒç”¨ freezeï¼Œäºæ˜¯ä¸¤ä¸ªç©ºçš„ memtable éƒ½è¢«åˆ›å»ºäº†ã€‚ ä¸ºäº†è§£å†³è¿™ç§æƒ…å†µï¼Œæ‰€æœ‰çš„ state ä¿®æ”¹æ“ä½œéƒ½éœ€è¦é€šè¿‡ state lock åŒæ­¥ï¼š fn put(\u0026self, key: \u0026[u8], value: \u0026[u8]) { // put things into the memtable, checks capacity, and drop the read lock on LSM state if memtable_reaches_capacity_on_put { let state_lock = self.state_lock.lock(); if /* check again current memtable reaches capacity */ { self.freeze_memtable(\u0026state_lock)?; } } } è¿™ç§æ¨¡å¼éå¸¸å¸¸è§ï¼Œæ¯”å¦‚ L0 flush ä¹Ÿæ˜¯è¿™æ ·ï¼š fn force_flush_next_imm_memtable(\u0026self) { let state_lock = self.state_lock.lock(); // get the oldest memtable and drop the read lock on LSM state // write the contents to the disk // get the write lock on LSM state and update the state } åœ¨è¿™ä¸ª Taskï¼Œéœ€è¦ä¿®æ”¹ put å’Œ delete æ»¡è¶³ memtable çš„ soft capacity limitï¼Œå½“åˆ°è¾¾é™åˆ¶æ—¶è°ƒç”¨ force_freeze_memtable å†»ç»“ memtableã€‚æµ‹è¯•æ–‡ä»¶å¹¶æ²¡æœ‰æµ‹è¯•å¹¶å‘åœºæ™¯ï¼Œæ‰€ä»¥éœ€è¦è‡ªå·±è€ƒè™‘å¤šç§ race condition ç«äº‰æƒ…å†µã€‚å¹¶ä¸”ï¼Œæ—¶åˆ»è®°ä½æ£€æŸ¥é”çš„åŒºåŸŸï¼Œä¿è¯ critical section ä¸´ç•ŒåŒºæ˜¯æœ€å°çš„ã€‚ å¯ä»¥ç®€å•åœ°èµ‹ç»™ä¸‹ä¸€ä¸ª memtable id ä¸º self.next_ssd_id(), æ³¨æ„ imm_memtables å­˜å‚¨äº†æœ€æ–°åˆ°æœ€æ—§çš„ memtablesï¼Œimm_memtables.first() æ˜¯æœ€åä¸€ä¸ªè¢«å†»ç»“çš„ã€‚ ä¿®æ”¹ Memtable::putï¼Œè®¡ç®— key å’Œ value çš„é•¿åº¦ï¼Œå¢åŠ åŸå­å˜é‡ï¼ˆä½¿ç”¨ Relaxed ä¸éœ€è¦çº¿æ€§ä¸€è‡´ï¼‰ pub fn put(\u0026self, key: \u0026[u8], value: \u0026[u8]) -\u003e Result\u003c()\u003e { let sz = key.len() + value.len(); self.map .insert(Bytes::copy_from_slice(key), Bytes::copy_from_slice(value)); self.approximate_size.fetch_add(sz, Ordering::Relaxed); Ok(()) } å®ç° LsmStorageInner::force_freeze_memtableï¼š pub fn force_freeze_memtable(\u0026self, _state_lock_observer: \u0026MutexGuard\u003c'_, ()\u003e) -\u003e Result\u003c()\u003e { let memtable_id = self.next_sst_id(); let memtable = if self.options.enable_wal { Arc::new(MemTable::create_with_wal( memtable_id, self.path_of_wal(memtable_id), )?) } else { Arc::new(MemTable::create(memtable_id)) }; let mut state = self.state.write(); // acquire the lock let mut snapshot = state.as_ref().clone(); // first use as_ref() to convert Arc to \u0026Arc and then clone() to make it mutable let old_memtable = std::mem::replace(\u0026mut snapshot.memtable, memtable); snapshot.imm_memtables.insert(0, old_memtable.clone()); // insert to the front *state = Arc::new(snapshot); // update the state drop(state); // release the lock // old_memtable.sync_wal()?; Ok(()) } è·å–æ–°çš„ memtable_id åæ ¹æ® option åˆ›å»ºæ–°çš„ Memtableï¼Œéšåè·å–å†™é”ï¼Œè·å– state çš„ mut çŠ¶æ€å¾—åˆ°æ—§çš„ memtableï¼Œä½¿ç”¨ std::mem::replace æ›¿æ¢æˆæ–°çš„ï¼Œéšåé‡Šæ”¾å†™é”å¹¶ä¸”æ›´æ–° *state = Arc::new(snapshot)ã€‚ ","date":"2024-03-22","objectID":"/posts/minilsm-1/:4:6","tags":["Database","LSM"],"title":"Mini-LSM Week 1 Day1","uri":"/posts/minilsm-1/"},{"categories":null,"content":"Task 4: Read Path - Get ä¿®æ”¹ src/lsm_storage.rs read path ä¸­çš„ get å‡½æ•°ï¼Œæ¥è·å–æœ€æ–°ç‰ˆæœ¬çš„ keyï¼Œä¿è¯ä½  probe æ‰«æäº†æœ€æ–°åˆ°æœ€æ—§çš„ memtable: pub fn get(\u0026self, key: \u0026[u8]) -\u003e Result\u003cOption\u003cBytes\u003e\u003e { let state = self.state.read(); if let Some(v) = state.memtable.get(key) { if v.is_empty() { return Ok(None); } return Ok(Some(v)); } for memtable in state.imm_memtables.iter() { if let Some(v) = memtable.get(key) { if v.is_empty() { return Ok(None); } return Ok(Some(v)); } } Ok(None) } ","date":"2024-03-22","objectID":"/posts/minilsm-1/:4:7","tags":["Database","LSM"],"title":"Mini-LSM Week 1 Day1","uri":"/posts/minilsm-1/"},{"categories":null,"content":"Conclusion ç¬¬ä¸€æ¬¡å†™ Rust é¡¹ç›®ï¼Œæœ‰å¾ˆå¤šä¸ç†Ÿæ‚‰ï¼Œå†™äº†è›®ä¹…ã€‚ é€šè¿‡ cargo x copy-test --week 1 --day 1 å’Œ cargo x scheck å¯ä»¥é€šè¿‡ç¬¬ä¸€å¤©çš„æ‰€æœ‰æµ‹è¯• ä¸ºä»€ä¹ˆ memtable ä¸æä¾› delete æ¥å£ï¼Ÿ çŒœæµ‹æ˜¯å› ä¸ºéœ€è¦ä¿æŒåŸå­æ“ä½œï¼Œæ¯”å¦‚è¯´å¤šç‰ˆæœ¬æ“ä½œ MVCCï¼Œæˆ–è€… WAL ä¸å¥½ç›´æ¥åˆ ï¼Œç­‰åˆ° compaction æ—¶å†å¤„ç† å¯ä»¥ç”¨å…¶ä»–æ•°æ®ç»“æ„å®ç° LSM ä¸­çš„ memtable å—ï¼Ÿä½¿ç”¨è·³è¡¨çš„ä¼˜åŠ£åŠ¿æ˜¯ä»€ä¹ˆï¼Ÿ å¯ä»¥ä½¿ç”¨çº¢é»‘æ ‘ç­‰è‡ªå¹³è¡¡æ ‘ç»“æ„ï¼Œæ¥å®ç°å¹³å‡æ—¶é—´å¤æ‚åº¦ O(logn) æŸ¥è¯¢ã€‚ä½†çº¢é»‘æ ‘éå¸¸éš¾å†™ï¼Œè·³è¡¨å®ç°åˆ™å¾ˆç›´è§‚ï¼ŒåŒæ—¶ä¸”æ”¯æŒèŒƒå›´æŸ¥è¯¢ï¼Œå†…å­˜å ç”¨ä¹Ÿå°‘ä¸€äº›ã€‚ ä¸ºä»€ä¹ˆéœ€è¦ state å’Œ state_lock çš„ç»„åˆï¼Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ state.read() å’Œ state.write() å—ï¼Ÿ åœ¨ LsmStorageInner ç»“æ„ä½“ä¸­æœ‰ state: Arc\u003cRwLock\u003cArc\u003cLsmStorageState\u003e\u003e\u003e å’Œ state_lock: Mutex\u003c()\u003e ç»„åˆ è™½ç„¶åœ¨ week1 day1 å¯ä»¥ä¸ç”¨ state_lcok ï¼ˆæŒ‰ç†æ¥è¯´åº”è¯¥åœ¨ force_freeze_memtable ç”¨ mutex é”ï¼Œé˜²æ­¢ç«äº‰ï¼Ÿï¼‰ è¿™ä¸ªé—®é¢˜ä¸å¤ªæ‡‚ï¼Œå¯èƒ½ Mutex æ˜¯ä¸ºäº†é˜²æ­¢å¤šä¸ªçº¿ç¨‹åŒæ—¶ put å¯¼è‡´åŒæ—¶ freeze çš„æƒ…å†µï¼Œæ­¤æ—¶ mutex ä¿æŠ¤ size ä¸ºä»€ä¹ˆ store å’Œ probe memtables çš„é¡ºåºå¾ˆé‡è¦ï¼Œå¦‚æœä¸€ä¸ª key åœ¨å¤šä¸ª memtablesï¼Œåº”è¯¥è¿”å›å“ªä¸ªç‰ˆæœ¬çš„ valueï¼Ÿ æœ€å…ˆè®¿é—®åº”è¯¥æ˜¯å†…å­˜ä¸­çš„ memtableï¼Œç„¶åä» imm_memtable ä»ç¬¬ä¸€ä¸ªå¼€å§‹æ¢æµ‹ï¼ˆç¬¬ä¸€ä¸ªæ˜¯æœ€æ–°çš„ï¼‰ï¼Œæ‰€ä»¥è¿”å›çš„ä¹Ÿæ˜¯æœ€æ–°çš„ latest version åé¢çš„ä¸€äº›é¢˜ç›®ç•™ç€ä¹‹åå†™å®Œæœ‰ä¸ªå…¨é¢è®¤è¯†å†æ¥çœ‹çœ‹ï¼Œå¯¹ Rust, LSM ä»¥åŠå¤šçº¿ç¨‹ç¼–ç¨‹è¿˜æ˜¯ä¸å¤ªç†Ÿæ‚‰ï¼Œå†™èµ·æ¥æœ‰äº›åƒåŠ› Is the memory layout of the memtable efficient / does it have good data locality? (Think of how Byte is implemented and stored in the skiplistâ€¦) What are the possible optimizations to make the memtable more efficient? So we are using parking_lot locks in this tutorial. Is its read-write lock a fair lock? What might happen to the readers trying to acquire the lock if there is one writer waiting for existing readers to stop? After freezing the memtable, is it possible that some threads still hold the old LSM state and wrote into these immutable memtables? How does your solution prevent it from happening? There are several places that you might first acquire a read lock on state, then drop it and acquire a write lock (these two operations might be in different functions but they happened sequentially due to one function calls the other). How does it differ from directly upgrading the read lock to a write lock? Is it necessary to upgrade instead of acquiring and dropping and what is the cost of doing the upgrade? More Memtable Formats. You may implement other memtable formats. For example, BTree memtable, vector memtable, and ART memtable. ","date":"2024-03-22","objectID":"/posts/minilsm-1/:4:8","tags":["Database","LSM"],"title":"Mini-LSM Week 1 Day1","uri":"/posts/minilsm-1/"},{"categories":null,"content":"Bao: Making Learned Query Optimization Practical MLDB + query optimization ","date":"2024-03-17","objectID":"/posts/bao-learned-query-opt/:1:0","tags":["Paper Reading"],"title":"Paper Reading: Bao: Making Learned Query Optimization Practical [SIGMOD 21]","uri":"/posts/bao-learned-query-opt/"},{"categories":null,"content":"ABSTRACT æœ€è¿‘ ML åš query optimization ç”±äºéœ€è¦ substantive training overhead æ‰€ä»¥å…¶å®å¾ˆå°‘ practical gains, inability to adapt to changes, poor tail performance. è®ºæ–‡æå‡ºäº† Bao, Bandit Optimizer, é€šè¿‡åˆ©ç”¨ç°æœ‰æŸ¥è¯¢ä¼˜åŒ–å™¨çš„çŸ¥è¯†ï¼Œå¯¹æ¯ä¸ªæŸ¥è¯¢æä¾›ä¼˜åŒ–å»ºè®®ã€‚ Bao combines mordern tree Convolutional Neural Networks (CNN) with Thompson sampling (RL). Bao å¯ä»¥ä»é”™è¯¯ä¸­å­¦ä¹ ï¼Œé€‚åº”ä¸åŒçš„ query workloads, data, schema. å®éªŒç»“æœæ˜¾ç¤º BAO å¯ä»¥å¿«é€Ÿå­¦ä¹ æ”¹å–„ç«¯åˆ°ç«¯æŸ¥è¯¢æ‰§è¡Œæ€§èƒ½ï¼ˆåŒ…æ‹¬ tail latencyï¼‰çš„ç­–ç•¥ï¼Œç”¨äºå‡ ç§åŒ…å« long-term æŸ¥è¯¢çš„å·¥ä½œè´Ÿè½½ã€‚åœ¨äº‘ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬è¡¨æ˜ï¼Œä¸å•†ä¸šç³»ç»Ÿç›¸æ¯”ï¼ŒBAO å¯ä»¥æä¾›é™ä½çš„æˆæœ¬å’Œæ›´å¥½çš„æ€§èƒ½ã€‚ é•¿å°¾è¯·æ±‚ï¼šP99, 99% è¯·æ±‚åœ¨ä¸€å®šè€—æ—¶å†…ï¼Œé•¿å°¾è¯·æ±‚å°±æ˜¯æ˜æ˜¾é«˜äºå‡å€¼çš„é‚£éƒ¨åˆ†æ¯”è¾ƒå°çš„è¯·æ±‚ ","date":"2024-03-17","objectID":"/posts/bao-learned-query-opt/:2:0","tags":["Paper Reading"],"title":"Paper Reading: Bao: Making Learned Query Optimization Practical [SIGMOD 21]","uri":"/posts/bao-learned-query-opt/"},{"categories":null,"content":"INTRODUCTION Query Optimization, cardinality estimation and cost modeling, difficult to crack å¾ˆå¤š Query Optimization éƒ½æ˜¯ ML åšçš„ï¼Œä½†å´æ˜¯å¾ˆå°‘å®ç”¨ï¼š Long training time, impractical amount of training data, ML-powered cardinality estimators based on supervised learning éœ€è¦æ”¶é›†ç²¾ç¡®çš„ cardinalitiesï¼Œéå¸¸æ˜‚è´µçš„æ“ä½œã€‚æ‰€ä»¥ Bao wish to estimate cardinalities in the first place. RL ä¹Ÿéœ€è¦å¥½å‡ å¤©çš„è®­ç»ƒã€‚ Inability to adjust to data and workload changes. query workload, data, schema æ˜¯ä¼šå˜çš„ï¼Œcardinality estimators based on supervised learning å°±éœ€è¦é‡æ–°è®­ç»ƒï¼Œä¸ç„¶å°±è¿‡æ—¶äº†ã€‚ Tail catastrophe. learning techniques æ¯” traditional optimizers å¹³å‡è¡¨ç°æ›´å¥½ï¼Œä½†æ˜¯é•¿å°¾è¡¨ç°å¾ˆå·® ï¼ˆ100x regression in query performanceï¼‰ã€‚å°¤å…¶æ˜¯è®­ç»ƒæ•°æ®ä¸è¶³æ—¶ï¼ŒåŒæ—¶ç»Ÿè®¡å’Œç°å®è¿˜æ˜¯å…·æœ‰å·®è·. Black-box decisions. DL æ–¹æ³•æ˜¯é»‘ç›’? ä¸ä¼ ç»Ÿä¼˜åŒ–å™¨ä¸åŒ, å½“å‰å­¦åˆ°çš„ä¼˜åŒ–æ–¹æ³•ä¸èƒ½ç»™ DBA æä¾›æ–¹æ³• Integration cost. å¤§éƒ¨åˆ† learned optimizers éƒ½æ˜¯ç ”ç©¶åŸå‹, å¾ˆå°‘ç»“åˆ DBMS. Bao å…‹æœäº†ä¸Šé¢çš„é—®é¢˜ï¼Œå¯ä»¥é›†æˆåˆ° PostgreSQLï¼Œhttps://github.com/learnedsystems/baoforpostgresql æ ¸å¿ƒæ€æƒ³ï¼šé¿å… learning an optimizer from scratchã€‚ take an existing optimizer (PostgreSQLâ€™s optimizer), and learn when to activate (or deactivate) some of its features on a query-by-query basis. In other words, Bao is a learned component that sits on top of an existing query optimizer in order to enhance query optimization, rather than replacing or discarding the traditional query optimizer altogether åœ¨ PostgreSQL ä¼˜åŒ–å™¨ä¹‹ä¸Šå¼€å§‹åšä¼˜åŒ–ï¼Œé‚£å¦‚æœä¹‹å‰çš„ä¼˜åŒ–å™¨ä¸å†æ›´æ–°ï¼Œåˆæˆ–è€…æ›´å¥½çš„ä¼˜åŒ–å™¨å‡ºç°äº†æ€ä¹ˆåŠå‘¢ï¼Ÿ PostgreSQL optimizer might underestimate the cardinality for some joins and wrongly select a loop join when other join algorithms (e.g., merge join, hash join) would be more effective This occurs in query 16b of the Join Order Benchmark (JOB)ï¼Œ and disabling loop-joins for this query yields a 3ğ‘¥ performance improvement (see Figure 1). Yet, it would be wrong to always disable loop joins. For example, for query 24b, disabling loop joins causes the performance to degrade by almost 50ğ‘¥, an arguably catastrophic regression. Bao assumes a finite set of hint sets and treats each hint set as an arm in a contextual multi-armed bandit problem. multi-armed bandit problem å¤šè‡‚èµŒåšæœºé—®é¢˜ï¼Œæœºå™¨å­¦ä¹ é—®é¢˜ï¼Œæ¯ä¸ªè€è™æœºèµ¢çš„æ¦‚ç‡ä¸ä¸€æ ·ï¼Œä¸çŸ¥é“æ¦‚ç‡ï¼Œé€‰æ‹©å“ªä¸ªèƒ½åšåˆ°æœ€å¤§æ”¶ç›Šï¼Ÿ Bao learns a model that predicts which hints will lead to good performance for a particular query. When a query arrives, our system selects a hint set, executes the resulting query plan, and observes a reward. Over time, Bao refines its model to more accurately predict which hint set will most benefit an incoming query. For example, for a highly selective query, Bao can automatically steer an optimizer towards a left-deep loop join plan (by restricting the optimizer from using hash or merge joins), and to disable loop joins for less selective queries By formulating the problem as a contextual multi-armed bandit, Bao can take advantage of Thompson sampling, a well-studied sample efficient algorithm Because Bao uses an underlying query optimizer, Bao has cardinality estimates available, allowing Bao to adapt to new data and schema changes just as well as the underlying optimizer. å…¶ä»– learned query optimization éœ€è¦é‡æ–°å­¦ä¹  ä¼ ç»Ÿä¼˜åŒ–å™¨ å·²çŸ¥çš„ä¿¡æ¯ï¼ŒBao å¯ä»¥ç›´æ¥å¼€å§‹å­¦ä¹ æ€ä¹ˆå»è°ƒä¼˜åº•å±‚ä¼˜åŒ–å™¨ï¼Œå¹¶ä¸”ç›¸è¾ƒäºä¼ ç»Ÿä¼˜åŒ–å™¨å¯ä»¥å‡å°‘ tail latencyã€‚ Short training time, 1 hour, by taking full advantage of existing query optimization knowledge, which was encoded by human experts into traditional optimizers available in DBMSes today Robustness to schema, data, and workload changes, maintain performance even in the presence of workload, data, and schema changes, leveraging a traditional query optimizerâ€™s cost and cardinality estimates Better tail latency, Bao is capable of improving tail performance by orders of magnitude with as little as 30 minutes to a few hours of training Interpretability and easier debugging, be inspected using standard tools, Low integration cost, every SQL Extensibility, adding new query hints over time, w/o retraining. Additionally, Baoâ€™s feature representation can be easily augmented with additional information which can be taken into account during optimization, although this does require retraining. cache state drawback: query optimization time increases, Bao must run the traditional quer","date":"2024-03-17","objectID":"/posts/bao-learned-query-opt/:3:0","tags":["Paper Reading"],"title":"Paper Reading: Bao: Making Learned Query Optimization Practical [SIGMOD 21]","uri":"/posts/bao-learned-query-opt/"},{"categories":null,"content":"SYSTEM MODEL Bao combines a tree convolution model, a neural network operator that can recognize important patterns in query plan trees, with Thompson sampling (solving contextual multi-armed bandit problems) Generating ğ‘› query plans: When a user submits a query, Bao uses the underlying query optimizer to produce ğ‘› query plans, one for each set of hint. While some hints can be applied to a single relation or predicate, Bao focuses only on query hints that are a boolean flag (e.g., disable loop join, force index usage). The sets of hints available to Bao must be specified upfront, empty -\u003e original optimizer Estimating the run-time for each query plan: Afterwards, each query plan is transformed into a vector tree (a tree where each node is a feature vector) -\u003e value model(tree convolutional neural network) -\u003e which predicts the quality (e.g., execution time) of each plan -\u003e parallel Selecting a query plan for execution: best expected performance -\u003e standard supervised fashion and pick the query plan with the best predicted performance. However, value model might be wrong, might not always pick the optimal plan and never try alternative strategies never learn when we are wrong. Thompson sampling explore a specific query offline and guarantee that only the best plan is selected. Once the query execution is complete, the combination of the selected query plan and the observed performance is added to Baoâ€™s experience. Periodically, this experience is used to retrain the predictive model, creating a feedback loop Assumptions and Limitations: assumes hints result in semantically equivalent query plans, Bao always uses the hints for the entire query plan. Bao cannot restrict features for only a part of a query plan. RL converge -\u003e small size of action Bao çš„ vaule model æ°¸è¿œä¸ä¼šä»é”™è¯¯ä¸­å­¦ä¹ ï¼Ÿè€Œä¸”çœ‹ä¸Šå»ä¸æ”¯æŒ subquery ä¼˜åŒ–ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯æ—¶é—´å¤æ‚åº¦å¤ªé«˜çš„åŸå› ã€‚ ","date":"2024-03-17","objectID":"/posts/bao-learned-query-opt/:4:0","tags":["Paper Reading"],"title":"Paper Reading: Bao: Making Learned Query Optimization Practical [SIGMOD 21]","uri":"/posts/bao-learned-query-opt/"},{"categories":null,"content":"SELECTING QUERY HINTS Baoâ€™s learning approach, optimization goal, formalize it as a contextual multi-armed bandit problem., apply Thompson sampling, a classical technique used to solve such problems Bao models each hint set in the family of hint sets Bao also assumes a user-defined performance metric ğ‘ƒ Contextual multi-armed bandits (CMABs): Thompson sampling: RL çš„ä¸€äº›ä¸œè¥¿ï¼Œä¸çœ‹äº† ","date":"2024-03-17","objectID":"/posts/bao-learned-query-opt/:5:0","tags":["Paper Reading"],"title":"Paper Reading: Bao: Making Learned Query Optimization Practical [SIGMOD 21]","uri":"/posts/bao-learned-query-opt/"},{"categories":null,"content":"Predictive model The core of Thompson sampling, Baoâ€™s algorithm for selecting hint sets on a per-query basis, is a predictive model that estimates the performance of a particular query plan. Bao æ˜¯æ€ä¹ˆè½¬æ¢ query plan trees: binarizing the query plan tree and encoding each query plan operator as a vector, optionally augmenting this representation with cache information Binarization: Many queries involve non-binary operations like aggregation or sorting. However, strictly binary query plan trees (i.e., all nodes have either zero or two children) are convenient because they greatly simplify tree convolution (explained in the next section). Vectorization: Each node in a query plan tree is transformed into a vector containing: (1) a one-hot encoding of the operator, (2) cardinality and cost information, and optionally (3) cache information Tree convolutional neural networks Integrating with Thompson sampling: ? ","date":"2024-03-17","objectID":"/posts/bao-learned-query-opt/:5:1","tags":["Paper Reading"],"title":"Paper Reading: Bao: Making Learned Query Optimization Practical [SIGMOD 21]","uri":"/posts/bao-learned-query-opt/"},{"categories":null,"content":"Training loop æå‡ºäº†æ–°çš„ optimization, åœ¨äº‘å¹³å°ä¸Šå¯ä»¥çƒ­åŠ è½½ GPUï¼Ÿ ","date":"2024-03-17","objectID":"/posts/bao-learned-query-opt/:5:2","tags":["Paper Reading"],"title":"Paper Reading: Bao: Making Learned Query Optimization Practical [SIGMOD 21]","uri":"/posts/bao-learned-query-opt/"},{"categories":null,"content":"POSTGRESQL INTEGRATION install and use with PostgreSQL, hook system Per-query activation: sits on top of a traditional optimizer, When Bao is activated, Thompson sampling is used to select query hints. When Bao is deactivated, the PostgreSQL optimizer is used. Note that even when Bao is disabled, Bao can (optionally) still learn from query executions. off-policy reinforcement learning ?? Active vs. advisor mode: In active mode, Bao operates as described above, automatically selecting hint sets and learning from their performance. In advisor mode, Bao does not select hint sets (all queries are optimized by the PostgreSQL planner), but still observes the performance of executed queries and trains a predictive model. Triggered exploration: query regressions, because Bao actively explores new query plans, regressions may be more erratic ","date":"2024-03-17","objectID":"/posts/bao-learned-query-opt/:6:0","tags":["Paper Reading"],"title":"Paper Reading: Bao: Making Learned Query Optimization Practical [SIGMOD 21]","uri":"/posts/bao-learned-query-opt/"},{"categories":null,"content":"RELATED WORKS One of the earliest applications of learning to query optimization was Leo [72], which used successive runs of the similar queries to adjust histogram estimators. Neo [51] showed that deep reinforcement learning could be applied directly to query latency, and could learn optimization strategies that were competitive with commercial systems after 24 hours of training. However, none of these techniques are capable of handling changes in schema, data, or queryworkload, and none demonstrate improvement in tail performance. Works applying reinforcement learning to adaptive query processing have shown interesting results, but are not applicableto existing, non-adaptive systems like PostgreSQL. æˆ‘ä¸è®¤ä¸º Bao å’Œ Neo æœ‰å¤ªå¤§çš„å·®åˆ«ï¼ŒåŒæ ·éƒ½æ˜¯ RLï¼Œä¸ºä»€ä¹ˆè¯´ Neo æ— æ³•é€‚åº”å˜åŒ–å‘¢ï¼Ÿ ","date":"2024-03-17","objectID":"/posts/bao-learned-query-opt/:7:0","tags":["Paper Reading"],"title":"Paper Reading: Bao: Making Learned Query Optimization Practical [SIGMOD 21]","uri":"/posts/bao-learned-query-opt/"},{"categories":null,"content":"EXPERIMENTS real-world database workloads, quantifying not only query performance, but also on the dollar-cost of executing a workload ","date":"2024-03-17","objectID":"/posts/bao-learned-query-opt/:8:0","tags":["Paper Reading"],"title":"Paper Reading: Bao: Making Learned Query Optimization Practical [SIGMOD 21]","uri":"/posts/bao-learned-query-opt/"},{"categories":null,"content":"Setup IMDb dataset, new real-world datasets and workload called Stack, Corp dataset å®éªŒç»“æœåªæ˜¯å’Œ PG, ComSys æ¯”äº†ä¸€ä¸‹ latencyï¼Œæ•ˆæœè¿˜ä¸é”™ï¼Œå¤§æ¦‚ 20% çš„æ”¹å–„ï¼Œ P99 ä¹Ÿæ”¹å–„å¾ˆå¤šï¼Œä½†ä¸ºä»€ä¹ˆè¿™éƒ¨åˆ†ä¸å’Œ Neo å¯¹æ¯”å‘¢ï¼Ÿ Query optimization time: The maximum optimization time required by PostgreSQL was 140ms, for the commercial system 165ms, and for Bao 230ms. For some applications, a 70ms increase in optimization time could be acceptable. Moreover, our current prototype is simple (e.g., our inference code is in Python), and thus a lot of optimization potential exists 230ms æ¯”èµ· 140ms è™½ç„¶ä¸å¤šï¼Œä½†ä¹Ÿä¸ç®—å°‘å§ï¼Œè€Œä¸”ç”¨äº†å¤§é‡å¹¶è¡Œ Prior learned optimizers: Neo [51] and DQ [40] are two other learning based approach to query optimization. Like Bao, Neo uses tree convolution, but unlike Bao, Neo does not select hint sets for specific queries, but instead fully builds query execution plans on its own. DQ uses deep Q learning [56] with a hand-crafted featurization and a fully-connected neural network (FCNN). We compare performance for the IMDb workload in Figure 14 (average of 20 repetitions on an N1-16 machine with a cutoff of 72 hours). For Figure 14a, we uniformly at random select a query to create a stable workload, and for Figure 14b we use our original dynamic workload. With a stable workload, Neo is able to overtake PostgreSQL after 24 hours, and Bao after 65 hours. This is because Neo has many more degrees of freedom than Bao: Neo can use any logically correct query plan for any query, whereas Bao is limited to a small number of options. These degrees of freedom come at a cost, as Neo takes significantly longer to converge. After 200 hours of training, Neoâ€™s query performance was 15% higher than Baoâ€™s. DQ, with a similar degrees of freedom as Neo, takes longer to outperform PostgreSQL, possibly due to FCNNs having a poor inductive bias [50] for query optimization [51]. With the dynamic workload (Figure 14b), Neo and DQâ€™s convergence is significantly hampered, as both techniques struggle to learn a policy robust to the changing workload. With a dynamic workload, neither DQ nor Neo is able to overtake Bao within 72 hours. 65h \u003e 24h ä¸ºä»€ä¹ˆ Bao ä¼šè¢« a small number of options é™åˆ¶å‘¢ï¼Œæ–‡ç« ä¹Ÿæ²¡æœ‰ä»”ç»†è§£é‡Š Bao æ˜¯æ€ä¹ˆé€‚åº” dynamic workload çš„ ","date":"2024-03-17","objectID":"/posts/bao-learned-query-opt/:8:1","tags":["Paper Reading"],"title":"Paper Reading: Bao: Making Learned Query Optimization Practical [SIGMOD 21]","uri":"/posts/bao-learned-query-opt/"},{"categories":null,"content":"CONCLUSION AND FUTURE WORK å®é™…ä¸Š Bao å›¢é˜Ÿå’Œ Neo å›¢é˜Ÿéƒ½æ˜¯ä¸€æ‰¹äººï¼Œåº”è¯¥æ˜¯æ³¨é‡ç‚¹ä¸å¤ªä¸€æ ·ï¼š Neo æ˜¯ç¬¬ä¸€ä¸ªæå‡ºæ·±åº¦å­¦ä¹  query optimizer çš„ï¼Œç”¨ä¸€ä¸ªæœªè¡¥å…¨çš„ query plan encoding ä¹‹åç”¨æ ‘å½¢ç½‘ç»œåšé¢„æµ‹ costï¼Œå¹¶ç”¨æœ€å°å †æœç´¢æœ€ä¼˜ planï¼Œå¿½ç•¥ cardinality ç­‰ç­‰ä¼ ç»Ÿï¼Œä¸ºæ¯ä¸ª predicate ç”¨æµ®ç‚¹æ•°å­˜ feature è®¾è®¡ word vector å­˜è¯­ä¹‰ï¼Œå¯èƒ½å¥½äº histgram é¢„æµ‹ã€‚ä½†ç¼ºç‚¹æ˜¯è®­ç»ƒæ—¶é—´é•¿ï¼Œåªåœ¨å¹³å‡ä¸Šæå‡æ¯”è¾ƒå¥½ï¼Œé«˜è´¨é‡çš„è®¡åˆ’å¾ˆå¯èƒ½åœ¨éšæœºæ ·æœ¬ä¸­ç¼ºå¤±ï¼Œæ ·æœ¬é‡å¿…é¡»å¤§ï¼Œæ¨¡å‹è®­ç»ƒæˆæœ¬å¤ªé«˜ã€‚ è€Œ Bao æ”¾å¼ƒåš Optimizerï¼Œä¸ºæˆç†Ÿæ•°æ®åº“æä¾› query hints å¦‚ boolean flag è¡¨ç¤ºæ˜¯å¦ä½¿ç”¨ hash join, merge join, index scan ç­‰ç­‰ï¼Œæšä¸¾æ‰€æœ‰ hint set (access method + join method) è§†ä½œå¤šè‡‚è€è™æœºï¼Œç”¨ Thompson sampling å¹³è¡¡é€‰ä¸€ä¸ªæœ€ä¼˜çš„ã€‚è®ºæ–‡æåˆ°äº† Bao æ”¶æ•›å¿«äº Neoï¼Œå¿«å¾ˆå¤šï¼Œè€Œä¸”å¯ä»¥æ ¹æ® workload è°ƒæ•´ï¼Œåœ¨ JOB æ•°æ®é›†ä¸Šè¡¨ç°éå¸¸å¥½ï¼Œä½†è¿˜æ˜¯å¯èƒ½ä¼šå»æ‰ä¸€äº›æœ€ä¼˜çš„ï¼Œé€‰æ‹©æ¬¡ä¼˜çš„ã€‚ å»å¹´ä¹Ÿæœ‰ä¸€ç¯‡ Leroï¼Œé‡‡ç”¨æˆå¯¹æ–¹æ³•è®­ç»ƒåˆ†ç±»å™¨ï¼Œä¹Ÿä¸æ˜¯ä»å¤´å¼€å§‹ï¼Œå¾ˆç±»ä¼¼ã€‚å°è¯•è§£å†³ Bao çš„ä¸€äº›é—®é¢˜: 1. åœ¨æ•´ä¸ªè®¡åˆ’æœç´¢è¿‡ç¨‹ä¸­ï¼Œé€šå¸¸å¯¹æ•´ä¸ªæŸ¥è¯¢åº”ç”¨æç¤ºé›†ã€‚å¦‚æœæŸ¥è¯¢çš„ä¸åŒéƒ¨åˆ†ï¼ˆå­æŸ¥è¯¢ï¼‰å…·æœ‰ä¸åŒçš„æœ€ä½³é€‰æ‹©ï¼Œåˆ™åœ¨æŸ¥è¯¢çº§åˆ«è°ƒæ•´æ ‡å¿—å¯èƒ½ä¼šé”™è¿‡å¯»æ‰¾é«˜è´¨é‡è®¡åˆ’çš„æœºä¼š 2. å¯ç”¨çš„æç¤ºé›†æ˜¯ç‰¹å®šäºç³»ç»Ÿçš„ã€‚ä¼˜åŒ–å™¨é€šå¸¸åŒ…å«æ•°ç™¾ä¸ªæ ‡å¿—æ¥å®ç°/ç¦ç”¨æŸäº›ä¼˜åŒ–è§„åˆ™ã€‚åœ¨å®è·µä¸­æšä¸¾å„ç§ç»„åˆæ˜¯ä¸å¯è¡Œçš„ã€‚æ‰‹åŠ¨é€‰æ‹©æç¤ºé›†çš„æœ‰æ•ˆå­é›†éœ€è¦å¯¹ç³»ç»Ÿè¿›è¡Œæ·±å…¥çš„ç†è§£ï¼Œå¹¶å¯¹å·¥ä½œè´Ÿè½½è¿›è¡Œç»¼åˆåˆ†æã€‚ Lero ç”šè‡³å®ç°äº†ä¸€ä¸ª Bao+, ç”¨æ›´å¤šè®¡åˆ’è¿›è¡Œæ¨¡å‹è®­ç»ƒï¼Œä½†å¥½åƒæ²¡æœ‰ä»”ç»†è¯´ã€‚åŒæ—¶æ‹“å±•äº†æ›´å¤šçš„æ•°æ®é›†ï¼Œ IMDBï¼ŒJOBï¼ŒSTATSï¼ŒTPC-Hï¼ŒTPC-DSï¼Œç­‰ç­‰ ","date":"2024-03-17","objectID":"/posts/bao-learned-query-opt/:9:0","tags":["Paper Reading"],"title":"Paper Reading: Bao: Making Learned Query Optimization Practical [SIGMOD 21]","uri":"/posts/bao-learned-query-opt/"},{"categories":null,"content":"Paer Reading The paper proposes a more practical model called Bao, which sits on top of an existing query optimizer (PostgreSQL) and utilizes machine learning and reinforcement learning for database query optimization. Bao solves lots of the issues with previous learned optimizers, including long training times, inability to adapt, and being difficult to interpret while offers advantages like faster training, robustness to workload and data changes, and better interpretability. The core idea of Bao is to utilize tree convolutional neural networks to analyze query plans and leverage ML techniques called Multi-armed bandit and Thompson Sampling to choose the best query plan among alternatives. Bao addresses a major limitation of previous learned optimizers â€“ long training times. By employing Thompson Sampling to solve bandit problem, Bao significantly reduces training time compared to traditional machine learning methods used for query optimization, and achieves similar performance to PostgreSQL in 2 hours training. Bao is more robust to changes in schema, data distribution, and query workload. By combining modern tree convolutional neural networks and Thompson sampling to provide query hints, Bao offers interpretability unlike other black-box machine learning models and aims to reduce tail latency and minimize the occurrence of slow-running queries. The paper also proposes a new method to optimize resource usage in cloud environments, specifically for tasks involving training a neural network with GPU and then using it for query optimization with CPU, which can reduce overall costs. Bao uses Thompson Sampling to enumerate all hint sets in the multi-armed bandit problem, but during the searching process, the hint set is applied to the entire query. If different parts of the query (subqueries) have different best choices, it will lead to the final choice is not optimal. Enumerating all collections is very time-consuming, the query optimization time of Bao is nearly 90ms higher than PostgreSQL. And for different systems, the size of the hint sets may be different, somtimes it might include hundreds of boolean flags. The architectures of Bao and Neo look very similar, though the authors of these papers are from the same group, the paper does not carefully compare Neo and Bao, especially the performance of training time and query latency. First, I would explain the difference between Neo and Bao in more depth, for example, why they all use modern tree convolutional neural networks. Besides, I will collect more data sets and testing their performance on more data benchmarks (such as TPC-H, TPC-DS, STATS). If possible, I would try some methods to limit the hint sets to reduce the current query optimization time, such as manual selection or from expert experiences. ","date":"2024-03-17","objectID":"/posts/bao-learned-query-opt/:10:0","tags":["Paper Reading"],"title":"Paper Reading: Bao: Making Learned Query Optimization Practical [SIGMOD 21]","uri":"/posts/bao-learned-query-opt/"},{"categories":null,"content":"Zero-Shot Cost Models for Out-of-the-box Learned Cost Prediction [VLDB 2022] ","date":"2024-03-16","objectID":"/posts/zero-shot-learned/:1:0","tags":["Paper Reading"],"title":"Paper Reading: Zero-Shot Cost Models for Out-of-the-box Learned Cost Prediction [VLDB 2022]","uri":"/posts/zero-shot-learned/"},{"categories":null,"content":"Abstract æœ¬æ–‡ä»‹ç»äº† zero-shot cost modelï¼Œè¯¥æ¨¡å‹å¯ä»¥ä½¿å­¦ä¹ çš„æˆæœ¬ä¼°ç®—èƒ½å¤Ÿ generalizes to unseen databasesã€‚ä¸æœ€ state-of-the-art çš„å·¥ä½œè´Ÿè½½é©±åŠ¨çš„æ–¹æ³•ç›¸åï¼Œè¿™äº›æ–¹æ³•ä¸å¿…åœ¨æ¯ä¸ªæ–°æ•°æ®åŸºç¡€ä¸Šæ‰§è¡Œå¤§é‡ training queries ï¼Œzero-shot cost models thus allow to instantiate a learned cost model out-of-the-box without expensive training data collectionã€‚ä¸ºäº† zero-shot cost modelsï¼Œæœ¬æ–‡æå‡º a new learning paradigm based on pre-trained cost modelsã€‚As core contributions to support the transfer of such a pre-trained cost model to unseen databases, we introduce a new model architecture and representation technique for encoding query workloads as input to those models. As we will show in our evaluation, zero-shot cost estimation can provide more accurate cost estimates than state-of-the-art models for a wide range of (real-world) databases without requiring any query executions on unseen databases. Furthermore, we show that zero-shot cost models can be used in a few-shot mode that further improves their quality by retraining them just with a small number of additional training queries on the unseen database. ä»¥åå°½å¯èƒ½å°‘åœ°ç›´æ¥æœºç¿»åŸè®ºæ–‡äº†ï¼Œå¤ªå¤šåè¯æœºç¿»æ•ˆæœå¾ˆå·®ï¼Œåè€Œé™ä½é˜…è¯»é€Ÿåº¦ã€‚åŸºæœ¬ä¸Šè¯»å®Œå°±å†™ä¸€ç‚¹æ„Ÿæƒ³ã€‚ ","date":"2024-03-16","objectID":"/posts/zero-shot-learned/:2:0","tags":["Paper Reading"],"title":"Paper Reading: Zero-Shot Cost Models for Out-of-the-box Learned Cost Prediction [VLDB 2022]","uri":"/posts/zero-shot-learned/"},{"categories":null,"content":"Introduction Motivation: Accurate physical cost estimation (i.e., estimating query latencies) is crucial for query optimization in DBMSs. Classically, cost estimation is performed using models that make several simplifying assumptions. As a result, such models often over or underestimate runtimes, leading to suboptimal planning decisions that degrade the overall query performance. Recently, machine learning has thus been used for learned cost models that do not need to make such simplifying assumptions. While it was shown that the cost estimates of such learned cost models are significantly more accurate than those of the traditional cost models, the existing approaches rely on workload-driven learning where models have to observe thousands of queries on the same database for which the cost prediction should be performed. This workload execution is required to gather the training data which can take hours (or days) since tens of thousands of queries need to be executed on potentially large databases In Figure 1, we show the cost estimation accuracy depending on how many hours we allow for gathering the training data for a workload-driven model. As we can see, even for a medium-sized database such as IMDB, it takes more than 5 hours of running queries on this database to gather enough training data such that the cost estimation model can provide a decent accuracy. Unfortunately, collecting training data by running queries is not a one-time effort. In fact, the training data collection has to be repeated for every new database a learned model should be deployed for. This is due to the fact that current model architectures for workload-driven learning tie a trained model to a particular database instance. Consequently, for every (new) unseen database we not only have to train a model from scratch but also gather training data in the form of queries. And even for the same database, in case of changed data characteristics due to updates, training data collection needs to be repeated. Overall, these repeated high costs for obtaining training data for unseen databases render workloaddriven learning unattractive for many practical deployments. è¿™é‡Œå‡ ä¸ªåè¯å¾ˆå¥‡æ€ª unseen database å’Œä»– database çš„æ¦‚å¿µä¹Ÿä¸åŒï¼Œå®é™…ä¸ŠæŒ‡çš„æ˜¯å…·æœ‰ç‰¹å®šæ•°æ®ç‰¹ç‚¹çš„æ•°æ®é›†ã€‚ å¯¹äº query optimization éœ€è¦æ”¶é›†å¾ˆå¤šæ•°æ®é›†ï¼Œå¹¶ä¸”ç²¾è¯»ä¸å¤Ÿé«˜ï¼Œè€Œä¸”å¯¹äºæ–°çš„æ•°æ®é›†åˆè¦é‡æ–°æ”¶é›†ã€‚zero-shot å¸Œæœ›èƒ½ç”¨ä¸€ç§è®­ç»ƒæ¨¡å‹æ¥æ³›åŒ–æ•°æ®é›†ã€‚ Contributions: In this paper, we thus suggest a new learning paradigm for cost estimation called zero-shot cost models that reduces these high efforts. The general idea behind zero-shot cost models is motivated by recent advances in transfer learning of models. Similar to other approaches such as GPT-3 which enable zero-shot learning for NLP, a zero-shot cost model is trained on a wide collection of different databases and workloads and can thus generalize out-of-the-box to a completely unseen database without the need to be trained particularly on that database. In fact as depicted in Figure 1, zero-shot cost models can provide a high accuracy and often even outperform existing workload-driven approaches that have been trained on large sets of training queries. Moreover, as we also show in Figure 1, zero-shot cost models can additionally be fine-tuned on the unseen database with just a few training queries and the resulting few-shot models further improve the accuracy. æœ¬æ–‡çš„æƒ³æ³•æ˜¯ç±»ä¼¼è¯­è¨€æ¨¡å‹è®­ç»ƒï¼Œè¿›è¡Œæ— æ ‡æ³¨çš„å¤§é‡é¢„å…ˆè®­ç»ƒï¼Œæ‰€ä»¥å¯ä»¥å¯¹æ²¡è§è¿‡çš„æ•°æ®é›†ç›´æ¥è¿›è¡Œä»£ä»·ä¼°è®¡ï¼Œå…·æœ‰è¾ƒé«˜çš„å‡†ç¡®ç‡ï¼Œç”šè‡³æ¯” workload-driven çš„è¡¨ç°å¥½ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥ fine-tunedã€‚ One could now argue that it might be a significant effort to collect sufficient training data across databases for pre-training a zero-shot model. However, in contrast to workload-driven models which require training data for every unseen database, training data collection is a one-time effort; i.e., once trained the zero shot model can be used for any new unseen database. In fact, in our evaluation we show that zero-shot models can provide high accuracies for a wide-variety of real-world databases. Moreover, for historical traces can be used which eliminates the need to collect any t","date":"2024-03-16","objectID":"/posts/zero-shot-learned/:3:0","tags":["Paper Reading"],"title":"Paper Reading: Zero-Shot Cost Models for Out-of-the-box Learned Cost Prediction [VLDB 2022]","uri":"/posts/zero-shot-learned/"},{"categories":null,"content":"Overview ","date":"2024-03-16","objectID":"/posts/zero-shot-learned/:4:0","tags":["Paper Reading"],"title":"Paper Reading: Zero-Shot Cost Models for Out-of-the-box Learned Cost Prediction [VLDB 2022]","uri":"/posts/zero-shot-learned/"},{"categories":null,"content":"Problem Statement ä¸»è¦ç›®æ ‡æ˜¯é¢„æµ‹åœ¨ unseen database ä¸Šçš„ query latencyï¼Œå¹¶ä¸”æ²¡æœ‰æå‰çŸ¥é“ä»»ä½• queryã€‚ æ–‡ç« è¯´ zero-short cost estimation å’Œ stoa workload-driven cost model æœ‰å¼ºçƒˆçš„å¯¹æ¯”ã€‚å¹¶ä¸”å¸Œæœ›èƒ½å¤Ÿåœ¨æµæ•°æ®åº“ã€å›¾æ•°æ®åº“åšä¸€äº›æœªæ¥çš„å·¥ä½œã€‚ Finally, while we believe that zero-shot learning for DBMSs is more generally applicable, we restrict ourselves in this paper to cost estimations for relational DBMSs (both single-node and distributed). In particular, zero-shot cost models for other types of systems such as graph-databases or streaming systems are interesting avenues of future work. ","date":"2024-03-16","objectID":"/posts/zero-shot-learned/:4:1","tags":["Paper Reading"],"title":"Paper Reading: Zero-Shot Cost Models for Out-of-the-box Learned Cost Prediction [VLDB 2022]","uri":"/posts/zero-shot-learned/"},{"categories":null,"content":"Our Approach A key challenge for developing zero-shot cost models is the question how to design a model that allows to generalize across databases. Typically, these consist of two models: a database-agnostic model to estimate the runtime cost and a database dependent model (e.g., histograms) to capture data characteristics. When predicting the cost of a query, the estimated cardinalities and other characteristics (i.e., outputs of the database-dependent models) serve as input to the general database-agnostic cost model which captures the general system behavior (e.g., the costs of a sequential scan grows linearly w.r.t. the number of rows). While the classical models are lightweight, they often largely under or overestimates the true costs of a query since models are too simple to capture complex interactions in the query plan and data. classical cost model åŒ…å«ä¸¤ä¸ª modelï¼Œä¼°è®¡è¿è¡Œæ—¶ cost å’Œæ•è· modelï¼Ÿ è¿™ä¸ªæ¨¡å‹åˆ†å¼€äº†å…³æ³¨ç‚¹ï¼Œç”¨ä¸€ä¸ªæ›´åŠ ä¸°å¯Œçš„å…·æœ‰çŸ¥è¯†çš„ learned æ¨¡å‹ï¼Œ similarly takes data characteristics of the unseen database as input to predict query runtimes in a database-agnostic mannerã€‚ç”¨ä¸åŒçš„ query plan å’Œ data characteristic of the plan è¿›è¡Œè®­ç»ƒã€‚ to predict the runtime of a query plan on a new (unseen) database, we feed the query plan together with its data characteristics into a zero-shot model. data characteristics æ˜¯ä»€ä¹ˆï¼Ÿtuple width, intermediate cardinalitiesï¼Œæ‰€ä»¥éœ€è¦æ•°æ®é©±åŠ¨å­¦ä¹ ï¼Ÿä½†è¿™æ˜¯å¦è¿åäº† zero-shotï¼Ÿè¿˜æ˜¯è¯´åªéœ€è¦è®­ç»ƒæ•°æ®ç‰¹å¾è€Œä¸æ˜¯ query è®­ç»ƒç„¶åæ¨ç†ï¼Œå’Œè¯­è¨€æ¨¡å‹ç±»ä¼¼ ä½†æ˜¯æ€ä¹ˆ estimate runtime of a plan given its data characteristics? æœ¬æ–‡æå‡ºäº†ä¸€ç§æ–°çš„ query è¡¨ç¤ºæ–¹æ³•ï¼Œæ—§çš„ä¸æ˜¯ transferable ä¹Ÿä¸æ˜¯ zero-shotã€‚è¿™ç§è¡¨ç°æ–¹å¼ completely relies on features that can be derived from any database to allow the model to generalize to unseen databases. For example, predicates for filter operations in a query are encoded by the general predicate structure (e.g., which data types and comparison operators are used in a predicate) instead of encoding the literals. In addition, data characteristics of a filter operator (e.g., input and output cardinality to express the selectivity) are provided as additional input to a zero-shot model. That way, a zero-shot model can learn the runtime overhead of a filter operation based on database-agnostic characteristics. We present details of our query representation in Section 3. Finally, a last important aspect of zero-shot cost models is that they can easily be extended to few-shot learning. Hence, instead of using the zero-shot model out-of-the box (which already can provide good performance), one can fine-tune the model with only a few training queries on an unseen database ","date":"2024-03-16","objectID":"/posts/zero-shot-learned/:4:2","tags":["Paper Reading"],"title":"Paper Reading: Zero-Shot Cost Models for Out-of-the-box Learned Cost Prediction [VLDB 2022]","uri":"/posts/zero-shot-learned/"},{"categories":null,"content":"Zero-Shot Cost Models how we devised such a transferable query representation how inference and training of a zero-shot model that uses this representation works ","date":"2024-03-16","objectID":"/posts/zero-shot-learned/:5:0","tags":["Paper Reading"],"title":"Paper Reading: Zero-Shot Cost Models for Out-of-the-box Learned Cost Prediction [VLDB 2022]","uri":"/posts/zero-shot-learned/"},{"categories":null,"content":"Query Representation State-of-the-art workload-driven models for cost estimation do not use transferable query representations and can thus only be used on the database they were trained on Query Representation for Workload-Driven Models: hard-code the model against a single database, attribute names (e.g., those used in filter predicates) are typically encoded using a one-hot encoding assigning each attribute present in the database a specific position in a feature vector. For instance, the attribute production_year of the IMDB dataset might be encoded using the vector (0,1,0)(assuming that there are only three attributes in total). If the same model should now be used to predict query costs for the SSB dataset, some attributes might not even exist or even worse they might exist but have very different data distributions or even a different data type. In fact, non-transferable feature encodings are not only used for attributes but in various places of the query representation such as encoding table names or literals in filter predicates. Query Representation for Zero-Shot Cost Models: Hence, for zero-shot cost models we require a new query representation that is transferable across databases. The main idea of the transferable representation we suggest in this paper is shown in Figure 3. At the core, a query plan and the involved tables and attributes are represented using a graph where graph nodes use transferable features 1 (i.e., features that provide meaningful information to predict runtime on different databases). This representation then serves as input for the training and inference process of zero shot cost models 2 ~ 4 that we explain in the subsequent sections. In the following, we discuss the graph encoding of the transferable featurization in detail Graph Encoding of Query Plans: While graph-based representations have been already used to represent query operators of a query plan [28], our representation has significant differences. First, as shown in Figure 3 1 , our representation not only encodes physical plan operators as nodes (gray) in the graph as in previous work [28], but it also covers all query plan information more holistically using different nodes types for attributes (green), tables (blue) as well as predicate information (red). Second, as discussed before, previous approaches also covered such information, however, they used one-hot-encodings (which are non-transferable) while our representation captures the query complexity in a transferable way For instance, to encode filter predicates, different from previous approaches we encode the predicate structure as nodes (red) without literals. In particular, we encode information such as data types of the attributes and operators used for comparisons. For example, the filter predicate company_type_id=2 for the query 0 in Figure 3, is encoded using an attribute node (ğ‘¥5) with the comparison node = (ğ‘¥7). As such, a zero-shot cost model provided with the transferable features (e.g., intermediate cardinalities which are given by the data-driven models) can infer the complexity of the predicates to estimate the query runtime Transferable Featurization: nodes in the graph 1 (e.g., plan operators as shown in gray) are transferable. In particular, when used on different databases, features should not encode any implicit information that hinder the transfer of the model to a new unseen database. The set of such features used for the different node types in our query representation is depicted in Table 1. For instance, attribute nodes (green) use features such as the data type or the width in bytes. Similarly, for tables (blue nodes), we use other transferable features (e.g., the number of rows as well as the number of pages on disk) transferable features can either characterize the query plan (e.g., operator types) or represent the data characteristics (e.g., intermediate cardinalities) For transferable features that represent data characteristics many can be de","date":"2024-03-16","objectID":"/posts/zero-shot-learned/:5:1","tags":["Paper Reading"],"title":"Paper Reading: Zero-Shot Cost Models for Out-of-the-box Learned Cost Prediction [VLDB 2022]","uri":"/posts/zero-shot-learned/"},{"categories":null,"content":"Inference on Zero-Shot Models ç”¨äº†æ¯ä¸ªå›¾èŠ‚ç‚¹çš„ç‰¹å¾å‘é‡æ¥åš MLP å¤šå±‚æ„ŸçŸ¥å™¨ï¼ˆæœºå™¨å­¦ä¹ ï¼‰ï¼ŒåŠ ä¸Š GNN åšæ¶ˆæ¯ä¼ é€’ï¼Œç”¨ DAG è¡¨ç¤ºæŸ¥è¯¢ We thus use a novel bottom-up message passing scheme through the graph (i.e., in topological ordering) to obtain an updated hidden state â„â€²ğ‘£ of a node ğ‘£ that contains all information of the child nodes. æœºå™¨å­¦ä¹ å†…å®¹ï¼Œæ²¡å¤ªç†è§£ ","date":"2024-03-16","objectID":"/posts/zero-shot-learned/:5:2","tags":["Paper Reading"],"title":"Paper Reading: Zero-Shot Cost Models for Out-of-the-box Learned Cost Prediction [VLDB 2022]","uri":"/posts/zero-shot-learned/"},{"categories":null,"content":"Training Zero-Shot Models åœ¨å‡ ä¸ªæ•°æ®é›†å’ŒæŸ¥è¯¢é›†ä¸Šåšäº†è®­ç»ƒ ","date":"2024-03-16","objectID":"/posts/zero-shot-learned/:5:3","tags":["Paper Reading"],"title":"Paper Reading: Zero-Shot Cost Models for Out-of-the-box Learned Cost Prediction [VLDB 2022]","uri":"/posts/zero-shot-learned/"},{"categories":null,"content":"Deriving Data Characteristics zero shot model å’Œå•ä¸ªæ•°æ®é›†çš„åˆ†å¸ƒæ— å…³ï¼Œæ‰€ä»¥èƒ½é¢„æµ‹ unseen datasetï¼ŒåŒæ—¶ä¸ºäº†å®ç°è¯¥ç‰¹æ€§ï¼Œéœ€è¦æä¾›æ•°æ®çš„ç‰¹å¾ï¼ˆå±æ€§å®½åº¦ã€é¡µé¢æ•°é‡ã€è¡¨æ ¼è¡Œæ•°é‡ï¼‰ æ‰€ä»¥éœ€è¦äººä¸º labelï¼Ÿæ²¡æœ‰è§£é‡Šæ¸…æ¥šåˆ°åº•æ€ä¹ˆé¢„æµ‹ cardinality estimation æœ¬æ¨¡å‹æ˜¯å’Œ traditional approach å’Œ data-driven model è¿›è¡Œæ¯”è¾ƒï¼Œä½† zero-shot æœ€å¥½å¯ä»¥å’Œåè€…ç»“åˆï¼Œä¼ ç»Ÿæ–¹æ³•ä½œä¸º fallbackã€‚ In our evaluation, we see that zero-shot models can still produce reasonable estimates even if only cardinalities estimates from traditional models are available ","date":"2024-03-16","objectID":"/posts/zero-shot-learned/:5:4","tags":["Paper Reading"],"title":"Paper Reading: Zero-Shot Cost Models for Out-of-the-box Learned Cost Prediction [VLDB 2022]","uri":"/posts/zero-shot-learned/"},{"categories":null,"content":"Robustness of Zero-Shot Models é’ˆå¯¹ unseen datasets, zero-shot model å…·æœ‰ä¼˜åŠ¿ï¼Œä½†åœ¨ä»€ä¹ˆæ—¶å€™å¯ä»¥è§‚å¯Ÿåˆ°è¶³å¤Ÿå¤šçš„ä¸åŒè®­ç»ƒæ•°æ®åº“(å’Œå·¥ä½œè´Ÿè½½) ï¼Œä»è€Œå¯ä»¥é²æ£’åœ°æ¨å¹¿åˆ° unseenï¼Ÿ é›¶æ‹æ¨¡å‹çš„è¿è¡Œæ—¶ä¼°è®¡çš„é²æ£’æ€§ï¼ŒWe then discuss a simple method to detect cases of workload drifts (i.e., the queries at runtime have substantially different characteristics than the training queries) as well as strategies how to tackle this problem. ","date":"2024-03-16","objectID":"/posts/zero-shot-learned/:6:0","tags":["Paper Reading"],"title":"Paper Reading: Zero-Shot Cost Models for Out-of-the-box Learned Cost Prediction [VLDB 2022]","uri":"/posts/zero-shot-learned/"},{"categories":null,"content":"Estimating the Generalization Performance simply esimate the generalization errors (actually use) estimate if additional training databases will improve the generalization performance æ‰€ä»¥è®­ç»ƒæ—¶ç”¨äº† subsetsï¼Œç„¶åç”¨æ›´å¤§çš„ train set å¦‚æœæ²¡æœ‰æ”¹è¿›ï¼Œåˆ™æ— æ³•æé«˜ generalization èƒ½åŠ› ","date":"2024-03-16","objectID":"/posts/zero-shot-learned/:6:1","tags":["Paper Reading"],"title":"Paper Reading: Zero-Shot Cost Models for Out-of-the-box Learned Cost Prediction [VLDB 2022]","uri":"/posts/zero-shot-learned/"},{"categories":null,"content":"Tackling Workload Drifts new database and workload, we suggest a strategy to detect cases of workload drifts by monitoring the test error and propose to tackle workload-drifts using few-shot learning è¿™æ˜¯ä¸€ä¸ªè›®æ–°å¥‡çš„ ideaï¼Œç”¨å¾®è°ƒè¿‡çš„æ¨¡å‹æ¥æ£€æµ‹å’Œè§£å†³ workload drifts ","date":"2024-03-16","objectID":"/posts/zero-shot-learned/:6:2","tags":["Paper Reading"],"title":"Paper Reading: Zero-Shot Cost Models for Out-of-the-box Learned Cost Prediction [VLDB 2022]","uri":"/posts/zero-shot-learned/"},{"categories":null,"content":"Extensions of Zero-Shot Cost Models zero-shot cost estimation can be extended in various directions. ","date":"2024-03-16","objectID":"/posts/zero-shot-learned/:7:0","tags":["Paper Reading"],"title":"Paper Reading: Zero-Shot Cost Models for Out-of-the-box Learned Cost Prediction [VLDB 2022]","uri":"/posts/zero-shot-learned/"},{"categories":null,"content":"Distributed DBMSs æœ¬æ–‡çš„ç ”ç©¶å¯¹è±¡è¿˜æ˜¯ å•æœº DBMSï¼Œè¿™ä¸€èŠ‚è®¨è®ºäº†å¦‚ä½•æ”¯æŒåˆ†å¸ƒå¼ DBMSï¼Œå°¤å…¶æ˜¯å½“æŸ¥è¯¢æ‰§è¡Œæ—¶æ•°æ®ä¼šè¢«æ‰“ä¹± shuffleã€‚å¹¶ä¸”è®¨è®ºäº†ä¸€äº›åˆ—å­˜/è¡Œå­˜æ—¶ï¼ŒæŸ¥è¯¢ä¼˜åŒ–çš„åŒºåˆ«ã€‚ ç„¶åæœ¬æ–‡æå‡ºäº†å¯¹ æŸ¥è¯¢ è¿›è¡Œæ‰©å±•ç¼–ç ï¼ŒåŒ…å« operator nodes for data shuffling as well as encode data formats (column or row) as a feature of the table node ","date":"2024-03-16","objectID":"/posts/zero-shot-learned/:7:1","tags":["Paper Reading"],"title":"Paper Reading: Zero-Shot Cost Models for Out-of-the-box Learned Cost Prediction [VLDB 2022]","uri":"/posts/zero-shot-learned/"},{"categories":null,"content":"Physical Design Tuning æ²¡æ‡‚ ","date":"2024-03-16","objectID":"/posts/zero-shot-learned/:7:2","tags":["Paper Reading"],"title":"Paper Reading: Zero-Shot Cost Models for Out-of-the-box Learned Cost Prediction [VLDB 2022]","uri":"/posts/zero-shot-learned/"},{"categories":null,"content":"Other Directions hardware parameters, database knob configurationsâ€¦ ","date":"2024-03-16","objectID":"/posts/zero-shot-learned/:7:3","tags":["Paper Reading"],"title":"Paper Reading: Zero-Shot Cost Models for Out-of-the-box Learned Cost Prediction [VLDB 2022]","uri":"/posts/zero-shot-learned/"},{"categories":null,"content":"A New Benchmark æœ¬æ–‡æå‡ºäº†ä¸€ä¸ªæ–°çš„ benchmark ","date":"2024-03-16","objectID":"/posts/zero-shot-learned/:8:0","tags":["Paper Reading"],"title":"Paper Reading: Zero-Shot Cost Models for Out-of-the-box Learned Cost Prediction [VLDB 2022]","uri":"/posts/zero-shot-learned/"},{"categories":null,"content":"Design Decisions æœ¬æ–‡è®¤ä¸ºä¼ ç»Ÿ TPC-H TPC-DS or SSB ä¸è¶³å¤Ÿè¯„ä¼°æˆæœ¬é¢„æµ‹æ¨¡å‹ï¼Œå¹¶ä¸”å› ä¸ºè¿™äº›æ•°æ®æ˜¯åˆæˆçš„ï¼Œæ²¡æ³•æ•æ‰åˆ°ç›¸å…³æ€§æ¥æä¾› cardinality estimationï¼Œä¹Ÿæœ‰äººåŸºäº IMDB æ•°æ®é›†ç»„äº†ä¸€äº›æ–°çš„ workload ç—…æ•…å­¦ä¹ çš„æˆæœ¬å’Œ cardinality estimationã€‚ä½†è¿™ä¹Ÿä¸èƒ½è¯„ä¼° zero-shotï¼Œå› ä¸ºè¦åœ¨ä¸åŒçš„æ•°æ®é›†ä¸Šè®­ç»ƒï¼Œéœ€è¦ä¸€ä¸ªè·¨è¶Šå¤šç§æ•°æ®é›†çš„ benchmarkã€‚ ","date":"2024-03-16","objectID":"/posts/zero-shot-learned/:8:1","tags":["Paper Reading"],"title":"Paper Reading: Zero-Shot Cost Models for Out-of-the-box Learned Cost Prediction [VLDB 2022]","uri":"/posts/zero-shot-learned/"},{"categories":null,"content":"Datasets correlations hardly resemble data distributions found in the real-world æœ¬æ–‡ä½¿ç”¨äº†çœŸå®ä¸–ç•Œæ•°æ®é›†ï¼Œä¹ŸåŠ å…¥äº† SSB å’Œ TPC-H ","date":"2024-03-16","objectID":"/posts/zero-shot-learned/:8:2","tags":["Paper Reading"],"title":"Paper Reading: Zero-Shot Cost Models for Out-of-the-box Learned Cost Prediction [VLDB 2022]","uri":"/posts/zero-shot-learned/"},{"categories":null,"content":"Workloads and Traces 20 ä¸ªæ•°æ®é›† + ç”Ÿæˆçš„æŸ¥è¯¢ ","date":"2024-03-16","objectID":"/posts/zero-shot-learned/:8:3","tags":["Paper Reading"],"title":"Paper Reading: Zero-Shot Cost Models for Out-of-the-box Learned Cost Prediction [VLDB 2022]","uri":"/posts/zero-shot-learned/"},{"categories":null,"content":"Experimental Evaluation Zero-Shot Accuracy, predict costs for unseen databases. Zero-Shot vs. Workload-Driven, compare the training overhead and accuracy with state-of-the-art workload driven approaches Generalization, workload drifts Extensions, distributed DBMSs and different physical designs Training and Inference Performance, compare training efforts to workload-driven models Ablation Study, alternatives of zero-shot models, how many database are sufficient for zero-shot cost models to generalize å®éªŒç»“æœå°±ä¸çœ‹äº†ï¼Œæ–‡ç« æ²¡æœ‰æ·±å…¥è®¨è®ºä»–ä»¬çš„æ•°æ®é›†çš„åŒºåˆ«ï¼Œå®éªŒç»“æœçœ‹èµ·æ¥å’Œ workload-driven çœ‹ä¸Šå»ä¹Ÿå·®ä¸å¤š ","date":"2024-03-16","objectID":"/posts/zero-shot-learned/:9:0","tags":["Paper Reading"],"title":"Paper Reading: Zero-Shot Cost Models for Out-of-the-box Learned Cost Prediction [VLDB 2022]","uri":"/posts/zero-shot-learned/"},{"categories":null,"content":"Conclusion The paper proposes a novel zero-shot cost model that enables learned cost estimation to unseen databases without extensive training on new datasets. The architecture of zero-shot cost model is very similar to the language model in NLP. It adopts the idea of â€‹â€‹pre-training, so that it can perform well on different datasets, and can also be fine-tuned for special datasets. The paper details the methods used to enable zero-shot cost models, including the transferable query representation, training zero-shot models and deriving data characteristics.The paper also discusses the robustness and scalability of zero-shot models (distributed database). The paper proposes a new benchmark spanning multiple datasets, and gives experimental results, proving that zero-shot models can perform excellent cost estimation on unseen datasets The paper proposes a novel zero-shot cost model, and suggests a learning paradigm based on pre-trained cost models. A new model architecture and a representation technique for encoding query workloads as input to these models are introduced, which together allow a zero shot cost model to generalize to an unseen database. The paper derives a method to estimate how accurate the runtime estimations of zero-shot models will be for unseen databases, and provides a new benchmark necessary to evaluate cost estimation models more broadly on a variety of real-world databases. The paper not only discusses the zero-shot cost model based on a single-node DBMS, but also discusses future work, proving that zero-shot cost estimation can also be achieved in a distributed database. It can also be combined with data-driven models or even fine-tuned zero-shot models for better cost estimations and accuracy. The zero-shot cost model may not always accurately predict costs for queries on databases that significantly differ from those seen during the modelâ€™s training, because it relies on pre-trained models and there are often large differences between real-world datasets and query workloads. This paper somewhat confuses the concepts of datasets and databases. And while zero-shot models can eliminate the need for extensive training on each new database, they may still require some fine-tuning or a few-shot learning approach to achieve the best performance on specific datasets and queries, which is not completely zero-shot. Although the paper has used 20 widely different data sets for benchmarking, 19 of them were used for training and only 1 was used for testing. It should be tested with more data sets. First, I would try to create a larger and more diverse training and testing dataset that covers a wide range of database schemas and query workloads and extend the benchmark used for evaluating cost models to include more real-world databases and complex queries. This would provide a more comprehensive assessment of the modelâ€™s performance and its ability to generalize. Second, extending the zero-shot model to distributed databases or more databases seems very feasible. I might try to expand this part a little further, especially to implement zero-shot cost models fordistributed stream processing or graph databases, because the queries and datasets for stream processing and graph database will be very different. The other parts of the paper are very perfect, especially the architecture that draws on language models, which is very clever. ","date":"2024-03-16","objectID":"/posts/zero-shot-learned/:10:0","tags":["Paper Reading"],"title":"Paper Reading: Zero-Shot Cost Models for Out-of-the-box Learned Cost Prediction [VLDB 2022]","uri":"/posts/zero-shot-learned/"},{"categories":null,"content":"SPADE: Synthesizing Assertions for Large Language Model Pipelines Synthesizing Assertions Pipelines åˆæˆæ–­è¨€ã€æµæ°´çº¿ ","date":"2024-03-01","objectID":"/posts/spade-paper/:1:0","tags":["Paper Reading"],"title":"Paper Reading: Spade Synthesizing Assertions for Large Language Model Pipelines","uri":"/posts/spade-paper/"},{"categories":null,"content":"ABSTRACT å°†å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰ç”¨äºå®šåˆ¶ã€é‡å¤æ•°æ® pipeline çš„æ“ä½œå…·æœ‰æŒ‘æˆ˜æ€§ï¼Œç‰¹åˆ«æ˜¯ç”±äºå…¶ä¸å¯é¢„æµ‹å’Œæ½œåœ¨çš„ç¾éš¾æ€§æ•…éšœã€‚è®¤è¯†åˆ°è¿™äº›é”™è¯¯çš„ä¸å¯é¿å…æ€§ï¼Œæˆ‘ä»¬å°†é‡ç‚¹æ”¾åœ¨è¯†åˆ« LLM åœ¨ä½œä¸ºæ•°æ®ç”Ÿæˆ pipeline çš„ä¸€éƒ¨åˆ†é‡å¤ä½¿ç”¨æ—¶å¯èƒ½ç”Ÿæˆé”™è¯¯å“åº”çš„æƒ…å†µã€‚æˆ‘ä»¬æå‡ºäº† spadeï¼Œä¸€ç§è‡ªåŠ¨åˆæˆæ–­è¨€çš„æ–¹æ³•ï¼Œå¯ä»¥è¯†åˆ«ä¸è‰¯çš„ LLM è¾“å‡ºã€‚SPADE åˆ†ææç¤ºç‰ˆæœ¬å†å²ï¼Œåˆ›å»ºå€™é€‰æ–­è¨€å‡½æ•°ï¼Œç„¶åé€‰æ‹©æ»¡è¶³è¦†ç›–ç‡å’Œå‡†ç¡®æ€§è¦æ±‚çš„æœ€å°é›†åˆã€‚åœ¨å¯¹ä¹ç§ä¸åŒçš„å®é™… LLM pipeline è¿›è¡Œæµ‹è¯•æ—¶ï¼Œä¸ç®€å•çš„åŸºçº¿ç›¸æ¯”ï¼Œspade æœ‰æ•ˆåœ°å‡å°‘äº† 14% çš„æ–­è¨€æ•°é‡ï¼Œå¹¶å°†é”™è¯¯å¤±è´¥ç‡é™ä½äº† 21%ã€‚ ","date":"2024-03-01","objectID":"/posts/spade-paper/:2:0","tags":["Paper Reading"],"title":"Paper Reading: Spade Synthesizing Assertions for Large Language Model Pipelines","uri":"/posts/spade-paper/"},{"categories":null,"content":"INTRODUCTION åœ¨æ•°æ® pipeline ä¸­ä½¿ç”¨å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰å¼•èµ·äº†å¹¿æ³›å…³æ³¨[17]ã€‚è¿™ç§çƒ­æƒ…å¾ˆå¤§ç¨‹åº¦ä¸Šå½’åŠŸäºå…¶ç®€å•æ€§ï¼šæ— éœ€å¤§å‹æ ‡æ³¨æ•°æ®é›†ï¼Œåªéœ€ç”¨è‡ªç„¶è¯­è¨€æç¤º LLMï¼Œå°±èƒ½è½»æ¾åˆ›å»ºä¸€ä¸ªè‡ªåŠ¨åŒ–çš„æ™ºèƒ½ pipeline ï¼Œåœ¨æ•°ç§’å†…æ‰§è¡Œä»»æ„æ•°æ®ç”Ÿæˆä»»åŠ¡ã€‚ç„¶è€Œï¼Œå°† LLM ç”¨äºæ— ç›‘ç£ã€é‡å¤æˆ–å¤§è§„æ¨¡çš„æ•°æ®ç”Ÿæˆä»»åŠ¡å´é¢ä¸´ç€å·¨å¤§çš„æŒ‘æˆ˜[34]ï¼Œä¾‹å¦‚æ½œåœ¨çš„é”™è¯¯ã€ä¸æ°å½“çš„ååº”æˆ–å¹»è§‰[44, 57]ã€‚ Data Management For Large Language Models: A Surveyï¼Œæ²¡å¤ªç†è§£å¼•ç”¨è¿™ç¯‡è®ºæ–‡çš„æ„æ€ï¼Œæ˜¯åœ¨é¢„è®­ç»ƒã€å¾®è°ƒæ—¶ç®¡ç†æ•°æ® ç”¨ LLM åˆ¶ä½œåº”ç”¨æ—¶ï¼Œå§‹ç»ˆæ— æ³•é¿å… potential errors, inappropriate responses, or hallucination è€ƒè™‘ä½¿ç”¨ LLM ç”Ÿæˆä¸ªæ€§åŒ–ç”µå½±æ¨èè¯´æ˜çš„ç”µå½±æµåª’ä½“å¹³å°ã€‚å¼€å‘äººå‘˜å¯èƒ½ä¼šç¼–å†™ç±»ä¼¼çš„æç¤ºæ¨¡æ¿ï¼š â€œæ ¹æ®ç”¨æˆ·çš„ä»¥ä¸‹ä¿¡æ¯ï¼Œä¸ºç”¨æˆ·åº”è¯¥è§‚çœ‹ {movie_name} çš„åŸå› ç¼–å†™ä¸ªæ€§åŒ–è¯´æ˜ï¼š {personal_info}â€œè¿™æ ·çš„æç¤ºæ¨¡æ¿ï¼Œé’ˆå¯¹å¤šä¸ªç”¨æˆ·-ç”µå½±é…å¯¹æ‰§è¡Œã€‚æ¨¡æ¿åŒ–å˜é‡ä»£è¡¨çš„ä¿¡æ¯å°†åœ¨è¿è¡Œæ—¶æ³¨å…¥ pipeline ï¼Œä½¿ pipeline èƒ½å¤Ÿä¸ºå„ç§è¾“å…¥ç”Ÿæˆæ•°æ®ã€‚ä»ç†è®ºä¸Šè®²ï¼Œè¿™ç§æç¤ºä¼¼ä¹è¶³å¤Ÿäº†ï¼Œä½†å¼€å‘äººå‘˜åœ¨å¯¹ä¸€äº›ç¤ºä¾‹è¾“å…¥è¿›è¡Œæµ‹è¯•æ—¶å¯èƒ½ä¼šå‘ç°ä¸€äº›é—®é¢˜ï¼šLLM å¯èƒ½ä¼šå¼•ç”¨ç”¨æˆ·ä»æœªçœ‹è¿‡çš„ç”µå½±ï¼Œå¼•ç”¨æ•æ„Ÿå±æ€§ï¼ˆå¦‚ç§æ—æˆ–æ°‘æ—ï¼‰ï¼Œç”šè‡³å‡ºç°å“åº”è¿‡çŸ­ç­‰åŸºæœ¬é—®é¢˜ã€‚ ä¸ºäº†è§£å†³è¿™äº›ç¼ºé™·ï¼Œæœ‰äººæå‡ºäº†åœ¨ LLM pipeline ä¸­åŠ å…¥æ–­è¨€ assertions çš„æ¡†æ¶ï¼Œä»¥ä¾¿åœ¨åˆ°è¾¾æœ€ç»ˆç”¨æˆ·ä¹‹å‰è¿‡æ»¤æ‰ä¸è‰¯ç”Ÿæˆ[37, 49]ã€‚é‰´äº LLM é”™è¯¯çš„ä¸å¯é¿å…æ€§[23]ï¼Œæ­¤ç±»æ–­è¨€æ˜¯æˆåŠŸéƒ¨ç½²ç”Ÿæˆæ•°æ®çš„ LLM pipeline çš„å…³é”®ã€‚ç„¶è€Œï¼Œå¼€å‘äººå‘˜å‘ç°ä¸ºè‡ªå®šä¹‰ LLM pipeline ç¼–å†™æ–­è¨€éå¸¸å›°éš¾ [35]ã€‚é¢ä¸´çš„æŒ‘æˆ˜åŒ…æ‹¬ï¼šé¢„æµ‹æ‰€æœ‰å¯èƒ½çš„ LLM æ•…éšœæ¨¡å¼ï¼›ä½¿ç”¨å„ç§è§„èŒƒæ–¹æ³•ï¼ˆå¦‚ Python å‡½æ•°æˆ– LLM è°ƒç”¨ï¼‰ç¼–å†™æ–­è¨€è€—æ—¶ï¼›æ–­è¨€ï¼ˆå°¤å…¶æ˜¯æ¶‰åŠ LLM è°ƒç”¨çš„æ–­è¨€ï¼‰å¿…é¡»ç²¾ç¡®ï¼›ä»¥åŠè®¸å¤š LLM pipeline å¼€å‘äººå‘˜ç¼ºä¹è½¯ä»¶å·¥ç¨‹ä¸“ä¸šçŸ¥è¯†æˆ–ç¼–ç ç»éªŒ [26ï¼Œ57]ã€‚æ­¤å¤–ï¼Œå¦‚æœæ–­è¨€è¿‡å¤šæˆ–ä¸å…·ä¿¡æ¯æ€§ï¼Œå¼€å‘äººå‘˜åœ¨ç›‘æ§å…¶ç»“æœæ—¶å¯èƒ½ä¼šä¸çŸ¥æ‰€æª åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å‘ç°äº†ä¸€ä¸ªæ–°é—®é¢˜ï¼Œå³å¦‚ä½•ä¸ºä»»ä½•åˆ©ç”¨ LLM çš„æ•°æ®ç”Ÿæˆ pipeline è‡ªåŠ¨ç”Ÿæˆä¸€ç»„å¥½çš„æ–­è¨€ã€‚å¯¹äº LLM å“åº”ï¼Œä¸€ä¸ªæ–­è¨€è¿”å›çœŸï¼ˆå³æˆåŠŸï¼‰æˆ–å‡ï¼ˆå³å¤±è´¥ï¼‰ï¼Œè€Œä¸€ç»„æ–­è¨€åˆ™è¿”å›å•ä¸ªæ–­è¨€çš„è”ç»“ã€‚ä¸€ç»„ â€œå¥½ â€œçš„æ–­è¨€å…·æœ‰æœ€å°çš„é‡å ï¼Œå…è®¸å¼€å‘äººå‘˜åœ¨é”™è¯¯çš„æˆåŠŸå’Œé”™è¯¯çš„å¤±è´¥ä¹‹é—´è¿›è¡Œæƒè¡¡ã€‚æˆ‘ä»¬å°†é—®é¢˜åˆ†è§£ä¸ºä¸¤ä¸ªéƒ¨åˆ†â€“å€™é€‰æ–­è¨€ç”Ÿæˆå’Œè¿‡æ»¤ candidate assertion generation and filtering â€“å¹¶æå‡ºäº† spadeï¼ˆ System for Prompt Analysis and Delta-Based Evaluation å›¾ 1ï¼‰ã€‚ delta åœ¨è¿™é‡Œæ˜¯ diff çš„æ„æ€ï¼Ÿ candidate assertion å’Œ filtering éƒ½æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿçœ‹ä¸Šå»è¿˜æ˜¯ LLM å®ç°çš„ å¯¹äºå€™é€‰æ–­è¨€çš„ç”Ÿæˆï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘ç›´æ¥è¯¢é—® LLM â€œä¸º x æç¤ºç¼–å†™æ–­è¨€â€ï¼Œä½†è¿™å¯èƒ½æ— æ³•æ»¡è¶³å¼€å‘äººå‘˜çš„è¦æ±‚ã€‚æˆ‘ä»¬å»ºè®®ä» prompt deltasï¼ˆå³ä¸¤ä¸ªè¿ç»­æç¤ºç¬¦ç‰ˆæœ¬ä¹‹é—´çš„å·®å¼‚ï¼‰ä¸­ç”Ÿæˆå€™é€‰æ–­è¨€ï¼Œè¿™é€šå¸¸è¡¨ç¤º LLM çš„ç‰¹å®šæ•…éšœæ¨¡å¼ã€‚ä¾‹å¦‚ï¼Œå¼€å‘äººå‘˜å¯èƒ½ä¼šæ·»åŠ ç±»ä¼¼ â€œé¿å…èŠ±å“¨è¯­è¨€ â€œçš„æŒ‡ä»¤ï¼Œä»è€Œä¿ƒä½¿æ–­è¨€æ£€æŸ¥å“åº”è¯­è¨€ã€‚æˆ‘ä»¬å¯¹æ¥è‡ª LangChainï¼ˆä¸€å®¶å¸®åŠ©äººä»¬æ„å»º LLM pipeline çš„åˆåˆ›å…¬å¸ï¼‰ç”¨æˆ·çš„ 19 ä¸ªè‡ªå®šä¹‰æ•°æ®ç”Ÿæˆ pipeline å’Œ pipeline æç¤ºç‰ˆæœ¬å†å²è¿›è¡Œäº†åˆ†æï¼Œä»è€Œå½¢æˆäº†ä¸€ä¸ª a taxonomy of prompt deltasã€‚Spade é¦–å…ˆåœ¨åˆ†ç±»æ³•ä¸­è‡ªåŠ¨å¯¹æç¤ºè„±èŠ‚è¿›è¡Œåˆ†ç±»ï¼Œç„¶åå°† Python å‡½æ•°ï¼ˆå¯èƒ½åŒ…æ‹¬ LLM è°ƒç”¨ï¼‰åˆæˆä¸ºå¯ç”¨æ–­è¨€ã€‚æˆ‘ä»¬å…¬å¼€å‘å¸ƒäº† SPADE çš„è¿™ä¸€ç»„ä»¶ï¼Œå±•ç¤ºäº†è¿™äº›æ–­è¨€çš„æ½œåŠ›ï¼Œå®ƒåœ¨é‡‘èã€åŒ»è¯å’Œ IT ç­‰ 10 å¤šä¸ªé¢†åŸŸæœ‰ 1300 å¤šä¸ªç”¨é€” [46] ã€‚ åœ¨ langchain ä¸Šçš„ SPADE ä¾‹å­ æˆ‘ä»¬å¯¹å€™é€‰æ–­è¨€çš„åˆ†æå‘ç°äº†å†—ä½™ã€ä¸å‡†ç¡®å’Œå¤§é‡å‡½æ•°ï¼Œä»…å‡ ä¸ª prompt deltas å°±å¾€å¾€è¶…è¿‡ 50 ä¸ªã€‚å†—ä½™æºäºå¯¹æç¤ºç›¸ä¼¼éƒ¨åˆ†çš„é‡å¤å®Œå–„ï¼Œæˆ–æç¤ºæŒ‡ä»¤å«ç³Šä¸æ¸…ï¼ˆå¦‚ â€œè¿”å›ä¸€ä¸ªç®€æ´çš„å›å¤â€ï¼‰ã€‚å‡å°‘å†—ä½™å¹¶ä¸ç®€å•ï¼Œå³ä½¿å¯¹å·¥ç¨‹å¸ˆæ¥è¯´ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œå› ä¸ºæ–­è¨€å¯èƒ½æ¶‰åŠç²¾ç¡®åº¦ä¸åŒçš„ LLM è°ƒç”¨ï¼Œè¿™å°±éœ€è¦ä¸€ä¸ªè‡ªåŠ¨è¿‡æ»¤ç»„ä»¶ã€‚ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨å¼€å‘äººå‘˜æ ‡è®°çš„ LLM å“åº”æ¥ä¼°ç®—æ¯ä¸ªæ–­è¨€çš„é”™è¯¯å¤±è´¥ç‡ï¼ˆfalse failure rate FFRï¼‰ï¼Œå¹¶å‰”é™¤æ¯ä¸ªè¶…è¿‡å¼€å‘äººå‘˜å®šä¹‰çš„ FFR é˜ˆå€¼çš„æ–­è¨€ã€‚ç„¶è€Œï¼Œå…¶ä½™æ–­è¨€çš„ FFR å¯èƒ½ä¼šç´¯è®¡è¶…è¿‡è¿™ä¸ªé˜ˆå€¼ï¼Œå†—ä½™å¯èƒ½ä¼šæŒç»­å­˜åœ¨ã€‚æˆ‘ä»¬çš„ç ”ç©¶è¡¨æ˜ï¼Œé€‰æ‹©ä¸€å°éƒ¨åˆ†æ–­è¨€æ¥æ»¡è¶³æ•…éšœè¦†ç›–ç‡å’Œ FFR æ ‡å‡†æ˜¯ NP-hard çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æ•´æ•°çº¿æ€§è§„åˆ’ï¼ˆILPï¼‰æ¥è¡¨è¾¾è¿™ä¸ªé—®é¢˜ï¼Œå¹¶ä½¿ç”¨ ILP æ±‚è§£å™¨æ¥æ‰¾å‡ºè§£å†³æ–¹æ¡ˆã€‚ç„¶è€Œï¼Œæˆ‘ä»¬å‘ç°æ ‡è®°çš„å“åº”å¯èƒ½æ— æ³•ä»£è¡¨æ‰€æœ‰æ•…éšœæ¨¡å¼ï¼Œä»è€Œå¯¼è‡´é—æ¼æœ‰ä»·å€¼çš„æ–­è¨€ã€‚ä¾‹å¦‚ï¼Œåœ¨æˆ‘ä»¬çš„ç”µå½±æ¨èåœºæ™¯ä¸­ï¼Œå¦‚æœå¼€å‘äººå‘˜æ ‡æ³¨æ ·æœ¬ä¸­çš„æ‰€æœ‰å›å¤éƒ½ä½äº 200 å­—ï¼Œé‚£ä¹ˆèƒ½å¤Ÿæ­£ç¡®éªŒè¯ LLM ç”Ÿæˆçš„æ³¨é‡Šæ˜¯å¦å°‘äº 200 å­—çš„æ–­è¨€å°±ä¼šè¢«æ”¾å¼ƒã€‚ä¸ºäº†æ‰©å¤§è¦†ç›–èŒƒå›´ï¼Œå¯ä»¥ä½¿ç”¨ä¸»åŠ¨å­¦ä¹ å’Œå¼±ç›‘ç£æ–¹æ³•ä¸ºæ¯ä¸ªå€™é€‰æ–­è¨€é‡‡æ ·å’Œæ ‡æ³¨æ–°çš„ LLM æç¤º-å“åº”å¯¹ï¼Œä½†è¿™å¯èƒ½å¾ˆæ˜‚è´µï¼Œæˆ–è€…éç¨‹åºå‘˜æ— æ³•ä½¿ç”¨ã€‚æˆ‘ä»¬å¼•å…¥äº†æ–­è¨€å­å—ï¼ˆassertion subsump-tionï¼‰ä½œä¸ºç¡®ä¿å…¨é¢è¦†ç›–çš„ä¸€ç§æ–¹æ³•ï¼šå¦‚æœä¸€ä¸ªæ–­è¨€ä¸åŒ…å«å¦ä¸€ä¸ªæ–­è¨€çš„æ•…éšœæ¨¡å¼ï¼Œé‚£ä¹ˆä¸¤ä¸ªæ–­è¨€éƒ½ä¼šè¢«é€‰ä¸­ã€‚å› æ­¤ï¼ŒSPADE ä¼šé€‰æ‹©ä¸€ç»„æœ€å°çš„æ–­è¨€ï¼Œå¹¶éµå®ˆæ•…éšœè¦†ç›–ç‡ã€å‡†ç¡®æ€§å’Œå­é›†çº¦æŸã€‚æ€»çš„æ¥è¯´ï¼Œæˆ‘ä»¬åšå‡ºäº†ä»¥ä¸‹è´¡çŒ®ï¼š Todayâ€™s research release of ChatGPT is the latest step in OpenAIâ€™s iterative deployment of increasingly safe and useful AI systems. Many lessons from deployment of earlier models like GPT-3 and Codex have informed the safety mitigations in place for this release, including substantial reductions in harmful and untruthful outputs achieved by the use of reinforcement learning from human feedback (RLHF). https://openai.com/blog/chatgpt?ref=blog.cg-wire.com OpenAI ç”¨ RL å’Œäººå·¥ç›‘ç£ï¼Œæ¥è§„é¿ä¸€äº›å®‰å…¨é—®é¢˜å’Œå‡å°‘ä¸çœŸå®è¾“å‡º Prompt Deltas for Candidate Assertion Generationï¼šæˆ‘ä»¬å‘ç° prompt version history æ˜¯æ•°æ®ç”Ÿæˆ LLM pipeline æ­£ç¡®æ€§æ ‡å‡†çš„ä¸°å¯Œæ¥æºã€‚æˆ‘ä»¬æ ¹æ® 19 ä¸ªå…·æœ‰ç‰ˆæœ¬å†å²çš„ LLM pipeline çš„æ¨æ–­å‡ºäº†æ–­è¨€æ ‡å‡†åˆ†ç±»æ³•ï¼Œå¹¶å°†å…¶å…¬å¸ƒäºä¼—ã€‚æˆ‘ä»¬å…¬å¼€å‘å¸ƒäº†ä¸€æ¬¾å·¥å…·ï¼Œç”¨äºä¸ºä»»ä½• pipeline ç”Ÿæˆå€™é€‰æ–­è¨€ï¼Œé€šè¿‡ 1300 å¤šæ¬¡éƒ¨ç½²ä¸ºè‡ªåŠ¨ç”Ÿæˆæ–­è¨€çš„å®ç”¨æ€§æä¾›äº†æ—©æœŸè¯æ®ï¼ŒåŒæ—¶ä¹Ÿä¸ºç­›é€‰è¿™äº›æ–­è¨€æä¾›äº†æœºä¼šã€‚ Filtering Method that Requires Little Data: æˆ‘ä»¬è¯æ˜ï¼Œåœ¨è¦†ç›–æ•…éšœæ¨¡å¼å’Œæ»¡è¶³å‡†ç¡®æ€§è¦æ±‚çš„å‰æä¸‹ï¼Œé€‰æ‹©æœ€å°çš„æ–­è¨€é›†æ˜¯ä¸€ä¸ª NP-Hardã€‚æˆ‘ä»¬å°†è¿™ä¸€é—®é¢˜è¡¨è¿°ä¸º ILPã€‚é‰´äºæ–­è¨€å¯èƒ½æ˜¯å†—ä½™å’Œä¸å‡†ç¡®çš„ï¼Œè€Œä¸” LLM å¼€å‘äººå‘˜å¯èƒ½ä¸å…·å¤‡å·¥ç¨‹ä¸“ä¸šçŸ¥è¯†æˆ–è¶³å¤Ÿçš„æ•°æ®æ¥ä½¿ç”¨ç°æœ‰çš„æ•°æ®é©±åŠ¨æ–¹æ³•è¿›è¡Œ ML pipeline æµ‹è¯•ï¼ˆå¦‚è®­ç»ƒæ¨¡å‹ï¼‰ï¼Œæˆ‘ä»¬å¼•å…¥äº†æ–­è¨€å½’å¹¶ä½œä¸ºåœ¨ä½æ•°æ®é‡ç¯å¢ƒä¸‹è¦†ç›–ç‡çš„æ–°å‹æ›¿ä»£æ–¹æ³•ã€‚ Empirical Study: æˆ‘ä»¬ä»‹ç»äº† spadeï¼Œè¿™æ˜¯æˆ‘ä»¬ä¸ºæ•°æ®ç”Ÿæˆ LLM pipeline è‡ªåŠ¨ç”Ÿæˆæ–­è¨€çš„ç³»ç»Ÿã€‚å¯¹äºä¹ä¸ªå…·æœ‰æç¤ºç‰ˆæœ¬å†å²çš„ LLM pipeline ï¼Œæˆ‘ä»¬æ”¶é›†äº†å¸¦æ ‡ç­¾çš„ prompt-response pairsï¼ˆå…¶ä¸­å…«ä¸ªå·²å¼€æºï¼‰ã€‚ https://spade-beta.streamlit.app/ åœ¨æ‰€æœ‰ pipelines ä¸­ï¼ŒSpade ç”Ÿæˆçš„æ–­è¨€éƒ½å…·æœ‰ good failure coverage å’Œ few false failuresï¼ˆå³æ— æ³•åšå‡ºè‰¯å¥½å“åº”ï¼‰ã€‚æˆ‘ä»¬åŸºäºå­å‡è®¾çš„ ILP ä¼˜äºä¸è€ƒè™‘æ–­è¨€é—´äº¤äº’çš„ç®€å•åŸºçº¿ï¼Œå‡å°‘äº† 14% çš„æ–­è¨€ï¼Œé™ä½äº† 21% çš„é”™è¯¯å¤±è´¥ç‡ã€‚ ","date":"2024-03-01","objectID":"/posts/spade-paper/:3:0","tags":["Paper Reading"],"title":"Paper Reading: Spade Synthesizing Assertions for Large Language Model Pipelines","uri":"/posts/spade-paper/"},{"categories":null,"content":"IDENTIFYING CANDIDATE ASSERTIONS æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªç›®æ ‡æ˜¯ç”Ÿæˆä¸€ç»„ candidate assertionsã€‚æˆ‘ä»¬å°†ä»‹ç» prompt deltas å¦‚ä½•ä¸ºå€™é€‰æ–­è¨€æä¾›ä¿¡æ¯ï¼Œå¹¶è§£é‡Šå¦‚ä½•ä»ä¸­å¾—å‡ºå€™é€‰æ–­è¨€ã€‚ ","date":"2024-03-01","objectID":"/posts/spade-paper/:4:0","tags":["Paper Reading"],"title":"Paper Reading: Spade Synthesizing Assertions for Large Language Model Pipelines","uri":"/posts/spade-paper/"},{"categories":null,"content":"Prompt Deltas å•æ­¥ LLM æµæ°´çº¿ç”±ä¸€ä¸ªæç¤ºæ¨¡æ¿ P ç»„æˆï¼Œè¯¥æ¨¡æ¿é€šè¿‡å¯¹è¾“å…¥å…ƒç»„ ğ‘¡ è¿›è¡Œæ ¼å¼åŒ–ï¼Œç”Ÿæˆä¸€ä¸ªæç¤º ğ‘ï¼Œå¹¶è¿”å›ä¸€ä¸ªå“åº” ğ‘Ÿã€‚P å¯ä»¥æœ‰å¾ˆå¤šç‰ˆæœ¬ï¼Œè¿™å–å†³äºå¼€å‘è€…å¦‚ä½•è¿­ä»£ä»–ä»¬çš„ prompt templateã€‚è®© $P_0$ è¡¨ç¤ºç©ºå­—ç¬¦ä¸²ï¼Œå³ç¬¬ 0 ä¸ªç‰ˆæœ¬ï¼Œè®© $P_i$ è¡¨ç¤ºæ¨¡æ¿çš„ç¬¬ i ä¸ªç‰ˆæœ¬ã€‚åœ¨ç¬¬ 1 èŠ‚çš„ç”µå½±æ¨èç¤ºä¾‹ä¸­ï¼Œå‡è®¾æœ‰ 7 ä¸ªç‰ˆæœ¬ï¼Œå…¶ä¸­ P7 å¦‚ä¸‹ï¼š Write a personalized note for why a user should watch {movie_name} given the following informa- tion about the user: {personal_info}. Ensure the recommendation note is concise, not exceeding 100 words. Mention the movieâ€™s genre and any shared cast members between the {movie_name} and other movies the user has watched. Mention any awards or critical acclaim received by {movie_name}. Do not mention anything related to the userâ€™s race, ethnicity, or any other sensitive attributes æˆ‘ä»¬å°† prompt delta $Î”P_{ğ‘–+1}$ å®šä¹‰ä¸º $P_i$ ä¸ $P_{i+1}$ ä¹‹é—´çš„å·®å€¼ã€‚å…·ä½“æ¥è¯´ï¼Œæç¤º Î”P æ˜¯ä¸€ç»„å¥å­ï¼Œå…¶ä¸­æ¯ä¸ªå¥å­éƒ½æ ‡è®°ä¸ºæ·»åŠ ï¼ˆå³ â€œ+\"ï¼‰æˆ–åˆ é™¤ï¼ˆå³â€-\"ï¼‰ã€‚ä¾‹å¦‚ï¼Œè¡¨ 1 æ˜¾ç¤ºäº†å¤šä¸ªç‰ˆæœ¬çš„ Î”Psã€‚Î”Pğ‘– ä¸­çš„æ¯ä¸ªå¥å­éƒ½ç”±æ·»åŠ ï¼ˆå³ Pğ‘– ä¸­çš„æ–°å¥å­ï¼ŒPğ‘–-1 ä¸­ä¸å­˜åœ¨ï¼‰å’Œåˆ é™¤ï¼ˆå³ Pğ‘–-1 ä¸­çš„å¥å­ï¼ŒPğ‘– ä¸­ä¸å­˜åœ¨ï¼‰ç»„æˆã€‚å¯¹å¥å­çš„ä¿®æ”¹ç”±åˆ é™¤å’Œæ·»åŠ è¡¨ç¤ºâ€“ä¾‹å¦‚ï¼Œè¡¨ 1 ä¸­çš„ Î”P6 åŒ…å«äº†ä» P5 ä¸­æ·»åŠ åˆ°å¥å­ä¸­çš„ä¸€äº›æ–°æŒ‡ä»¤ã€‚å¦‚è¡¨ 1 æœ€å³è¾¹ä¸€æ æ‰€ç¤ºï¼ŒÎ”Pğ‘– ä¸­çš„æ¯ä¸€ä¸ªæ·»åŠ éƒ½è¡¨ç¤ºå¯èƒ½çš„æ–­è¨€æ ‡å‡†ã€‚ ","date":"2024-03-01","objectID":"/posts/spade-paper/:4:1","tags":["Paper Reading"],"title":"Paper Reading: Spade Synthesizing Assertions for Large Language Model Pipelines","uri":"/posts/spade-paper/"},{"categories":null,"content":"Prompt Delta Analysis æˆ‘ä»¬åˆ†æäº†ä» LangChain ç”¨æˆ·é‚£é‡Œæ”¶é›†åˆ°çš„ 19 ä¸ª LLM pipelineï¼Œæ¯ä¸ª pipeline ç”± 3 åˆ° 11 ä¸ªå†å²æç¤ºæ¨¡æ¿ç‰ˆæœ¬ç»„æˆã€‚è¿™äº› pipeline æ¶µç›–å„ç§ä»»åŠ¡ï¼Œä»ç”Ÿæˆå·¥ä½œæ€»ç»“åˆ°è‡ªå®šä¹‰é—®ç­”èŠå¤©æœºå™¨äººã€‚é™„å½• B ä¸­çš„è¡¨ 6 æ˜¾ç¤ºäº†è¿™äº› pipeline çš„æ‘˜è¦ï¼ŒåŒ…æ‹¬æ¯ä¸ª pipeline çš„æè¿°å’Œæç¤ºç‰ˆæœ¬çš„æ•°é‡ã€‚å¯¹äºæ¯ä¸ª pipeline ï¼Œæˆ‘ä»¬å°†æç¤ºç¬¦ï¼ˆå³ Î”Pğ‘–ï¼‰åˆ†ä¸ºä¸åŒç±»å‹â€“ä¾‹å¦‚ï¼ŒæŒ‡ç¤º LLM åœ¨æ¯ä¸ªå›å¤ä¸­åŒ…å«ä¸€ä¸ªæ–°çŸ­è¯­ï¼ˆå³åŒ…å«ï¼‰ï¼Œæˆ–æŒ‡ç¤º LLM ä»¥æŸç§è¯­æ°”å›å¤ï¼ˆå³å®šæ€§æ ‡å‡†ï¼‰ã€‚æˆ‘ä»¬å¯¹åˆ†ç±»è¿›è¡Œäº† 4 æ¬¡åå¤ä¿®æ”¹ï¼Œæœ€ç»ˆå½¢æˆäº†å›¾ 2 ä¸­çš„åˆ†ç±»æ³•ã€‚æç¤ºç‰ˆæœ¬çš„åˆ†ç±»æ³¨é‡Šæ•°æ®é›†å¯åœ¨ç½‘ä¸Šæ‰¾åˆ° 3ã€‚å¤§å¤šæ•°æç¤ºç¬¦éƒ½å±äºæ•°æ®æ•´åˆï¼ˆå³æ·»åŠ å ä½å˜é‡ï¼‰å’Œå·¥ä½œæµç¨‹æè¿°ï¼ˆå³æ·»åŠ æŒ‡ç¤ºè®© LLM æ›´å‡†ç¡®åœ°æ‰§è¡Œä»»åŠ¡ï¼‰ã€‚åœ¨è¡¨ 2 ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨å¼•è¨€ä¸­çš„ç”µå½±æ¨è pipeline ç¤ºä¾‹ï¼Œå±•ç¤ºäº†åˆ†ç±»æ³•ä¸­æ¯ä¸ªç±»åˆ«çš„æç¤ºåˆ†éš”ç¬¦ç¤ºä¾‹ å½“ä»è‡ªåŠ¨è¯†åˆ«çš„æç¤ºåˆ†éš”çº¿ä¸­å¾—å‡ºæ–­è¨€å€™é€‰é¡¹æ—¶ï¼Œæ–­è¨€è´¨é‡æ˜¾ç„¶å–å†³äºè¯†åˆ«ç±»åˆ«çš„å‡†ç¡®æ€§ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ç¡®è®¤äº† GPT-4 å¯¹æç¤ºåˆ†ç•Œç‚¹çš„æ­£ç¡®åˆ†ç±»ï¼ˆæˆªè‡³ 2023 å¹´ 10 æœˆï¼‰ã€‚æˆ‘ä»¬ä¸º 19 ä¸ª pipeline çš„æ‰€æœ‰æç¤ºç‰ˆæœ¬åˆ†é…äº†åŸºæœ¬çœŸå®ç±»åˆ«ï¼ŒGPT-4 çš„ F1 å¾—åˆ†ä¸º 0.8135ã€‚ç”¨äºä»æç¤ºåˆ†æ®µä¸­æå–ç±»åˆ«çš„æç¤ºè¯¦è§é™„å½• C ä»€ä¹ˆæ˜¯ F1 scoreï¼Ÿ åœ¨äºŒè¿›åˆ¶åˆ†ç±»å’Œä¿¡æ¯æ£€ç´¢ç³»ç»Ÿçš„ç»Ÿè®¡åˆ†æä¸­ï¼ŒF-SCORE æˆ– F-MEASIE æ˜¯å¯¹é¢„æµ‹æ€§èƒ½çš„é‡åº¦ã€‚ ","date":"2024-03-01","objectID":"/posts/spade-paper/:4:2","tags":["Paper Reading"],"title":"Paper Reading: Spade Synthesizing Assertions for Large Language Model Pipelines","uri":"/posts/spade-paper/"},{"categories":null,"content":"From Taxonomy to Assertions åˆ©ç”¨æˆ‘ä»¬çš„åˆ†ç±»æ³•ï¼ŒSPADE ä½¿ç”¨ LLM ä¸º prompt deltas åˆ†ç±»å¹¶ç”Ÿæˆæ–­è¨€ï¼Œè¯¦è§é™„å½• Cã€‚å¯¹äºæ¯ä¸ª Î”Pğ‘– ï¼ŒSPADE éƒ½ä¼šæç¤º LLM ä¸ºæ–­è¨€æå‡ºå°½å¯èƒ½å¤šçš„æ ‡å‡†ï¼Œæ¯ä¸ªæ ‡å‡†éƒ½ä¸åˆ†ç±»æ ‡å‡†çš„ç±»åˆ«ä¸€è‡´ (e.g., Figure 3) æ ‡å‡† Criterion è¢«å®½æ³›åœ°å®šä¹‰ä¸ºå¯¹ç¤ºä¾‹è¿›è¡Œæ“ä½œå¹¶è¯„ä¼°ä¸º â€œçœŸ â€œæˆ– â€œå‡ â€œçš„ä¸€äº›è‡ªç„¶è¯­è¨€è¡¨è¾¾å¼ï¼ˆä¾‹å¦‚ï¼Œâ€œcheck for concisenessâ€ï¼‰ã€‚Spade ä¼šåˆ†ææ¯ä¸ª Î”Pğ‘– è€Œä¸æ˜¯åªåˆ†ææœ€åä¸€ä¸ªæç¤ºç‰ˆæœ¬ï¼ŒåŸå› æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼šå¼€å‘äººå‘˜é€šå¸¸ä¼šåˆ é™¤æç¤ºä¸­çš„æŒ‡ä»¤ä»¥é™ä½æˆæœ¬ï¼ŒåŒæ—¶æœŸæœ›è·å¾—ç›¸åŒçš„è¡Œä¸º[35]ï¼›æç¤ºåŒ…å«å›ºæœ‰çš„æ­§ä¹‰ï¼Œå¹¶æš—ç¤ºäº†è¯„ä¼°æŸäº›æ ‡å‡†çš„å¤šç§æ–¹æ³•ï¼›å¦‚æœåªåˆ†æä¸€ä¸ªç‰ˆæœ¬ï¼Œå¤æ‚çš„æç¤ºå¯èƒ½ä¼šå¯¼è‡´é—æ¼æ–­è¨€ã€‚å› æ­¤ï¼Œåˆ†ææ¯ä¸ª Î”Pğ‘– ä¼šå¢åŠ ç”Ÿæˆç›¸å…³æ–­è¨€çš„å¯èƒ½æ€§ å¯¹äºæ¯ä¸ª deltaï¼Œspade éƒ½ä¼šæ”¶é›†å·²è¯†åˆ«çš„æ ‡å‡†ï¼Œå¹¶å†æ¬¡æç¤º LLM åˆ›å»º Python æ–­è¨€å‡½æ•°ã€‚åˆæˆå‡½æ•°å¯ä»¥ä½¿ç”¨å¤–éƒ¨ Python åº“ï¼Œä¹Ÿå¯ä»¥é’ˆå¯¹å¤æ‚çš„æ ‡å‡†å‘ LLM æå‡ºäºŒè¿›åˆ¶æŸ¥è¯¢ã€‚åœ¨å‡½æ•°åˆæˆæ—¶ï¼ŒLLM ä¼šè¢«æŒ‡ç¤ºï¼Œå¦‚æœæ ‡å‡†æŒ‡å®šå¾—å¾ˆæ¨¡ç³Šæˆ–å¯ä»¥è§£é‡Šï¼Œä¾‹å¦‚ â€œcheck for concisenessâ€ï¼Œå®ƒå°±å¯ä»¥ç”Ÿæˆå¤šä¸ªå‡½æ•°ï¼Œæ¯ä¸ªå‡½æ•°éƒ½å¯¹æ ‡å‡†è¿›è¡Œè¯„ä¼°ã€‚åœ¨è¿™ä¸ªç®€æ´æ€§ç¤ºä¾‹ä¸­ï¼ŒLLM å¯ä»¥è¿”å›å¤šä¸ªå‡½æ•°â€“ä¸€ä¸ªå°†å›å¤åˆ†æˆå¥å­å¹¶ç¡®ä¿ä¸è¶…è¿‡ï¼ˆä¾‹å¦‚ï¼‰3 ä¸ªå¥å­çš„å‡½æ•°ï¼Œä¸€ä¸ªå°†å›å¤åˆ†æˆå•è¯å¹¶ç¡®ä¿ä¸è¶…è¿‡ï¼ˆä¾‹å¦‚ï¼‰25 ä¸ªå•è¯çš„å‡½æ•°ï¼Œæˆ–è€…ä¸€ä¸ªå°†å›å¤å‘é€ç»™ LLM å¹¶è¯¢é—®å›å¤æ˜¯å¦ç®€æ´çš„å‡½æ•°ã€‚è¿™ä¸€æ­¥éª¤çš„æ€»ä½“ç»“æœæ˜¯å€™é€‰å‡½æ•°çš„å¤šé›†åˆ ğ¹ = {ğ‘“1, â€¦, ğ‘“ğ‘š} ã€‚ æˆ‘ä»¬çš„æ–¹æ³•é‡‡ç”¨äº†ä¸¤æ­¥æµç¨‹ï¼Œå› ä¸ºäº‹å®è¯æ˜ï¼Œå°†ä»»åŠ¡åˆ†è§£ä¸ºå¤šä¸ªæ­¥éª¤å¯ä»¥æé«˜ LLM çš„å‡†ç¡®æ€§ [21, 53, 55]ã€‚ä¸è¿‡ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œéšç€ LLM æ—¥æ–°æœˆå¼‚çš„å‘å±•ï¼Œä¸€æ­¥å¼æµç¨‹å¯èƒ½å·²ç»å¯è¡Œã€‚æ­¤å¤–ï¼Œè™½ç„¶æˆ‘ä»¬çš„åˆ†ç±»æ³•ç°åœ¨å¯ä»¥æŒ‡å¯¼ LLM ç”Ÿæˆæ–­è¨€ï¼Œä½†æœªæ¥çš„ LLM å¯èƒ½ä¼šé€šè¿‡äººç±»åé¦ˆçš„å¼ºåŒ–å­¦ä¹ æ¥éšå¼åœ°å­¦ä¹ è¿™äº›ç±»åˆ«[12]ã€‚ä¸è¿‡ï¼Œäº†è§£ä¸å€™é€‰æ–­è¨€ç›¸å…³çš„åŸºäºåˆ†ç±»å­¦çš„ç±»åˆ«å¯èƒ½æœ‰åŠ©äºè¿‡æ»¤å®ƒä»¬ Designing LLM Chains by Adapting Techniques from Crowdsourcing Workflows. arXiv preprint arXiv:2312.11681 (2023) Chain-of-thought prompting elicits reasoning in large language models. Advances in Neural Information Processing Systems ä»»åŠ¡åˆ†è§£ä¸ºä»€ä¹ˆå¯ä»¥æé«˜ LLM çš„å‡†ç¡®æ€§ï¼Ÿè€Œä¸”ç°åœ¨ ChatGPT å°±æ˜¯ç”¨çš„ Human Feedback RL æ¥å¢å¼ºçš„ Deep reinforcement learning from human preferences ","date":"2024-03-01","objectID":"/posts/spade-paper/:4:3","tags":["Paper Reading"],"title":"Paper Reading: Spade Synthesizing Assertions for Large Language Model Pipelines","uri":"/posts/spade-paper/"},{"categories":null,"content":"LangChain Deployment æ¯”è¾ƒäº†æ—©æœŸç‰ˆæœ¬å’ŒåæœŸçš„åŒºåˆ«ï¼Œå¹äº†ä¸€ä¸‹è‡ªå·±ç”Ÿæˆçš„æ–­è¨€æœ‰å¤šä¹ˆå¥½ï¼Œæ¶µç›–äº†å¤šå°‘ä¸ªé¢†åŸŸï¼Œè¾¾åˆ°äº† â€œperfectâ€ æåˆ°äº†ä¸€ä¸ªæ€»ç»“æ–‡ç« çš„ä¾‹å­ï¼Œå…·æœ‰ 14 ä¸ª prompt ç‰ˆæœ¬ï¼Œå¯¹ä»– SPADE åï¼Œå¯ä»¥æœ‰ä¸€äº›æ–­è¨€ï¼Œå¿…é¡»è¦æœ‰ä¸€äº›å…³é”®è¯ç­‰ç­‰ ä½†è¿™äº›æ–­è¨€å¹¶ä¸æ˜¯æ­£åˆ™åŒ¹é…ï¼Œè€Œæ˜¯å­—ç¬¦ä¸²åŒ¹é…ï¼Œæˆ‘è§‰å¾—ä¸å¤ªåˆç†ã€‚ æ–‡ä¸­ä¹Ÿæåˆ°è¯´è®¸å¤šæ–­è¨€å¯èƒ½æ˜¯ä¸æ­£ç¡®çš„ï¼Œæ€ä¹ˆçŸ¥é“æ–­è¨€æ˜¯æ­£ç¡®çš„å‘¢ï¼Ÿæœ¬æ–‡çš„å®éªŒå¯èƒ½ä¹Ÿä¸å¤Ÿï¼Œäºæ˜¯é‡‡ç”¨äº†è‡ªåŠ¨åŒ– filtering ","date":"2024-03-01","objectID":"/posts/spade-paper/:4:4","tags":["Paper Reading"],"title":"Paper Reading: Spade Synthesizing Assertions for Large Language Model Pipelines","uri":"/posts/spade-paper/"},{"categories":null,"content":"FILTERING CANDIDATE ASSERTIONS åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬è§£å†³äº†ç¬¬ 2.4 èŠ‚ä¸­ç¡®å®šçš„å†—ä½™å’Œä¸æ­£ç¡®æ–­è¨€çš„é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯åœ¨å…·æœ‰å¤§é‡ prompt ç‰ˆæœ¬çš„ pipeline ä¸­ã€‚ è¿‡æ»¤æ­¤å€™é€‰é›†ä¸ä»…å¯ä»¥æé«˜éƒ¨ç½²æ–­è¨€ä»¥åœ¨ç”Ÿäº§ä¸­è¿è¡Œæ—¶çš„æ•ˆç‡ï¼Œè€Œä¸”è¿˜å¯ä»¥å‡å°‘å¼€å‘äººå‘˜çš„è®¤çŸ¥å¼€é”€ ","date":"2024-03-01","objectID":"/posts/spade-paper/:5:0","tags":["Paper Reading"],"title":"Paper Reading: Spade Synthesizing Assertions for Large Language Model Pipelines","uri":"/posts/spade-paper/"},{"categories":null,"content":"Definitions å°† ğ‘’ğ‘– è§†ä¸º LLM pipeline åœ¨æŸäº›è¾“å…¥ä¸Šçš„ç«¯åˆ°ç«¯æ‰§è¡Œï¼ˆå³è¿è¡Œï¼‰çš„ç¤ºä¾‹ã€‚ ä»¤ ğ¸ ä¸ºæ‰€æœ‰æ­¤ç±»ç¤ºä¾‹è¿è¡Œçš„é›†åˆï¼ˆè¯¥é›†åˆæœªé¢„å…ˆæä¾›ï¼Œæˆ‘ä»¬å°†å¾ˆå¿«å¤„ç†ï¼‰ã€‚ æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ–­è¨€å‡½æ•° ğ‘“ : ğ¸ â†’ {0,1}ï¼Œå…¶ä¸­ 1 è¡¨ç¤ºæˆåŠŸï¼Œ0 è¡¨ç¤ºå¤±è´¥ã€‚ ä»¤ ğ¹â€² ={ğ‘“1, ğ‘“2, . ã€‚ ., ğ‘“ğ‘˜} æ˜¯ä¸€ç»„ ğ‘˜ æ–­è¨€ã€‚ å½“ä¸”ä»…å½“ä¸€ä¸ªä¾‹å­ ğ‘’ğ‘– æ»¡è¶³ ğ¹â€™ ä¸­çš„æ‰€æœ‰æ–­è¨€æ—¶ï¼Œè¯¥é›†åˆæ‰è®¤ä¸ºå®ƒæ˜¯æˆåŠŸçš„ã€‚ å…·ä½“æ¥è¯´ ä¸€äº›æ•°å­¦å®šä¹‰ï¼Œå®šä¹‰äº† Coverage å’Œ False Failure Rate ","date":"2024-03-01","objectID":"/posts/spade-paper/:5:1","tags":["Paper Reading"],"title":"Paper Reading: Spade Synthesizing Assertions for Large Language Model Pipelines","uri":"/posts/spade-paper/"},{"categories":null,"content":"Coverage Problem Formulation ç›®æ ‡æ˜¯æ‰¾åˆ°æœ€å°çš„é›†åˆ minimal set of assertions æ»¡è¶³æ‰€æœ‰ä¾‹å­ï¼Ÿ æ‰¾åˆ°ä¸€ä¸ª Coverage(ğ¹â€²) â‰¥ğ›¼, FFR(ğ¹â€²) â‰¤ğœ æ‰¾åˆ°é™åˆ¶ï¼Œå°±å˜æˆäº†ä¸€ä¸ªä¼˜åŒ–é—®é¢˜ï¼Œé›†åˆè¦†ç›–é—®é¢˜ æˆ‘ä»¬å°†æ­¤ ILP çš„è§£å†³æ–¹æ¡ˆç§°ä¸º $spade_{cov}$ã€‚ ç®€å•åœ°è¯´ï¼Œå¯¹äº ğœ =0 å’Œ ğ›¼ =1ï¼Œè¿™ä¸ªé—®é¢˜æ˜¯ NP-hard çš„ï¼Œé€šè¿‡ç®€å•åœ°ä»é›†åˆè¦†ç›–å½’çº¦ï¼Œå¹¶ä¸”æ˜¯ NP é—®é¢˜ï¼Œå› ä¸ºå®ƒå¯ä»¥ç”¨ ILP å½¢å¼è¡¨ç¤º ","date":"2024-03-01","objectID":"/posts/spade-paper/:5:2","tags":["Paper Reading"],"title":"Paper Reading: Spade Synthesizing Assertions for Large Language Model Pipelines","uri":"/posts/spade-paper/"},{"categories":null,"content":"Subsumption Problem Formulation åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å‡è®¾å¼€å‘äººå‘˜æ„¿æ„æä¾›ä¸€ç»„å…¨é¢çš„æ ‡è®°ç¤ºä¾‹è¿è¡Œ ğ¸â€²ï¼Œåœ¨å¼€å‘äººå‘˜ä¸æ„¿æ„è¿™æ ·åšçš„è®¾ç½®ä¸­ï¼Œå¹¶ä¸” ğ¸â€²ä¸åŒ…æ‹¬ ğ¸ ä¸­çš„æ‰€æœ‰æ•…éšœç±»å‹ï¼Œspade_cov å¯èƒ½ä¼š å¿½ç•¥ ğ¹ ä¸­çš„æœ‰ç”¨æ–­è¨€ï¼Œè¿™äº›æ–­è¨€åªèƒ½æ•è· ğ¸ \\ğ¸â€² ä¸­çš„å¤±è´¥â€”â€”å¦‚ç¬¬ 4 èŠ‚ä¸­çš„ç»éªŒæ‰€ç¤ºã€‚æˆ‘ä»¬æœ€åˆè€ƒè™‘ä½¿ç”¨ä¸»åŠ¨å­¦ä¹  [6] ä¸ºæ¯ä¸ªæ–­è¨€é‡‡æ ·æ›´å¤šçš„ LLM å“åº”ï¼Œå¹¶ä½¿ç”¨å¼±ç›‘ç£æ¥æ ‡è®°å“åº” [36 ]ã€‚ ç„¶è€Œï¼Œè¿™ç§æ–¹æ³•å¯¹äºæœ€å…ˆè¿›çš„ LLM æ¥è¯´æˆæœ¬é«˜æ˜‚ï¼Œå¹¶ä¸”éœ€è¦å¤§é‡çš„æ‰‹åŠ¨å·¥ä½œæ¥å¹³è¡¡æ¯ä¸ªæ–­è¨€çš„å¤±è´¥å’ŒæˆåŠŸç¤ºä¾‹ï¼Œç¡®ä¿æœ‰æ„ä¹‰çš„ FFR å¹¶é¿å…ç”±äºä»£è¡¨æ€§ä¸è¶³çš„æ•…éšœç±»å‹è€Œæ’é™¤æ–­è¨€ã€‚ å¯¹äºè¿™ç§è®¾ç½®ï¼Œæˆ‘ä»¬è¿˜å¼•å…¥äº†åŒ…å«ã€‚ å‡è®¾æ‰€æœ‰å€™é€‰æ–­è¨€å‡½æ•°æ¶µç›–å°½å¯èƒ½å¤šçš„æ•…éšœæ¨¡å¼ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯é€‰æ‹© ğ¹â€² âŠ† ğ¹ï¼Œä½¿å¾— ğ¹ \\ğ¹â€² ä¸­çš„æ–­è¨€åŒ…å«åœ¨ ğ¹â€² ä¸­ã€‚ å½¢å¼ä¸Šï¼Œå¦‚æœ ğ‘† ä¸­å‡½æ•°çš„åˆå–é€»è¾‘ä¸Šæ„å‘³ç€ ğ‘† å’Œ ğ‘“ ä¸­å‡½æ•°çš„åˆå–ï¼Œåˆ™ä¸€ç»„å‡½æ•° ğ‘† åŒ…å«æŸä¸ªå‡½æ•° ğ‘“ ã€‚ å¤ªå¤šå®šä¹‰äº†ï¼Œå¯èƒ½ä¸»è¦æ˜¯åœ¨è§£å†³è¿™ä¸ªé›†åˆè¦†ç›–å§ ","date":"2024-03-01","objectID":"/posts/spade-paper/:5:3","tags":["Paper Reading"],"title":"Paper Reading: Spade Synthesizing Assertions for Large Language Model Pipelines","uri":"/posts/spade-paper/"},{"categories":null,"content":"EVALUATION æˆ‘ä»¬é¦–å…ˆè®¨è®º LLM pipelines å’Œæ•°æ®é›†ï¼ˆå³ ğ¸â€²ï¼‰ï¼› ç„¶åï¼Œæˆ‘ä»¬è®¨è®ºæ–¹æ³•å’ŒæŒ‡æ ‡å¹¶å±•ç¤ºæˆ‘ä»¬çš„ç»“æœã€‚ å®éªŒä»£ç ã€æ•°æ®é›†å’Œ LLM å“åº”æ‰˜ç®¡åœ¨ GitHub ä¸Š ","date":"2024-03-01","objectID":"/posts/spade-paper/:6:0","tags":["Paper Reading"],"title":"Paper Reading: Spade Synthesizing Assertions for Large Language Model Pipelines","uri":"/posts/spade-paper/"},{"categories":null,"content":"Pipeline and Dataset Descriptions æˆ‘ä»¬å¯¹ 9 ä¸ª LLM pipeline è¿›è¡Œäº†è¯„ä¼°ï¼Œå…¶ä¸­ 8 ä¸ªæ¥è‡ª LangChain Hubï¼ˆLLM pipeline çš„å¼€æºé›†åˆï¼‰ï¼Œä»¥åŠ 1 ä¸ªä¸“æœ‰ pipeline ã€‚ å…­ä¸ª LangChain Hub pipeline å¸®åŠ©å¼€å‘äº† prompt delta taxonomyï¼ˆç¬¬ 2.2 èŠ‚ï¼‰ï¼Œä½†åœ¨åˆ›å»ºåˆ†ç±»æ³•åï¼Œä» spade çš„ Streamlit éƒ¨ç½²ï¼ˆç¬¬ 2.4 èŠ‚ï¼‰æ·»åŠ äº†ä¸¤æ¡ pipeline ã€‚ ä¸“æœ‰ pipeline æ˜¯ fashion pipelineï¼Œå®ƒä¸ºæ´»åŠ¨æä¾›æœè£…å»ºè®®ã€‚ ä¹‹æ‰€ä»¥åŒ…å«æ­¤ pipeline ï¼Œæ˜¯å› ä¸ºå®ƒä½¿ç”¨äº† LLM åŸ¹è®­ä¸­æœªåŒ…å«çš„æ•°æ®åŠå…¶å®é™…éƒ¨ç½²ï¼Œå±•ç¤ºäº† Spade çš„ real-world æ€§ã€‚ è™½ç„¶æˆ‘ä»¬ä½¿ç”¨çœŸå®çš„ç”¨æˆ·æç¤ºæ¨¡æ¿å’Œå†å²è®°å½•ï¼ˆ3 åˆ° 16 ä¸ªæç¤ºç‰ˆæœ¬ä¹‹é—´ï¼‰ï¼Œä½†æˆ‘ä»¬æ„å»ºäº†è‡ªå·±çš„ä¸€ç»„ç¤ºä¾‹æç¤º-å“åº”å¯¹å’Œæ ‡ç­¾ (ğ¸â€²) è¿›è¡Œæµ‹è¯•ã€‚ LangChain Hub pipeline çš„ä¸¤ä¸ªæ•°æ®é›†æ¥è‡ª Kaggleï¼Œè€Œå…¶ä»–æ•°æ®é›†æ˜¯ä½¿ç”¨ Chat GPT Proï¼ˆåŸºäº GPT-4ï¼‰ç»¼åˆç”Ÿæˆçš„ã€‚ ä¾‹å¦‚ï¼Œå¯¹äºä½¿ç”¨ LLM å®¡æŸ¥æ‹‰å–è¯·æ±‚çš„ codereviews pipeline ï¼Œæˆ‘ä»¬è¦æ±‚ Chat GPT ç”Ÿæˆæ¶µç›–å„ç§ç¼–ç¨‹è¯­è¨€ã€åº”ç”¨ç¨‹åºç±»å‹å’Œå·®å¼‚å¤§å°çš„å ä½ç¬¦å€¼ã€‚ æˆ‘ä»¬å¯¹ 8 ä¸ª LangChain pipeline çš„ LLM å›å¤è¿›è¡Œäº†æ ‡è®°ï¼Œä»¥è¯„ä¼°ä»–ä»¬æ˜¯å¦ç¬¦åˆæç¤ºè¯´æ˜ã€‚ å“åº”åˆ†ä¸º GPT-3.5-Turbo å’Œ GPT-4ã€‚ å¯¹äº fashion pipeline ï¼Œæ ‡ç­¾æ˜¯ç”±å¼€å‘äººå‘˜åœ¨ç›¸åº”çš„å¯åŠ¨æ—¶å®Œæˆçš„ã€‚ è¡¨ 3 æä¾›äº†æ¯ä¸ª LLM æµç¨‹å’Œæ•°æ®é›†çš„è¯¦ç»†ä¿¡æ¯ã€‚ æˆ‘ä»¬å·²ç»å¼€æºäº† LangChain Hub 8 ä¸ª pipeline çš„æ‰€æœ‰æ•°æ® ","date":"2024-03-01","objectID":"/posts/spade-paper/:6:1","tags":["Paper Reading"],"title":"Paper Reading: Spade Synthesizing Assertions for Large Language Model Pipelines","uri":"/posts/spade-paper/"},{"categories":null,"content":"Method Comparison and Metrics å’Œä¹‹å‰ä¸€æ ·ï¼Œä»¤ ğ¸â€² ä¸ºç¤ºä¾‹æç¤º-å“åº”å¯¹çš„æ•°æ®é›†ï¼Œä»¥åŠå“åº”æ˜¯å¥½ï¼ˆå³ 1ï¼‰è¿˜æ˜¯åï¼ˆå³ 0ï¼‰çš„ç›¸åº”æ ‡ç­¾ã€‚ ä»¤ ğœ ä¸º FFR é˜ˆå€¼ï¼Œğ¹ ä¸º SPADE ç¬¬ä¸€æ­¥äº§ç”Ÿçš„å€™é€‰æ–­è¨€é›†ï¼ˆç¬¬ 2 èŠ‚ï¼‰ã€‚ å¦‚æœå€™é€‰å‡½æ•° ğ‘“ å¯¼è‡´æŸäº›ç¤ºä¾‹ ğ‘’ å‡ºç°è¿è¡Œæ—¶é”™è¯¯ï¼Œæˆ‘ä»¬è¡¨ç¤º ğ‘“ (ğ‘’) =0ï¼ˆå³å¤±è´¥ï¼‰ã€‚ æˆ‘ä»¬æ‰€æœ‰çš„ä»£ç éƒ½æ˜¯ç”¨ Python ç¼–å†™çš„ï¼Œä½¿ç”¨ PuLP Python åŒ…æ¥å¯»æ‰¾ ILP çš„è§£å†³æ–¹æ¡ˆã€‚ æˆ‘ä»¬ä½¿ç”¨é»˜è®¤çš„ PuLP é…ç½®ï¼Œå®ƒä½¿ç”¨ CBC æ±‚è§£å™¨ [18]ã€‚ æˆ‘ä»¬è¯„ä¼°äº† spade çš„ä¸‰ä¸ªç‰ˆæœ¬ï¼š â€¢ $spade_base$ é€‰æ‹© ğ¹ ä¸­çš„æ‰€æœ‰å‡½æ•° ğ‘“ï¼Œå…¶ä¸­ FFR ({ğ‘“ }) â‰¤ğœ â€¢ spade_cov æ˜¯ç¬¬ 3.2 èŠ‚ä¸­å®šä¹‰çš„ ILP çš„è§£ â€¢ spade_sub æ˜¯ç¬¬ 3.3.1 èŠ‚ä¸­å®šä¹‰çš„ ILP çš„è§£ è®© ğ¹â€² ä»£è¡¨ä»»ä½•ç‰ˆæœ¬çš„ spade æ‰€é€‰æ‹©çš„æ–­è¨€é›†åˆã€‚ æˆ‘ä»¬æµ‹é‡å››ä¸ªæŒ‡æ ‡ï¼š (1) æ‰€é€‰æ–­è¨€çš„åˆ†æ•°ï¼ˆå³ |ğ¹â€²|/|ğ¹|ï¼‰ (2) æ’é™¤çš„éåŒ…å«å‡½æ•°çš„åˆ†æ•°ï¼ˆå³ |ğº|/|ğ¹|ï¼Œå…¶ä¸­ ğº ={ğ‘” |ğ‘” Îµğ¹ \\ğ¹â€² å’Œ ğ¹â€² Ì¸=â‡’ ğ‘”}) (3) é”™è¯¯å¤±è´¥ç‡ï¼ˆå®šä¹‰ 3.2ï¼‰ (4) ğ¸â€² çš„è¦†ç›–ç‡ï¼ˆå®šä¹‰ 3.1ï¼‰ æ­¤å¤–ï¼Œspade_sub æˆåŠŸçš„ä¸€ä¸ªé‡è¦æ–¹é¢æ˜¯åŒ…å«çš„æœ‰æ•ˆæ€§ æ‰€æœ‰æ–­è¨€å¯¹ä¹‹é—´çš„è¯„ä¼°ã€‚ ç”±äºæˆ‘ä»¬æ²¡æœ‰åŒ…å«çš„åŸºæœ¬äº‹å®ï¼Œå› æ­¤æˆ‘ä»¬å…³æ³¨ç²¾åº¦ï¼Œè®¡ç®—ä¸ºæ­£ç¡®è¯†åˆ«çš„åŒ…å«å¯¹åœ¨ LLM è¯†åˆ«çš„æ‰€æœ‰åŒ…å«å¯¹ä¸­çš„æ¯”ä¾‹ã€‚ æˆ‘ä»¬ä¸è¯„ä¼°å¬å›ç‡ï¼ˆGPT-4 æ˜¯å¦è¯†åˆ«äº†æ¯ä¸€ä¸ªå¯èƒ½çš„åŒ…å«ï¼‰ï¼Œå› ä¸ºä¸ºæ¯ä¸ªç®¡é“æ ‡è®°å¯èƒ½æ•°ä¸‡ä¸ªæ–­è¨€å¯¹æ˜¯ä¸åˆ‡å®é™…çš„ã€‚ æ­¤å¤–ï¼Œç²¾ç¡®åº¦æ¯”å¬å›ç‡æˆ–å‡†ç¡®æ€§æ›´é‡è¦ï¼Œå› ä¸ºå³ä½¿è¯†åˆ«ä¸€äº›åŒ…å«ï¼Œspade_sub ä¹Ÿèƒ½ç”¨æ¯” $spade_base$ æ›´å°‘çš„é€‰å®šæ–­è¨€æ¥å®ç°è§£å†³æ–¹æ¡ˆã€‚ è¿™é‡Œè¯„ä¼°ç²¾ç¡®ç‡ï¼Œä½†å´å¿½ç•¥å¬å›ç‡ï¼Œæ„Ÿè§‰æ˜¯è®ºæ–‡ä¸å¤Ÿå…¨é¢çš„åœ°æ–¹ã€‚ ç²¾ç¡®ç‡ï¼šTP/ (TP + FP)ï¼Œæˆ‘è§‰å¾—æœ‰æ•…éšœä¸­çš„çœŸæ•…éšœ / ï¼ˆæˆ‘è§‰å¾—æœ‰æ•…éšœä¸”çœŸæ•…éšœ + æˆ‘è§‰å¾—æœ‰æ•…éšœä½†æ²¡æ•…éšœï¼‰ å¬å›ç‡ï¼šTP / (TP + FN), æˆ‘è§‰å¾—æœ‰æ•…éšœä¸­çš„çœŸæ•…éšœ / ï¼ˆæˆ‘è§‰å¾—æœ‰æ•…éšœä¸”çœŸæ•…éšœ + æˆ‘è§‰å¾—æ²¡æ•…éšœä½†çœŸæ•…éšœï¼‰ èƒ½å¦ç†è§£ä¸ºï¼Œç²¾ç¡®ç‡åŒºåˆ†çœŸå‡æ­£ç¡®ï¼Œå¬å›ç‡é’ˆå¯¹æ ·æœ¬ä¸­æœ‰å¤šå°‘æ­£ç¡®çš„æ˜¯ä½ ç»™å‡ºæ¥çš„ã€‚æ‰€ä»¥ä¸€èˆ¬ä¸¤è€…éƒ½è¦ä¸€èµ·è€ƒè™‘ï¼Ÿ ","date":"2024-03-01","objectID":"/posts/spade-paper/:6:2","tags":["Paper Reading"],"title":"Paper Reading: Spade Synthesizing Assertions for Large Language Model Pipelines","uri":"/posts/spade-paper/"},{"categories":null,"content":"Results and Discussion ä½¿ç”¨ GPT-4 è¯„ä¼°æ‰€æœ‰ pipeline çš„å½’å¹¶ç»“æœï¼Œå¹³å‡ç²¾åº¦ä¸º 0.82ï¼Œå¦‚è¡¨ 5 æ‰€ç¤ºï¼Œè¯å®äº†å…¶æœ‰æ•ˆæ€§ã€‚ ä¸ºç®€å•èµ·è§ï¼Œæˆ‘ä»¬å°†æ‰€æœ‰ç®¡é“çš„è¦†ç›–ç‡å’Œ FFR é˜ˆå€¼è®¾ç½®ä¸ºç›¸åŒï¼ˆğ›¼ =0.6ï¼Œğœ =0.25ï¼‰ã€‚ æˆ‘ä»¬åœ¨è¡¨ 4 ä¸­æŠ¥å‘Šäº†ä¸‰ç§æ–¹æ³•çš„ç»“æœã€‚ä¾‹å¦‚ï¼Œè€ƒè™‘ codereviews ç®¡é“ï¼Œå®ƒä½¿ç”¨ LLM æ¥å®¡æŸ¥ä»»ä½•ä»£ç å­˜å‚¨åº“çš„æ‹‰å–è¯·æ±‚ã€‚ è¿™é‡Œï¼Œ $spade_base$ é€‰æ‹© 20 ä¸ªæ–­è¨€ï¼Œ $spade_base$ é€‰æ‹© 2 ä¸ªæ–­è¨€ï¼Œ spade_sub é€‰æ‹© 15 ä¸ªæ–­è¨€ã€‚ é€šè¿‡é€‰æ‹©æ›´å¤šå‡½æ•°ï¼Œspade_sub å¯ç¡®ä¿åŒ…å«æ‰€æœ‰æœªåŒ…å«çš„å‡½æ•°ã€‚ æ‰€æœ‰ä¸‰ç§æ–¹æ³•éƒ½éµå®ˆ ğ¸â€² è¦†ç›–çº¦æŸï¼Œä½† $spade_base$ åœ¨ 9 ä¸ªç®¡é“ä¸­æœ‰ 4 ä¸ªè¿åäº† FFR çº¦æŸã€‚ å¹³å‡è€Œè¨€ï¼Œä¸ $spade_base$ ç›¸æ¯”ï¼Œspade_sub é€‰æ‹©çš„æ–­è¨€æ•°é‡å‡å°‘äº†çº¦ 14%ï¼Œå¹¶ä¸” FFR æ˜¾ç€é™ä½ï¼Œç›¸å¯¹äº $spade_base$ å‡å°‘äº†çº¦ 21%ã€‚ spade_cov å¹³å‡æ’é™¤äº† 44% æœªåŒ…å«åœ¨ ğ¹â€² ä¸­çš„å‡½æ•°ã€‚ æˆ‘ä»¬éšåè®¨è®ºä¸åŒ spade å®ç°ä¹‹é—´çš„æƒè¡¡ ç»“æœå’Œä¾‹å­éƒ½æ˜¾ç¤ºäº†æ¯”è¾ƒé«˜çš„ precisionï¼Œè€Œä¸”ç”¨çš„æ˜¯ GPT-4 å…¶ä¸­ code review pipeline çš„ä¸€äº› assertion ä¼šå›å»è°ƒç”¨ LLMï¼Œè¯¢é—®æ˜¯å¦åŒ…å«ä»£ç ä¿®æ”¹çš„å»ºè®®ï¼Œreview æ˜¯å¦ç²¾ç®€ï¼Œæ˜¯å¦èšç„¦äºè¯¥ PR å‰©ä¸‹çš„æ²¡ä»”ç»†çœ‹ï¼Œå¾ˆå¤šç»“æœå¹¶ä¸æ˜¯å¾ˆä»¤äººä¿¡æœï¼Œå°¤å…¶æ˜¯å¯¹ä¸‰ä¸ªä¸åŒçš„ SPADE (base é€‰æ‹©æ‰€æœ‰çš„ fï¼Œcov é€‰æ‹©æœ€å°çš„é›†åˆï¼Œsub æ˜¯ Subsumption Constraints é™åˆ¶çš„) ä¸åŒç‰ˆæœ¬ SPADE çš„ç»“æœï¼Œğ›¼ =0.6 å’Œ ğœ =0.25ã€‚ å‹¾å·å’Œ x æ ‡è®°è¡¨ç¤ºæ˜¯å¦æ»¡è¶³ ğ›¼ å’Œ ğœ çº¦æŸã€‚ æ¯ä¸ªæ¡ç›®éƒ½æ˜¯è¯¥ç®¡é“çš„å€™é€‰æ–­è¨€æ€»æ•°çš„ä¸€éƒ¨åˆ†ï¼ˆæ‹¬å·ä¸­æ˜¯ç»å¯¹æ•°é‡ï¼‰ã€‚ spade_cov æ€»ä½“ä¸Šé€‰æ‹©æœ€å°‘çš„æ–­è¨€ã€‚ spade_sub åœ¨ä¼˜åŒ–åŒ…å«æ—¶é€‰æ‹©æœ€å°‘çš„æ–­è¨€ ğœ¶ and ğ‰ Threshold Sensitivityï¼šSpade ä¸­ ILP æ±‚è§£å™¨çš„è§£å†³æ–¹æ¡ˆçš„å¯è¡Œæ€§å–å†³äºæ‰€é€‰çš„ ğ›¼ å’Œ ğœ é˜ˆå€¼ã€‚ å¦‚æœæ‰¾ä¸åˆ°å¯è¡Œçš„è§£å†³æ–¹æ¡ˆï¼Œå¼€å‘äººå‘˜å¯èƒ½éœ€è¦ä»¥äºŒåˆ†æœç´¢çš„æ–¹å¼è°ƒæ•´è¿™äº›å€¼ã€‚ åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæ‰€æœ‰ 9 ä¸ª LLM ç®¡é“éƒ½äº§ç”Ÿäº† ğ›¼ = 0.6 å’Œ ğœ = 0.25 çš„å¯è¡Œè§£å†³æ–¹æ¡ˆã€‚ ç„¶è€Œï¼Œğ¸â€² çš„å°å°ºå¯¸ä½¿å¾— spade_cov å¯¹ ğ›¼ ç‰¹åˆ«æ•æ„Ÿã€‚ åœ¨ç®¡é“ä¸­ï¼Œæˆ‘ä»¬è§‚å¯Ÿåˆ° 1 åˆ° 5 ä¸ªæ–­è¨€è¦†ç›–äº† 60% çš„å¤±è´¥ã€‚ ä¾‹å¦‚ï¼Œspade_cov åªä¸ºç”µå­é‚®ä»¶ç®¡é“é€‰æ‹©äº†ä¸€ä¸ªæ–­è¨€ FFR Tradeoffs: è€ƒè™‘åˆ°å¯¹äºä¸‰ä¸ª LLM ç®¡é“ï¼Œä¸º spade_base å’Œ spade_sub é€‰æ‹©çš„å‡½æ•°æ¯”ä¾‹ä¹‹é—´çš„å·®å¼‚å°äº 10%ï¼Œäººä»¬å¯èƒ½æƒ³çŸ¥é“ spade_sub çš„å¤æ‚æ€§æ˜¯å¦å€¼å¾—ã€‚ spade_sub é€šå¸¸æ›´å¯å–ï¼Œå› ä¸º spade_base æ— æ³•å§‹ç»ˆæ»¡è¶³ FFR é˜ˆå€¼ ğœã€‚ æˆ‘ä»¬è§‚å¯Ÿåˆ°ï¼Œéšç€æç¤ºç‰ˆæœ¬çš„å¢åŠ ï¼Œæ–­è¨€çš„æ•°é‡ä¹Ÿä¼šå¢åŠ ï¼Œä»è€Œå¯¹ spade_base äº§ç”Ÿä¸åˆ©å½±å“ã€‚ ä¸€ç»„çš„æœ€åæƒ…å†µ FFR æ˜¯å„ä¸ª FFR çš„æ€»å’Œï¼Œå¦‚å…¬å¼ (2) æ‰€ç¤ºã€‚ å› æ­¤ï¼Œåœ¨å­˜åœ¨å¤§é‡ç‹¬ç«‹æ–­è¨€çš„æƒ…å†µä¸‹ï¼Œæ€» FFR å¾ˆå¯èƒ½ä¼šè¶…è¿‡é˜ˆå€¼ã€‚è¿™ä¸ªé—®é¢˜åœ¨ fashion å’Œ lecturesummaries ç®¡é“ä¸­å¾ˆæ˜æ˜¾ï¼Œå°½ç®¡ 67 å’Œ 32 ä¸ªæ–­è¨€ä¸­çš„æ¯ä¸€ä¸ªéƒ½å•ç‹¬æ»¡è¶³ FFR çº¦æŸï¼Œä½† spade_base çš„æ€» FFR åˆ†åˆ«è¾¾åˆ° 0.88 å’Œ 0.53ã€‚ å®é™…ä¸Šï¼Œå¦‚æœå°† spade éƒ¨ç½²åœ¨äº¤äº’å¼ç³»ç»Ÿä¸­ï¼Œå…¶ä¸­ spade å¯ä»¥å®æ—¶è§‚å¯Ÿæ¯ä¸ª LLM è°ƒç”¨ï¼ˆä¾‹å¦‚ï¼Œä½œä¸º OpenAI API çš„åŒ…è£…å™¨ï¼‰ï¼Œåˆ™å¤§é‡çš„æç¤ºç‰ˆæœ¬è¿›ä¸€æ­¥éœ€è¦åŸºäºæ•´ä½“ FFR è¿‡æ»¤æ–­è¨€ ã€‚ è¿™å¼ºè°ƒäº†å¯¹æ›´å¤æ‚çš„ spade_cov æˆ– spade_sub æ–¹æ³•çš„éœ€è¦ ","date":"2024-03-01","objectID":"/posts/spade-paper/:6:3","tags":["Paper Reading"],"title":"Paper Reading: Spade Synthesizing Assertions for Large Language Model Pipelines","uri":"/posts/spade-paper/"},{"categories":null,"content":"Limitations and Future Work Improving Quality of LLMs: è™½ç„¶ LLMï¼ˆå°é—­å¼å’Œå¼€æºï¼‰æ­£åœ¨è¿…é€Ÿæ”¹è¿›ï¼Œå¹¶ä¸”æˆ‘ä»¬æ²¡æœ‰æ˜ç¡®ç ”ç©¶ spade çš„ prompt engineering strategiesï¼Œä½†è¡¥å……çš„ç ”ç©¶æƒ³æ³•æ˜¯æ¢ç´¢æ­¤ç±»ç­–ç•¥æˆ–å¾®è°ƒå°å‹å¼€æºæ¨¡å‹ä»¥ç”Ÿæˆæ–­è¨€ã€‚ æ­¤å¤–ï¼Œæˆ‘ä»¬æå‡ºå°† subsumption ä½œä¸ºè¦†ç›–èŒƒå›´ä»£ç†ï¼Œä½†æ²¡æœ‰æ¢ç´¢ prompt å·¥ç¨‹ç”šè‡³é LLM ç­–ç•¥ï¼ˆä¾‹å¦‚ï¼Œæ–­è¨€æ¥æºï¼‰æ¥è¯„ä¼°åŒ…å«ã€‚ å°½ç®¡ LLM å–å¾—äº†è¿›æ­¥ï¼Œä½† SPADE çš„è¿‡æ»¤é˜¶æ®µå¯¹äºå‡å°‘å†—ä½™å’Œç¡®ä¿å‡†ç¡®æ€§ä»ç„¶è‡³å…³é‡è¦ï¼Œç‰¹åˆ«æ˜¯å› ä¸ºæ–­è¨€å¯èƒ½æ¶‰åŠ LLMã€‚ Collecting Labeled Examples: è·å–æ ‡è®°æ•°æ®ï¼ˆğ¸â€²ï¼‰å¾ˆå›°éš¾ã€‚ æˆ‘ä»¬çš„å¤§å¤šæ•°æ•°æ®é›†çš„æç¤ºç‰ˆæœ¬å¾ˆå°‘ï¼ˆåªæœ‰æäº¤ç»™ LangChain Hub çš„ç‰ˆæœ¬ï¼‰ï¼Œä½†å®é™…ä¸Šï¼Œå¼€å‘äººå‘˜å¯èƒ½ä¼šå¯¹å…¶æç¤ºè¿›è¡Œæ•°åæˆ–æ•°ç™¾æ¬¡è¿­ä»£ã€‚ æœªæ¥çš„å·¥ä½œå¯èƒ½æ¶‰åŠé€šè¿‡ LLM API åŒ…è£…å™¨è¿›è¡Œè¢«åŠ¨ç¤ºä¾‹æ”¶é›†æˆ–æ”¶é›†å¼€å‘äººå‘˜å¯¹æ–­è¨€çš„åé¦ˆã€‚ å¯¹ä¸åŒç±»å‹çš„æ–­è¨€è¿›è¡Œä¼˜å…ˆçº§æ’åºå¹¶åœ¨ spade ä¸­å°†è¿™äº›ä¼˜å…ˆçº§å½¢å¼åŒ–æ˜¯å¦ä¸€ä¸ªéœ€è¦æ¢ç´¢çš„é¢†åŸŸã€‚ æ­¤å¤–ï¼Œåœ¨æœ‰é™çš„ ğ¸â€² ä¸‹è¯„ä¼° FFR ä¼°è®¡çš„å‡†ç¡®æ€§ï¼Œå¹¶æ¢ç´¢åœ¨ç¼ºä¹å¤§å‹æ ‡è®°æ•°æ®é›†çš„æƒ…å†µä¸‹æé«˜ FFR å‡†ç¡®æ€§çš„æ–¹æ³•ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡é¢„æµ‹é©±åŠ¨çš„æ¨ç† [2]ï¼‰ï¼Œä¸ºæœªæ¥çš„å·¥ä½œæå‡ºäº†ä¸€ä¸ªæœ‰è¶£çš„é¢†åŸŸ Supporting More Complex LLM Pipelines: æˆ‘ä»¬çš„ç ”ç©¶é‡ç‚¹æ˜¯å•æç¤º LLM pipelineï¼Œä½†æ›´å¤æ‚çš„ç®¡é“ï¼ˆä¾‹å¦‚æ¶‰åŠå¤šä¸ªæç¤ºã€å¤–éƒ¨èµ„æºå’Œäººå·¥äº¤äº’çš„ç®¡é“ï¼‰ä¸ºæ¯ä¸ªç®¡é“ç»„ä»¶è‡ªåŠ¨ç”Ÿæˆæ–­è¨€æä¾›äº†æœºä¼šã€‚ ä¾‹å¦‚ï¼Œåœ¨æ£€ç´¢å¢å¼ºç”Ÿæˆç®¡é“ä¸­[28]ï¼Œç”šè‡³å¯ä»¥åœ¨ç”Ÿæˆ LLM å“åº”ä¹‹å‰å°†æ–­è¨€åº”ç”¨äºæ£€ç´¢åˆ°çš„ä¸Šä¸‹æ–‡ã€‚ ","date":"2024-03-01","objectID":"/posts/spade-paper/:6:4","tags":["Paper Reading"],"title":"Paper Reading: Spade Synthesizing Assertions for Large Language Model Pipelines","uri":"/posts/spade-paper/"},{"categories":null,"content":"RELATED WORK Prompt Engineering: å¯¹äºéæŠ€æœ¯ç”¨æˆ· [57] å’ŒæŠ€æœ¯ç”¨æˆ· [34, 47] æ¥è¯´ï¼ŒPrompt å·¥ç¨‹å¾ˆå›°éš¾ï¼ŒåŸå› æœ‰å‡ ä¸ªï¼šæç¤ºæªè¾ [4, 29] æˆ–æŒ‡ä»¤æˆ–ä¸Šä¸‹æ–‡çš„é¡ºåº [30] çš„å¾®å°å˜åŒ–å¯èƒ½ä¼šæ˜¾ç€å½±å“è¾“å‡ºã€‚ æ­¤å¤–ï¼Œéšç€ LLM åœ¨ API ä¸‹å‘ç”Ÿå˜åŒ–ï¼ˆå³æç¤ºæ¼‚ç§»ï¼‰ï¼Œè¾“å‡ºå¯èƒ½ä¼šåœ¨å¼€å‘äººå‘˜ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹å‘ç”Ÿå˜åŒ– [9]ã€‚ å¸®åŠ©æç¤ºç®¡ç†å’Œå®éªŒçš„å·¥å…·å’Œè®ºæ–‡ä¸æ–­å‡ºç°ï¼Œç”šè‡³ä½¿ç”¨ LLM æ¥ç¼–å†™æç¤º [3,11,54,55,59]ã€‚ æ­¤å¤–ï¼Œéƒ¨ç½²çš„æç¤ºå¼•å…¥äº†æ–°çš„æŒ‘æˆ˜ï¼Œä¾‹å¦‚â€œç”¨æ›´å°‘çš„æ ‡è®°å¹³è¡¡æ›´å¤šçš„ä¸Šä¸‹æ–‡â€å’Œâ€œäº‰è®ºæç¤ºè¾“å‡ºâ€ä»¥æ»¡è¶³ç”¨æˆ·å®šä¹‰çš„æ ‡å‡†[35]ã€‚ æˆ‘ä»¬çš„å·¥ä½œå¹¶ä¸æ˜ç¡®åœ°ä¸“æ³¨äºå¸®åŠ©å¼€å‘äººå‘˜åˆ›å»ºæ›´å¥½çš„æç¤ºï¼Œä½†å®ƒå¯ä»¥é€šè¿‡æ¨èçš„æ–­è¨€é—´æ¥æ”¯æŒå¼€å‘äººå‘˜æ”¹è¿›æç¤ºã€‚ ML and LLM Evaluation: ä¼—æ‰€å‘¨çŸ¥ï¼Œè¯„ä¼°å’Œç›‘æ§å·²éƒ¨ç½²çš„æœºå™¨å­¦ä¹ æ¨¡å‹å…·æœ‰æŒ‘æˆ˜æ€§ [33, 45]ã€‚ åœ¨éƒ¨ç½²ç¯å¢ƒä¸­è¯„ä¼° LLM æ›´å…·æŒ‘æˆ˜æ€§ï¼Œå› ä¸º LLM é€šå¸¸ç”¨äºç”Ÿæˆä»»åŠ¡ï¼Œå…¶è¾“å‡ºæ˜¯è‡ªç”±å½¢å¼çš„[13]ã€‚ ä¸€äº› LLM ç®¡é“ç±»å‹ï¼Œä¾‹å¦‚ä½¿ç”¨æ£€ç´¢å¢å¼ºç”Ÿæˆç®¡é“çš„é—®ç­” [28]ï¼Œå¯ä»¥ä½¿ç”¨æ ‡å‡†åŒ–çš„è‡ªåŠ¨åŒ–æŒ‡æ ‡ [14, 39]ï¼Œä½†å…¶ä»–ç±»å‹åˆ™å› æœªçŸ¥æŒ‡æ ‡å’Œç¼ºä¹æ ‡è®°æ•°æ®é›†è€Œé¢ä¸´æŒ‘æˆ˜ [8, 35, 56]ã€‚ é€šå¸¸ï¼Œç»„ç»‡ä¾é äººç±»è¯„ä¼°è€…æ¥è¯„ä¼° LLM çš„è¾“å‡º[19,35,52]ï¼Œä½†æœ€è¿‘çš„ç ”ç©¶è¡¨æ˜ LLM å¯ä»¥é€šè¿‡è¯¦ç»†çš„â€œè®°åˆ†å¡â€è¿›è¡Œæœ‰æ•ˆçš„è‡ªæˆ‘è¯„ä¼°[7,26,58]ã€‚ ç„¶è€Œï¼Œç¼–å†™è¿™äº›è®°åˆ†å¡å¯èƒ½å…·æœ‰æŒ‘æˆ˜æ€§ [35]ï¼Œä»è€Œæ¿€åŠ±è‡ªåŠ¨ç”Ÿæˆçš„è¯„ä¼°è€… LLMs for Software Testing: LLM è¶Šæ¥è¶Šå¤šåœ°ç”¨äºè½¯ä»¶æµ‹è¯•ï¼Œä¸»è¦ç”¨äºç”Ÿæˆå•å…ƒæµ‹è¯•å’Œæµ‹è¯•ç”¨ä¾‹[27,40,48,50,51]ã€‚ ç ”ç©¶æ¢è®¨äº† LLM çš„æ¿€åŠ±ç­–ç•¥ã€å¹»è§‰å’Œä¸ç¡®å®šæ€§å¦‚ä½•å½±å“ä»£ç æˆ–æµ‹è¯•çš„å‡†ç¡®æ€§ [10,15,16,32]ã€‚ æˆ‘ä»¬çš„å·¥ä½œæ˜¯äº’è¡¥çš„ï¼Œå¹¶åˆ©ç”¨ LLM ä¸º LLM ç®¡é“ç”ŸæˆåŸºäºä»£ç çš„æ–­è¨€ Testing in ML Pipelines: ML pipelines åœ¨ç”Ÿäº§ä¸­å¾ˆéš¾ç®¡ç†ã€‚ è®¸å¤šæœ‰å…³æœºå™¨å­¦ä¹ æµ‹è¯•çš„æ–‡çŒ®éƒ½æ˜¯é€šè¿‡åˆ†ææ•°æ®è´¨é‡ [5, 22, 42, 43] æˆ–æ¥æº [31, 41] æ¥éªŒè¯ç»“æ„åŒ–æ•°æ®ã€‚ ML æµ‹è¯•å¹³å°é€šå¸¸æä¾›è‡ªåŠ¨å®éªŒè·Ÿè¸ªå’Œé˜²æ­¢è¿‡åº¦æ‹Ÿåˆ [1, 38]ï¼Œä»¥åŠæ•°æ®åˆ†å¸ƒè°ƒè¯•å·¥å…· [20]ã€‚ ç‰¹å®šäºæ¨¡å‹çš„æ–­è¨€é€šå¸¸éœ€è¦äººç±»è§„èŒƒ[25]ï¼Œæˆ–è€…è‡³å°‘éœ€è¦å¤§é‡æ•°æ®æ¥è®­ç»ƒå­¦ä¹ æ–­è¨€[24]ã€‚ LLM é“¾æˆ–ç®¡é“æ˜¯ä¸€ç±»æ–°å‹ ML ç®¡é“ï¼ŒLLM æœ¬èº«å¯ä»¥ç”¨å¾ˆå°‘çš„æ•°æ®ç”Ÿæˆæ–­è¨€ã€‚ æœ€è¿‘çš„ä¸€é¡¹ç ”ç©¶å¼ºè°ƒäº†æµ‹è¯•â€œcopilotâ€ç±»äº§å“çš„ LLM ç®¡é“çš„éš¾åº¦ï¼šå¼€å‘äººå‘˜å¸Œæœ›ç¡®ä¿å‡†ç¡®æ€§ï¼ŒåŒæ—¶é¿å…è¿‡åº¦ä½¿ç”¨èµ„æºï¼Œä¾‹å¦‚è¿è¡Œæ•°ç™¾ä¸ªæ–­è¨€ [35]â€”â€”è¿™æ¿€å‘äº†æˆ‘ä»¬çš„æ–­è¨€è¿‡æ»¤æ–¹æ³•ã€‚ ","date":"2024-03-01","objectID":"/posts/spade-paper/:7:0","tags":["Paper Reading"],"title":"Paper Reading: Spade Synthesizing Assertions for Large Language Model Pipelines","uri":"/posts/spade-paper/"},{"categories":null,"content":"CONCLUSION æˆ‘ä»¬çš„å·¥ä½œå¼•å…¥äº†è‡ªåŠ¨ç”Ÿæˆæ–­è¨€ä»¥æ•è· LLM ç®¡é“ä¸­çš„æ•…éšœçš„æ–°é—®é¢˜ï¼Œä»¥åŠåŒ…å«ä¸¤ä¸ªç»„ä»¶çš„è§£å†³æ–¹æ¡ˆï¼šé¦–å…ˆï¼Œå®ƒ synthesizes candidate assertionsï¼› ç„¶åï¼Œå®ƒä¼š filter å®ƒä»¬ã€‚ æˆ‘ä»¬æå‡ºäº†æ–­è¨€åˆæˆçš„å¿«é€Ÿç¼–è¾‘åˆ†ç±»æ³•ï¼Œé€šè¿‡ä¸ LangChain çš„é›†æˆå’Œéƒ¨ç½²å±•ç¤ºäº†å…¶æ½œåŠ›ã€‚ æˆ‘ä»¬å°†ç”¨äºé«˜ç²¾åº¦è¦†ç›–æ•…éšœçš„æœ€ä½³æ–­è¨€é›†çš„é€‰æ‹©è¡¨ç¤ºä¸ºæ•´æ•°çº¿æ€§ç¨‹åºï¼ˆILPï¼‰ã€‚ æˆ‘ä»¬æå‡ºäº†æ–­è¨€åŒ…å«æ¥æ¶µç›–æ•°æ®ç¨€ç¼ºåœºæ™¯ä¸­çš„æ•…éšœï¼Œå¹¶å°†å…¶çº³å…¥æˆ‘ä»¬çš„ ILP ä¸­ã€‚ æˆ‘ä»¬çš„è‡ªåŠ¨ç”Ÿæˆæ–­è¨€ç³»ç»Ÿ Spade åœ¨ 9 ä¸ªçœŸå®æ•°æ®ç”Ÿæˆ LLM ç®¡é“ä¸Šè¿›è¡Œäº†è¯„ä¼°ã€‚ æˆ‘ä»¬å·²å…¬å¼€æˆ‘ä»¬çš„ä»£ç å’Œæ•°æ®é›†ä»¥ä¾›è¿›ä¸€æ­¥ç ”ç©¶å’Œåˆ†æ æ²¡æœ‰ç†è§£ SPADE base, cov, sub ä¹‹é—´çš„åŒºåˆ«ï¼Œåªæ˜¯é€‰æ‹©çš„é›†åˆä¸åŒå— The paper presents SPADE, which is a method to detect incorrect outputs from large language models (LLMs) by automatically synthesizing assertions when developing LLM pipelines (such as codereviews and lecturesummaries). SPADE analyses the prompt version histories and creating candidate assertion functions based on the prompt deltas. Then, SPADE selects a minimal set of assertions or a subset that satisfies the coverage and accuracy requirements, meaning that they can catch most of the errors without causing too many false failures. The paper also uses a pruning technique to remove redundant or contradictory assertions from the final set. Finally, The paper evaluates SPADE on 9 real-world LLM pipelines and shows that it can reduce the number of assertions by 14% and decrease false failures by 21% compared to simpler baselines. The paper proposes a novel formulation of synthesizing assertions for LLM pipelines, which takes into account the prompt version histories, the coverage and accuracy requirements, and the trade-off between assertion complexity and number. It also provides an open-source implementation of SPADE and deploy it on the Langchain. The SPADE can effectively reduce the number of assertions and false failures compared to simpler baselines, and that spade-generated assertions can help developers improve their LLM pipelines. Spade reduces the number of assertions by 14% and the number of false failures by 21% compared to simpler baselines. It evaluates SPADE on nine real-world LLM pipelines, and demonstrates its effectiveness in reducing the number of assertions, increasing the coverage and accuracy of assertions, and identifying bad LLM outputs. Like all the applications built on LLM, it relies on the quality of the language model, the ability of LLM correct classificationand the availability of prompt version histories. If the prompt is too large or the language model performs bad, the assertions (python code or string match) might not work. The paper does not compare SPADE with Reinforcement Learning from Human Feedback(ChatGPT is enhanced with RLHF to filter inaccurate text and harmful output). SPADE also ignored the very important metrics, recall rate, in the experiment. SPADE does not discuss the different effects brought by different assertion implementation methods. For example, most assertions are string matching and many of them might even not work, which may cause some assertions to fail and increase FFR. I would try to first compare SPADE with other existing methods for LLM quality control, such as RLHF. Then explore more appropriate assertion implementation methods instead of simple string matching, and discuss the impact of different assertions on FFR. And during the experiment, try to deeply explore the impact of different coverage rates on recall and precision. Finally, try to generalize SPADE to more language models, such as smaller models with less parameters, making the LLM pipeline construction cheaper ","date":"2024-03-01","objectID":"/posts/spade-paper/:8:0","tags":["Paper Reading"],"title":"Paper Reading: Spade Synthesizing Assertions for Large Language Model Pipelines","uri":"/posts/spade-paper/"},{"categories":null,"content":"SEED: Domain-Specific Data Curation With Large Language Models ä½¿ç”¨å¤§å‹è¯­è¨€æ¨¡å‹çš„ é¢†åŸŸç‰¹å®š æ•°æ®ç®¡ç† ","date":"2024-03-01","objectID":"/posts/seed-paper/:1:0","tags":["Paper Reading"],"title":"Paper Reading: SEED Domain-Specific Data Curation With Large Language Models","uri":"/posts/seed-paper/"},{"categories":null,"content":"ABSTRACT å‡†å¤‡åˆ†ææ•°æ®çš„æ•°æ®ç®¡ç†ä»»åŠ¡ Data Curation å¯¹äºå°†æ•°æ®è½¬æ¢ä¸ºå¯è¡Œçš„è§è§£è‡³å…³é‡è¦ã€‚ä½†æ˜¯ï¼Œç”±äºä¸åŒåŸŸä¸­çš„åº”ç”¨ç¨‹åºçš„ä¸åŒè¦æ±‚ï¼Œé€šç”¨çš„ç°æˆå·¥å…·é€šå¸¸ä¸è¶³ã€‚ç»“æœï¼Œæ•°æ®ç§‘å­¦å®¶é€šå¸¸å¿…é¡»å¼€å‘é’ˆå¯¹æ•°æ®é›†å’Œä»»åŠ¡é‡èº«å®šåˆ¶çš„ç‰¹å®šé¢†åŸŸ domain-specific è§£å†³æ–¹æ¡ˆï¼Œä¾‹å¦‚åœ¨è¶³å¤Ÿæ•°é‡çš„å¸¦æ³¨é‡Šçš„ç¤ºä¾‹ä¸Šç¼–å†™ç‰¹å®šäºåŸŸçš„ä»£ç æˆ–åŸ¹è®­æœºå™¨å­¦ä¹ æ¨¡å‹ã€‚ä¼—æ‰€å‘¨çŸ¥ï¼Œè¿™ä¸ªè¿‡ç¨‹å¾ˆå›°éš¾ä¸”è€—æ—¶ã€‚æˆ‘ä»¬æå‡ºäº† SEED ï¼Œè¿™æ˜¯ä¸€ç§ LLM-as-compiler æ–¹æ³•ï¼Œè¯¥æ–¹æ³•è‡ªåŠ¨é€šè¿‡å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMSï¼‰è‡ªåŠ¨ç”Ÿæˆç‰¹å®šäºåŸŸçš„æ•°æ®ç­–åˆ’è§£å†³æ–¹æ¡ˆã€‚ç”¨æˆ·æè¿°äº†ä¸€ä¸ªä»»åŠ¡ï¼Œè¾“å…¥æ•°æ®å’Œé¢„æœŸçš„é‡åï¼ŒSEED compiler ç¼–è¯‘å™¨å°±ä¼šç”Ÿäº§ç”± LLM ç”Ÿæˆçš„ä»£ç ï¼Œå°å‹æ¨¡å‹å’Œæ•°æ®è®¿é—®æ¨¡å—ç»„æˆçš„å¯æ‰§è¡Œç®¡é“ã€‚SEED ä½¿ç”¨è¿™äº›ç”Ÿæˆçš„æ¨¡å—æ¥å¤„ç†å¤§éƒ¨åˆ†æ•°æ®è®°å½•ï¼Œå¹¶åŠ¨æ€å†³å®š LLM ä½•æ—¶åº”è¯¥ä»‹å…¥ç›´æ¥å¤„ç†ä¸€äº›å•ç‹¬çš„è®°å½•ï¼Œå¯èƒ½ä½¿ç”¨æ•°æ®è®¿é—®æ¨¡å—ä»æ•°æ®æºæ£€ç´¢ç›¸å…³ä¿¡æ¯ï¼Œä»¥ååŠ© LLM è§£å†³ä»»åŠ¡ã€‚ä¸ºäº†éªŒè¯è¿™ç§æ–°çš„ã€é©å‘½æ€§çš„æ–¹æ³•ï¼Œæˆ‘ä»¬åœ¨è·¨è¶Š 5 ä¸ªæ•°æ®ç®¡ç†ä»»åŠ¡çš„ 9 ä¸ªæ•°æ®é›†ä¸Šè¿›è¡Œäº†å®éªŒã€‚ç»“æœè¡¨æ˜ï¼ŒSEED ç”Ÿæˆçš„ç‰¹å®šé¢†åŸŸçš„è§£å†³æ–¹æ¡ˆæ˜¾è‘—ä¼˜äºå®ƒä»¬çš„é€šç”¨å¯¹åº”æ–¹æ¡ˆï¼Œé€šå¸¸æ¥è¿‘ä½¿ç”¨æ•°åƒä¸ªæ ‡è®°è®­ç»ƒç¤ºä¾‹çš„æ‰‹åŠ¨ç®¡ç†è§£å†³æ–¹æ¡ˆçš„æ€§èƒ½ã€‚æ­¤å¤–ï¼Œä¸åœ¨æ¯ä¸ªæ•°æ®è®°å½•ä¸Šä½¿ç”¨ LLM çš„è§£å†³æ–¹æ¡ˆç›¸æ¯”ï¼ŒSEED å®ç°äº†æœ€å…ˆè¿›çš„æˆ–ç›¸å½“å°‘çš„æ€§èƒ½ï¼ŒåŒæ—¶æ˜¾ç€å‡å°‘äº† LLM è°ƒç”¨çš„æ•°é‡ ","date":"2024-03-01","objectID":"/posts/seed-paper/:2:0","tags":["Paper Reading"],"title":"Paper Reading: SEED Domain-Specific Data Curation With Large Language Models","uri":"/posts/seed-paper/"},{"categories":null,"content":"INTRODUCTION æ•°æ®ç®¡ç†ä»»åŠ¡æ˜¯ discover, extract, transform, clean, and integrate dataï¼Œå¯¹å„ç§å„æ ·çš„ç»„ç»‡éƒ½è‡³å…³é‡è¦ã€‚å°½ç®¡æ•°æ®ç®¡ç†ç•Œåšå‡ºäº†å·¨å¤§çš„åŠªåŠ›ï¼Œä½†è®¸å¤šæ¥æºä»ç„¶æŠ¥å‘Šç§°ï¼Œæ•°æ®ç§‘å­¦å®¶ä»ç„¶å°† 80% ä»¥ä¸Šçš„æ—¶é—´èŠ±åœ¨è¿™äº›ä»»åŠ¡ä¸Šã€‚è¿™æ ·åšçš„ä¸€ä¸ªå…³é”®åŸå› æ˜¯ï¼Œä¸åŒé¢†åŸŸçš„åº”ç”¨ç¨‹åºæœ‰ä¸åŒçš„éœ€æ±‚ï¼Œå³ä½¿æ˜¯é’ˆå¯¹å•ä¸€çš„æ•°æ®ç®¡ç†ä»»åŠ¡ï¼Œä¹Ÿæ²¡æœ‰ä¸€ä¸ªé€šç”¨çš„è§£å†³æ–¹æ¡ˆã€‚ä¾‹å¦‚ï¼Œå¯¹äºæ•°æ®æå–ä»»åŠ¡ï¼Œå¯ä»¥é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼æœ‰æ•ˆåœ°æå–è´§å¸é‡‘é¢ï¼Œä¾‹å¦‚æœç´¢åé¢è·Ÿç€ä»¥é€—å·å’Œå¥å·åˆ†éš”çš„æ•°å­—çš„ç¾å…ƒç¬¦å·ï¼Œå³$\\d[\\d|ï¼Œ|ã€‚è€Œæå–äººååˆ™éœ€è¦ä¸€ç§å®Œå…¨ä¸åŒçš„æ–¹æ³•ï¼Œæ¯”å¦‚åœ¨ Mr.æˆ– Ms.ç­‰ç§°å‘¼é™„è¿‘æœç´¢å¤§å†™çš„å•è¯ã€‚ç”±äºè¿™æ ·çš„æ¡ˆä¾‹ï¼Œé€šç”¨ç°æˆçš„å·¥å…·å¾ˆå°‘è¶³å¤Ÿã€‚å–è€Œä»£ä¹‹çš„æ˜¯ï¼Œæ•°æ®ç§‘å­¦å®¶é€šå¸¸å¿…é¡»å¼€å‘é’ˆå¯¹æ•°æ®é›†å’Œé—®é¢˜åŸŸé‡èº«å®šåˆ¶çš„ç‰¹å®šåº”ç”¨è§£å†³æ–¹æ¡ˆï¼Œä¾‹å¦‚ç‰¹å®šé¢†åŸŸçš„ç‰¹å®šè§£å†³æ–¹æ¡ˆä»£ç ï¼ˆå¦‚ä¸Šé¢çš„æ­£åˆ™è¡¨è¾¾å¼ï¼‰æˆ–åœ¨å¤§é‡å¸¦æ³¨é‡Šçš„ç¤ºä¾‹ä¸­è®­ç»ƒä»¥æ‰§è¡Œè¿™äº›ç±»å‹çš„ä»»åŠ¡çš„æœºå™¨å­¦ä¹ æ¨¡å‹ã€‚ç»“æœï¼Œä¸ºç‰¹å®šæ–¹æ¡ˆè®¾è®¡æ•°æ®ç­–å±•è§£å†³æ–¹æ¡ˆæ˜¯è€—æ—¶çš„ï¼Œéœ€è¦è¿›è¡Œå¤šè½®éœ€æ±‚ç”Ÿæˆï¼ŒåŸ¹è®­æ•°æ®æ”¶é›†ï¼Œæ¨¡å‹/ç®—æ³•å¼€å‘ä»¥åŠä¸æ•°æ®ç§‘å­¦å®¶å’ŒåŸŸä¸“å®¶è¿›è¡Œæµ‹è¯•ï¼Œå¹¶ä¸”å¾ˆå°‘å¯ä»¥ä»ä¸€ä¸ªéƒ¨ç½²ä¸­é‡å¤ä½¿ç”¨åˆ°ä¸‹ä¸€ä¸ªã€‚å¯¹äºä¼ä¸šè€Œè¨€ï¼Œè¿™å¯èƒ½æ˜¯éå¸¸æ˜‚è´µçš„,ä¾‹å¦‚ï¼ŒCitadel é›‡ç”¨ 50 å¤šåæ•°æ®ç®¡ç†ä¸“å®¶æ¥å‘å…¶åˆ†æå¸ˆæä¾›é«˜è´¨é‡çš„æ¸…æ´æ•°æ®,æ¯å¹´ä½¿ä»–ä»¬èŠ±è´¹æ•°åƒä¸‡ã€‚ ","date":"2024-03-01","objectID":"/posts/seed-paper/:3:0","tags":["Paper Reading"],"title":"Paper Reading: SEED Domain-Specific Data Curation With Large Language Models","uri":"/posts/seed-paper/"},{"categories":null,"content":"Our Approach: SEED åœ¨è¿™é¡¹å·¥ä½œä¸­ï¼Œæˆ‘ä»¬æå‡ºäº† SEEDï¼Œä¸€ç§ LLM-as-compiler çš„æ–¹æ³•ï¼Œå®ƒç»™å‡ºä»»åŠ¡çš„ç”¨æˆ·æè¿°ã€è¾“å…¥æ•°æ®å’Œé¢„æœŸè¾“å‡º(ä½œä¸º JSON è§„èŒƒ)ï¼Œè‡ªåŠ¨å°†è¯¥è§„èŒƒç¼–è¯‘æˆä¸“é—¨é’ˆå¯¹æ‰‹å¤´æ•°æ®å’Œåº”ç”¨ç¨‹åºå®šåˆ¶çš„ç‰¹å®šé¢†åŸŸæ•°æ®ç®¡ç†è§£å†³æ–¹æ¡ˆã€‚ å…³é”®è§è§£æ˜¯ï¼ŒLLM å…·æœ‰ä»¤äººå°è±¡æ·±åˆ»çš„ç”Ÿæˆä»£ç èƒ½åŠ›ï¼Œæ‰§è¡Œæ¨ç†ï¼Œç†è§£æ•°æ®çš„è¯­ä¹‰å’Œç¼–ç å¸¸è¯†çš„èƒ½åŠ›ï¼Œå°†å¯¼è‡´æ•°æ®ç­–åˆ’ç ”ç©¶çš„èŒƒå¼è½¬ç§»ï¼Œå¹¶å¯ä»¥åœ¨è¯¥æ•°æ®ç­–åˆ’æ–¹é¢æ„å»ºæ•°æ®ç­–åˆ’è§£å†³æ–¹æ¡ˆ on the flyã€‚å®é™…ä¸Šï¼Œå…ˆå‰çš„å·¥ä½œè¡¨æ˜ï¼ŒLLM å¯ä»¥åœ¨è§£å†³ç‰¹å®šæ•°æ®ç­–å±•ä»»åŠ¡æ–¹é¢éå¸¸æœ‰æ•ˆã€‚ä¸è¿™äº›å…ˆå‰çš„å·¥ä½œä¸åŒï¼Œè¿™äº›å·¥ä½œç›´æ¥ä¾èµ–äº LLM æ¥å¤„ç†æ•°æ®ç­–å±•ä»»åŠ¡ä¸­çš„æ¯ä¸ªè®°å½•ï¼ŒSEED æ—¨åœ¨ä½¿ç”¨ LLMS æ¥ç”Ÿæˆä¸åŒæ•°æ®ç­–åˆ’ä»»åŠ¡çš„åŸŸç‰¹å¼‚æ€§æ¨¡å—ï¼Œå…¶ä¸­ä¸€äº›å¯èƒ½æ¶‰åŠ LLMS çš„ç›´æ¥è°ƒç”¨å’Œä¸€äº›å…¶ä¸­æ˜¯ LLM ç”Ÿæˆçš„ï¼Œä½†ä¸€æ—¦ç”Ÿäº§äº† LLMã€‚ LLM çœŸçš„èƒ½æ¨ç†å—ï¼Ÿ å…³é”®çš„è§è§£æ˜¯ï¼ŒLLMs å…·æœ‰ä»¤äººå°è±¡æ·±åˆ»çš„ç”Ÿæˆä»£ç ã€æ‰§è¡Œæ¨ç†ã€ç†è§£æ•°æ®è¯­ä¹‰å’Œç¼–ç å¸¸è¯†çš„èƒ½åŠ›ï¼Œè¿™å°†å¯¼è‡´æ•°æ®æ•´ç†ç ”ç©¶èŒƒå¼çš„è½¬å˜ï¼Œå¹¶ä½¿å³æ—¶æ„å»ºæ•°æ®æ•´ç†è§£å†³æ–¹æ¡ˆæˆä¸ºå¯èƒ½ã€‚äº‹å®ä¸Šï¼Œå…ˆå‰çš„å·¥ä½œå·²ç»è¡¨æ˜ï¼ŒLLM åœ¨è§£å†³ç‰¹å®šæ•°æ®æ•´ç†ä»»åŠ¡æ–¹é¢éå¸¸æœ‰æ•ˆã€‚ä¸è¿™äº›ç›´æ¥ä¾èµ– LLM å¤„ç†æ•°æ®æ•´ç†ä»»åŠ¡ä¸­æ¯æ¡è®°å½•çš„å‰æœŸå·¥ä½œä¸åŒï¼ŒSEED çš„ç›®æ ‡æ˜¯åˆ©ç”¨ LLM ä¸ºä¸åŒçš„æ•°æ®æ•´ç†ä»»åŠ¡ç”Ÿæˆç‰¹å®šé¢†åŸŸçš„æ¨¡å—ï¼Œå…¶ä¸­æœ‰äº›æ¨¡å—å¯èƒ½éœ€è¦ç›´æ¥è°ƒç”¨ LLMï¼Œæœ‰äº›æ¨¡å—ç”± LLM ç”Ÿæˆï¼Œä½†ç”Ÿæˆåå¹¶ä¸ä½¿ç”¨ LLMã€‚ Simran Arora et al. 2023. Language Models Enable Simple Systems for Generating Structured Views of Heterogeneous Data Lakes. Proc. VLDB Endow. 17, 2 (2023), 92â€“105 çœ‹ä¸Šå»è¿™éå¸¸ä¾èµ– LLM çš„æ€§èƒ½ å…·ä½“æ¥è¯´ï¼ŒSEED ç¼–è¯‘å™¨ä¼šç”Ÿæˆä¸€ä¸ªæ‰§è¡Œç®¡é“ ç”±ä»£ç ã€å°å‹æ¨¡å‹å’Œæ•°æ®è®¿é—®æ¨¡å—ä»¥åŠ å’Œæ•°æ®è®¿é—®æ¨¡å—ç»„æˆçš„æ‰§è¡Œæµæ°´çº¿ã€‚è®°å½•çš„ç›´æ¥è°ƒç”¨ã€‚åœ¨è¿™ä¸ªæ‰§è¡Œæµæ°´çº¿ä¸­ï¼Œæ¨¡å—ä»¥å„ç§æ–¹å¼ä½¿ç”¨ LLMã€‚æ–¹å¼ä½¿ç”¨ LLMã€‚ä¾‹å¦‚ï¼Œä»£ç æˆ–å°å‹æ¨¡å‹æ¨¡å—ç”± ä¾‹å¦‚ï¼Œç”± LLM åˆæˆä»£ç æˆ–å°å‹æ¨¡å‹æ¨¡å—ï¼Œä»¥æä¾›ç‰¹å®šé¢†åŸŸçš„è§£å†³æ–¹æ¡ˆï¼ˆå¦‚ç”¨äºæå–è´§å¸é‡‘é¢çš„æ­£åˆ™è¡¨è¾¾å¼ï¼‰ã€‚è¡¨è¾¾å¼ï¼‰ã€‚å¦‚æœè¿™äº›æ¨¡å— å¦‚æœè¿™äº›æ¨¡å—å¯¹æŸäº›è®°å½•çš„ç»“æœæ²¡æœ‰ä¿¡å¿ƒï¼ŒSEED å°†æŠŠå®ƒä»¬è½¬å‘ç»™ LLM æ¨¡å—ï¼Œç”± LLM æ¨¡å—å¯¹è¿™äº›ç»“æœè¿›è¡Œåˆ†æã€‚è¯¥æ¨¡å—è™½ç„¶æˆæœ¬é«˜æ˜‚ï¼Œä½†é€šå¸¸èƒ½ è¯¥æ¨¡å—è™½ç„¶ä»·æ ¼æ˜‚è´µï¼Œä½†é€šå¸¸èƒ½å¤Ÿå¯¹æ•°æ®é¡¹æ‰§è¡Œå¤æ‚çš„ã€ç±»ä¼¼äºäººç±»æ¨ç†çš„ä»»åŠ¡ã€‚å¯¹äº å¯¹äºæ¯ä¸ªè¯·æ±‚ï¼ŒLLM æ¨¡å—å¯èƒ½ä¼šè¿›ä¸€æ­¥ä½¿ç”¨ä¸€ä¸ªæ•°æ®è®¿é—®æ¨¡å—ï¼Œè¯¥æ¨¡å—ä¼šä»ä¸€ä¸ªæ•°æ®åº“ä¸­æ£€ç´¢ç›¸å…³ä¿¡æ¯ã€‚æ¨¡å—ï¼Œä»æ•°æ®åº“æˆ–å…¶ä»–ç”¨æˆ·æä¾›çš„æ•°æ®ä¸­æ£€ç´¢ç›¸å…³ä¿¡æ¯ ç”¨æˆ·æä¾›çš„æ•°æ®ä¸­æ£€ç´¢ç›¸å…³ä¿¡æ¯ï¼Œä»¥ååŠ© LLM å®Œæˆä»»åŠ¡ã€‚åœ¨æ­¤ï¼ŒSEED åˆ©ç”¨ LLM çš„æ¨ç†èƒ½åŠ›æ¥é€ä¸ªç¡®å®š å“ªäº›é¢å¤–ä¿¡æ¯å’Œå·¥å…·å°†æœ‰åŠ©äº è§£å†³ç‰¹å®šä»»åŠ¡ è¿™æ ·ï¼ŒSEED å°±èƒ½åˆ©ç”¨ LLM çš„åˆæˆ synthesisã€æ¨ç† reasoning å’Œè¯­ä¹‰ç†è§£èƒ½åŠ›ä»¥åŠç¼–ç çš„å¸¸è¯†æ¥æ„å»ºç‰¹å®šé¢†åŸŸçš„è§£å†³æ–¹æ¡ˆã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œç”¨æˆ·æ— éœ€æ‰‹åŠ¨ç¼–ç æ¨¡å—æˆ–æ³¨é‡Šå¤§é‡è®­ç»ƒç¤ºä¾‹ã€‚æ­¤å¤–ï¼Œä¸ä¹‹å‰å°† LLM ç”¨äºæ•°æ®æ•´ç†ä»»åŠ¡çš„å·¥ä½œä¸åŒï¼ŒSEED ä¸éœ€è¦åœ¨æ¯æ¡æ•°æ®è®°å½•ä¸Šéƒ½è°ƒç”¨æ˜‚è´µçš„ LLMï¼Œå› ä¸ºåœ¨å¤„ç†å¤§å‹æ•°æ®é›†æ—¶ï¼ŒLLM ä¼šé¢ä¸´å¯æ‰©å±•æ€§ã€æ•ˆç‡å’Œæˆæœ¬é—®é¢˜ã€‚SEED åˆ†ä¸¤æ­¥è¿›è¡Œæµæ°´çº¿ç¼–è¯‘ã€‚é¦–å…ˆï¼Œç”±äºä¸åŒçš„æ¨¡å—å¯èƒ½é€‚åˆä¸åŒçš„åº”ç”¨ï¼ŒSEED ä¼šè§£æç”¨æˆ·æä¾›çš„é…ç½®æ–‡ä»¶ï¼Œç”Ÿæˆä¸€ä¸ªæ•°æ®æ•´ç†è®¡åˆ’ï¼ŒæŒ‡å®šè¦å¯ç”¨çš„æ¨¡å—ã€‚æ­£å¦‚ç¬¬ 2 ç« ä¸­è¿›ä¸€æ­¥è®¨è®ºçš„é‚£æ ·ï¼Œå¯¹äºä¸åŒçš„åº”ç”¨ï¼ŒSEED ä¼šæ ¹æ®ä»»åŠ¡ã€åº”ç”¨çš„å…·ä½“è¦æ±‚å’Œæ•°æ®çš„å±æ€§ï¼Œç”Ÿæˆä¸åŒçš„è®¡åˆ’ï¼Œè¿™äº›è®¡åˆ’ä¼šä½¿ç”¨ä¸åŒçš„æ¨¡å—ç»„åˆã€‚æ¥ä¸‹æ¥ï¼Œåœ¨ç»™å®šæ•°æ®æ•´ç†è®¡åˆ’çš„æƒ…å†µä¸‹ï¼ŒSEED ä½¿ç”¨ LLM æ„å»ºç›¸åº”çš„æ¨¡å—ï¼Œå¦‚ä»£ç ã€å°å‹æ¨¡å‹æˆ–æ•°æ®è®¿é—®æ¨¡å—ï¼Œå¹¶å°†è¿™äº›ç”Ÿæˆçš„æ¨¡å—ç»„è£…æˆå¯æ‰§è¡Œæµæ°´çº¿ï¼Œé€ä¸€å¤„ç†æ•°æ®è®°å½•ã€‚ç¬¬ 3ã€4 å’Œ 5 èŠ‚å°†è®¨è®ºè¿™äº›æ¨¡å—çš„ç»†èŠ‚ã€‚ SEED åˆ†ä¸¤æ­¥è¿›è¡Œæµæ°´çº¿ç¼–è¯‘ã€‚é¦–å…ˆï¼Œç”±äºä¸åŒçš„æ¨¡å—å¯èƒ½é€‚åˆä¸åŒçš„åº”ç”¨ï¼ŒSEED ä¼šè§£æç”¨æˆ·æä¾›çš„é…ç½®æ–‡ä»¶ï¼Œç”Ÿæˆä¸€ä¸ªæ•°æ®æ•´ç†è®¡åˆ’ï¼ŒæŒ‡å®šè¦å¯ç”¨çš„æ¨¡å—ã€‚æ­£å¦‚ç¬¬ 2 ç« ä¸­è¿›ä¸€æ­¥è®¨è®ºçš„é‚£æ ·ï¼Œå¯¹äºä¸åŒçš„åº”ç”¨ï¼ŒSEED ä¼šæ ¹æ®ä»»åŠ¡ã€åº”ç”¨çš„å…·ä½“è¦æ±‚å’Œæ•°æ®çš„å±æ€§ï¼Œç”Ÿæˆä¸åŒçš„è®¡åˆ’ï¼Œè¿™äº›è®¡åˆ’ä¼šä½¿ç”¨ä¸åŒçš„æ¨¡å—ç»„åˆã€‚ æ¥ä¸‹æ¥ï¼Œåœ¨ç»™å®šæ•°æ®æ•´ç†è®¡åˆ’çš„æƒ…å†µä¸‹ï¼ŒSEED ä½¿ç”¨ LLM æ„å»ºç›¸åº”çš„æ¨¡å—ï¼Œå¦‚ä»£ç ã€å°å‹æ¨¡å‹æˆ–æ•°æ®è®¿é—®æ¨¡å—ï¼Œå¹¶å°†è¿™äº›ç”Ÿæˆçš„æ¨¡å—ç»„è£…æˆå¯æ‰§è¡Œæµæ°´çº¿ï¼Œé€ä¸€å¤„ç†æ•°æ®è®°å½•ã€‚ç¬¬ 3ã€4 å’Œ 5 èŠ‚å°†è®¨è®ºè¿™äº›æ¨¡å—çš„ç»†èŠ‚ã€‚ ","date":"2024-03-01","objectID":"/posts/seed-paper/:3:1","tags":["Paper Reading"],"title":"Paper Reading: SEED Domain-Specific Data Curation With Large Language Models","uri":"/posts/seed-paper/"},{"categories":null,"content":"Contributions æˆ‘ä»¬çš„ä¸»è¦è´¡çŒ®åœ¨äºè¯æ˜äº† LLM èƒ½å¤Ÿä»¥ä¸€ç§å…¨æ–°çš„ã€é©å‘½æ€§çš„æ–¹æ³•æ¥å¤„ç†æ•°æ®æ•´ç†ä»»åŠ¡ã€‚ä¸ä¼ ç»Ÿçš„æ•°æ®æ•´ç†å·¥å…·ä¸åŒï¼ŒSEED çš„ç›®æ ‡ä¸æ˜¯æä¾›ç°æˆçš„è§£å†³æ–¹æ¡ˆä¾›ç”¨æˆ·åº”ç”¨äºè‡ªå·±çš„æ•°æ®é›†ã€‚ç›¸åï¼ŒSEED ä¼šæ ¹æ®ç»™å®šæ•°æ®é›†çš„å±æ€§ä»¥åŠç”¨æˆ·çš„ç‰¹å®šéœ€æ±‚ï¼Œä¸ºç»™å®šæ•°æ®é›†å³æ—¶ç¼–è¯‘å®ä¾‹ä¼˜åŒ–è§£å†³æ–¹æ¡ˆã€‚åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œç”¨æˆ·æ— éœ€ç¼–å†™ä»»ä½•ä»£ç æˆ–æ‰§è¡Œæç¤ºå·¥ç¨‹ã€‚ ä¸ºäº†éªŒè¯è¿™ä¸€æƒ³æ³•ï¼Œæˆ‘ä»¬æ„å»ºäº† SEED çš„åˆå§‹ç‰ˆæœ¬ã€‚ç»“æœä»¤äººé¼“èˆï¼šé€šè¿‡å¯¹æ„å»ºæ¨¡å—çš„ä¸€äº›åŸºæœ¬ä¼˜åŒ–ï¼ˆæˆ‘ä»¬å°†åœ¨ä¸‹æ–‡ä»‹ç»ï¼‰ï¼ŒSEED èƒ½å¤Ÿä¸ºå¤šä¸ªæ•°æ®æ•´ç†é—®é¢˜æä¾›é«˜æ•ˆã€æœ‰æ•ˆçš„è§£å†³æ–¹æ¡ˆï¼Œè¯æ˜äº†å…¶åœ¨å®è·µä¸­çš„æ½œåŠ›ã€‚ç‰¹åˆ«æ˜¯ï¼Œé€šè¿‡åœ¨ 9 ä¸ªæ•°æ®é›†ä¸Šçš„å®éªŒï¼Œæˆ‘ä»¬å‘ç° SEED æ‰€ç”Ÿæˆçš„è§£å†³æ–¹æ¡ˆå¤§å¤§ä¼˜äºé€šç”¨è§£å†³æ–¹æ¡ˆï¼Œé€šå¸¸æ¥è¿‘äºåœ¨æ•°åƒä¸ªç¤ºä¾‹ä¸­è®­ç»ƒå‡ºæ¥çš„è§£å†³æ–¹æ¡ˆçš„æ€§èƒ½ï¼Œè¿™äº›æ•°æ®é›†æ¶µç›–äº†æ•°æ®ä¼°ç®—ã€æ•°æ®æå–ã€æ•°æ®æ³¨é‡Šã€å®ä½“è§£æå’Œæ•°æ®å‘ç°ç­‰å„ç§æ•°æ®æ•´ç†ä»»åŠ¡ã€‚æ­¤å¤–ï¼Œä¸åœ¨æ¯æ¡æ•°æ®è®°å½•ä¸Šéƒ½ä½¿ç”¨ LLM çš„è§£å†³æ–¹æ¡ˆç›¸æ¯”ï¼ŒSEED å®ç°äº†æœ€å…ˆè¿›çš„æˆ–å¯ä¸ä¹‹åª²ç¾çš„ä¸€æ¬¡æ€§æ€§èƒ½ï¼ŒåŒæ—¶å¤§å¤§å‡å°‘äº†æ‰€éœ€çš„ LLM è°ƒç”¨æ¬¡æ•° æˆ‘ä»¬çš„æŠ€æœ¯è´¡çŒ®ä¸»è¦é›†ä¸­åœ¨æœ‰æ•ˆç”Ÿæˆæ¨¡å—æœ¬èº«ï¼ŒåŒ…æ‹¬ ä»£ç ç”Ÿæˆã€‚æˆ‘ä»¬æå‡ºäº†æ–°é¢–çš„æŠ€æœ¯ï¼Œä»¥è§£å†³ LLM åœ¨ç”Ÿæˆé«˜è´¨é‡å’Œç¨³å¥ä»£ç ä»¥åŠé¿å…äººå·¥æç¤ºå·¥ç¨‹å’Œè°ƒè¯•æ–¹é¢çš„å±€é™æ€§ã€‚ä¸ºäº†æ”¯æŒå…·æœ‰å¤æ‚é€»è¾‘çš„åœºæ™¯ï¼ŒSEED ç”Ÿæˆäº†ä¸€ç³»åˆ—ä»£ç ç‰‡æ®µï¼Œè¿™äº›ä»£ç ç‰‡æ®µå¯å…±åŒè§£å†³ä»»åŠ¡ï¼Œå› æ­¤æ¯”å•æ®µä»£ç æ›´å¼ºå¤§ã€‚ æ¨¡å‹ç”Ÿæˆã€‚SEED åˆ©ç”¨ä½œä¸º annotators and teachers çš„ LLM ç”Ÿæˆå°å‹æ¨¡å‹ã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬åˆ©ç”¨ LLM æä¾›æ ‡ç­¾ï¼Œä»è€Œé¿å…äº†ä¼ ç»Ÿå­¦ä¹ æ–¹æ³•ä¸­çš„äººå·¥æ ‡æ³¨å·¥ä½œã€‚æˆ‘ä»¬è®¾è®¡çš„ç®—æ³•å¯ä»¥æ˜æ™ºåœ°é€‰æ‹©è¦æäº¤ç»™ LLM çš„è®°å½•ï¼Œä»è€Œæœ€å¤§é™åº¦åœ°å‡å°‘æŸ¥è¯¢ LLM çš„é¢‘ç‡ï¼ŒåŒæ—¶æœ€å¤§é™åº¦åœ°æé«˜æ‰€å­¦å°å‹æ¨¡å‹çš„æ•ˆç‡ã€‚ æ•°æ®è®¿é—®æ¨¡å—ã€‚æˆ‘ä»¬æå‡ºäº†åŒ…æ‹¬æ‰¹é‡æŸ¥è¯¢å’Œè¿­ä»£å·¥å…·è°ƒç”¨åœ¨å†…çš„ä¼˜åŒ–æ–¹æ¡ˆï¼Œåˆ©ç”¨ä»æ•°æ®åº“ä¸­æå–çš„ç›¸å…³ä¿¡æ¯æ¥å¢å¼º LLMï¼Œä»è€Œå¤§å¤§é™ä½æ‰§è¡Œæˆæœ¬ï¼ŒåŒæ—¶æé«˜å‡†ç¡®æ€§ã€‚ ","date":"2024-03-01","objectID":"/posts/seed-paper/:3:2","tags":["Paper Reading"],"title":"Paper Reading: SEED Domain-Specific Data Curation With Large Language Models","uri":"/posts/seed-paper/"},{"categories":null,"content":"SEED OVERVIEW ä¸‹é¢æˆ‘ä»¬å°†ä»‹ç» SEED çš„æ“ä½œã€‚ User Configurationã€‚SEED é€šè¿‡ä¸€ä¸ªç®€å•çš„é…ç½®æ–‡ä»¶ä¸ç”¨æˆ·äº¤äº’ã€‚å›¾ 1 æ˜¾ç¤ºäº†å®ä½“è§£æä»»åŠ¡çš„é…ç½®ã€‚ç»™å®šä¸€ç»„å±æ€§ä¸º â€œåç§°â€ã€â€œåˆ¶é€ å•† â€œå’Œ â€œä»·æ ¼ â€œçš„äº§å“ï¼Œç”¨æˆ·éœ€è¦ç¡®å®šä¸¤ä¸ªäº§å“æ˜¯å¦æŒ‡çš„æ˜¯åŒä¸€ä»¶å•†å“ã€‚é…ç½®ä¸»è¦åŒ…æ‹¬ä¸¤éƒ¨åˆ†ï¼šï¼ˆ1ï¼‰ç”¨è‡ªç„¶è¯­è¨€æè¿°ä»»åŠ¡ã€è¾“å…¥å’Œè¾“å‡ºï¼›ï¼ˆ2ï¼‰ï¼ˆå¯é€‰ï¼‰æä¾›å¯ç”¨æ•°æ®å’Œå·¥å…·ã€‚ç”¨æˆ·é¦–å…ˆæŒ‡å®šä»»åŠ¡åç§°ã€è¾“å…¥å’Œè¾“å‡ºã€‚ä»»åŠ¡åç§°å¯ä»¥æ˜¯ä»»æ„æ–‡æœ¬ã€‚æ¯ä¸ªè¾“å…¥è¿˜åŒ…æ‹¬åç§°ã€æ•°æ®ç±»å‹å’Œè‡ªç„¶è¯­è¨€æè¿°ï¼Œä¾‹å¦‚ï¼Œæè¿°å¯ä»¥åŒ…å«ç”¨æˆ·å¯¹å±æ€§çš„é¢†åŸŸçŸ¥è¯†ã€‚ç”¨æˆ·ä»¥åŒæ ·çš„æ–¹å¼å®šä¹‰è¾“å‡ºã€‚ç”¨æˆ·è¿˜å¯ä»¥é€‰æ‹©æä¾›æ›´å¤šçš„é¢†åŸŸçŸ¥è¯†ã€‚è¿™å¯ä»¥é€šè¿‡è‡ªç„¶è¯­è¨€æè¿°ã€ä¾› SEED ä½¿ç”¨çš„ API å½¢å¼çš„è‡ªå®šä¹‰å·¥å…·æˆ–åŒ…å«ç¤ºä¾‹çš„æ•°æ®æ–‡ä»¶ï¼ˆæ— è®ºæ˜¯å¦åŠ æ³¨ï¼‰æ¥å®ç°ã€‚ å¯¹äºå¸¸è§çš„æ•°æ®æ•´ç†ä»»åŠ¡ï¼ŒåŒ…æ‹¬æ•°æ®æå–ã€æ•°æ®å‘ç°ã€å®ä½“è§£æã€æ•°æ®ä¼°ç®—å’Œæ•°æ®å‘ç°ï¼ŒSEED æä¾›å†…ç½®é…ç½®æ¨¡æ¿ã€‚è¿™äº›æ¨¡æ¿ä¼šè‡ªåŠ¨å¡«å……é…ç½®æ–‡ä»¶ä¸­çš„æ‰€éœ€å­—æ®µï¼Œç”¨æˆ·å¯æ ¹æ®éœ€è¦å¯¹å…¶è¿›è¡Œè°ƒæ•´ã€‚åœ¨ä¸Šè¿°å®ä½“è§£æä»»åŠ¡ä¸­ï¼Œæ¨¡æ¿ä¼šåœ¨è¾“å…¥å­—æ®µä¸­å¡«å……ä¸¤ä¸ªå®ä½“ï¼Œå¹¶åœ¨è¾“å‡ºå­—æ®µä¸­å¡«å……ä»¥ä¸‹ä¿¡æ¯ï¼š â€œåç§°ï¼šis_sameï¼›ç±»å‹ï¼šboolï¼›æè¿°ï¼šå¦‚æœä¸¤ä¸ªæ ‡é¢˜ç›¸åŒï¼Œåˆ™ä¸º 1ï¼š å¦‚æœä¸¤ä¸ªæ ‡é¢˜ç›¸åŒï¼Œåˆ™ä¸º 1ï¼Œå¦åˆ™ä¸º 0â€ã€‚é€‰æ‹©å®ä½“è§£ææ¨¡æ¿åï¼Œç”¨æˆ·åªéœ€é€‰æ‹©æ€§åœ°æä¾›æç¤ºå’Œä¸€äº›ç¤ºä¾‹ Compilation. ç”¨æˆ·å®Œæˆé…ç½®åï¼ŒSEED ä¼šå°†å…¶ç¼–è¯‘æˆç¬¦åˆç”¨æˆ·è§„èŒƒçš„åŠŸèƒ½ APIï¼ˆä¾‹å¦‚ï¼Œåœ¨å›¾ 1 ä¸­çš„ç¤ºä¾‹ä¸­ï¼Œç”Ÿæˆäº†ä¸€ä¸ªå‡½æ•° entity_resolution(entity1ï¼Œentity2) â†’is_sameï¼‰ã€‚è¯¥å‡½æ•°ä»¥æ•°æ®è®°å½•å¯¹çš„æ ¼å¼æ¥æ”¶æ•°æ®ï¼Œå¹¶è¾“å‡ºä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå…¶ä¸­ä¸€å¯¹æ˜¯å¦åŒ¹é…ã€‚ SEED åˆ†ä¸¤æ­¥ç¼–è¯‘è§£å†³æ–¹æ¡ˆï¼š (1) åˆ¶å®šæ•°æ®æ•´ç†è®¡åˆ’ï¼Œç¡®å®šå¯ç”¨å“ªäº›æ¨¡å— (2) æ„å»ºæ¨¡å—å¹¶å°†è¿™äº›æ¨¡å—è¿æ¥åˆ°å¯æ‰§è¡Œç®¡é“ä¸­ã€‚ (1) åˆ¶å®šæ•°æ®ç®¡ç†è®¡åˆ’ã€‚é’ˆå¯¹ä¸åŒçš„ä»»åŠ¡å’Œæ•°æ®é›†ï¼ŒSEED ä½¿ç”¨åŸºäºè§„åˆ™çš„æ–¹æ³•æ¥ç”Ÿæˆä¸åŒçš„è®¡åˆ’ï¼Œå¹¶ä½¿ç”¨ä¸åŒçš„æ¨¡å—ç»„åˆã€‚ ä½œä¸ºé«˜çº§ä½†æ˜‚è´µçš„æ•°æ®åˆ†æå·¥å…·ï¼ŒLLM æ¨¡å—è¢«é»˜è®¤é€‰æ‹©ä¸ºè½»é‡çº§ä»£ç å’Œå°å‹æ¨¡å‹æ¨¡å—çš„å¤‡ç”¨æ¨¡å—ã€‚ä¸€äº›éœ€è¦è¯­ä¹‰ç†è§£èƒ½åŠ›çš„å¤æ‚ä»»åŠ¡å¯èƒ½ä¼šå•ç‹¬ä½¿ç”¨ LLM æ¨¡å—ï¼Œä¾‹å¦‚ï¼Œåœ¨æ•°æ®å‘ç°ä¸­ï¼Œæ¨ç†ä¸€ä¸ªè¡¨æ˜¯å¦ä¸ç”¨æˆ·çš„é—®é¢˜ç›¸å…³æ˜¯ LLM æ¯”ç®€å•æ–¹æ³•æ›´å…·ä¼˜åŠ¿çš„é¢†åŸŸ ä»£ç æ¨¡å—é€‚ç”¨äºæ•°æ®æ•´ç†ä»»åŠ¡ï¼Œåœ¨è¿™äº›ä»»åŠ¡ä¸­ï¼Œå¤§å¤šæ•°æƒ…å†µéƒ½å¯ä»¥ä½¿ç”¨åŸºäºè§„åˆ™çš„æ–¹æ³•æœ‰æ•ˆè§£å†³ï¼Œä¾‹å¦‚æ•°æ®æ¸…ç†å’Œæ•°æ®æå–ã€‚ä¾‹å¦‚ï¼Œåœ¨åŸºäºé¢†åŸŸçŸ¥è¯†çš„æ•°æ®æ¸…ç†ä¸­ï¼Œç”¨æˆ·é€šå¸¸ä¼šå‡å®šæ­£å¸¸æ•°æ®ä¸­å­˜åœ¨ä¸€äº›æœ‰è§„å¾‹çš„æ¨¡å¼ï¼Œå¹¶å°†é”™è¯¯è¯†åˆ«ä¸ºè¿åè¿™äº›æ¨¡å¼çš„æ•°æ®è®°å½•ã€‚æ­£å¦‚æˆ‘ä»¬åœ¨æ•°æ®ä¼°ç®—ä»»åŠ¡ï¼ˆç¬¬ 6.1 èŠ‚ï¼‰ä¸­çš„å®éªŒæ‰€è¯å®çš„é‚£æ ·ï¼Œç”± LLM ç”Ÿæˆçš„å°ç¨‹åºå¯ä»¥æœ‰æ•ˆåœ°å®ç°è¿™ä¸€é€»è¾‘ Small model modules å°å‹æ¨¡å‹æ¨¡å—é€‚ç”¨äºå¯å»ºæ¨¡ä¸ºé¢„æµ‹æˆ–ç”Ÿæˆæœºå™¨å­¦ä¹ ä»»åŠ¡çš„æ•°æ®æ•´ç†ä»»åŠ¡ã€‚ä¾‹å¦‚ï¼Œå®ä½“è§£æå¯è§†ä¸ºä¸€ä¸ªåˆ†ç±»é—®é¢˜ï¼Œå®ƒå°†ä¸€å¯¹å¯¹è±¡åˆ†ä¸ºåŒ¹é…æˆ–ä¸åŒ¹é…ï¼Œè€Œæ•°æ®ä¼°ç®—å¯è§†ä¸ºä¸€ä¸ªç”Ÿæˆé—®é¢˜ï¼Œå®ƒæ ¹æ®ä¸Šä¸‹æ–‡ç”Ÿæˆç¼ºå¤±çš„å±æ€§ã€‚è¿™äº›é—®é¢˜å¯ä»¥é€šè¿‡æœºå™¨å­¦ä¹ æ¨¡å‹å¾ˆå¥½åœ°è§£å†³ï¼Œè¯¥æ¨¡å‹ç”± LLM ç”Ÿæˆçš„ç¤ºä¾‹æˆ–ç”¨æˆ·æä¾›çš„ç¤ºä¾‹è®­ç»ƒè€Œæˆ Data access modules æ•°æ®è®¿é—®æ¨¡å—æ€»æ˜¯ä¸ LLM æ¨¡å—è€¦åˆåœ¨ä¸€èµ·ã€‚å®ƒä»¬å¯¹äºéœ€è¦å¤§é‡æ•°æ®è®¿é—®çš„ä»»åŠ¡ç‰¹åˆ«æœ‰ç”¨ã€‚ä¾‹å¦‚ï¼Œæ•°æ®å‘ç°éœ€è¦æœç´¢ä¼ä¸šæ•°æ®ï¼Œä»¥å‘ç°ä¸ç”¨æˆ·é—®é¢˜æœ€ç›¸å…³çš„æ•°æ®ã€‚SEED æä¾›äº†ä¸€å¥—ä¸“é—¨ç”¨äºæ•°æ®åº“æ“ä½œçš„é¢„å®šä¹‰å·¥å…·ã€‚æ­¤å¤–ï¼Œå®ƒè¿˜å…è®¸ä½¿ç”¨å…¶ä»–æ¨¡å—ï¼ˆä»£ç æˆ–å°å‹æ¨¡å‹ï¼‰ä½œä¸ºå·¥å…·ï¼Œä»¥åŠç”¨æˆ·æä¾›çš„å…¶ä»–å·¥å…·ã€‚è¦åœ¨æ•°æ®è®¿é—®æ¨¡å—ä¸­æ³¨å†Œå·¥å…·ï¼Œç”¨æˆ·åªéœ€å‘ŠçŸ¥ SEED å·¥å…·çš„ API å¹¶æä¾›ç®€è¦è¯´æ˜å³å¯ã€‚ é™¤äº†ä»»åŠ¡ä¹‹å¤–ï¼Œåœ¨åˆ¶å®šæ•°æ®æ•´ç†è®¡åˆ’æ—¶ï¼ŒSEED è¿˜ä¼šè€ƒè™‘ç‰¹å®šé¢†åŸŸçš„è¦æ±‚æˆ–æ•°æ®çš„ç‹¬ç‰¹å±æ€§ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç”¨æˆ·åœ¨æè¿°ä»–ä»¬çš„å®ä½“è§£æä»»åŠ¡æ—¶æå‡ºäº†ä¸€äº›å¯ä»¥ç”¨è§„åˆ™è½»æ¾è¡¨è¾¾çš„ç‰¹å®šè¦æ±‚ï¼Œå¦‚äº§å“è¡¨ä¸­çš„ä¸¤æ¡è®°å½•å¦‚æœä»·æ ¼ä¸åŒå°±ä¸å±äºåŒä¸€é¡¹ç›®ï¼Œé‚£ä¹ˆ SEED å°±ä¼šç”Ÿæˆä¸€ä¸ªé¦–å…ˆä½¿ç”¨ä»£ç æ¨¡å—è€Œä¸æ˜¯å°æ¨¡å‹çš„è®¡åˆ’ã€‚è¿™å†æ¬¡åˆ©ç”¨äº† LLM çš„è¯­ä¹‰ç†è§£èƒ½åŠ›ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒSEED ä½¿ç”¨ LLM æ¥å¢å¼ºåŸºäºè§„åˆ™çš„æ–¹æ³•ã€‚å®ƒè¯»å–ä»»åŠ¡æè¿°ï¼Œè¯„ä¼°åŸºäºè§„åˆ™çš„æ–¹æ³•ç”Ÿæˆçš„è®¡åˆ’ï¼Œå¹¶åœ¨å¿…è¦æ—¶å¯¹å…¶è¿›è¡Œä¿®æ”¹ (2) æ„å»ºå¯æ‰§è¡Œç®¡é“ã€‚ç”Ÿæˆæ•°æ®æ•´ç†è®¡åˆ’åï¼ŒSEED ä¼šä½¿ç”¨ LLM æ¥å¸®åŠ©æ„å»ºè®¡åˆ’ä¸­çš„æ¨¡å—ï¼Œå¹¶å°†å®ƒä»¬é“¾æ¥åˆ°å¯æ‰§è¡Œç®¡é“ä¸­ï¼Œä»è€ŒåŠ¨æ€åè°ƒæ¨¡å—ä¹‹é—´çš„å…³ç³»ã€‚å¯¹äºä½¿ç”¨ä»£ç æ¨¡å—çš„è®¡åˆ’ï¼ŒSEED é¦–å…ˆä½¿ç”¨é¢„å®šä¹‰æ¨¡æ¿å°†é…ç½®æ–‡ä»¶è½¬æ¢ä¸ºä»»åŠ¡æè¿°æç¤ºã€‚ç„¶åå°†è¯¥æç¤ºå‘é€åˆ° LLMï¼Œç”Ÿæˆä¸€ç³»åˆ—è‡ªåŠ¨è¯„ä¼°å’Œå®Œå–„çš„ä»£ç ç‰‡æ®µï¼ˆç¬¬ 3 ç« ï¼‰ã€‚è¿™æ ·å°±ç”Ÿæˆäº†ä¸€ä¸ªå¯è°ƒç”¨çš„æ–¹æ³•ï¼Œå¦‚å®ä½“è§£å†³ä»£ç ï¼ˆentity_resolution_code()ï¼‰ã€‚åŒæ ·ï¼Œå¯¹äºå…·æœ‰å°å‹æ¨¡å‹çš„è®¡åˆ’ï¼ŒSEED ä¼šç”Ÿæˆä¸€ä¸ªæç¤ºæ¨¡æ¿ï¼Œè¯·æ±‚ LLM å¯¹æ•°æ®è¿›è¡Œæ³¨é‡Šï¼Œç„¶åç”Ÿæˆä¸€ä¸ªå¯è°ƒç”¨çš„æ–¹æ³•ï¼Œä¾‹å¦‚ entity_resolution_model()ï¼Œè¯¥æ–¹æ³•ä¸åœ¨ LLM æ³¨é‡Šæ•°æ®ä¸Šè®­ç»ƒçš„å°å‹æ¨¡å‹ç›¸å¯¹åº”ï¼ˆç¬¬ 4 èŠ‚ï¼‰ã€‚å¯¹äºå¯ç”¨äº†æ•°æ®è®¿é—®æ¨¡å—çš„è®¡åˆ’ï¼ŒSEED ä¼šç”Ÿæˆä¸€ä¸ªæç¤ºï¼Œå°† LLM è¿æ¥åˆ°ä¸ç»™å®šä»»åŠ¡ç›¸å…³çš„æ•°æ®è®¿é—®æ¥å£ï¼Œå¹¶ä¸º LLM é€‰æ‹©æ€§åœ°ä½¿ç”¨è¿™äº›æ¥å£æå–æ•°æ®ç¼–åˆ¶ä¸€ä¸ªè¿­ä»£è¿‡ç¨‹ï¼ˆç¬¬ 5.2 èŠ‚ï¼‰ã€‚è¿™ä¹Ÿä¼šç”Ÿæˆä¸€ä¸ªå¯è°ƒç”¨çš„æ–¹æ³•ï¼Œå¦‚ entity_resolution_da()ã€‚æœ€ç»ˆï¼ŒSEED å°†è¿™äº›å†…éƒ¨æ–¹æ³•è°ƒç”¨è¿æ¥èµ·æ¥ï¼Œç”Ÿæˆä¸€ä¸ªæœ€ç»ˆæ–¹æ³•ï¼Œä¾‹å¦‚ï¼Œentity_resolution(entity1, entity2) â†’ is_same è¯·æ³¨æ„ï¼Œè™½ç„¶è¿™ä¸æ˜¯æœ¬æ–‡çš„é‡ç‚¹ï¼Œä½†æˆ‘ä»¬åœ¨ SEED ä¸­èŠ±è´¹äº†å¤§é‡ç²¾åŠ›ï¼Œç²¾å¿ƒè®¾è®¡äº†åŠ¨æ€æç¤ºç»„æˆæ¨¡æ¿ï¼Œè¿™äº›æ¨¡æ¿åœ¨è¿™äº›ç±»å‹çš„æ•°æ®æ•´ç†ä»»åŠ¡ä¸­æ™®éè¡¨ç°è‰¯å¥½ï¼Œä»è€Œæ¶ˆé™¤äº†ç”¨æˆ·å¯¹æç¤ºå·¥ç¨‹çš„éœ€æ±‚ã€‚æœ‰å…³æç¤ºæ¨¡æ¿ï¼Œè¯·å‚é˜…æ‰©å±•ç‰ˆé™„å½• D [36]ã€‚ æ¨¡å—æ‰§è¡Œã€‚ç”Ÿæˆçš„æ–¹æ³•æ ¹æ®æ•°æ®æ•´ç†è®¡åˆ’ä¾æ¬¡æ‰§è¡Œæ¨¡å—ï¼Œé€ä¸€å¤„ç†æ¯æ¡æ•°æ®è®°å½•ã€‚æ¯ä¸ªæ¨¡å—å†³å®šæ˜¯ç›´æ¥è¿”å›ç»“æœè¿˜æ˜¯å°†ç»“æœä¼ é€’ç»™ä¸‹ä¸€ä¸ªæ¨¡å—ã€‚å¯¹äºä»£ç æ¨¡å—ï¼Œå½“é‡åˆ°ä¸ç¡®å®šçš„æƒ…å†µæ—¶ï¼Œç”Ÿæˆçš„ä»£ç ç‰‡æ®µä¼šè¢«æ˜ç¡®æŒ‡ç¤ºæ”¾å¼ƒï¼ˆç¬¬ 3.1 èŠ‚ï¼‰ï¼Œè¿™äº›ä»£ç ç‰‡æ®µå°†ç»§ç»­æµå‘ä¸‹ä¸€ä¸ªæ¨¡å—ï¼Œè€Œå°æ¨¡å‹æ¨¡å—åœ¨äº§ç”Ÿç½®ä¿¡åº¦è¾ƒä½çš„é¢„æµ‹ç»“æœæ—¶ä¼šæ”¾å¼ƒï¼ˆç¬¬ 4.2 èŠ‚ï¼‰ã€‚æ•°æ®è®¿é—®æ¨¡å—ä»æ•°æ®ä¸­æ£€ç´¢ç›¸å…³ä¿¡æ¯ï¼Œå¹¶å°†å…¶ä¼ é€’ç»™ LLMï¼Œå› ä¸ºå®ƒå§‹ç»ˆä¸ LLM æ¨¡å—è€¦åˆã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ä»‹ç»æ„å»ºå•ä¸ªä»£ç æ¨¡å—ã€å°å‹æ¨¡å‹æ¨¡å—å’Œæ•°æ®è®¿é—®æ¨¡å—çš„æŠ€æœ¯ã€‚ ","date":"2024-03-01","objectID":"/posts/seed-paper/:4:0","tags":["Paper Reading"],"title":"Paper Reading: SEED Domain-Specific Data Curation With Large Language Models","uri":"/posts/seed-paper/"},{"categories":null,"content":"CODE GENERATION å°½ç®¡ä½¿ç”¨ LLM ç”Ÿæˆä»£ç å¸å¼•äº†å¤§é‡å…³æ³¨ï¼Œä½†å®ƒä¹Ÿé¢ä¸´ç€æŒ‘æˆ˜ã€‚LLM é€šå¸¸éš¾ä»¥ç”Ÿæˆé«˜è´¨é‡å’Œå¥å£®çš„ä»£ç  ã€‚åŒæ—¶ï¼Œæç¤ºå·¥ç¨‹å’Œæ‰‹åŠ¨éªŒè¯ç”Ÿæˆä»£ç çš„æ­£ç¡®æ€§éœ€è¦æŠ•å…¥å¤§é‡æ—¶é—´ï¼Œè¿™ä½¿å¾— LLM ç”Ÿæˆä»£ç çš„æ•ˆç‡è¾ƒä½ã€‚æ­¤å¤–ï¼ŒLLM é€šå¸¸æ˜¯åœ¨å°å‹ä»£ç ç”Ÿæˆä»»åŠ¡ä¸­è¿›è¡Œè¯„ä¼°ï¼Œåœ¨ç”Ÿæˆå¤§å‹åº”ç”¨æˆ–éœ€è¦å¤æ‚é€»è¾‘çš„ç¨‹åºæ—¶ä»æœ‰å›°éš¾ã€‚ä¸è¿‡ï¼Œä¸€äº›å¤æ‚çš„æ•°æ®æ•´ç†ä»»åŠ¡å¯èƒ½éœ€è¦å®ç°ä¸å¤šä¸ªç»„åˆè§„åˆ™ç›¸å¯¹åº”çš„å¤æ‚é€»è¾‘ã€‚ä¾‹å¦‚ï¼Œä»éç»“æ„åŒ–æ•°æ®ä¸­æå–å¤šç§ç±»å‹ç›®æ ‡ä¿¡æ¯çš„æ•°æ®æå–ï¼ˆå¦‚ä» HTML æ–‡ä»¶ä¸­æŠ“å–æ•°æ®è®°å½•ï¼‰å¾ˆéš¾é€šè¿‡å•ä¸ªä»£ç ç‰‡æ®µå®Œæˆ SEED ä½¿ç”¨ä¸¤ç§æŠ€æœ¯æ¥åº”å¯¹ä¸Šè¿°æŒ‘æˆ˜ï¼Œå®ƒä»¬å…±åŒæé«˜äº†ç”Ÿæˆä»£ç çš„å‡†ç¡®æ€§å’Œç¨³å¥æ€§ï¼ŒåŒæ—¶æœ€å¤§é™åº¦åœ°å‡å°‘äº†äººåŠ›ã€‚é¦–å…ˆï¼Œå»ºè®®ä»£ç ç”Ÿæˆä¸éªŒè¯å°†ä»£ç ç”Ÿæˆå’Œè°ƒè¯•ä½œä¸ºä¸€ä¸ªç»Ÿä¸€çš„äº¤äº’è¿‡ç¨‹ï¼Œå……åˆ†åˆ©ç”¨äº† LLM çš„æ¨ç†èƒ½åŠ›ã€‚è¿™ä¸€è¿‡ç¨‹æ˜¯è‡ªåŠ¨çš„ï¼ŒåŒæ—¶ä¿è¯äº†ä»£ç çš„è´¨é‡ã€‚å…¶æ¬¡ï¼Œä»£ç é›†åˆä¸æ¼”åŒ–å¯ä»¥äº§ç”Ÿä¸€ç»„ç›¸äº’è¡¥å¿çš„ä»£ç ç‰‡æ®µã€‚è¿™æ ·ï¼Œä»£ç ç»„åˆå°±èƒ½æœ‰æ•ˆå¤„ç†ç¨‹åºä¸­éœ€è¦å¤æ‚é€»è¾‘çš„æƒ…å†µã€‚æˆ‘ä»¬è®¾è®¡äº†ä¸€ç§è¿›åŒ–æ–¹æ³•æ¥è¿­ä»£ä¼˜åŒ–ä»£ç é›†åˆã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†è¯¦ç»†é˜è¿°è¿™ä¸¤ç§æŠ€æœ¯ã€‚ ","date":"2024-03-01","objectID":"/posts/seed-paper/:5:0","tags":["Paper Reading"],"title":"Paper Reading: SEED Domain-Specific Data Curation With Large Language Models","uri":"/posts/seed-paper/"},{"categories":null,"content":"Code Generation with Advising and Validation ","date":"2024-03-01","objectID":"/posts/seed-paper/:5:1","tags":["Paper Reading"],"title":"Paper Reading: SEED Domain-Specific Data Curation With Large Language Models","uri":"/posts/seed-paper/"},{"categories":null,"content":"â€¦ è¿™ç¯‡æ–‡ç« çš„é‡ç‚¹åœ¨æˆ‘çœ‹æ¥æ˜¯ä»–ä»¬çš„ Cache è®¾è®¡ï¼Œç»“åˆ Local LM æ˜¾è‘—é™ä½å¯¹ LLM/GPT-4 çš„è°ƒç”¨ï¼ŒåŒæ—¶ä¿è¯äº†ç²¾åº¦ï¼Œä½†æ˜¯è®ºæ–‡å†™å¾—æœ‰ç‚¹å¤šè€Œä¸”ä¸å®¹æ˜“è¯»ï¼Œåˆ‡å…¥çš„è§’åº¦æ˜¯ data curation ä»»åŠ¡ï¼Œæ²¡æœ‰æ¥è§¦è¿‡å°±æš‚æ—¶ä¸è¯»äº†ã€‚ä»£ç ç”Ÿæˆéƒ¨åˆ†ä¹Ÿåº”è¯¥æœ‰æ„æ€ï¼Œå›å¤´ç ”ç©¶ä¸‹ä»–ä»¬çš„ä»£ç ã€‚ ","date":"2024-03-01","objectID":"/posts/seed-paper/:5:2","tags":["Paper Reading"],"title":"Paper Reading: SEED Domain-Specific Data Curation With Large Language Models","uri":"/posts/seed-paper/"},{"categories":null,"content":"AnalyticDB-V: A Hybrid Analytical Engine Towards Query Fusion for Structured and Unstructured Data ","date":"2024-02-25","objectID":"/posts/analyticdb-paper/:1:0","tags":["Paper Reading"],"title":"Paper Reading: AnalyticDB-V","uri":"/posts/analyticdb-paper/"},{"categories":null,"content":"ABSTRACT éšç€éç»“æ„åŒ–æ•°æ®çš„çˆ†ç‚¸æ€§å¢é•¿ï¼ˆä¾‹å¦‚å›¾åƒï¼Œè§†é¢‘å’ŒéŸ³é¢‘ï¼‰ï¼Œéç»“æ„åŒ–æ•°æ®åˆ†æåœ¨çœŸå®ä¸–ç•Œåº”ç”¨çš„ä¸°å¯Œè„‰ç»œä¸­å¹¿æ³›å­˜åœ¨ã€‚è®¸å¤šæ•°æ®åº“ç³»ç»Ÿå¼€å§‹åˆå¹¶éç»“æ„åŒ–æ•°æ®åˆ†æä»¥æ»¡è¶³æ­¤ç±»éœ€æ±‚ã€‚ä½†æ˜¯ï¼Œåœ¨å¤§å¤šæ•°ç³»ç»Ÿä¸­ï¼Œå¯¹éç»“æ„åŒ–å’Œç»“æ„åŒ–æ•°æ®çš„æŸ¥è¯¢é€šå¸¸è¢«è§†ä¸º disjoint tasksï¼Œåœ¨å¤§å¤šæ•°ç³»ç»Ÿä¸­ï¼Œæ··åˆæŸ¥è¯¢ï¼ˆå³æ¶‰åŠä¸¤ç§æ•°æ®ç±»å‹ï¼‰å°šæœªå¾—åˆ°å……åˆ†æ”¯æŒã€‚ åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬åœ¨é˜¿é‡Œå·´å·´ï¼ˆAnalyticDB-Vï¼ˆADBVï¼‰ï¼‰æå‡ºäº†ä¸€ç§æ··åˆåˆ†æå¼•æ“ï¼Œä»¥æ»¡è¶³è¿™ç§æ–°å…´éœ€æ±‚ã€‚ADBV æä¾›ä¸€ä¸ªæ¥å£ï¼Œè¯¥æ¥å£é€šè¿‡å°†éç»“æ„åŒ–æ•°æ®è½¬æ¢ä¸ºé«˜ç»´ vectorsï¼Œä»¥ä½¿ç”¨ SQL è¯­ä¹‰æ¥è¡¨è¾¾æ··åˆæŸ¥è¯¢ã€‚ADBVA é‡‡ç”¨ lambda æ¡†æ¶å¹¶åˆ©ç”¨äº†è¿‘ä¼¼æœ€è¿‘çš„é‚»å±…æœç´¢ï¼ˆANNï¼‰æŠ€æœ¯çš„ä¼˜ç‚¹æ¥æ”¯æŒæ··åˆæ•°æ®åˆ†æã€‚æ­¤å¤–ï¼Œæå‡ºäº†ä¸€ç§æ–°é¢–çš„ ANNS ç®—æ³•æ¥æé«˜ä»£è¡¨å¤§é‡éç»“æ„åŒ–æ•°æ®çš„å¤§å‹å‘é‡çš„å‡†ç¡®æ€§ã€‚æ‰€æœ‰ ANNS ç®—æ³•å‡åœ¨ ADBV ä¸­ä½œä¸ºç‰©ç†è¿è¥å•†å®æ–½ï¼ŒåŒæ—¶æå‡ºäº†åŸºäºæˆæœ¬çš„ä¼˜åŒ–æŠ€æœ¯ï¼Œä»¥ç¡®å®šæœ‰æ•ˆçš„æ‰§è¡Œè®¡åˆ’ã€‚å¯¹å…¬å…±å’Œå†…éƒ¨æ•°æ®é›†çš„å®éªŒç»“æœè¡¨æ˜ï¼ŒADBV åŠå…¶æœ‰æ•ˆæ€§æ‰€å–å¾—çš„å‡ºè‰²æ€§èƒ½ã€‚ADBVHA å·²æˆåŠŸéƒ¨ç½²åœ¨é˜¿é‡Œå·´å·´äº‘ä¸Šï¼Œä¸ºå„ç§ç°å®ä¸–ç•Œåº”ç”¨æä¾›äº†æ··åˆæŸ¥è¯¢å¤„ç†æœåŠ¡ã€‚ ","date":"2024-02-25","objectID":"/posts/analyticdb-paper/:2:0","tags":["Paper Reading"],"title":"Paper Reading: AnalyticDB-V","uri":"/posts/analyticdb-paper/"},{"categories":null,"content":"INTRODUCTION ç”±äºæ™ºèƒ½æ‰‹æœºï¼Œç›‘è§†è®¾å¤‡å’Œç¤¾äº¤åª’ä½“çš„æµè¡Œï¼Œæ¯å¤©éƒ½ä¼šç”Ÿæˆå¤§é‡çš„éç»“æ„åŒ–æ•°æ®ï¼Œä¾‹å¦‚å›¾åƒï¼Œè§†é¢‘å’ŒéŸ³é¢‘ã€‚ä¾‹å¦‚ï¼Œåœ¨ 2019 å¹´å•èº«æ—¥çš„å…¨çƒè´­ç‰©èŠ‚æœŸé—´ï¼Œé«˜è¾¾ 500ï¼…çš„éç»“æ„åŒ–æ•°æ®è¢«çº³å…¥é˜¿é‡Œå·´å·´çš„æ ¸å¿ƒå­˜å‚¨ç³»ç»Ÿã€‚ä¸ºäº†ä¿ƒè¿›å¯¹éç»“æ„åŒ–æ•°æ®çš„åˆ†æï¼Œé€šå¸¸åˆ©ç”¨åŸºäºå†…å®¹çš„æ£€ç´¢ç³»ç»Ÿã€‚åœ¨è¿™äº›ç³»ç»Ÿä¸­ï¼Œé¦–å…ˆå°†æ¯ä¸ªéç»“æ„åŒ–æ•°æ®ï¼ˆä¾‹å¦‚ï¼Œå›¾åƒï¼‰è½¬æ¢ä¸ºé«˜ç»´ç‰¹å¾å‘é‡ï¼Œç„¶ååœ¨è¿™äº›å‘é‡ä¸Šè¿›è¡Œåç»­æ£€ç´¢ã€‚è¿™ç§å‘é‡æ£€ç´¢åœ¨å„ç§é¢†åŸŸéƒ½å¹¿æ³›ï¼Œä¾‹å¦‚é¢éƒ¨è¯†åˆ«ï¼Œäºº/è½¦è¾†é‡æ–°è¯†åˆ«ï¼Œæ¨èå’Œè¯­éŸ³è¯†åˆ«è¯†åˆ«ã€‚åœ¨é˜¿é‡Œå·´å·´ï¼Œæˆ‘ä»¬è¿˜åœ¨ç”Ÿäº§ç³»ç»Ÿä¸­é‡‡ç”¨è¿™ç§æ–¹æ³•ã€‚ å°½ç®¡åŸºäºå†…å®¹çš„æ£€ç´¢ç³»ç»Ÿæ”¯æŒæœªç»æ£€æµ‹çš„æ•°æ®åˆ†æï¼Œä½†åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œç”±äºå„ç§åŸå› ï¼Œéƒ½åº” jointly queried éç»“æ„åŒ–å’Œç»“æ„åŒ–æ•°æ®ï¼ˆæˆ‘ä»¬ç§°å®ƒä»¬ä¸ºæ··åˆæŸ¥è¯¢ï¼‰ã€‚é¦–å…ˆï¼Œå¯¹éç»“æ„åŒ–æ•°æ®çš„æŸ¥è¯¢å¯èƒ½ä¸è¶³ä»¥æè¿°æ‰€éœ€çš„å¯¹è±¡ï¼Œå…¶ä¸­æ··åˆæŸ¥è¯¢æœ‰åŠ©äºè¯æ˜å…¶è¡¨ç°åŠ›ã€‚ä¾‹å¦‚ï¼Œåœ¨æ·˜å®ï¼ˆTaobaoï¼‰ç­‰ç”µå­å•†åŠ¡å¹³å°ä¸Šï¼Œä¸€ä¸ªæ½œåœ¨çš„å®¢æˆ·å¯ä»¥å¯»æ‰¾ä»·æ ¼ï¼ˆä¸åˆ° 100 ç¾å…ƒï¼‰ï¼Œå‘è´§ï¼ˆfree-shippingï¼‰ï¼Œè¯„çº§ï¼ˆè¶…è¿‡ 4.5ï¼‰å’Œæ ·å¼çš„è¿è¡£è£™ï¼ˆè§†è§‰ä¸Šç±»ä¼¼ç”µå½±æ˜æ˜Ÿç©¿ç€çš„è¡£æœï¼‰ã€‚å…¶æ¬¡ï¼Œæœ€å…ˆè¿›çš„ç‰¹å¾çŸ¢é‡æå–ç®—æ³•çš„å‡†ç¡®æ€§è¿œéä»¤äººæ»¡æ„ï¼Œå°¤å…¶æ˜¯åœ¨å¤§å‹æ•°æ®é›†ä¸Šï¼Œæ··åˆæŸ¥è¯¢æœ‰åŠ©äºæé«˜å‡†ç¡®æ€§ã€‚å¯¹äºæ£€æŸ¥ï¼Œå½“å›¾åƒæ•°é‡ä» 0.64 milion ç¼©æ”¾åˆ° 1200 ä¸‡æ—¶ï¼Œfalse-negative è¯†åˆ«ç‡å¢åŠ äº† 40 å€ã€‚å› æ­¤ï¼Œå¯¹ç»“æ„åŒ–å±æ€§ï¼ˆä¾‹å¦‚æ€§åˆ«ï¼Œå¹´é¾„ï¼Œå›¾åƒæ•è·çš„ä½ç½®ï¼Œæ—¶é—´æˆ³ï¼‰å¯¹çŸ¢é‡æœç´¢ç©ºé—´ç¼©å°å¹¶æœ‰æ•ˆæé«˜å‡†ç¡®æ€§å¯ä»¥æ–½åŠ çº¦æŸã€‚æ€»è€Œè¨€ä¹‹ï¼Œæ··åˆæŸ¥è¯¢å¯¹å¤§é‡æ–°å…´åº”ç”¨ç¨‹åºå…·æœ‰å¾ˆé«˜çš„ä»·å€¼ã€‚ ä½†æ˜¯ï¼Œå¤§å¤šæ•°ç°æœ‰ç³»ç»Ÿä¸æä¾›æ··åˆæŸ¥è¯¢çš„ native supportã€‚å¼€å‘äººå‘˜å¿…é¡»ä¾é ä¸¤ä¸ªéš”ç¦»å¼•æ“æ¥è¿›è¡Œæ··åˆæŸ¥è¯¢å¤„ç†ï¼šçŸ¢é‡ç›¸ä¼¼æ€§æœç´¢å¼•æ“ç”¨äºéç»“æ„åŒ–æ•°æ®å’Œç”¨äºç»“æ„åŒ–æ•°æ®çš„æ•°æ®åº“ç³»ç»Ÿã€‚è¿™ç§åšæ³•å…·æœ‰å›ºæœ‰çš„å±€é™æ€§ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å¿…é¡»åœ¨ä¸¤ä¸ªç³»ç»Ÿä¸Šå®ç°é¢å¤–çš„é€»è¾‘å’Œ post-processing åæœŸå¤„ç†æ­¥éª¤ï¼Œä»¥ç¡®ä¿æ•°æ®ä¸€è‡´æ€§å’ŒæŸ¥è¯¢æ­£ç¡®æ€§ã€‚å…¶æ¬¡ï¼Œæ··åˆæŸ¥è¯¢ä¸èƒ½è”åˆä¼˜åŒ–ï¼Œå› ä¸ºå­æŸ¥è¯¢æ˜¯åœ¨ä¸¤ä¸ªå¼•æ“ä¸Šç‹¬ç«‹æ‰§è¡Œçš„ã€‚ ä¸ºäº†åº”å¯¹è¿™ä¸€æŒ‘æˆ˜ï¼Œæˆ‘ä»¬åœ¨ Alibaba Cloud çš„ OLAP System AnalyticDBï¼ˆADBï¼‰å†…è®¾è®¡å’Œå®æ–½äº†ä¸€ä¸ªæ–°çš„åˆ†æå¼•æ“ï¼Œç§°ä¸º AnalyticDB-Vï¼ˆADBVï¼‰ï¼Œè¯¥å¼•æ“åœ¨ Alibaba Cloud ä¸Šè¿›è¡Œäº†ç®¡ç†ï¼Œè¯¥å¼•æ“å¯ä»¥ç®¡ç†å¤§é‡åŠŸèƒ½å‘é‡å’Œç»“æ„åŒ–æ•°æ®å¹¶ä¸”æœ¬æœºæ”¯æŒæ··åˆæŸ¥è¯¢ã€‚åœ¨ç³»ç»Ÿçš„è®¾è®¡å’Œå¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬é‡åˆ°å¹¶è§£å†³äº†å‡ ä¸ªé‡å¤§çš„æŒ‘æˆ˜ï¼š é«˜ç»´å‘é‡çš„å®æ—¶ç®¡ç†ã€‚ä»éç»“æ„åŒ–æ•°æ®ä¸­æå–çš„ç‰¹å¾å‘é‡é€šå¸¸å…·æœ‰æé«˜çš„ç»´æ•°ã€‚ä¾‹å¦‚ï¼Œåœ¨é˜¿é‡Œå·´å·´ï¼Œéç»“æ„åŒ–æ•°æ®çš„å‘é‡åœ¨è®¸å¤šåœºæ™¯ä¸­å¯ä»¥è¾¾åˆ° 500 å¤šä¸ªç»´åº¦ï¼Œä¾‹å¦‚åœ¨çº¿è´­ç‰©åº”ç”¨ç¨‹åºã€‚æ­¤å¤–ï¼Œè¿™äº›å‘é‡æ˜¯å®æ—¶ç”Ÿæˆçš„ã€‚å¯¹è¿™äº›é«˜ç»´å‘é‡çš„å®æ—¶ç®¡ç†(å³ CRUD æ“ä½œ)å¯¹äºç°æœ‰çš„æ•°æ®åº“å’Œå‘é‡æœç´¢å¼•æ“æ¥è¯´æ˜¯ç¹é‡çš„ã€‚ä¸€æ–¹é¢ï¼Œåªæ”¯æŒç›¸ä¼¼åº¦æœç´¢çš„åœ¨çº¿æ•°æ®åº“ç³»ç»Ÿ (ä¾‹å¦‚ Post-greSQL å’Œ MySQL) ä»…é€‚ç”¨äºå¤šè¾¾æ•°åç»´çš„å‘é‡ã€‚å¦ä¸€æ–¹é¢ï¼Œå‘é‡ç›¸ä¼¼æ€§æœç´¢å¼•æ“ï¼ˆä¾‹å¦‚ faissï¼‰é‡‡ç”¨ ANNï¼ˆå¤§çº¦æœ€è¿‘çš„é‚»å±…æœç´¢ï¼‰æ–¹æ³•ä»¥ç¦»çº¿æ–¹å¼å¤„ç†å’Œç´¢å¼•é«˜ç»´å‘é‡ï¼Œè¿™äº›æ–¹å¼æ— æ³•å¤„ç†å®æ—¶æ›´æ–° æ··åˆæŸ¥è¯¢ä¼˜åŒ–ã€‚æ··åˆæŸ¥è¯¢ä¸º joint execution and optimization æä¾›äº†æ–°çš„æœºä¼šï¼Œå¹¶è€ƒè™‘äº†ç‰¹å¾å‘é‡å’Œç»“æ„åŒ–å±æ€§ã€‚ä½†æ˜¯ï¼Œæ··åˆæŸ¥è¯¢ä¼˜åŒ–æœ¬è´¨ä¸Šæ¯”ç°æœ‰ä¼˜åŒ–æ›´ä¸ºå¤æ‚ã€‚æ”¯æŒ TOP-K è¿è¥çš„ç»å…¸ä¼˜åŒ–å™¨ä¸å¿…è€ƒè™‘å‡†ç¡®æ€§é—®é¢˜ï¼Œå³æ‰€æœ‰æŸ¥è¯¢è®¡åˆ’éƒ½ä¼šå¸¦æ¥ç›¸åŒçš„ç»“æœã€‚ä½†æ˜¯ï¼Œå¯¹äºæ··åˆæŸ¥è¯¢ï¼ŒANNï¼ˆåœ¨å‘é‡ä¸Šï¼‰è¿”å›è¿‘ä¼¼ç»“æœï¼Œä»¥é¿å…è¿›è¡Œè¿‡åº¦æœç´¢ï¼Œå› æ­¤ Top-K æ“ä½œçš„å‡†ç¡®æ€§éš ANN æ–¹æ³•å’Œå‚æ•°è®¾ç½®çš„é€‰æ‹©è€Œå˜åŒ–ã€‚è¦å¹³è¡¡è¿‘ä¼¼ç»“æœçš„è´¨é‡å’ŒæŸ¥è¯¢å¤„ç†é€Ÿåº¦ï¼Œè¿˜æœ‰ä¸€é¡¹éå¸¸é‡è¦çš„ä»»åŠ¡ é«˜æ‰©å±•æ€§å’Œå¹¶å‘æ€§ã€‚åœ¨æˆ‘ä»¬çš„è®¸å¤šç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå‘é‡ä»¥æå¤§çš„è§„æ¨¡è¿›è¡Œç®¡ç†ã€‚ä¾‹å¦‚ï¼Œåœ¨æ™ºèƒ½åŸå¸‚è¿è¾“æ–¹æ¡ˆä¸­ï¼Œæˆ‘ä»¬å¿…é¡»æ¯å¤©ç®¡ç†è¶…è¿‡ 117 äº¿é“è·¯æˆ–è½¦è¾†å¿«ç…§ï¼Œæ¯å¤©æœ‰ 1 äº¿ä¸ªæ–°æ’å…¥çš„è®°å½•ã€‚æ­¤å¤–ï¼Œè‡³å°‘éœ€è¦æ¯ç§’å¤„ç† 5,000 ä¸ªæŸ¥è¯¢ï¼Œå…¶ä¸­ 90ï¼…ä»¥ä¸Šæ˜¯æ–°å…´çš„æŸ¥è¯¢ã€‚åœ¨ Freshippo è¶…å¸‚çš„å¦ä¸€ç§åº”ç”¨ç¨‹åºæ–¹æ¡ˆä¸­ï¼Œé˜¿é‡Œå·´å·´é›†å›¢çš„æ•°å­—åŒ–é›¶å”®å•†åº—ï¼Œ8 äº¿ 512 ç»´çŸ¢é‡å­˜å‚¨åœ¨ ADBV ä¸­ã€‚å³°å€¼è´Ÿè½½ä¸ºæ¯ç§’ 4000 ä¸ªæŸ¥è¯¢ï¼ˆQPSï¼‰ï¼Œé«˜äº 80ï¼…çš„æŸ¥è¯¢æ˜¯æ··åˆæŸ¥è¯¢ã€‚åˆ†å¸ƒå¼ä½“ç³»ç»“æ„å¯¹äºå¦‚æ­¤å¤§è§„æ¨¡çš„å·¥ä½œè´Ÿè½½è‡³å…³é‡è¦ã€‚æ­¤å¤–ï¼Œå¿…é¡»ç»´æŒå¤§é‡çŸ¢é‡å’Œæ–°æ‘„å…¥æ•°æ®çš„å¿«é€Ÿç´¢å¼• åœ¨ ADBVï¼Œæˆ‘ä»¬è§£å†³äº†ä¸Šè¿°æŒ‘æˆ˜ï¼Œå¹¶åšå‡ºäº†ä»¥ä¸‹ä¸»è¦è´¡çŒ®ï¼š ç”¨äºæ··åˆæŸ¥è¯¢çš„å®æ—¶åˆ†æå¼•æ“ã€‚æˆ‘ä»¬æå‡ºäº†ä¸€ç§åˆ†æå¼•æ“ï¼Œè¯¥å¼•æ“æœ¬åœ°æ”¯æŒèåˆç»“æ„åŒ–å’Œéç»“æ„åŒ–çš„å®æ—¶æ›´æ–°çš„æ•°æ®ã€‚ä¸ºäº†æ»¡è¶³å®æ—¶éœ€æ±‚ï¼Œæˆ‘ä»¬é‡‡ç”¨äº†å¸¦æœ‰ä¸åŒ ANN ç´¢å¼•çš„ Lambda æ¡†æ¶ï¼Œç”¨äºæµå±‚å’Œæ‰¹å¤„ç†å±‚ã€‚æµå±‚ä¸­åŸºäºé‚»åŸŸçš„ ANNS æ–¹æ³•æ”¯æŒå®æ—¶æ’å…¥ï¼Œä½†ä¼šæ¶ˆè€—å¤§é‡å†…å­˜ã€‚æ‰¹å¤„ç†å±‚ä¸­åŸºäºç¼–ç çš„ ANN æ–¹æ³•æ¶ˆè€—çš„å†…å­˜è¾ƒå°‘ï¼Œä½†éœ€è¦åœ¨ construction ä¹‹å‰ç¦»çº¿è®­ç»ƒã€‚Lambda æ¡†æ¶å¯ä»¥å®šæœŸåˆå¹¶ä»æµå±‚ä¸­æ–°æ‘„å…¥çš„æ•°æ®ä¸­ï¼Œå¹¶å°†å…¶ä»åˆ†æ‰¹å±‚ä¸­ã€‚ ä¸€ç§æ–°çš„ ANNS ç®—æ³•ã€‚ä¸ºäº†æé«˜ä»£è¡¨å¤§é‡éç»“æ„åŒ–æ•°æ®çš„å¤§è§„æ¨¡çŸ¢é‡çš„å‡†ç¡®æ€§ï¼Œæå‡ºäº†ä¸€ç§æ–°çš„ ANNS ç´¢å¼•ï¼Œç§°ä¸º Voronoi Graph Product Quantization (VGPQ)ã€‚ä¸ IVFPQ ç›¸æ¯”ï¼Œè¯¥ç®—æ³•å¯ä»¥æœ‰æ•ˆåœ°ç¼©å°çŸ¢é‡ç©ºé—´ä¸­çš„æœç´¢ scopeã€‚æ ¹æ®å®è¯ç ”ç©¶ï¼ŒVGPQ æ¯” IVFPQ æ›´æœ‰æ•ˆåœ°å¯¹ massive vectors è¿›è¡Œå¿«é€Ÿç´¢å¼•å’ŒæŸ¥è¯¢æ›´æœ‰æ•ˆ Accuracy-aware çš„åŸºäºæˆæœ¬çš„æ··åˆæŸ¥è¯¢ä¼˜åŒ–ã€‚åœ¨ ADBV ä¸­ï¼ŒANNS ç®—æ³•è¢«åŒ…è£¹ä¸º physical operatorsã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä¾é æŸ¥è¯¢ä¼˜åŒ–å™¨æ¥æœ‰æ•ˆåœ°æ”¯æŒæ··åˆæŸ¥è¯¢è¿‡ç¨‹ã€‚å…³ç³»æ•°æ®åº“ä¸­çš„ç‰©ç†è¿ç®—ç¬¦å§‹ç»ˆè¿”å›ç¡®åˆ‡çš„ç»“æœã€‚ä½†æ˜¯ï¼Œè¿™äº›æ–°å¼•å…¥çš„ç‰©ç†è¿è¥å•†å¯èƒ½ä¸ä¼šä¸¥æ ¼éµå¾ªå…³ç³»ä»£æ•°ï¼Œè€Œæ˜¯è¾“å‡ºè¿‘ä¼¼ç»“æœã€‚ç”±äºè¿‘ä¼¼çš„æ€§è´¨ï¼Œæˆ‘ä»¬æä¾›äº†æ–°çš„æ“ä½œè§„åˆ™ï¼Œä»¥è¾¾åˆ°æœ€ä½³çš„æŸ¥è¯¢æ•ˆç‡ã€‚è¿™äº›è§„åˆ™è‡ªç„¶åµŒå…¥äº† ADBV çš„ä¼˜åŒ–å™¨ä¸­ åœ¨ä»¥ä¸‹å„èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†æä¾› ADBV çš„è¯¦ç»†ä¿¡æ¯ã€‚Â§2 ä»‹ç»äº†æ··åˆæŸ¥è¯¢å’Œ SQL dialects çš„èƒŒæ™¯ã€‚Â§3ï¼ŒÂ§4 å’ŒÂ§5 ä»‹ç»äº†æˆ‘ä»¬çš„è®¾è®¡å’Œå®ç°ï¼Œå³æ€»ä½“ç³»ç»Ÿè®¾è®¡ï¼ŒçŸ¢é‡å¤„ç†ï¼ˆANNSï¼‰ç®—æ³•å’ŒåŸºäºå‡†ç¡®æ€§çš„åŸºäºæˆæœ¬çš„æ··åˆæŸ¥è¯¢ä¼˜åŒ–ã€‚å®éªŒè¯„ä¼°æ˜¯åœ¨Â§6 ä¸­è¿›è¡Œçš„ã€‚ç›¸å…³å·¥ä½œå°†åœ¨Â§7 ä¸­è®¨è®ºï¼Œå¹¶åœ¨ç¬¬ 8 èŠ‚ä¸­å¾—å‡ºç»“è®ºã€‚ ","date":"2024-02-25","objectID":"/posts/analyticdb-paper/:3:0","tags":["Paper Reading"],"title":"Paper Reading: AnalyticDB-V","uri":"/posts/analyticdb-paper/"},{"categories":null,"content":"BACKGROUND ","date":"2024-02-25","objectID":"/posts/analyticdb-paper/:4:0","tags":["Paper Reading"],"title":"Paper Reading: AnalyticDB-V","uri":"/posts/analyticdb-paper/"},{"categories":null,"content":"Motivation ä¸ºäº†å‡†ç¡®åœ°æ£€ç´¢æ„Ÿå…´è¶£çš„è®°å½•ï¼Œå…¸å‹çš„æ··åˆæŸ¥è¯¢åŒ…æ‹¬ç‰¹å¾å‘é‡ä¸Šçš„ç›¸ä¼¼æ€§çº¦æŸ(ä»éç»“æ„åŒ–æ•°æ®ä¸­æå–)å’Œç»“æ„åŒ–æ•°æ®ä¸Šçš„å€¼çº¦æŸã€‚è€ƒè™‘å›¾ 1 æ‰€ç¤ºçš„ç¤ºä¾‹ï¼Œç›®æ ‡æ˜¯æ£€ç´¢åœ¨è§†è§‰ä¸Šä¸æŸ¥è¯¢å›¾åƒç›¸ä¼¼çš„è¡£æœï¼Œä½†æ˜¯æ˜¯çº¢è‰²çš„ã€‚ä¼ ç»Ÿåœ°ï¼Œè¿™ä¸¤ç§çº¦æŸç”±ä¸¤ä¸ªç‹¬ç«‹çš„ç³»ç»Ÿå¤„ç†ã€‚å¼€å‘äººå‘˜éœ€è¦æŸ¥è¯¢ä½¿ç”¨çŸ¢é‡æœç´¢å¼•æ“ï¼ˆä¾‹å¦‚ Faissï¼ŒVearchï¼‰çš„ Top-K å›¾åƒï¼ŒåŒæ—¶ä»æ•°æ®åº“ä¸­æ£€ç´¢é¢œè‰²ä¿¡æ¯ã€‚ä¹‹åï¼Œä»ä¸¤ä¸ªç³»ç»Ÿè·å¾—çš„è®°å½•ç»“åˆåˆå¹¶ä»¥å¾—å‡ºæœ€ç»ˆç»“æœã€‚ è¿™ç§å®è·µå¼•èµ·äº†é¢å¤–çš„å‘å±•å·¥ä½œå’Œæ„æˆæˆæœ¬ã€‚å¯èƒ½ä¼šé‡åˆ°å°‘äº k è®°å½•ï¼ˆä»çŸ¢é‡æœç´¢å¼•æ“è¿”å›ï¼‰æˆåŠŸåœ°ä¼ é€’ç”¨æˆ·æŸ¥è¯¢ä¸­è¡¨è¾¾çš„é¢œè‰²æˆ–æ ·å¼çº¦æŸï¼Œå› æ­¤æ— æ³•æ„é€ é¡¶éƒ¨çš„ç»“æœä»¥æ»¡è¶³ç”¨æˆ·ä¸­æ˜ç¡®æåŠçš„é‡å­è¦æ±‚è¯¢é—®ã€‚å› æ­¤ï¼Œå¼€å‘äººå‘˜å¿…é¡»ä»”ç»†è®¾ç½®çŸ¢é‡æœç´¢å¼•æ“è¦æ£€ç´¢çš„è®°å½•æ•°é‡ã€‚æ­¤å¤–ï¼Œæ‰§è¡Œæ•ˆç‡å…·æœ‰ä¼˜åŒ–çš„å·¨å¤§æ½œåŠ›ã€‚ä¾‹å¦‚ï¼Œå¦‚æœåªæœ‰ä¸€å°éƒ¨åˆ†è¡£æœæ»¡è¶³ç»“æ„åŒ–çš„ç»“æ„ï¼ˆå³çº¢è‰²ï¼‰ï¼Œåˆ™é¦–å…ˆä½¿ç”¨ç»“æ„åŒ–çº¦æŸæ¥æ£€ç´¢è®°å½•ï¼Œç„¶åç›´æ¥ä»æ£€ç´¢åˆ°çš„è®¾ç½®ä¸­è¯†åˆ«å‡ºæœ€æ¥è¿‘çš„ç‰¹å¾å‘é‡ï¼Œå°†ä¼šæ›´æœ‰æ•ˆã€‚å› æ­¤ï¼ŒADBV çš„åŠ¨æœºæ˜¯è§£å†³ä¸Šè¿°é—®é¢˜ã€‚ ADBV å…è®¸ç”¨æˆ·å°†æ··åˆæŸ¥è¯¢ä½œä¸º SQL è¯­å¥è¡¨ç¤ºï¼Œå¹¶åœ¨æ— éœ€æ‰‹åŠ¨è°ƒæ•´çš„æƒ…å†µä¸‹æœ‰æ•ˆåœ°æ‰§è¡Œå®ƒã€‚è¯·æ³¨æ„ï¼Œéç»“æ„åŒ–å’Œç»“æ„åŒ–æ•°æ®éƒ½å¯ä»¥å­˜å‚¨åœ¨ä¸€ä¸ªè¡¨ä¸­ã€‚ç‰¹åˆ«æ˜¯ï¼Œåœ¨æ’å…¥é˜¶æ®µå°†éç»“æ„åŒ–æ•°æ®è½¬æ¢ä¸ºå‘é‡ï¼ˆé€šè¿‡ç‰¹å¾æå–åŠŸèƒ½ï¼‰ï¼Œå¹¶å­˜å‚¨åœ¨åˆ—ä¸­ã€‚ ","date":"2024-02-25","objectID":"/posts/analyticdb-paper/:4:1","tags":["Paper Reading"],"title":"Paper Reading: AnalyticDB-V","uri":"/posts/analyticdb-paper/"},{"categories":null,"content":"SQL dialects ADBV æä¾›çµæ´»ä¸”æ˜“äºä½¿ç”¨çš„ SQL æ¥å£ã€‚å¼€å‘äººå‘˜å¯ä»¥è½»æ¾å°†å…¶åº”ç”¨ç¨‹åºç§»æ¤åˆ°æœ€å°çš„åŠªåŠ›ä¸­ ç•¥ ","date":"2024-02-25","objectID":"/posts/analyticdb-paper/:4:2","tags":["Paper Reading"],"title":"Paper Reading: AnalyticDB-V","uri":"/posts/analyticdb-paper/"},{"categories":null,"content":"SYSTEM DESIGN ADBV å»ºç«‹åœ¨é˜¿é‡Œå·´å·´çš„ PB-scale OLAP æ•°æ®åº“ç³»ç»Ÿ AnalyticDB ä¹‹ä¸Šï¼Œè¯¥ç³»ç»Ÿä¾èµ–äºä¸¤ä¸ªåŸºæœ¬ç»„ä»¶ï¼Œå³ç›˜å¤ï¼Œç”¨äºå¯é å’Œæ°¸ä¹…çš„åˆ†å¸ƒå¼å­˜å‚¨ã€‚ä¼ç¾²ï¼Œç”¨äºèµ„æºç®¡ç†å’Œè®¡ç®—ä½œä¸šè°ƒåº¦ã€‚ADBV å¢å¼ºäº† AnalyticDB çš„å‘é‡æ”¯æŒå’Œæ··åˆæŸ¥è¯¢åŠŸèƒ½ã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†æ”¹è¿›çŸ¢é‡ç®¡ç†å’Œæ··åˆæŸ¥è¯¢å¤„ç†çš„åŠŸèƒ½å’Œæœ‰æ•ˆæ€§çš„å…³é”®ç³»ç»Ÿè®¾è®¡ ","date":"2024-02-25","objectID":"/posts/analyticdb-paper/:5:0","tags":["Paper Reading"],"title":"Paper Reading: AnalyticDB-V","uri":"/posts/analyticdb-paper/"},{"categories":null,"content":"Architecture overview å›¾ 2 ä¸­ä»‹ç»çš„ ADBV çš„æ¶æ„ï¼Œä¸»è¦ç”±ä¸‰ç§ç±»å‹çš„èŠ‚ç‚¹ç»„æˆï¼šCoordinator åè°ƒå™¨ï¼ŒWrite Node, and Read Nodeã€‚ Coordinators æ¥å—ï¼Œè§£æï¼Œä¼˜åŒ– SQL è¯­å¥ï¼Œå¹¶å°†å…¶æ´¾é£ä»¥è¯»/å†™èŠ‚ç‚¹ã€‚ADBV é‡‡ç”¨å…¸å‹çš„è¯»/å†™è§£è€¦åˆï¼Œå®ƒä»¥ä½æŸ¥è¯¢å»¶è¿Ÿå’Œé«˜å†™å…¥é‡çš„ä¸€è‡´æ€§è¿›è¡Œäº†äº¤æ˜“ã€‚å› æ­¤ï¼Œå†™èŠ‚ç‚¹ä»…ç”¨äºå†™è¯·æ±‚ï¼ˆå³æ’å…¥ï¼Œåˆ é™¤å’Œæ›´æ–°ï¼‰ï¼Œè€Œè¯»å–èŠ‚ç‚¹åˆ™ç”¨äºç²¾é€‰æŸ¥è¯¢ã€‚æ–°æ‘„å…¥çš„æ•°æ®åœ¨æ‰¿è¯ºåå°†å…¶å†²å…¥ ç›˜å¤ã€‚ADBV åœ¨å­˜å‚¨å±‚ï¼ˆç¬¬ 3.2 èŠ‚ï¼‰ä¸­é‡‡ç”¨ LAMBDA æ¡†æ¶æœ‰æ•ˆåœ°ç®¡ç† vectorsï¼šstreaming å±‚æ¶‰åŠå®æ—¶æ•°æ®æ’å…¥å’Œä¿®æ”¹ï¼›æ‰¹å¤„ç†å±‚å‘¨æœŸä»å‹ç¼©æ–°æ’å…¥çš„å‘é‡å’Œé‡å»º ANN ç´¢å¼•ã€‚æ­¤å¤–ï¼ŒADBV å°†å‡ ä¸ªæ˜‚è´µçš„è°“è¯ push down åˆ°å­˜å‚¨å±‚ï¼Œä»¥ä¾¿å……åˆ†åˆ©ç”¨è¿™äº›èŠ‚ç‚¹çš„ è®¡ç®— èƒ½åŠ› ","date":"2024-02-25","objectID":"/posts/analyticdb-paper/:5:1","tags":["Paper Reading"],"title":"Paper Reading: AnalyticDB-V","uri":"/posts/analyticdb-paper/"},{"categories":null,"content":"Lambda framework ç”±äºæœç´¢æ•´ä¸ªçŸ¢é‡æ•°æ®é›†çš„å¤æ‚æ€§æ˜¯ä¸å¯æ¥å—çš„ï¼Œå› æ­¤å¿…é¡»å»ºç«‹ç´¢å¼•æ¥é™ä½æˆæœ¬ã€‚ ç„¶è€Œï¼Œåœ¨ä½ç»´ä¸­å¹¿æ³›ä½¿ç”¨çš„ä¼ ç»Ÿç´¢å¼•æŠ€æœ¯ï¼Œå¦‚ KD-tree å’Œ ball-tree ï¼Œå¯¹äºæ·±åº¦å­¦ä¹ æ¨¡å‹ç”Ÿæˆçš„é«˜ç»´å‘é‡æ¥è¯´æ•ˆæœä¸ä½³ã€‚ ç»éªŒè¯æ˜ï¼Œæ­¤ç±»è§£å†³æ–¹æ¡ˆå¯¹äºé«˜ç»´å‘é‡è¡¨ç°å‡ºçº¿æ€§å¤æ‚æ€§ã€‚ å› æ­¤ï¼Œæå‡ºäº† HNSWï¼ˆHierarchical Navigable Small Worldï¼‰å’Œ LSHï¼ˆLocality-SensitiveHashï¼‰ç­‰ç®—æ³•ï¼Œä»¥è¿‘ä¼¼çš„æ–¹å¼åœ¨å‘é‡ä¸Šè¿›è¡Œå®æ—¶ç´¢å¼•æ„å»ºã€‚ ç„¶è€Œï¼Œç°æœ‰çš„ç®—æ³•è¦ä¹ˆç”±äºå†…å­˜æ¶ˆè€—å¤§è€Œæ— æ³•å¤„ç†å¤§é‡æ•°æ®ï¼Œè¦ä¹ˆæ— æ³•æä¾›è¶³å¤Ÿå‡†ç¡®çš„ç»“æœã€‚ ä»¥ HNSW ä¸ºä¾‹ï¼Œå®ƒéœ€è¦å°†ç´¢å¼•æ•°æ®å’Œç‰¹å¾å‘é‡æŒä¹…å­˜å‚¨åœ¨å†…å­˜ä¸­ä»¥é¿å…ç£ç›˜ I/Oï¼Œå¦åˆ™å…¶æ€§èƒ½å°†æ˜¾ç€ä¸‹é™ã€‚ é™¤äº†åŸå§‹æ•°æ®ä¹‹å¤–ï¼Œæ¯æ¡è®°å½•è¿˜éœ€è¦å¤§çº¦ 400 bytes çš„å†…å­˜ç”¨äºå…¶ç´¢å¼•ã€‚ æˆ‘ä»¬é‡‡ç”¨ lambda æ¡†æ¶æ¥è§£å†³æ”¯æŒå®æ—¶æ’å…¥çš„æŒ‘æˆ˜ã€‚ åœ¨æ­¤æ¡†æ¶ä¸‹ï¼ŒADBV ä½¿ç”¨ HNSW å®æ—¶ä¸ºæ–°æ’å…¥çš„å‘é‡ï¼ˆå³å¢é‡æ•°æ®ï¼‰å»ºç«‹ç´¢å¼•ã€‚ ADBV æ ¹æ®å»ºè®®çš„ VGPQ ç®—æ³•ï¼ˆç¬¬ 4.2 èŠ‚ï¼‰å®šæœŸå°†å¢é‡æ•°æ®ä¸åŸºçº¿æ•°æ®åˆå¹¶åˆ°å…¨å±€ç´¢å¼•ï¼ˆç¬¬ 3.2.2 èŠ‚ï¼‰ä¸­ï¼Œå¹¶ä¸¢å¼ƒ HNSW ç´¢å¼•ã€‚ å›¾ 3 æè¿°äº† lambda æ¡†æ¶ï¼Œå®ƒç”±ä¸‰å±‚ç»„æˆï¼šæ‰¹å¤„ç†å±‚ã€æµå¤„ç†å±‚å’ŒæœåŠ¡å±‚ã€‚ è¿™äº›å±‚å…±åŒå¤„ç†æ¯ä¸ªä¼ å…¥çš„æŸ¥è¯¢ã€‚ æ‰¹å¤„ç†å±‚æ ¹æ®åŸºçº¿æ•°æ®è¿”å›æœç´¢ç»“æœï¼ˆç¬¬ 3.2.2 èŠ‚ä¸­è®¨è®ºï¼‰ã€‚ å¯¹äºæµå±‚ï¼Œå®ƒæ‰§è¡Œä¸¤é¡¹ä»»åŠ¡ï¼šå¤„ç†æ•°æ®ä¿®æ”¹ï¼ˆå³ INSERTã€DELETE å’Œ UPDATEï¼‰ï¼Œä»¥åŠåœ¨å¢é‡æ•°æ®ä¸Šç”Ÿæˆæœç´¢ç»“æœã€‚ å¯¹äº SELECT è¯­å¥ï¼Œæ‰¹å¤„ç†å±‚å’Œæµå¤„ç†å±‚çš„éƒ¨åˆ†ç»“æœç”±åè°ƒå™¨åˆå¹¶ä»¥å¾—å‡ºæœ€ç»ˆç»“æœã€‚ æœåŠ¡å±‚è´Ÿè´£å‘æ‰¹å¤„ç†å±‚å’Œæµå¤„ç†å±‚å‘å‡ºè¯·æ±‚å¹¶å°†ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ã€‚ ä¸åŒçš„å±‚é©»ç•™åœ¨ä¸åŒç±»å‹çš„èŠ‚ç‚¹ä¸­ï¼Œå³åè°ƒå™¨ä¸­çš„æœåŠ¡å±‚ã€è¯»å–èŠ‚ç‚¹ä¸­çš„æ‰¹å¤„ç†å±‚ä»¥åŠè¯»å–èŠ‚ç‚¹å’Œå†™å…¥èŠ‚ç‚¹ä¸­çš„æµå±‚ã€‚ ","date":"2024-02-25","objectID":"/posts/analyticdb-paper/:5:2","tags":["Paper Reading"],"title":"Paper Reading: AnalyticDB-V","uri":"/posts/analyticdb-paper/"},{"categories":null,"content":"Clustering-based partitioning ","date":"2024-02-25","objectID":"/posts/analyticdb-paper/:5:3","tags":["Paper Reading"],"title":"Paper Reading: AnalyticDB-V","uri":"/posts/analyticdb-paper/"},{"categories":null,"content":"VECTOR PROCESSING ALGORITHMS ","date":"2024-02-25","objectID":"/posts/analyticdb-paper/:6:0","tags":["Paper Reading"],"title":"Paper Reading: AnalyticDB-V","uri":"/posts/analyticdb-paper/"},{"categories":null,"content":"Vector query processing ","date":"2024-02-25","objectID":"/posts/analyticdb-paper/:6:1","tags":["Paper Reading"],"title":"Paper Reading: AnalyticDB-V","uri":"/posts/analyticdb-paper/"},{"categories":null,"content":"Voronoi graph product quantization ","date":"2024-02-25","objectID":"/posts/analyticdb-paper/:6:2","tags":["Paper Reading"],"title":"Paper Reading: AnalyticDB-V","uri":"/posts/analyticdb-paper/"},{"categories":null,"content":"Storage design for VGPQ ","date":"2024-02-25","objectID":"/posts/analyticdb-paper/:6:3","tags":["Paper Reading"],"title":"Paper Reading: AnalyticDB-V","uri":"/posts/analyticdb-paper/"},{"categories":null,"content":"HYBRID QUERY OPTIMIZATION ","date":"2024-02-25","objectID":"/posts/analyticdb-paper/:7:0","tags":["Paper Reading"],"title":"Paper Reading: AnalyticDB-V","uri":"/posts/analyticdb-paper/"},{"categories":null,"content":"Hybrid query execution ","date":"2024-02-25","objectID":"/posts/analyticdb-paper/:7:1","tags":["Paper Reading"],"title":"Paper Reading: AnalyticDB-V","uri":"/posts/analyticdb-paper/"},{"categories":null,"content":"Cost model for optimization ","date":"2024-02-25","objectID":"/posts/analyticdb-paper/:7:2","tags":["Paper Reading"],"title":"Paper Reading: AnalyticDB-V","uri":"/posts/analyticdb-paper/"},{"categories":null,"content":"Accuracy-aware hyperparameter tuning ","date":"2024-02-25","objectID":"/posts/analyticdb-paper/:7:3","tags":["Paper Reading"],"title":"Paper Reading: AnalyticDB-V","uri":"/posts/analyticdb-paper/"},{"categories":null,"content":"EXPERIMENTS ","date":"2024-02-25","objectID":"/posts/analyticdb-paper/:8:0","tags":["Paper Reading"],"title":"Paper Reading: AnalyticDB-V","uri":"/posts/analyticdb-paper/"},{"categories":null,"content":"Experimental setup ","date":"2024-02-25","objectID":"/posts/analyticdb-paper/:8:1","tags":["Paper Reading"],"title":"Paper Reading: AnalyticDB-V","uri":"/posts/analyticdb-paper/"},{"categories":null,"content":"VGPQ ","date":"2024-02-25","objectID":"/posts/analyticdb-paper/:8:2","tags":["Paper Reading"],"title":"Paper Reading: AnalyticDB-V","uri":"/posts/analyticdb-paper/"},{"categories":null,"content":"Clustering-based partition pruning ","date":"2024-02-25","objectID":"/posts/analyticdb-paper/:8:3","tags":["Paper Reading"],"title":"Paper Reading: AnalyticDB-V","uri":"/posts/analyticdb-paper/"},{"categories":null,"content":"Hybrid query optimization ","date":"2024-02-25","objectID":"/posts/analyticdb-paper/:8:4","tags":["Paper Reading"],"title":"Paper Reading: AnalyticDB-V","uri":"/posts/analyticdb-paper/"},{"categories":null,"content":"Two-step solution vs. ADBV ","date":"2024-02-25","objectID":"/posts/analyticdb-paper/:8:5","tags":["Paper Reading"],"title":"Paper Reading: AnalyticDB-V","uri":"/posts/analyticdb-paper/"},{"categories":null,"content":"Milvusï¼šA Purpose-Built Vector Data Management System ","date":"2024-02-25","objectID":"/posts/milvus-paper/:1:0","tags":["Paper Reading"],"title":"Paper Reading: Milvus A Purpose-Built Vector Data Management System","uri":"/posts/milvus-paper/"},{"categories":null,"content":"ABSTRACT æœ€è¿‘ï¼Œæ•°æ®ç§‘å­¦å’Œäººå·¥æ™ºèƒ½åº”ç”¨ä¸­è¿«åˆ‡éœ€è¦ç®¡ç†é«˜ç»´å‘é‡æ•°æ®ã€‚ éç»“æ„åŒ–æ•°æ®å’Œæœºå™¨å­¦ä¹  (ML) çš„æ¿€å¢æ¨åŠ¨äº†è¿™ä¸€è¶‹åŠ¿ï¼Œå…¶ä¸­ ML æ¨¡å‹é€šå¸¸å°†éç»“æ„åŒ–æ•°æ®è½¬æ¢ä¸ºç‰¹å¾å‘é‡ä»¥è¿›è¡Œæ•°æ®åˆ†æï¼Œä¾‹å¦‚äº§å“æ¨èã€‚ ç°æœ‰çš„å‘é‡æ•°æ®ç®¡ç†ç³»ç»Ÿå’Œç®—æ³•æœ‰ä¸¤ä¸ªå±€é™æ€§ï¼šï¼ˆ1ï¼‰åœ¨å¤„ç†å¤§è§„æ¨¡åŠ¨æ€å‘é‡æ•°æ®æ—¶ä¼šå‡ºç°ä¸¥é‡çš„æ€§èƒ½é—®é¢˜ï¼› (2)å®ƒä»¬æä¾›çš„åŠŸèƒ½æœ‰é™ï¼Œä¸èƒ½æ»¡è¶³å¤šåŠŸèƒ½åº”ç”¨çš„è¦æ±‚ã€‚ æœ¬æ–‡ä»‹ç»äº† Milvusï¼Œè¿™æ˜¯ä¸€ä¸ªä¸“é—¨æ„å»ºçš„æ•°æ®ç®¡ç†ç³»ç»Ÿï¼Œç”¨äºæœ‰æ•ˆç®¡ç†å¤§è§„æ¨¡å‘é‡æ•°æ®ã€‚ Milvus æ”¯æŒæ˜“äºä½¿ç”¨çš„åº”ç”¨ç¨‹åºæ¥å£ï¼ˆåŒ…æ‹¬ SDK å’Œ RESTful APIï¼‰ï¼› é’ˆå¯¹å…·æœ‰ç°ä»£ CPU å’Œ GPU çš„å¼‚æ„è®¡ç®—å¹³å°è¿›è¡Œä¼˜åŒ–ï¼› å®ç°è¶…è¶Šç®€å•å‘é‡ç›¸ä¼¼æ€§æœç´¢çš„é«˜çº§æŸ¥è¯¢å¤„ç†ï¼› å¤„ç†åŠ¨æ€æ•°æ®ä»¥å®ç°å¿«é€Ÿæ›´æ–°ï¼ŒåŒæ—¶ç¡®ä¿é«˜æ•ˆçš„æŸ¥è¯¢å¤„ç†ï¼› å¹¶å°†æ•°æ®åˆ†å¸ƒåˆ°å¤šä¸ªèŠ‚ç‚¹ä»¥å®ç°å¯æ‰©å±•æ€§å’Œå¯ç”¨æ€§ã€‚ æˆ‘ä»¬é¦–å…ˆæè¿° Milvus çš„è®¾è®¡å’Œå®ç°ã€‚ ç„¶åæˆ‘ä»¬æ¼”ç¤º Milvus æ”¯æŒçš„å®é™…ç”¨ä¾‹ã€‚ ç‰¹åˆ«æ˜¯ï¼Œæˆ‘ä»¬åœ¨ Milvus ä¹‹ä¸Šæ„å»ºäº†ä¸€ç³»åˆ— 10 ä¸ªåº”ç”¨ç¨‹åºï¼ˆä¾‹å¦‚å›¾åƒ/è§†é¢‘æœç´¢ã€åŒ–å­¦ç»“æ„åˆ†æã€COVID-19 æ•°æ®é›†æœç´¢ã€ä¸ªæ€§åŒ–æ¨èã€ç”Ÿç‰©å¤šå› ç´ è®¤è¯ã€æ™ºèƒ½é—®ç­”ï¼‰ã€‚ æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨å¹¿æ³›çš„ç³»ç»Ÿå¯¹ Milvus è¿›è¡Œå®éªŒè¯„ä¼°ï¼ŒåŒ…æ‹¬ä¸¤ä¸ªå¼€æºç³»ç»Ÿï¼ˆVeach å’Œ Microsoft SPTAGï¼‰å’Œä¸‰ä¸ªå•†ä¸šç³»ç»Ÿã€‚ å®éªŒè¡¨æ˜ï¼ŒMilvus æ¯”ç«äº‰å¯¹æ‰‹å¿«ä¸¤ä¸ªæ•°é‡çº§ï¼ŒåŒæ—¶æä¾›æ›´å¤šåŠŸèƒ½ã€‚ ç°åœ¨ Milvus å·²è¢«å…¨çƒæ•°ç™¾å®¶ç»„ç»‡éƒ¨ç½²ï¼Œä¹Ÿè¢«è®¤å®šä¸º LF AI \u0026 Data Foundation çš„å­µåŒ–é˜¶æ®µé¡¹ç›®ã€‚ Milvus å¼€æºäº https://github.com/milvus-io/milvusã€‚ ","date":"2024-02-25","objectID":"/posts/milvus-paper/:2:0","tags":["Paper Reading"],"title":"Paper Reading: Milvus A Purpose-Built Vector Data Management System","uri":"/posts/milvus-paper/"},{"categories":null,"content":"INTRODUCTION åœ¨ Zillizï¼Œæˆ‘ä»¬é‡åˆ°äº†å„ç§å®¢æˆ·åœ¨è®¸å¤šæ•°æ®ç§‘å­¦å’Œäººå·¥æ™ºèƒ½åº”ç”¨ä¸­ç®¡ç†å¤§è§„æ¨¡é«˜ç»´å‘é‡æ•°æ®ï¼ˆç»´åº¦ä» 10 åˆ° 1000 ç»´ï¼‰ä¸æ–­å¢é•¿çš„éœ€æ±‚ã€‚ è¿™ä¸»è¦æ˜¯ç”±äºä¸¤ä¸ªè¶‹åŠ¿ã€‚ ç¬¬ä¸€ä¸ªæ˜¯ç”±äºæ™ºèƒ½æ‰‹æœºã€ç‰©è”ç½‘è®¾å¤‡å’Œç¤¾äº¤åª’ä½“åº”ç”¨ç¨‹åºçš„æ™®åŠï¼Œå›¾åƒã€è§†é¢‘ã€æ–‡æœ¬ã€åŒ»ç–—æ•°æ®å’Œä½æˆ¿æ•°æ®ç­‰éç»“æ„åŒ–æ•°æ®çš„çˆ†ç‚¸å¼å¢é•¿ã€‚ æ® IDC ç§°ï¼Œåˆ° 2025 å¹´ï¼Œ80% çš„æ•°æ®å°†æ˜¯éç»“æ„åŒ–çš„ã€‚ ç¬¬äºŒä¸ªè¶‹åŠ¿æ˜¯æœºå™¨å­¦ä¹ çš„å¿«é€Ÿå‘å±•ï¼Œå¯ä»¥æœ‰æ•ˆåœ°å°†éç»“æ„åŒ–æ•°æ®è½¬æ¢ä¸ºå­¦ä¹ çš„ç‰¹å¾å‘é‡ä»¥è¿›è¡Œæ•°æ®åˆ†æã€‚ ç‰¹åˆ«æ˜¯ï¼Œæ¨èç³»ç»Ÿä¸­æœ€è¿‘æµè¡Œçš„æ–¹æ³•ç§°ä¸ºå‘é‡åµŒå…¥ï¼Œå®ƒå°†é¡¹ç›®è½¬æ¢ä¸ºç‰¹å¾å‘é‡ï¼ˆä¾‹å¦‚ item2vec ã€word2vec ã€doc2vec ã€graph2vec ï¼‰å¹¶é€šè¿‡ æä¾›æ¨è å¯»æ‰¾ç›¸ä¼¼çš„å‘é‡ã€‚ ä¾‹å¦‚ï¼ŒYouTube å°†è§†é¢‘åµŒå…¥åˆ°å‘é‡ä¸­ï¼› Airbnb ç”¨å‘é‡å»ºæ¨¡æˆ¿å±‹ ï¼› ç”Ÿç‰©ç§‘å­¦å®¶ä½¿ç”¨è½½ä½“æè¿°è¯ç‰©åŒ–åˆç‰©çš„åˆ†å­ç»“æ„ä¿¡æ¯ã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œå›¾åƒå’Œæ–‡æœ¬ä¹Ÿè‡ªç„¶åœ°ç”±å‘é‡è¡¨ç¤ºã€‚ ä¸æ–­å¢é•¿çš„ä¾‹å­æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿä»€ä¹ˆæƒ…å†µä¸‹ä¸€ä¸ªå‘é‡ä¼šä¸æ–­å¢åŠ ç»´åº¦ è¿™äº›åº”ç”¨ç¨‹åºå¯¹è®¾è®¡å¯æ‰©å±•çš„å‘é‡æ•°æ®ç®¡ç†ç³»ç»Ÿæå‡ºäº†ç‹¬ç‰¹çš„è¦æ±‚å’ŒæŒ‘æˆ˜ã€‚ å…¶ä¸­åŒ…æ‹¬ï¼šï¼ˆ1ï¼‰ä¸ä»…éœ€è¦æ”¯æŒå¤§è§„æ¨¡å‘é‡æ•°æ®çš„å¿«é€ŸæŸ¥è¯¢å¤„ç†ï¼Œè¿˜éœ€è¦æ”¯æŒåŠ¨æ€å‘é‡æ•°æ®çš„é«˜æ•ˆå¤„ç†ï¼ˆä¾‹å¦‚æ’å…¥å’Œåˆ é™¤ï¼‰ã€‚ ä¾‹å¦‚ï¼ŒYoutube æ¯åˆ†é’Ÿä¸Šä¼  500 å°æ—¶çš„ç”¨æˆ·ç”Ÿæˆè§†é¢‘ï¼ŒåŒæ—¶æä¾›å®æ—¶æ¨è ã€‚ï¼ˆ2ï¼‰é™¤äº†ç®€å•çš„å‘é‡ç›¸ä¼¼æ€§æœç´¢ä¹‹å¤–ï¼Œè¿˜éœ€è¦æä¾›é«˜çº§æŸ¥è¯¢å¤„ç†ï¼Œä¾‹å¦‚å±æ€§è¿‡æ»¤å’Œå¤šå‘é‡æŸ¥è¯¢å¤„ç†ã€‚ è¿™é‡Œçš„å±æ€§è¿‡æ»¤æ˜¯åªæœç´¢æ»¡è¶³ç»™å®šè¿‡æ»¤æ¡ä»¶çš„å‘é‡ï¼Œè¿™åœ¨ç”µå­å•†åŠ¡åº”ç”¨ä¸­å¾ˆæœ‰ç”¨ï¼Œä¾‹å¦‚ï¼Œæ‰¾åˆ°ä¸ç»™å®šå›¾åƒå‘é‡ç›¸ä¼¼ä¸”æˆæœ¬ä½äº 100 ç¾å…ƒçš„ T æ¤ã€‚ å¤šå‘é‡æŸ¥è¯¢å¤„ç†ç›®æ ‡é€‚ç”¨äºæ¯ä¸ªå¯¹è±¡ç”±å¤šä¸ªå‘é‡æè¿°çš„åœºæ™¯ï¼Œä¾‹å¦‚ï¼Œåœ¨è®¸å¤šè®¡ç®—æœºè§†è§‰åº”ç”¨ä¸­ä½¿ç”¨é¢éƒ¨å‘é‡å’Œå§¿åŠ¿å‘é‡æ¥åˆ†æäººç‰©ã€‚ ç°æœ‰çš„çŸ¢é‡æ•°æ®ç®¡ç†å·¥ä½œä¸»è¦é›†ä¸­äºçŸ¢é‡ç›¸ä¼¼åº¦æœç´¢ï¼Œä½†ç”±äºæ€§èƒ½è¾ƒå·®ï¼ˆé’ˆå¯¹å¤§è§„æ¨¡å’ŒåŠ¨æ€çŸ¢é‡æ•°æ®ï¼‰å’ŒåŠŸèƒ½æœ‰é™ï¼ˆä¾‹å¦‚ä¸æ”¯æŒå±æ€§è¿‡æ»¤å’Œå¤šçŸ¢é‡æŸ¥è¯¢ï¼‰ï¼Œæ— æ³•æ»¡è¶³ä¸Šè¿°è¦æ±‚ï¼Œä»¥æ”¯æŒå¤šåŠŸèƒ½æ•°æ®ç§‘å­¦å’Œäººå·¥æ™ºèƒ½åº”ç”¨ã€‚ æ›´å…·ä½“åœ°è¯´ï¼Œæˆ‘ä»¬å°†ç°æœ‰çš„å·¥ä½œåˆ†ä¸ºä¸¤ç±»ï¼šç®—æ³•å’Œç³»ç»Ÿã€‚ å¯¹äºå‘é‡ç›¸ä¼¼æ€§æœç´¢çš„ç®—æ³•å·¥ä½œåŠå…¶å¼€æºå®ç°åº“ï¼ˆä»¥ Facebook Faiss å’Œ Microsoft SPTAG ä¸ºä¾‹ï¼‰ï¼Œå­˜åœ¨ä¸€äº›å±€é™æ€§ã€‚ (1) å®ƒä»¬æ˜¯ç®—æ³•å’Œåº“ï¼Œè€Œä¸æ˜¯ç®¡ç†çŸ¢é‡æ•°æ®çš„æˆç†Ÿç³»ç»Ÿã€‚ ä»–ä»¬ä¸èƒ½å¾ˆå¥½åœ°å¤„ç†å¤§é‡æ•°æ®ï¼Œå› ä¸ºä»–ä»¬å‡è®¾æ‰€æœ‰æ•°æ®å’Œç´¢å¼•éƒ½å­˜å‚¨åœ¨ä¸»å†…å­˜ä¸­å¹¶ä¸”ä¸èƒ½è·¨è¶Šå¤šå°æœºå™¨ã€‚ (2)è¿™äº›å·¥ä½œé€šå¸¸å‡è®¾æ•°æ®ä¸€æ—¦è¢«å¼•å…¥ç³»ç»Ÿå°±æ˜¯é™æ€çš„ï¼Œå¹¶ä¸”ä¸èƒ½è½»æ¾åœ°å¤„ç†åŠ¨æ€æ•°æ®ï¼ŒåŒæ—¶ç¡®ä¿å¿«é€Ÿçš„å®æ—¶æœç´¢ã€‚ (3) å®ƒä»¬ä¸æ”¯æŒé«˜çº§æŸ¥è¯¢å¤„ç†ã€‚ ï¼ˆ4ï¼‰è¿™äº›å·¥ä½œæ²¡æœ‰é’ˆå¯¹ CPU å’Œ GPU çš„å¼‚æ„è®¡ç®—æ¶æ„è¿›è¡Œä¼˜åŒ– Milvus ä¸»è¦çš„å·¥ä½œï¼š full-fledged system that manages vector data, handle dynamic data while ensuring fast real-time searches, support advanced query processing, optimized for the heterogeneous computing architecture with CPUs and GPUs å¯¹äºçŸ¢é‡ç›¸ä¼¼æ€§æœç´¢çš„ç³»ç»Ÿï¼Œä¾‹å¦‚é˜¿é‡Œå·´å·´ AnalyticDB-V å’Œé˜¿é‡Œå·´å·´ PASEï¼ˆPostgreSQLï¼‰ï¼Œå®ƒä»¬éµå¾ªä¸€åˆ€åˆ‡çš„æ–¹æ³•é€šè¿‡æ·»åŠ ä¸€ä¸ªåä¸ºâ€œçŸ¢é‡åˆ—â€çš„è¡¨åˆ—æ¥æ‰©å±•å…³ç³»æ•°æ®åº“ä»¥æ”¯æŒçŸ¢é‡æ•°æ® â€æ¥å­˜å‚¨å‘é‡ã€‚ ç„¶è€Œï¼Œè¿™äº›ç³»ç»Ÿå¹¶ä¸æ˜¯ä¸“é—¨ç”¨äºç®¡ç†çŸ¢é‡æ•°æ®çš„ï¼Œä¹Ÿä¸å°†çŸ¢é‡è§†ä¸º first-class citizensã€‚ (1) ä¼˜åŒ–å™¨å’Œå­˜å‚¨å¼•æ“ç­‰ä¼ ç»Ÿæ•°æ®åº“ç»„ä»¶æ— æ³•å¯¹å‘é‡è¿›è¡Œå¾®è°ƒä¼˜åŒ–ï¼Œä¾‹å¦‚ï¼ŒæŸ¥è¯¢ä¼˜åŒ–å™¨é”™è¿‡äº†å……åˆ†åˆ©ç”¨ CPU å’Œ GPU å¤„ç†å‘é‡æ•°æ®çš„é‡è¦æœºä¼šã€‚ (2)ä¸æ”¯æŒå¤šå‘é‡æŸ¥è¯¢ç­‰é«˜çº§æŸ¥è¯¢å¤„ç† best leverage CPU and GPU for processing vector data, support advanced query processing such as multi-vector queries å¦ä¸€ä¸ªç›¸å…³ç³»ç»Ÿæ˜¯ Vearchï¼Œå®ƒæ˜¯ä¸ºå‘é‡æœç´¢è€Œè®¾è®¡çš„ã€‚ ä½† Vearch åœ¨å¤§è§„æ¨¡æ•°æ®ä¸Šæ•ˆç‡ä¸é«˜ã€‚ å®éªŒï¼ˆå›¾ 8 å’Œå›¾ 15ï¼‰è¡¨æ˜ï¼Œæœ¬æ–‡ä»‹ç»çš„ç³»ç»Ÿ Milvus æ¯” Vearch å¿« 6.4x ~ 47.0xã€‚ æ­¤å¤–ï¼ŒVeach ä¸æ”¯æŒå¤šå‘é‡æŸ¥è¯¢å¤„ç†ã€‚ large scale data, multi-vector query processing æœ¬æ–‡ä»‹ç»äº† Milvusï¼Œè¿™æ˜¯ä¸€ç§ä¸“é—¨æ„å»ºçš„æ•°æ®ç®¡ç†ç³»ç»Ÿï¼Œç”¨äºä¸ºæ•°æ®ç§‘å­¦å’Œäººå·¥æ™ºèƒ½åº”ç”¨é«˜æ•ˆå­˜å‚¨å’Œæœç´¢å¤§è§„æ¨¡çŸ¢é‡æ•°æ®ã€‚ å®ƒæ˜¯ä¸€ä¸ªä¸“é—¨ç”¨äºé«˜ç»´å‘é‡çš„ç³»ç»Ÿï¼Œéµå¾ª one-size-not-fits-all çš„è®¾è®¡å®è·µï¼Œä¸æ³›åŒ–å…³ç³»æ•°æ®åº“ä»¥æ”¯æŒå‘é‡ä¸åŒã€‚ Milvus æä¾›äº†è®¸å¤šåº”ç”¨ç¨‹åºæ¥å£ï¼ˆåŒ…æ‹¬ Python/Java/Go/C++ çš„ SDK å’Œ RESTful APIï¼‰ï¼Œå¯ä»¥æ–¹ä¾¿åº”ç”¨ç¨‹åºä½¿ç”¨ã€‚ Milvus é’ˆå¯¹å…·æœ‰ç°ä»£ CPU å’Œ GPUï¼ˆå¤šä¸ª GPU è®¾å¤‡ï¼‰çš„å¼‚æ„è®¡ç®—æ¶æ„è¿›è¡Œäº†é«˜åº¦è°ƒä¼˜ï¼Œä»¥å®ç°æœ€ä½³æ•ˆç‡ã€‚ å®ƒæ”¯æŒå¤šç§æŸ¥è¯¢ç±»å‹ï¼Œä¾‹å¦‚å…·æœ‰å„ç§ç›¸ä¼¼æ€§å‡½æ•°çš„å‘é‡ç›¸ä¼¼æ€§æœç´¢ã€å±æ€§è¿‡æ»¤å’Œå¤šå‘é‡æŸ¥è¯¢å¤„ç†ã€‚ å®ƒæä¾›äº†ä¸åŒç±»å‹çš„ç´¢å¼•ï¼ˆä¾‹å¦‚ï¼ŒåŸºäºé‡åŒ–çš„ç´¢å¼•å’ŒåŸºäºå›¾çš„ç´¢å¼•ï¼‰ï¼Œå¹¶å¼€å‘äº†ä¸€ä¸ªå¯æ‰©å±•çš„æ¥å£ï¼Œå¯ä»¥è½»æ¾åœ°å°†æ–°ç´¢å¼•åˆå¹¶åˆ°ç³»ç»Ÿä¸­ã€‚ Milvus é€šè¿‡åŸºäº LSM çš„ç»“æ„ç®¡ç†åŠ¨æ€çŸ¢é‡æ•°æ®ï¼ˆä¾‹å¦‚æ’å…¥å’Œåˆ é™¤ï¼‰ï¼ŒåŒæ—¶é€šè¿‡å¿«ç…§éš”ç¦»æä¾›ä¸€è‡´çš„å®æ—¶æœç´¢ã€‚ Milvus ä¹Ÿæ˜¯ä¸€ä¸ªè·¨å¤šä¸ªèŠ‚ç‚¹éƒ¨ç½²çš„åˆ†å¸ƒå¼æ•°æ®ç®¡ç†ç³»ç»Ÿï¼Œä»¥å®ç°å¯æ‰©å±•æ€§å’Œå¯ç”¨æ€§ã€‚ è¡¨ 1 çªå‡ºæ˜¾ç¤ºäº† Milvus ä¸å…¶ä»–ç³»ç»Ÿä¹‹é—´çš„ä¸»è¦åŒºåˆ«ã€‚ åœ¨å®ç°æ–¹é¢ï¼ŒMilvus æ„å»ºäº Facebook Faiss ä¹‹ä¸Šï¼Œåè€…æ˜¯ä¸€ä¸ªç”¨äºå‘é‡ç›¸ä¼¼æ€§æœç´¢çš„å¼€æº C++ åº“ã€‚ ä½† Milvus æ˜¾ç€å¢å¼ºäº† Faissï¼Œæé«˜äº†æ€§èƒ½ï¼ˆä¾‹å¦‚ç¬¬ 3 èŠ‚ä¸­é’ˆå¯¹å¼‚æ„è®¡ç®—å¹³å°çš„ä¼˜åŒ–ã€ç¬¬ 2.3 èŠ‚ä¸­é«˜æ•ˆæ”¯æŒåŠ¨æ€æ•°æ®ç®¡ç†ä»¥åŠç¬¬ 5.3 èŠ‚ä¸­çš„åˆ†å¸ƒå¼æŸ¥è¯¢å¤„ç†ï¼‰ã€å¢å¼ºçš„åŠŸèƒ½ï¼ˆä¾‹å¦‚å±æ€§è¿‡æ»¤å’Œå¤šé‡æŸ¥è¯¢ï¼‰ã€‚ ç¬¬ 4 èŠ‚ä¸­çš„çŸ¢é‡æŸ¥è¯¢å¤„ç†ï¼‰ï¼Œä»¥åŠæ›´å¥½çš„å¯ç”¨æ€§ï¼ˆä¾‹å¦‚ç¬¬ 2.1 èŠ‚ä¸­çš„åº”ç”¨ç¨‹åºæ¥å£ï¼‰ï¼Œæˆä¸ºæˆç†Ÿçš„æ˜“äºä½¿ç”¨çš„çŸ¢é‡æ•°æ®ç®¡ç†ç³»ç»Ÿ äº§å“å½±å“ï¼š Milvus å·²è¢«å…¨çƒæ•°ç™¾ä¸ªç»„ç»‡å’Œæœºæ„é‡‡ç”¨ï¼Œæ¶‰åŠå›¾åƒå¤„ç†ã€è®¡ç®—æœºè§†è§‰ã€è‡ªç„¶è¯­è¨€å¤„ç†ã€è¯­éŸ³è¯†åˆ«ã€æ¨èç³»ç»Ÿå’Œè¯ç‰©å‘ç°ç­‰å„ä¸ªé¢†åŸŸã€‚ æ›´é‡è¦çš„æ˜¯ï¼ŒMilvus äº 2020 å¹´ 1 æœˆè¢« LF AI \u0026 Data Foundation æ¥çº³ä¸ºå­µåŒ–é˜¶æ®µé¡¹ç›®ã€‚1 è´¡çŒ®ã€‚ æœ¬æ–‡åšå‡ºä»¥ä¸‹è´¡çŒ®ï¼š â€¢ ç³»ç»Ÿè®¾è®¡å’Œå®ç°ï¼ˆç¬¬ 2 èŠ‚å’Œç¬¬ 5 èŠ‚ï¼‰ï¼šæ€»ä½“è´¡çŒ®æ˜¯ Milvus çš„è®¾è®¡å’Œå®ç°ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸“é—¨æ„å»ºçš„çŸ¢é‡æ•°æ®ç®¡ç†ç³»ç»Ÿï¼Œç”¨äºç®¡ç†å¤§è§„æ¨¡åŠ¨æ€çŸ¢é‡æ•°æ®ï¼Œä»¥æ”¯æŒæ•°æ®ç§‘å­¦å’Œäººå·¥æ™ºèƒ½åº”ç”¨ ã€‚ Milvus å¼€æºäº https://github.com/milvus-io/milvusã€‚ â€¢ å¼‚æ„è®¡ç®—ï¼ˆç¬¬ 3 éƒ¨åˆ†ï¼‰ï¼šæˆ‘ä»¬é’ˆå¯¹å…·æœ‰ç°ä»£ CPU å’Œ GPU çš„å¼‚æ„ç¡¬ä»¶å¹³å°ä¼˜åŒ– Milvusï¼Œä»¥å®ç°å¿«é€ŸæŸ¥è¯¢å¤„ç†ã€‚ å¯¹äºé¢å‘ CPU çš„è®¾è®¡ï¼Œæˆ‘ä»¬å»ºè®®ç¼“å­˜æ„ŸçŸ¥å’Œ SIMD æ„ŸçŸ¥ï¼ˆä¾‹å¦‚ SSEã€AVXã€AVX2ã€AVX512ï¼‰ä¼˜åŒ–ã€‚ å¯¹äºé¢å‘ GPU çš„è®¾è®¡ï¼Œæˆ‘ä»¬è®¾è®¡äº†ä¸€ç§æ–°çš„æ··åˆç´¢å¼•ï¼Œå……åˆ†åˆ©ç”¨äº† CPU å’Œ GPU çš„ä¼˜ç‚¹ï¼Œå¹¶ä¸”æˆ‘ä»¬è¿˜å¼€å‘äº†ä¸€ç§æ–°çš„è°ƒåº¦ç­–ç•¥æ¥æ”¯æŒå¤šä¸ª GPU è®¾å¤‡ã€‚ â€¢ é«˜çº§æŸ¥è¯¢å¤„ç†ï¼ˆç¬¬ 4 èŠ‚ï¼‰ï¼šé™¤äº†ç®€å•çš„å‘é‡ç›¸ä¼¼æ€§æœç´¢ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜æ”¯æŒ Milvus ä¸­çš„å±æ€§è¿‡æ»¤å’Œå¤šå‘é‡æŸ¥è¯¢å¤„ç†ã€‚ ç‰¹åˆ«æ˜¯ï¼Œæˆ‘ä»¬è®¾è®¡äº†ä¸€ç§æ–°çš„åŸºäºåˆ†åŒºçš„å±æ€§è¿‡æ»¤ç®—æ³•å’Œä¸¤ç§ç”¨äºå¤šå‘é‡æŸ¥è¯¢å¤„ç†çš„ç®—æ³•ï¼ˆå‘é‡èåˆå’Œè¿­ä»£åˆå¹¶ï¼‰ã€‚ â€¢ æ–°é¢–çš„åº”ç”¨ç¨‹åºï¼ˆç¬¬ 6 èŠ‚ï¼‰ï¼šæˆ‘ä»¬æè¿°ç”± Milvus æä¾›æ”¯æŒçš„æ–°é¢–çš„åº”ç”¨ç¨‹åºã€‚ ç‰¹åˆ«æ˜¯ï¼Œæˆ‘ä»¬åœ¨ Milvus ä¹‹ä¸Šæ„å»ºäº†ä¸€ç³»åˆ— 10 ä¸ªåº”ç”¨ç¨‹åºï¼Œä»¥å±•ç¤ºå…¶å¹¿æ³›çš„é€‚ç”¨æ€§ï¼ŒåŒ…æ‹¬å›¾åƒæœç´¢ã€è§†é¢‘æœç´¢ã€åŒ–å­¦ç»“æ„åˆ†æã€COVID-19 æ•°æ®é›†æœç´¢ã€ä¸ªæ€§åŒ–æ¨èã€ç”Ÿç‰©å¤šå› ç´ è®¤è¯ã€æ™ºèƒ½é—®ç­”ã€å›¾åƒ-æ–‡æœ¬æ£€ç´¢ã€è·¨æ¨¡å¼è¡Œäººæœç´¢å’Œé£Ÿè°±é£Ÿç‰©æœç´¢ ","date":"2024-02-25","objectID":"/posts/milvus-paper/:3:0","tags":["Paper Reading"],"title":"Paper Reading: Milvus A Purpose-Built Vector Data Management System","uri":"/posts/milvus-paper/"},{"categories":null,"content":"SYSTEM DESIGN ä¸‹æ¬¡å†è¯» ","date":"2024-02-25","objectID":"/posts/milvus-paper/:4:0","tags":["Paper Reading"],"title":"Paper Reading: Milvus A Purpose-Built Vector Data Management System","uri":"/posts/milvus-paper/"},{"categories":null,"content":"VBase: Unifying Online Vector Similarity Search and Relational Queries via Relaxed Monotonicity VBase: é€šè¿‡ Relaxed Monotonicity (æ¾å¼›å•è°ƒæ€§) ç»Ÿä¸€åœ¨çº¿çŸ¢é‡ç›¸ä¼¼æ€§æœç´¢å’Œå…³ç³»æŸ¥è¯¢ ","date":"2024-02-17","objectID":"/posts/vbase-paper/:1:0","tags":["Paper Reading"],"title":"Paper Reading: VBase: Unifying Online Vector Similarity Search and Relational Queries via Relaxed Monotonicity","uri":"/posts/vbase-paper/"},{"categories":null,"content":"Abstract åŸºäºé«˜ç»´å‘é‡ç´¢å¼•çš„è¿‘ä¼¼ç›¸ä¼¼åº¦æŸ¥è¯¢ approximate similarity querieså·²ç»æˆä¸ºè®¸å¤šå…³é”®åœ¨çº¿æœåŠ¡çš„åŸºç¡€ã€‚å¯¹æ›´å¤æ‚çš„å‘é‡æŸ¥è¯¢çš„æ—¥ç›Šå¢é•¿çš„éœ€æ±‚è¦æ±‚å°†å‘é‡æœç´¢ç³»ç»Ÿä¸å…³ç³»æ•°æ®åº“é›†æˆåœ¨ä¸€èµ·ã€‚ç„¶è€Œï¼Œé«˜ç»´å‘é‡ç›˜ä¸è¡¨ç°å•è°ƒæ€§ï¼Œè€Œå•è°ƒæ€§æ˜¯å¸¸è§„æŒ‡æ ‡çš„ä¸€ä¸ªé‡è¦æ€§è´¨ã€‚ç¼ºä¹å•è°ƒæ€§è¿«ä½¿ç°æœ‰çš„å‘é‡ç³»ç»Ÿä¾èµ–äº monotonicity-preserving tentative indicesï¼ˆä¸ºç›®æ ‡çŸ¢é‡çš„ TopK è¿‘é‚»ä¸´æ—¶è®¾ç½®ï¼‰æ¥æ–¹ä¾¿æŸ¥è¯¢ï¼Œç”±äºéš¾ä»¥é¢„æµ‹æœ€ä¼˜ Kï¼Œè¿™å°†å¯¼è‡´æ¬¡ä¼˜æ€§èƒ½ã€‚æœ¬æ–‡ä»‹ç»çš„ VBASE ç³»ç»Ÿèƒ½æœ‰æ•ˆæ”¯æŒè¿‘ä¼¼ç›¸ä¼¼æ€§æœç´¢å’Œå…³ç³»è¿ç®—ç¬¦çš„å¤æ‚æŸ¥è¯¢ã€‚VBASE å‘ç°äº†ä¸€ä¸ªå…±åŒå±æ€§ relaxed monotonicity æ¾å¼›å•è°ƒæ€§ï¼Œä»è€Œå°†ä¸¤ä¸ªçœ‹ä¼¼ä¸å…¼å®¹çš„ç³»ç»Ÿç»Ÿä¸€èµ·æ¥ã€‚è¿™ä¸€å…±åŒå±æ€§ä½¿ VBASE èƒ½å¤Ÿè§„é¿ä»… TopK çš„é™åˆ¶ï¼Œä»è€Œæ˜¾è‘—æé«˜æ•ˆç‡ï¼ŒåŒæ—¶è¯æ˜å®ƒä¿ç•™äº†åŸºäº TopK çš„è¯­ä¹‰ã€‚è¯„ä¼°ç»“æœè¡¨æ˜ï¼Œåœ¨å¤æ‚çš„åœ¨çº¿å‘é‡æŸ¥è¯¢ä¸­ï¼ŒVBASE çš„æ€§èƒ½æ¯”æœ€å…ˆè¿›çš„å‘é‡ç³»ç»Ÿé«˜å‡ºä¸‰ä¸ªæ•°é‡çº§ã€‚VBASE è¿˜èƒ½è¿›è¡Œåˆ†ææ€§ç›¸ä¼¼æ€§æŸ¥è¯¢ analytical similarity queriesï¼Œè€Œä»¥å¾€çš„å‘é‡ç³»ç»Ÿåˆ™æ— æ³•åšåˆ°è¿™ä¸€ç‚¹ï¼Œè€Œä¸”åœ¨ç²¾ç¡®æŸ¥è¯¢æ–¹é¢ï¼ŒVBASE æé«˜äº† 7000x speedup çš„åŒæ—¶å‡†ç¡®ç‡è¾¾åˆ° 99.9%ã€‚ ","date":"2024-02-17","objectID":"/posts/vbase-paper/:2:0","tags":["Paper Reading"],"title":"Paper Reading: VBase: Unifying Online Vector Similarity Search and Relational Queries via Relaxed Monotonicity","uri":"/posts/vbase-paper/"},{"categories":null,"content":"Introduction æ·±åº¦å­¦ä¹ ï¼ˆembeddingï¼‰æ¨¡å‹çš„æœ€æ–°è¿›å±•æ˜¯å°†å‡ ä¹æ‰€æœ‰ç±»å‹çš„æ•°æ®ï¼ˆå¦‚å›¾åƒã€è§†é¢‘ã€æ–‡æ¡£ï¼‰æ˜ å°„æˆé«˜ç»´å‘é‡ã€‚å¯¹é«˜ç»´å‘é‡çš„æŸ¥è¯¢å¯ä»¥è¿›è¡Œå¤æ‚çš„è¯­ä¹‰åˆ†æï¼Œè¿™åœ¨ä»¥å‰å³ä½¿ä¸æ˜¯ä¸å¯èƒ½ï¼Œä¹Ÿæ˜¯å¾ˆå›°éš¾çš„ï¼Œå› æ­¤å®ƒä»¬æˆä¸ºè®¸å¤šé‡è¦åœ¨çº¿æœåŠ¡çš„åŸºçŸ³ï¼Œå¦‚æœç´¢ã€ç”µå­å•†åŠ¡å’Œæ¨èç³»ç»Ÿã€‚è¿™äº›æœåŠ¡çš„ â€œåœ¨çº¿â€ æ€§è´¨è¦æ±‚çŸ¢é‡æœç´¢ä»¥æ¯«ç§’ä¸ºå•ä½å®Œæˆã€‚è¿™ç§ä¸¥æ ¼çš„å»¶è¿Ÿè¦æ±‚ä¸ç²¾ç¡®æœç´¢ç®—æ³•çš„å›ºæœ‰é«˜æˆæœ¬ç›¸å†²çªï¼Œè¿«ä½¿ç»ˆç«¯ç”¨æˆ·åªèƒ½é€‰æ‹©é«˜ç»´å‘é‡ä¸Šçš„è¿‘ä¼¼æŸ¥è¯¢ç»“æœã€‚éšç€æ–°çš„çŸ¢é‡æœç´¢åº”ç”¨ä¸æ–­æ¶Œç°ï¼ŒçŸ¢é‡æŸ¥è¯¢å˜å¾—è¶Šæ¥è¶Šå¤æ‚ï¼Œé€šå¸¸æ¶‰åŠæ ‡é‡æ•°æ®å’ŒçŸ¢é‡æ•°æ®çš„æ··åˆæœç´¢ã€‚è¿™è‡ªç„¶è€Œç„¶åœ°æ¨åŠ¨äº†çŸ¢é‡æœç´¢ç³»ç»Ÿä¸å…³ç³»æ•°æ®åº“çš„æ•´åˆã€‚ çŸ¢é‡æœç´¢å’Œæ•°æ®åº“ç³»ç»Ÿä½¿ç”¨ç´¢å¼•çš„æ–¹å¼å„ä¸ç›¸åŒï¼Œè€Œç´¢å¼•æ˜¯åŠ å¿«æŸ¥è¯¢é€Ÿåº¦çš„å…³é”®ç»“æ„ã€‚ä¼ ç»Ÿç´¢å¼•ï¼ˆå¦‚ B-Treeï¼‰çš„ä¸€ä¸ªé‡è¦ç‰¹æ€§æ˜¯å•è°ƒæ€§ã€‚è¿™ä¸€ç‰¹æ€§ç¡®ä¿äº†æŸ¥è¯¢å¯ä»¥åœ¨ç´¢å¼•çš„å¼•å¯¼ä¸‹æ²¿ç€æŸä¸ªæ–¹å‘å•è°ƒåœ°éå†æ•°æ®é›†ã€‚è¿™é€šå¸¸å¯ä»¥é¿å…æ€»æ•°æ®æ‰«æï¼Œä»è€Œæé«˜æŸ¥è¯¢æ‰§è¡Œæ•ˆç‡ã€‚ç„¶è€Œï¼Œç”±äºç»´åº¦è¯…å’’ï¼ˆcurse of dimensionalityï¼‰ï¼Œå¯¹äºé«˜ç»´å‘é‡ç´¢å¼•æ¥è¯´ï¼Œä¿æŒå•è°ƒæ€§çš„ä»£ä»·è¿‡äºæ˜‚è´µã€‚å–è€Œä»£ä¹‹çš„æ˜¯ï¼Œå®ƒä»¬é€šå¸¸è¢«ç»„ç»‡æˆå›¾æˆ–åŸºäºèšç±»çš„ä¸è§„åˆ™ç»“æ„ï¼Œè¿™ç§ç»“æ„è¿‘ä¼¼äºå•è°ƒæ€§ã€‚éå†è¿™æ ·çš„å‘é‡ç´¢å¼•å¹¶ä¸èƒ½ä¿è¯ç›®æ ‡å‘é‡è·ç¦»çš„ä¸¥æ ¼å•è°ƒæ€§ï¼Œä½†å®ƒèƒ½è®©ç³»ç»Ÿæœ‰æ•ˆåœ°ç¡®å®šæ–°çš„éå†ä½•æ—¶ä¸å¤ªå¯èƒ½åˆ°è¾¾æ¯”å½“å‰ K ä¸ªå‘é‡æ›´æ¥è¿‘ç›®æ ‡çš„å‘é‡ã€‚å› æ­¤ï¼Œç°ä»£å‘é‡ç´¢å¼•åªæ”¯æŒè¿‘ä¼¼ TopKï¼Œå³è¿‘ä¼¼æŸ¥æ‰¾ K ä¸ªè¿‘é‚»ã€‚TopK æŸ¥è¯¢ä¼šéå†å‘é‡ç´¢å¼•è¶³å¤Ÿå¤šçš„æ­¥æ•°ï¼Œç›´åˆ°ç¡®å®šä¸å¯èƒ½æ‰¾åˆ°æ¯”å½“å‰ K ä¸ªæœ€è¿‘å‘é‡æ›´è¿‘çš„é‚»å±…ä¸ºæ­¢ã€‚ ä¸ºäº†æ•´åˆå‘é‡æœç´¢å’Œæ•°æ®åº“ç³»ç»Ÿï¼Œç°æœ‰çš„å‘é‡æ•°æ®åº“ç³»ç»Ÿé€‰æ‹©äº†ä¸¥æ ¼çš„å•è°ƒæ€§ã€‚ä¸ºäº†æ”¯æŒ TopK ä»¥å¤–çš„ç›¸ä¼¼æ€§æŸ¥è¯¢ï¼Œå®ƒä»¬é¦–å…ˆåˆ©ç”¨ TopK æ”¶é›† K ä¸ªå‘é‡ï¼Œç„¶åæ ¹æ®ä¸ç›®æ ‡å‘é‡çš„è·ç¦»å¯¹ K ä¸ªå‘é‡è¿›è¡Œæ’åºï¼Œè¿™æ ·å°±å»ºç«‹äº†ä¸€ä¸ªä¿æŒå•è°ƒæ€§çš„ä¸´æ—¶ç´¢å¼•ã€‚å› æ­¤ï¼Œå¤æ‚çš„å…³ç³»è¿ç®—ç¬¦å¯ä»¥æŒ‰ä¼ ç»Ÿæ–¹å¼åœ¨ä¸´æ—¶ç´¢å¼•ä¸Šæ‰§è¡Œã€‚è€ƒè™‘ä¸‹é¢çš„å‘é‡æœç´¢æŸ¥è¯¢ï¼šâ€œæŸ¥æ‰¾ X ä¸ªä¸å›¾ç‰‡æœ€ç›¸ä¼¼ä½†ä½äºæŸä¸€ä»·æ ¼çš„äº§å“â€ã€‚æ•°æ®åº“è§„åˆ’è€…é¦–å…ˆä¼šåœ¨å›¾åƒåµŒå…¥çš„å‘é‡å±æ€§ä¸Šè¿è¡Œå‘é‡æœç´¢è¿ç®—ç¬¦ï¼Œä»¥æ‰¾åˆ° K ä¸ªæœ€è¿‘çš„å›¾å…ƒï¼Œç„¶ååœ¨ä»·æ ¼å±æ€§ä¸Šåº”ç”¨è¿‡æ»¤è¿ç®—ç¬¦ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬æ— æ³•å‡†ç¡®é¢„æµ‹æœ‰å¤šå°‘å›¾å…ƒä¼šé€šè¿‡è¿‡æ»¤è¿ç®—ç¬¦ï¼Œè¿™ä¸ªæ•°å­—å¯èƒ½è¿œå°äº Kã€‚å› æ­¤ï¼Œè¿™ç§åšæ³•æœ¬èº«å°±éš¾ä»¥ç¡®å®šèƒ½äº§ç”Ÿç²¾ç¡® X ç»“æœçš„æœ€ä½³ Kã€‚å› æ­¤ï¼Œå®ƒè¦ä¹ˆé‡‡ç”¨ä¿å®ˆçš„å¤§ K è®¾ç½®ï¼Œè¦ä¹ˆé‡‡ç”¨å¤šä¸ª K çš„åå¤è¯•éªŒï¼Œè¿™ä¸¤ç§æ–¹æ³•éƒ½ä¼šå¯¼è‡´æ¬¡ä¼˜æŸ¥è¯¢æ€§èƒ½ã€‚ åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº† VBASEï¼Œè¿™æ˜¯ä¸€ä¸ªæ–°ç³»ç»Ÿï¼Œèƒ½å¤Ÿé«˜æ•ˆåœ°ä¸ºå¤æ‚çš„åœ¨çº¿æŸ¥è¯¢æä¾›æœåŠ¡ï¼Œè¿™äº›æŸ¥è¯¢æ—¢æ¶‰åŠè¿‘ä¼¼ç›¸ä¼¼æ€§æœç´¢ï¼Œä¹Ÿæ¶‰åŠæ ‡é‡å’ŒçŸ¢é‡æ•°æ®é›†ä¸Šçš„å…³ç³»è¿ç®—ç¬¦ã€‚VBASE å°†æ¾å¼›å•è°ƒæ€§ï¼ˆRelaxed Monotonicityï¼‰ä½œä¸ºä»å‘é‡æœç´¢ç³»ç»Ÿå’Œå…³ç³»æ•°æ®åº“è¿™ä¸¤ä¸ªçœ‹ä¼¼ä¸åŒçš„ç³»ç»Ÿä¸­æŠ½è±¡å‡ºæ¥çš„å…±åŒå±æ€§ã€‚æ¾å¼›å•è°ƒæ€§è¦æ±‚ç´¢å¼•éå†ä»…è¿‘ä¼¼éµå¾ªå•è°ƒæ€§ã€‚æˆ‘ä»¬è§‚å¯Ÿåˆ°ï¼Œæœ€å…ˆè¿›çš„çŸ¢é‡ç´¢å¼•éƒ½ä»¥ä¸¤é˜¶æ®µæ¨¡å¼éµå¾ªæ¾å¼›å•è°ƒæ€§å±æ€§ï¼šç´¢å¼•éå†é¦–å…ˆè¿‘ä¼¼å®šä½ç¦»ç›®æ ‡çŸ¢é‡æœ€è¿‘çš„åŒºåŸŸï¼Œç„¶åä»¥è¿‘ä¼¼æ–¹å¼é€æ­¥è¿œç¦»ç›®æ ‡åŒºåŸŸã€‚åŸºäºè¿™ä¸€è§‚å¯Ÿç»“æœï¼Œæˆ‘ä»¬æ­£å¼å®šä¹‰äº† â€œæ¾å¼›å•è°ƒæ€§ â€œå±æ€§ï¼Œå®ƒæŠ½è±¡äº†å¤§å¤šæ•°ç°æœ‰çŸ¢é‡ç´¢å¼•å·²ç»å…·å¤‡çš„æ ¸å¿ƒç´¢å¼•éå†æ¨¡å¼ã€‚æ¾å¼›å•è°ƒæ€§å¯ä»¥çœ‹ä½œæ˜¯å•è°ƒæ€§çš„ä¸€ç§å¹¿ä¹‰å½¢å¼ï¼Œå› æ­¤ä¹Ÿé€‚ç”¨äºä¼ ç»Ÿçš„æ ‡é‡ç´¢å¼•ï¼Œå¦‚ B-Treeã€‚å› æ­¤ï¼Œæ¾å¼›å•è°ƒæ€§å¯ä»¥ä½œä¸ºçŸ¢é‡æœç´¢å’Œæ•°æ®åº“ç³»ç»Ÿçš„å…±åŒåŸºç¡€ é€šè¿‡æ¾å¼›å•è°ƒæ€§ï¼ŒVBASE å»ºç«‹äº†ä¸€ä¸ªç»Ÿä¸€çš„æŸ¥è¯¢æ‰§è¡Œå¼•æ“ï¼Œä»¥æ”¯æŒå¯¹æ ‡é‡å’ŒçŸ¢é‡æ•°æ®çš„å„ç§æŸ¥è¯¢ï¼ŒåŒ…æ‹¬è·¨å¤šä¸ªå¼‚æ„ç´¢å¼•çš„æŸ¥è¯¢ queries across multiple heterogeneous indicesã€‚VBASE çš„ç»Ÿä¸€å¼•æ“åŸºäº Next æ¥å£ï¼Œè€Œä¸æ˜¯ TopKï¼Œä»¥æ”¯æŒå‘é‡å’Œæ ‡é‡ç´¢å¼•çš„éå†ã€‚åŒæ—¶ï¼Œè¯¥å¼•æ“å…è®¸ä»æ¾å¼›å•è°ƒæ€§ä¸­æ¨å¯¼å‡ºé€šç”¨ç»ˆæ­¢æ¡ä»¶ï¼Œä»¥ä¾¿åŠæ—¶åœæ­¢æŸ¥è¯¢çš„æ‰§è¡Œã€‚ VBASE çš„ç‹¬ç‰¹ä¹‹å¤„åœ¨äºå…¶åŸºäºæ¾å¼›å•è°ƒæ€§çš„æŸ¥è¯¢æ‰§è¡Œå¼•æ“å¯ä»¥è¯æ˜å…¶æŸ¥è¯¢ç»“æœä¸æœ€ä¼˜ K çš„ TopKonly è§£å†³æ–¹æ¡ˆæ‰€äº§ç”Ÿçš„æŸ¥è¯¢ç»“æœç›¸å½“ã€‚è¿™ä¸€å¼ºå¤§çš„ç‰¹æ€§ä½¿ VBASE èƒ½å¤Ÿè§„é¿ TopKonly æ¥å£çš„é™åˆ¶ï¼Œåœ¨ä¿ç•™åŸºäº TopK çš„æŸ¥è¯¢è¯­ä¹‰çš„åŒæ—¶ï¼Œæ˜¾è‘—æé«˜æ•ˆç‡ã€‚ç‰¹åˆ«æ˜¯ï¼ŒåŸºäºæ¨å¯¼å‡ºçš„å¹¿ä¹‰ç»ˆæ­¢æ¡ä»¶ï¼ŒVBASE èƒ½å¤Ÿåœ¨ç´¢å¼•éå†è¿‡ç¨‹ä¸­æ£€æµ‹ Kï¼Œè€Œæ— éœ€é¢„æµ‹ Kã€‚å¯¹äºæ¯” TopK æœç´¢æ›´å¤æ‚çš„æŸ¥è¯¢ï¼ŒVBASE å¯ä»¥åœ¨ç»“æœå‡†ç¡®æ€§ç›¸ä¼¼ï¼ˆå³ç›¸åŒç”šè‡³æ›´å¥½çš„ recallsï¼‰çš„æƒ…å†µä¸‹ï¼Œå®ç°æ¯”æœ€å…ˆè¿›ç³»ç»Ÿä½è¾¾ä¸‰ä¸ªæ•°é‡çº§çš„å¹³å‡å’Œå°¾éƒ¨æŸ¥è¯¢å»¶è¿Ÿã€‚ æ­¤å¤–ï¼Œé€šè¿‡æ”¾æ¾å•è°ƒæ€§ï¼ŒVBASE ç”šè‡³å¯ä»¥æ”¯æŒä»¥å¾€ç³»ç»Ÿä¸æ”¯æŒçš„è¿‘ä¼¼æŸ¥è¯¢ç±»å‹ï¼Œå¹¶æ˜¾ç¤ºå‡ºå“è¶Šçš„æŸ¥è¯¢æ€§èƒ½å’Œå‡†ç¡®æ€§ã€‚ä¾‹å¦‚ï¼ŒVBASE å¯ä»¥åœ¨ 16 ç§’å†…å®Œæˆ join-based vector query with 99.9%+ recall rateï¼Œæ¯”æš´åŠ›è¡¨æ‰«æå¿« 7000 å€ã€‚ æ€»ä¹‹ï¼Œæœ¬æ–‡åšå‡ºäº†ä»¥ä¸‹è´¡çŒ®ï¼š VBASE ç¡®å®šå¹¶æ­£å¼å®šä¹‰äº† â€œæ¾å¼›å•è°ƒæ€§ Relaxed Monotonicity\"ï¼Œè¿™ä¸€ç‰¹æ€§é¦–æ¬¡æ­ç¤ºäº†ç²¾å¿ƒè®¾è®¡çš„å‘é‡æŒ‡æ•°çš„æ ¸å¿ƒï¼Œä»¥åŠå®ƒä»¬åœ¨å®è·µä¸­æœ‰æ•ˆå·¥ä½œçš„åŸå› ã€‚ VBASE åŸºäºæ¾å¼›å•è°ƒæ€§æ„å»ºäº†ä¸€ä¸ªç»Ÿä¸€æ•°æ®åº“å¼•æ“ï¼Œå¯åˆ©ç”¨çŸ¢é‡å’Œæ ‡é‡æ•°æ®ç´¢å¼•è¿›è¡ŒåŠŸèƒ½å¼ºå¤§çš„å¤æ‚æŸ¥è¯¢ã€‚ æˆ‘ä»¬è¯æ˜äº† VBASE çš„ç»Ÿä¸€å¼•æ“ä½¿ç”¨å‘é‡ç´¢å¼•äº§ç”Ÿçš„ç»“æœä¸çº¯ TopK æ–¹æ³•ç›¸å½“ï¼Œå…¶ execution plan æ¯”çº¯ TopK æ–¹æ³•æ›´æœ‰æ•ˆã€‚ æˆ‘ä»¬åœ¨ PostgreSQL çš„åŸºç¡€ä¸Šå®ç°äº† VBASEï¼Œåªå¢åŠ äº† 2000 è¡Œä»£ç ï¼Œå¹¶å±•ç¤ºäº†å¯¹æ··åˆ 100 ä¸‡é…æ–¹æ•°æ®é›†ä¸Šçš„å…«ä¸ªå¤æ‚ SQL æŸ¥è¯¢çš„ç«¯åˆ°ç«¯è¯„ä¼°ï¼Œè¿™äº›æ•°æ®é›†æ—¢æœ‰çŸ¢é‡å±æ€§ï¼Œä¹Ÿæœ‰æ ‡é‡å±æ€§ã€‚æˆ‘ä»¬è®¡åˆ’å°† VBASE å¼€æºï¼Œä»¥æ»¡è¶³äººå·¥æ™ºèƒ½æ—¶ä»£æ–°å‡ºç°çš„é‡è¦çŸ¢é‡åˆ†æåº”ç”¨ã€‚ ","date":"2024-02-17","objectID":"/posts/vbase-paper/:3:0","tags":["Paper Reading"],"title":"Paper Reading: VBase: Unifying Online Vector Similarity Search and Relational Queries via Relaxed Monotonicity","uri":"/posts/vbase-paper/"},{"categories":null,"content":"Background ","date":"2024-02-17","objectID":"/posts/vbase-paper/:4:0","tags":["Paper Reading"],"title":"Paper Reading: VBase: Unifying Online Vector Similarity Search and Relational Queries via Relaxed Monotonicity","uri":"/posts/vbase-paper/"},{"categories":null,"content":"Emerging Online Vector Queries åœ¨äººå·¥æ™ºèƒ½æ—¶ä»£ï¼ŒçŸ¢é‡å·²æˆä¸ºä¸€ç§é‡è¦çš„æ•°æ®è¡¨ç¤ºå½¢å¼ã€‚æ·±åº¦å­¦ä¹ å·²ç»ä¿ƒæˆäº†è¶Šæ¥è¶Šå¤šä»¥å‘é‡ä¸ºä¸­å¿ƒçš„åœ¨çº¿åº”ç”¨ï¼ŒåŒ…æ‹¬åŸºäºåµŒå…¥çš„æ£€ç´¢ã€äººè„¸è¯†åˆ«ã€ä»£ç æ£€ç´¢ã€é—®é¢˜è§£ç­”ã€è°·æ­Œå¤šé‡æœç´¢ã€Facebook è¿‘ä¼¼é‡å¤æ£€æµ‹ç­‰ã€‚æœ€è¿‘ï¼Œäººå·¥æ™ºèƒ½åº”ç”¨åˆ©ç”¨ ChatGPT çš„æ£€ç´¢æ’ä»¶ï¼Œå°†å…¶ä¸“æœ‰çŸ¥è¯†ã€ä¸ªäººæ–‡æ¡£å’ŒèŠå¤©ä¸Šä¸‹æ–‡è½¬æ¢æˆå‘é‡ã€‚è¿™æ ·å°±èƒ½æ£€ç´¢åˆ°æœ‰ä»·æ ¼ã€ç±»åˆ«ã€åœ°ç‚¹æˆ–æ—¶é—´é™åˆ¶çš„ç›¸å…³å‘é‡ï¼Œä»è€Œåœ¨èŠå¤©ä¸­æ„å»ºæç¤ºã€‚ ä¼ ç»Ÿåº”ç”¨ä¹Ÿå—ç›Šäºäººå·¥æ™ºèƒ½çš„å‘é‡ã€‚ä¾‹å¦‚ï¼Œæœç´¢å¼•æ“å°†ç½‘ç»œæ–‡æ¡£è½¬åŒ–ä¸ºè¯è¢‹ç¨€ç–å‘é‡å’Œæ·±åº¦å­¦ä¹ å¡«å……å¯†é›†å‘é‡ï¼Œä»¥æé«˜æœç´¢ç»“æœçš„ç›¸å…³æ€§ã€‚è€Œæ¨èç³»ç»Ÿåˆ™å°†å›¾ç‰‡ã€è§†é¢‘å’Œå•†å“æè¿°è½¬åŒ–ä¸ºä¸åŒçš„å‘é‡ã€‚ç»“åˆå•†å“ä»·æ ¼å’Œç±»åˆ«ç­‰æ ‡é‡æ•°æ®ï¼Œè¿™äº›å‘é‡å¯ç”¨äºæå‡æ¨èä½“éªŒã€‚ æ‰€æœ‰è¿™äº›éƒ½éœ€è¦ä¸€ä¸ªé€šç”¨ç³»ç»Ÿæ¥é«˜æ•ˆè¿è¡Œå¤æ‚çš„çŸ¢é‡å’Œæ ‡é‡æŸ¥è¯¢ã€‚æ€»ä¹‹ï¼Œè¿™äº›å‘é‡åº”ç”¨åœºæ™¯å¯åˆ†ä¸ºä»¥ä¸‹å‡ ç±»ã€‚ S1: åŸºäºåµŒå…¥çš„æ£€ç´¢ã€æ¨èå’Œé—®é¢˜è§£ç­”åŸºæœ¬ä¸Šéƒ½æ˜¯åœ¨ç»™å®šæŸ¥è¯¢å‘é‡çš„æƒ…å†µä¸‹ï¼Œåœ¨å‘é‡æ•°æ®é›†ä¸­æœç´¢ K ä¸ªæœ€æ¥è¿‘çš„å‘é‡ã€‚è¿™ç±»æŸ¥è¯¢å¯ä»¥å¾ˆè‡ªç„¶åœ°ç”¨å•å‘é‡åˆ—ä¸Šçš„ TopK è¿ç®—ç¬¦æ¥è¡¨è¾¾ã€‚ S2ï¼šå•çŸ¢é‡ TopK åŠ æ ‡é‡å±æ€§è¿‡æ»¤ã€‚åœ¨æŸäº›æ ‡é‡å±æ€§é™åˆ¶æ¡ä»¶ä¸‹ï¼Œè¿˜éœ€è¦æ‰¾åˆ° TopK ç»“æœã€‚Google Multisearch å°±å±äºè¿™ä¸€ç±»ã€‚å®ƒå…è®¸ç”¨æˆ·åœ¨è¿›è¡Œç›¸ä¼¼æ€§å›¾åƒæœç´¢æ—¶æä¾›é¢å¤–çš„æ–‡æœ¬æç¤ºã€‚ S3: å¤šåˆ— TopKã€‚æœ‰äº›çŸ¢é‡åˆ†æéœ€è¦å°†ä¸åŒçŸ¢é‡å±æ€§çš„å¤šä¸ª TopK æœç´¢ç»“æœè¿›è¡Œäº¤å‰ã€‚ä¾‹å¦‚ï¼Œå›¾åƒ-é£Ÿè°±æ£€ç´¢ æ˜¯ä¸€ç§å¯¹ï¼ˆçŸ¢é‡åŒ–ï¼‰æˆåˆ†å…³é”®è¯å’Œèœè‚´å›¾åƒæ ·æœ¬çš„å¤šæ¨¡æ€æ•°æ®å±æ€§è¿›è¡Œçš„é£Ÿè°±æœç´¢ã€‚æœ€è¿‘çš„ç ”ç©¶è¡¨æ˜ï¼Œå¤šåˆ— TopK æœç´¢å¯ä»¥æé«˜é—®é¢˜è§£ç­”ç­‰åº”ç”¨çš„ç»“æœè´¨é‡ã€‚ S4: å‘é‡ç›¸ä¼¼æ€§è¿‡æ»¤å™¨ã€‚ç›¸ä¼¼æ€§è¿‡æ»¤æ˜¯å…¸å‹çš„å‘é‡åˆ†æåº”ç”¨åœºæ™¯ã€‚ä¾‹å¦‚ï¼Œäººè„¸è¯†åˆ«å’Œ Facebook çš„è¿‘ä¹å®Œå…¨é‡å¤æ£€æµ‹éƒ½æ˜¯ä»å…·æœ‰ç›¸ä¼¼æ€§é˜ˆå€¼çš„æ•°æ®é›†ä¸­æœç´¢ç›¸ä¼¼å›¾åƒï¼ˆç»™å®šå›¾åƒï¼‰ã€‚ä¸ºäº†æ”¯æŒè¿™ç±»åº”ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŸºäºä¸¤å¼ å›¾ç‰‡ä¹‹é—´è·ç¦»ç›¸ä¼¼æ€§çš„çŸ¢é‡è¿‡æ»¤ï¼Œå³åŸºäºè·ç¦»çš„èŒƒå›´æŸ¥è¯¢ã€‚æ‰€æœ‰è¿™äº›çŸ¢é‡æŸ¥è¯¢ç±»å‹éƒ½æœ‰ä¸¥æ ¼çš„å»¶è¿Ÿè¦æ±‚ï¼ˆå¦‚æ¯«ç§’ï¼‰ã€‚é—æ†¾çš„æ˜¯ï¼Œç°æœ‰ç³»ç»Ÿéƒ½æ— æ³•å…¨é¢æœ‰æ•ˆåœ°æ”¯æŒæ‰€æœ‰è¿™äº›åœ¨çº¿ç›¸ä¼¼æ€§æŸ¥è¯¢ï¼ˆè§è¡¨ 1ï¼‰ã€‚ ","date":"2024-02-17","objectID":"/posts/vbase-paper/:4:1","tags":["Paper Reading"],"title":"Paper Reading: VBase: Unifying Online Vector Similarity Search and Relational Queries via Relaxed Monotonicity","uri":"/posts/vbase-paper/"},{"categories":null,"content":"The Division Between Databases and Vector Search Systems è™½ç„¶æ•°æ®åº“å¯ä»¥é€šè¿‡å…³ç³»ä»£æ•°æ¥è¡¨è¾¾ä¸Šè¿°æŸ¥è¯¢ï¼Œä½†ç”±äºå‘é‡ç´¢å¼•å’Œä¼ ç»Ÿæ•°æ®åº“ç´¢å¼•åœ¨è¯­ä¹‰ä¸Šå­˜åœ¨åˆ†æ­§ï¼Œå› æ­¤å¾ˆéš¾æä¾›ä¸€ä¸ªç»Ÿä¸€çš„ç³»ç»Ÿæ¥é«˜æ•ˆè¿è¡Œå„ç±»å¤æ‚çš„åœ¨çº¿å‘é‡æŸ¥è¯¢ï¼Œå¦‚è¡¨ 1 æ‰€ç¤ºã€‚ å…³ç³»æ•°æ®åº“ã€‚å…³ç³»æ•°æ®åº“æ˜¯è¿è¡Œå¤æ‚æŸ¥è¯¢çš„æœ€ä¸»è¦å·¥å…·ä¹‹ä¸€ã€‚ä¸ºäº†æ»¡è¶³ä½å»¶è¿Ÿçš„ â€œåœ¨çº¿â€ è¦æ±‚ï¼Œæ•°æ®åº“å¹¿æ³›é‡‡ç”¨ç´¢å¼•æ¥åŠ é€ŸæŸ¥è¯¢æ‰§è¡Œï¼Œå¦‚ B æ ‘ã€B+ æ ‘ç­‰ã€‚è¿™äº›ç´¢å¼•å…·æœ‰å•è°ƒæ€§ï¼ˆmonotonicityï¼‰ï¼Œè¿™ç§ç‰¹æ€§å…è®¸æŸ¥è¯¢æ²¿æŸä¸ªæ–¹å‘å•è°ƒåœ°éå†ç´¢å¼•ï¼Œä¾‹å¦‚ï¼ŒæŒ‰é™åºæˆ–å‡åºéå†ã€‚ åœ¨æ–°å…´å‘é‡åœºæ™¯ä¸­ï¼Œæœ€é‡è¦çš„åœ¨çº¿æŸ¥è¯¢ç±»å‹ä¹‹ä¸€æ˜¯ TopK æŸ¥è¯¢ã€‚è€Œä¼ ç»Ÿçš„æ•°æ®åº“ç´¢å¼•å¯ä»¥é€šè¿‡æŒ‰å‡åºæˆ–é™åºéå†ç´¢å¼•å¹¶åœ¨æ”¶é›†åˆ° K ä¸ªç»“æœåç«‹å³ç»ˆæ­¢æŸ¥è¯¢æ¥åŠ å¿« TopK çš„é€Ÿåº¦ã€‚è¿™ç§ä¼˜åŒ–é€‚ç”¨äºè®¸å¤š TopK å˜ä½“ï¼Œå¦‚ TopK + è¿‡æ»¤å’Œå¤šåˆ— TopK æŸ¥è¯¢ã€‚ç„¶è€Œï¼Œè¿™ç§ä¼˜åŒ–çš„æœ‰æ•ˆæ€§ä¾èµ–äºå•è°ƒæ€§å‡è®¾ï¼Œè€Œé«˜ç»´å‘é‡ç´¢å¼•å¹¶ä¸éµå¾ªå•è°ƒæ€§å‡è®¾ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°†è¯¦ç»†è¯´æ˜ã€‚ Approximate vector search è¿‘ä¼¼å‘é‡æœç´¢ï¼šæœ€è¿‘ï¼Œäººå·¥æ™ºèƒ½æ¨¡å‹çš„çˆ†å‘äº§ç”Ÿäº†å¤§é‡ä¸”ä¸æ–­å¢é•¿çš„é«˜ç»´å‘é‡æ•°æ®ã€‚ä¸ºäº†è·å¾—æ›´å¥½çš„å­¦ä¹ è¡¨ç¤ºï¼Œä¸€ä¸ªå‘é‡å¯ä»¥æœ‰æ•°ç™¾ä¸ªç»´åº¦ã€‚ç”±äºç»´åº¦è¯…å’’ï¼Œæ²¡æœ‰ä»»ä½•è§£å†³æ–¹æ¡ˆèƒ½åœ¨äºšçº¿æ€§æ—¶é—´å†…å®Œæˆé«˜ç»´å‘é‡æŸ¥è¯¢ã€‚ä¸ºäº†åº”å¯¹ â€œåœ¨çº¿â€ åœºæ™¯ï¼Œç°ä»£å‘é‡æœç´¢ç³»ç»Ÿé‡‡ç”¨è¿‘ä¼¼æ–¹æ³•ï¼Œåœ¨ä¿æŒç›¸å¯¹è¾ƒé«˜çš„ç»“æœå‡†ç¡®ç‡ï¼ˆ90% ä»¥ä¸Šçš„å¬å›ç‡ï¼‰çš„åŒæ—¶ï¼Œå¤§å¹…é™ä½æŸ¥è¯¢å»¶è¿Ÿï¼ˆæ¯«ç§’çº§ï¼‰ã€‚è¿™äº›ç³»ç»Ÿé€šå¸¸è¢«ç§°ä¸ºè¿‘ä¼¼è¿‘é‚»æœç´¢ï¼ˆapproximate nearest neighbor search ANNSï¼‰ç³»ç»Ÿã€‚ ä¸å…³ç³»æ•°æ®åº“ä¸€æ ·ï¼ŒçŸ¢é‡ç´¢å¼•ä¹Ÿè¢«ç”¨æ¥ä¿ƒè¿›è¿‘ä¼¼çŸ¢é‡æœç´¢ã€‚æœ‰ä»£è¡¨æ€§çš„çŸ¢é‡ç´¢å¼•æˆ–ä»¥åˆ†åŒºçš„å½¢å¼ç»„ç»‡ï¼ˆåŸºäºèšç±»ã€å“ˆå¸Œã€é«˜ç»´æ ‘ï¼Œæˆ–ä»¥é‚»åŸŸå›¾ï¼‰ã€‚åœ¨é«˜ç»´ç©ºé—´ä¸­å®šä½ä¸€ä¸ªå‘é‡çš„éš¾åº¦è¿«ä½¿è¿™äº›å‘é‡ç´¢å¼•å¯¹è¿‘ä¼¼ TopK è¿›è¡Œä¼˜åŒ–ã€‚åœ¨ TopK æŸ¥è¯¢ä¸­ï¼Œç´¢å¼•éå†ç”±æŸ¥è¯¢å‘é‡ q å¼•å¯¼ï¼Œæ ¹æ® q ä¸æŸäº›é”šç‚¹ï¼ˆå¦‚ç¾¤é›†ä¸­å¿ƒç‚¹æˆ–é‡‡æ ·å›¾é¡¶ç‚¹ï¼‰ä¹‹é—´çš„è·ç¦»ï¼Œè¿‘ä¼¼åœ°å‘æœ€è¿‘çš„é‚»å±…è¿‚å›å‰è¿›ã€‚åœ¨éå†è¿‡ç¨‹ä¸­ï¼Œq çš„æ–¹å‘å¯èƒ½ä¼šå‘ç”Ÿå·¨å¤§å˜åŒ–ï¼Œå› æ­¤è¯¥è¿‡ç¨‹ä¸èƒ½ä¿è¯åœ¨æ¯ä¸€æ­¥éå†ä¸­éƒ½æ¥è¿‘ qï¼Œè€Œä¸”å‘é‡ç´¢å¼•éå†ä¹Ÿä¸æ˜¯å•è°ƒçš„ã€‚ çŸ¢é‡ç´¢å¼•ç¼ºä¹å•è°ƒæ€§ä½¿å¾—æ•°æ®åº“ç³»ç»Ÿæ— æ³•ç›´æ¥ä½¿ç”¨çŸ¢é‡ç´¢å¼•æ¥åŠ é€ŸæŸ¥è¯¢ï¼Œè¿™ä¹Ÿæ˜¯æ•°æ®åº“å’ŒçŸ¢é‡æœç´¢ç³»ç»Ÿä¹‹é—´äº§ç”Ÿåˆ†æ­§çš„ä¸»è¦åŸå› ã€‚ åŸºäº TopK çš„è§£å†³æ–¹æ¡ˆæ¶ˆé™¤ divisionï¼šç”±äºçŸ¢é‡ç´¢å¼•æ˜¯ä¸º TopK ä¼˜åŒ–çš„ï¼ŒANNS ç³»ç»Ÿåªæä¾›ä¸€ä¸ª TopK æ¥å£ã€‚ä¸ºäº†ç¼©å°æ•°æ®åº“å’ŒçŸ¢é‡æœç´¢ç³»ç»Ÿä¹‹é—´çš„å•è°ƒæ€§å·®è·ï¼Œç›®å‰çš„åšæ³•æ˜¯ä½¿ç”¨ ANNS TopK æ¥å£ï¼Œæ ¹æ®ä¸ç›®æ ‡çŸ¢é‡çš„è·ç¦»æ’åºçš„ K ä¸ªçŸ¢é‡åˆ›å»ºæš‚å®šç´¢å¼•ã€‚è¿™ç§æš‚å®šç´¢å¼•èƒ½ä¿æŒå•è°ƒæ€§ï¼Œä»è€Œåœ¨æ•°æ®åº“ä¸­å®ç°å¿«é€ŸçŸ¢é‡æŸ¥è¯¢å¤„ç†ã€‚ ç„¶è€Œï¼ŒåŸºäº TopK çš„æš‚å®šç´¢å¼•è§£å†³æ–¹æ¡ˆå¹¶ä¸ä»¤äººæ»¡æ„ã€‚è¦é¢„æµ‹æš‚å®šç´¢å¼• K çš„æ­£ç¡®å¤§å°æ˜¯å¾ˆå›°éš¾çš„ï¼Œç”šè‡³æ˜¯ä¸å¯èƒ½çš„ï¼Œå› ä¸ºåœ¨æŸ¥è¯¢ä¸­ï¼Œå¸¦æœ‰è¿‡æ»¤çº¦æŸçš„åç»­å…³ç³»è¿ç®—ç¬¦å¯ä»¥æ”¶é›†åˆ°æ­£ç¡®æ•°é‡çš„ç»“æœã€‚è¿™ç§é™åˆ¶æ™®éé€‚ç”¨äº TopK + è¿‡æ»¤æŸ¥è¯¢ã€å‘é‡ç›¸ä¼¼æ€§è¿‡æ»¤æŸ¥è¯¢ç­‰ã€‚å› æ­¤ï¼ŒåŸºäº TopK çš„æš‚å®šç´¢å¼•ä¸å¯é¿å…åœ°ä¼šå¯¼è‡´ä¿å®ˆåœ°é€‰æ‹©ä¸€ä¸ªéå¸¸å¤§çš„ Kï¼Œæˆ–è€…å¯¹ä¸åŒå¤§å°çš„ K è¿›è¡Œåå¤è¯•éªŒï¼Œè¿™éƒ½ä¼šäº§ç”Ÿè¿‡å¤šçš„æ•°æ®è®¿é—®å’Œè®¡ç®—é‡ã€‚ ","date":"2024-02-17","objectID":"/posts/vbase-paper/:4:2","tags":["Paper Reading"],"title":"Paper Reading: VBase: Unifying Online Vector Similarity Search and Relational Queries via Relaxed Monotonicity","uri":"/posts/vbase-paper/"},{"categories":null,"content":"VBASE Design ","date":"2024-02-17","objectID":"/posts/vbase-paper/:5:0","tags":["Paper Reading"],"title":"Paper Reading: VBase: Unifying Online Vector Similarity Search and Relational Queries via Relaxed Monotonicity","uri":"/posts/vbase-paper/"},{"categories":null,"content":"Relaxed Monotonicity ä¸ä¼ ç»Ÿæ ‡é‡ç´¢å¼•ä¸åŒï¼Œé«˜ç»´å‘é‡ç´¢å¼•æ˜¯ä¸ºè¿‘ä¼¼ TopK è€Œè®¾è®¡çš„ï¼Œå¹¶ä¸éµå¾ªå•è°ƒæ€§ã€‚å›¾ 1 æ˜¾ç¤ºäº† FAISS IVVFlat å’Œ HNSW è¿™ä¸¤ç§å¸¸ç”¨çŸ¢é‡ç´¢å¼•çš„ TopK éå†æ¨¡å¼ã€‚å¦‚å›¾æ‰€ç¤ºï¼ŒçŸ¢é‡æŒ‡æ•°éå†ä¸ç¬¦åˆå•è°ƒæ€§ï¼Œéšç€éå†çš„è¿›è¡Œï¼Œåˆ°ç›®æ ‡çŸ¢é‡çš„è·ç¦»ä¼šå‡ºç°ä¸å¯é¢„æµ‹çš„æ³¢åŠ¨ã€‚ç”±äºè¿™äº›çŸ¢é‡ç´¢å¼•ç¼ºä¹å•è°ƒæ€§ï¼Œå…³ç³»æ•°æ®åº“æ— æ³•ç›´æ¥ä½¿ç”¨å®ƒä»¬æ¥åŠ é€ŸæŸ¥è¯¢ã€‚ ä¸¤é˜¶æ®µå‘é‡ç´¢å¼•éå†æ¨¡å¼ï¼šå°½ç®¡å¦‚æ­¤ï¼Œå›¾ 1 æ˜¾ç¤ºäº†ä¸¤ä¸ªçŸ¢é‡ç´¢å¼•çš„ä¸¤é˜¶æ®µç´¢å¼•éå†æ¨¡å¼ã€‚åœ¨ç¬¬ä¸€é˜¶æ®µï¼Œå°½ç®¡çŸ¢é‡è·ç¦»æœ‰è¾ƒå¤§æ³¢åŠ¨ï¼Œä½†ç´¢å¼•éå†å¤§è‡´æ¥è¿‘ç›®æ ‡çŸ¢é‡åŒºåŸŸã€‚åœ¨ç¬¬äºŒé˜¶æ®µï¼ŒæŒ‡æ•°éå†è¶‹äºç¨³å®šï¼Œå¹¶ä»¥è¿‘ä¼¼æ–¹å¼ç¨³æ­¥åç¦»ç›®æ ‡çŸ¢é‡åŒºåŸŸã€‚è¿™ç§ä¸¤é˜¶æ®µéå†æ¨¡å¼åœ¨æˆ‘ä»¬ç ”ç©¶çš„å¤§å¤šæ•°å‘é‡æŒ‡æ•°ä¸­éƒ½å¾ˆå¸¸è§ã€‚æˆ‘ä»¬è®¤ä¸ºï¼Œè®¾è®¡è‰¯å¥½çš„çŸ¢é‡ç´¢å¼•çš„æœ¬è´¨æ˜¯ä¸€ç§æœ‰æ•ˆçš„æ•°æ®ç»“æ„ï¼Œå®ƒéšå«äº†è¿™ç§éå†æ¨¡å¼ã€‚å› æ­¤ï¼Œå½“ TopK æœç´¢æŸ¥è¯¢è¿›å…¥ç¬¬äºŒé˜¶æ®µæ—¶ï¼Œç”±äºè¿›ä¸€æ­¥éå†ä¸å¯èƒ½è¯†åˆ«å‡ºæ›´å¤šç›¸ä¼¼å‘é‡ï¼Œå› æ­¤å¯ä»¥æå‰ç»ˆæ­¢ã€‚æ¾å¼›å•è°ƒæ€§çš„æ­£å¼å®šä¹‰ã€‚æ ¹æ®ä¸¤é˜¶æ®µéå†æ¨¡å¼ï¼Œæˆ‘ä»¬å¯ä»¥æ­£å¼å®šä¹‰ â€œæ¾å¼›å•è°ƒæ€§â€ï¼ˆRelaxed Monotonicityï¼‰ï¼Œä»¥ç¡®å®šå‘é‡ç´¢å¼•éå†æ˜¯å¦å·²è¿›å…¥ç¬¬äºŒé˜¶æ®µã€‚è¯¥å®šä¹‰å»ºç«‹åœ¨å‘é‡ TopK æœç´¢å†…éƒ¨æ‰§è¡Œæ–¹å¼çš„ç›´è§‚åŸºç¡€ä¹‹ä¸Š å›¾ 2 å±•ç¤ºäº†å¯¹æŸ¥è¯¢å‘é‡ q è¿›è¡Œä¸€èˆ¬å‘é‡æœç´¢çš„è¿‡ç¨‹ã€‚å›¾ä¸­è™šçº¿ç®­å¤´è¡¨ç¤ºä¸ q ç›¸å…³çš„ç´¢å¼•éå†è·¯å¾„ã€‚åœ¨é«˜ç»´ç©ºé—´ä¸­ï¼Œq çš„é‚»åŸŸç”±ä»¥ q ä¸ºä¸­å¿ƒçš„é‚»åŸŸçƒå®šä¹‰ï¼Œå¦‚å›¾ 2 ä¸­çš„åœ†å½¢æ‰€ç¤ºã€‚ä¹‹åï¼Œç´¢å¼•éå†ç¦»å¼€çƒä½“ï¼Œè¿›å…¥ç¬¬äºŒé˜¶æ®µã€ åœ¨è¿™ä¸€é˜¶æ®µï¼ŒæŸ¥è¯¢å¯ä»¥ç»ˆæ­¢ã€‚ å›¾ 2ï¼šæ¾å¼›å•è°ƒæ€§ç›´è§‚ç¤ºæ„å›¾ã€‚å‘é‡æŸ¥è¯¢ q æ²¿ç€éå†è·¯å¾„çš„å‰è¿›æ–¹å‘å‘ç°äº† q ä¸ E ä¸ªæœ€è¿‘å‘é‡çš„é‚»åŸŸã€ å›¾ 2 æ˜¾ç¤ºï¼Œè¦ç¡®å®šæ˜¯å¦è¿›å…¥ç¬¬äºŒé˜¶æ®µï¼ŒæŸ¥è¯¢éœ€è¦äº†è§£ä»¥ q ä¸ºä¸­å¿ƒçš„é‚»åŸŸçƒåŠå¾„ Rqï¼Œä»¥åŠæŸ¥è¯¢çš„å½“å‰ç´¢å¼•éå†ä½ç½®ï¼ˆè¡¨ç¤ºä¸ºéå†æ­¥é•¿ sï¼‰ä¸ q ä¹‹é—´çš„è·ç¦» Msq æ˜¯å¦å¤§äº Rqï¼Œå³æ˜¯å¦è¶…å‡ºäº† q çš„é‚»åŸŸã€‚ å½¢å¼ä¸Šï¼ŒRqï¼ˆq é‚»åŸŸçš„åŠå¾„ï¼‰å®šä¹‰ä¸ºï¼š Rq = Max(To pE({Distance(q,v j )|j âˆˆ[1,s âˆ’1]})), (1) å…¶ä¸­ To pE è¡¨ç¤º éå†è¿‡ç¨‹ä¸­è§‚å¯Ÿåˆ°çš„ q çš„ E ä¸ªæœ€è¿‘é‚»ï¼Œå‡è®¾åˆ°ç›®å‰ä¸ºæ­¢éå†å·²ç»åˆ°è¾¾æ­¥éª¤ sã€‚ å¯¹äº K ä¸ªæœ€è¿‘å‘é‡æœç´¢æŸ¥è¯¢ï¼Œéœ€è¦ E â‰¥K æ‰èƒ½äº§ç”Ÿè¶³å¤Ÿçš„æœ€ç»ˆç»“æœã€‚ åœ¨å›¾ 2 ä¸­ï¼Œåœ†åœˆå†…çš„ E å‘é‡æ˜¯è¿„ä»Šä¸ºæ­¢è®¿é—®çš„æ‰€æœ‰ s ä¸ªå‘é‡ä¸­ q çš„æœ€è¿‘é‚»ã€‚ åœ¨ç´¢å¼•éå†è¿‡ç¨‹ä¸­ï¼Œçƒä½“åŠå¾„ Rq åœ¨ç¬¬ 1 é˜¶æ®µä¼šé€æ¸å‡å°ï¼Œå¹¶åœ¨ç¬¬ 2 é˜¶æ®µå˜å¾—ç¨³å®šã€‚ ç»™å®š Rq çš„å®šä¹‰ï¼Œç³»ç»Ÿéœ€è¦å®šä¹‰ Msqï¼Œå³ç›®æ ‡å‘é‡ q ä¸å½“å‰ç´¢å¼•éå†ä½ç½®ä¹‹é—´çš„è·ç¦»æµ‹é‡ï¼Œè¡¨ç¤ºä¸ºéå†æ­¥é•¿ sã€‚ ç„¶åä½¿ç”¨ Msq æ¥åˆ¤æ–­éå†æ˜¯å¦è¿›å…¥é˜¶æ®µ 2ï¼Œå³ç¦»å¼€é‚»å±…çƒä½“ã€‚ æ•°å­¦ä¸Šï¼ŒMsq è¢«å®šä¹‰ä¸ºæœ€è¿‘ w æ­¥ä¸­éå†çš„æ‰€æœ‰å‘é‡åˆ° q çš„ä¸­å€¼è·ç¦»ï¼Œå³éå†çª—å£ã€‚ Msq = Median({Distance(q,vi)|i âˆˆ[s âˆ’w +1,s]}), (2) å…¶ä¸­ Distance(q,vi) è¡¨ç¤º q ä¸å‘é‡ vi ä¹‹é—´çš„è·ç¦»ï¼Œåœ¨è¿‡å»çš„éå†ä¸­ çª—æˆ·ã€‚ è¯·æ³¨æ„ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸­ä½æ•°è€Œä¸æ˜¯å‡å€¼æ¥å¿½ç•¥éå†çª—å£ä¸­çš„ä»»ä½•ç¦»ç¾¤å‘é‡ï¼Œè¿™äº›å‘é‡ä¸ q çš„è·ç¦»æ¯”å…¶ä»–å‘é‡è¿‡å¤§æˆ–è¿‡å°ã€‚ ä¾‹å¦‚å›¾ 2 æ‰€ç¤ºéå†çª—å£ä¸­æœ€å·¦è¾¹å’Œæœ€å³è¾¹ä½ç½®çš„ä¸¤ä¸ªç¦»ç¾¤å€¼å‘é‡ã€‚ çœ‹ä¸æ‡‚ Summarization: The paper identifies a common property, relaxed monotonicity, to unify two seemingly incompatible systems: vector search systems and relational databases, and proposes VBase that can handle complex queries of both approximate similarity search and relational operators on high-dimensional vector data. Relaxed monotonicity allows VBase to circumvent the constraints of a TopK-only interface and achieve significantly higher efficiency, while provably preserving the semantics of TopK-based solutions. The paper also presents a PostgreSQL-based implementation of VBase and compares it with other open source systems. Contribution: The paper introduces the concept of relaxed monotonicity, a property that can unify vector similarity search and relational queries, and leverages it to perform early termination of vector search. VBase builds a unified database engine based on relaxed monotonicity and modifies the original topk vector query interface so that the vector index can continuously spit out results to downstream operators, it can be easily connected to the volcano model of traditional relational databases. VBase has the same accuracy as the pure TopK method, and the execution plan is more efficient The paper implements VBASE based on PostgreSQL, adding only 2,000 additional lines of code, and compares it with other open source systems. It shows that VBase achieves up to three orders-of-magnitude higher performance than state-of-the-art vector systems on complex online vector queries. Limitation Key concepts and algorithms lack relatively clear definitions and descriptions, and there may be some confusion. It does not provide a clear and formal definition of relaxed monotonicity, the cost estimation and query planning methods. The paper does not discuss the limitations and assumptions of the relaxed monotonicity property. For example, how does it cope with dynamic and evolving data and queries? Improve: Run a series of hybrid queries on VBase and AnalyticDB-V systems, and measure their performance and accuracy using various metrics. Analyze the results and identify the strengths and weaknesses of both systems since they both combine vector similarity search and relational queries. Provide more rigorous and formal definitions and proofs of the relaxed monotonicity, the cost estimation and query planning methods, and discuss their limitations and assumptions to help to clarify and validate the core concept of the paper. ","date":"2024-02-17","objectID":"/posts/vbase-paper/:5:1","tags":["Paper Reading"],"title":"Paper Reading: VBase: Unifying Online Vector Similarity Search and Relational Queries via Relaxed Monotonicity","uri":"/posts/vbase-paper/"},{"categories":null,"content":"ç¬¬äºŒç« ï¼šæ•°æ®æ¨¡å‹ä¸æŸ¥è¯¢è¯­è¨€ æ•°æ®æ¨¡å‹å¯èƒ½æ˜¯è½¯ä»¶å¼€å‘ä¸­æœ€é‡è¦çš„éƒ¨åˆ†äº†ï¼Œå› ä¸ºå®ƒä»¬çš„å½±å“å¦‚æ­¤æ·±è¿œï¼šä¸ä»…ä»…å½±å“ç€è½¯ä»¶çš„ç¼–å†™æ–¹å¼ï¼Œè€Œä¸”å½±å“ç€æˆ‘ä»¬çš„ è§£é¢˜æ€è·¯ã€‚ å¤šæ•°åº”ç”¨ä½¿ç”¨å±‚å±‚å åŠ çš„æ•°æ®æ¨¡å‹æ„å»ºã€‚ ç°å®ä¸–ç•Œï¼šé‡‡ç”¨å¯¹è±¡æˆ–æ•°æ®ç»“æ„ï¼Œä»¥åŠæ“æ§é‚£äº›æ•°æ®ç»“æ„çš„ API æ¥è¿›è¡Œå»ºæ¨¡ å­˜å‚¨æ•°æ®ç»“æ„ï¼Œé€šç”¨æ•°æ®æ¨¡å‹å¦‚ JSON æˆ– XML æ–‡æ¡£ã€å…³ç³»æ•°æ®åº“ä¸­çš„è¡¨æˆ–å›¾æ¨¡å‹ã€‚ å†…å­˜ã€ç£ç›˜æˆ–ç½‘ç»œä¸Šçš„å­—èŠ‚æ¥è¡¨ç¤º JSON / XML/ å…³ç³» / å›¾æ•°æ®ã€‚è¿™ç±»è¡¨ç¤ºå½¢å¼ä½¿æ•°æ®æœ‰å¯èƒ½ä»¥å„ç§æ–¹å¼æ¥æŸ¥è¯¢ï¼Œæœç´¢ï¼Œæ“çºµå’Œå¤„ç†ã€‚ ç¡¬ä»¶å·¥ç¨‹å¸ˆå·²ç»æƒ³å‡ºäº†ä½¿ç”¨ç”µæµã€å…‰è„‰å†²ã€ç£åœºæˆ–è€…å…¶ä»–ä¸œè¥¿æ¥è¡¨ç¤ºå­—èŠ‚çš„æ–¹æ³• ä¸€ä¸ªå¤æ‚çš„åº”ç”¨ç¨‹åºå¯èƒ½ä¼šæœ‰æ›´å¤šçš„ä¸­é—´å±‚æ¬¡ï¼Œæ¯”å¦‚åŸºäº API çš„ APIï¼Œä¸è¿‡åŸºæœ¬æ€æƒ³ä»ç„¶æ˜¯ä¸€æ ·çš„ï¼šæ¯ä¸ªå±‚éƒ½é€šè¿‡æä¾›ä¸€ä¸ªæ˜ç¡®çš„æ•°æ®æ¨¡å‹æ¥éšè—æ›´ä½å±‚æ¬¡ä¸­çš„å¤æ‚æ€§ã€‚è¿™äº›æŠ½è±¡å…è®¸ä¸åŒçš„äººç¾¤æœ‰æ•ˆåœ°åä½œï¼ˆä¾‹å¦‚æ•°æ®åº“å‚å•†çš„å·¥ç¨‹å¸ˆå’Œä½¿ç”¨æ•°æ®åº“çš„åº”ç”¨ç¨‹åºå¼€å‘äººå‘˜ï¼‰ã€‚ é€‰æ‹©ä¸€ä¸ªé€‚åˆçš„æ•°æ®æ¨¡å‹æ˜¯éå¸¸é‡è¦çš„ã€‚ æ•°æ®æ¨¡å‹åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿç”¨æ¥æè¿°ã€ç»„ç»‡ã€æ“ä½œæ•°æ®ï¼Œå¯¹ç°å®è¿›è¡ŒæŠ½è±¡ï¼Ÿ æœ¬ç« ä»‹ç»ç”¨äºæ•°æ®å­˜å‚¨å’ŒæŸ¥è¯¢çš„é€šç”¨æ•°æ®æ¨¡å‹ï¼ˆæ¯”è¾ƒå…³ç³»æ¨¡å‹ã€æ–‡æ¡£æ¨¡å‹ã€å›¾æ•°æ®æ¨¡å‹ï¼‰å’ŒæŸ¥è¯¢è¯­è¨€ï¼Œä»¥åŠå­˜å‚¨å¼•æ“å’Œæ•°æ®æ¨¡å‹å¦‚ä½•å®ç°çš„ ","date":"2024-02-10","objectID":"/posts/ddia-2/:1:0","tags":["DDIA","ç¬”è®°"],"title":"é˜…è¯»ï¼šDDIA ç¬¬äºŒç« ","uri":"/posts/ddia-2/"},{"categories":null,"content":"å…³ç³»æ¨¡å‹ä¸æ–‡æ¡£æ¨¡å‹ ç°åœ¨æœ€è‘—åçš„æ•°æ®æ¨¡å‹å¯èƒ½æ˜¯ SQLã€‚å®ƒåŸºäº Edgar Codd åœ¨ 1970 å¹´æå‡ºçš„å…³ç³»æ¨¡å‹ï¼šæ•°æ®è¢«ç»„ç»‡æˆ å…³ç³»ï¼ˆSQL ä¸­ç§°ä½œ è¡¨ï¼‰ï¼Œå…¶ä¸­æ¯ä¸ªå…³ç³»æ˜¯ å…ƒç»„ï¼ˆSQL ä¸­ç§°ä½œ è¡Œï¼‰ çš„æ— åºé›†åˆã€‚ å…³ç³»æ¨¡å‹æ›¾æ˜¯ä¸€ä¸ªç†è®ºæ€§çš„æè®®ï¼Œå½“æ—¶å¾ˆå¤šäººéƒ½æ€€ç–‘æ˜¯å¦èƒ½å¤Ÿæœ‰æ•ˆå®ç°å®ƒã€‚ç„¶è€Œåˆ°äº† 20 ä¸–çºª 80 å¹´ä»£ä¸­æœŸï¼Œå…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆRDBMSesï¼‰å’Œ SQL å·²æˆä¸ºå¤§å¤šæ•°äººä»¬å­˜å‚¨å’ŒæŸ¥è¯¢æŸäº›å¸¸è§„ç»“æ„çš„æ•°æ®çš„é¦–é€‰å·¥å…·ã€‚ å…³ç³»æ•°æ®åº“èµ·æºäºÂ·ï¼Œåœ¨ 20 ä¸–çºª 60 å¹´ä»£å’Œ 70 å¹´ä»£ç”¨å¤§å‹è®¡ç®—æœºæ¥æ‰§è¡Œã€‚ä»ä»Šå¤©çš„è§’åº¦æ¥çœ‹ï¼Œé‚£äº›ç”¨ä¾‹æ˜¾å¾—å¾ˆå¹³å¸¸ï¼šå…¸å‹çš„ äº‹åŠ¡å¤„ç†ï¼ˆå°†é”€å”®æˆ–é“¶è¡Œäº¤æ˜“ï¼Œèˆªç©ºå…¬å¸é¢„è®¢ï¼Œåº“å­˜ç®¡ç†ä¿¡æ¯è®°å½•åœ¨åº“ï¼‰å’Œ æ‰¹å¤„ç†ï¼ˆå®¢æˆ·å‘ç¥¨ï¼Œå·¥èµ„å•ï¼ŒæŠ¥å‘Šï¼‰ å½“æ—¶çš„å…¶ä»–æ•°æ®åº“è¿«ä½¿åº”ç”¨ç¨‹åºå¼€å‘äººå‘˜å¿…é¡»è€ƒè™‘æ•°æ®åº“å†…éƒ¨çš„æ•°æ®è¡¨ç¤ºå½¢å¼ã€‚å…³ç³»æ¨¡å‹è‡´åŠ›äºå°†ä¸Šè¿°å®ç°ç»†èŠ‚éšè—åœ¨æ›´ç®€æ´çš„æ¥å£ä¹‹å å¤šå¹´æ¥ï¼Œåœ¨æ•°æ®å­˜å‚¨å’ŒæŸ¥è¯¢æ–¹é¢å­˜åœ¨ç€è®¸å¤šç›¸äº’ç«äº‰çš„æ–¹æ³•ã€‚åœ¨ 20 ä¸–çºª 70 å¹´ä»£å’Œ 80 å¹´ä»£åˆï¼Œç½‘çŠ¶æ¨¡å‹ï¼ˆnetwork modelï¼‰å’Œå±‚æ¬¡æ¨¡å‹ï¼ˆhierarchical modelï¼‰æ›¾æ˜¯ä¸»è¦çš„é€‰æ‹©ï¼Œä½†å…³ç³»æ¨¡å‹ï¼ˆrelational modelï¼‰éšåå æ®äº†ä¸»å¯¼åœ°ä½ã€‚å¯¹è±¡æ•°æ®åº“åœ¨ 20 ä¸–çºª 80 å¹´ä»£æœ«å’Œ 90 å¹´ä»£åˆæ¥äº†åˆå»ã€‚XML æ•°æ®åº“åœ¨äºŒåä¸€ä¸–çºªåˆå‡ºç°ï¼Œä½†åªæœ‰å°ä¼—é‡‡ç”¨è¿‡ã€‚å…³ç³»æ¨¡å‹çš„æ¯ä¸ªç«äº‰è€…éƒ½åœ¨å…¶æ—¶ä»£äº§ç”Ÿäº†å¤§é‡çš„ç‚’ä½œï¼Œä½†ä»æ¥æ²¡æœ‰æŒç»­ã€‚ éšç€ç”µè„‘è¶Šæ¥è¶Šå¼ºå¤§å’Œäº’è”ï¼Œå®ƒä»¬å¼€å§‹ç”¨äºæ—¥ç›Šå¤šæ ·åŒ–çš„ç›®çš„ã€‚å…³ç³»æ•°æ®åº“éå¸¸æˆåŠŸåœ°è¢«æ¨å¹¿åˆ°ä¸šåŠ¡æ•°æ®å¤„ç†çš„åŸå§‹èŒƒå›´ä¹‹å¤–æ›´ä¸ºå¹¿æ³›çš„ç”¨ä¾‹ä¸Šã€‚ä½ ä»Šå¤©åœ¨ç½‘ä¸Šçœ‹åˆ°çš„å¤§éƒ¨åˆ†å†…å®¹ä¾æ—§æ˜¯ç”±å…³ç³»æ•°æ®åº“æ¥æä¾›æ”¯æŒï¼Œæ— è®ºæ˜¯åœ¨çº¿å‘å¸ƒï¼Œè®¨è®ºï¼Œç¤¾äº¤ç½‘ç»œï¼Œç”µå­å•†åŠ¡ï¼Œæ¸¸æˆï¼Œè½¯ä»¶å³æœåŠ¡ç”Ÿäº§åŠ›åº”ç”¨ç¨‹åºç­‰ç­‰å†…å®¹ã€‚ ","date":"2024-02-10","objectID":"/posts/ddia-2/:2:0","tags":["DDIA","ç¬”è®°"],"title":"é˜…è¯»ï¼šDDIA ç¬¬äºŒç« ","uri":"/posts/ddia-2/"},{"categories":null,"content":"NoSQL çš„è¯ç”Ÿ ç°åœ¨ - 2010 å¹´ä»£ï¼ŒNoSQL å¼€å§‹äº†æœ€æ–°ä¸€è½®å°è¯•ï¼Œè¯•å›¾æ¨ç¿»å…³ç³»æ¨¡å‹çš„ç»Ÿæ²»åœ°ä½ã€‚â€œNoSQLâ€ è¿™ä¸ªåå­—è®©äººé—æ†¾ï¼Œå› ä¸ºå®é™…ä¸Šå®ƒå¹¶æ²¡æœ‰æ¶‰åŠåˆ°ä»»ä½•ç‰¹å®šçš„æŠ€æœ¯ã€‚æœ€åˆå®ƒåªæ˜¯ä½œä¸ºä¸€ä¸ªé†’ç›®çš„ Twitter æ ‡ç­¾ï¼Œç”¨åœ¨ 2009 å¹´ä¸€ä¸ªå…³äºåˆ†å¸ƒå¼ï¼Œéå…³ç³»æ•°æ®åº“ä¸Šçš„å¼€æºèšä¼šä¸Šã€‚æ— è®ºå¦‚ä½•ï¼Œè¿™ä¸ªæœ¯è¯­è§¦åŠ¨äº†æŸäº›ç¥ç»ï¼Œå¹¶è¿…é€Ÿåœ¨ç½‘ç»œåˆ›ä¸šç¤¾åŒºå†…å¤–ä¼ æ’­å¼€æ¥ã€‚å¥½äº›æœ‰è¶£çš„æ•°æ®åº“ç³»ç»Ÿç°åœ¨éƒ½ä¸ #NoSQL æ ‡ç­¾ç›¸å…³è”ï¼Œå¹¶ä¸” NoSQL è¢«è¿½æº¯æ€§åœ°é‡æ–°è§£é‡Šä¸º ä¸ä»…æ˜¯ SQLï¼ˆNot Only SQLï¼‰ é‡‡ç”¨ NoSQL æ•°æ®åº“çš„èƒŒåæœ‰å‡ ä¸ªé©±åŠ¨å› ç´ ï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š éœ€è¦æ¯”å…³ç³»æ•°æ®åº“æ›´å¥½çš„å¯ä¼¸ç¼©æ€§ï¼ŒåŒ…æ‹¬éå¸¸å¤§çš„æ•°æ®é›†æˆ–éå¸¸é«˜çš„å†™å…¥ååé‡ ç›¸æ¯”å•†ä¸šæ•°æ®åº“äº§å“ï¼Œå…è´¹å’Œå¼€æºè½¯ä»¶æ›´å—åçˆ± å…³ç³»æ¨¡å‹ä¸èƒ½å¾ˆå¥½åœ°æ”¯æŒä¸€äº›ç‰¹æ®Šçš„æŸ¥è¯¢æ“ä½œ å—æŒ«äºå…³ç³»æ¨¡å‹çš„é™åˆ¶æ€§ï¼Œæ¸´æœ›ä¸€ç§æ›´å…·å¤šåŠ¨æ€æ€§ä¸è¡¨ç°åŠ›çš„æ•°æ®æ¨¡å‹ ä¸åŒçš„åº”ç”¨ç¨‹åºæœ‰ä¸åŒçš„éœ€æ±‚ï¼Œä¸€ä¸ªç”¨ä¾‹çš„æœ€ä½³æŠ€æœ¯é€‰æ‹©å¯èƒ½ä¸åŒäºå¦ä¸€ä¸ªç”¨ä¾‹çš„æœ€ä½³æŠ€æœ¯é€‰æ‹©ã€‚å› æ­¤ï¼Œåœ¨å¯é¢„è§çš„æœªæ¥ï¼Œå…³ç³»æ•°æ®åº“ä¼¼ä¹å¯èƒ½ä¼šç»§ç»­ä¸å„ç§éå…³ç³»æ•°æ®åº“ä¸€èµ·ä½¿ç”¨ - è¿™ç§æƒ³æ³•æœ‰æ—¶ä¹Ÿè¢«ç§°ä¸º æ··åˆæŒä¹…åŒ–ï¼ˆpolyglot persistenceï¼‰ã€‚ ","date":"2024-02-10","objectID":"/posts/ddia-2/:3:0","tags":["DDIA","ç¬”è®°"],"title":"é˜…è¯»ï¼šDDIA ç¬¬äºŒç« ","uri":"/posts/ddia-2/"},{"categories":null,"content":"å¯¹è±¡å…³ç³»ä¸åŒ¹é… ç›®å‰å¤§å¤šæ•°åº”ç”¨ç¨‹åºå¼€å‘éƒ½ä½¿ç”¨é¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€æ¥å¼€å‘ï¼Œè¿™å¯¼è‡´äº†å¯¹ SQL æ•°æ®æ¨¡å‹çš„æ™®éæ‰¹è¯„ï¼šå¦‚æœæ•°æ®å­˜å‚¨åœ¨å…³ç³»è¡¨ä¸­ï¼Œé‚£ä¹ˆéœ€è¦ä¸€ä¸ªç¬¨æ‹™çš„è½¬æ¢å±‚ï¼Œå¤„äºåº”ç”¨ç¨‹åºä»£ç ä¸­çš„å¯¹è±¡å’Œè¡¨ï¼Œè¡Œï¼Œåˆ—çš„æ•°æ®åº“æ¨¡å‹ä¹‹é—´ã€‚æ¨¡å‹ä¹‹é—´çš„ä¸è¿è´¯æœ‰æ—¶è¢«ç§°ä¸º é˜»æŠ—ä¸åŒ¹é…ï¼ˆimpedance mismatchï¼‰ã€‚ åƒ ActiveRecord å’Œ Hibernate è¿™æ ·çš„ å¯¹è±¡å…³ç³»æ˜ å°„ï¼ˆORM object-relational mappingï¼‰ æ¡†æ¶å¯ä»¥å‡å°‘è¿™ä¸ªè½¬æ¢å±‚æ‰€éœ€çš„æ ·æ¿ä»£ç çš„æ•°é‡ï¼Œä½†æ˜¯å®ƒä»¬ä¸èƒ½å®Œå…¨éšè—è¿™ä¸¤ä¸ªæ¨¡å‹ä¹‹é—´çš„å·®å¼‚ã€‚ ORM æ¡†æ¶å’Œæ‰‹å†™ SQL åº”è¯¥æ€ä¹ˆé€‰æ‹©ï¼Ÿ ä¾‹å¦‚ï¼Œå›¾ 2-1 å±•ç¤ºäº†å¦‚ä½•åœ¨å…³ç³»æ¨¡å¼ä¸­è¡¨ç¤ºç®€å†ï¼ˆä¸€ä¸ª LinkedIn ç®€ä»‹ï¼‰ã€‚æ•´ä¸ªç®€ä»‹å¯ä»¥é€šè¿‡ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦ user_id æ¥æ ‡è¯†ã€‚åƒ first_name å’Œ last_name è¿™æ ·çš„å­—æ®µæ¯ä¸ªç”¨æˆ·åªå‡ºç°ä¸€æ¬¡ï¼Œæ‰€ä»¥å¯ä»¥åœ¨ User è¡¨ä¸Šå°†å…¶å»ºæ¨¡ä¸ºåˆ—ã€‚ä½†æ˜¯ï¼Œå¤§å¤šæ•°äººåœ¨èŒä¸šç”Ÿæ¶¯ä¸­æ‹¥æœ‰å¤šäºä¸€ä»½çš„å·¥ä½œï¼Œäººä»¬å¯èƒ½æœ‰ä¸åŒæ ·çš„æ•™è‚²é˜¶æ®µå’Œä»»æ„æ•°é‡çš„è”ç³»ä¿¡æ¯ã€‚ä»ç”¨æˆ·åˆ°è¿™äº›é¡¹ç›®ä¹‹é—´å­˜åœ¨ä¸€å¯¹å¤šçš„å…³ç³»ï¼Œå¯ä»¥ç”¨å¤šç§æ–¹å¼æ¥è¡¨ç¤ºï¼š ä¼ ç»Ÿ SQL æ¨¡å‹ï¼ˆSQLï¼š1999 ä¹‹å‰ï¼‰ä¸­ï¼Œæœ€å¸¸è§çš„è§„èŒƒåŒ–è¡¨ç¤ºå½¢å¼æ˜¯å°†èŒä½ï¼Œæ•™è‚²å’Œè”ç³»ä¿¡æ¯æ”¾åœ¨å•ç‹¬çš„è¡¨ä¸­ï¼Œå¯¹ User è¡¨æä¾›å¤–é”®å¼•ç”¨ åç»­çš„ SQL æ ‡å‡†å¢åŠ äº†å¯¹ç»“æ„åŒ–æ•°æ®ç±»å‹å’Œ XML æ•°æ®çš„æ”¯æŒï¼›è¿™å…è®¸å°†å¤šå€¼æ•°æ®å­˜å‚¨åœ¨å•è¡Œå†…ï¼Œå¹¶æ”¯æŒåœ¨è¿™äº›æ–‡æ¡£å†…æŸ¥è¯¢å’Œç´¢å¼•ã€‚è¿™äº›åŠŸèƒ½åœ¨ Oracleï¼ŒIBM DB2ï¼ŒMS SQL Server å’Œ PostgreSQL ä¸­éƒ½æœ‰ä¸åŒç¨‹åº¦çš„æ”¯æŒã€‚JSON æ•°æ®ç±»å‹ä¹Ÿå¾—åˆ°å¤šä¸ªæ•°æ®åº“çš„æ”¯æŒï¼ŒåŒ…æ‹¬ IBM DB2ï¼ŒMySQL å’Œ PostgreSQLã€‚ ç¬¬ä¸‰ç§é€‰æ‹©æ˜¯å°†èŒä¸šï¼Œæ•™è‚²å’Œè”ç³»ä¿¡æ¯ç¼–ç ä¸º JSON æˆ– XML æ–‡æ¡£ï¼Œå°†å…¶å­˜å‚¨åœ¨æ•°æ®åº“çš„æ–‡æœ¬åˆ—ä¸­ï¼Œå¹¶è®©åº”ç”¨ç¨‹åºè§£æå…¶ç»“æ„å’Œå†…å®¹ã€‚è¿™ç§é…ç½®ä¸‹ï¼Œé€šå¸¸ä¸èƒ½ä½¿ç”¨æ•°æ®åº“æ¥æŸ¥è¯¢è¯¥ç¼–ç åˆ—ä¸­çš„å€¼ã€‚ å¯¹äºä¸€ä¸ªåƒç®€å†è¿™æ ·è‡ªåŒ…å«æ–‡æ¡£çš„æ•°æ®ç»“æ„è€Œè¨€ï¼ŒJSON è¡¨ç¤ºæ˜¯éå¸¸åˆé€‚çš„ï¼ŒJSON æ¯” XML æ›´ç®€å•ã€‚é¢å‘æ–‡æ¡£çš„æ•°æ®åº“ï¼ˆå¦‚ MongoDBï¼ŒRethinkDBï¼ŒCouchDB å’Œ Espressoï¼‰æ”¯æŒè¿™ç§æ•°æ®æ¨¡å‹ã€‚ æœ‰ä¸€äº›å¼€å‘äººå‘˜è®¤ä¸º JSON æ¨¡å‹å‡å°‘äº†åº”ç”¨ç¨‹åºä»£ç å’Œå­˜å‚¨å±‚ä¹‹é—´çš„é˜»æŠ—ä¸åŒ¹é…ã€‚ä¸è¿‡ï¼Œæ­£å¦‚æˆ‘ä»¬å°†åœ¨ ç¬¬å››ç«  ä¸­çœ‹åˆ°çš„é‚£æ ·ï¼ŒJSON ä½œä¸ºæ•°æ®ç¼–ç æ ¼å¼ä¹Ÿå­˜åœ¨é—®é¢˜ã€‚ JSON è¡¨ç¤ºæ¯” å›¾ 2-1 ä¸­çš„å¤šè¡¨æ¨¡å¼å…·æœ‰æ›´å¥½çš„ å±€éƒ¨æ€§ï¼ˆlocalityï¼‰ã€‚å¦‚æœåœ¨å‰é¢çš„å…³ç³»å‹ç¤ºä¾‹ä¸­è·å–ç®€ä»‹ï¼Œé‚£éœ€è¦æ‰§è¡Œå¤šä¸ªæŸ¥è¯¢ï¼ˆé€šè¿‡ user_id æŸ¥è¯¢æ¯ä¸ªè¡¨ï¼‰ï¼Œæˆ–è€…åœ¨ User è¡¨ä¸å…¶ä¸‹å±è¡¨ä¹‹é—´æ··ä¹±åœ°æ‰§è¡Œå¤šè·¯è¿æ¥ã€‚è€Œåœ¨ JSON è¡¨ç¤ºä¸­ï¼Œæ‰€æœ‰ç›¸å…³ä¿¡æ¯éƒ½åœ¨åŒä¸€ä¸ªåœ°æ–¹ï¼Œä¸€ä¸ªæŸ¥è¯¢å°±è¶³å¤Ÿäº†ã€‚ ä»ç”¨æˆ·ç®€ä»‹æ–‡ä»¶åˆ°ç”¨æˆ·èŒä½ï¼Œæ•™è‚²å†å²å’Œè”ç³»ä¿¡æ¯ï¼Œè¿™ç§ä¸€å¯¹å¤šå…³ç³»éšå«äº†æ•°æ®ä¸­çš„ä¸€ä¸ªæ ‘çŠ¶ç»“æ„ï¼Œè€Œ JSON è¡¨ç¤ºä½¿å¾—è¿™ä¸ªæ ‘çŠ¶ç»“æ„å˜å¾—æ˜ç¡® ","date":"2024-02-10","objectID":"/posts/ddia-2/:4:0","tags":["DDIA","ç¬”è®°"],"title":"é˜…è¯»ï¼šDDIA ç¬¬äºŒç« ","uri":"/posts/ddia-2/"},{"categories":null,"content":"å¤šå¯¹ä¸€å’Œå¤šå¯¹å¤šçš„å…³ç³» region_id å’Œ industry_id æ˜¯ä»¥ IDï¼Œè€Œä¸æ˜¯çº¯å­—ç¬¦ä¸² â€œGreater Seattle Areaâ€ å’Œ â€œPhilanthropyâ€ çš„å½¢å¼ç»™å‡ºçš„ã€‚ä¸ºä»€ä¹ˆï¼Ÿ å¦‚æœç”¨æˆ·ç•Œé¢ç”¨ä¸€ä¸ªè‡ªç”±æ–‡æœ¬å­—æ®µæ¥è¾“å…¥åŒºåŸŸå’Œè¡Œä¸šï¼Œé‚£ä¹ˆå°†ä»–ä»¬å­˜å‚¨ä¸ºçº¯æ–‡æœ¬å­—ç¬¦ä¸²æ˜¯åˆç†çš„ã€‚å¦ä¸€æ–¹å¼æ˜¯ç»™å‡ºåœ°ç†åŒºåŸŸå’Œè¡Œä¸šçš„æ ‡å‡†åŒ–çš„åˆ—è¡¨ï¼Œå¹¶è®©ç”¨æˆ·ä»ä¸‹æ‹‰åˆ—è¡¨æˆ–è‡ªåŠ¨å¡«å……å™¨ä¸­è¿›è¡Œé€‰æ‹©ï¼Œå…¶ä¼˜åŠ¿å¦‚ä¸‹ï¼š å„ä¸ªç®€ä»‹ä¹‹é—´æ ·å¼å’Œæ‹¼å†™ç»Ÿä¸€ é¿å…æ­§ä¹‰ï¼ˆä¾‹å¦‚ï¼Œå¦‚æœæœ‰å‡ ä¸ªåŒåçš„åŸå¸‚ï¼‰ æ˜“äºæ›´æ–° â€”â€” åç§°åªå­˜å‚¨åœ¨ä¸€ä¸ªåœ°æ–¹ï¼Œå¦‚æœéœ€è¦æ›´æ”¹ï¼ˆä¾‹å¦‚ï¼Œç”±äºæ”¿æ²»äº‹ä»¶è€Œæ”¹å˜åŸå¸‚åç§°ï¼‰ï¼Œå¾ˆå®¹æ˜“è¿›è¡Œå…¨é¢æ›´æ–°ã€‚ æœ¬åœ°åŒ–æ”¯æŒ â€”â€” å½“ç½‘ç«™ç¿»è¯‘æˆå…¶ä»–è¯­è¨€æ—¶ï¼Œæ ‡å‡†åŒ–çš„åˆ—è¡¨å¯ä»¥è¢«æœ¬åœ°åŒ–ï¼Œä½¿å¾—åœ°åŒºå’Œè¡Œä¸šå¯ä»¥ä½¿ç”¨ç”¨æˆ·çš„è¯­è¨€æ¥æ˜¾ç¤º æ›´å¥½çš„æœç´¢ â€”â€” ä¾‹å¦‚ï¼Œæœç´¢åç››é¡¿å·çš„æ…ˆå–„å®¶å°±ä¼šåŒ¹é…è¿™ä»½ç®€ä»‹ï¼Œå› ä¸ºåœ°åŒºåˆ—è¡¨å¯ä»¥ç¼–ç è®°å½•è¥¿é›…å›¾åœ¨åç››é¡¿è¿™ä¸€äº‹å®ï¼ˆä» â€œGreater Seattle Areaâ€ è¿™ä¸ªå­—ç¬¦ä¸²ä¸­çœ‹ä¸å‡ºæ¥ï¼‰ ","date":"2024-02-10","objectID":"/posts/ddia-2/:5:0","tags":["DDIA","ç¬”è®°"],"title":"é˜…è¯»ï¼šDDIA ç¬¬äºŒç« ","uri":"/posts/ddia-2/"},{"categories":null,"content":"DB-BERT: a databse tuning tool that reads the manual DB-BERTï¼Œä¸€ä¸ªè¯»äº†æ‰‹å†Œçš„æ•°æ®åº“è°ƒä¼˜å·¥å…· https://arxiv.org/pdf/2112.10925.pdf ","date":"2024-02-04","objectID":"/posts/llm-capability/:1:0","tags":["Paper Reading"],"title":"Paper Reading: DB-BERT: a Database Tuning Tool that â€œReads the Manualâ€","uri":"/posts/llm-capability/"},{"categories":null,"content":"Abstract DB-BERT æ˜¯ä¸€ç§æ•°æ®åº“è°ƒä¼˜å·¥å…·ï¼Œå¯åˆ©ç”¨é€šè¿‡å¯¹æ‰‹å†Œå’Œå…¶ä»–ç›¸å…³æ–‡æœ¬æ–‡æ¡£è¿›è¡Œè‡ªç„¶è¯­è¨€åˆ†æè€Œè·å¾—çš„ä¿¡æ¯ã€‚å®ƒåˆ©ç”¨æ–‡æœ¬æ¥è¯†åˆ«éœ€è¦è°ƒæ•´çš„æ•°æ®åº“ç³»ç»Ÿå‚æ•°ä»¥åŠæ¨èçš„å‚æ•°å€¼ã€‚DB-BERT åº”ç”¨é¢„å…ˆè®­ç»ƒå¥½çš„å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆç‰¹åˆ«æ˜¯ BERT æ¨¡å‹ï¼‰è¿›è¡Œæ–‡æœ¬åˆ†æã€‚åœ¨åˆå§‹è®­ç»ƒé˜¶æ®µï¼Œå®ƒä¼šå¾®è°ƒæ¨¡å‹æƒé‡ï¼Œä»¥ä¾¿å°†è‡ªç„¶è¯­è¨€æç¤ºè½¬åŒ–ä¸ºæ¨èè®¾ç½®ã€‚åœ¨è¿è¡Œæ—¶ï¼ŒDB-BERT ä¼šå­¦ä¹ æ±‡æ€»ã€è°ƒæ•´å’Œä¼˜å…ˆå¤„ç†æç¤ºï¼Œä»¥å®ç°ç‰¹å®šæ•°æ®åº“ç³»ç»Ÿå’ŒåŸºå‡†çš„æœ€ä½³æ€§èƒ½ã€‚è¿™ä¸¤ä¸ªé˜¶æ®µéƒ½æ˜¯è¿­ä»£å¼çš„ï¼Œå¹¶ä½¿ç”¨å¼ºåŒ–å­¦ä¹ æ¥æŒ‡å¯¼é€‰æ‹©è¦è¯„ä¼°çš„è°ƒæ•´è®¾ç½®ï¼ˆæƒ©ç½šæ•°æ®åº“ç³»ç»Ÿæ‹’ç»æ¥å—çš„è®¾ç½®ï¼ŒåŒæ—¶å¥–åŠ±æé«˜æ€§èƒ½çš„è®¾ç½®ï¼‰ã€‚åœ¨å®éªŒä¸­ï¼Œæˆ‘ä»¬åˆ©ç”¨æ•°ç™¾ç¯‡æœ‰å…³æ•°æ®åŸºç¡€è°ƒæ•´çš„æ–‡æœ¬æ–‡æ¡£ä½œä¸º DB-BERT çš„è¾“å…¥ã€‚æˆ‘ä»¬å°† DB-BERT ä¸ä¸åŒçš„åŸºå‡†ï¼ˆTPC-C å’Œ TPC-Hï¼‰ã€æŒ‡æ ‡ï¼ˆååé‡å’Œè¿è¡Œæ—¶é—´ï¼‰ä»¥åŠæ•°æ®åº“ç³»ç»Ÿï¼ˆPostgres å’Œ MySQLï¼‰è¿›è¡Œäº†æ¯”è¾ƒã€‚åœ¨æ‰€æœ‰æƒ…å†µä¸‹ï¼ŒDB-BERT éƒ½èƒ½åœ¨æ‰€æœ‰æ¯”è¾ƒæ–¹æ³•ä¸­æ‰¾åˆ°æœ€ä½³å‚æ•°è®¾ç½®ã€‚æºç ï¼šhttps://itrummer.github.io/dbbert/ ","date":"2024-02-04","objectID":"/posts/llm-capability/:2:0","tags":["Paper Reading"],"title":"Paper Reading: DB-BERT: a Database Tuning Tool that â€œReads the Manualâ€","uri":"/posts/llm-capability/"},{"categories":null,"content":"Introduction Give me a user manual, and Iâ€™m happy for hours. â€“ Lennon Parham When all else fails, read the instructions. â€“ Anonymous æ‰‹å†Œæ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œä¾‹å¦‚ï¼Œåœ¨å¼€å§‹è°ƒä¼˜æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆDBMSï¼‰ä¹‹å‰ï¼Œå»ºè®®å…ˆé˜…è¯»ç›¸å…³æ‰‹å†Œã€‚ä½†ä¸€ç›´ä»¥æ¥è¿™äº›æ‰‹å†Œä¼¼ä¹åªé€‚ç”¨äºäººç±»ï¼Œè€Œæ— æ³•è¢«æœºå™¨é˜…è¯»ï¼Œä½†æ˜¯éšç€åŸºäº Transformer æ¶æ„çš„ï¼Œå¼ºå¤§çš„é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹çš„å‡ºç°ï¼Œæƒ…å†µå‘ç”Ÿäº†æ”¹å˜ã€‚æœ¬æ–‡ çš„ DB-BERT å°±åŸºäº BERT æ¨¡å‹ï¼Œé€šè¿‡é˜…è¯»ï¼ˆè‡ªç„¶è¯­è¨€åˆ†æï¼‰æ•°æ®åº“æ‰‹å†Œå’Œæ•°ç™¾ä»½å…³äºè°ƒä¼˜çš„æ–‡æœ¬ï¼Œæ¥å¯»æ‰¾æ›´æœ‰å¸Œæœ›çš„æ•°æ®åº“ç³»ç»Ÿå‚æ•°è¿›è¡Œè°ƒä¼˜ã€‚ è¿‘å¹´æ¥ï¼Œä¸ºç‰¹å®šå·¥ä½œè´Ÿè½½å’Œæ€§èƒ½æŒ‡æ ‡å¯»æ‰¾ DBMS å‚æ•°ï¼ˆä¹Ÿç§° tuning knobsï¼‰çš„æœ€ä½³å‚æ•°å€¼çš„é—®é¢˜å—åˆ°äº†å¹¿æ³›å…³æ³¨ã€‚ç°åœ¨çš„ DBMS æœ‰æ•°ç™¾ä¸ªå‚æ•°ï¼Œå› æ­¤å¾ˆéš¾æ‰‹åŠ¨æ‰¾åˆ°æœ€ä½³è®¾ç½®ã€‚è¿™å°±æ¿€å‘äº†è‡ªåŠ¨å‚æ•°è°ƒæ•´çš„è®¡ç®—æ–¹æ³•ã€‚ç›®å‰çš„ä¸»æµæ–¹æ³•æ˜¯æœºå™¨å­¦ä¹ ï¼Œå°¤å…¶æ˜¯å¼ºåŒ–å­¦ä¹ ã€‚åœ¨è¿™ç§æ–¹æ³•ä¸­ï¼Œè°ƒä¼˜å·¥å…·ä¼šæ ¹æ®ç‰¹å®šè®¾ç½®çš„åŸºå‡†è¿è¡Œç»“æœï¼Œæœ‰åŸåˆ™åœ°é€‰æ‹©è¦å°è¯•çš„æ•°æ®åº“ç®¡ç†ç³»ç»Ÿå‚æ•°å€¼ç»„åˆã€‚ç„¶è€Œï¼Œè¿™ç§æ–¹æ³•æˆæœ¬é«˜æ˜‚ï¼ˆæœ€è¿‘çš„å·¥ä½œåœ¨æ¯æ¬¡è°ƒæ•´è¿‡ç¨‹ä¸­éƒ½è¦è¿›è¡Œæ•°ç™¾æ¬¡è¿­ä»£ï¼‰ï¼Œå¦‚æœèƒ½ä»¥æ•°æ®åº“ä¸“å®¶çš„æ„è§ä¸ºæŒ‡å¯¼ï¼Œé¢„å…ˆé€‰æ‹©ä¸€å°éƒ¨åˆ†è¦è°ƒæ•´çš„å‚æ•°å’Œåˆç†çš„æ•°å€¼èŒƒå›´ï¼Œæ•ˆæœä¼šæ›´å¥½ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯ç”¨é€šè¿‡åˆ†ææ–‡æœ¬æ–‡æ¡£è‡ªåŠ¨è·å–çš„ä¿¡æ¯æ¥æ›¿ä»£è¿™äº›è¾“å…¥ã€‚æˆ‘ä»¬å°†ç›¸åº”çš„é—®é¢˜ç§°ä¸ºè‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰å¢å¼ºå‹æ•°æ®åº“è°ƒæ•´ã€‚ DB-BERT ä»æ–‡æœ¬ä¸­æå–è°ƒä¼˜æç¤ºï¼Œä¸ºç‰¹å®šå‚æ•°æ¨èç‰¹å®šå€¼ã€‚è¡¨ 1 æ˜¾ç¤ºäº†å¸¦æœ‰æ¥æºçš„ç¤ºä¾‹ä»¥åŠæ¯ä¸ªæå–æç¤ºçš„ç›¸å…³æ­£å¼è¡¨ç¤ºã€‚å…¶ä¸­ä¸€äº›æç¤ºï¼ˆç¬¬äºŒä¸ªç¤ºä¾‹ï¼‰æ¨èç»å¯¹å€¼ï¼Œè€Œå¦ä¸€äº›æç¤ºï¼ˆç¬¬ä¸€ä¸ªå’Œç¬¬ä¸‰ä¸ªç¤ºä¾‹ï¼‰åˆ™æ¨èç›¸å¯¹å€¼ã€‚å¯¹äºåè€…ï¼Œå°†æç¤ºè½¬åŒ–ä¸ºå…·ä½“çš„æ¨èå€¼éœ€è¦äº†è§£ç³»ç»Ÿå±æ€§ï¼Œå¦‚ RAM çš„å¤§å°ã€‚ä¸€äº›æç¤ºï¼ˆå‰ä¸¤ä¸ªç¤ºä¾‹ï¼‰æ˜ç¡®æåˆ°äº†å‚æ•°ï¼Œè€Œå¦ä¸€äº›æç¤ºï¼ˆæœ€åä¸€ä¸ªç¤ºä¾‹ï¼‰åªæ˜¯éšå«åœ°æåˆ°äº†å‚æ•°ã€‚DB-BERT å¯ä»¥åˆ©ç”¨è¡¨ 1 ä¸­æ˜¾ç¤ºçš„æ‰€æœ‰æç¤ºã€‚ å¯¹äºç»™å®šçš„æ–‡æœ¬ç‰‡æ®µï¼ŒDB-BERT ä½¿ç”¨ BERT å˜æ¢å™¨æ¨¡å‹çš„å¾®è°ƒç‰ˆæœ¬æ¥è§£å†³å››é¡¹ä»»åŠ¡ã€‚é¦–å…ˆï¼Œå®ƒå†³å®šæ–‡æœ¬ç‰‡æ®µæ˜¯å¦åŒ…å«æç¤ºã€‚å…¶æ¬¡ï¼Œå®ƒå°†æç¤ºè½¬åŒ–ä¸ºå…¬å¼ï¼Œå¦‚è¡¨ 1 æ‰€ç¤ºã€‚è¿™å¯èƒ½éœ€è¦è§£å†³éšå¼å‚æ•°å¼•ç”¨å’Œç›¸å¯¹æ¨èçš„æ­¥éª¤ã€‚ç¬¬ä¸‰ï¼ŒDB-BERT å¯èƒ½ä¼šå†³å®šåœ¨é¢„å…ˆå®šä¹‰çš„èŒƒå›´å†…åç¦»å»ºè®®å€¼ï¼Œè€Œä¸æ˜¯å®Œå…¨ä¾èµ–æç¤ºã€‚æœ€åï¼Œè€ƒè™‘åˆ°å¤šä¸ªæ¥æºçš„æç¤ºå¯èƒ½ç›¸äº’å†²çªï¼ŒDB-BERT ä¼šä¸ºæç¤ºé€‰æ‹©æƒé‡ï¼Œä»£è¡¨å…¶ç›¸å¯¹é‡è¦æ€§ DB-BERT å¹¶ä¸åªä¾èµ–äºè°ƒä¼˜æç¤ºã€‚ç›¸åï¼Œå®ƒä½¿ç”¨è°ƒä¼˜æç¤ºä½œä¸ºåŸºäºå¼ºåŒ–å­¦ä¹ çš„è°ƒæ•´æ–¹æ³•çš„æŒ‡å¯¼ã€‚åœ¨è°ƒä¼˜è¿‡ç¨‹ä¸­ï¼ŒDB-BERT ä¼šä¸æ–­è¿­ä»£ï¼Œç›´åˆ°ç”¨æˆ·å®šä¹‰çš„ä¼˜åŒ–æ—¶é—´é¢„ç®—ç”¨å®Œä¸ºæ­¢ã€‚åœ¨æ¯æ¬¡è¿­ä»£ä¸­ï¼ŒDB-BERT éƒ½ä¼šé€‰æ‹©ä¸€ä¸ªæˆ–å¤šä¸ª DBMS é…ç½®ï¼ˆå³å‚æ•°è®¾ç½®ï¼‰è¿›è¡Œå°è¯•ã€‚DB-BERT å°†è¿™äº›è¿è¡Œè¿‡ç¨‹ä¸­è§‚å¯Ÿåˆ°çš„æ€§èƒ½ï¼ˆåœ¨ç”¨æˆ·å®šä¹‰çš„åŸºå‡†ä¸Šï¼‰è½¬åŒ–ä¸ºå¥–åŠ±å€¼ã€‚ åœ¨æœªæ¥çš„è¿­ä»£ä¸­ï¼Œè¯¥å¥–åŠ±å€¼å°†ä½¿ç”¨åŒæ·±åº¦ Q-Networks å¼ºåŒ–å­¦ä¹ ç®—æ³•æ¥æŒ‡å¯¼é…ç½®çš„é€‰æ‹©ã€‚ä¸ºäº†åº”ç”¨è¯¥ç®—æ³•ï¼Œæˆ‘ä»¬å°†æ•°æ®åº“è°ƒæ•´è¡¨è¿°ä¸ºä¸€ä¸ªå…·æœ‰ç¦»æ•£çŠ¶æ€å’Œè¡Œä¸ºçš„é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ï¼ˆMDPï¼‰ã€‚æˆ‘ä»¬å°†å¯¹æ¯ä¸ªæç¤ºçš„å¤„ç†è¡¨ç¤ºä¸ºä¸€ç³»åˆ—å†³ç­–ï¼Œç¡®å®šæç¤ºç±»å‹ï¼ˆå¦‚ç›¸å¯¹å€¼ä¸ç»å¯¹å€¼ï¼‰ä»¥åŠæç¤ºæƒé‡ã€‚ä¸ºäº†åœ¨è¿™äº›å†³ç­–ä¸­åˆ©ç”¨ NLPï¼Œæˆ‘ä»¬å°†æ¯ä¸ªå†³ç­–é€‰é¡¹ä¸æ–‡æœ¬æ ‡ç­¾ç›¸å…³è”ã€‚è¿™æ ·ï¼ŒDB-BERT å°±èƒ½ä½¿ç”¨ BERT Transformer æ¯”è¾ƒæç¤ºæ–‡æœ¬å’Œå†³ç­–æ ‡ç­¾ã€‚æˆ‘ä»¬ä»¥ç‹¬ç«‹äºç³»ç»Ÿå’ŒåŸºå‡†çš„æ–¹å¼è®­ç»ƒ DB-BERTï¼Œç„¶åå°†å…¶åº”ç”¨äºç‰¹å®šçš„è°ƒæ•´ä»»åŠ¡ã€‚åŸåˆ™ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨äººå·¥æ ‡æ³¨çš„è°ƒæ•´æ–‡æ¡£è¿›è¡Œè®­ç»ƒï¼ˆä¸ºä¸æ ‡æ³¨ä¸€è‡´çš„æç¤ºç¿»è¯‘åˆ†é…é«˜å¥–åŠ±ï¼‰ã€‚ç„¶è€Œï¼Œç”Ÿæˆè¿™æ ·çš„æ•°æ®éœ€è¦ä¸“å®¶çŸ¥è¯†ï¼Œå¾ˆéš¾å®ç°ä¼—åŒ…ï¼ˆç›¸æ¯”ä¹‹ä¸‹ï¼Œæ ‡æ³¨åªéœ€è¦å¸¸è¯†æ€§çŸ¥è¯†ï¼‰ã€‚ç›¸åï¼Œæˆ‘ä»¬åˆ©ç”¨æ•°æ®åº“ç³»ç»Ÿæœ¬èº«çš„ï¼ˆå™ªå£°ï¼‰åé¦ˆã€‚æˆ‘ä»¬å‡è®¾ï¼Œè°ƒæ•´æç¤ºå¦‚æœç¿»è¯‘æ­£ç¡®ï¼Œå¾€å¾€ä¼šæ¨èä¸ä¼šæ˜¾è‘—é™ä½æ€§èƒ½çš„å¯æ¥å—å€¼ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨è®­ç»ƒ DB-BERT æ—¶ï¼Œä¼šä¸ºç¿»è¯‘æˆå¯æ¥å—å‚æ•°è®¾ç½®ï¼ˆå³ DBMS æ¥å—è¯¥è®¾ç½®ï¼‰çš„æç¤ºåˆ†é…å¥–åŠ±ã€‚å¦ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬ä¼šå¯¹å¯¼è‡´ä¸å¯æ¥å—çš„å‚æ•°è®¾ç½®ï¼ˆå³ DBMS æ‹’ç»æ¥å—è¯¥è®¾ç½®ï¼‰æˆ–æ˜¾è‘—é™ä½ç®€å•ç¤ºä¾‹å·¥ä½œè´Ÿè½½æ€§èƒ½çš„è®¾ç½®è¿›è¡Œæƒ©ç½šã€‚ è®­ç»ƒçš„ç»“æœæ˜¯ä¸€ä¸ªæ¨¡å‹ï¼ˆå³ç»è¿‡å¾®è°ƒçš„ BERT æ¨¡å‹çš„çº¦ 1.1 äº¿ä¸ªå‚æ•°çš„æƒé‡ï¼‰ï¼Œå¯ç”¨ä½œåœ¨å…¶ä»–åŸºå‡†ä¸Šè°ƒæ•´å…¶ä»–æ•°æ®åº“ç³»ç»Ÿçš„èµ·ç‚¹ã€‚æˆ‘ä»¬åªçŸ¥é“æœ€è¿‘æœ‰ä¸€ç¯‡å…³äºåˆ©ç”¨æ–‡æœ¬æ–‡æ¡£è¿›è¡Œæ•°æ®åº“è°ƒæ•´çš„è®ºæ–‡ã€‚ä½œè€…æå‡ºäº†ä¸€ç§åŸºäºç›‘ç£å­¦ä¹ çš„ç®€å•æ–¹æ³•ã€‚è¯¥æ–¹æ³•é€šè¿‡äººå·¥æ ‡æ³¨äº†æç¤ºç¿»è¯‘çš„è°ƒæ•´æç¤ºè¿›è¡Œè®­ç»ƒã€‚ä¸æ­¤ç›¸åï¼ŒDB-BERT ä½¿ç”¨æœªæ ‡è®°çš„æ–‡æœ¬ä½œä¸ºè¾“å…¥ã€‚è¾“å…¥æ–‡æœ¬æ— éœ€äººå·¥é¢„å¤„ç†ã€‚ä¸æç¤ºç¿»è¯‘æ­¥éª¤ç›¸å…³çš„é€‰æ‹©ç”±äººå·¥æä¾›çš„æ–‡æœ¬æ ‡ç­¾ï¼ˆå…± 15 ä¸ªæ ‡ç­¾ï¼‰è¿›è¡Œæ³¨é‡Šã€‚ä¸è¿‡ï¼Œè¿™äº›æ ‡ç­¾å¹¶ä¸ä¾èµ–äºåœºæ™¯ï¼Œæˆ‘ä»¬åœ¨æ‰€æœ‰å®éªŒä¸­éƒ½ä½¿ç”¨äº†ç›¸åŒçš„æ ‡ç­¾ï¼ˆè¡¨ 3 æ˜¾ç¤ºäº† 15 ä¸ªæ ‡ç­¾ä¸­çš„ 5 ä¸ªï¼‰ã€‚è¿™åŒæ ·é€‚ç”¨äºä¸‹æ–‡ä»‹ç»çš„æ‰€æœ‰å…¶ä»–è°ƒæ•´å‚æ•°ã€‚é™¤äº†äººå·¥æ ‡æ³¨å¼€é”€æ–¹é¢çš„å·®å¼‚ï¼Œå…ˆå‰çš„æ–¹æ³•çº¯ç²¹åŸºäºè¾“å…¥æ–‡æœ¬ï¼Œæ²¡æœ‰æ•´åˆä»»ä½•æ€§èƒ½æµ‹é‡ï¼Œå› æ­¤æ— æ³•æ ¹æ®ç‰¹å®šåŸºå‡†æˆ–æŒ‡æ ‡è°ƒæ•´æ¨èã€‚ åœ¨æˆ‘ä»¬çš„å®éªŒä¸­ï¼Œæˆ‘ä»¬ä¸åä¸€é¡¹å·¥ä½œä»¥åŠæ— è¾“å…¥æ–‡æœ¬æ•°æ®åº“è°ƒæ•´çš„æœ€æ–°æ–¹æ³•è¿›è¡Œäº†æ¯”è¾ƒã€‚æˆ‘ä»¬åˆ©ç”¨é€šè¿‡å‘å¸ƒå¸¦æœ‰ç›¸å…³å…³é”®è¯çš„è°·æ­ŒæŸ¥è¯¢æŒ–æ˜å‡ºçš„å¤§å‹æ–‡æ¡£é›†ä½œä¸º DB-BERT çš„æ–‡æœ¬è¾“å…¥ã€‚æˆ‘ä»¬è€ƒè™‘äº†ä¸åŒçš„ benchmarksï¼ˆTPC-C å’Œ TPC-Hï¼‰ã€æŒ‡æ ‡ï¼ˆååé‡å’Œå»¶è¿Ÿï¼‰å’Œæ•°æ®åº“ç³»ç»Ÿï¼ˆMySQL å’Œ Postgresï¼‰ã€‚å®éªŒæ¸…æ¥šåœ°è¡¨æ˜ï¼Œé€šè¿‡æ–‡æœ¬åˆ†æè·å¾—çš„ä¿¡æ¯å¯¹ DB-BERT å¤§æœ‰è£¨ç›Šã€‚æ€»ä¹‹ï¼Œæˆ‘ä»¬çš„åŸåˆ›æ€§ç§‘å­¦è´¡çŒ®å¦‚ä¸‹ï¼š ä»‹ç»äº† DB-BERTï¼Œè¿™æ˜¯ä¸€ä¸ªç»“åˆè‡ªç„¶è¯­è¨€æ–‡æœ¬æ–‡æ¡£å’ŒåŸºå‡†è¯„ä¼°çš„è¿è¡Œæ—¶é—´åé¦ˆæ¥æŒ‡å¯¼æ•°æ®åº“è°ƒæ•´çš„ç³»ç»Ÿã€‚ æè¿°äº† DB-BERT ç”¨äºæå–ã€ä¼˜å…ˆæ’åºã€ç¿»è¯‘ã€æ±‡æ€»å’Œè¯„ä¼°è°ƒæ•´æç¤ºçš„æœºåˆ¶ã€‚ ä½¿ç”¨å¤šç§åŸºå‡†ã€æŒ‡æ ‡å’Œæ•°æ®åº“ç³»ç»Ÿå¯¹ DB-BERT è¿›è¡Œäº†å®éªŒæ€§è¯„ä¼°ï¼Œå¹¶ä¸ benchmarks è¿›è¡Œäº†æ¯”è¾ƒã€‚ æœ¬æ–‡çš„æç¤ºç»„ç»‡å¦‚ä¸‹ã€‚ç¬¬ 2 èŠ‚ä»‹ç»äº†å­¦ä¹ å’Œ NLP çš„å¿…è¦èƒŒæ™¯ã€‚ç„¶åï¼Œåœ¨ç¬¬ 3 èŠ‚ä¸­ä»‹ç»æˆ‘ä»¬çš„é—®é¢˜æ¨¡å‹å’Œæœ¯è¯­ã€‚ç¬¬ 4 èŠ‚æ¦‚è¿° DB-BERTã€‚ç„¶åï¼Œåœ¨ç¬¬ 5 èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç» DB-BERT å¦‚ä½•ä»æ–‡æœ¬æ–‡æ¡£ä¸­æå–å€™é€‰æç¤ºå¹¶å¯¹å…¶è¿›è¡Œä¼˜å…ˆæ’åºã€‚æˆ‘ä»¬åœ¨ç¬¬ 6 èŠ‚å±•ç¤º DB-BERT å¦‚ä½•ç¿»è¯‘å•ä¸ªæç¤ºï¼Œåœ¨ç¬¬ 7 èŠ‚å±•ç¤º DB-BERT å¦‚ä½•æ±‡æ€»å’Œè¯„ä¼°æç¤ºã€‚åœ¨ç¬¬ 8 èŠ‚ä¸­ï¼Œæˆ‘ä»¬æŠ¥å‘Šäº†å®éªŒç»“æœï¼Œæœ€åä»¥ç¬¬ 9 èŠ‚ä½œä¸ºç»“æŸã€‚ ","date":"2024-02-04","objectID":"/posts/llm-capability/:3:0","tags":["Paper Reading"],"title":"Paper Reading: DB-BERT: a Database Tuning Tool that â€œReads the Manualâ€","uri":"/posts/llm-capability/"},{"categories":null,"content":"Background and related work ","date":"2024-02-04","objectID":"/posts/llm-capability/:4:0","tags":["Paper Reading"],"title":"Paper Reading: DB-BERT: a Database Tuning Tool that â€œReads the Manualâ€","uri":"/posts/llm-capability/"},{"categories":null,"content":"Pre-Trained Language Models ç•¥å» LLM ä»‹ç» ","date":"2024-02-04","objectID":"/posts/llm-capability/:4:1","tags":["Paper Reading"],"title":"Paper Reading: DB-BERT: a Database Tuning Tool that â€œReads the Manualâ€","uri":"/posts/llm-capability/"},{"categories":null,"content":"Natural Language Query Interfaces è‡ªç„¶è¯­è¨€ Query Interfaces æ˜¯é¢„è®­ç»ƒæ¨¡å‹åœ¨æ•°æ®åº“ä¸­æœ€æµè¡Œçš„åº”ç”¨ã€‚åœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼Œç›¸åº”çš„æ–¹æ³•æ„æˆäº†æ–‡æœ¬åˆ° SQL ç¿»è¯‘åŸºå‡†çš„æœ€æ–°æŠ€æœ¯ï¼Œå¦‚ WikiSQL æˆ– SPIDER ã€‚å°†æ–‡æœ¬ç¿»è¯‘æˆæŸ¥è¯¢çš„é—®é¢˜ä¸ä»æ–‡æœ¬ä¸­æå–è°ƒæ•´æç¤ºçš„é—®é¢˜å…·æœ‰æŸäº›å…±åŒç‰¹ç‚¹ã€‚åœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œæ–‡æœ¬éƒ½è¢«ç¿»è¯‘æˆå½¢å¼åŒ–çš„è¡¨ç¤ºã€‚ç„¶è€Œï¼Œæ–‡æœ¬åˆ° SQL æ–¹æ³•é€šå¸¸æ˜¯å°†å•å¥ç¿»è¯‘æˆå•ä¸ª SQL æŸ¥è¯¢ï¼Œè€Œ DB-BERT åˆ™æ˜¯ä»å¤šå¥æ–‡æœ¬æ®µè½ä¸­æå–å¤šä¸ªè°ƒæ•´æç¤ºã€‚æ­¤å¤–ï¼ŒDB-BERT è¿˜å¿…é¡»å¯¹ä»å¤šä¸ªæ¥æºè·å¾—çš„ç›¸äº’å†²çªçš„æç¤ºè¿›è¡Œæ±‡æ€»å’Œä¼˜å…ˆæ’åºï¼ˆè¿™æ˜¯è‡ªç„¶è¯­è¨€æŸ¥è¯¢ç•Œé¢ä¸­æ²¡æœ‰å‡ºç°è¿‡çš„å­é—®é¢˜ï¼‰ã€‚ä¸ä¹‹å‰å¤§å¤šæ•°æœ‰å…³æ–‡æœ¬åˆ° SQL ç¿»è¯‘çš„å·¥ä½œä¸åŒï¼ŒDB-BERT å¹¶ä¸å‡å®šå­˜åœ¨æ ‡æ³¨çš„è®­ç»ƒæ ·æœ¬ ","date":"2024-02-04","objectID":"/posts/llm-capability/:4:2","tags":["Paper Reading"],"title":"Paper Reading: DB-BERT: a Database Tuning Tool that â€œReads the Manualâ€","uri":"/posts/llm-capability/"},{"categories":null,"content":"Reinforcement Learning ç•¥å»å¼ºåŒ–å­¦ä¹ ä»‹ç» å…·ä½“æ¥è¯´ï¼ŒDB-BERT ä½¿ç”¨äº†åŒæ·±åº¦ Q-Networks ç®—æ³•ã€‚è¯¥ç®—æ³•é€šè¿‡æ·±åº¦å­¦ä¹ æ¥ä¼°è®¡ç‰¹å®šçŠ¶æ€ä¸‹çš„è¡ŒåŠ¨å€¼ï¼Œä½¿ç”¨ä¸¤ä¸ªç‹¬ç«‹çš„æ¨¡å‹æ¥é€‰æ‹©è¡ŒåŠ¨å’Œè¯„ä¼°è¡ŒåŠ¨ã€‚å¼ºåŒ–å­¦ä¹ å·²è¢«ç”¨äºæ•°æ®åº“é¢†åŸŸçš„å„ç§é—®é¢˜ï¼ŒåŒ…æ‹¬è°ƒæ•´é—®é¢˜ï¼ˆæ¥ä¸‹æ¥å°†è¯¦ç»†è®¨è®ºï¼‰ã€‚ä¸ä¹‹å‰çš„å·¥ä½œä¸åŒï¼Œæˆ‘ä»¬å°†å¼ºåŒ–å­¦ä¹ ä¸ NLP ç»“åˆèµ·æ¥ï¼Œä»¥æ‰¾åˆ°æœ‰å‰æ™¯çš„å‚æ•°è®¾ç½®ã€‚æ›´å¹¿æ³›åœ°è¯´ï¼Œæˆ‘ä»¬çš„å·¥ä½œä¸ä¹‹å‰åˆ©ç”¨æ–‡æœ¬è¿›è¡Œå¼ºåŒ–å­¦ä¹ çš„å·¥ä½œç›¸è”ç³»ï¼Œç‰¹åˆ«æ˜¯ä¹‹å‰å…³äºæŒ‡ä»¤è·Ÿè¸ªçš„å·¥ä½œã€‚ä¸è¿‡ï¼Œä¹‹å‰çš„å·¥ä½œå¹¶æ²¡æœ‰è€ƒè™‘æ€§èƒ½è°ƒæ•´ï¼Œç‰¹åˆ«æ˜¯æ•°æ®åº“è°ƒæ•´ã€‚ ","date":"2024-02-04","objectID":"/posts/llm-capability/:4:3","tags":["Paper Reading"],"title":"Paper Reading: DB-BERT: a Database Tuning Tool that â€œReads the Manualâ€","uri":"/posts/llm-capability/"},{"categories":null,"content":"Database Tuning ä¹‹å‰çš„å·¥ä½œé€šè¿‡ç›‘ç£å­¦ä¹ è®­ç»ƒ Transformer æ¨¡å‹æ¥è¯†åˆ«åŒ…å«è°ƒæ•´æç¤ºçš„å¥å­ã€‚å¯¹äºè¢«å½’ç±»ä¸ºè°ƒæ•´æç¤ºçš„å¥å­ï¼Œå®ƒä¼šæ ¹æ®ç®€å•çš„å¯å‘å¼æå–å‚æ•°å’Œæ•°å€¼ã€‚è¿™ç§æ–¹æ³•ä»…ä½¿ç”¨æ–‡æœ¬è¾“å…¥ï¼Œä½†æ²¡æœ‰è¿è¡Œæ—¶åé¦ˆã€‚å®ƒä»æ–‡æ¡£é›†ä¸­æå–å›ºå®šçš„å»ºè®®é›†ï¼Œæ— æ³•é€‚åº”ç‰¹å®šçš„å·¥ä½œè´Ÿè½½å’Œæ€§èƒ½æŒ‡æ ‡ã€‚å¦ä¸€æ–¹é¢ï¼ŒDB-BERT ä»…å°†ä»æ–‡æœ¬ä¸­æå–çš„æç¤ºä½œä¸ºèµ·ç‚¹ã€‚å®ƒæ”¯æŒæ›´å¹¿æ³›çš„è°ƒæ•´æç¤ºï¼ˆå¦‚éšå«æç¤ºï¼‰ï¼Œå¹¶ä¸”åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä¸éœ€è¦æ³¨é‡Šè°ƒæ•´æç¤ºã€‚æˆ‘ä»¬åœ¨è¡¨ 2 ä¸­æ€»ç»“äº†å…¶ä¸­çš„ä¸€äº›å·®å¼‚ï¼Œå¹¶åœ¨ç¬¬ 8 èŠ‚ä¸­å¯¹è¿™ä¸¤ç§æ–¹æ³•è¿›è¡Œäº†å®éªŒæ¯”è¾ƒã€‚å¦‚ä»Šï¼Œæœºå™¨å­¦ä¹ å·²æˆä¸ºå„ç§æ•°æ®åº“ä¼˜åŒ–é—®é¢˜çš„é¦–é€‰æ–¹æ³•ï¼Œä»æŸ¥è¯¢ä¼˜åŒ–åˆ°ç‰©ç†è®¾è®¡å†³ç­–å†åˆ°æ•°æ®åº“ç³»ç»Ÿå‚æ•°è°ƒæ•´ã€‚æˆ‘ä»¬è¦è§£å†³çš„æ˜¯åä¸€ä¸ªé—®é¢˜çš„æ‰©å±•ç‰ˆæœ¬ï¼Œé€šè¿‡è‡ªç„¶è¯­è¨€æ–‡æœ¬æ–‡æ¡£æ¥æ‰©å±•è¾“å…¥å†…å®¹ã€‚ ","date":"2024-02-04","objectID":"/posts/llm-capability/:4:4","tags":["Paper Reading"],"title":"Paper Reading: DB-BERT: a Database Tuning Tool that â€œReads the Manualâ€","uri":"/posts/llm-capability/"},{"categories":null,"content":"Problem Model æˆ‘ä»¬è°ƒæ•´æ•°æ®åº“ç³»ç»Ÿå‚æ•°çš„é…ç½®ã€‚ å®šä¹‰ 3.1ï¼ˆé…ç½®ï¼‰ã€‚ æ¯ä¸ªæ•°æ®åº“ç®¡ç†ç³»ç»Ÿéƒ½ä¸ä¸€ç»„é…ç½®å‚æ•° P ç›¸å…³è”ã€‚ç”¨ V è¡¨ç¤ºå¯æ¥å—çš„å‚æ•°å€¼é›†ã€‚é…ç½®ä¸ºæ¯ä¸ªå‚æ•°åˆ†é…ä¸€ä¸ªæœ‰æ•ˆå€¼ï¼Œå¹¶è¡¨ç¤ºä¸ºä¸€ä¸ªå‡½æ•° P â†¦ Vã€‚ç­‰ä»·åœ°ï¼Œæˆ‘ä»¬å°†è¯¥å‡½æ•°è¡¨ç¤ºä¸ºå‚æ•°å€¼å¯¹çš„é›†åˆ {âŸ¨ğ‘ğ‘–,ğ‘£ğ‘–âŸ©} for ğ‘ğ‘–âˆˆ Pand ğ‘£ğ‘– âˆˆV of parameter-value pairsã€‚é…ç½®ä¸­æœªå¼•ç”¨çš„å‚æ•°ä¿æŒé»˜è®¤å€¼ã€‚ æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ‰¾åˆ°ä¼˜åŒ–æ€§èƒ½çš„é…ç½®ã€‚ä¼ ç»Ÿä¸Šï¼Œæˆ‘ä»¬ä½¿ç”¨ä»¥ä¸‹é—®é¢˜æ¨¡å‹ã€‚ å®šä¹‰ 3.2ï¼ˆæ•°æ®åº“è°ƒæ•´ï¼‰ã€‚æ•°æ®åº“è°ƒæ•´é—®é¢˜ç”±ä¸€ä¸ªå…ƒç»„âŸ¨ğ‘, P,VâŸ© æè¿°ã€‚è¿™é‡Œï¼Œğ‘ æ˜¯ä¸€ä¸ªåŸºå‡†ï¼Œå®šä¹‰äº†ä¸€ç»„æŸ¥è¯¢ï¼ˆæˆ–äº‹åŠ¡å·¥ä½œé‡ï¼‰ï¼Œä»¥åŠéœ€è¦ä¼˜åŒ–çš„æ€§èƒ½æŒ‡æ ‡ï¼ˆå¦‚è¿è¡Œæ—¶é—´æˆ–ååé‡ï¼‰ã€‚è§£å†³æ–¹æ¡ˆå°†ä» V ä¸­é€‰æ‹©çš„ç”¨äºè°ƒæ•´çš„å‚æ•° P èµ‹å€¼ï¼Œå¹¶æ ¹æ®åŸºå‡† ğ‘ ç†æƒ³åœ°ä¼˜åŒ–æ€§èƒ½ã€‚åœ¨æœ¬ç ”ç©¶ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºè¯¥é—®é¢˜æ¨¡å‹çš„ä¸€ä¸ªå˜ä½“ã€‚ å®šä¹‰ 3.3ï¼ˆNLP å¢å¼ºè°ƒæ•´ï¼‰ã€‚ä¸€ä¸ª NLP å¢å¼ºæ•°æ®åº“è°ƒä¼˜å®ä¾‹ç”±ä¸€ä¸ªå…ƒç»„âŸ¨ğ‘,ğ‘‡,ğ‘†âŸ©æè¿°ã€‚è¿™é‡Œï¼Œğ‘ æ˜¯è¦ä¼˜åŒ–çš„åŸºå‡†ï¼Œğ‘‡ æ˜¯åŒ…å«è°ƒæ•´æç¤ºçš„æ–‡æœ¬æ–‡æ¡£é›†åˆã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯åˆ©ç”¨é€šè¿‡è‡ªç„¶è¯­è¨€åˆ†æä» ğ‘ ğ‘‡ ä¸­æå–çš„è°ƒæ•´æç¤ºï¼Œåœ¨è€ƒè™‘æ‰€æœ‰ DBMS è°ƒæ•´æ—‹é’®ï¼ˆæ›´å‡†ç¡®åœ°è¯´ï¼Œæˆ‘ä»¬å½“å‰çš„å®ç°è€ƒè™‘äº†æ¯ä¸ªç³»ç»Ÿçš„æ‰€æœ‰æ•´æ•°ã€æ•°å€¼å’Œå¸ƒå°”å‚æ•°ï¼‰çš„æƒ…å†µä¸‹ï¼Œæ‰¾åˆ° ğ‘ çš„æœ€ä½³é…ç½®ã€‚ğ‘† æ˜¯ä¸€ä¸ªåŒ…å«æ•°å€¼ç³»ç»Ÿå±æ€§ï¼ˆå¦‚å†…å­˜å¤§å°æˆ–å†…æ ¸æ•°é‡ï¼‰çš„å‘é‡ï¼Œç”¨äºå°†å¯èƒ½åŒ…å«ç›¸å¯¹å€¼å»ºè®®çš„æç¤ºè½¬åŒ–ä¸ºå…·ä½“å€¼ã€‚æˆ‘ä»¬ä¸å¸Œæœ›ç”¨æˆ·æŒ‡å®šè¦è°ƒæ•´çš„å‚æ•°ï¼Œä¹Ÿä¸å¸Œæœ›ç”¨æˆ·å»ºè®®å‚æ•°çš„å–å€¼èŒƒå›´ã€‚æˆ‘ä»¬ä¾é è‡ªç„¶è¯­è¨€åˆ†ææ¥ç¡®å®šç›¸å…³å‚æ•°å’Œå»ºè®®å€¼ã€‚ä¸è¿‡ï¼Œæœ¬å·¥ä½œä¸­ä»‹ç»çš„æ–¹æ³•å‡å®šå¯ä»¥è®¿é—®æ•°æ®åº“ç®¡ç†ç³»ç»Ÿå®ä¾‹ã€‚é€šè¿‡è¯¥æ¥å£ï¼Œæˆ‘ä»¬å¯ä»¥éªŒè¯æå–çš„å‚æ•°åç§°æ˜¯å¦æœ‰æ•ˆï¼Œä»¥åŠå‚æ•°ç±»å‹æ˜¯å¦åœ¨æˆ‘ä»¬çš„èŒƒå›´ä¹‹å†…ï¼ˆæˆ‘ä»¬å½“å‰çš„å®ç°è€ƒè™‘äº†æ•´æ•°ã€å¸ƒå°”å’Œæ•°å€¼å‚æ•°ï¼‰ã€‚ å®šä¹‰ 3.4ï¼ˆè°ƒæ•´æç¤ºï¼‰ã€‚è°ƒä¼˜æç¤ºå»ºè®®ä¸€ä¸ª DBMS å‚æ•°çš„å€¼ã€‚æˆ‘ä»¬å°†è°ƒä¼˜æç¤ºå»ºæ¨¡ä¸ºä¸€ä¸ªä¸‰å…ƒç»„ âŸ¨ğ‘¡,ğ‘,ğ‘£âŸ©ï¼Œå…¶ä¸­ ğ‘¡ æ˜¯åŒ…å«æç¤ºçš„æ–‡æœ¬ç‰‡æ®µï¼Œğ‘ æ˜¯ç‰¹å®šå‚æ•°ï¼Œğ‘£ æ˜¯ ğ‘¡ ä¸­æåˆ°çš„ç‰¹å®šå€¼ã€‚å¦‚æœ ğ‘ åœ¨ ğ‘¡ ä¸­è¢«æ˜ç¡®æåŠï¼Œæˆ‘ä»¬å°±ç§°è¯¥æç¤ºä¸ºæ˜¾å¼æç¤ºï¼Œåä¹‹åˆ™ä¸ºéšå¼æç¤ºã€‚åœ¨ä¼ªä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ â€œğ‘ â€œæˆ– â€œğ‘¡ â€œæ¥æŒ‡ä»£æç¤º â€œğ‘ â€œçš„å‚æ•°æˆ–æ–‡æœ¬ã€‚è¯·æ³¨æ„ï¼Œä¸€ä¸ªæ–‡æœ¬ç‰‡æ®µ ğ‘¡ å¯èƒ½åŒ…å«å¤šä¸ªå‚æ•°çš„å»ºè®®æˆ–åŒä¸€å‚æ•°çš„å¤šä¸ªå»ºè®®å€¼ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ ğ‘ å’Œ ğ‘£ æ¥è¯†åˆ« ğ‘¡ ä¸­çš„ç‰¹å®šæç¤ºã€‚ğ‘£ å€¼ä¸ä¸€å®šå°±æ˜¯ä¸º ğ‘ æå‡ºçš„å…·ä½“å€¼ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦å°†è°ƒæ•´æç¤ºè½¬åŒ–ä¸ºå…¬å¼çš„åŸå› ã€‚ å®šä¹‰ 3.5ï¼ˆç¿»è¯‘æç¤ºï¼‰ã€‚æˆ‘ä»¬å°†è°ƒæ•´æç¤ºâŸ¨ğ‘¡,ğ‘,ğ‘£âŸ© è½¬æ¢ä¸º ğ‘ =ğ‘“ (ğ‘£,ğ‘†)å½¢å¼çš„å…¬å¼ï¼Œå…¶ä¸­ ğ‘“ æ˜¯å…¬å¼ï¼Œğ‘† æ˜¯æ•°å€¼ç³»ç»Ÿå±æ€§ï¼ˆå¦‚ä¸»å†…å­˜å®¹é‡ï¼‰çš„å‘é‡ã€‚æˆ‘ä»¬è€ƒè™‘äº† ğ‘“ (ğ‘£,ğ‘†) =ğ‘£ -ğ‘š ä»¥åŠ ğ‘“ (ğ‘£,ğ‘†) =ğ‘£ -ğ‘†ğ‘– -ğ‘š ç±»å‹çš„å…¬å¼ï¼Œå…¶ä¸­ ğ‘†ğ‘– æ˜¯ ğ‘† çš„ ğ‘–-th åˆ†é‡ï¼Œğ‘š âˆˆRa ä¹˜æ³•å™¨ï¼ˆä»ç¦»æ•£çš„ ğ‘€ ä¹˜æ³•å™¨é›†åˆä¸­é€‰å–ï¼‰ã€‚æˆ‘ä»¬å°†ä¸¾ä¾‹è¯´æ˜è°ƒæ•´æç¤ºåŠå…¶è½¬æ¢ã€‚ä¾‹ 3.6. å‡è®¾ ğ‘† =âŸ¨8ğºğµ,4,1ğ‘‡ğµâŸ©æè¿°äº†ç›®æ ‡ç³»ç»Ÿçš„å†…å­˜å®¹é‡ã€å†…æ ¸æ•°é‡å’Œç£ç›˜ç©ºé—´å¤§å°ã€‚é‚£ä¹ˆï¼Œğ‘ =shared_buffers å’Œ ğ‘£ =0.25 çš„è°ƒæ•´æç¤º ğ‘“ (ğ‘£,ğ‘†) =ğ‘£ -ğ‘†0-1ï¼ˆå…¶ä¸­ 1 ä»£è¡¨ä¹˜æ³•å™¨ï¼‰åº”è½¬æ¢ä¸ºå…¬å¼ ğ‘“ (ğ‘£,ğ‘†) =ğ‘£-ğ‘†0-1ï¼ˆå…¶ä¸­ 1 ä»£è¡¨ä¹˜æ³•å™¨ï¼‰ï¼Œå…¶å€¼ä¸º 2 GBã€‚ ","date":"2024-02-04","objectID":"/posts/llm-capability/:5:0","tags":["Paper Reading"],"title":"Paper Reading: DB-BERT: a Database Tuning Tool that â€œReads the Manualâ€","uri":"/posts/llm-capability/"},{"categories":null,"content":"System Overview DB-BERT æœç´¢ DBMS è°ƒèŠ‚æ—‹é’®çš„è®¾ç½®ï¼Œä»¥æ ¹æ®ç‰¹å®šåŸºå‡†ï¼ˆæŒ‡å®šå·¥ä½œè´Ÿè½½å’Œæ€§èƒ½æŒ‡æ ‡ï¼‰æœ€å¤§åŒ–æ€§èƒ½ã€‚ DB-BERT ä¸ä¹‹å‰çš„è°ƒä¼˜ç³»ç»Ÿä¸åŒï¼Œå®ƒåˆ©ç”¨æœ‰å…³ DBMS çš„æ–‡æœ¬æ–‡æ¡£æ¥è°ƒä¼˜ï¼Œä¾‹å¦‚ DBMS æ‰‹å†Œï¼Œä½œä¸ºé™„åŠ è¾“å…¥ã€‚ DB-BERT è·å–è¦è°ƒæ•´çš„åŸºå‡†ä½œä¸ºè¾“å…¥ã€åŒ…å«è°ƒæ•´æ—‹é’®å»ºè®®è®¾ç½®çš„æ–‡æœ¬æ–‡æ¡£é›†åˆä»¥åŠæè¿°ç¡¬ä»¶å¹³å°çš„æ•°å­—å±æ€§ï¼ˆå³ï¼Œæˆ‘ä»¬çš„å®ç°æœŸæœ› RAM æ•°é‡ã€æ ¸å¿ƒæ•°é‡å’Œ ç£ç›˜ç©ºé—´ä½œä¸ºè¾“å…¥ï¼‰ã€‚åä¸€ä¸ªè¾“å…¥å¯¹äºç¿»è¯‘ä½¿ç”¨ç›¸å¯¹å»ºè®®çš„æ–‡æœ¬æ–‡æ¡£ä¸­çš„è°ƒæ•´æç¤ºï¼ˆä¾‹å¦‚ï¼Œå»ºè®®ç¼“å†²åŒºå¤§å°å  RAM é‡çš„ç™¾åˆ†æ¯”ï¼‰æ˜¯å¿…è¦çš„ã€‚ è¯·æ³¨æ„ï¼ŒDB-BERT ä¸é™äºä¸ä¸Šè¿°ç¡¬ä»¶å±æ€§ç›¸å…³çš„å‚æ•°ã€‚ DB-BERT å¯ä»¥å¤„ç†ä»»æ„å‚æ•°çš„æç¤ºï¼Œåªè¦å°†æ¨èå€¼æŒ‡å®šä¸ºæ–‡æœ¬ä¸­çš„ç»å¯¹å€¼å³å¯ã€‚DB-BERT ä¸å•ç‹¬ä½¿ç”¨æ–‡æœ¬è¾“å…¥æ¥ç¡®å®šå‚æ•°è®¾ç½®ï¼ˆå°†å…¶ä¸ä¹‹å‰çš„ NLP å¢å¼ºæ•°æ®åº“è°ƒä¼˜å·¥ä½œåˆ†å¼€ï¼‰ã€‚ ç›¸åï¼Œå®ƒåˆ©ç”¨é€šè¿‡å¯¹ DBMS ä¸Šçš„ç‰¹å®šé…ç½®è¿›è¡ŒåŸºå‡†æµ‹è¯•è·å¾—çš„è¿è¡Œæ—¶åé¦ˆæ¥è¿›è¡Œè°ƒæ•´ã€‚ å› æ­¤ï¼ŒDB-BERT éœ€è¦è¿æ¥åˆ° DBMS å®ä¾‹ã€‚ åœ¨è°ƒä¼˜ä¼šè¯å¼€å§‹æ—¶ï¼ŒDB-BERT å°†è¾“å…¥æ–‡æœ¬åˆ’åˆ†ä¸ºæ–‡æœ¬ç‰‡æ®µï¼Œå¹¶å°è¯•ä»æ¯ä¸ªç‰‡æ®µä¸­æå–è°ƒä¼˜æç¤ºï¼ˆå›¾ 1 ä¸­çš„æ­¥éª¤ Aï¼‰ã€‚ è°ƒæ•´æç¤ºå¯¹åº”äºå¯¹ç‰¹å®šå‚æ•°çš„ç‰¹å®šå€¼çš„æ¨èã€‚ ä»æ–‡æœ¬ç‰‡æ®µä¸­æå–æç¤ºå¹¶éæ˜“äº‹ï¼Œç‰¹åˆ«æ˜¯å› ä¸ºå‚æ•°å¼•ç”¨å¯èƒ½æ˜¯éšå¼çš„ï¼ˆå³æ–‡æœ¬æ²¡æœ‰æ˜ç¡®æåŠè¦è°ƒæ•´çš„å‚æ•°çš„åç§°ï¼‰ã€‚ æ¥ä¸‹æ¥ï¼ŒDB-BERT ç¡®å®šåœ¨ä»¥ä¸‹é˜¶æ®µè€ƒè™‘æç¤ºçš„é¡ºåºï¼ˆå›¾ 1 ä¸­çš„æ­¥éª¤ Bï¼‰ã€‚ ç†æƒ³æƒ…å†µä¸‹ï¼Œé¦–å…ˆè€ƒè™‘æœ€é‡è¦çš„æç¤ºã€‚ DB-BERT ä½¿ç”¨å¯å‘å¼æ–¹æ³•å¯¹æç¤ºè¿›è¡Œæ’åºï¼Œä¼˜å…ˆè€ƒè™‘ç»å¸¸æåˆ°çš„å‚æ•°çš„æç¤ºï¼ŒåŒæ—¶é™åˆ¶åŒä¸€å‚æ•°è¿ç»­è€ƒè™‘çš„æç¤ºæ•°é‡ã€‚ æ¥ä¸‹æ¥ï¼ŒDB-BERT æ ¹æ®è°ƒæ•´æç¤ºè¿­ä»£æ„å»ºé…ç½®ï¼ˆå³è°ƒæ•´æ—‹é’®çš„å€¼åˆ†é…ï¼‰ã€‚ å®ƒé€šè¿‡è¯•è¿è¡Œåœ¨è¾“å…¥åŸºå‡†ä¸Šè¯„ä¼°è¿™äº›é…ç½®ã€‚ è¿­ä»£ç»§ç»­ï¼Œç›´åˆ°ç”¨æˆ·ä¸­æ–­ä¼˜åŒ–æˆ–è¾¾åˆ°ç”¨æˆ·æŒ‡å®šçš„ä¼˜åŒ–æ—¶é—´é™åˆ¶ã€‚ åœ¨æ¯æ¬¡è¿­ä»£ä¸­ï¼ŒDB-BERT éƒ½ä¼šè€ƒè™‘ä¸€æ‰¹è°ƒä¼˜æç¤ºï¼ˆè€Œä¸æ˜¯æ•´ç»„è°ƒä¼˜æç¤ºï¼‰ã€‚å®ƒæŒ‰ç…§è°ƒæ•´ä¼šè¯å¼€å§‹æ—¶å»ºç«‹çš„é¡ºåºè€ƒè™‘æç¤ºï¼Œä»è€Œé¦–å…ˆè€ƒè™‘çœ‹ä¼¼æœ€é‡è¦çš„æç¤ºã€‚ å¯¹äºæ¯ä¸ªæç¤ºï¼ŒDB-BERT éƒ½ä¼šåšå‡ºä¸‰ç§ç±»å‹çš„å†³ç­–ã€‚ é¦–å…ˆï¼Œå®ƒå°†æç¤ºæ–‡æœ¬è½¬æ¢ä¸ºä¸€ä¸ªç®€å•çš„æ–¹ç¨‹ï¼Œä¸ºå‚æ•°åˆ†é…ä¸€ä¸ªå€¼ï¼ˆå›¾ 1 ä¸­çš„æ­¥éª¤ Cï¼‰ã€‚ å…¶æ¬¡ï¼Œåœ¨æ­¥éª¤ D ä¸­ï¼Œå†³å®šæ˜¯å¦åç¦»æ¨èå€¼ï¼ˆå³æ˜¯å¦å°†æ¨èå€¼ä¹˜ä»¥å¸¸æ•°ï¼‰ã€‚ ç¬¬ä¸‰ï¼Œå®ƒä¸ºæç¤ºåˆ†é…æƒé‡ï¼ˆæ­¥éª¤ Eï¼‰ã€‚ è¿™äº›æƒé‡å†³å®šäº†åœ¨å…³äºåŒä¸€è°ƒè°æ—‹é’®çš„å»ºè®®ç›¸äº’å†²çªçš„æƒ…å†µä¸‹å¦‚ä½•ç¡®å®šä¼˜å…ˆçº§ã€‚ åœ¨å¤„ç†å½“å‰æ‰¹æ¬¡ä¸­çš„æ‰€æœ‰æç¤ºåï¼ŒDB-BERT å°†å®ƒä»¬èšåˆæˆä¸€å°ç»„é…ç½®ï¼ˆæ­¥éª¤ Fï¼‰ï¼Œä½¿ç”¨æç¤ºæƒé‡åœ¨ä¸ä¸€è‡´çš„æ¨èä¹‹é—´è¿›è¡Œè°ƒè§£ã€‚ å®ƒé€šè¿‡è¯•è¿è¡Œåœ¨ç”¨æˆ·æŒ‡å®šçš„åŸºå‡†ä¸Šè¯„ä¼°è¿™äº›é…ç½®ï¼ˆå›¾ 1 ä¸­çš„æ­¥éª¤ Gï¼‰ã€‚ DB-BERT åœ¨è°ƒä¼˜è¿‡ç¨‹ä¸­å­¦ä¹ æ”¹è¿›æç¤ºçš„ç¿»è¯‘ã€è°ƒæ•´å’ŒåŠ æƒæ–¹å¼ã€‚ è¿™ä½¿å¾— DB-BERT èƒ½å¤Ÿé’ˆå¯¹å½“å‰çš„åŸºå‡†æµ‹è¯•å’Œå¹³å°è¿›è¡Œä¸“é—¨çš„é…ç½®ã€‚ DB-BERT ä½¿ç”¨å¼ºåŒ–å­¦ä¹ æ¥åšå‡ºä¸å›¾ 1 ä¸­çš„æ­¥éª¤ C åˆ° E ç›¸å…³çš„æ‰€æœ‰å†³ç­–ã€‚å› æ­¤ï¼Œå­¦ä¹ è¿‡ç¨‹ç”±ç³»ç»Ÿè¯•å›¾æœ€å¤§åŒ–çš„å¥–åŠ±å‡½æ•°é©±åŠ¨ã€‚ å¯¹äº DB-BERTï¼Œè¯¥å¥–åŠ±å‡½æ•°åŸºäºè¯•è¿è¡ŒæœŸé—´ç‰¹å®šé…ç½®çš„æ€§èƒ½ç»“æœã€‚ DBMS æ¥å—çš„é…ç½®ï¼ˆå³ï¼Œå°è¯•å°†å‚æ•°è®¾ç½®ä¸ºç‰¹å®šå€¼ä¸ä¼šå¯¼è‡´é”™è¯¯ï¼‰å¹¶å®ç°é«˜æ€§èƒ½ï¼Œä»è€Œäº§ç”Ÿé«˜å¥–åŠ±å€¼ã€‚ æ ¹æ®æ”¶åˆ°çš„å¥–åŠ±ï¼Œç³»ç»Ÿå­¦ä¹ åœ¨æ¥ä¸‹æ¥çš„è¿­ä»£ä¸­æ”¹è¿›å…¶å†³ç­–ï¼ˆå›¾ 1 ä¸­çš„æ­¥éª¤ Hï¼‰ã€‚ DB-BERT ä½¿ç”¨æ·±åº¦å¼ºåŒ–å­¦ä¹ ã€‚ è¿™æ„å‘³ç€ä¸ç‰¹å®šé€‰æ‹©ç›¸å…³çš„å³æ—¶å’Œæœªæ¥å¥–åŠ±å€¼æ˜¯ä½¿ç”¨ç¥ç»ç½‘ç»œæ¥ä¼°è®¡çš„ã€‚å…·ä½“æ¥è¯´ï¼ŒDB-BERT ä½¿ç”¨é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ BERT ä½œä¸ºç¥ç»ç½‘ç»œã€‚ ç”±äºç»è¿‡é¢„è®­ç»ƒï¼Œè¯¥æ¨¡å‹å…·æœ‰å¼€ç®±å³ç”¨çš„å¼ºå¤§è‡ªç„¶è¯­è¨€åˆ†æåŠŸèƒ½ã€‚ ä¸ºäº†ä¼°è®¡æ­¥éª¤ C åˆ° E ä¸­ç‰¹å®šé€‰æ‹©çš„ä»·å€¼ï¼Œå°† BERT åº”ç”¨äºæ–‡æœ¬ç‰‡æ®µå¯¹ã€‚ ç¬¬ä¸€ä¸ªç‰‡æ®µå–è‡ªè°ƒæ•´æç¤ºçš„æ–‡æœ¬ï¼Œç¬¬äºŒä¸ªç‰‡æ®µæ˜¯è¡¨ç¤ºè¯¥é€‰æ‹©çš„è¯­ä¹‰çš„æ–‡æœ¬æ ‡ç­¾ï¼ˆæœ‰å…³ç¤ºä¾‹æ ‡ç­¾ï¼Œè¯·å‚é˜…ç¬¬ 6 èŠ‚ä¸­çš„è¡¨ 3ï¼‰ã€‚ æ ¹æ®æ”¶åˆ°çš„å¥–åŠ±å€¼ï¼ŒBERT æ¨¡å‹çš„åˆå§‹æƒé‡åœ¨è°ƒä¼˜è¿‡ç¨‹ä¸­ï¼ˆæ­¥éª¤ Hï¼‰è¿›è¡Œç»†åŒ–ã€‚ ç®—æ³• 1 è¡¨ç¤ºç”± DB-BERT ä»¥ä¼ªä»£ç å½¢å¼æ‰§è¡Œçš„ä¸»å‡½æ•°ã€‚ è¾“å…¥é›†æˆäº†ç”¨æˆ·æä¾›çš„è¾“å…¥ï¼ˆå¦‚å›¾ 1 æ‰€ç¤ºï¼‰ä»¥åŠå…¶ä»–å‚æ•°ï¼Œè‡ªåŠ¨æå–æˆ–åœ¨ç³»ç»Ÿå’ŒåŸºå‡†æµ‹è¯•ä¸­ä¿æŒä¸å˜ã€‚ å…¶ä¸­åŒ…æ‹¬ä» DBMS ä¸­æå–çš„æ•´å¥—æ•´æ•°ã€å¸ƒå°”å’Œæ•°å­—è°ƒèŠ‚æ—‹é’®ã€ğ‘ƒã€ä¸€ç»„ä¹˜æ³•å™¨ ğ‘€ï¼ˆåç¦»æ–‡æœ¬ä¸­æå‡ºçš„å€¼ï¼‰ã€ä¸€ç»„æƒé‡ ğ‘Šï¼ˆç”¨äºç¡®å®šå†²çªæç¤ºä¹‹é—´çš„ç›¸å¯¹é‡è¦æ€§ï¼‰ æ¥è‡ªä¸åŒæ¥æºï¼‰ï¼Œä»¥åŠå‚æ•° ğ‘™ã€ğ‘’ å’Œ ğ‘› åˆ†åˆ«ç”¨äºé€‰æ‹©æ¯ä¸ªå‚æ•°å’Œè¿­ä»£å¤„ç†çš„æç¤ºæ•°é‡ã€æ¯æ¬¡è¿­ä»£è€ƒè™‘çš„æç¤ºæ€»æ•°ä»¥åŠæ¯æ¬¡è¿­ä»£è¯„ä¼°çš„é…ç½®æ•°é‡ã€‚ è¿™äº›å‚æ•°çš„è¯­ä¹‰å°†åœ¨ä»¥ä¸‹éƒ¨åˆ†ä¸­æ›´è¯¦ç»†åœ°æè¿°ã€‚ ç®—æ³• 1 ä¸­çš„ç¬¬ 8 è¡Œå®ç°äº†å›¾ 1 ä¸­çš„æ­¥éª¤ Aï¼Œç¬¬ 10 è¡Œå®ç°äº†æ­¥éª¤ Bã€‚ä¸»å¾ªç¯è¿­ä»£ç›´åˆ°è°ƒæ•´æ—¶é—´é¢„ç®—è€—å°½ã€‚ å‡½æ•° Batches(ğ»ğ‘œ,ğ‘’) æŒ‰ç…§ä¹‹å‰å»ºç«‹çš„æç¤ºé¡ºåºå°†æç¤ºåˆ†ä¸ºæœ€å¤š ğ‘’ å¤§å°çš„æ‰¹æ¬¡ã€‚ æ¯æ¬¡è°ƒç”¨ RunEpisode éƒ½ä¼šå®ç°å›¾ 1 ä¸­çš„æ­¥éª¤ C åˆ° Hã€‚æœ€åï¼ŒDB-BERT æ¨èå‡ºæœ€ä½³é…ç½®ã€‚ç¬¬ 5 èŠ‚è®¨è®ºæç¤ºæå–å’Œæ’åºã€‚ ç¬¬ 6 èŠ‚æ›´è¯¦ç»†åœ°æè¿°äº†å­¦ä¹ è¿‡ç¨‹ï¼Œç¬¬ 7 èŠ‚æ¦‚è¿°äº†å¦‚ä½•å°†æç¤ºèšåˆåˆ°é…ç½®ä¸­ã€‚ ","date":"2024-02-04","objectID":"/posts/llm-capability/:6:0","tags":["Paper Reading"],"title":"Paper Reading: DB-BERT: a Database Tuning Tool that â€œReads the Manualâ€","uri":"/posts/llm-capability/"},{"categories":null,"content":"Extracting candidate hints ç¬¬ä¸€æ­¥ï¼ŒDB-BERT æå–å€™é€‰è°ƒæ•´æç¤ºã€‚ æ ¹æ®å®šä¹‰ 3.4ï¼Œè°ƒæ•´æç¤ºç”±æ–‡æœ¬ç‰‡æ®µã€å‚æ•°å¼•ç”¨å’Œå€¼å¼•ç”¨ç»„æˆã€‚ ç®—æ³• 2 æè¿°äº†æå–è¿‡ç¨‹ï¼ˆå¦‚å›¾ 2 æ‰€ç¤ºï¼‰ã€‚ å®ƒæå–æ˜¾å¼å’Œéšå¼å‚æ•°å¼•ç”¨ã€‚ é€šè¿‡å°†æ–‡æœ¬ï¼ˆå‘é‡ï¼‰çš„ BERT ç¼–ç ä¸å‚æ•°åç§°çš„ BERT ç¼–ç è¿›è¡Œæ¯”è¾ƒï¼Œé€‰æ‹©å…·æœ‰æœ€å°ä½™å¼¦è·ç¦»çš„å‚æ•°æ¥è·å¾—éšå¼å¼•ç”¨ã€‚ æˆ‘ä»¬å°†æ–‡æœ¬ä¸­å‡ºç°çš„æ‰€æœ‰æ•°å­—ï¼ˆå¯èƒ½ä¸å°ºå¯¸å•ä½ç»„åˆï¼‰è§†ä¸ºæ½œåœ¨çš„ä»·å€¼å»ºè®®ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†è¡¨ç¤ºå¸ƒå°”æ ‡å¿—çš„æ‰“å¼€å’Œå…³é—­å€¼çš„å€¼ 0 å’Œ 1 æ·»åŠ åˆ°å€¼é›†ä¸­ï¼ˆåœ¨è°ƒæ•´æç¤ºä¸­é€šå¸¸ä¸ä¼šæ˜ç¡®æåŠæ‰“å¼€å’Œå…³é—­å€¼ï¼‰ã€‚ ç»™å®šæ–‡æœ¬ç‰‡æ®µçš„å€™é€‰æç¤ºé›†æ˜¯å‚æ•°å¼•ç”¨å’Œå€¼ä¹‹é—´çš„ç¬›å¡å°”ç§¯ã€‚ è¿™æ„å‘³ç€æˆ‘ä»¬çš„å€™é€‰è€…å¯èƒ½åŒ…å«é”™è¯¯çš„æç¤ºï¼ˆå³æœªé€šè¿‡æ–‡æœ¬é“¾æ¥çš„å‚æ•°å€¼ç»„åˆï¼‰ã€‚ å°†å®é™…æç¤ºä¸é”™è¯¯æç¤ºåˆ†å¼€çš„ä»»åŠ¡åœ¨ç¿»è¯‘é˜¶æ®µå¾—åˆ°è§£å†³ï¼Œå¦‚ä¸‹ä¸€èŠ‚æ‰€è¿°ã€‚ æå–å€™é€‰æç¤ºåï¼ŒDB-BERT ä½¿ç”¨ç®—æ³• 3 å¯¹å®ƒä»¬è¿›è¡Œæ’åºã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯åœ¨æŒ‰æ’åºé¡ºåºè€ƒè™‘æç¤ºæ—¶å¢åŠ æ‰¾åˆ°æœ‰å¸Œæœ›çš„é…ç½®çš„æœºä¼šã€‚ æˆ‘ä»¬è€ƒè™‘ä¸¤æ¡ç»éªŒæ³•åˆ™ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬æœŸæœ›åœ¨æ›´å¤šæ–‡æ¡£ä¸­æåŠé‡è¦å‚æ•°ã€‚ å…¶æ¬¡ï¼Œå½“è€ƒè™‘åˆ°å…³äºåŒä¸€å‚æ•°çš„è¶Šæ¥è¶Šå¤šçš„æç¤ºæ—¶ï¼Œæˆ‘ä»¬é¢„è®¡æ”¶ç›Šä¼šé€’å‡ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬ä¼˜å…ˆè€ƒè™‘æ›´å¤šæ–‡æ¡£ä¸­å‡ºç°çš„å‚æ•°çš„æç¤ºã€‚ ç„¶è€Œï¼Œåœ¨åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªå‚æ•°ä¹‹å‰ï¼Œæˆ‘ä»¬æœ€å¤šè€ƒè™‘å…³äºåŒä¸€å‚æ•°çš„å›ºå®šæ•°é‡çš„æç¤ºã€‚ ç®—æ³• 3 å®ç°äº†è¿™äº›é«˜çº§åŸåˆ™ã€‚ æŒ‰å‚æ•°å¯¹æç¤ºè¿›è¡Œåˆ†ç»„åï¼Œå®ƒä¼šè¿­ä»£æç¤ºç´¢å¼•èŒƒå›´ã€‚ å¯¹äºæ¯ä¸ªç´¢å¼•èŒƒå›´ï¼Œå®ƒæŒ‰å‡ºç°æ¬¡æ•°é™åºè¿­ä»£å‚æ•°ï¼Œåœ¨åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªå‚æ•°ä¹‹å‰ä¸ºæ¯ä¸ªå‚æ•°æ·»åŠ  ğ‘™ æç¤ºï¼ˆç›´åˆ°æ²¡æœ‰ä»»ä½•æ–°æç¤ºå¯ä¾›ä¸ºä»»ä½•å‚æ•°æ·»åŠ ï¼‰ ä¾‹ 5.1ã€‚ å›¾ 3 è¯´æ˜äº†å…·æœ‰ä¸‰ä¸ªå‚æ•°çš„æç¤ºæ’åºã€‚ è“è‰²çŸ©å½¢ä»£è¡¨æ¯ä¸ªå‚æ•°çš„æç¤ºã€‚ æ°´å¹³å®½åº¦ä¸æç¤ºæ•°é‡æˆæ­£æ¯”ã€‚ ä»æœ€å¸¸æåˆ°çš„å‚æ•°å¼€å§‹ï¼Œæˆ‘ä»¬ä¸ºæ¯ä¸ªå‚æ•°æ·»åŠ æœ‰é™æ•°é‡çš„æç¤ºã€‚å¤„ç†å®Œæœ€ä¸å¸¸æåŠçš„å‚æ•°ï¼ˆç”±çº¢è‰²ç®­å¤´è¡¨ç¤ºï¼‰å‚æ•° 3 åï¼Œæˆ‘ä»¬å†æ¬¡ä»ç¬¬ä¸€ä¸ªå‚æ•°å¼€å§‹ï¼Œç›´åˆ°ä¸å†æœ‰æç¤ºä¸ºæ­¢ ","date":"2024-02-04","objectID":"/posts/llm-capability/:7:0","tags":["Paper Reading"],"title":"Paper Reading: DB-BERT: a Database Tuning Tool that â€œReads the Manualâ€","uri":"/posts/llm-capability/"},{"categories":null,"content":"Translating single hints DB-BERT å°†è°ƒä¼˜æç¤ºè½¬æ¢ä¸ºç®—æœ¯å…¬å¼ï¼ˆè¯¦ç»†ä¿¡æ¯è¯·å‚è§å®šä¹‰ 3.5ï¼‰ã€‚ è¿™äº›å…¬å¼å¯èƒ½å–å†³äºæ–‡æœ¬ä¸­æŒ‡å®šçš„å€¼ä»¥åŠç³»ç»Ÿå±æ€§ï¼ˆä¾‹å¦‚ä¸»å†…å­˜é‡ï¼‰ã€‚ è¯„ä¼°å…¬å¼ä¼šäº§ç”Ÿè°ƒä¼˜æ—‹é’®çš„å€¼å»ºè®®ã€‚ å¯¹äºæ¯ä¸ªè°ƒæ•´æç¤ºï¼Œæˆ‘ä»¬å°†ç¿»è¯‘å»ºæ¨¡ä¸ºä¸€ç³»åˆ—å†³ç­–ã€‚ æˆ‘ä»¬å­¦ä¹ ä½¿ç”¨å¼ºåŒ–å­¦ä¹ æ¥ç¿»è¯‘è°ƒæ•´æç¤ºã€‚ å¼ºåŒ–å­¦ä¹ é€šå¸¸åº”ç”¨äºé©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ï¼ˆMDPï¼‰ï¼Œç”±ä¸€ç»„çŠ¶æ€ã€åŠ¨ä½œã€å°†çŠ¶æ€å’ŒåŠ¨ä½œå¯¹æ˜ å°„åˆ°æ–°çŠ¶æ€çš„è½¬æ¢å‡½æ•°ä»¥åŠå¥–åŠ±å‡½æ•°æŒ‡å®šã€‚ å¼ºåŒ–å­¦ä¹ ä»£ç†å­¦ä¹ ä»¥è§‚å¯Ÿä¸ºæŒ‡å¯¼ï¼Œåšå‡ºæœ€å¤§åŒ–é¢„æœŸå¥–åŠ±çš„å†³ç­–ã€‚ åœ¨æˆ‘ä»¬çš„åœºæ™¯ä¸­ï¼ŒçŠ¶æ€ä»£è¡¨ï¼ˆéƒ¨åˆ†æŒ‡å®šçš„ï¼‰ç®—æœ¯å…¬å¼ã€‚ æ“ä½œæŒ‡å®šå…¬å¼çš„å„ä¸ªéƒ¨åˆ†ã€‚ è½¬æ¢å‡½æ•°å°†éƒ¨åˆ†æŒ‡å®šçš„å…¬å¼å’Œæ“ä½œé“¾æ¥åˆ°è¡¨ç¤ºå…¬å¼çš„çŠ¶æ€ï¼Œå¹¶æŒ‰ç…§æ“ä½œä¸­çš„æŒ‡å®šå®Œæˆã€‚ å¥–åŠ±å‡½æ•°åŸºäº DBMS çš„åé¦ˆï¼Œæƒ©ç½šå¯¼è‡´ä¸å¯æ¥å—çš„é…ç½®çš„ç¿»è¯‘ï¼ŒåŒæ—¶å¥–åŠ±æé«˜æ€§èƒ½çš„æ›´æ”¹ã€‚ æˆ‘ä»¬åœ¨ 6.1 èŠ‚ä¸­æè¿°ç¯å¢ƒçš„ç»“æ„ï¼ˆå³çŠ¶æ€ã€åŠ¨ä½œã€è½¬æ¢å’Œå¥–åŠ±ï¼‰ï¼Œåœ¨ 6.2 èŠ‚ä¸­æè¿°å­¦ä¹ ä»£ç†çš„ç»“æ„ã€‚ ","date":"2024-02-04","objectID":"/posts/llm-capability/:8:0","tags":["Paper Reading"],"title":"Paper Reading: DB-BERT: a Database Tuning Tool that â€œReads the Manualâ€","uri":"/posts/llm-capability/"},{"categories":null,"content":"Learning Environment ç®—æ³• 4 å®ç°äº† DB-BERT ç”¨äºç¿»è¯‘å•ä¸ªæç¤ºçš„è½¬æ¢å‡½æ•°ï¼ˆä¼ªä»£ç æ¥è¿‘äºç›¸åº” OpenAI Gym ç¯å¢ƒä¸­æ­¥éª¤å‡½æ•°çš„å®ç° 2ï¼‰ã€‚åœ¨ç®—æ³• 4 ä¸­ï¼Œå¯¹äºå›ºå®šè°ƒæ•´æç¤ºï¼Œå½“å‰çŠ¶æ€ç”±éƒ¨åˆ†æŒ‡å®šçš„å…¬å¼ (ğ‘“) å’Œå˜é‡ ğ‘‘ï¼ˆä¸‹ä¸€ä¸ªå†³ç­–çš„æ•´æ•° IDï¼‰æ¥è¡¨å¾ã€‚ å¯¹äºæ¯ä¸ªæç¤ºï¼Œæˆ‘ä»¬ä»ä¸€ä¸ªç©ºå…¬å¼ ğ‘“ å’Œ ğ‘‘ =0 å¼€å§‹ã€‚ æˆ‘ä»¬å°†åŠ¨ä½œï¼ˆè¾“å…¥ ğ‘ï¼‰è¡¨ç¤ºä¸ºä» 1 åˆ° 5 çš„æ•´æ•°ã€‚ åŠ¨ä½œçš„è¯­ä¹‰å–å†³äº ğ‘‘ çš„å€¼ã€‚ å¯¹äº ğ‘‘ =0ï¼Œè¯¥æ“ä½œå†³å®šå½“å‰æç¤ºæ˜¯å¦é”™è¯¯ï¼ˆå¸¸é‡ NO_HINTï¼‰ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™å†³å®šæç¤ºæ˜¯å¦å»ºè®®ç›¸å¯¹æˆ–ç»å¯¹å‚æ•°å€¼ã€‚ ç›¸å¯¹å€¼è¡¨ç¤ºä¸ºç³»ç»Ÿå±æ€§çš„ç™¾åˆ†æ¯”ï¼Œä¾‹å¦‚ä¸»å†…å­˜æˆ–æ ¸å¿ƒæ•°é‡ï¼ˆå­˜å‚¨åœ¨å‘é‡ ğ‘† ä¸­ï¼Œğ‘†ğ‘ ä»£è¡¨ç‰¹å®šå‘é‡åˆ†é‡ï¼‰ã€‚ å¯¹äºç›¸å¯¹å€¼ï¼Œæˆ‘ä»¬å°† ğ‘“ è®¾ç½®ä¸ºå€¼ ğ‘£ ä¸ç›¸åº”ç³»ç»Ÿå±æ€§ä¹‹é—´çš„ä¹˜ç§¯ã€‚ æˆ‘ä»¬é€šè¿‡è®¾ç½® ğ‘†1=1 æ¥ç»Ÿä¸€ç›¸å¯¹å€¼å’Œç»å¯¹å€¼çš„å¤„ç†ï¼ˆå³ ğ‘=1 ä»£è¡¨ç»å¯¹å€¼ï¼‰ å¯¹äº ğ‘‘ = 1ï¼Œè¯¥æ“ä½œä» ğ‘€ ä¸­é€‰æ‹©ä¸€ä¸ªå…è®¸åç¦»å»ºè®®å€¼çš„ä¹˜æ•°ã€‚ ä¸ä¹‹å‰ä»…æå–è°ƒæ•´æç¤ºçš„å·¥ä½œä¸åŒï¼Œè¿™ç§ä¹˜æ³•å™¨å…è®¸ DB-BERT é€‚åº”ç‰¹å®šçš„åŸºå‡†ã€‚ åœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»ä¸€ä¸ªæƒè¡¡æç¤ºçš„é™„åŠ å†³ç­–ã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ç»è¿‡ä¸¤æ¬¡å†³ç­–ï¼Œå·²ç»å®Œå…¨æ˜ç¡®äº†å…¬å¼ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°è¯•å°†å‚æ•° ğ‘ è®¾ç½®ä¸ºå…¬å¼è¯„ä¼°ç»“æœã€‚ å¦‚æœè¯¥è®¾ç½®è¢« DBMS æ‹’ç»ï¼Œæˆ‘ä»¬å°†ç›´æ¥è¿›å…¥ç»“æŸçŠ¶æ€ï¼ˆå¸¸é‡ ENDï¼‰ã€‚ è¿™ç§æƒ…å†µä¼šäº§ç”Ÿè´Ÿå¥–åŠ±ï¼ˆæ¿€åŠ±æˆ‘ä»¬çš„ä»£ç†å­¦ä¹ å°†æç¤ºè½¬åŒ–ä¸ºå¯æ¥å—çš„å…¬å¼ï¼‰ã€‚å¦åˆ™ï¼Œæˆ‘ä»¬è¯„ä¼°è¾“å…¥åŸºå‡† ğ‘ çš„æ€§èƒ½ã€‚ ç»“æœæ˜¯å¥–åŠ±å€¼ã€‚ æ›´é«˜çš„å¥–åŠ±ä¸æ›´å¥½çš„ç»©æ•ˆç›¸å…³ã€‚ æˆ‘ä»¬é€šè¿‡å°†æ€§èƒ½ä¸é…ç½®è¿›è¡Œæ¯”è¾ƒæ¥è®¡ç®—å¥–åŠ±ï¼Œä»¥è¯„ä¼°é»˜è®¤è®¾ç½®ä¸‹çš„æ€§èƒ½ã€‚ å¯¹äº OLAP åŸºå‡†ï¼ˆä¾‹å¦‚ï¼ŒTPC-Hï¼‰ï¼Œæˆ‘ä»¬ä½¿ç”¨è¿è¡Œæ—¶é—´çš„å¢é‡ï¼ˆæŒ‰å¸¸æ•°ç¼©æ”¾ï¼‰ã€‚ å¯¹äº OLTP åŸºå‡†ï¼ˆä¾‹å¦‚ TPC-Cï¼‰ï¼Œæˆ‘ä»¬ä½¿ç”¨ååé‡å¢é‡ã€‚ æˆ‘ä»¬å¥–åŠ±å¯æ¥å—å¹¶æé«˜æ€§èƒ½çš„é…ç½®ã€‚ è¿™ä¸¤ä¸ªæŒ‡æ ‡ä¸è°ƒæ•´ç›´æ¥ç›¸å…³ã€‚ æˆ‘ä»¬åœ¨åº”ç”¨ DB-BERT æ¥é’ˆå¯¹ç‰¹å®šåŸºå‡†è°ƒæ•´ç‰¹å®šç³»ç»Ÿæ—¶ä½¿ç”¨å®ƒä»¬ã€‚ åœ¨å°† DB-BERT åº”ç”¨äºç‰¹å®šçš„è°ƒä¼˜ä»»åŠ¡ä¹‹å‰ï¼Œæˆ‘ä»¬ä¼šæ‰§è¡Œä¸€ä¸ªè®­ç»ƒé˜¶æ®µæ¥å¾®è°ƒ DB-BERT çš„è¯­è¨€æ¨¡å‹ï¼Œä»¥å®ç°ä¸€èˆ¬çš„æç¤ºç¿»è¯‘ã€‚ ä¸ºäº†åŠ é€Ÿæ”¶æ•›ï¼Œä»…åœ¨è®­ç»ƒæœŸé—´ï¼Œæˆ‘ä»¬åœ¨å¥–åŠ±å‡½æ•°ä¸­æ·»åŠ äº†ä¸€ä¸ªé¢å¤–çš„ç»„ä»¶ã€‚ è¯¥ç»„ä»¶å¥–åŠ±çœ‹èµ·æ¥æ›´æœ‰å¯èƒ½çš„è®¾ç½®ï¼Œä¾‹å¦‚ å› ä¸ºå®ƒä»¬ä¸å‚æ•°çš„é»˜è®¤è®¾ç½®å…·æœ‰ç›¸åŒçš„æ•°é‡çº§ã€‚ è¿™ç§å¯å‘å¼æ–¹æ³•å–ä»£äº†å…ˆå‰å·¥ä½œä¸­ä½¿ç”¨çš„æ‰‹åŠ¨ç”Ÿæˆçš„æç¤ºç¿»è¯‘ã€‚ å›¾ 4 è¯´æ˜äº†è½¬æ¢è¿‡ç¨‹èƒŒåçš„ MDPï¼ˆå›¾ 4 ä¸­çš„ä¸€äº›çŠ¶æ€æœªåœ¨ç®—æ³• 4 ä¸­æ˜ç¡®è¡¨ç¤ºï¼‰ã€‚ ","date":"2024-02-04","objectID":"/posts/llm-capability/:8:1","tags":["Paper Reading"],"title":"Paper Reading: DB-BERT: a Database Tuning Tool that â€œReads the Manualâ€","uri":"/posts/llm-capability/"},{"categories":null,"content":"Learning Agent DB-BERT å¼•å…¥äº†ä¸€ä¸ªå­¦ä¹  agent æ¥é€‰æ‹©æ“ä½œä»¥æœ€å¤§åŒ–å¥–åŠ±ã€‚ åœ¨æ¯ç§çŠ¶æ€ä¸‹ï¼Œä»£ç†éƒ½ä¼šåœ¨ä¸€ç»„ç¦»æ•£çš„é€‰é¡¹ä¸­è¿›è¡Œé€‰æ‹©ã€‚ æ¯ä¸ªé€‰é¡¹éƒ½å¯ä»¥è¡¨ç¤ºä¸ºè‡ªç„¶è¯­è¨€è¯­å¥ã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡å°†è¯¥è¯­å¥ä¸è°ƒæ•´æç¤ºæ–‡æœ¬è¿›è¡Œæ¯”è¾ƒæ¥æ‰¾å‡ºå“ªä¸ªé€‰é¡¹æ˜¯æ­£ç¡®çš„ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬å°†åŠ¨ä½œé€‰æ‹©å»ºæ¨¡ä¸ºâ€œå¤šé¡¹é€‰æ‹©é—®é¢˜å›ç­”é—®é¢˜â€ã€‚ é¢„è®­ç»ƒçš„è¯­è¨€æ¨¡å‹å¯ä»¥ç”¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼ˆåœ¨æˆ‘ä»¬çš„å®ç°ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ BertForMultipleChoice Transformer æ¨¡å‹ 3ï¼‰ã€‚ æˆ‘ä»¬åœ¨è®­ç»ƒæœŸé—´æ ¹æ®æ”¶åˆ°çš„å¥–åŠ±å¾®è°ƒæ¨¡å‹æƒé‡ã€‚ ç®—æ³• 5 æ˜¾ç¤ºäº†æ™ºèƒ½ä½“å¦‚ä½•æ ¹æ®è§‚å¯Ÿæ¥è¯„ä¼°ç‰¹å®šæ“ä½œã€‚ é™¤äº†è¦è¯„ä¼°çš„æ“ä½œä¹‹å¤–ï¼Œè¾“å…¥è¿˜åŒ…æ‹¬å½“å‰è°ƒæ•´æç¤ºï¼ˆè°ƒæ•´æ–‡æœ¬ ğ‘¡ã€å‚æ•° ğ‘ å’Œå€¼ ğ‘£ï¼‰ä»¥åŠå½“å‰ç¿»è¯‘æ­¥éª¤ï¼ˆå†³ç­– ğ‘‘ï¼‰çš„æè¿°ã€‚ æˆ‘ä»¬å°†è¡ŒåŠ¨å’Œå†³ç­–çš„æ¯ä¸ªç»„åˆä¸æ ‡ç­¾ç›¸å…³è”ã€‚ åŒ…å«è¿™äº›æ ‡ç­¾çš„æ•°ç»„é€šè¿‡ä¼ªä»£ç ä¸­çš„å¸¸é‡ CHOICE_LABEL è¡¨ç¤ºã€‚ æ ‡ç­¾æ˜¯è‡ªç„¶è¯­è¨€å¥å­ï¼Œä»£è¡¨ç›¸å…³é€‰æ‹©çš„è¯­ä¹‰ã€‚ å®ƒåŒ…å«è°ƒæ•´æç¤ºä¸­å…·ä½“å‚æ•°å’Œå€¼çš„å ä½ç¬¦ã€‚ Instantiate å‡½æ•°ç”¨å…·ä½“å€¼æ›¿æ¢å ä½ç¬¦ã€‚ BERT æ¨¡å‹ä½¿ç”¨ä¸‰ä¸ªè¾“å…¥ï¼šè¾“å…¥æ–‡æœ¬ã€å°†è¾“å…¥æ ‡è®°ä¸ä¸¤ç§è¾“å…¥ç±»å‹ä¹‹ä¸€ç›¸å…³è”çš„ç±»å‹æ ‡è®°ï¼Œä»¥åŠæŒ‡ç¤ºè¦è€ƒè™‘çš„æ ‡è®°çš„æ©ç ã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬è¿æ¥æç¤ºæ–‡æœ¬å’Œå®ä¾‹åŒ–æ ‡ç­¾ä»¥å½¢æˆè¾“å…¥æ–‡æœ¬ã€‚ é”®å…¥å°†æç¤ºæ–‡æœ¬ä¸æ ‡ç­¾åˆ†å¼€ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰è¾“å…¥æ–‡æœ¬éƒ½ä¼šè¢«è€ƒè™‘è¿›è¡Œå¤„ç†ã€‚ åœ¨æˆ‘ä»¬çš„é€šç”¨è®­ç»ƒé˜¶æ®µå‘ç”Ÿäº†å¼‚å¸¸ï¼ˆæ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ç¬¬ 6.1 èŠ‚ï¼‰ã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¸Œæœ›é¿å…å­¦ä¹ ç‰¹å®šå‚æ•°çš„åç§°ï¼Œå› ä¸ºå®ƒä»¬ä¸èƒ½è·¨ç³»ç»Ÿæ³›åŒ–ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬å±è”½æ‰€æœ‰å‡ºç°çš„å½“å‰å‚æ•°åç§°ï¼ˆå‡½æ•°å±è”½ï¼‰ã€‚ å¦ä¸€æ–¹é¢ï¼Œå¦‚æœå­¦ä¹ ç³»ç»Ÿå’ŒåŸºå‡†æµ‹è¯•ç‰¹å®šé…ç½®ä»¥è§£å†³å…·ä½“çš„è°ƒä¼˜é—®é¢˜ï¼Œåˆ™æ²¡æœ‰ç†ç”±éšè—ä¿¡æ¯ã€‚ ç®—æ³• 5 ä½¿ç”¨å¸ƒå°”æ ‡å¿— (MASKED_MODE) åœ¨è¿™ä¸¤ç§æ¨¡å¼ä¹‹é—´åˆ‡æ¢ã€‚ è¡¨ 3 æ˜¾ç¤ºäº†ä¸ä¸åŒæ“ä½œå’Œç¬¬ä¸€å†³ç­–çº§åˆ«ç›¸å…³çš„æ ‡ç­¾ã€‚ åœ¨æ­¤çº§åˆ«ï¼Œæˆ‘ä»¬å†³å®šå€™é€‰æç¤ºæ˜¯å¦ä»£è¡¨å®é™…æç¤ºï¼Œå¦‚æœæ˜¯ï¼Œåˆ™ç¡®å®šè¯¥å€¼æ˜¯ç›¸å¯¹å€¼è¿˜æ˜¯ç»å¯¹å€¼ã€‚ æœ€åï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜ç¿»è¯‘ã€‚ ä¾‹ 6.1ã€‚ è€ƒè™‘è°ƒæ•´æç¤º âŸ¨ğ‘¡,ğ‘,ğ‘£âŸ©ï¼Œå…¶ä¸­ ğ‘¡ = â€œå°†å…±äº«ç¼“å†²åŒºè®¾ç½®ä¸º RAM çš„ 25%â€ï¼Œğ‘ = shared_buffers å’Œ ğ‘£ = 25%ã€‚ é¦–å…ˆï¼Œä»£ç†å†³å®šæç¤ºæ˜¯å¦æœ‰æ•ˆä»¥åŠæ˜¯å¦æ¨èç»å¯¹å€¼æˆ–ç›¸å¯¹å€¼ã€‚ ä½¿ç”¨è¡¨ 3 ä¸­çš„æ ‡ç­¾ï¼Œä»£ç†æ ¹æ®æç¤ºæ–‡æœ¬è¯„ä¼°æ›¿ä»£æ“ä½œã€‚ ä¾‹å¦‚ï¼Œå¯¹äºæ“ä½œ 1ï¼Œä»£ç†ç”Ÿæˆè¾“å…¥æ–‡æœ¬â€œå°†å…±äº«ç¼“å†²åŒºè®¾ç½®ä¸º RAM çš„ 25%ã€‚ shared_buffers and 25%ä¸ä¸»å†…å­˜ç›¸å…³ã€‚â€ï¼Œé€šè¿‡ç±»å‹è§„èŒƒåˆ†éš”ä¸¤ä¸ªå¥å­ã€‚ å¦‚æœæ¿€æ´»å±è”½æ¨¡å¼ï¼Œåˆ™ä¸¤æ¬¡å‡ºç°çš„ shared_buffers å‚æ•°å°†è¢«å±è”½ã€‚ ä¸ºäº†åšå‡ºé€‰æ‹©ï¼Œä»£ç†ä¼šåœ¨å†…éƒ¨æ¯”è¾ƒå°† BERT åº”ç”¨äºæ¯ä¸ªå¯èƒ½æ“ä½œçš„è¾“å…¥æ‰€äº§ç”Ÿçš„å€¼ã€‚ ","date":"2024-02-04","objectID":"/posts/llm-capability/:8:2","tags":["Paper Reading"],"title":"Paper Reading: DB-BERT: a Database Tuning Tool that â€œReads the Manualâ€","uri":"/posts/llm-capability/"},{"categories":null,"content":"Aggregating Hints æœ€åä¸€èŠ‚æè¿°å¦‚ä½•ç¿»è¯‘å•ä¸ªè°ƒæ•´æç¤ºã€‚ ç„¶è€Œï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦é›†æˆå¤šä¸ªæç¤ºï¼ˆå¯èƒ½æ¥è‡ªä¸åŒæ¥æºï¼‰ä»¥è·å¾—æœ€ä½³æ€§èƒ½ã€‚ DB-BERT æ ¹æ®æç¤ºç»„åˆ›å»ºé…ç½®ã€‚ è¿™éœ€è¦æ±‡æ€»æ¥è‡ªä¸åŒæ¥æºçš„å¯èƒ½ç›¸äº’å†²çªçš„æç¤ºã€‚ ä¸ºäº†æ”¯æŒè¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬æ‰©å±•äº†ä¸Šä¸€èŠ‚ä¸­ä»‹ç»çš„ MDPã€‚ æˆ‘ä»¬ä¸è€ƒè™‘å•ä¸ªæç¤ºï¼Œè€Œæ˜¯è€ƒè™‘æ•´æ‰¹æç¤ºã€‚ å¯¹äºæ¯ä¸ªæç¤ºï¼Œæˆ‘ä»¬æ·»åŠ ä¸€ä¸ªé¢å¤–çš„å†³ç­–ï¼Œå°†æç¤ºåˆ†é…ç»™æƒé‡ã€‚ è¯¥æƒé‡å†³å®šäº†å°†æç¤ºä¸å…¶ä»–æç¤ºèšåˆåˆ°é…ç½®ä¸­æ—¶çš„ä¼˜å…ˆçº§ã€‚ ç®—æ³• 6 æ˜¾ç¤ºäº† DB-BERT ä¸»å¾ªç¯çš„ä¸€æ¬¡è¿­ä»£æœŸé—´æ‰§è¡Œçš„å®Œæ•´ä¼ªä»£ç ï¼ˆç®—æ³• 6 ç”±ç®—æ³• 1 è°ƒç”¨ï¼‰ã€‚ ä»å¼ºåŒ–å­¦ä¹ çš„è§’åº¦æ¥çœ‹ï¼Œæ¯æ¬¡è¿­ä»£å¯¹åº”äºç›¸å…³ MDP çš„ä¸€ä¸ªæƒ…èŠ‚ã€‚ æ¯ä¸ªæƒ…èŠ‚éƒ½ä»ç›¸åŒçš„èµ·å§‹çŠ¶æ€å¼€å§‹ï¼Œä»£è¡¨é»˜è®¤é…ç½®ã€‚ å› æ­¤ï¼Œä¸é»˜è®¤é…ç½®ç›¸æ¯”ï¼Œæ¯é›†è€ƒè™‘çš„æç¤ºæ•°é‡ç¡®å®é™åˆ¶äº†æœ€å¤§æ›´æ”¹æ•°é‡ã€‚ ç„¶è€Œï¼Œæ­£å¦‚æœ€è¿‘çš„å·¥ä½œæ‰€ç¤ºï¼Œè°ƒæ•´å°‘é‡çš„è°ƒè°æ—‹é’®é€šå¸¸è¶³ä»¥å®ç°æ¥è¿‘æœ€ä½³çš„æ€§èƒ½ã€‚ ç®—æ³• 6 è·å–ä¸€æ‰¹å€™é€‰æç¤ºä½œä¸ºè¾“å…¥ã€‚ å®ƒè¿­ä»£è¿™äº›æç¤ºå¹¶ä½¿ç”¨ç®—æ³• 4ï¼ˆå‡½æ•° Tstepï¼‰æ¥è½¬æ¢å•ä¸ªæç¤ºï¼ˆåˆ†åˆ«ç¡®å®šå€™é€‰æç¤ºæ˜¯é”™è¯¯çš„ä¸”ä¸åº”è¢«è€ƒè™‘ï¼‰ã€‚ æˆ‘ä»¬é€šè¿‡æŒ‡å®š â€œ-â€ ä½œä¸º Tstep çš„åŸºå‡†å‚æ•°æ¥æ¨è¿ŸåŸºå‡†è¯„ä¼°ã€‚ å¦‚æœæˆåŠŸå°†å½“å‰æç¤ºè½¬æ¢ä¸ºå…¬å¼ï¼ˆå³ ğ‘“ â‰  âˆ’ï¼‰ï¼Œç®—æ³• 6 ä¼šåˆ†é…ä¸€ä¸ªæƒé‡ï¼ˆç¬¬ 18 è¡Œï¼‰ã€‚ æƒé‡æ˜¯ä»ç¦»æ•£çš„å¯èƒ½æ€§é›†åˆ ğ‘Š ä¸­é€‰æ‹©çš„ï¼Œå¹¶ç”±å­¦ä¹ ä»£ç†ï¼ˆå‡½æ•° ChooseActionï¼‰åˆ†é…ã€‚ æœ€åï¼Œè¯¥ç®—æ³•ç»„è£…äº†ä¸€ç»„åŠ æƒè°ƒæ•´æç¤º ğ»ğ‘¤ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨åŠ æƒæç¤ºç»„è£…ä¸€ä¸ªæˆ–å¤šä¸ªé…ç½®è¿›è¡Œè¯„ä¼°ã€‚ ç®—æ³• 7 ä½¿ç”¨åŠ æƒæç¤ºä½œä¸ºè¾“å…¥æ¥é€‰æ‹©å’Œè¯„ä¼°é…ç½®ã€‚ å®ƒè¿­ä»£æç¤ºä¸­æåˆ°çš„å‚æ•°ï¼ˆä»ç¬¬ 23 è¡Œå¾ªç¯åˆ°ç¬¬ 30 è¡Œï¼‰å¹¶é€‰æ‹©æœ‰é™æ•°é‡çš„ ğ‘› å€¼è¿›è¡Œå°è¯•ï¼ˆğ‘› æ˜¯ä¸€ä¸ªè°ƒæ•´å‚æ•°ï¼‰ã€‚ é€‰æ‹©å€¼æ˜¯ä¸ºäº†å°½å¯èƒ½è¦†ç›–å»ºè®®å€¼ï¼ˆåœ¨æç¤ºä¸­ï¼‰çš„èŒƒå›´ã€‚ æˆ‘ä»¬è¿­ä»£åœ°é€‰æ‹©å€¼ï¼ˆä»ç¬¬ 26 è¡Œå¾ªç¯åˆ°ç¬¬ 29 è¡Œï¼‰ã€‚ æˆ‘ä»¬å¸Œæœ›åœ¨ä»¥ä¸‹æ„ä¹‰ä¸Šå°½å¯èƒ½æ¥è¿‘åœ°æ¶µç›–æç¤ºä¸­æå‡ºçš„å€¼ã€‚ ç»™å®šä¸€ä¸ªæ¯”è¾ƒç›¸åŒå‚æ•°å€¼çš„è·ç¦»å‡½æ•° ğ›¿ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯æœ€å°åŒ–æç¤ºä¸­æå‡ºçš„å€¼ä¸æœ€æ¥è¿‘çš„é€‰å®šå€¼ä¹‹é—´çš„æœ€å¤§åŠ æƒè·ç¦»ã€‚ ç»™å®šä¸€ç»„åŠ æƒå€¼ ğ‘‰ å’Œä¸€ç»„é€‰å®šçš„é…ç½® ğ¶ï¼Œå‡½æ•° MaxDist è®¡ç®—åä¸€ä¸ªæŒ‡æ ‡ã€‚ æˆ‘ä»¬è´ªå©ªåœ°é€‰æ‹©å€¼ï¼Œåœ¨æ¯ä¸€æ­¥ä¸­æœ€å°åŒ–ä¸Šè¿°æˆæœ¬å‡½æ•°ã€‚ è¯·æ³¨æ„ï¼ŒæŸäº›è°ƒæ•´æ—‹é’®åªèƒ½è®¾ç½®ä¸ºå…¶å€¼èŒƒå›´å†…çš„ç‰¹å®šå€¼ï¼ˆä¾‹å¦‚ï¼ŒMySQL çš„ innodb_buffer_pool_size å¿…é¡»æ˜¯å—å¤§å°çš„å€æ•°ï¼‰ã€‚ æˆ‘ä»¬ä¸èƒ½ç®€å•åœ°å¹³å‡å»ºè®®å€¼ã€‚ ä¾‹ 7.1ã€‚ å‡è®¾æˆ‘ä»¬æ”¶é›†å»ºè®®å‚æ•° shared_buffers çš„ä»¥ä¸‹å€¼çš„æç¤ºï¼š1GBï¼Œæƒé‡ 1ï¼Œ2GBï¼Œæƒé‡ 8ï¼Œ8GBï¼Œæƒé‡ 1ã€‚å½“é€‰æ‹© 1GB æ—¶ï¼Œæˆ‘ä»¬è·å¾—æœ€å¤§åŠ æƒè·ç¦» 8Â·|2âˆ’1| = 8 GB ä¸å€¼ 2 GBï¼ˆä»…è·ç¦» 1 Â·|8 -1| = 7 GB ä¸ 8 GBï¼‰ã€‚ é€‰æ‹© 2 GB ä¼šäº§ç”Ÿè· 8 GB å€¼ 7 GB çš„æœ€å¤§åŠ æƒè·ç¦»ã€‚ é€‰æ‹© 8 GB ä¼šäº§ç”Ÿè·å€¼ 2 GB çš„æœ€å¤§åŠ æƒè·ç¦» 48 GBã€‚ å› æ­¤ï¼Œæˆ‘ä»¬é¦–å…ˆé€‰æ‹©å€¼ 2 GBã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬é€‰æ‹©å€¼ 8 GB ä»¥å°†æœ€å¤§è·ç¦»æœ€å°åŒ–ä¸º 1 GBã€‚ æœ€åï¼Œæˆ‘ä»¬å°†æ¯ä¸ªå‚æ•°çš„é€‰å®šå€¼ç»„åˆæˆ ğ‘› é…ç½®ï¼ˆç¬¬ 32 è¡Œï¼‰ã€‚ Function Evaluate åœ¨ç»™å®šåŸºå‡† ğ‘ ä¸Šè¯„ä¼°é€‰å®šçš„é…ç½®ã€‚ å®ƒå¯¹ DBMS ä¸æ¥å—çš„é…ç½®è¿›è¡Œæƒ©ç½šï¼Œå¦åˆ™æ ¹æ®åŸºå‡†æ€§èƒ½è®¡ç®—å¥–åŠ±ï¼ˆæˆ‘ä»¬ä½¿ç”¨ç¬¬ 6.1 èŠ‚ä¸­ä»‹ç»çš„å¥–åŠ±å‡½æ•°ï¼‰ã€‚ å‡½æ•° EvalWeighted è¿”å›ä»»ä½•é…ç½®è·å¾—çš„æœ€å¤§å¥–åŠ±ã€‚ ","date":"2024-02-04","objectID":"/posts/llm-capability/:9:0","tags":["Paper Reading"],"title":"Paper Reading: DB-BERT: a Database Tuning Tool that â€œReads the Manualâ€","uri":"/posts/llm-capability/"},{"categories":null,"content":"Experiments ","date":"2024-02-04","objectID":"/posts/llm-capability/:10:0","tags":["Paper Reading"],"title":"Paper Reading: DB-BERT: a Database Tuning Tool that â€œReads the Manualâ€","uri":"/posts/llm-capability/"},{"categories":null,"content":"Setup æˆ‘ä»¬æ¯”è¾ƒäº† MySQL 8.0 å’Œ Postgres 13.2 çš„ç³»ç»Ÿé…ç½®å‚æ•°è°ƒæ•´æ–¹æ³•ã€‚ æˆ‘ä»¬è€ƒè™‘è¿™äº›ç³»ç»Ÿæä¾›çš„æ‰€æœ‰æ•°å­—å’Œå¸ƒå°”è°ƒæ•´å‚æ•°ï¼šPostgres çš„ 232 ä¸ªå‚æ•°å’Œ MySQL çš„ 266 ä¸ªå‚æ•°ã€‚ æˆ‘ä»¬ä½¿ç”¨æ¯”ä¾‹å› å­ä¸º 1ï¼ˆç¬¬ 8.4 èŠ‚ï¼‰å’Œ 10ï¼ˆç¬¬ 8.5 èŠ‚ï¼‰çš„ TPC-H ä»¥åŠæ¯”ä¾‹å› å­ä¸º 20 çš„ TPCC ä½œä¸ºåŸºå‡†ã€‚ å¯¹äº TPC-Cï¼Œæˆ‘ä»¬ä½¿ç”¨ 10 ä¸ªç»ˆç«¯ï¼Œä¸é™åˆ¶åˆ°è¾¾ç‡ï¼Œé¢„çƒ­å’Œæµ‹é‡æ—¶é—´å‡ä¸º 60 ç§’ã€‚ é™¤äº†è¿™äº›å‚æ•°ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜ä½¿ç”¨ OLTP åŸºå‡†æµ‹è¯•ä¸­çš„ Postgres å’Œ MySQL çš„é»˜è®¤ TPC-C é…ç½®ã€‚ æˆ‘ä»¬æ‰§è¡Œäº”æ¬¡è¿è¡Œï¼Œå¹¶å…è®¸ 25 åˆ†é’Ÿçš„è°ƒæ•´æ—¶é—´ï¼ˆä¹‹å‰çš„å·¥ä½œä½¿ç”¨ç›¸åŒçš„æ—¶é—´èŒƒå›´ ï¼‰ã€‚ æ‰€æœ‰å®éªŒå‡åœ¨å…·æœ‰ 8 ä¸ª vCPUã€61 GB RAM å’Œå…·æœ‰ 16 GB å†…å­˜çš„ Tesla V100 GPU çš„ p3.2xlarge EC2 å®ä¾‹ä¸Šæ‰§è¡Œã€‚ EC2 å®ä¾‹ä½¿ç”¨ Amazon Deep Learning AMI å’Œ Ubuntu 18.04ã€‚ æˆ‘ä»¬ä¸æœ€è¿‘çš„ DDPG++ ç®—æ³• è¿›è¡Œæ¯”è¾ƒï¼Œä½œä¸ºæ²¡æœ‰ NLP å¢å¼ºçš„è°ƒä¼˜çš„ä»£è¡¨ã€‚ æˆ‘ä»¬è€ƒè™‘è°ƒæ•´å‚æ•°çš„ä¸åŒå€¼èŒƒå›´ï¼ŒèŒƒå›´ä»é»˜è®¤å€¼çš„ä¸¤å€ï¼ˆå³ ğ‘‘/2 åˆ° 2Â·ğ‘‘ï¼Œå…¶ä¸­ ğ‘‘ æ˜¯é»˜è®¤å€¼ï¼‰åˆ° 100ã€‚æˆ‘ä»¬å°†è¿™äº›ç‰ˆæœ¬è¡¨ç¤ºä¸º DDPG2ã€DDPG10 å’Œ DDPG100 ä»¥ä¸‹æƒ…èŠ‚ã€‚ æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜ä¸æœ€è¿‘ä¸€ç¯‡å…³äº NLP å¢å¼ºæ•°æ®åº“è°ƒä¼˜çš„è®ºæ–‡ä¸­æè¿°çš„ä¸¤ä¸ªåŸºçº¿è¿›è¡Œäº†æ¯”è¾ƒã€‚ åœ¨ä¸‹æ–‡ä¸­ï¼ŒPrior-Main è¡¨ç¤ºå…ˆå‰å·¥ä½œæå‡ºçš„åŸºäºç›‘ç£å­¦ä¹ çš„ä¸»è¦æ–¹æ³•ã€‚ æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜ä¸åŒä¸€ç¯‡è®ºæ–‡ä¸­æè¿°çš„ç®€å•åŸºçº¿ï¼ˆè¡¨ç¤ºä¸º Prior-Simpleï¼‰è¿›è¡Œæ¯”è¾ƒ é»˜è®¤æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯¹ DB-BERT ä½¿ç”¨ä»¥ä¸‹é…ç½®å‚æ•°ã€‚ DB-BERT ä½¿ç”¨å¼ºåŒ–å­¦ä¹ ä»ä¸€ç»„å›ºå®šçš„æ›¿ä»£æ–¹æ¡ˆä¸­ä¸ºæ¯ä¸ªæç¤ºé€‰æ‹©ä¹˜æ•°å€¼å’Œæƒé‡ã€‚ å¯¹äºæ‰€æœ‰å®éªŒï¼ŒDB-BERT ä»é›†åˆ {1/4,1/2,1,2,4} ä¸­é€‰æ‹©ä¹˜æ•°ï¼Œå¹¶ä»é›†åˆ {0,2,4,8,16} ä¸­é€‰æ‹©æƒé‡ã€‚ æˆ‘ä»¬åœ¨æ¯ç§æƒ…å†µä¸‹éƒ½ä½¿ç”¨ç›¸åŒæ•°é‡çš„æ›¿ä»£æ–¹æ¡ˆï¼ˆäº”ä¸ªï¼‰ã€‚ è¿™ä½¿å¾—ä½¿ç”¨ OpenAI Gym æ¡†æ¶å¯¹ç›¸å…³ç¯å¢ƒè¿›è¡Œå»ºæ¨¡å˜å¾—æ›´åŠ å®¹æ˜“ã€‚ æˆ‘ä»¬é¿å…ä½¿ç”¨è¿‡å°æˆ–è¿‡å¤§çš„ä¹˜æ³•å™¨ï¼ˆå¦‚æœæœ€ä½³å‚æ•°å€¼åœ¨ä»»ä½•æ–¹å‘ä¸Šä¸å»ºè®®å€¼çš„åå·®è¶…è¿‡å››å€ï¼Œåˆ™åº”å¿½ç•¥ç›¸å…³æç¤ºï¼‰ã€‚ æƒé‡æ›¿ä»£é›†å…è®¸ DB-BERT å¿½ç•¥æç¤ºï¼ˆé€šè¿‡ä½¿ç”¨é›¶æƒé‡ï¼‰ï¼Œå¹¶ä½¿ç‰¹å®šæç¤ºçš„é‡è¦æ€§æ¯”å…¶ä»–å…·æœ‰éé›¶æƒé‡çš„æç¤ºé‡è¦å…«å€ã€‚ æˆ‘ä»¬å°† ğ‘™ è®¾ç½®ä¸º 10ï¼Œä»¥ä¾¿æ¯ä¸ªæƒ…èŠ‚å’Œå‚æ•°æœ€å¤šå…è®¸ 10 ä¸ªæç¤ºã€‚ æˆ‘ä»¬æ€»å…±è€ƒè™‘æ¯é›†æœ€å¤š 50 ä¸ªæç¤º (ğ‘’ = 50)ï¼Œå¹¶è¯„ä¼°æ¯é›†çš„ä¸¤ç§é…ç½® (ğ‘› = 2)ã€‚ DB-BERT å°†æ–‡æœ¬æ–‡æ¡£åˆ†å‰²æˆé•¿åº¦æœ€å¤šä¸º 128 ä¸ªæ ‡è®°çš„ç‰‡æ®µã€‚ æ‰€æœ‰åŸºçº¿å‡åœ¨ Python 3.7 ä¸­å®ç°ï¼Œä½¿ç”¨ Pytorch 1.8.1 å’Œï¼ˆå¯¹äº NLP å¢å¼ºçš„è°ƒæ•´åŸºçº¿ï¼‰Huggingface Transformers åº“ã€‚ DB-BERT ä½¿ç”¨ Google çš„å¯ç¼–ç¨‹æœç´¢å¼•æ“ API6 æ¥æ£€ç´¢æ–‡æœ¬æ–‡æ¡£ã€‚ æ­¤å¤–ï¼ŒDB-BERT ä½¿ç”¨è‡ªä¸»å­¦ä¹ åº“ 7 ä¸­çš„ Double Deep Q-Networks å®ç°ä½œä¸ºå¼ºåŒ–å­¦ä¹ ç®—æ³• ","date":"2024-02-04","objectID":"/posts/llm-capability/:10:1","tags":["Paper Reading"],"title":"Paper Reading: DB-BERT: a Database Tuning Tool that â€œReads the Manualâ€","uri":"/posts/llm-capability/"},{"categories":null,"content":"Tuning Text Documents DB-BERT é™„å¸¦ä¸€ä¸ªè„šæœ¬ï¼Œå¯ä»¥é€šè¿‡ Google æœç´¢æ£€ç´¢æ–‡æœ¬æ–‡æ¡£å¹¶å°†å…¶è½¬æ¢ä¸º DB-BERT æ‰€éœ€çš„è¾“å…¥æ ¼å¼ã€‚ å¯¹äºä»¥ä¸‹å¤§éƒ¨åˆ†å®éªŒï¼Œæˆ‘ä»¬ä½¿ç”¨é€šè¿‡æŸ¥è¯¢â€œPostgresql æ€§èƒ½è°ƒæ•´æç¤ºâ€ï¼ˆ2021 å¹´ 4 æœˆ 11 æ—¥å‘å¸ƒï¼‰å’Œâ€œMySQL æ€§èƒ½è°ƒæ•´æç¤ºâ€ï¼ˆ2021 å¹´ 4 æœˆ 15 æ—¥å‘å¸ƒï¼‰æ£€ç´¢çš„ä¸¤ä¸ªæ–‡æ¡£é›†åˆã€‚ æˆ‘ä»¬å°†è¿™ä¸¤ä¸ªæŸ¥è¯¢çš„å‰ 100 ä¸ª Google ç»“æœåŒ…å«åˆ°ç›¸åº”çš„æ–‡æ¡£é›†åˆä¸­ï¼ˆPostgres æ€»å…±å  1.3 MB æ–‡æœ¬ï¼ŒMySQL æ€»å…±å  2.4 MB æ–‡æœ¬ï¼‰ã€‚ ç»“æœå¤šç§å¤šæ ·ï¼Œæ¶µç›–åšå®¢æ¡ç›®ã€è®ºå›è®¨è®ºï¼ˆä¾‹å¦‚ï¼Œæ•°æ®åº“ç®¡ç†å‘˜ Stack Exchange8ï¼‰ä»¥åŠä¸¤ä¸ªæ•°æ®åº“ç³»ç»Ÿçš„åœ¨çº¿æ‰‹å†Œã€‚ ä¸‹é¢æˆ‘ä»¬å°† Postgres Pg100 çš„æ–‡æ¡£é›†åˆå’Œ MySQL Ms100 çš„æ–‡æ¡£é›†åˆç§°ä¸ºã€‚ å›¾ 5 æ˜¾ç¤ºäº†è¿™äº›æ–‡æ¡£é›†åˆä¸­å‚æ•°æåŠå’Œå»ºè®®å€¼åˆ†é…çš„åˆ†å¸ƒï¼Œè¿™äº›æ–‡æ¡£é›†åˆæ˜¯é€šè¿‡ DB-BERT çš„å€™é€‰æç¤ºæå–æœºåˆ¶ç”Ÿæˆçš„ï¼ˆå‚è§ç¬¬ 5 èŠ‚ï¼‰ã€‚ æ˜¾ç„¶ï¼Œæ–‡æ¡£å’Œå‚æ•°ä¸Šçš„æç¤ºåˆ†å¸ƒæ˜¯ä¸å‡åŒ€çš„ã€‚ å¯¹äºè¿™ä¸¤ä¸ªæ•°æ®åº“ç³»ç»Ÿï¼Œåœ¨å¤šä¸ªæ–‡æ¡£ä¸­æåˆ°çš„å‚æ•°å¾ˆå°‘ï¼Œè€Œå¤§å¤šæ•°å‚æ•°ä»…åœ¨å•ä¸ªæ–‡æ¡£ä¸­æåˆ°ã€‚ åŒæ ·ï¼Œå¤šä¸ªæ¥æºæå‡ºäº†ä¸€äº›ä»»åŠ¡ã€‚ å¦ä¸€æ–¹é¢ï¼Œå¤§å¤šæ•°ä»·å€¼åˆ†é…ä»…æå‡ºä¸€æ¬¡ã€‚ è¡¨ 4 æ˜¾ç¤ºäº† Postgres å’Œ MySQL æœ€å¸¸æåˆ°çš„å‚æ•°ã€‚ å…¶ä¸­ä¸ç¼“å†²åŒºå¤§å°ç›¸å…³çš„å‚æ•°ï¼ˆä¾‹å¦‚ï¼ŒPostgres çš„å…±äº«ç¼“å†²åŒºå’Œ MySQL çš„ innodb_buffer_pool_sizeï¼‰å°¤ä¸ºçªå‡ºã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œä¸å¹¶è¡Œæ€§ï¼ˆä¾‹å¦‚ max_parallel_workers_per_gatherï¼‰æˆ–æ—¥å¿—è®°å½•ï¼ˆä¾‹å¦‚ max_wal_sizeï¼‰ç›¸å…³çš„å‚æ•°ä¹Ÿç»å¸¸è¢«æåŠã€‚ ","date":"2024-02-04","objectID":"/posts/llm-capability/:10:2","tags":["Paper Reading"],"title":"Paper Reading: DB-BERT: a Database Tuning Tool that â€œReads the Manualâ€","uri":"/posts/llm-capability/"},{"categories":null,"content":"Training å…¶ä¸­ä¸¤ç§æ¯”è¾ƒç®—æ³•ï¼Œå³ DB-BERT å’Œ Prior-Mainï¼Œåœ¨è¿è¡Œå‰ä½¿ç”¨è®­ç»ƒã€‚ Prior-Main ä½¿ç”¨è‡ªç„¶è¯­è¨€è°ƒæ•´æç¤ºï¼ˆç”¨ç›¸å…³å…¬å¼æ³¨é‡Šï¼‰ä½œä¸ºè®­ç»ƒæ•°æ®ã€‚ æˆ‘ä»¬ä½¿ç”¨ä¸ä¹‹å‰çš„å·¥ä½œç›¸åŒçš„è®­ç»ƒæ ·æœ¬å’Œè®­ç»ƒå‚æ•°ã€‚ ä¸åä¸€ç¯‡è®ºæ–‡ä¸­çš„å®éªŒè®¾ç½®ä¸€è‡´ï¼Œæˆ‘ä»¬åº”ç”¨åœ¨ Postgres æ ·æœ¬ä¸Šè®­ç»ƒçš„ Prior-Main æ¥è°ƒä¼˜ MySQLï¼Œå¹¶åº”ç”¨åœ¨ MySQL æ ·æœ¬ä¸Šè®­ç»ƒçš„ Prior-Main æ¥è°ƒä¼˜ Postgresã€‚ ç›®æ ‡æ˜¯è¯æ˜ NLP å¢å¼ºçš„æ•°æ®åº“è°ƒä¼˜ä¸éœ€è¦ç‰¹å®šäºç³»ç»Ÿçš„å¸¦æ³¨é‡Šçš„ç¤ºä¾‹ã€‚ Prior-Main ä¸æ”¯æŒä»å›ºå®šæ–‡æ¡£é›†åˆä¸­æå–ç‰¹å®šäºåŸºå‡†æµ‹è¯•çš„è°ƒæ•´æç¤ºï¼Œå¦‚æœä½¿ç”¨ç›¸åŒçš„æ–‡æ¡£é›†åˆæ¥è°ƒæ•´å¤šä¸ªåŸºå‡†æµ‹è¯•ï¼Œåˆ™è¿™æ˜¯ä¸€ä¸ªç¼ºç‚¹ã€‚ ä¸ºäº†è‡³å°‘å…è®¸ä¸€å®šç¨‹åº¦çš„å¯å˜æ€§ï¼Œæˆ‘ä»¬ä¸ºäº”ä¸ªåŸºå‡†è¿è¡Œä¸­çš„æ¯ä¸€ä¸ªå•ç‹¬è®­ç»ƒ Prior-Main æ¨¡å‹ã€‚ è¿™å¯¼è‡´æ¯æ¬¡è¿è¡Œä¸­çš„æå–ç•¥æœ‰ä¸åŒã€‚ åœ¨ç¬¬ 8.1 èŠ‚ä¸­æ¦‚è¿°çš„å¹³å°ä¸Šè®­ç»ƒ Prior-Main å¯¹äº MySQL æ ·æœ¬éœ€è¦ 417 ç§’ï¼Œå¯¹äº Postgres æ ·æœ¬éœ€è¦ 393 ç§’ã€‚ DB-BERT ä¸ä½¿ç”¨å¸¦æ³¨é‡Šçš„è°ƒä¼˜æç¤ºè¿›è¡Œè®­ç»ƒã€‚ ç›¸åï¼Œå®ƒåœ¨è®­ç»ƒé˜¶æ®µä½¿ç”¨æ•°æ®åº“ç³»ç»Ÿæœ¬èº«è¿›è¡Œè¿è¡Œæ—¶åé¦ˆã€‚ ä¸ Prior-Main ç±»ä¼¼ï¼Œæˆ‘ä»¬åœ¨ Pg100 ä¸Šè®­ç»ƒ DB-BERT æ¥è°ƒæ•´ MySQLï¼Œåœ¨ Ms100 ä¸Šè®­ç»ƒ DB-BERT æ¥è°ƒæ•´ Postgresã€‚ æˆ‘ä»¬åœ¨è®­ç»ƒæœŸé—´æ¿€æ´» mask modeï¼ˆå‚è§ç¬¬ 6 èŠ‚ï¼‰ï¼Œè¿™æ„å‘³ç€å‚æ•°åç§°è¢«å±è”½ã€‚ è¿™é¿å…äº†å­¦ä¹ ç³»ç»Ÿç‰¹å®šçš„å‚æ•°åç§°ï¼ˆè¿™åœ¨æˆ‘ä»¬çš„å®éªŒè®¾ç½®ä¸­æ— ç”¨ï¼‰ï¼Œå¹¶å°†æ³¨æ„åŠ›é›†ä¸­åœ¨è°ƒæ•´æç¤ºçš„å¥å­ç»“æ„ä¸Šã€‚ DB-BERT çš„å¥–åŠ±ä¿¡å·ï¼ˆå‚è§ç¬¬ 6 èŠ‚å’Œç¬¬ 7 èŠ‚ï¼‰ç»“åˆäº†æ ¹æ®è°ƒæ•´æç¤ºæˆåŠŸæ›´æ”¹å‚æ•°å€¼ï¼ˆæ„å‘³ç€ç›¸åº”å€¼æœ‰æ•ˆï¼‰å’Œè·å¾—çš„æ€§èƒ½çš„å¥–åŠ±ã€‚ ä¸ºäº†è¡¡é‡æ€§èƒ½ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªç»¼åˆæ•°æ®åº“ï¼Œå…¶ä¸­åŒ…å«ä¸¤ä¸ªè¡¨ï¼Œå…¶ä¸­ä¸¤åˆ—åŒ…å«ä» 1 åˆ° 1,000,000 çš„è¿ç»­æ•°å­—ã€‚ æˆ‘ä»¬ä½¿ç”¨ç®€å•çš„è®¡æ•°èšåˆæŸ¥è¯¢é€šè¿‡ç›¸ç­‰è°“è¯è¿æ¥ä¸¤ä¸ªè¡¨ã€‚ å¯¹æ€§èƒ½çš„å¥–åŠ±æŒ‰æ¯”ä¾‹ç¼©å°äº† 100 å€ï¼Œä»¥é¿å…ä¸“é—¨é’ˆå¯¹æ­¤äººä¸ºåŸºå‡†ï¼ˆå®ƒä»…ç”¨äºæƒ©ç½šç‰¹åˆ«ç³Ÿç³•çš„é…ç½®ï¼Œä¾‹å¦‚å°†ç¼“å†²æ± å¤§å°è®¾ç½®ä¸ºæœ€å°å€¼ï¼‰ã€‚ æœ€åï¼Œæˆ‘ä»¬ä¸ºè®¾ç½®ä¸é»˜è®¤è®¾ç½®ç›¸åŒæ•°é‡çº§çš„å‚æ•°å€¼æ·»åŠ ä¸€ä¸ªå°çš„å¥–åŠ±å¥–é‡‘ï¼ˆå‡è®¾ä¸é»˜è®¤å€¼çš„æç«¯åå·®æ˜¯å¯èƒ½çš„ï¼Œä½†å¯èƒ½æ€§è¾ƒå°ï¼‰ã€‚ DB-BERT çš„è®­ç»ƒä»å…·æœ‰ 1.1 äº¿ä¸ªå‚æ•°çš„ BERT åŸºç¡€æ¨¡å‹ [3] å¼€å§‹ã€‚ æ‰€æœ‰æ¨¡å‹å‚æ•°å‡åœ¨è®­ç»ƒæœŸé—´è°ƒæ•´ã€‚ æˆ‘ä»¬åœ¨ Pg100 ä¸Šè®­ç»ƒ DB-BERT 5,000 æ¬¡è¿­ä»£ï¼Œåœ¨ Ms100 ä¸Šè®­ç»ƒ DB-BERT 10,000 æ¬¡è¿­ä»£ï¼ˆç”±äºè¯¥é›†åˆä¸­çš„æç¤ºæ•°é‡è¾ƒå¤šï¼‰ã€‚ Pg100 çš„è®­ç»ƒæ—¶é—´ä¸º 43 åˆ†é’Ÿï¼ŒMs100 çš„è®­ç»ƒæ—¶é—´ä¸º 84 åˆ†é’Ÿã€‚ å›¾ 6 æ˜¾ç¤ºäº† Pg100 çš„è¿›åº¦ä¸è®­ç»ƒæ­¥éª¤æ•°çš„å‡½æ•°å…³ç³» ","date":"2024-02-04","objectID":"/posts/llm-capability/:10:3","tags":["Paper Reading"],"title":"Paper Reading: DB-BERT: a Database Tuning Tool that â€œReads the Manualâ€","uri":"/posts/llm-capability/"},{"categories":null,"content":"Comparison with Baselines æˆ‘ä»¬å°† DB-BERT ä¸ TPC-Hï¼ˆè§å›¾ 7ï¼‰å’Œ TPC-Cï¼ˆè§å›¾ 8ï¼‰çš„åŸºçº¿è¿›è¡Œæ¯”è¾ƒã€‚ æˆ‘ä»¬æ¯æ¬¡è¿è¡Œéƒ½ä¼šè°ƒæ•´ Postgres å’Œ MySQL 25 åˆ†é’Ÿã€‚ æˆ‘ä»¬ä½¿ç”¨ååé‡ä½œä¸º TPC-C çš„ä¼˜åŒ–æŒ‡æ ‡å’Œ TPC-H çš„æ‰§è¡Œæ—¶é—´ã€‚ æˆ‘ä»¬å°†æ‰¾åˆ°çš„æœ€ä½³é…ç½®ï¼ˆy è½´ï¼‰çš„æ€§èƒ½æ˜¾ç¤ºä¸ºä¼˜åŒ–æ—¶é—´ï¼ˆx è½´ï¼‰çš„å‡½æ•°ã€‚ åœ¨è¿™äº›å›¾ä¸­å’Œä¸‹é¢çš„å›¾ä¸­ï¼Œæˆ‘ä»¬æŠ¥å‘Šäº†ç®—æœ¯å¹³å‡å€¼ä»¥åŠäº”æ¬¡è¿è¡Œçš„ç¬¬ 20 ä¸ªå’Œç¬¬ 80 ä¸ªç™¾åˆ†ä½æ•°ï¼ˆä½¿ç”¨è¯¯å·®çº¿æ˜¾ç¤ºç™¾åˆ†ä½æ•°ï¼‰ã€‚ DDPG++ æ˜¯ä¸€ç§åŸºäºå¼ºåŒ–å­¦ä¹ çš„æ•°æ®åº“è°ƒä¼˜æ–¹æ³•ã€‚ å®ƒè¢«è¯æ˜ä¸å„ç§å…¶ä»–æœ€å…ˆè¿›çš„è°ƒæ•´æ–¹æ³•å…·æœ‰ç«äº‰åŠ›ã€‚ ç„¶è€Œï¼Œä¹‹å‰çš„è®ºæ–‡è¯„ä¼°äº† DDPG++ çš„æ•°åä¸ªè°ƒæ•´å‚æ•°ï¼Œå¹¶ä¸ºæ¯ä¸ªè°ƒæ•´ä¼šè¯åˆ†é… 150 æ¬¡è¿­ä»£ã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬è€ƒè™‘äº†æ•°ç™¾ä¸ªå‚æ•°è¿›è¡Œè°ƒæ•´ï¼Œå¹¶åªå…è®¸å¾ˆå°‘è¿­ä»£çš„è°ƒæ•´æ—¶é—´èŒƒå›´ã€‚ æ˜¾ç„¶ï¼Œåœ¨åˆ†é…çš„æ—¶é—´èŒƒå›´å†…ï¼ŒDDPG++ æ²¡æœ‰æ‰¾åˆ°ä¸ DB-BERT è´¨é‡ç›¸å½“çš„è§£å†³æ–¹æ¡ˆã€‚ ç‰¹åˆ«æ˜¯å¯¹äº TPC-Hï¼ŒDDPG++ ç»å¸¸å°è¯•æ˜¾ç€é™ä½æ€§èƒ½çš„å‚æ•°æ›´æ”¹ï¼ˆä¾‹å¦‚ï¼Œä¼˜åŒ–å™¨æˆæœ¬å¸¸é‡çš„æ›´æ”¹è§¦å‘ä¸åŒçš„è¿æ¥é¡ºåºï¼‰ã€‚ å› æ­¤ï¼Œå¯¹äº DDPG++ï¼Œæ‰¾åˆ°çš„æœ€ä½³é…ç½®çš„æ€§èƒ½å‡ ä¹ä¿æŒä¸å˜ï¼ˆæ¥è¿‘é€šè¿‡åˆå§‹è¿­ä»£ä¹‹å‰å°è¯•çš„é»˜è®¤é…ç½®å®ç°çš„æ€§èƒ½ï¼‰ã€‚ DDPG++ å¯ä»¥å—ç›ŠäºæŒ‡å®šåœ¨è°ƒæ•´æœŸé—´è¦è€ƒè™‘çš„ç‰¹å®šå‚æ•°å€¼èŒƒå›´ã€‚ ä¾‹å¦‚ï¼Œä¸é»˜è®¤è®¾ç½®ç›¸æ¯”ï¼Œå°†ç¼“å†²æ± å¤§å°å¢åŠ ä¸€ä¸ªæ•°é‡çº§é€šå¸¸æ˜¯æœ‰ç›Šçš„ã€‚ ç„¶è€Œï¼Œå¯¹äºä¼˜åŒ–å™¨æˆæœ¬å¸¸é‡ï¼ˆä¾‹å¦‚ Postgres ä¸­çš„ random_page_costï¼‰ï¼Œè¿™æ ·åšæ˜¯å±é™©çš„ã€‚ æˆ‘ä»¬çš„ç›®æ ‡æ˜¯è¡¨æ˜æ­¤ç±»è¾“å…¥å¯ä»¥éƒ¨åˆ†åœ°è¢«ä»æ–‡æœ¬ä¸­è‡ªåŠ¨æŒ–æ˜çš„ä¿¡æ¯æ‰€æ›¿ä»£ã€‚ Prior-Simple å’Œ Prior-Main æ˜¯ä¸¤ä¸ªæœ€ç›¸å…³çš„åŸºçº¿ï¼Œå› ä¸ºä¸¤è€…éƒ½ä½¿ç”¨è°ƒæ•´æ–‡æœ¬ä½œä¸ºè¾“å…¥ï¼Œç±»ä¼¼äº DB-BERTã€‚ PriorSimple ä½¿ç”¨æœ´ç´ å¯å‘å¼è¿›è¡Œç¿»è¯‘ã€‚ åº”ç”¨è¿™ç§å¯å‘å¼æ–¹æ³•å¾ˆå¿«ï¼Œå¹¶ä¸” Prior-Simple é€šå¸¸æ˜¯è¿”å›ç»“æœçš„ç¬¬ä¸€ä¸ªåŸºçº¿ã€‚ ä½†æ˜¯ï¼Œå®ƒä»…ä» Pg100 ä¸­æå–å°† checkpoint_completion_target è®¾ç½®ä¸º 0.9 çš„å»ºè®®ï¼Œè€Œæ²¡æœ‰ä» Ms100 ä¸­æå–å»ºè®®ã€‚ å› æ­¤ï¼Œå®ƒä¸ä¼šæ¯”é»˜è®¤é…ç½®æœ‰æ‰€æ”¹è¿›ã€‚ Prior-Main çš„æ€§èƒ½æ˜æ˜¾æ›´å¥½ã€‚ ç”±äºè®­ç»ƒä¸­çš„å¾®å°å·®å¼‚ï¼Œä¸åŒè¿è¡Œä¸­çš„æå–æœ‰æ‰€ä¸åŒï¼Œä»è€Œå¯¼è‡´è¾ƒé«˜çš„æ–¹å·®ã€‚ ä¾‹å¦‚ï¼Œå¯¹äº Pg100ï¼ŒPrior-Main èƒ½å¤Ÿæå–ä¸€ä¸ªè°ƒæ•´æç¤ºï¼Œå»ºè®®åœ¨äº”æ¬¡è¿è¡Œä¸­æœ‰ä¸¤æ¬¡å°†å…±äº«ç¼“å†²åŒºè®¾ç½®ä¸ºä¸»å†…å­˜çš„ 25%ã€‚ è¿™å¯ä»¥æ˜¾ç€æé«˜æ€§èƒ½ï¼Œç‰¹åˆ«æ˜¯å¯¹äº TPC-Hã€‚ ç„¶è€Œï¼Œå¹³å‡æ€§èƒ½æ˜æ˜¾ä½äºæœ€ä½³æ€§èƒ½ã€‚ ç”±äº Prior-Main åœ¨èšåˆè°ƒæ•´æç¤ºä¹‹å‰å¯¹æ–‡æ¡£é›†åˆä¸­çš„æ‰€æœ‰å¥å­è¿›è¡Œåˆ†ç±»ï¼Œå› æ­¤å…¶è¿è¡Œæ—¶é—´æ˜æ˜¾é«˜äº Prior-Simpleã€‚ DB-BERT åœ¨è°ƒä¼˜æ—¶é—´å’Œç»“æœè´¨é‡ä¹‹é—´å®ç°äº†æœ‰å¸å¼•åŠ›çš„æƒè¡¡ã€‚ ä¸ DDPG++ ä¸åŒï¼Œå®ƒä½¿ç”¨è°ƒæ•´æ–‡æœ¬ä½œä¸ºè¾“å…¥ï¼Œå¯ä»¥å¿«é€Ÿè¯†åˆ«æœ€ç›¸å…³çš„å‚æ•°å’Œå€™é€‰å€¼ã€‚ ä¸ Prior-Simple å’Œ Prior-Main ç›¸æ¯”ï¼Œå®ƒå¹³å‡æ‰¾åˆ°æ˜æ˜¾æ›´å¥½çš„è§£å†³æ–¹æ¡ˆã€‚ ç‰¹åˆ«æ˜¯å¯¹äº MySQLï¼ŒPrior-Main é€šå¸¸æ— æ³•æ‰¾åˆ°è´¨é‡ç›¸å½“çš„è§£å†³æ–¹æ¡ˆã€‚ æ­¤å¤–ï¼Œä¸ DB-BERT äº§ç”Ÿæ¥è¿‘æœ€ä¼˜è§£çš„æ—¶é—´ï¼ˆå³ï¼Œä¸ DB-BERT æœ€ç»ˆæœ€ä¼˜è§£çš„ç™¾åˆ†ä¹‹ä¸€ä»¥å†…ï¼‰ç›¸æ¯”ï¼ŒPrior-Main åˆ†ææ‰€æœ‰æ–‡æ¡£æ‰€èŠ±è´¹çš„æ—¶é—´é€šå¸¸è¦é«˜å‡ºä¸¤åˆ°ä¸‰å€ã€‚ ï¼‰ã€‚ è¡¨ 5 å’Œè¡¨ 6 æ˜¾ç¤ºäº† DB-BERT åœ¨è°ƒä¼˜ Postgres æ—¶å‘ç°çš„é…ç½®ã€‚ å°½ç®¡ä»åŒä¸€æ–‡æ¡£é›†åˆä¸­æå–æç¤ºï¼ŒDB-BERT ä»èƒ½å¤Ÿæ‰¾åˆ°ç‰¹å®šäºåŸºå‡†çš„é…ç½® ","date":"2024-02-04","objectID":"/posts/llm-capability/:10:4","tags":["Paper Reading"],"title":"Paper Reading: DB-BERT: a Database Tuning Tool that â€œReads the Manualâ€","uri":"/posts/llm-capability/"},{"categories":null,"content":"Further Analysis æˆ‘ä»¬ç ”ç©¶ä¸åŒå› ç´ å¯¹è°ƒä¼˜æ€§èƒ½çš„å½±å“ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬å°† DB-BERT ä¸å›¾ 9 ä¸­çš„ä¸¤ä¸ªç®€åŒ–å˜ä½“è¿›è¡Œæ¯”è¾ƒã€‚æˆ‘ä»¬ä¸æŒ‰æ–‡æ¡£é¡ºåºå¤„ç†æç¤ºçš„ DB-BERT å˜ä½“è¿›è¡Œæ¯”è¾ƒï¼ˆè€Œä¸æ˜¯æŒ‰ç…§ç¬¬ 5 èŠ‚ä¸­çš„æè¿°å¯¹æç¤ºè¿›è¡Œä¼˜å…ˆçº§æ’åºï¼‰ã€‚ æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜ä¸ä¸è€ƒè™‘éšå¼æç¤ºçš„å˜ä½“è¿›è¡Œæ¯”è¾ƒï¼ˆå³ï¼Œä»…æ˜¾å¼æåŠå‚æ•°åç§°çš„æç¤ºï¼‰ã€‚ æ˜¾ç„¶ï¼Œè¿™ä¸¤ç§ç®€åŒ–éƒ½ä¼šé™ä½ TPC-H çš„è°ƒæ•´æ€§èƒ½ã€‚ è€ƒè™‘æ–‡æ¡£é¡ºåºä¸­çš„æç¤ºå¯ä»¥é˜²æ­¢ DB-BERT é¦–å…ˆè°ƒæ•´æœ€ç›¸å…³çš„å‚æ•°ã€‚ ä¸¢å¼ƒéšå¼æç¤ºä¼šå‡å°‘å¯ç”¨æç¤ºçš„æ€»æ•°ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç ”ç©¶è¾“å…¥æ–‡æœ¬çš„å½±å“ã€‚ æˆ‘ä»¬ç”¨ä¸€ç¯‡åšå®¢æ–‡ç«  9 æ›¿æ¢äº†åŒ…å«æ•°ç™¾ä¸ªé€šç”¨è°ƒæ•´æç¤ºçš„ Pg100ã€‚ è¿™ç¯‡æ–‡ç« æè¿°äº†å¦‚ä½•ä¸“é—¨é’ˆå¯¹ TPC-H è°ƒæ•´ Postgresã€‚ å›¾ 5 æ¯”è¾ƒäº†æ‰€æœ‰ NLP å¢å¼ºè°ƒæ•´åŸºçº¿çš„ä¸åŒè¾“å…¥æ–‡æ¡£çš„æ€§èƒ½ã€‚ è™½ç„¶ Prior-Simple çš„æ€§èƒ½ä¸ä¼šéšç€è¾“å…¥æ–‡æœ¬çš„å˜åŒ–è€Œå˜åŒ–ï¼Œä½†å½“æˆ‘ä»¬åˆ‡æ¢åˆ°è¾ƒå°çš„æ–‡æ¡£æ—¶ï¼ŒPrior-Main çš„æ€§èƒ½ä¼šä¸‹é™ã€‚ Prior-å¤§å‹æ–‡æ¡£é›†åˆçš„ä¸»è¦å¥½å¤„æ˜¯å†—ä½™æç¤ºå¯ä»¥éƒ¨åˆ†å¼¥è¡¥ä¸ç²¾ç¡®çš„æå–ã€‚ å¯¹äºè¾ƒå°çš„è¾“å…¥æ–‡æ¡£ï¼Œå®ƒä¸ä¼šæå–ä»»ä½•æç¤ºã€‚ ç„¶è€Œï¼ŒDB-BERT å—ç›Šäºæ›´ä¸“ä¸šçš„è°ƒæ•´æç¤ºã€‚ ä½¿ç”¨ç‰¹å®šäºåŸºå‡†çš„è¾“å…¥æ–‡æœ¬ï¼Œå®ƒå¯ä»¥æ›´å¿«åœ°æ”¶æ•›åˆ°æ¥è¿‘æœ€ä½³çš„è§£å†³æ–¹æ¡ˆï¼Œå¹¶æœ€ç»ˆæ‰¾åˆ°ç¨å¾®æ›´å¥½çš„è§£å†³æ–¹æ¡ˆï¼ˆä¸è¡¨ 5 ç›¸æ¯”ï¼Œä½¿ç”¨æ›´é«˜çš„å…±äº«ç¼“å†²åŒºå‚æ•°å€¼ï¼Œå¦‚åšå®¢æ¡ç›®ä¸­æ‰€å»ºè®®çš„ï¼‰ã€‚ æœ€åï¼Œæˆ‘ä»¬æ‰©å¤§æ•°æ®å¤§å°ã€‚ å›¾ 11 æŠ¥å‘Šäº†æ¯”ä¾‹å› å­ä¸º 10 çš„ TPC-H çš„ç»“æœï¼ˆå¹¶ä½¿ç”¨ TPC-H ç‰¹å®šè°ƒæ•´æ–‡æœ¬ï¼‰10ã€‚ ä¸æ˜¾ç¤ºç¼©æ”¾å› å­ 1 çš„ç»“æœçš„å›¾ 10 ç›¸æ¯”ï¼ŒDB-BERT éœ€è¦æ›´é•¿çš„æ—¶é—´æ‰èƒ½æ‰¾åˆ°æ¥è¿‘æœ€ä¼˜çš„è§£å†³æ–¹æ¡ˆã€‚ è¿™æ˜¯é¢„æœŸçš„ï¼Œå› ä¸ºæ¯ä¸ªåŸºå‡†è¯„ä¼°çš„è¿è¡Œæ—¶é—´è¾ƒé•¿ä¼šå‡å°‘æ¯ä¸ªæ—¶é—´å•ä½çš„ DB-BERT è¿­ä»£æ¬¡æ•°ã€‚ ä¸å…¶ä»–åŸºçº¿ç›¸æ¯”ï¼ŒDB-BERT å†æ¬¡æ‰¾åˆ°äº†æ˜æ˜¾æ›´å¥½çš„è§£å†³æ–¹æ¡ˆã€‚ ","date":"2024-02-04","objectID":"/posts/llm-capability/:10:5","tags":["Paper Reading"],"title":"Paper Reading: DB-BERT: a Database Tuning Tool that â€œReads the Manualâ€","uri":"/posts/llm-capability/"},{"categories":null,"content":"Conclusion and Outlook æœ¬æ–‡æå‡ºäº† DB-BERTï¼Œè¿™æ˜¯ä¸€ä¸ªæ•°æ®åº“è°ƒä¼˜ç³»ç»Ÿï¼Œå¯ä»¥ä»æ–‡æœ¬æ–‡æ¡£ä¸­æå–è°ƒä¼˜æç¤ºã€‚ æˆ‘ä»¬çš„å®éªŒè¡¨æ˜ï¼Œæ­¤ç±»æç¤ºå¯ä»¥å¸¦æ¥æ˜æ˜¾æ›´å¥½çš„è°ƒæ•´ç»“æœã€‚ åœ¨æœªæ¥çš„å·¥ä½œä¸­ï¼Œæˆ‘ä»¬å°†è€ƒè™‘æ›´åŠ å¤šæ ·åŒ–çš„è°ƒä¼˜ç›®æ ‡ã€‚ ç›®å‰ï¼ŒDB-BERT ä»…é™äºä¼˜åŒ–å¯è½»æ¾æµ‹é‡çš„æŒ‡æ ‡ï¼Œä¾‹å¦‚å»¶è¿Ÿæˆ–ååé‡ã€‚ ç„¶è€Œï¼Œè¿˜æœ‰å…¶ä»–ä¸€äº›éš¾ä»¥è¡¡é‡çš„é‡è¦æŒ‡æ ‡ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœæ„¿æ„æ¥å—æ•°æ®ä¸¢å¤±çš„å°é£é™©ï¼Œè®¸å¤šå‚æ•°ï¼ˆä¾‹å¦‚ Postgres ä¸­çš„ fsync å‚æ•°ï¼‰å¯ä»¥æé«˜æ€§èƒ½ã€‚ æ•°æ®åº“æ‰‹å†Œé€šå¸¸åŒ…å«è¯¦ç»†è¯´æ˜æ­¤ç±»é£é™©çš„è­¦å‘Šã€‚ æˆ‘ä»¬è®¡åˆ’æ‰©å±• DB-BERTï¼Œä»¥æå–éš¾ä»¥ä»æ‰‹å†Œä¸­æµ‹é‡çš„æŒ‡æ ‡ä¿¡æ¯ã€‚ å› æ­¤ï¼Œå®ƒå¯ä»¥æ”¯æŒç”¨æˆ·æ‰¾åˆ°æœ€å¤§åŒ–æ€§èƒ½çš„å‚æ•°è®¾ç½®ï¼ŒåŒæ—¶éµå®ˆå…¶ä»–æŒ‡æ ‡çš„çº¦æŸã€‚ ","date":"2024-02-04","objectID":"/posts/llm-capability/:11:0","tags":["Paper Reading"],"title":"Paper Reading: DB-BERT: a Database Tuning Tool that â€œReads the Manualâ€","uri":"/posts/llm-capability/"},{"categories":null,"content":"NodeJS è¿™å­¦æœŸè¦ç”¨ JS å†™åˆ†å¸ƒå¼ï¼Œçœ‹ Ryan Dahl åœ¨ 2009 å¹´ JSConf ä¸Šåˆ†äº« NodeJS èƒŒåçš„æ¦‚å¿µï¼Œåˆšå¥½å¤ä¹ ä¸€ä¸‹ JS çš„ä¸€äº›çŸ¥è¯† NodeJS ç®€è¿°ï¼š Server Side Javascript Built on Googleâ€™s V8 Evented, non-blocking IO, similar to EventMachine or Pythonâ€™s Twisted. CommonJS module system (ç”¨ ES6 Module æ›¿ä»£ CommonJS) 8k lines of C/C++, 2k lines of JavaScript, 14 Contributes ","date":"2024-01-30","objectID":"/posts/node-js-io/:1:0","tags":["é˜…è¯»"],"title":"é˜…è¯»ï¼šRyan Dahl: NodeJS","uri":"/posts/node-js-io/"},{"categories":null,"content":"IO needs to be done differently äº‹ä»¶é©±åŠ¨ï¼Œå•çº¿ç¨‹å¼‚æ­¥ IO æ˜¯å¦èƒ½ç†è§£ä¸ºéé˜»å¡çš„åç¨‹ï¼Ÿ è®¸å¤š Web åº”ç”¨ä½¿ç”¨ç±»ä¼¼ var result = db.query(\"select * from T); çš„è¯­å¥ï¼Œå½“æŸ¥è¯¢åœ¨è¿è¡Œæ—¶ï¼Œæ¡†æ¶åœ¨åšä»€ä¹ˆå‘¢ï¼Ÿå¤§éƒ¨åˆ†æ—¶é—´ä¸‹ï¼Œå®ƒåœ¨ä¸€ç›´ç­‰å¾…ã€‚ IO Latency åœ¨ç¡¬ç›˜ã€ç½‘ç»œçº§åˆ«æ˜¯è¾ƒé•¿çš„ å¥½çš„è½¯ä»¶æ˜¯å¯ä»¥å¤„ç†å¤šä»»åŠ¡çš„ï¼Œå½“å‰çº¿ç¨‹ç­‰å¾…æ—¶ï¼Œå…¶ä»–çš„çº¿ç¨‹å¯ä»¥æ‰§è¡Œå…¶ä»–ä»»åŠ¡ Apache å’Œ NGINX æ˜¯å¦‚ä½•å¤„ç† IO çš„ï¼Ÿ ä» Benchmark æ¥çœ‹ï¼Œéšç€å¤„ç†é‡å¢é•¿ï¼Œconcurrency NGINX æ˜¯ Apache çš„ä¸¤å€ï¼Œä½†å†…å­˜å ç”¨ä¸Šï¼ŒApache æ˜¾è‘—å¤§äº NGINXã€‚ Apache uses one thread per connection NGINX doesnot use threads, it uses an event loop å¯¹äºå¤§é‡çš„å¹¶å‘æ“ä½œï¼Œä¸èƒ½ç”¨ OS threads å¤„ç†æ¯ä¸ªè¿æ¥ï¼šä¸Šä¸‹æ–‡åˆ‡æ¢æ˜¯æ˜‚è´µçš„ï¼Œè°ƒç”¨æ ˆä¹Ÿéå¸¸å ç”¨ç©ºé—´ã€‚è€Œæ˜¯ç”¨å•çº¿ç¨‹å’Œäº‹ä»¶å¾ªç¯ã€‚ green threads / coroutines can improve ä½†è¿˜æ˜¯å¯èƒ½æ˜¯é˜»å¡çš„ threaded concurrency is a leaky abstraction ä½¿ç”¨äº‹ä»¶å¾ªç¯ï¼Œï¼Œä¸éœ€è¦ machineryï¼Œquery ç»“æŸä¹‹åæ‰§è¡Œç›¸åº”çš„å‡½æ•°ï¼š db.query('select * from T', () =\u003e {}); ","date":"2024-01-30","objectID":"/posts/node-js-io/:2:0","tags":["é˜…è¯»"],"title":"é˜…è¯»ï¼šRyan Dahl: NodeJS","uri":"/posts/node-js-io/"},{"categories":null,"content":"Cultural Bias everybody is talking about threads å­¦ IO çš„æ—¶å€™å¤§éƒ¨åˆ†äººéƒ½æ˜¯å…ˆæ¥è§¦é˜»å¡çš„ puts() å’Œ gets() ","date":"2024-01-30","objectID":"/posts/node-js-io/:2:1","tags":["é˜…è¯»"],"title":"é˜…è¯»ï¼šRyan Dahl: NodeJS","uri":"/posts/node-js-io/"},{"categories":null,"content":"Missing Infrastructure Why isnâ€™t everyone using event loops? Single threaded event loops require I/O to be non-blocking POSIX async closures and aynonymous functions async queries â€¦ ","date":"2024-01-30","objectID":"/posts/node-js-io/:2:2","tags":["é˜…è¯»"],"title":"é˜…è¯»ï¼šRyan Dahl: NodeJS","uri":"/posts/node-js-io/"},{"categories":null,"content":"Too much Infrastructure EventMachine, Twisted, AnyEvent easy to create efficient servers (Ruby) ","date":"2024-01-30","objectID":"/posts/node-js-io/:2:3","tags":["é˜…è¯»"],"title":"é˜…è¯»ï¼šRyan Dahl: NodeJS","uri":"/posts/node-js-io/"},{"categories":null,"content":"Javascript äº‹ä»¶å¾ªç¯ï¼šå¾®ä»»åŠ¡ã€å®ä»»åŠ¡ https://javascript.info/event-loop https://developer.mozilla.org/en-US/docs/Web/JavaScript/Event_loop#queue Javascript designed specifically to be used with an event loop anonymous functions, closures only one callback at a time I/O through DOM event callbacks ","date":"2024-01-30","objectID":"/posts/node-js-io/:3:0","tags":["é˜…è¯»"],"title":"é˜…è¯»ï¼šRyan Dahl: NodeJS","uri":"/posts/node-js-io/"},{"categories":null,"content":"NodeJS provide a purely evented, non-blocking infrastructure to script highly concurrent programs ","date":"2024-01-30","objectID":"/posts/node-js-io/:4:0","tags":["é˜…è¯»"],"title":"é˜…è¯»ï¼šRyan Dahl: NodeJS","uri":"/posts/node-js-io/"},{"categories":null,"content":"Design Goals no functions should direct perform I/O, to receive info from disk/network/another process there must be a callback ","date":"2024-01-30","objectID":"/posts/node-js-io/:5:0","tags":["é˜…è¯»"],"title":"é˜…è¯»ï¼šRyan Dahl: NodeJS","uri":"/posts/node-js-io/"},{"categories":null,"content":"Low level è¿™éƒ¨åˆ†è®¨è®ºäº† Ryan Dahl æ˜¯æ€ä¹ˆè€ƒè™‘å’Œè®¾è®¡çš„ stream everything, never force the buffering of data donot remove functionality present at the POSIX layer (support half-closed TCP connections) have built-in support for the most important protocols: TCP, DNS, HTTP support many HTTP features: chunked requests and responses keep-alive hang requests API should be both familiar to client-side JS programmers and old school UNIX hackers platform independent ","date":"2024-01-30","objectID":"/posts/node-js-io/:5:1","tags":["é˜…è¯»"],"title":"é˜…è¯»ï¼šRyan Dahl: NodeJS","uri":"/posts/node-js-io/"},{"categories":null,"content":"Usage and Examples ä¸€äº›äº‹ä»¶å¾ªç¯çš„ä¾‹å­ï¼Œç”±äºéƒ½æ¯”è¾ƒä¹…è€Œä¸” PPT å®åœ¨çœ‹ä¸æ¸…ï¼Œè¿™é‡Œç”¨ MDN æœ€æ–°çš„ (() =\u003e { console.log(\"this is the start\"); setTimeout(() =\u003e { console.log(\"Callback 1: this is a msg from call back\"); }); // has a default time value of 0 console.log(\"this is just a message\"); setTimeout(() =\u003e { console.log(\"Callback 2: this is a msg from call back\"); }, 0); console.log(\"this is the end\"); })(); // \"this is the start\" // \"this is just a message\" // \"this is the end\" // \"Callback 1: this is a msg from call back\" // \"Callback 2: this is a msg from call back\" process object emits an event when it receives a signal. Like in the DOM, you need only add a listener to catch them. process.addListener('SIGINT', () =\u003e { puts('good bye'); process.exit(0); }); A TCP server emits a â€œconnectionâ€ event each time someone connects HTTP upload emits a â€œbodyâ€ event on each packet. All objects which emit events are instances of process.EventEmitter ","date":"2024-01-30","objectID":"/posts/node-js-io/:6:0","tags":["é˜…è¯»"],"title":"é˜…è¯»ï¼šRyan Dahl: NodeJS","uri":"/posts/node-js-io/"},{"categories":null,"content":"File I/O is non-blocking something typically hard to do è¿™éƒ¨åˆ†ä¸»è¦è¯»å–æ–‡ä»¶ï¼Œä»£ç å®åœ¨çœ‹ä¸æ¸… A promise is a kind of EventEmitter which emits either â€œsuccessâ€ or â€œerrorâ€ All file operations return a promise (API sugar) ","date":"2024-01-30","objectID":"/posts/node-js-io/:6:1","tags":["é˜…è¯»"],"title":"é˜…è¯»ï¼šRyan Dahl: NodeJS","uri":"/posts/node-js-io/"},{"categories":null,"content":"HTTP Server å±•ç¤ºäº† Simple HTTP server å’Œ Streaming HTTP serverï¼Œåè€…å¯ä»¥ hang request æ­¤å¤–è¿˜å¯ä»¥ä½¿ç”¨ sys.exec('ls -l /').addCallback() è¿™éƒ¨åˆ†æåˆ°çš„ buffer ä¸å¤ªç†è§£æ˜¯ä»€ä¹ˆæ„æ€ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯ç”¨äºå¤„ç† TCP æµã€æ–‡ä»¶ç³»ç»Ÿæ“ä½œã€ä¸Šä¸‹æ–‡ä¹‹ç±»çš„äºŒè¿›åˆ¶æµæ•°æ®çš„ Bufferã€‚ ","date":"2024-01-30","objectID":"/posts/node-js-io/:6:2","tags":["é˜…è¯»"],"title":"é˜…è¯»ï¼šRyan Dahl: NodeJS","uri":"/posts/node-js-io/"},{"categories":null,"content":"IRC demo Ryan å±•ç¤ºäº†ä¸€ä¸ª Internet Relay Chat èŠå¤©æœåŠ¡å™¨ https://gist.github.com/ry/a3d0bbbff196af633995 ","date":"2024-01-30","objectID":"/posts/node-js-io/:7:0","tags":["é˜…è¯»"],"title":"é˜…è¯»ï¼šRyan Dahl: NodeJS","uri":"/posts/node-js-io/"},{"categories":null,"content":"Internal Design V8 (Google) libuv / libev / libeio http-parser evocom udns Thread Pool underneath everything: Blocking (possibly blocking) system calls are executed in the thread pool Signal handlers and thread pool callbacks are marshaled back into to the main thread via a pipe STDIN_FILENO will refer to a file, cannot select() on files: read() will block Solution: start a pipe and pumping thread, pump data from blocking fd into pipe. Main thread can pool for data on the pipe. è¿™ä¸€æ®µæºç  https://github.com/nodejs/node/blob/d52f63d9b29446b26ec831acd8ec6da9147896e5/deps/coupling/coupling.c ä¸çŸ¥é“æ˜¯ä¸æ˜¯å·²ç»è¢«å¼ƒç”¨äº†ï¼Œæœ€æ—©çš„æºä»£ç å¾ˆå¤šéƒ½æ˜¯ C å†™çš„ ","date":"2024-01-30","objectID":"/posts/node-js-io/:8:0","tags":["é˜…è¯»"],"title":"é˜…è¯»ï¼šRyan Dahl: NodeJS","uri":"/posts/node-js-io/"},{"categories":null,"content":"ç»“è¯­ 09 å¹´çš„æ—¶å€™æå‡ºè¿™ç§å•çº¿ç¨‹éé˜»å¡çš„å¼‚æ­¥è®¾è®¡ï¼Œæ˜¯éå¸¸æƒŠè‰³çš„ã€‚å¸Œæœ›æœ‰æ—¶é—´å¯ä»¥çœ‹çœ‹ NodeJS çš„æºç ã€‚ 03/06/2024 è¡¥å……ï¼Œå½“æ—¶å¿½ç•¥äº† libuv çš„å¼•å…¥ï¼ŒåªçŸ¥é“ NodeJS æ˜¯äº‹ä»¶å¾ªç¯çš„ï¼Œä½†æ˜¯ä¸çŸ¥é“ä»–æ˜¯æ€ä¹ˆå®ç°çš„ã€‚ ","date":"2024-01-30","objectID":"/posts/node-js-io/:9:0","tags":["é˜…è¯»"],"title":"é˜…è¯»ï¼šRyan Dahl: NodeJS","uri":"/posts/node-js-io/"},{"categories":null,"content":"DDIA åºç«  http://ddia.vonng.com/#/ch1 æ•°æ®å¯†é›†å‹ çš„åº”ç”¨ï¼Œæ•°æ®æ˜¯å…¶ä¸»è¦æŒ‘æˆ˜ï¼ˆæ•°æ®é‡ï¼Œæ•°æ®å¤æ‚åº¦æˆ–æ•°æ®å˜åŒ–é€Ÿåº¦ï¼‰ã€‚ è®¡ç®—å¯†é›†å‹ï¼Œå¤„ç†å™¨é€Ÿåº¦æ˜¯å…¶ç“¶é¢ˆã€‚ æ–°å‹æ•°æ®åº“ç³»ç»Ÿï¼ˆNoSQLï¼‰ï¼Œæ¶ˆæ¯é˜Ÿåˆ—ï¼Œç¼“å­˜ï¼Œæœç´¢ç´¢å¼•ï¼Œæ‰¹å¤„ç†å’Œæµå¤„ç†æ¡†æ¶ ä»¥åŠç›¸å…³æŠ€æœ¯ä¹Ÿéå¸¸é‡è¦ã€‚ ","date":"2024-01-05","objectID":"/posts/ddia-1/:1:0","tags":["DDIA","ç¬”è®°"],"title":"é˜…è¯»ï¼šDDIA åºç« ä»¥åŠç¬¬ä¸€ç« ","uri":"/posts/ddia-1/"},{"categories":null,"content":"å¤§çº² ç¬¬ä¸€éƒ¨åˆ†ï¼šè®¨è®ºè®¾è®¡æ•°æ®å¯†é›†å‹åº”ç”¨æ‰€èµ–çš„åŸºæœ¬æ€æƒ³ã€‚ç›®æ ‡ï¼šå¯é æ€§ã€å¯ä¼¸ç¼©æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚æ–¹æ³•ï¼šå‡ ç§ä¸åŒçš„æ•°æ®æ¨¡å‹å’ŒæŸ¥è¯¢è¯­è¨€ã€‚å­˜å‚¨å¼•æ“ï¼šæ•°æ®åº“å¦‚ä½•åœ¨ç£ç›˜ä¸Šæ‘†æ”¾æ•°æ®ï¼Œå¦‚ä½•é«˜æ•ˆæŸ¥æ‰¾ã€‚æ•°æ®ç¼–ç ï¼ˆåºåˆ—åŒ–ï¼‰ï¼Œä»¥åŠéšæ—¶é—´æ¼”åŒ–çš„æ¨¡å¼ ç¬¬äºŒéƒ¨åˆ†ï¼šå­˜å‚¨åœ¨ä¸€å°æœºå™¨ä¸Šçš„æ•°æ®è½¬å‘è®¨è®ºåˆ†å¸ƒåœ¨å¤šå°æœºå™¨ä¸Šçš„æ•°æ®ã€‚å¤åˆ¶ï¼ˆç¬¬äº”ç« ï¼‰ã€åˆ†åŒº / åˆ†ç‰‡ï¼ˆç¬¬å…­ç« ï¼‰å’Œäº‹åŠ¡ï¼ˆç¬¬ä¸ƒç« ï¼‰ã€åˆ†å¸ƒå¼ç³»ç»Ÿé—®é¢˜çš„æ›´å¤šç»†èŠ‚ï¼ˆç¬¬å…«ç« ï¼‰ã€åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å®ç°ä¸€è‡´æ€§ä¸å…±è¯†æ„å‘³ç€ä»€ä¹ˆï¼ˆç¬¬ä¹ç« ï¼‰ã€‚ ç¬¬ä¸‰éƒ¨åˆ†ï¼šä»å…¶ä»–æ•°æ®é›†è¡ç”Ÿå‡ºä¸€äº›æ•°æ®é›†çš„ç³»ç»Ÿã€‚ç¬¬åç«  æ‰¹å¤„ç†æ–¹æ³•ï¼Œç¬¬åä¸€ç«  æµå¤„ç†ï¼Œç¬¬åäºŒç«  ä¸­ï¼Œè®¨è®ºåœ¨å°†æ¥æ„å»ºå¯é ã€å¯ä¼¸ç¼©å’Œå¯ç»´æŠ¤çš„åº”ç”¨ç¨‹åºçš„æ–¹æ³•ã€‚ ","date":"2024-01-05","objectID":"/posts/ddia-1/:2:0","tags":["DDIA","ç¬”è®°"],"title":"é˜…è¯»ï¼šDDIA åºç« ä»¥åŠç¬¬ä¸€ç« ","uri":"/posts/ddia-1/"},{"categories":null,"content":"ç¬¬ä¸€éƒ¨åˆ†ï¼šæ•°æ®ç³»ç»ŸåŸºç¡€ æ•°æ®ç³»ç»Ÿåº•å±‚çš„åŸºç¡€æ¦‚å¿µï¼šå•æœºå’Œå¤šæœºåˆ†å¸ƒå¼ ","date":"2024-01-05","objectID":"/posts/ddia-1/:3:0","tags":["DDIA","ç¬”è®°"],"title":"é˜…è¯»ï¼šDDIA åºç« ä»¥åŠç¬¬ä¸€ç« ","uri":"/posts/ddia-1/"},{"categories":null,"content":"ç¬¬ä¸€ç« ï¼šå¯é æ€§ã€å¯ä¼¸ç¼©æ€§å’Œå¯ç»´æŠ¤æ€§ ç°ä»Šå¾ˆå¤šåº”ç”¨ç¨‹åºéƒ½æ˜¯ æ•°æ®å¯†é›†å‹çš„ï¼Œè€Œéè®¡ç®—å¯†é›†å‹çš„ã€‚è®¸å¤šç¨‹åºéƒ½éœ€è¦ï¼š å­˜å‚¨æ•°æ®ï¼šæ•°æ®åº“ åŠ å¿«è¯»å–é€Ÿåº¦ï¼šç¼“å­˜ æœç´¢ã€è¿‡æ»¤ï¼šæœç´¢ç´¢å¼• å‘é€æ¶ˆæ¯ã€å¼‚æ­¥å¤„ç†ï¼šæµå¤„ç† å®šæœŸå¤„ç†å¤§æ‰¹é‡æ•°æ®ï¼šæ‰¹å¤„ç† æ•°æ®ç³»ç»Ÿ Data System æ•°æ®åº“ã€æ¶ˆæ¯é˜Ÿåˆ—ã€ç¼“å­˜ç­‰å·¥å…·åˆ†å±äºå‡ ä¸ªå·®å¼‚æ˜¾è‘—çš„ç±»åˆ«ï¼Œä½†ç±»åˆ«ä¹‹é—´çš„ç•Œé™å˜å¾—è¶Šæ¥è¶Šæ¨¡ç³Šï¼Œä¾‹å¦‚ï¼šæ•°æ®å­˜å‚¨å¯ä»¥è¢«å½“æˆæ¶ˆæ¯é˜Ÿåˆ—ç”¨ï¼ˆRedisï¼‰ï¼Œæ¶ˆæ¯é˜Ÿåˆ—åˆ™å¸¦æœ‰ç±»ä¼¼æ•°æ®åº“çš„æŒä¹…ä¿è¯ï¼ˆApache Kafkaï¼‰ æ•°æ®åº“è¯¾ä¸Šå¬åˆ°è¿‡ä¸€ä¸ªè¯´æ³•ï¼šNoSQL å’Œå…³ç³»å‹æ•°æ®åº“å¹¶ä¸å¯¹ç«‹ï¼Œå®ƒä»¬é€æ¸æ‹¥æœ‰å¯¹æ–¹çš„åŠŸèƒ½ã€‚ è¶Šæ¥è¶Šå¤šçš„åº”ç”¨ç¨‹åºæœ‰ç€å„ç§ä¸¥æ ¼è€Œå¹¿æ³›çš„è¦æ±‚ï¼Œå•ä¸ªå·¥å…·ä¸è¶³ä»¥æ»¡è¶³æ‰€æœ‰çš„æ•°æ®å¤„ç†å’Œå­˜å‚¨éœ€æ±‚ã€‚å–è€Œä»£ä¹‹çš„æ˜¯ï¼Œæ€»ä½“å·¥ä½œè¢«æ‹†åˆ†æˆä¸€ç³»åˆ—èƒ½è¢«å•ä¸ªå·¥å…·é«˜æ•ˆå®Œæˆçš„ä»»åŠ¡ï¼Œå¹¶é€šè¿‡åº”ç”¨ä»£ç å°†å®ƒä»¬ç¼åˆèµ·æ¥ã€‚ å¦‚æœä¸€ä¸ªå·¥å…·èƒ½å®ç°å¤šç§åŠŸèƒ½ï¼Œå®ƒä¼šæœ‰å¸‚åœºå—ï¼Ÿæ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´ç°åœ¨çš„æ¶æ„è®¾è®¡éœ€è¦ç”¨å¤šç§æ¡†æ¶å’Œç»„ä»¶ï¼Ÿæ˜¯ä½è€¦åˆçš„åŸåˆ™è¿˜æ˜¯è´¨é‡å’Œæ•ˆç‡é™åˆ¶ï¼Ÿè¿˜æ˜¯æ–‡ä¸­æåˆ°çš„å¯é æ€§ã€å¯ä¼¸ç¼©æ€§ã€å¯ç»´æŠ¤æ€§ï¼Ÿ å½“ç³»ç»Ÿå‡ºé—®é¢˜æ—¶ï¼Œå¦‚ä½•ç¡®ä¿æ•°æ®çš„æ­£ç¡®æ€§å’Œå®Œæ•´æ€§ï¼Ÿå½“éƒ¨åˆ†ç³»ç»Ÿé€€åŒ–é™çº§æ—¶ï¼Œå¦‚ä½•ä¸ºå®¢æˆ·æä¾›å§‹ç»ˆå¦‚ä¸€çš„è‰¯å¥½æ€§èƒ½ï¼Ÿå½“è´Ÿè½½å¢åŠ æ—¶ï¼Œå¦‚ä½•æ‰©å®¹åº”å¯¹ï¼Ÿä»€ä¹ˆæ ·çš„ API æ‰æ˜¯å¥½çš„ APIï¼Ÿ å¯é æ€§ï¼ˆReliabilityï¼‰ï¼šç³»ç»Ÿåœ¨å›°å¢ƒä¸­ä»å¯æ­£å¸¸å·¥ä½œ å¯ä¼¸ç¼©æ€§ï¼ˆScalabilityï¼‰ï¼šæœ‰åˆç†çš„åŠæ³•åº”å¯¹ç³»ç»Ÿçš„å¢é•¿ å¯ç»´æŠ¤æ€§ï¼ˆMaintainabilityï¼‰ï¼šè®¸å¤šä¸åŒçš„äººï¼ˆå·¥ç¨‹å¸ˆã€è¿ç»´ï¼‰åœ¨ä¸åŒçš„ç”Ÿå‘½å‘¨æœŸï¼Œéƒ½èƒ½é«˜æ•ˆåœ°åœ¨ç³»ç»Ÿä¸Šå·¥ä½œ ","date":"2024-01-05","objectID":"/posts/ddia-1/:3:1","tags":["DDIA","ç¬”è®°"],"title":"é˜…è¯»ï¼šDDIA åºç« ä»¥åŠç¬¬ä¸€ç« ","uri":"/posts/ddia-1/"},{"categories":null,"content":"å¯é æ€§ å³ä½¿å‡ºç°é—®é¢˜ï¼Œä¹Ÿèƒ½ç»§ç»­æ­£ç¡®å·¥ä½œã€‚é€ æˆé”™è¯¯çš„åŸå› å«åš æ•…éšœï¼ˆfaultï¼‰ï¼Œèƒ½é¢„æ–™å¹¶åº”å¯¹æ•…éšœçš„ç³»ç»Ÿç‰¹æ€§å¯ç§°ä¸º å®¹é”™ï¼ˆfault-tolerantï¼‰ æˆ– éŸ§æ€§ï¼ˆresilientï¼‰ åç›´è§‰çš„æ˜¯ï¼Œåœ¨è¿™ç±»å®¹é”™ç³»ç»Ÿä¸­ï¼Œé€šè¿‡æ•…æ„è§¦å‘æ¥æé«˜æ•…éšœç‡æ˜¯æœ‰æ„ä¹‰çš„ã€‚å°½ç®¡æ¯”èµ· é˜»æ­¢é”™è¯¯ï¼ˆprevent errorï¼‰ï¼Œæˆ‘ä»¬é€šå¸¸æ›´å€¾å‘äº å®¹å¿é”™è¯¯ã€‚ ç¡¬ä»¶æ•…éšœ ç¡¬ç›˜çš„ å¹³å‡æ— æ•…éšœæ—¶é—´ï¼ˆMTTF, mean time to failureï¼‰ï¼šä»æ•°å­¦æœŸæœ›ä¸Šè®²ï¼Œåœ¨æ‹¥æœ‰ 10000 ä¸ªç£ç›˜çš„å­˜å‚¨é›†ç¾¤ä¸Šï¼Œå¹³å‡æ¯å¤©ä¼šæœ‰ 1 ä¸ªç£ç›˜å‡ºæ•…éšœã€‚ ä¸ºäº†å‡å°‘ç³»ç»Ÿçš„æ•…éšœç‡ï¼Œç¬¬ä¸€ååº”é€šå¸¸éƒ½æ˜¯å¢åŠ å•ä¸ªç¡¬ä»¶çš„å†—ä½™åº¦ï¼Œä¾‹å¦‚ï¼šç£ç›˜å¯ä»¥ç»„å»º RAIDï¼ŒæœåŠ¡å™¨å¯èƒ½æœ‰åŒè·¯ç”µæºå’Œçƒ­æ’æ‹” CPUï¼Œæ•°æ®ä¸­å¿ƒå¯èƒ½æœ‰ç”µæ± å’ŒæŸ´æ²¹å‘ç”µæœºä½œä¸ºåå¤‡ç”µæºï¼ŒæŸä¸ªç»„ä»¶æŒ‚æ‰æ—¶å†—ä½™ç»„ä»¶å¯ä»¥ç«‹åˆ»æ¥ç®¡ã€‚ä½†å¤§é‡ä½¿ç”¨æœºå™¨ï¼Œä¼šç›¸åº”åœ°å¢åŠ ç¡¬ä»¶æ•…éšœç‡ã€‚ äº‘å¹³å°çš„è®¾è®¡å°±æ˜¯ä¼˜å…ˆè€ƒè™‘ çµæ´»æ€§ï¼ˆflexibilityï¼‰ å’Œ å¼¹æ€§ï¼ˆelasticityï¼‰ï¼Œè€Œä¸æ˜¯å•æœºå¯é æ€§ã€‚ è½¯ä»¶é”™è¯¯ é€šå¸¸è®¤ä¸ºç¡¬ä»¶æ•…éšœæ˜¯éšæœºçš„ã€ç›¸äº’ç‹¬ç«‹çš„ å¦ä¸€ç±»é”™è¯¯æ˜¯å†…éƒ¨çš„ ç³»ç»Ÿæ€§é”™è¯¯ï¼Œå› ä¸ºæ˜¯è·¨èŠ‚ç‚¹ç›¸å…³çš„ï¼Œæ‰€ä»¥æ¯”èµ·ä¸ç›¸å…³çš„ç¡¬ä»¶æ•…éšœå¾€å¾€å¯èƒ½é€ æˆæ›´å¤šçš„ ç³»ç»Ÿå¤±æ•ˆ é”™è¯¯è¾“å…¥ å¤±æ§è¿›ç¨‹ç”¨å°½ä¸€äº›å…±äº«èµ„æºï¼ŒåŒ…æ‹¬ CPU æ—¶é—´ã€å†…å­˜ã€ç£ç›˜ç©ºé—´æˆ–ç½‘ç»œå¸¦å®½ã€‚ ç³»ç»Ÿä¾èµ–çš„æœåŠ¡å˜æ…¢ï¼Œæ²¡æœ‰å“åº”ï¼Œé”™è¯¯å“åº” çº§è”æ•…éšœ åŠæ³•ï¼šä»”ç»†è€ƒè™‘ç³»ç»Ÿä¸­çš„å‡è®¾å’Œäº¤äº’ï¼›å½»åº•çš„æµ‹è¯•ï¼›è¿›ç¨‹éš”ç¦»ï¼›å…è®¸è¿›ç¨‹å´©æºƒå¹¶é‡å¯ï¼›æµ‹é‡ã€ç›‘æ§å¹¶åˆ†æç”Ÿäº§ç¯å¢ƒä¸­çš„ç³»ç»Ÿè¡Œä¸ºã€‚å¦‚æœç³»ç»Ÿèƒ½å¤Ÿæä¾›ä¸€äº›ä¿è¯ï¼ˆä¾‹å¦‚åœ¨ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œè¿›å…¥ä¸å‘å‡ºçš„æ¶ˆæ¯æ•°é‡ç›¸ç­‰ï¼‰ï¼Œé‚£ä¹ˆç³»ç»Ÿå°±å¯ä»¥åœ¨è¿è¡Œæ—¶ä¸æ–­è‡ªæ£€ï¼Œå¹¶åœ¨å‡ºç° å·®å¼‚ï¼ˆdiscrepancyï¼‰ æ—¶æŠ¥è­¦ æµ‹è¯•æ˜¯ç›¸å½“é‡è¦çš„ä¸€ç¯ äººä¸ºé”™è¯¯ äººç±»æ˜¯ä¸å¯é çš„ ä»¥æœ€å°åŒ–çŠ¯é”™æœºä¼šçš„æ–¹å¼è®¾è®¡ç³»ç»Ÿï¼šç²¾å¿ƒè®¾è®¡çš„æŠ½è±¡ã€API å’Œç®¡ç†åå° è§£è€¦ï¼ˆdecoupleï¼‰ï¼Œæä¾›ä¸€ä¸ªåŠŸèƒ½é½å…¨çš„éç”Ÿäº§ç¯å¢ƒ æ²™ç®±ï¼ˆsandboxï¼‰ å„ä¸ªå±‚æ¬¡è¿›è¡Œå½»åº•çš„æµ‹è¯•ï¼šå•å…ƒæµ‹è¯•ã€å…¨ç³»ç»Ÿé›†æˆæµ‹è¯•åˆ°æ‰‹åŠ¨æµ‹è¯•ï¼Œè¦†ç›–æ­£å¸¸æƒ…å†µä¸­å°‘è§çš„ è¾¹ç¼˜åœºæ™¯ corner case å¿«é€Ÿåœ°æ¢å¤ï¼šå¿«é€Ÿå›æ»šé…ç½®å˜æ›´ï¼Œåˆ†æ‰¹å‘å¸ƒæ–°ä»£ç ï¼Œå¹¶æä¾›æ•°æ®é‡ç®—å·¥å…· é…ç½®è¯¦ç»†å’Œæ˜ç¡®çš„ç›‘æ§ï¼Œæ¯”å¦‚æ€§èƒ½æŒ‡æ ‡å’Œé”™è¯¯ç‡ è‰¯å¥½çš„ç®¡ç†å®è·µä¸å……åˆ†çš„åŸ¹è®­ äººç±»æ˜¯ä¸å¯é çš„ å¯é æ€§æœ‰å¤šé‡è¦ï¼Ÿ æ ¸ç”µç«™å’Œç©ºä¸­äº¤é€šç®¡åˆ¶è½¯ä»¶ï¼Œå•†åŠ¡åº”ç”¨ï¼Œç”µå•†ç½‘ç«™ åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šé€‰æ‹©ç‰ºç‰²å¯é æ€§æ¥é™ä½å¼€å‘æˆæœ¬ï¼Œä½†æˆ‘ä»¬å·å·¥å‡æ–™æ—¶ï¼Œåº”è¯¥æ¸…æ¥šæ„è¯†åˆ°è‡ªå·±åœ¨åšä»€ä¹ˆã€‚ å¯é æ€§å’Œæ­£ç¡®æ€§æ˜¯å¦ç›¸å…³ï¼Ÿ ","date":"2024-01-05","objectID":"/posts/ddia-1/:3:2","tags":["DDIA","ç¬”è®°"],"title":"é˜…è¯»ï¼šDDIA åºç« ä»¥åŠç¬¬ä¸€ç« ","uri":"/posts/ddia-1/"},{"categories":null,"content":"å¯ä¼¸ç¼©æ€§ ç³»ç»Ÿä»Šå¤©èƒ½å¯é è¿è¡Œï¼Œå¹¶ä¸æ„å‘³æœªæ¥ä¹Ÿèƒ½å¯é è¿è¡Œã€‚ æœåŠ¡ é™çº§ï¼ˆdegradationï¼‰ çš„ä¸€ä¸ªå¸¸è§åŸå› æ˜¯è´Ÿè½½å¢åŠ ï¼Œä¾‹å¦‚ï¼šç³»ç»Ÿè´Ÿè½½å·²ç»ä»ä¸€ä¸‡ä¸ªå¹¶å‘ç”¨æˆ·å¢é•¿åˆ°åä¸‡ä¸ªå¹¶å‘ç”¨æˆ·ã€‚ å¯ä¼¸ç¼©æ€§ï¼ˆScalabilityï¼‰ æ˜¯ç”¨æ¥æè¿°ç³»ç»Ÿåº”å¯¹è´Ÿè½½å¢é•¿èƒ½åŠ›çš„æœ¯è¯­ã€‚è®¨è®ºå¯ä¼¸ç¼©æ€§æ„å‘³ç€è€ƒè™‘è¯¸å¦‚ â€œå¦‚æœç³»ç»Ÿä»¥ç‰¹å®šæ–¹å¼å¢é•¿ï¼Œæœ‰ä»€ä¹ˆé€‰é¡¹å¯ä»¥åº”å¯¹å¢é•¿ï¼Ÿâ€ å’Œ â€œå¦‚ä½•å¢åŠ è®¡ç®—èµ„æºæ¥å¤„ç†é¢å¤–çš„è´Ÿè½½ï¼Ÿâ€ ç­‰é—®é¢˜ã€‚ é‡åˆ°è¿‡ä¸€ä¸ªå•æœº AWS DocDB æŸ¥è¯¢æ…¢çš„é—®é¢˜ï¼Œé€šè¿‡å¢åŠ å¤šä¸ªå®ä¾‹èƒ½è§£å†³ã€‚ä½†è¿˜æ˜¯éœ€è¦æ·»åŠ ç´¢å¼•æˆ–æ˜¯åˆ†ç‰‡ã€‚ æè¿°è´Ÿè½½ åœ¨è®¨è®ºå¢é•¿é—®é¢˜ï¼ˆå¦‚æœè´Ÿè½½åŠ å€ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿï¼‰å‰ï¼Œé¦–å…ˆè¦èƒ½ç®€è¦æè¿°ç³»ç»Ÿçš„å½“å‰è´Ÿè½½ï¼šè´Ÿè½½å‚æ•° load parametersï¼Œå‚æ•°çš„æœ€ä½³é€‰æ‹©å–å†³äºç³»ç»Ÿæ¶æ„ï¼Œå®ƒå¯èƒ½æ˜¯æ¯ç§’å‘ Web æœåŠ¡å™¨å‘å‡ºçš„è¯·æ±‚ QPSã€æ•°æ®åº“ä¸­çš„è¯»å†™æ¯”ç‡ã€èŠå¤©å®¤ä¸­åŒæ—¶æ´»è·ƒçš„ç”¨æˆ·æ•°é‡ã€ç¼“å­˜å‘½ä¸­ç‡æˆ–å…¶ä»–ä¸œè¥¿ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä¹Ÿè®¸å¹³å‡æƒ…å†µå¯¹ä½ å¾ˆé‡è¦ï¼Œä¹Ÿè®¸ä½ çš„ç“¶é¢ˆæ˜¯å°‘æ•°æç«¯åœºæ™¯ã€‚ æ¨ç‰¹çš„ä¸¤ä¸ªä¸»è¦ä¸šåŠ¡æ˜¯ï¼šå‘å¸ƒæ¨æ–‡ï¼ˆå¹³å‡ 4.6k è¯·æ±‚ / ç§’ï¼Œå³°å€¼è¶…è¿‡ 12k è¯·æ±‚ / ç§’ï¼‰ã€ä¸»é¡µæ—¶é—´çº¿ï¼ˆç”¨æˆ·å¯ä»¥æŸ¥é˜…ä»–ä»¬å…³æ³¨çš„äººå‘å¸ƒçš„æ¨æ–‡ï¼ˆ300k è¯·æ±‚ / ç§’ï¼‰ï¼‰ ç„¶è€Œæ¨ç‰¹çš„ä¼¸ç¼©æ€§æŒ‘æˆ˜å¹¶ä¸æ˜¯ä¸»è¦æ¥è‡ªæ¨ç‰¹é‡ï¼Œè€Œæ˜¯æ¥è‡ª æ‰‡å‡ºï¼ˆfan-outï¼‰â€”â€” æ¯ä¸ªç”¨æˆ·å…³æ³¨äº†å¾ˆå¤šäººï¼Œä¹Ÿè¢«å¾ˆå¤šäººå…³æ³¨ã€‚æœ‰ä¸¤ç§å®ç°æ–¹æ³•ï¼š æ‰‡å‡ºï¼šåœ¨äº‹åŠ¡å¤„ç†ç³»ç»Ÿä¸­ï¼Œä½¿ç”¨å®ƒæ¥æè¿°ä¸ºäº†æœåŠ¡ä¸€ä¸ªä¼ å…¥è¯·æ±‚è€Œéœ€è¦æ‰§è¡Œå…¶ä»–æœåŠ¡çš„è¯·æ±‚æ•°é‡ã€‚ å‘å¸ƒæ¨æ–‡ï¼šå°†æ–°æ¨æ–‡æ’å…¥å…¨å±€æ¨æ–‡é›†åˆï¼Œå½“ä¸€ä¸ªç”¨æˆ·è¯·æ±‚è‡ªå·±çš„ä¸»é¡µæ—¶é—´çº¿æ—¶ï¼Œé¦–å…ˆæŸ¥æ‰¾ä»–å…³æ³¨çš„æ‰€æœ‰äººï¼ŒæŸ¥è¯¢è¿™äº›è¢«å…³æ³¨ç”¨æˆ·å‘å¸ƒçš„æ¨æ–‡å¹¶æŒ‰æ—¶é—´é¡ºåºåˆå¹¶ã€‚åœ¨å¦‚ å›¾ 1-2 æ‰€ç¤ºçš„å…³ç³»å‹æ•°æ®åº“ä¸­ï¼Œå¯ä»¥ç¼–å†™è¿™æ ·çš„æŸ¥è¯¢ï¼š SELECT tweets.*, users.* FROM tweets JOIN users ON tweets.sender_id = users.id JOIN follows ON follows.followee_id = users.id WHERE follows.follower_id = current_user å¦‚ä½•è®¾è®¡è¿™ä¸ªè¡¨ï¼Ÿfollows è¡¨å­˜å…³æ³¨è€…å’Œç”¨æˆ· IDï¼›tweets è¡¨å­˜æ¨æ–‡ idï¼Œå‘é€è€… idï¼Œæ¨æ–‡ï¼Œæ—¶é—´æˆ³ï¼›users è¡¨å­˜ idï¼Œæ˜µç§°ï¼Œå¤´åƒã€‚ç¬¦åˆæœ€å°åŒ–å†—ä½™å’Œä¾èµ–ï¼Œnormalizationã€‚ ä¸ºæ¯ä¸ªç”¨æˆ·çš„ä¸»é¡µæ—¶é—´çº¿ç»´æŠ¤ä¸€ä¸ªç¼“å­˜ï¼Œå°±åƒæ¯ä¸ªç”¨æˆ·çš„æ¨æ–‡æ”¶ä»¶ç®±ã€‚ å½“ä¸€ä¸ªç”¨æˆ·å‘å¸ƒæ¨æ–‡æ—¶ï¼ŒæŸ¥æ‰¾æ‰€æœ‰å…³æ³¨è¯¥ç”¨æˆ·çš„äººï¼Œå¹¶å°†æ–°çš„æ¨æ–‡æ’å…¥åˆ°æ¯ä¸ªä¸»é¡µæ—¶é—´çº¿ç¼“å­˜ä¸­ã€‚ å› æ­¤è¯»å–ä¸»é¡µæ—¶é—´çº¿çš„è¯·æ±‚å¼€é”€å¾ˆå°ï¼Œå› ä¸ºç»“æœå·²ç»æå‰è®¡ç®—å¥½äº†ã€‚ æ–¹æ³•ä¸€æŸ¥è¯¢è´Ÿè½½è¾ƒé«˜ï¼Œè€Œæ–¹æ³•äºŒæ•ˆæœæ›´å¥½ï¼Œå› ä¸ºå‘æ¨é¢‘ç‡æ¯”æŸ¥è¯¢ä¸»é¡µæ—¶é—´çº¿çš„é¢‘ç‡å‡ ä¹ä½äº†ä¸¤ä¸ªæ•°é‡çº§ï¼Œæ‰€ä»¥åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæœ€å¥½åœ¨å†™å…¥æ—¶åšæ›´å¤šçš„å·¥ä½œï¼Œè€Œåœ¨è¯»å–æ—¶åšæ›´å°‘çš„å·¥ä½œã€‚ ä½†æ–¹æ³•äºŒçš„ç¼ºç‚¹æ˜¯ï¼Œåœ¨å‘æ¨æ—¶éœ€è¦åšå¤§é‡é¢å¤–å·¥ä½œã€‚å¹³å‡æ¥è¯´ï¼Œä¸€æ¡æ¨æ–‡ä¼šå‘å¾€çº¦ 75 ä¸ªå…³æ³¨è€…ï¼Œæ‰€ä»¥æ¯ç§’ 4.6k çš„å‘æ¨å†™å…¥ï¼Œå˜æˆäº†å¯¹ä¸»é¡µæ—¶é—´çº¿ç¼“å­˜æ¯ç§’ 345k çš„å†™å…¥ã€‚ä½†è¿™ä¸ªå¹³å‡å€¼éšè—äº†ç”¨æˆ·ç²‰ä¸æ•°å·®å¼‚å·¨å¤§è¿™ä¸€ç°å®ï¼Œä¸€äº›ç”¨æˆ·æœ‰è¶…è¿‡ 3000 ä¸‡çš„ç²‰ä¸ï¼Œè¿™æ„å‘³ç€ä¸€æ¡æ¨æ–‡å°±å¯èƒ½ä¼šå¯¼è‡´ä¸»é¡µæ—¶é—´çº¿ç¼“å­˜çš„ 3000 ä¸‡æ¬¡å†™å…¥ï¼åŠæ—¶å®Œæˆè¿™ç§æ“ä½œæ˜¯ä¸€ä¸ªå·¨å¤§çš„æŒ‘æˆ˜ â€”â€” æ¨ç‰¹å°è¯•åœ¨ 5 ç§’å†…å‘ç²‰ä¸å‘é€æ¨æ–‡ã€‚ æ¯ä¸ªç”¨æˆ·ç²‰ä¸æ•°çš„åˆ†å¸ƒï¼ˆå¯èƒ½æŒ‰è¿™äº›ç”¨æˆ·çš„å‘æ¨é¢‘ç‡æ¥åŠ æƒï¼‰æ˜¯æ¢è®¨å¯ä¼¸ç¼©æ€§çš„ä¸€ä¸ªå…³é”®è´Ÿè½½å‚æ•°ï¼Œå› ä¸ºå®ƒå†³å®šäº†æ‰‡å‡ºè´Ÿè½½ã€‚ æ¨ç‰¹é‡‡ç”¨æ··åˆæ–¹æ³•ï¼Œè¿™ç§æ··åˆæ–¹æ³•èƒ½å§‹ç»ˆå¦‚ä¸€åœ°æä¾›è‰¯å¥½æ€§èƒ½ã€‚ è¿™ä¸€ç« è®¨è®ºäº†è®¸å¤š system design éœ€è¦è€ƒè™‘çš„ä¸€äº›æŒ‡æ ‡ï¼Œæ¨ç‰¹çš„ä¾‹å­ä¹Ÿéå¸¸å¥½ æè¿°æ€§èƒ½ å½“è´Ÿè½½å¢åŠ ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ å¢åŠ è´Ÿè½½å‚æ•°å¹¶ä¿æŒç³»ç»Ÿèµ„æºï¼ˆCPUã€å†…å­˜ã€ç½‘ç»œå¸¦å®½ç­‰ï¼‰ä¸å˜æ—¶ï¼Œç³»ç»Ÿæ€§èƒ½å°†å—åˆ°ä»€ä¹ˆå½±å“ï¼Ÿ å¢åŠ è´Ÿè½½å‚æ•°å¹¶å¸Œæœ›ä¿æŒæ€§èƒ½ä¸å˜æ—¶ï¼Œéœ€è¦å¢åŠ å¤šå°‘ç³»ç»Ÿèµ„æºï¼Ÿ å¦‚ä½•æè¿°ç³»ç»Ÿæ€§èƒ½ï¼Ÿ å¯¹äº Hadoop è¿™æ ·çš„æ‰¹å¤„ç†ç³»ç»Ÿï¼Œé€šå¸¸å…³å¿ƒçš„æ˜¯ ååé‡ï¼ˆthroughputï¼‰ï¼Œå³æ¯ç§’å¯ä»¥å¤„ç†çš„è®°å½•æ•°é‡ï¼Œæˆ–è€…åœ¨ç‰¹å®šè§„æ¨¡æ•°æ®é›†ä¸Šè¿è¡Œä½œä¸šçš„æ€»æ—¶é—´ ã€‚å¯¹äºåœ¨çº¿ç³»ç»Ÿï¼Œé€šå¸¸æ›´é‡è¦çš„æ˜¯æœåŠ¡çš„ å“åº”æ—¶é—´ï¼ˆresponse timeï¼‰ï¼Œå³å®¢æˆ·ç«¯å‘é€è¯·æ±‚åˆ°æ¥æ”¶å“åº”ä¹‹é—´çš„æ—¶é—´ã€‚ ç†æƒ³æƒ…å†µä¸‹ï¼Œæ‰¹é‡ä½œä¸šçš„è¿è¡Œæ—¶é—´æ˜¯æ•°æ®é›†çš„å¤§å°é™¤ä»¥ååé‡ã€‚ åœ¨å®è·µä¸­ç”±äºæ•°æ®å€¾æ–œï¼ˆæ•°æ®ä¸æ˜¯å‡åŒ€åˆ†å¸ƒåœ¨æ¯ä¸ªå·¥ä½œè¿›ç¨‹ä¸­ï¼‰ï¼Œéœ€è¦ç­‰å¾…æœ€æ…¢çš„ä»»åŠ¡å®Œæˆï¼Œæ‰€ä»¥è¿è¡Œæ—¶é—´å¾€å¾€æ›´é•¿ã€‚ å»¶è¿Ÿå’Œå“åº”æ—¶é—´ å»¶è¿Ÿï¼ˆlatencyï¼‰ å’Œ å“åº”æ—¶é—´ï¼ˆresponse timeï¼‰ ç»å¸¸ç”¨ä½œåŒä¹‰è¯ï¼Œä½†å®é™…ä¸Šå®ƒä»¬å¹¶ä¸ä¸€æ ·ã€‚å“åº”æ—¶é—´æ˜¯å®¢æˆ·æ‰€çœ‹åˆ°çš„ï¼Œé™¤äº†å®é™…å¤„ç†è¯·æ±‚çš„æ—¶é—´ï¼ˆ æœåŠ¡æ—¶é—´ï¼ˆservice timeï¼‰ ï¼‰ä¹‹å¤–ï¼Œè¿˜åŒ…æ‹¬ç½‘ç»œå»¶è¿Ÿå’Œæ’é˜Ÿå»¶è¿Ÿã€‚å»¶è¿Ÿæ˜¯æŸä¸ªè¯·æ±‚ç­‰å¾…å¤„ç†çš„ æŒç»­æ—¶é•¿ï¼Œåœ¨æ­¤æœŸé—´å®ƒå¤„äº ä¼‘çœ ï¼ˆlatentï¼‰ çŠ¶æ€ï¼Œå¹¶ç­‰å¾…æœåŠ¡ã€‚ å³ä½¿ä¸æ–­é‡å¤å‘é€åŒæ ·çš„è¯·æ±‚ï¼Œæ¯æ¬¡å¾—åˆ°çš„å“åº”æ—¶é—´ä¹Ÿéƒ½ä¼šç•¥æœ‰ä¸åŒã€‚å°†å“åº”æ—¶é—´è§†ä¸ºä¸€ä¸ªå¯ä»¥æµ‹é‡çš„æ•°å€¼ åˆ†å¸ƒï¼ˆdistributionï¼‰ï¼Œè€Œä¸æ˜¯å•ä¸ªæ•°å€¼ã€‚ é€šå¸¸æŠ¥è¡¨éƒ½ä¼šå±•ç¤ºæœåŠ¡çš„å¹³å‡å“åº”æ—¶é—´ã€‚ç„¶è€Œå¦‚æœä½ æƒ³çŸ¥é“ â€œå…¸å‹ï¼ˆtypicalï¼‰â€ å“åº”æ—¶é—´ï¼Œé‚£ä¹ˆå¹³å‡å€¼å¹¶ä¸æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„æŒ‡æ ‡ï¼Œå› ä¸ºå®ƒä¸èƒ½å‘Šè¯‰ä½ æœ‰å¤šå°‘ç”¨æˆ·å®é™…ä¸Šç»å†äº†è¿™ä¸ªå»¶è¿Ÿã€‚ é€šå¸¸ä½¿ç”¨ ç™¾åˆ†ä½ç‚¹ï¼ˆpercentilesï¼‰ ä¼šæ›´å¥½ã€‚å¦‚æœå°†å“åº”æ—¶é—´åˆ—è¡¨æŒ‰æœ€å¿«åˆ°æœ€æ…¢æ’åºï¼Œé‚£ä¹ˆ ä¸­ä½æ•°ï¼ˆmedianï¼‰å°±åœ¨æ­£ä¸­é—´ï¼Œå¯ä»¥è¡¨ç¤ºä¸€åŠçš„è¯·æ±‚å°‘äºä¸­ä½æ•°ã€‚ å¦‚æœæƒ³çŸ¥é“å…¸å‹åœºæ™¯ä¸‹ç”¨æˆ·éœ€è¦ç­‰å¾…å¤šé•¿æ—¶é—´ï¼Œé‚£ä¹ˆä¸­ä½æ•°æ˜¯ä¸€ä¸ªå¥½çš„åº¦é‡æ ‡å‡†ï¼Œä¸€åŠç”¨æˆ·è¯·æ±‚çš„å“åº”æ—¶é—´å°‘äºå“åº”æ—¶é—´çš„ä¸­ä½æ•°ï¼Œå¦ä¸€åŠæœåŠ¡æ—¶é—´æ¯”ä¸­ä½æ•°é•¿ã€‚ä¸­ä½æ•°ä¹Ÿè¢«ç§°ä¸ºç¬¬ 50 ç™¾åˆ†ä½ç‚¹ï¼Œæœ‰æ—¶ç¼©å†™ä¸º p50ã€‚æ³¨æ„ä¸­ä½æ•°æ˜¯å…³äºå•ä¸ªè¯·æ±‚çš„ï¼›å¦‚æœç”¨æˆ·åŒæ—¶å‘å‡ºå‡ ä¸ªè¯·æ±‚ï¼ˆåœ¨ä¸€ä¸ªä¼šè¯è¿‡ç¨‹ä¸­ï¼Œæˆ–è€…ç”±äºä¸€ä¸ªé¡µé¢ä¸­åŒ…å«äº†å¤šä¸ªèµ„æºï¼‰ï¼Œåˆ™è‡³å°‘ä¸€ä¸ªè¯·æ±‚æ¯”ä¸­ä½æ•°æ…¢çš„æ¦‚ç‡è¿œå¤§äº 50%ã€‚ ä¸ºäº†å¼„æ¸…å¼‚å¸¸å€¼æœ‰å¤šç³Ÿç³•ï¼Œå¯ä»¥çœ‹çœ‹æ›´é«˜çš„ç™¾åˆ†ä½ç‚¹ï¼Œä¾‹å¦‚ç¬¬ 95ã€99 å’Œ 99.9 ç™¾åˆ†ä½ç‚¹ï¼ˆç¼©å†™ä¸º p95ï¼Œp99 å’Œ p999ï¼‰ã€‚å®ƒä»¬æ„å‘³ç€ 95%ã€99% æˆ– 99.9% çš„è¯·æ±‚å“åº”æ—¶é—´è¦æ¯”è¯¥é˜ˆå€¼å¿«ã€‚ å“åº”æ—¶é—´çš„é«˜ç™¾åˆ†ä½ç‚¹ï¼ˆä¹Ÿç§°ä¸º å°¾éƒ¨å»¶è¿Ÿï¼Œå³ tail latenciesï¼‰éå¸¸é‡è¦ï¼Œå› ä¸ºå®ƒä»¬ç›´æ¥å½±å“ç”¨æˆ·çš„æœåŠ¡ä½“éªŒã€‚ä¾‹å¦‚äºšé©¬é€Šåœ¨æè¿°å†…éƒ¨æœåŠ¡çš„å“åº”æ—¶é—´è¦æ±‚æ—¶æ˜¯ä»¥ 99.9 ç™¾åˆ†ä½ç‚¹ä¸ºå‡†ï¼Œå³ä½¿å®ƒåªå½±å“ä¸€åƒä¸ªè¯·æ±‚ä¸­çš„ä¸€ä¸ªã€‚è¿™æ˜¯å› ä¸ºè¯·æ±‚å“åº”æœ€æ…¢çš„å®¢æˆ·å¾€å¾€ä¹Ÿæ˜¯æ•°æ®æœ€å¤šçš„å®¢æˆ·ï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯æœ€æœ‰ä»·å€¼çš„å®¢æˆ· â€”â€” å› ä¸ºä»–ä»¬æé’±äº†ã€‚ä¿è¯ç½‘ç«™å“åº”è¿…é€Ÿå¯¹äºä¿æŒå®¢æˆ·çš„æ»¡æ„åº¦éå¸¸é‡è¦ï¼Œäºšé©¬é€Šè§‚å¯Ÿåˆ°ï¼šå“åº”æ—¶é—´å¢åŠ  100 æ¯«ç§’ï¼Œé”€å”®é‡å°±å‡å°‘ 1%ï¼›è€Œå¦ä¸€äº›æŠ¥å‘Šè¯´ï¼šæ…¢ 1 ç§’é’Ÿä¼šè®©å®¢æˆ·æ»¡æ„åº¦æŒ‡æ ‡å‡å°‘ 16%ã€‚å¦ä¸€æ–¹é¢ï¼Œä¼˜åŒ–ç¬¬ 99.99 ç™¾åˆ†ä½ç‚¹ï¼ˆä¸€ä¸‡ä¸ªè¯·æ±‚ä¸­æœ€æ…¢çš„ä¸€ä¸ªï¼‰è¢«è®¤ä¸ºå¤ªæ˜‚è´µäº†ï¼Œä¸èƒ½ä¸ºäºšé©¬é€Šçš„ç›®æ ‡å¸¦æ¥è¶³å¤Ÿå¥½å¤„ã€‚å‡å°é«˜ç™¾åˆ†ä½ç‚¹å¤„çš„å“åº”æ—¶é—´ç›¸å½“å›°éš¾ï¼Œå› ä¸ºå®ƒå¾ˆå®¹æ˜“å—åˆ°éšæœºäº‹ä»¶çš„å½±å“ï¼Œè¿™è¶…å‡ºäº†æ§åˆ¶èŒƒå›´ï¼Œè€Œä¸”æ•ˆç›Šä¹Ÿå¾ˆå°ã€‚ ç™¾åˆ†ä½ç‚¹é€šå¸¸ç”¨äº æœåŠ¡çº§åˆ«ç›®æ ‡ï¼ˆSLO, service level objectivesï¼‰ å’Œ æœåŠ¡çº§åˆ«åè®®ï¼ˆSLA, service level agreementsï¼‰ï¼Œå³å®šä¹‰æœåŠ¡é¢„æœŸæ€§èƒ½å’Œå¯ç”¨æ€§çš„åˆåŒã€‚ SLA å¯èƒ½ä¼šå£°æ˜ï¼Œå¦‚æœæœåŠ¡å“åº”æ—¶é—´çš„ä¸­ä½æ•°å°äº 200 æ¯«ç§’ï¼Œä¸” 99.9 ç™¾åˆ†ä½ç‚¹ä½äº 1 ç§’ï¼Œåˆ™è®¤ä¸ºæœåŠ¡å·¥ä½œæ­£å¸¸ï¼ˆå¦‚æœå“åº”æ—¶é—´æ›´é•¿ï¼Œå°±è®¤ä¸ºæœåŠ¡ä¸è¾¾æ ‡ï¼‰ã€‚è¿™äº›æŒ‡æ ‡ä¸ºå®¢æˆ·è®¾å®šäº†æœŸæœ›å€¼ï¼Œå¹¶å…è®¸å®¢æˆ·åœ¨ SLA æœªè¾¾æ ‡çš„æƒ…å†µä¸‹è¦æ±‚é€€æ¬¾ã€‚ æ’é˜Ÿå»¶è¿Ÿï¼ˆqueueing delayï¼‰ é€šå¸¸å äº†é«˜ç™¾åˆ†ä½ç‚¹å¤„å“åº”æ—¶é—´çš„å¾ˆå¤§ä¸€éƒ¨åˆ†ã€‚ç”±äºæœåŠ¡å™¨åªèƒ½å¹¶è¡Œå¤„ç†å°‘é‡çš„äº‹åŠ¡ï¼ˆå¦‚å—å…¶ CPU æ ¸æ•°çš„é™åˆ¶ï¼‰ï¼Œæ‰€ä»¥åªè¦æœ‰å°‘é‡ç¼“æ…¢çš„è¯·æ±‚å°±èƒ½é˜»ç¢åç»­è¯·æ±‚çš„å¤„ç†ï¼Œè¿™ç§æ•ˆåº”æœ‰æ—¶è¢«ç§°ä¸º å¤´éƒ¨é˜»å¡ï¼ˆhead-of-line blockingï¼‰ ã€‚å³ä½¿åç»­è¯·æ±‚åœ¨æœåŠ¡å™¨ä¸Šå¤„ç†çš„éå¸¸è¿…é€Ÿï¼Œç”±äºéœ€è¦ç­‰å¾…å…ˆå‰è¯·æ±‚å®Œæˆï¼Œå®¢æˆ·ç«¯æœ€ç»ˆçœ‹åˆ°çš„æ˜¯ç¼“æ…¢çš„æ€»ä½“å“åº”æ—¶é—´ã€‚å› ä¸ºå­˜åœ¨è¿™ç§æ•ˆåº”ï¼Œæµ‹é‡å®¢æˆ·ç«¯çš„å“åº”æ—¶é—´éå¸¸é‡è¦ã€‚ å®è·µä¸­çš„ç™¾åˆ†ä½ç‚¹ åœ¨å¤šé‡è°ƒç”¨çš„åç«¯æœåŠ¡é‡Œï¼Œé«˜ç™¾åˆ†ä½æ•°å˜å¾—ç‰¹åˆ«é‡è¦ã€‚å³ä½¿å¹¶è¡Œè°ƒç”¨ï¼Œæœ€ç»ˆç”¨æˆ·è¯·æ±‚ä»ç„¶éœ€è¦ç­‰å¾…æœ€æ…¢çš„å¹¶è¡Œè°ƒç”¨å®Œæˆã€‚ å¦‚æœä½ æƒ³å°†å“åº”æ—¶é—´ç™¾åˆ†ç‚¹æ·»åŠ åˆ°ä½ çš„æœåŠ¡çš„ç›‘è§†ä»ªè¡¨æ¿ï¼Œåˆ™éœ€è¦æŒç»­æœ‰æ•ˆåœ°è®¡ç®—å®ƒä»¬ã€‚ ç®€å•çš„å®ç°æ˜¯åœ¨æ—¶é—´çª—å£å†…ä¿å­˜æ‰€æœ‰è¯·æ±‚çš„å“åº”æ—¶é—´åˆ—è¡¨ï¼Œå¹¶ä¸”æ¯åˆ†é’Ÿå¯¹åˆ—è¡¨è¿›è¡Œæ’åºã€‚å¦‚æœå¯¹ä½ æ¥è¯´æ•ˆç‡å¤ªä½ï¼Œé‚£ä¹ˆæœ‰ä¸€äº›ç®—æ³•èƒ½å¤Ÿä»¥æœ€å°çš„ CPU å’Œå†…å­˜æˆæœ¬ï¼ˆå¦‚å‰å‘è¡°å‡ã€t-digest æˆ– HdrHistogramï¼‰æ¥è®¡ç®—ç™¾åˆ†ä½æ•°çš„è¿‘ä¼¼å€¼ã€‚ ç”¨äºæè¿°è´Ÿè½½å’Œæ€§èƒ½çš„æŒ‡æ ‡ï¼Œè¿™éƒ¨åˆ†æ¦‚å¿µä¹Ÿå¤ªå¤šäº†ï¼Œç»å¸¸å¬åˆ° SLA ä½†ä¸èƒ½ç›´è§‚ç†è§£ã€‚è®¸å¤š Grafana ä¸Šçš„æŒ‡æ ‡ä¹Ÿæ²¡æœ‰æ·±å…¥å»ç†è§£ã€‚ åº”å¯¹è´Ÿè½½çš„æ–¹æ³• å·²ç»è®¨è®ºäº†ç”¨äºæè¿°è´Ÿè½½çš„å‚æ•°å’Œç”¨äºè¡¡é‡æ€§èƒ½çš„æŒ‡æ ‡ã€‚å¯ä»¥å¼€å§‹è®¤çœŸè®¨è®ºå¯ä¼¸ç¼©æ€§äº†ï¼šå½“è´Ÿè½½å‚æ•°å¢åŠ æ—¶ï¼Œå¦‚ä½•ä¿æŒè‰¯å¥½çš„æ€§èƒ½ï¼Ÿ çºµå‘ä¼¸ç¼©ï¼ˆscaling upï¼Œä¹Ÿç§°ä¸ºå‚ç›´ä¼¸ç¼©ï¼Œå³ vertical scalingï¼Œè½¬å‘æ›´å¼ºå¤§çš„æœºå™¨ï¼‰ æ¨ªå‘ä¼¸ç¼©ï¼ˆscaling outï¼Œä¹Ÿç§°ä¸ºæ°´å¹³ä¼¸ç¼©ï¼Œå³ horizontal scalingï¼Œå°†è´Ÿè½½åˆ†å¸ƒåˆ°å¤šå°å°æœºå™¨ä¸Šï¼‰ è·¨å¤šå°æœºå™¨åˆ†é…è´Ÿè½½ä¹Ÿç§°ä¸º â€œæ— å…±äº«ï¼ˆshared-nothingï¼‰â€ æ¶æ„ã€‚å¯ä»¥åœ¨å•å°æœºå™¨ä¸Šè¿è¡Œçš„ç³»ç»Ÿé€šå¸¸æ›´ç®€å•ï¼Œä½†é«˜ç«¯æœºå™¨å¯èƒ½éå¸¸è´µï¼Œæ‰€ä»¥éå¸¸å¯†é›†çš„è´Ÿè½½é€šå¸¸æ— æ³•é¿å…åœ°éœ€è¦æ¨ªå‘ä¼¸ç¼©ã€‚ç°å®ä¸–ç•Œä¸­çš„ä¼˜ç§€æ¶æ„éœ€è¦å°†è¿™ä¸¤ç§æ–¹æ³•åŠ¡å®åœ°ç»“åˆï¼Œå› ä¸ºä½¿ç”¨å‡ å°è¶³å¤Ÿå¼ºå¤§çš„æœºå™¨å¯èƒ½æ¯”ä½¿ç”¨å¤§é‡çš„å°å‹è™šæ‹Ÿæœºæ›´ç®€å•ä¹Ÿæ›´ä¾¿å®œã€‚ æœ‰äº›ç³»ç»Ÿæ˜¯ å¼¹æ€§ï¼ˆelasticï¼‰ çš„ï¼Œè¿™æ„å‘³ç€å¯ä»¥åœ¨æ£€æµ‹åˆ°è´Ÿè½½å¢åŠ æ—¶è‡ªåŠ¨å¢åŠ è®¡ç®—èµ„æºï¼Œè€Œå…¶ä»–ç³»ç»Ÿåˆ™æ˜¯æ‰‹åŠ¨ä¼¸ç¼©ï¼ˆäººå·¥åˆ†æå®¹é‡å¹¶å†³å®šå‘ç³»ç»Ÿæ·»åŠ æ›´å¤šçš„æœºå™¨ï¼‰ã€‚å¦‚æœè´Ÿè½½ æéš¾é¢„æµ‹ï¼ˆhighly ","date":"2024-01-05","objectID":"/posts/ddia-1/:3:3","tags":["DDIA","ç¬”è®°"],"title":"é˜…è¯»ï¼šDDIA åºç« ä»¥åŠç¬¬ä¸€ç« ","uri":"/posts/ddia-1/"},{"categories":null,"content":"å¯æ¼”åŒ–æ€§ï¼šæ‹¥æŠ±å˜åŒ– ç³»ç»Ÿçš„éœ€æ±‚æ°¸è¿œä¸å˜ï¼ŒåŸºæœ¬æ˜¯ä¸å¯èƒ½çš„ã€‚æ›´å¯èƒ½çš„æƒ…å†µæ˜¯ï¼Œå®ƒä»¬å¤„äºå¸¸æ€çš„å˜åŒ–ä¸­ï¼Œä¾‹å¦‚ï¼šä½ äº†è§£äº†æ–°çš„äº‹å®ã€å‡ºç°æ„æƒ³ä¸åˆ°çš„åº”ç”¨åœºæ™¯ã€ä¸šåŠ¡ä¼˜å…ˆçº§å‘ç”Ÿå˜åŒ–ã€ç”¨æˆ·è¦æ±‚æ–°åŠŸèƒ½ã€æ–°å¹³å°å–ä»£æ—§å¹³å°ã€æ³•å¾‹æˆ–ç›‘ç®¡è¦æ±‚å‘ç”Ÿå˜åŒ–ã€ç³»ç»Ÿå¢é•¿è¿«ä½¿æ¶æ„å˜åŒ–ç­‰ã€‚ åœ¨ç»„ç»‡æµç¨‹æ–¹é¢ï¼Œ æ•æ·ï¼ˆagileï¼‰ å·¥ä½œæ¨¡å¼ä¸ºé€‚åº”å˜åŒ–æä¾›äº†ä¸€ä¸ªæ¡†æ¶ã€‚æ•æ·ç¤¾åŒºè¿˜å¼€å‘äº†å¯¹åœ¨é¢‘ç¹å˜åŒ–çš„ç¯å¢ƒä¸­å¼€å‘è½¯ä»¶å¾ˆæœ‰å¸®åŠ©çš„æŠ€æœ¯å·¥å…·å’Œæ¨¡å¼ï¼Œå¦‚ æµ‹è¯•é©±åŠ¨å¼€å‘ï¼ˆTDD, test-driven developmentï¼‰ å’Œ é‡æ„ï¼ˆrefactoringï¼‰ ã€‚ é‡æ„ æ”¹å–„æ—¢æœ‰ä»£ç çš„è®¾è®¡ç¬¬äºŒç‰ˆ ä¹Ÿæ˜¯ä¸€æœ¬æ²¡åšæŒçœ‹å®Œçš„ä¹¦ ä¿®æ”¹æ•°æ®ç³»ç»Ÿå¹¶ä½¿å…¶é€‚åº”ä¸æ–­å˜åŒ–éœ€æ±‚çš„å®¹æ˜“ç¨‹åº¦ï¼Œæ˜¯ä¸ ç®€å•æ€§ å’Œ æŠ½è±¡æ€§ å¯†åˆ‡ç›¸å…³çš„ï¼šç®€å•æ˜“æ‡‚çš„ç³»ç»Ÿé€šå¸¸æ¯”å¤æ‚ç³»ç»Ÿæ›´å®¹æ˜“ä¿®æ”¹ã€‚ä½†ç”±äºè¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µï¼Œæˆ‘ä»¬å°†ç”¨ä¸€ä¸ªä¸åŒçš„è¯æ¥æŒ‡ä»£æ•°æ®ç³»ç»Ÿå±‚é¢çš„æ•æ·æ€§ï¼š å¯æ¼”åŒ–æ€§ï¼ˆevolvabilityï¼‰ ","date":"2024-01-05","objectID":"/posts/ddia-1/:3:4","tags":["DDIA","ç¬”è®°"],"title":"é˜…è¯»ï¼šDDIA åºç« ä»¥åŠç¬¬ä¸€ç« ","uri":"/posts/ddia-1/"},{"categories":null,"content":"æœ¬ç« æ€»ç»“ æœ¬ç« æ¢è®¨äº†ä¸€äº›å…³äºæ•°æ®å¯†é›†å‹åº”ç”¨çš„åŸºæœ¬æ€è€ƒæ–¹å¼ ä¸€ä¸ªåº”ç”¨å¿…é¡»æ»¡è¶³å„ç§éœ€æ±‚æ‰ç§°å¾—ä¸Šæœ‰ç”¨ï¼šåŠŸèƒ½éœ€æ±‚ï¼ˆå®ƒåº”è¯¥åšä»€ä¹ˆï¼Œæ¯”å¦‚å…è®¸ä»¥å„ç§æ–¹å¼å­˜å‚¨ï¼Œæ£€ç´¢ï¼Œæœç´¢å’Œå¤„ç†æ•°æ®ï¼‰ã€éåŠŸèƒ½éœ€æ±‚ï¼ˆé€šç”¨å±æ€§ï¼Œå®‰å…¨æ€§ã€å¯é æ€§ã€åˆè§„æ€§ã€å¯ä¼¸ç¼©æ€§ã€å…¼å®¹æ€§å’Œå¯ç»´æŠ¤æ€§ï¼‰ è¯¦ç»†è®¨è®ºäº†å¯é æ€§ã€å¯ä¼¸ç¼©æ€§ã€å¯ç»´æŠ¤æ€§ ","date":"2024-01-05","objectID":"/posts/ddia-1/:4:0","tags":["DDIA","ç¬”è®°"],"title":"é˜…è¯»ï¼šDDIA åºç« ä»¥åŠç¬¬ä¸€ç« ","uri":"/posts/ddia-1/"},{"categories":null,"content":"æ€»ç»“è¿‡å» å…¶å®ä¸å¤ªå¸Œæœ›å†™ä¸€äº›å°å­¦ç”Ÿæµæ°´è´¦æ¥è®°å½•è¿‡å»ï¼Œä½† 2023 è¿‡çš„å®åœ¨æ˜¯å¤ªå¿«ï¼Œå¹´çºªåˆ°äº†ä¹Ÿå¼€å§‹é€æ¸å¿˜äº‹ï¼Œä¸å†™ä¸€äº›ä¸œè¥¿æ€»ä¼šè®°ä¸èµ·è‡ªå·±åšäº†ä»€ä¹ˆï¼Œéœ€è¦åšä»€ä¹ˆã€‚ 2023 å¹´è¿‡å¾—å¾ˆåŒ†å¿™ï¼Œå…¶å®æ¯å¤©å°±æ˜¯å®ä¹ å’Œæ‰“æ‰“æ¸¸æˆå°±è¿‡å»äº†ã€‚å…»æˆäº†å¤©å¤©ç¡å‰æ€»çˆ±åˆ·è§†é¢‘çš„åä¹ æƒ¯ï¼Œå­¦ä¹ çš„åŠ¨åŠ›ä¹Ÿå°‘äº†å¾ˆå¤šï¼Œç¢ç‰‡åŒ–å­¦ä¹ çš„æ–¹å¼å§‹ç»ˆä¸é€‚åˆæˆ‘ã€‚ å»å¹´å…«æœˆåº•åˆ°äº†ç¾å›½è¯»ç ”ï¼Œä½†ä¹Ÿå°±æ˜¯æ¢äº†ä¸ªåœ°æ–¹æ‰“æ¸¸æˆå’Œåˆ·æ‰‹æœºã€‚æ‰¾å®ä¹ çš„è·¯ç¨‹è¿‡äºåå·ï¼Œå‡ ç™¾ä»½ç”³è¯·ä¸‹å»ä¸åˆ°ä¸¤ä¸ªé¢è¯•ï¼Œä¹Ÿéƒ½ä¸€é¢å°±æŒ‚äº†ã€‚å…¶å®æœ‰å¾ˆå¤šå»å¹´å°±è¯¥å»åšçš„äº‹æƒ…ï¼Œä¸€ç›´è¢«æ‹–åˆ°äº†ç°åœ¨ã€‚ ","date":"2024-01-04","objectID":"/posts/my-first-post/:1:0","tags":["æ€»ç»“"],"title":"2024 çš„ä¸€äº›è®¡åˆ’","uri":"/posts/my-first-post/"},{"categories":null,"content":"æ–°çš„å¼€å§‹ å¹´åˆæ€»æœ‰ä¸€äº›æ–—å¿—ï¼Œä¹Ÿæƒ³çœ‹çœ‹ä»Šå¹´ä¼šä¸ä¼šæœ‰äº›ä¸å¤ªä¸€æ ·ã€‚ä½†æ¯æ¯æ–°å¹´çš„ç›®æ ‡å¤¹æ‚çš„æ—§å¹´çš„ä¸ç”˜ï¼Œå…¶å®ä¹Ÿè¿˜æ˜¯å…œå…œè½¬è½¬æ²¡ä»€ä¹ˆä¸ä¸€æ ·ã€‚ ä»Šå¹´å¸Œæœ›è‡ªå·±èƒ½å®Œæˆçš„ä¸€äº›ç›®æ ‡ï¼Œåˆåˆ†çŸ­æœŸçš„å’Œé•¿æœŸçš„ï¼š 100km æ¯æœˆ è·‘ä¸€æ¬¡åŠé©¬ Rust å‚ä¸ä¸€äº›å¼€æºé¡¹ç›® cmu-db/bustub MIT 6824 DDIA æ¯æœˆæ€»ç»“ å­¦ Rust å…¶å®ä¸€ç›´æä¸èµ·åŠ²ï¼Œä½†ç»å†äº†ä¸€æ¬¡å¤±è´¥çš„ C++ é¢è¯•åï¼Œæ„Ÿè§‰å­¦ä¹  Rust è¿˜æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚ ","date":"2024-01-04","objectID":"/posts/my-first-post/:2:0","tags":["æ€»ç»“"],"title":"2024 çš„ä¸€äº›è®¡åˆ’","uri":"/posts/my-first-post/"},{"categories":null,"content":"ç»“è¯­ å‡ºå›½è¯»ç ”å¹¶ä¸åƒå¾ˆå¤šäººæ‰€æƒ³çš„é‚£æ ·å…‰é²œè‰³ä¸½ï¼Œå®é™…ä¸Šç•™å­¦å¯¹æˆ‘æ¥è¯´ï¼Œå¥½åƒçœŸçš„æ²¡æœ‰å¤ªå¤§åŒºåˆ«ï¼Œå€’æ˜¯å¨è‰ºé•¿è¿›äº†ä¸å°‘ï¼Œæ›´åŠ èƒ½è®¤æ¸…è‡ªå·±é€‚åˆä»€ä¹ˆã€‚ å¸Œæœ›ç­‰ä¸€æœˆç»“æŸçš„æ—¶å€™ï¼Œæˆ‘è¿˜æœ‰è¿™ä»½åŠ¨åŠ›å’Œå¹²åŠ²å†æ¬¡æ€»ç»“ã€‚ ","date":"2024-01-04","objectID":"/posts/my-first-post/:3:0","tags":["æ€»ç»“"],"title":"2024 çš„ä¸€äº›è®¡åˆ’","uri":"/posts/my-first-post/"}]